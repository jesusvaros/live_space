(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const _ of f)if(_.type==="childList")for(const y of _.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&l(y)}).observe(document,{childList:!0,subtree:!0});function s(f){const _={};return f.integrity&&(_.integrity=f.integrity),f.referrerPolicy&&(_.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?_.credentials="include":f.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function l(f){if(f.ep)return;f.ep=!0;const _=s(f);fetch(f.href,_)}})();function Kh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P_={exports:{}},xm={};var nb;function P2(){if(nb)return xm;nb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(l,f,_){var y=null;if(_!==void 0&&(y=""+_),f.key!==void 0&&(y=""+f.key),"key"in f){_={};for(var d in f)d!=="key"&&(_[d]=f[d])}else _=f;return f=_.ref,{$$typeof:t,type:l,key:y,ref:f!==void 0?f:null,props:_}}return xm.Fragment=e,xm.jsx=s,xm.jsxs=s,xm}var sb;function I2(){return sb||(sb=1,P_.exports=P2()),P_.exports}var S=I2(),I_={exports:{}},bm={},j_={exports:{}},L_={};var rb;function j2(){return rb||(rb=1,(function(t){function e($e,ct){var We=$e.length;$e.push(ct);e:for(;0<We;){var Tt=We-1>>>1,lt=$e[Tt];if(0<f(lt,ct))$e[Tt]=ct,$e[We]=lt,We=Tt;else break e}}function s($e){return $e.length===0?null:$e[0]}function l($e){if($e.length===0)return null;var ct=$e[0],We=$e.pop();if(We!==ct){$e[0]=We;e:for(var Tt=0,lt=$e.length,xe=lt>>>1;Tt<xe;){var Ce=2*(Tt+1)-1,st=$e[Ce],ot=Ce+1,_t=$e[ot];if(0>f(st,We))ot<lt&&0>f(_t,st)?($e[Tt]=_t,$e[ot]=We,Tt=ot):($e[Tt]=st,$e[Ce]=We,Tt=Ce);else if(ot<lt&&0>f(_t,We))$e[Tt]=_t,$e[ot]=We,Tt=ot;else break e}}return ct}function f($e,ct){var We=$e.sortIndex-ct.sortIndex;return We!==0?We:$e.id-ct.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var _=performance;t.unstable_now=function(){return _.now()}}else{var y=Date,d=y.now();t.unstable_now=function(){return y.now()-d}}var A=[],I=[],B=1,N=null,V=3,K=!1,se=!1,ne=!1,ve=!1,re=typeof setTimeout=="function"?setTimeout:null,ge=typeof clearTimeout=="function"?clearTimeout:null,oe=typeof setImmediate<"u"?setImmediate:null;function me($e){for(var ct=s(I);ct!==null;){if(ct.callback===null)l(I);else if(ct.startTime<=$e)l(I),ct.sortIndex=ct.expirationTime,e(A,ct);else break;ct=s(I)}}function ye($e){if(ne=!1,me($e),!se)if(s(A)!==null)se=!0,ke||(ke=!0,et());else{var ct=s(I);ct!==null&&pt(ye,ct.startTime-$e)}}var ke=!1,Re=-1,Ge=5,He=-1;function Xe(){return ve?!0:!(t.unstable_now()-He<Ge)}function at(){if(ve=!1,ke){var $e=t.unstable_now();He=$e;var ct=!0;try{e:{se=!1,ne&&(ne=!1,ge(Re),Re=-1),K=!0;var We=V;try{t:{for(me($e),N=s(A);N!==null&&!(N.expirationTime>$e&&Xe());){var Tt=N.callback;if(typeof Tt=="function"){N.callback=null,V=N.priorityLevel;var lt=Tt(N.expirationTime<=$e);if($e=t.unstable_now(),typeof lt=="function"){N.callback=lt,me($e),ct=!0;break t}N===s(A)&&l(A),me($e)}else l(A);N=s(A)}if(N!==null)ct=!0;else{var xe=s(I);xe!==null&&pt(ye,xe.startTime-$e),ct=!1}}break e}finally{N=null,V=We,K=!1}ct=void 0}}finally{ct?et():ke=!1}}}var et;if(typeof oe=="function")et=function(){oe(at)};else if(typeof MessageChannel<"u"){var Et=new MessageChannel,gt=Et.port2;Et.port1.onmessage=at,et=function(){gt.postMessage(null)}}else et=function(){re(at,0)};function pt($e,ct){Re=re(function(){$e(t.unstable_now())},ct)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($e){$e.callback=null},t.unstable_forceFrameRate=function($e){0>$e||125<$e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ge=0<$e?Math.floor(1e3/$e):5},t.unstable_getCurrentPriorityLevel=function(){return V},t.unstable_next=function($e){switch(V){case 1:case 2:case 3:var ct=3;break;default:ct=V}var We=V;V=ct;try{return $e()}finally{V=We}},t.unstable_requestPaint=function(){ve=!0},t.unstable_runWithPriority=function($e,ct){switch($e){case 1:case 2:case 3:case 4:case 5:break;default:$e=3}var We=V;V=$e;try{return ct()}finally{V=We}},t.unstable_scheduleCallback=function($e,ct,We){var Tt=t.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?Tt+We:Tt):We=Tt,$e){case 1:var lt=-1;break;case 2:lt=250;break;case 5:lt=1073741823;break;case 4:lt=1e4;break;default:lt=5e3}return lt=We+lt,$e={id:B++,callback:ct,priorityLevel:$e,startTime:We,expirationTime:lt,sortIndex:-1},We>Tt?($e.sortIndex=We,e(I,$e),s(A)===null&&$e===s(I)&&(ne?(ge(Re),Re=-1):ne=!0,pt(ye,We-Tt))):($e.sortIndex=lt,e(A,$e),se||K||(se=!0,ke||(ke=!0,et()))),$e},t.unstable_shouldYield=Xe,t.unstable_wrapCallback=function($e){var ct=V;return function(){var We=V;V=ct;try{return $e.apply(this,arguments)}finally{V=We}}}})(L_)),L_}var ab;function L2(){return ab||(ab=1,j_.exports=j2()),j_.exports}var R_={exports:{}},fn={};var ob;function R2(){if(ob)return fn;ob=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),y=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),I=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),V=Symbol.iterator;function K(xe){return xe===null||typeof xe!="object"?null:(xe=V&&xe[V]||xe["@@iterator"],typeof xe=="function"?xe:null)}var se={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ne=Object.assign,ve={};function re(xe,Ce,st){this.props=xe,this.context=Ce,this.refs=ve,this.updater=st||se}re.prototype.isReactComponent={},re.prototype.setState=function(xe,Ce){if(typeof xe!="object"&&typeof xe!="function"&&xe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,xe,Ce,"setState")},re.prototype.forceUpdate=function(xe){this.updater.enqueueForceUpdate(this,xe,"forceUpdate")};function ge(){}ge.prototype=re.prototype;function oe(xe,Ce,st){this.props=xe,this.context=Ce,this.refs=ve,this.updater=st||se}var me=oe.prototype=new ge;me.constructor=oe,ne(me,re.prototype),me.isPureReactComponent=!0;var ye=Array.isArray;function ke(){}var Re={H:null,A:null,T:null,S:null},Ge=Object.prototype.hasOwnProperty;function He(xe,Ce,st){var ot=st.ref;return{$$typeof:t,type:xe,key:Ce,ref:ot!==void 0?ot:null,props:st}}function Xe(xe,Ce){return He(xe.type,Ce,xe.props)}function at(xe){return typeof xe=="object"&&xe!==null&&xe.$$typeof===t}function et(xe){var Ce={"=":"=0",":":"=2"};return"$"+xe.replace(/[=:]/g,function(st){return Ce[st]})}var Et=/\/+/g;function gt(xe,Ce){return typeof xe=="object"&&xe!==null&&xe.key!=null?et(""+xe.key):Ce.toString(36)}function pt(xe){switch(xe.status){case"fulfilled":return xe.value;case"rejected":throw xe.reason;default:switch(typeof xe.status=="string"?xe.then(ke,ke):(xe.status="pending",xe.then(function(Ce){xe.status==="pending"&&(xe.status="fulfilled",xe.value=Ce)},function(Ce){xe.status==="pending"&&(xe.status="rejected",xe.reason=Ce)})),xe.status){case"fulfilled":return xe.value;case"rejected":throw xe.reason}}throw xe}function $e(xe,Ce,st,ot,_t){var kt=typeof xe;(kt==="undefined"||kt==="boolean")&&(xe=null);var It=!1;if(xe===null)It=!0;else switch(kt){case"bigint":case"string":case"number":It=!0;break;case"object":switch(xe.$$typeof){case t:case e:It=!0;break;case B:return It=xe._init,$e(It(xe._payload),Ce,st,ot,_t)}}if(It)return _t=_t(xe),It=ot===""?"."+gt(xe,0):ot,ye(_t)?(st="",It!=null&&(st=It.replace(Et,"$&/")+"/"),$e(_t,Ce,st,"",function(Gi){return Gi})):_t!=null&&(at(_t)&&(_t=Xe(_t,st+(_t.key==null||xe&&xe.key===_t.key?"":(""+_t.key).replace(Et,"$&/")+"/")+It)),Ce.push(_t)),1;It=0;var ei=ot===""?".":ot+":";if(ye(xe))for(var li=0;li<xe.length;li++)ot=xe[li],kt=ei+gt(ot,li),It+=$e(ot,Ce,st,kt,_t);else if(li=K(xe),typeof li=="function")for(xe=li.call(xe),li=0;!(ot=xe.next()).done;)ot=ot.value,kt=ei+gt(ot,li++),It+=$e(ot,Ce,st,kt,_t);else if(kt==="object"){if(typeof xe.then=="function")return $e(pt(xe),Ce,st,ot,_t);throw Ce=String(xe),Error("Objects are not valid as a React child (found: "+(Ce==="[object Object]"?"object with keys {"+Object.keys(xe).join(", ")+"}":Ce)+"). If you meant to render a collection of children, use an array instead.")}return It}function ct(xe,Ce,st){if(xe==null)return xe;var ot=[],_t=0;return $e(xe,ot,"","",function(kt){return Ce.call(st,kt,_t++)}),ot}function We(xe){if(xe._status===-1){var Ce=xe._result;Ce=Ce(),Ce.then(function(st){(xe._status===0||xe._status===-1)&&(xe._status=1,xe._result=st)},function(st){(xe._status===0||xe._status===-1)&&(xe._status=2,xe._result=st)}),xe._status===-1&&(xe._status=0,xe._result=Ce)}if(xe._status===1)return xe._result.default;throw xe._result}var Tt=typeof reportError=="function"?reportError:function(xe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof xe=="object"&&xe!==null&&typeof xe.message=="string"?String(xe.message):String(xe),error:xe});if(!window.dispatchEvent(Ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",xe);return}console.error(xe)},lt={map:ct,forEach:function(xe,Ce,st){ct(xe,function(){Ce.apply(this,arguments)},st)},count:function(xe){var Ce=0;return ct(xe,function(){Ce++}),Ce},toArray:function(xe){return ct(xe,function(Ce){return Ce})||[]},only:function(xe){if(!at(xe))throw Error("React.Children.only expected to receive a single React element child.");return xe}};return fn.Activity=N,fn.Children=lt,fn.Component=re,fn.Fragment=s,fn.Profiler=f,fn.PureComponent=oe,fn.StrictMode=l,fn.Suspense=A,fn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Re,fn.__COMPILER_RUNTIME={__proto__:null,c:function(xe){return Re.H.useMemoCache(xe)}},fn.cache=function(xe){return function(){return xe.apply(null,arguments)}},fn.cacheSignal=function(){return null},fn.cloneElement=function(xe,Ce,st){if(xe==null)throw Error("The argument must be a React element, but you passed "+xe+".");var ot=ne({},xe.props),_t=xe.key;if(Ce!=null)for(kt in Ce.key!==void 0&&(_t=""+Ce.key),Ce)!Ge.call(Ce,kt)||kt==="key"||kt==="__self"||kt==="__source"||kt==="ref"&&Ce.ref===void 0||(ot[kt]=Ce[kt]);var kt=arguments.length-2;if(kt===1)ot.children=st;else if(1<kt){for(var It=Array(kt),ei=0;ei<kt;ei++)It[ei]=arguments[ei+2];ot.children=It}return He(xe.type,_t,ot)},fn.createContext=function(xe){return xe={$$typeof:y,_currentValue:xe,_currentValue2:xe,_threadCount:0,Provider:null,Consumer:null},xe.Provider=xe,xe.Consumer={$$typeof:_,_context:xe},xe},fn.createElement=function(xe,Ce,st){var ot,_t={},kt=null;if(Ce!=null)for(ot in Ce.key!==void 0&&(kt=""+Ce.key),Ce)Ge.call(Ce,ot)&&ot!=="key"&&ot!=="__self"&&ot!=="__source"&&(_t[ot]=Ce[ot]);var It=arguments.length-2;if(It===1)_t.children=st;else if(1<It){for(var ei=Array(It),li=0;li<It;li++)ei[li]=arguments[li+2];_t.children=ei}if(xe&&xe.defaultProps)for(ot in It=xe.defaultProps,It)_t[ot]===void 0&&(_t[ot]=It[ot]);return He(xe,kt,_t)},fn.createRef=function(){return{current:null}},fn.forwardRef=function(xe){return{$$typeof:d,render:xe}},fn.isValidElement=at,fn.lazy=function(xe){return{$$typeof:B,_payload:{_status:-1,_result:xe},_init:We}},fn.memo=function(xe,Ce){return{$$typeof:I,type:xe,compare:Ce===void 0?null:Ce}},fn.startTransition=function(xe){var Ce=Re.T,st={};Re.T=st;try{var ot=xe(),_t=Re.S;_t!==null&&_t(st,ot),typeof ot=="object"&&ot!==null&&typeof ot.then=="function"&&ot.then(ke,Tt)}catch(kt){Tt(kt)}finally{Ce!==null&&st.types!==null&&(Ce.types=st.types),Re.T=Ce}},fn.unstable_useCacheRefresh=function(){return Re.H.useCacheRefresh()},fn.use=function(xe){return Re.H.use(xe)},fn.useActionState=function(xe,Ce,st){return Re.H.useActionState(xe,Ce,st)},fn.useCallback=function(xe,Ce){return Re.H.useCallback(xe,Ce)},fn.useContext=function(xe){return Re.H.useContext(xe)},fn.useDebugValue=function(){},fn.useDeferredValue=function(xe,Ce){return Re.H.useDeferredValue(xe,Ce)},fn.useEffect=function(xe,Ce){return Re.H.useEffect(xe,Ce)},fn.useEffectEvent=function(xe){return Re.H.useEffectEvent(xe)},fn.useId=function(){return Re.H.useId()},fn.useImperativeHandle=function(xe,Ce,st){return Re.H.useImperativeHandle(xe,Ce,st)},fn.useInsertionEffect=function(xe,Ce){return Re.H.useInsertionEffect(xe,Ce)},fn.useLayoutEffect=function(xe,Ce){return Re.H.useLayoutEffect(xe,Ce)},fn.useMemo=function(xe,Ce){return Re.H.useMemo(xe,Ce)},fn.useOptimistic=function(xe,Ce){return Re.H.useOptimistic(xe,Ce)},fn.useReducer=function(xe,Ce,st){return Re.H.useReducer(xe,Ce,st)},fn.useRef=function(xe){return Re.H.useRef(xe)},fn.useState=function(xe){return Re.H.useState(xe)},fn.useSyncExternalStore=function(xe,Ce,st){return Re.H.useSyncExternalStore(xe,Ce,st)},fn.useTransition=function(){return Re.H.useTransition()},fn.version="19.2.0",fn}var lb;function nx(){return lb||(lb=1,R_.exports=R2()),R_.exports}var z_={exports:{}},ro={};var cb;function z2(){if(cb)return ro;cb=1;var t=nx();function e(A){var I="https://react.dev/errors/"+A;if(1<arguments.length){I+="?args[]="+encodeURIComponent(arguments[1]);for(var B=2;B<arguments.length;B++)I+="&args[]="+encodeURIComponent(arguments[B])}return"Minified React error #"+A+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(e(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},f=Symbol.for("react.portal");function _(A,I,B){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:N==null?null:""+N,children:A,containerInfo:I,implementation:B}}var y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(A,I){if(A==="font")return"";if(typeof I=="string")return I==="use-credentials"?I:""}return ro.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,ro.createPortal=function(A,I){var B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I||I.nodeType!==1&&I.nodeType!==9&&I.nodeType!==11)throw Error(e(299));return _(A,I,null,B)},ro.flushSync=function(A){var I=y.T,B=l.p;try{if(y.T=null,l.p=2,A)return A()}finally{y.T=I,l.p=B,l.d.f()}},ro.preconnect=function(A,I){typeof A=="string"&&(I?(I=I.crossOrigin,I=typeof I=="string"?I==="use-credentials"?I:"":void 0):I=null,l.d.C(A,I))},ro.prefetchDNS=function(A){typeof A=="string"&&l.d.D(A)},ro.preinit=function(A,I){if(typeof A=="string"&&I&&typeof I.as=="string"){var B=I.as,N=d(B,I.crossOrigin),V=typeof I.integrity=="string"?I.integrity:void 0,K=typeof I.fetchPriority=="string"?I.fetchPriority:void 0;B==="style"?l.d.S(A,typeof I.precedence=="string"?I.precedence:void 0,{crossOrigin:N,integrity:V,fetchPriority:K}):B==="script"&&l.d.X(A,{crossOrigin:N,integrity:V,fetchPriority:K,nonce:typeof I.nonce=="string"?I.nonce:void 0})}},ro.preinitModule=function(A,I){if(typeof A=="string")if(typeof I=="object"&&I!==null){if(I.as==null||I.as==="script"){var B=d(I.as,I.crossOrigin);l.d.M(A,{crossOrigin:B,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0})}}else I==null&&l.d.M(A)},ro.preload=function(A,I){if(typeof A=="string"&&typeof I=="object"&&I!==null&&typeof I.as=="string"){var B=I.as,N=d(B,I.crossOrigin);l.d.L(A,B,{crossOrigin:N,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0,type:typeof I.type=="string"?I.type:void 0,fetchPriority:typeof I.fetchPriority=="string"?I.fetchPriority:void 0,referrerPolicy:typeof I.referrerPolicy=="string"?I.referrerPolicy:void 0,imageSrcSet:typeof I.imageSrcSet=="string"?I.imageSrcSet:void 0,imageSizes:typeof I.imageSizes=="string"?I.imageSizes:void 0,media:typeof I.media=="string"?I.media:void 0})}},ro.preloadModule=function(A,I){if(typeof A=="string")if(I){var B=d(I.as,I.crossOrigin);l.d.m(A,{as:typeof I.as=="string"&&I.as!=="script"?I.as:void 0,crossOrigin:B,integrity:typeof I.integrity=="string"?I.integrity:void 0})}else l.d.m(A)},ro.requestFormReset=function(A){l.d.r(A)},ro.unstable_batchedUpdates=function(A,I){return A(I)},ro.useFormState=function(A,I,B){return y.H.useFormState(A,I,B)},ro.useFormStatus=function(){return y.H.useHostTransitionStatus()},ro.version="19.2.0",ro}var ub;function Tw(){if(ub)return z_.exports;ub=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),z_.exports=z2(),z_.exports}var hb;function D2(){if(hb)return bm;hb=1;var t=L2(),e=nx(),s=Tw();function l(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)o+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function _(r){var o=r,p=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(p=o.return),r=o.return;while(r)}return o.tag===3?p:null}function y(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function d(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function A(r){if(_(r)!==r)throw Error(l(188))}function I(r){var o=r.alternate;if(!o){if(o=_(r),o===null)throw Error(l(188));return o!==r?null:r}for(var p=r,w=o;;){var P=p.return;if(P===null)break;var D=P.alternate;if(D===null){if(w=P.return,w!==null){p=w;continue}break}if(P.child===D.child){for(D=P.child;D;){if(D===p)return A(P),r;if(D===w)return A(P),o;D=D.sibling}throw Error(l(188))}if(p.return!==w.return)p=P,w=D;else{for(var W=!1,pe=P.child;pe;){if(pe===p){W=!0,p=P,w=D;break}if(pe===w){W=!0,w=P,p=D;break}pe=pe.sibling}if(!W){for(pe=D.child;pe;){if(pe===p){W=!0,p=D,w=P;break}if(pe===w){W=!0,w=D,p=P;break}pe=pe.sibling}if(!W)throw Error(l(189))}}if(p.alternate!==w)throw Error(l(190))}if(p.tag!==3)throw Error(l(188));return p.stateNode.current===p?r:o}function B(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=B(r),o!==null)return o;r=r.sibling}return null}var N=Object.assign,V=Symbol.for("react.element"),K=Symbol.for("react.transitional.element"),se=Symbol.for("react.portal"),ne=Symbol.for("react.fragment"),ve=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),ge=Symbol.for("react.consumer"),oe=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),ye=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),Re=Symbol.for("react.memo"),Ge=Symbol.for("react.lazy"),He=Symbol.for("react.activity"),Xe=Symbol.for("react.memo_cache_sentinel"),at=Symbol.iterator;function et(r){return r===null||typeof r!="object"?null:(r=at&&r[at]||r["@@iterator"],typeof r=="function"?r:null)}var Et=Symbol.for("react.client.reference");function gt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Et?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case ne:return"Fragment";case re:return"Profiler";case ve:return"StrictMode";case ye:return"Suspense";case ke:return"SuspenseList";case He:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case se:return"Portal";case oe:return r.displayName||"Context";case ge:return(r._context.displayName||"Context")+".Consumer";case me:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Re:return o=r.displayName||null,o!==null?o:gt(r.type)||"Memo";case Ge:o=r._payload,r=r._init;try{return gt(r(o))}catch{}}return null}var pt=Array.isArray,$e=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ct=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,We={pending:!1,data:null,method:null,action:null},Tt=[],lt=-1;function xe(r){return{current:r}}function Ce(r){0>lt||(r.current=Tt[lt],Tt[lt]=null,lt--)}function st(r,o){lt++,Tt[lt]=r.current,r.current=o}var ot=xe(null),_t=xe(null),kt=xe(null),It=xe(null);function ei(r,o){switch(st(kt,o),st(_t,r),st(ot,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?k(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=k(o),r=C(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Ce(ot),st(ot,r)}function li(){Ce(ot),Ce(_t),Ce(kt)}function Gi(r){r.memoizedState!==null&&st(It,r);var o=ot.current,p=C(o,r.type);o!==p&&(st(_t,r),st(ot,p))}function Mi(r){_t.current===r&&(Ce(ot),Ce(_t)),It.current===r&&(Ce(It),Nh._currentValue=We)}var Di,Pn;function hn(r){if(Di===void 0)try{throw Error()}catch(p){var o=p.stack.trim().match(/\n( *(at )?)/);Di=o&&o[1]||"",Pn=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Di+r+Pn}var zn=!1;function it(r,o){if(!r||zn)return"";zn=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(o){var Rt=function(){throw Error()};if(Object.defineProperty(Rt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Rt,[])}catch(vt){var mt=vt}Reflect.construct(r,[],Rt)}else{try{Rt.call()}catch(vt){mt=vt}r.call(Rt.prototype)}}else{try{throw Error()}catch(vt){mt=vt}(Rt=r())&&typeof Rt.catch=="function"&&Rt.catch(function(){})}}catch(vt){if(vt&&mt&&typeof vt.stack=="string")return[vt.stack,mt.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var P=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");P&&P.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=w.DetermineComponentFrameRoot(),W=D[0],pe=D[1];if(W&&pe){var De=W.split(`
`),ft=pe.split(`
`);for(P=w=0;w<De.length&&!De[w].includes("DetermineComponentFrameRoot");)w++;for(;P<ft.length&&!ft[P].includes("DetermineComponentFrameRoot");)P++;if(w===De.length||P===ft.length)for(w=De.length-1,P=ft.length-1;1<=w&&0<=P&&De[w]!==ft[P];)P--;for(;1<=w&&0<=P;w--,P--)if(De[w]!==ft[P]){if(w!==1||P!==1)do if(w--,P--,0>P||De[w]!==ft[P]){var St=`
`+De[w].replace(" at new "," at ");return r.displayName&&St.includes("<anonymous>")&&(St=St.replace("<anonymous>",r.displayName)),St}while(1<=w&&0<=P);break}}}finally{zn=!1,Error.prepareStackTrace=p}return(p=r?r.displayName||r.name:"")?hn(p):""}function Qn(r,o){switch(r.tag){case 26:case 27:case 5:return hn(r.type);case 16:return hn("Lazy");case 13:return r.child!==o&&o!==null?hn("Suspense Fallback"):hn("Suspense");case 19:return hn("SuspenseList");case 0:case 15:return it(r.type,!1);case 11:return it(r.type.render,!1);case 1:return it(r.type,!0);case 31:return hn("Activity");default:return""}}function qn(r){try{var o="",p=null;do o+=Qn(r,p),p=r,r=r.return;while(r);return o}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var wi=Object.prototype.hasOwnProperty,fi=t.unstable_scheduleCallback,xn=t.unstable_cancelCallback,Hn=t.unstable_shouldYield,es=t.unstable_requestPaint,Xi=t.unstable_now,Ki=t.unstable_getCurrentPriorityLevel,Wi=t.unstable_ImmediatePriority,gs=t.unstable_UserBlockingPriority,Ct=t.unstable_NormalPriority,In=t.unstable_LowPriority,an=t.unstable_IdlePriority,Tn=t.log,Zn=t.unstable_setDisableYieldValue,jt=null,ri=null;function Jt(r){if(typeof Tn=="function"&&Zn(r),ri&&typeof ri.setStrictMode=="function")try{ri.setStrictMode(jt,r)}catch{}}var Bi=Math.clz32?Math.clz32:xs,jn=Math.log,ci=Math.LN2;function xs(r){return r>>>=0,r===0?32:31-(jn(r)/ci|0)|0}var Dn=256,$n=262144,Ji=4194304;function be(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ie(r,o,p){var w=r.pendingLanes;if(w===0)return 0;var P=0,D=r.suspendedLanes,W=r.pingedLanes;r=r.warmLanes;var pe=w&134217727;return pe!==0?(w=pe&~D,w!==0?P=be(w):(W&=pe,W!==0?P=be(W):p||(p=pe&~r,p!==0&&(P=be(p))))):(pe=w&~D,pe!==0?P=be(pe):W!==0?P=be(W):p||(p=w&~r,p!==0&&(P=be(p)))),P===0?0:o!==0&&o!==P&&(o&D)===0&&(D=P&-P,p=o&-o,D>=p||D===32&&(p&4194048)!==0)?o:P}function te(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function he(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function we(){var r=Ji;return Ji<<=1,(Ji&62914560)===0&&(Ji=4194304),r}function je(r){for(var o=[],p=0;31>p;p++)o.push(r);return o}function Ne(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Ze(r,o,p,w,P,D){var W=r.pendingLanes;r.pendingLanes=p,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=p,r.entangledLanes&=p,r.errorRecoveryDisabledLanes&=p,r.shellSuspendCounter=0;var pe=r.entanglements,De=r.expirationTimes,ft=r.hiddenUpdates;for(p=W&~p;0<p;){var St=31-Bi(p),Rt=1<<St;pe[St]=0,De[St]=-1;var mt=ft[St];if(mt!==null)for(ft[St]=null,St=0;St<mt.length;St++){var vt=mt[St];vt!==null&&(vt.lane&=-536870913)}p&=~Rt}w!==0&&ee(r,w,0),D!==0&&P===0&&r.tag!==0&&(r.suspendedLanes|=D&~(W&~o))}function ee(r,o,p){r.pendingLanes|=o,r.suspendedLanes&=~o;var w=31-Bi(o);r.entangledLanes|=o,r.entanglements[w]=r.entanglements[w]|1073741824|p&261930}function Le(r,o){var p=r.entangledLanes|=o;for(r=r.entanglements;p;){var w=31-Bi(p),P=1<<w;P&o|r[w]&o&&(r[w]|=o),p&=~P}}function Ue(r,o){var p=o&-o;return p=(p&42)!==0?1:Oe(p),(p&(r.suspendedLanes|o))!==0?0:p}function Oe(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Ve(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Bt(){var r=ct.p;return r!==0?r:(r=window.event,r===void 0?32:Br(r.type))}function qt(r,o){var p=ct.p;try{return ct.p=r,o()}finally{ct.p=p}}var Dt=Math.random().toString(36).slice(2),At="__reactFiber$"+Dt,ti="__reactProps$"+Dt,pi="__reactContainer$"+Dt,ji="__reactEvents$"+Dt,Qi="__reactListeners$"+Dt,gi="__reactHandles$"+Dt,qi="__reactResources$"+Dt,on="__reactMarker$"+Dt;function Qe(r){delete r[At],delete r[ti],delete r[ji],delete r[Qi],delete r[gi]}function Ot(r){var o=r[At];if(o)return o;for(var p=r.parentNode;p;){if(o=p[pi]||p[At]){if(p=o.alternate,o.child!==null||p!==null&&p.child!==null)for(r=ai(r);r!==null;){if(p=r[At])return p;r=ai(r)}return o}r=p,p=r.parentNode}return null}function ui(r){if(r=r[At]||r[pi]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function ln(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(l(33))}function ut(r){var o=r[qi];return o||(o=r[qi]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ft(r){r[on]=!0}var Ti=new Set,en={};function Li(r,o){vr(r,o),vr(r+"Capture",o)}function vr(r,o){for(en[r]=o,r=0;r<o.length;r++)Ti.add(o[r])}var On=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Is={},Ir={};function rr(r){return wi.call(Ir,r)?!0:wi.call(Is,r)?!1:On.test(r)?Ir[r]=!0:(Is[r]=!0,!1)}function yi(r,o,p){if(rr(o))if(p===null)r.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var w=o.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+p)}}function An(r,o,p){if(p===null)r.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+p)}}function bs(r,o,p,w){if(w===null)r.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(p);return}r.setAttributeNS(o,p,""+w)}}function pn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Na(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function qr(r,o,p){var w=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var P=w.get,D=w.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return P.call(this)},set:function(W){p=""+W,D.call(this,W)}}),Object.defineProperty(r,o,{enumerable:w.enumerable}),{getValue:function(){return p},setValue:function(W){p=""+W},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function $i(r){if(!r._valueTracker){var o=Na(r)?"checked":"value";r._valueTracker=qr(r,o,""+r[o])}}function Ln(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var p=o.getValue(),w="";return r&&(w=Na(r)?r.checked?"true":"false":r.value),r=w,r!==p?(o.setValue(r),!0):!1}function Pl(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Wo=/[\n"\\]/g;function Un(r){return r.replace(Wo,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Ba(r,o,p,w,P,D,W,pe){r.name="",W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?r.type=W:r.removeAttribute("type"),o!=null?W==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+pn(o)):r.value!==""+pn(o)&&(r.value=""+pn(o)):W!=="submit"&&W!=="reset"||r.removeAttribute("value"),o!=null?wa(r,W,pn(o)):p!=null?wa(r,W,pn(p)):w!=null&&r.removeAttribute("value"),P==null&&D!=null&&(r.defaultChecked=!!D),P!=null&&(r.checked=P&&typeof P!="function"&&typeof P!="symbol"),pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?r.name=""+pn(pe):r.removeAttribute("name")}function mn(r,o,p,w,P,D,W,pe){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(r.type=D),o!=null||p!=null){if(!(D!=="submit"&&D!=="reset"||o!=null)){$i(r);return}p=p!=null?""+pn(p):"",o=o!=null?""+pn(o):p,pe||o===r.value||(r.value=o),r.defaultValue=o}w=w??P,w=typeof w!="function"&&typeof w!="symbol"&&!!w,r.checked=pe?r.checked:!!w,r.defaultChecked=!!w,W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(r.name=W),$i(r)}function wa(r,o,p){o==="number"&&Pl(r.ownerDocument)===r||r.defaultValue===""+p||(r.defaultValue=""+p)}function Xn(r,o,p,w){if(r=r.options,o){o={};for(var P=0;P<p.length;P++)o["$"+p[P]]=!0;for(p=0;p<r.length;p++)P=o.hasOwnProperty("$"+r[p].value),r[p].selected!==P&&(r[p].selected=P),P&&w&&(r[p].defaultSelected=!0)}else{for(p=""+pn(p),o=null,P=0;P<r.length;P++){if(r[P].value===p){r[P].selected=!0,w&&(r[P].defaultSelected=!0);return}o!==null||r[P].disabled||(o=r[P])}o!==null&&(o.selected=!0)}}function Hr(r,o,p){if(o!=null&&(o=""+pn(o),o!==r.value&&(r.value=o),p==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=p!=null?""+pn(p):""}function Co(r,o,p,w){if(o==null){if(w!=null){if(p!=null)throw Error(l(92));if(pt(w)){if(1<w.length)throw Error(l(93));w=w[0]}p=w}p==null&&(p=""),o=p}p=pn(o),r.defaultValue=p,w=r.textContent,w===p&&w!==""&&w!==null&&(r.value=w),$i(r)}function Zr(r,o){if(o){var p=r.firstChild;if(p&&p===r.lastChild&&p.nodeType===3){p.nodeValue=o;return}}r.textContent=o}var Yo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function oo(r,o,p){var w=o.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?w?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":w?r.setProperty(o,p):typeof p!="number"||p===0||Yo.has(o)?o==="float"?r.cssFloat=p:r[o]=(""+p).trim():r[o]=p+"px"}function lo(r,o,p){if(o!=null&&typeof o!="object")throw Error(l(62));if(r=r.style,p!=null){for(var w in p)!p.hasOwnProperty(w)||o!=null&&o.hasOwnProperty(w)||(w.indexOf("--")===0?r.setProperty(w,""):w==="float"?r.cssFloat="":r[w]="");for(var P in o)w=o[P],o.hasOwnProperty(P)&&p[P]!==w&&oo(r,P,w)}else for(var D in o)o.hasOwnProperty(D)&&oo(r,D,o[D])}function Il(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ic=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function jl(r){return jc.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function qs(){}var Ao=null;function Hs(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Bs=null,Ii=null;function jr(r){var o=ui(r);if(o&&(r=o.stateNode)){var p=r[ti]||null;e:switch(r=o.stateNode,o.type){case"input":if(Ba(r,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),o=p.name,p.type==="radio"&&o!=null){for(p=r;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Un(""+o)+'"][type="radio"]'),o=0;o<p.length;o++){var w=p[o];if(w!==r&&w.form===r.form){var P=w[ti]||null;if(!P)throw Error(l(90));Ba(w,P.value,P.defaultValue,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name)}}for(o=0;o<p.length;o++)w=p[o],w.form===r.form&&Ln(w)}break e;case"textarea":Hr(r,p.value,p.defaultValue);break e;case"select":o=p.value,o!=null&&Xn(r,!!p.multiple,o,!1)}}}var Rn=!1;function Lc(r,o,p){if(Rn)return r(o,p);Rn=!0;try{var w=r(o);return w}finally{if(Rn=!1,(Bs!==null||Ii!==null)&&(Cd(),Bs&&(o=Bs,r=Ii,Ii=Bs=null,jr(o),r)))for(o=0;o<r.length;o++)jr(r[o])}}function aa(r,o){var p=r.stateNode;if(p===null)return null;var w=p[ti]||null;if(w===null)return null;p=w[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(r=r.type,w=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!w;break e;default:r=!1}if(r)return null;if(p&&typeof p!="function")throw Error(l(231,o,typeof p));return p}var Sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ll=!1;if(Sa)try{var oa={};Object.defineProperty(oa,"passive",{get:function(){Ll=!0}}),window.addEventListener("test",oa,oa),window.removeEventListener("test",oa,oa)}catch{Ll=!1}var $a=null,Xo=null,Ts=null;function la(){if(Ts)return Ts;var r,o=Xo,p=o.length,w,P="value"in $a?$a.value:$a.textContent,D=P.length;for(r=0;r<p&&o[r]===P[r];r++);var W=p-r;for(w=1;w<=W&&o[p-w]===P[D-w];w++);return Ts=P.slice(r,1<w?1-w:void 0)}function Ko(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Mo(){return!0}function Rc(){return!1}function Qs(r){function o(p,w,P,D,W){this._reactName=p,this._targetInst=P,this.type=w,this.nativeEvent=D,this.target=W,this.currentTarget=null;for(var pe in r)r.hasOwnProperty(pe)&&(p=r[pe],this[pe]=p?p(D):D[pe]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Mo:Rc,this.isPropagationStopped=Rc,this}return N(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Mo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Mo)},persist:function(){},isPersistent:Mo}),o}var Zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zc=Qs(Zs),Po=N({},Zs,{view:0,detail:0}),tn=Qs(Po),Ua,Ui,ca,ec=N({},Po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xu,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ca&&(ca&&r.type==="mousemove"?(Ua=r.screenX-ca.screenX,Ui=r.screenY-ca.screenY):Ui=Ua=0,ca=r),Ua)},movementY:function(r){return"movementY"in r?r.movementY:Ui}}),Jo=Qs(ec),yu=N({},ec,{dataTransfer:0}),Qu=Qs(yu),eh=N({},Po,{relatedTarget:0}),Dc=Qs(eh),_u=N({},Zs,{animationName:0,elapsedTime:0,pseudoElement:0}),Oc=Qs(_u),th=N({},Zs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ta=Qs(th),ih=N({},Zs,{data:0}),co=Qs(ih),uo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qo(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=vu[r])?!!o[r]:!1}function xu(){return Qo}var tc=N({},Po,{key:function(r){if(r.key){var o=uo[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Ko(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?nh[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xu,charCode:function(r){return r.type==="keypress"?Ko(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ko(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),sh=Qs(tc),Jh=N({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bu=Qs(Jh),Nc=N({},Po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xu}),rh=Qs(Nc),Bc=N({},Zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),wu=Qs(Bc),el=N({},ec,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),xr=Qs(el),Su=N({},Zs,{newState:0,oldState:0}),tl=Qs(Su),Lr=[9,13,27,32],il=Sa&&"CompositionEvent"in window,Io=null;Sa&&"documentMode"in document&&(Io=document.documentMode);var nl=Sa&&"TextEvent"in window&&!Io,Rl=Sa&&(!il||Io&&8<Io&&11>=Io),$c=" ",ys=!1;function ah(r,o){switch(r){case"keyup":return Lr.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hi(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ho=!1;function gn(r,o){switch(r){case"compositionend":return Hi(o);case"keypress":return o.which!==32?null:(ys=!0,$c);case"textInput":return r=o.data,r===$c&&ys?null:r;default:return null}}function En(r,o){if(ho)return r==="compositionend"||!il&&ah(r,o)?(r=la(),Ts=Xo=$a=null,ho=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Rl&&o.locale!=="ko"?null:o.data;default:return null}}var sl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rr(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!sl[r.type]:o==="textarea"}function zl(r,o,p,w){Bs?Ii?Ii.push(w):Ii=[w]:Bs=w,o=Rd(o,"onChange"),0<o.length&&(p=new zc("onChange","change",null,p,w),r.push({event:p,listeners:o}))}var ua=null,Ea=null;function Fa(r){Lf(r,0)}function ar(r){var o=ln(r);if(Ln(o))return r}function rl(r,o){if(r==="change")return o}var Uc=!1;if(Sa){var ha;if(Sa){var da="oninput"in document;if(!da){var Dl=document.createElement("div");Dl.setAttribute("oninput","return;"),da=typeof Dl.oninput=="function"}ha=da}else ha=!1;Uc=ha&&(!document.documentMode||9<document.documentMode)}function jo(){ua&&(ua.detachEvent("onpropertychange",al),Ea=ua=null)}function al(r){if(r.propertyName==="value"&&ar(Ea)){var o=[];zl(o,Ea,r,Hs(r)),Lc(Fa,o)}}function Gr(r,o,p){r==="focusin"?(jo(),ua=o,Ea=p,ua.attachEvent("onpropertychange",al)):r==="focusout"&&jo()}function Fc(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ar(Ea)}function ka(r,o){if(r==="click")return ar(o)}function Ol(r,o){if(r==="input"||r==="change")return ar(o)}function Va(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Gs=typeof Object.is=="function"?Object.is:Va;function cn(r,o){if(Gs(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var p=Object.keys(r),w=Object.keys(o);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var P=p[w];if(!wi.call(o,P)||!Gs(r[P],o[P]))return!1}return!0}function ol(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ic(r,o){var p=ol(r);r=0;for(var w;p;){if(p.nodeType===3){if(w=r+p.textContent.length,r<=o&&w>=o)return{node:p,offset:o-r};r=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=ol(p)}}function nc(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?nc(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function qa(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Pl(r.document);o instanceof r.HTMLIFrameElement;){try{var p=typeof o.contentWindow.location.href=="string"}catch{p=!1}if(p)r=o.contentWindow;else break;o=Pl(r.document)}return o}function fo(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var ll=Sa&&"documentMode"in document&&11>=document.documentMode,po=null,sc=null,Lo=null,mo=!1;function cl(r,o,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;mo||po==null||po!==Pl(w)||(w=po,"selectionStart"in w&&fo(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Lo&&cn(Lo,w)||(Lo=w,w=Rd(sc,"onSelect"),0<w.length&&(o=new zc("onSelect","select",null,o,p),r.push({event:o,listeners:w}),o.target=po)))}function Wr(r,o){var p={};return p[r.toLowerCase()]=o.toLowerCase(),p["Webkit"+r]="webkit"+o,p["Moz"+r]="moz"+o,p}var Ca={animationend:Wr("Animation","AnimationEnd"),animationiteration:Wr("Animation","AnimationIteration"),animationstart:Wr("Animation","AnimationStart"),transitionrun:Wr("Transition","TransitionRun"),transitionstart:Wr("Transition","TransitionStart"),transitioncancel:Wr("Transition","TransitionCancel"),transitionend:Wr("Transition","TransitionEnd")},Nl={},ul={};Sa&&(ul=document.createElement("div").style,"AnimationEvent"in window||(delete Ca.animationend.animation,delete Ca.animationiteration.animation,delete Ca.animationstart.animation),"TransitionEvent"in window||delete Ca.transitionend.transition);function js(r){if(Nl[r])return Nl[r];if(!Ca[r])return r;var o=Ca[r],p;for(p in o)if(o.hasOwnProperty(p)&&p in ul)return Nl[r]=o[p];return r}var Ro=js("animationend"),rc=js("animationiteration"),hl=js("animationstart"),Qh=js("transitionrun"),Tu=js("transitionstart"),Vc=js("transitioncancel"),zo=js("transitionend"),Bl=new Map,fa="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");fa.push("scrollEnd");function Kn(r,o){Bl.set(r,o),Li(o,[r])}var Aa=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Yr=[],br=0,os=0;function wr(){for(var r=br,o=os=br=0;o<r;){var p=Yr[o];Yr[o++]=null;var w=Yr[o];Yr[o++]=null;var P=Yr[o];Yr[o++]=null;var D=Yr[o];if(Yr[o++]=null,w!==null&&P!==null){var W=w.pending;W===null?P.next=P:(P.next=W.next,W.next=P),w.pending=P}D!==0&&go(p,P,D)}}function Ls(r,o,p,w){Yr[br++]=r,Yr[br++]=o,Yr[br++]=p,Yr[br++]=w,os|=w,r.lanes|=w,r=r.alternate,r!==null&&(r.lanes|=w)}function dl(r,o,p,w){return Ls(r,o,p,w),Ha(r)}function pa(r,o){return Ls(r,null,null,o),Ha(r)}function go(r,o,p){r.lanes|=p;var w=r.alternate;w!==null&&(w.lanes|=p);for(var P=!1,D=r.return;D!==null;)D.childLanes|=p,w=D.alternate,w!==null&&(w.childLanes|=p),D.tag===22&&(r=D.stateNode,r===null||r._visibility&1||(P=!0)),r=D,D=D.return;return r.tag===3?(D=r.stateNode,P&&o!==null&&(P=31-Bi(p),r=D.hiddenUpdates,w=r[P],w===null?r[P]=[o]:w.push(o),o.lane=p|536870912),D):null}function Ha(r){if(50<au)throw au=0,kd=null,Error(l(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Sr={};function Eu(r,o,p,w){this.tag=r,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(r,o,p,w){return new Eu(r,o,p,w)}function $l(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Xr(r,o){var p=r.alternate;return p===null?(p=er(r.tag,o,r.key,r.mode),p.elementType=r.elementType,p.type=r.type,p.stateNode=r.stateNode,p.alternate=r,r.alternate=p):(p.pendingProps=o,p.type=r.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=r.flags&65011712,p.childLanes=r.childLanes,p.lanes=r.lanes,p.child=r.child,p.memoizedProps=r.memoizedProps,p.memoizedState=r.memoizedState,p.updateQueue=r.updateQueue,o=r.dependencies,p.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},p.sibling=r.sibling,p.index=r.index,p.ref=r.ref,p.refCleanup=r.refCleanup,p}function ac(r,o){r.flags&=65011714;var p=r.alternate;return p===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=p.childLanes,r.lanes=p.lanes,r.child=p.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=p.memoizedProps,r.memoizedState=p.memoizedState,r.updateQueue=p.updateQueue,r.type=p.type,o=p.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function fl(r,o,p,w,P,D){var W=0;if(w=r,typeof r=="function")$l(r)&&(W=1);else if(typeof r=="string")W=Eo(r,p,ot.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case He:return r=er(31,p,o,P),r.elementType=He,r.lanes=D,r;case ne:return Kr(p.children,P,D,o);case ve:W=8,P|=24;break;case re:return r=er(12,p,o,P|2),r.elementType=re,r.lanes=D,r;case ye:return r=er(13,p,o,P),r.elementType=ye,r.lanes=D,r;case ke:return r=er(19,p,o,P),r.elementType=ke,r.lanes=D,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case oe:W=10;break e;case ge:W=9;break e;case me:W=11;break e;case Re:W=14;break e;case Ge:W=16,w=null;break e}W=29,p=Error(l(130,r===null?"null":typeof r,"")),w=null}return o=er(W,p,o,P),o.elementType=r,o.type=w,o.lanes=D,o}function Kr(r,o,p,w){return r=er(7,r,w,o),r.lanes=p,r}function pl(r,o,p){return r=er(6,r,null,o),r.lanes=p,r}function ml(r){var o=er(18,null,null,0);return o.stateNode=r,o}function oc(r,o,p){return o=er(4,r.children!==null?r.children:[],r.key,o),o.lanes=p,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var u=new WeakMap;function b(r,o){if(typeof r=="object"&&r!==null){var p=u.get(r);return p!==void 0?p:(o={value:r,source:o,stack:qn(o)},u.set(r,o),o)}return{value:r,source:o,stack:qn(o)}}var M=[],$=0,Z=null,ce=0,Ae=[],Je=0,dt=null,wt=1,Yt="";function _i(r,o){M[$++]=ce,M[$++]=Z,Z=r,ce=o}function un(r,o,p){Ae[Je++]=wt,Ae[Je++]=Yt,Ae[Je++]=dt,dt=r;var w=wt;r=Yt;var P=32-Bi(w)-1;w&=~(1<<P),p+=1;var D=32-Bi(o)+P;if(30<D){var W=P-P%5;D=(w&(1<<W)-1).toString(32),w>>=W,P-=W,wt=1<<32-Bi(o)+P|p<<P|w,Yt=D+r}else wt=1<<D|p<<P|w,Yt=r}function Ws(r){r.return!==null&&(_i(r,1),un(r,1,0))}function Es(r){for(;r===Z;)Z=M[--$],M[$]=null,ce=M[--$],M[$]=null;for(;r===dt;)dt=Ae[--Je],Ae[Je]=null,Yt=Ae[--Je],Ae[Je]=null,wt=Ae[--Je],Ae[Je]=null}function Tr(r,o){Ae[Je++]=wt,Ae[Je++]=Yt,Ae[Je++]=dt,wt=o.id,Yt=o.overflow,dt=r}var bn=null,Yi=null,Lt=!1,Ma=null,zr=!1,lc=Error(l(519));function Jr(r){var o=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gl(b(o,r)),lc}function Do(r){var o=r.stateNode,p=r.type,w=r.memoizedProps;switch(o[At]=r,o[ti]=w,p){case"dialog":Mn("cancel",o),Mn("close",o);break;case"iframe":case"object":case"embed":Mn("load",o);break;case"video":case"audio":for(p=0;p<Rh.length;p++)Mn(Rh[p],o);break;case"source":Mn("error",o);break;case"img":case"image":case"link":Mn("error",o),Mn("load",o);break;case"details":Mn("toggle",o);break;case"input":Mn("invalid",o),mn(o,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":Mn("invalid",o);break;case"textarea":Mn("invalid",o),Co(o,w.value,w.defaultValue,w.children)}p=w.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||o.textContent===""+p||w.suppressHydrationWarning===!0||zh(o.textContent,p)?(w.popover!=null&&(Mn("beforetoggle",o),Mn("toggle",o)),w.onScroll!=null&&Mn("scroll",o),w.onScrollEnd!=null&&Mn("scrollend",o),w.onClick!=null&&(o.onclick=qs),o=!0):o=!1,o||Jr(r,!0)}function _s(r){for(bn=r.return;bn;)switch(bn.tag){case 5:case 31:case 13:zr=!1;return;case 27:case 3:zr=!0;return;default:bn=bn.return}}function Oi(r){if(r!==bn)return!1;if(!Lt)return _s(r),Lt=!0,!1;var o=r.tag,p;if((p=o!==3&&o!==27)&&((p=o===5)&&(p=r.type,p=!(p!=="form"&&p!=="button")||j(r.type,r.memoizedProps)),p=!p),p&&Yi&&Jr(r),_s(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(l(317));Yi=di(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(l(317));Yi=di(r)}else o===27?(o=Yi,de(r.type)?(r=Wt,Wt=null,Yi=r):Yi=o):Yi=bn?Vt(r.stateNode.nextSibling):null;return!0}function yo(){Yi=bn=null,Lt=!1}function ku(){var r=Ma;return r!==null&&(Ia===null?Ia=r:Ia.push.apply(Ia,r),Ma=null),r}function gl(r){Ma===null?Ma=[r]:Ma.push(r)}var cc=xe(null),Qr=null,Za=null;function Oo(r,o,p){st(cc,o._currentValue),o._currentValue=p}function No(r){r._currentValue=cc.current,Ce(cc)}function ed(r,o,p){for(;r!==null;){var w=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,w!==null&&(w.childLanes|=o)):w!==null&&(w.childLanes&o)!==o&&(w.childLanes|=o),r===p)break;r=r.return}}function Cu(r,o,p,w){var P=r.child;for(P!==null&&(P.return=r);P!==null;){var D=P.dependencies;if(D!==null){var W=P.child;D=D.firstContext;e:for(;D!==null;){var pe=D;D=P;for(var De=0;De<o.length;De++)if(pe.context===o[De]){D.lanes|=p,pe=D.alternate,pe!==null&&(pe.lanes|=p),ed(D.return,p,r),w||(W=null);break e}D=pe.next}}else if(P.tag===18){if(W=P.return,W===null)throw Error(l(341));W.lanes|=p,D=W.alternate,D!==null&&(D.lanes|=p),ed(W,p,r),W=null}else W=P.child;if(W!==null)W.return=P;else for(W=P;W!==null;){if(W===r){W=null;break}if(P=W.sibling,P!==null){P.return=W.return,W=P;break}W=W.return}P=W}}function qc(r,o,p,w){r=null;for(var P=o,D=!1;P!==null;){if(!D){if((P.flags&524288)!==0)D=!0;else if((P.flags&262144)!==0)break}if(P.tag===10){var W=P.alternate;if(W===null)throw Error(l(387));if(W=W.memoizedProps,W!==null){var pe=P.type;Gs(P.pendingProps.value,W.value)||(r!==null?r.push(pe):r=[pe])}}else if(P===It.current){if(W=P.alternate,W===null)throw Error(l(387));W.memoizedState.memoizedState!==P.memoizedState.memoizedState&&(r!==null?r.push(Nh):r=[Nh])}P=P.return}r!==null&&Cu(o,r,p,w),o.flags|=262144}function oh(r){for(r=r.firstContext;r!==null;){if(!Gs(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function tr(r){Qr=r,Za=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function nn(r){return Au(Qr,r)}function yl(r,o){return Qr===null&&tr(r),Au(r,o)}function Au(r,o){var p=o._currentValue;if(o={context:o,memoizedValue:p,next:null},Za===null){if(r===null)throw Error(l(308));Za=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Za=Za.next=o;return p}var lh=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(p,w){r.push(w)}};this.abort=function(){o.aborted=!0,r.forEach(function(p){return p()})}},rf=t.unstable_scheduleCallback,Mu=t.unstable_NormalPriority,ws={$$typeof:oe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ga(){return{controller:new lh,data:new Map,refCount:0}}function _l(r){r.refCount--,r.refCount===0&&rf(Mu,function(){r.controller.abort()})}var oi=null,vi=0,vl=0,xl=null;function td(r,o){if(oi===null){var p=oi=[];vi=0,vl=Lh(),xl={status:"pending",value:void 0,then:function(w){p.push(w)}}}return vi++,o.then(E,E),o}function E(){if(--vi===0&&oi!==null){xl!==null&&(xl.status="fulfilled");var r=oi;oi=null,vl=0,xl=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function i(r,o){var p=[],w={status:"pending",value:null,reason:null,then:function(P){p.push(P)}};return r.then(function(){w.status="fulfilled",w.value=o;for(var P=0;P<p.length;P++)(0,p[P])(o)},function(P){for(w.status="rejected",w.reason=P,P=0;P<p.length;P++)(0,p[P])(void 0)}),w}var h=$e.S;$e.S=function(r,o){Lg=Xi(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&td(r,o),h!==null&&h(r,o)};var g=xe(null);function v(){var r=g.current;return r!==null?r:ps.pooledCache}function T(r,o){o===null?st(g,g.current):st(g,o.pool)}function R(){var r=v();return r===null?null:{parent:ws._currentValue,pool:r}}var O=Error(l(460)),U=Error(l(474)),H=Error(l(542)),Y={then:function(){}};function X(r){return r=r.status,r==="fulfilled"||r==="rejected"}function le(r,o,p){switch(p=r[p],p===void 0?r.push(o):p!==o&&(o.then(qs,qs),o=p),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Pe(r),r;default:if(typeof o.status=="string")o.then(qs,qs);else{if(r=ps,r!==null&&100<r.shellSuspendCounter)throw Error(l(482));r=o,r.status="pending",r.then(function(w){if(o.status==="pending"){var P=o;P.status="fulfilled",P.value=w}},function(w){if(o.status==="pending"){var P=o;P.status="rejected",P.reason=w}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Pe(r),r}throw _e=o,O}}function fe(r){try{var o=r._init;return o(r._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(_e=p,O):p}}var _e=null;function Ee(){if(_e===null)throw Error(l(459));var r=_e;return _e=null,r}function Pe(r){if(r===O||r===H)throw Error(l(483))}var Ie=null,ze=0;function Se(r){var o=ze;return ze+=1,Ie===null&&(Ie=[]),le(Ie,r,o)}function Fe(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Ye(r,o){throw o.$$typeof===V?Error(l(525)):(r=Object.prototype.toString.call(o),Error(l(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function rt(r){function o(nt,qe){if(r){var ht=nt.deletions;ht===null?(nt.deletions=[qe],nt.flags|=16):ht.push(qe)}}function p(nt,qe){if(!r)return null;for(;qe!==null;)o(nt,qe),qe=qe.sibling;return null}function w(nt){for(var qe=new Map;nt!==null;)nt.key!==null?qe.set(nt.key,nt):qe.set(nt.index,nt),nt=nt.sibling;return qe}function P(nt,qe){return nt=Xr(nt,qe),nt.index=0,nt.sibling=null,nt}function D(nt,qe,ht){return nt.index=ht,r?(ht=nt.alternate,ht!==null?(ht=ht.index,ht<qe?(nt.flags|=67108866,qe):ht):(nt.flags|=67108866,qe)):(nt.flags|=1048576,qe)}function W(nt){return r&&nt.alternate===null&&(nt.flags|=67108866),nt}function pe(nt,qe,ht,Mt){return qe===null||qe.tag!==6?(qe=pl(ht,nt.mode,Mt),qe.return=nt,qe):(qe=P(qe,ht),qe.return=nt,qe)}function De(nt,qe,ht,Mt){var Ri=ht.type;return Ri===ne?St(nt,qe,ht.props.children,Mt,ht.key):qe!==null&&(qe.elementType===Ri||typeof Ri=="object"&&Ri!==null&&Ri.$$typeof===Ge&&fe(Ri)===qe.type)?(qe=P(qe,ht.props),Fe(qe,ht),qe.return=nt,qe):(qe=fl(ht.type,ht.key,ht.props,null,nt.mode,Mt),Fe(qe,ht),qe.return=nt,qe)}function ft(nt,qe,ht,Mt){return qe===null||qe.tag!==4||qe.stateNode.containerInfo!==ht.containerInfo||qe.stateNode.implementation!==ht.implementation?(qe=oc(ht,nt.mode,Mt),qe.return=nt,qe):(qe=P(qe,ht.children||[]),qe.return=nt,qe)}function St(nt,qe,ht,Mt,Ri){return qe===null||qe.tag!==7?(qe=Kr(ht,nt.mode,Mt,Ri),qe.return=nt,qe):(qe=P(qe,ht),qe.return=nt,qe)}function Rt(nt,qe,ht){if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return qe=pl(""+qe,nt.mode,ht),qe.return=nt,qe;if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case K:return ht=fl(qe.type,qe.key,qe.props,null,nt.mode,ht),Fe(ht,qe),ht.return=nt,ht;case se:return qe=oc(qe,nt.mode,ht),qe.return=nt,qe;case Ge:return qe=fe(qe),Rt(nt,qe,ht)}if(pt(qe)||et(qe))return qe=Kr(qe,nt.mode,ht,null),qe.return=nt,qe;if(typeof qe.then=="function")return Rt(nt,Se(qe),ht);if(qe.$$typeof===oe)return Rt(nt,yl(nt,qe),ht);Ye(nt,qe)}return null}function mt(nt,qe,ht,Mt){var Ri=qe!==null?qe.key:null;if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return Ri!==null?null:pe(nt,qe,""+ht,Mt);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case K:return ht.key===Ri?De(nt,qe,ht,Mt):null;case se:return ht.key===Ri?ft(nt,qe,ht,Mt):null;case Ge:return ht=fe(ht),mt(nt,qe,ht,Mt)}if(pt(ht)||et(ht))return Ri!==null?null:St(nt,qe,ht,Mt,null);if(typeof ht.then=="function")return mt(nt,qe,Se(ht),Mt);if(ht.$$typeof===oe)return mt(nt,qe,yl(nt,ht),Mt);Ye(nt,ht)}return null}function vt(nt,qe,ht,Mt,Ri){if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint")return nt=nt.get(ht)||null,pe(qe,nt,""+Mt,Ri);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case K:return nt=nt.get(Mt.key===null?ht:Mt.key)||null,De(qe,nt,Mt,Ri);case se:return nt=nt.get(Mt.key===null?ht:Mt.key)||null,ft(qe,nt,Mt,Ri);case Ge:return Mt=fe(Mt),vt(nt,qe,ht,Mt,Ri)}if(pt(Mt)||et(Mt))return nt=nt.get(ht)||null,St(qe,nt,Mt,Ri,null);if(typeof Mt.then=="function")return vt(nt,qe,ht,Se(Mt),Ri);if(Mt.$$typeof===oe)return vt(nt,qe,ht,yl(qe,Mt),Ri);Ye(qe,Mt)}return null}function mi(nt,qe,ht,Mt){for(var Ri=null,rs=null,Si=qe,wn=qe=0,Bn=null;Si!==null&&wn<ht.length;wn++){Si.index>wn?(Bn=Si,Si=null):Bn=Si.sibling;var as=mt(nt,Si,ht[wn],Mt);if(as===null){Si===null&&(Si=Bn);break}r&&Si&&as.alternate===null&&o(nt,Si),qe=D(as,qe,wn),rs===null?Ri=as:rs.sibling=as,rs=as,Si=Bn}if(wn===ht.length)return p(nt,Si),Lt&&_i(nt,wn),Ri;if(Si===null){for(;wn<ht.length;wn++)Si=Rt(nt,ht[wn],Mt),Si!==null&&(qe=D(Si,qe,wn),rs===null?Ri=Si:rs.sibling=Si,rs=Si);return Lt&&_i(nt,wn),Ri}for(Si=w(Si);wn<ht.length;wn++)Bn=vt(Si,nt,wn,ht[wn],Mt),Bn!==null&&(r&&Bn.alternate!==null&&Si.delete(Bn.key===null?wn:Bn.key),qe=D(Bn,qe,wn),rs===null?Ri=Bn:rs.sibling=Bn,rs=Bn);return r&&Si.forEach(function($h){return o(nt,$h)}),Lt&&_i(nt,wn),Ri}function Ni(nt,qe,ht,Mt){if(ht==null)throw Error(l(151));for(var Ri=null,rs=null,Si=qe,wn=qe=0,Bn=null,as=ht.next();Si!==null&&!as.done;wn++,as=ht.next()){Si.index>wn?(Bn=Si,Si=null):Bn=Si.sibling;var $h=mt(nt,Si,as.value,Mt);if($h===null){Si===null&&(Si=Bn);break}r&&Si&&$h.alternate===null&&o(nt,Si),qe=D($h,qe,wn),rs===null?Ri=$h:rs.sibling=$h,rs=$h,Si=Bn}if(as.done)return p(nt,Si),Lt&&_i(nt,wn),Ri;if(Si===null){for(;!as.done;wn++,as=ht.next())as=Rt(nt,as.value,Mt),as!==null&&(qe=D(as,qe,wn),rs===null?Ri=as:rs.sibling=as,rs=as);return Lt&&_i(nt,wn),Ri}for(Si=w(Si);!as.done;wn++,as=ht.next())as=vt(Si,nt,wn,as.value,Mt),as!==null&&(r&&as.alternate!==null&&Si.delete(as.key===null?wn:as.key),qe=D(as,qe,wn),rs===null?Ri=as:rs.sibling=as,rs=as);return r&&Si.forEach(function(M2){return o(nt,M2)}),Lt&&_i(nt,wn),Ri}function Ss(nt,qe,ht,Mt){if(typeof ht=="object"&&ht!==null&&ht.type===ne&&ht.key===null&&(ht=ht.props.children),typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case K:e:{for(var Ri=ht.key;qe!==null;){if(qe.key===Ri){if(Ri=ht.type,Ri===ne){if(qe.tag===7){p(nt,qe.sibling),Mt=P(qe,ht.props.children),Mt.return=nt,nt=Mt;break e}}else if(qe.elementType===Ri||typeof Ri=="object"&&Ri!==null&&Ri.$$typeof===Ge&&fe(Ri)===qe.type){p(nt,qe.sibling),Mt=P(qe,ht.props),Fe(Mt,ht),Mt.return=nt,nt=Mt;break e}p(nt,qe);break}else o(nt,qe);qe=qe.sibling}ht.type===ne?(Mt=Kr(ht.props.children,nt.mode,Mt,ht.key),Mt.return=nt,nt=Mt):(Mt=fl(ht.type,ht.key,ht.props,null,nt.mode,Mt),Fe(Mt,ht),Mt.return=nt,nt=Mt)}return W(nt);case se:e:{for(Ri=ht.key;qe!==null;){if(qe.key===Ri)if(qe.tag===4&&qe.stateNode.containerInfo===ht.containerInfo&&qe.stateNode.implementation===ht.implementation){p(nt,qe.sibling),Mt=P(qe,ht.children||[]),Mt.return=nt,nt=Mt;break e}else{p(nt,qe);break}else o(nt,qe);qe=qe.sibling}Mt=oc(ht,nt.mode,Mt),Mt.return=nt,nt=Mt}return W(nt);case Ge:return ht=fe(ht),Ss(nt,qe,ht,Mt)}if(pt(ht))return mi(nt,qe,ht,Mt);if(et(ht)){if(Ri=et(ht),typeof Ri!="function")throw Error(l(150));return ht=Ri.call(ht),Ni(nt,qe,ht,Mt)}if(typeof ht.then=="function")return Ss(nt,qe,Se(ht),Mt);if(ht.$$typeof===oe)return Ss(nt,qe,yl(nt,ht),Mt);Ye(nt,ht)}return typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint"?(ht=""+ht,qe!==null&&qe.tag===6?(p(nt,qe.sibling),Mt=P(qe,ht),Mt.return=nt,nt=Mt):(p(nt,qe),Mt=pl(ht,nt.mode,Mt),Mt.return=nt,nt=Mt),W(nt)):p(nt,qe)}return function(nt,qe,ht,Mt){try{ze=0;var Ri=Ss(nt,qe,ht,Mt);return Ie=null,Ri}catch(Si){if(Si===O||Si===H)throw Si;var rs=er(29,Si,null,nt.mode);return rs.lanes=Mt,rs.return=nt,rs}}}var bt=rt(!0),$t=rt(!1),Ht=!1;function Qt(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zt(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ut(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ni(r,o,p){var w=r.updateQueue;if(w===null)return null;if(w=w.shared,(Wn&2)!==0){var P=w.pending;return P===null?o.next=o:(o.next=P.next,P.next=o),w.pending=o,o=Ha(r),go(r,null,p),o}return Ls(r,w,o,p),Ha(r)}function ki(r,o,p){if(o=o.updateQueue,o!==null&&(o=o.shared,(p&4194048)!==0)){var w=o.lanes;w&=r.pendingLanes,p|=w,o.lanes=p,Le(r,p)}}function Gt(r,o){var p=r.updateQueue,w=r.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var P=null,D=null;if(p=p.firstBaseUpdate,p!==null){do{var W={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};D===null?P=D=W:D=D.next=W,p=p.next}while(p!==null);D===null?P=D=o:D=D.next=o}else P=D=o;p={baseState:w.baseState,firstBaseUpdate:P,lastBaseUpdate:D,shared:w.shared,callbacks:w.callbacks},r.updateQueue=p;return}r=p.lastBaseUpdate,r===null?p.firstBaseUpdate=o:r.next=o,p.lastBaseUpdate=o}var Xt=!1;function Ei(){if(Xt){var r=xl;if(r!==null)throw r}}function Gn(r,o,p,w){Xt=!1;var P=r.updateQueue;Ht=!1;var D=P.firstBaseUpdate,W=P.lastBaseUpdate,pe=P.shared.pending;if(pe!==null){P.shared.pending=null;var De=pe,ft=De.next;De.next=null,W===null?D=ft:W.next=ft,W=De;var St=r.alternate;St!==null&&(St=St.updateQueue,pe=St.lastBaseUpdate,pe!==W&&(pe===null?St.firstBaseUpdate=ft:pe.next=ft,St.lastBaseUpdate=De))}if(D!==null){var Rt=P.baseState;W=0,St=ft=De=null,pe=D;do{var mt=pe.lane&-536870913,vt=mt!==pe.lane;if(vt?(kn&mt)===mt:(w&mt)===mt){mt!==0&&mt===vl&&(Xt=!0),St!==null&&(St=St.next={lane:0,tag:pe.tag,payload:pe.payload,callback:null,next:null});e:{var mi=r,Ni=pe;mt=o;var Ss=p;switch(Ni.tag){case 1:if(mi=Ni.payload,typeof mi=="function"){Rt=mi.call(Ss,Rt,mt);break e}Rt=mi;break e;case 3:mi.flags=mi.flags&-65537|128;case 0:if(mi=Ni.payload,mt=typeof mi=="function"?mi.call(Ss,Rt,mt):mi,mt==null)break e;Rt=N({},Rt,mt);break e;case 2:Ht=!0}}mt=pe.callback,mt!==null&&(r.flags|=64,vt&&(r.flags|=8192),vt=P.callbacks,vt===null?P.callbacks=[mt]:vt.push(mt))}else vt={lane:mt,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},St===null?(ft=St=vt,De=Rt):St=St.next=vt,W|=mt;if(pe=pe.next,pe===null){if(pe=P.shared.pending,pe===null)break;vt=pe,pe=vt.next,vt.next=null,P.lastBaseUpdate=vt,P.shared.pending=null}}while(!0);St===null&&(De=Rt),P.baseState=De,P.firstBaseUpdate=ft,P.lastBaseUpdate=St,D===null&&(P.shared.lanes=0),ru|=W,r.lanes=W,r.memoizedState=Rt}}function Zi(r,o){if(typeof r!="function")throw Error(l(191,r));r.call(o)}function dn(r,o){var p=r.callbacks;if(p!==null)for(r.callbacks=null,r=0;r<p.length;r++)Zi(p[r],o)}var Fn=xe(null),ir=xe(0);function Wa(r,o){r=Fo,st(ir,r),st(Fn,o),Fo=r|o.baseLanes}function ts(){st(ir,Fo),st(Fn,Fn.current)}function Dr(){Fo=ir.current,Ce(Fn),Ce(ir)}var ls=xe(null),cs=null;function Rs(r){var o=r.alternate;st(Nn,Nn.current&1),st(ls,r),cs===null&&(o===null||Fn.current!==null||o.memoizedState!==null)&&(cs=r)}function Ya(r){st(Nn,Nn.current),st(ls,r),cs===null&&(cs=r)}function uc(r){r.tag===22?(st(Nn,Nn.current),st(ls,r),cs===null&&(cs=r)):_o()}function _o(){st(Nn,Nn.current),st(ls,ls.current)}function or(r){Ce(ls),cs===r&&(cs=null),Ce(Nn)}var Nn=xe(0);function hc(r){for(var o=r;o!==null;){if(o.tag===13){var p=o.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||zt(p)||Kt(p)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var vo=0,Pi=null,yn=null,us=null,ma=!1,zs=!1,Ds=!1,Or=0,sn=0,Xa=null,Hc=0;function hs(){throw Error(l(321))}function ch(r,o){if(o===null)return!1;for(var p=0;p<o.length&&p<r.length;p++)if(!Gs(r[p],o[p]))return!1;return!0}function id(r,o,p,w,P,D){return vo=D,Pi=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,$e.H=r===null||r.memoizedState===null?ug:Lp,Ds=!1,D=p(w,P),Ds=!1,zs&&(D=bl(o,p,w,P)),nd(r),D}function nd(r){$e.H=ud;var o=yn!==null&&yn.next!==null;if(vo=0,us=yn=Pi=null,ma=!1,sn=0,Xa=null,o)throw Error(l(300));r===null||Us||(r=r.dependencies,r!==null&&oh(r)&&(Us=!0))}function bl(r,o,p,w){Pi=r;var P=0;do{if(zs&&(Xa=null),sn=0,zs=!1,25<=P)throw Error(l(301));if(P+=1,us=yn=null,r.updateQueue!=null){var D=r.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}$e.H=Rp,D=o(p,w)}while(zs);return D}function af(){var r=$e.H,o=r.useState()[0];return o=typeof o.then=="function"?Wc(o):o,r=r.useState()[0],(yn!==null?yn.memoizedState:null)!==r&&(Pi.flags|=1024),o}function Zc(){var r=Or!==0;return Or=0,r}function dc(r,o,p){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~p}function Gc(r){if(ma){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}ma=!1}vo=0,us=yn=Pi=null,zs=!1,sn=Or=0,Xa=null}function lr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return us===null?Pi.memoizedState=us=r:us=us.next=r,us}function fs(){if(yn===null){var r=Pi.alternate;r=r!==null?r.memoizedState:null}else r=yn.next;var o=us===null?Pi.memoizedState:us.next;if(o!==null)us=o,yn=r;else{if(r===null)throw Pi.alternate===null?Error(l(467)):Error(l(310));yn=r,r={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},us===null?Pi.memoizedState=us=r:us=us.next=r}return us}function Ul(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wc(r){var o=sn;return sn+=1,Xa===null&&(Xa=[]),r=le(Xa,r,o),o=Pi,(us===null?o.memoizedState:us.next)===null&&(o=o.alternate,$e.H=o===null||o.memoizedState===null?ug:Lp),r}function sd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Wc(r);if(r.$$typeof===oe)return nn(r)}throw Error(l(438,String(r)))}function of(r){var o=null,p=Pi.updateQueue;if(p!==null&&(o=p.memoCache),o==null){var w=Pi.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(o={data:w.data.map(function(P){return P.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),p===null&&(p=Ul(),Pi.updateQueue=p),p.memoCache=o,p=o.data[o.index],p===void 0)for(p=o.data[o.index]=Array(r),w=0;w<r;w++)p[w]=Xe;return o.index++,p}function fc(r,o){return typeof o=="function"?o(r):o}function uh(r){var o=fs();return Pu(o,yn,r)}function Pu(r,o,p){var w=r.queue;if(w===null)throw Error(l(311));w.lastRenderedReducer=p;var P=r.baseQueue,D=w.pending;if(D!==null){if(P!==null){var W=P.next;P.next=D.next,D.next=W}o.baseQueue=P=D,w.pending=null}if(D=r.baseState,P===null)r.memoizedState=D;else{o=P.next;var pe=W=null,De=null,ft=o,St=!1;do{var Rt=ft.lane&-536870913;if(Rt!==ft.lane?(kn&Rt)===Rt:(vo&Rt)===Rt){var mt=ft.revertLane;if(mt===0)De!==null&&(De=De.next={lane:0,revertLane:0,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),Rt===vl&&(St=!0);else if((vo&mt)===mt){ft=ft.next,mt===vl&&(St=!0);continue}else Rt={lane:0,revertLane:ft.revertLane,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},De===null?(pe=De=Rt,W=D):De=De.next=Rt,Pi.lanes|=mt,ru|=mt;Rt=ft.action,Ds&&p(D,Rt),D=ft.hasEagerState?ft.eagerState:p(D,Rt)}else mt={lane:Rt,revertLane:ft.revertLane,gesture:ft.gesture,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},De===null?(pe=De=mt,W=D):De=De.next=mt,Pi.lanes|=Rt,ru|=Rt;ft=ft.next}while(ft!==null&&ft!==o);if(De===null?W=D:De.next=pe,!Gs(D,r.memoizedState)&&(Us=!0,St&&(p=xl,p!==null)))throw p;r.memoizedState=D,r.baseState=W,r.baseQueue=De,w.lastRenderedState=D}return P===null&&(w.lanes=0),[r.memoizedState,w.dispatch]}function Yc(r){var o=fs(),p=o.queue;if(p===null)throw Error(l(311));p.lastRenderedReducer=r;var w=p.dispatch,P=p.pending,D=o.memoizedState;if(P!==null){p.pending=null;var W=P=P.next;do D=r(D,W.action),W=W.next;while(W!==P);Gs(D,o.memoizedState)||(Us=!0),o.memoizedState=D,o.baseQueue===null&&(o.baseState=D),p.lastRenderedState=D}return[D,w]}function Fl(r,o,p){var w=Pi,P=fs(),D=Lt;if(D){if(p===void 0)throw Error(l(407));p=p()}else p=o();var W=!Gs((yn||P).memoizedState,p);if(W&&(P.memoizedState=p,Us=!0),P=P.queue,Iu(yp.bind(null,w,P,r),[r]),P.getSnapshot!==o||W||us!==null&&us.memoizedState.tag&1){if(w.flags|=2048,Qc(9,{destroy:void 0},pc.bind(null,w,P,p,o),null),ps===null)throw Error(l(349));D||(vo&127)!==0||Bo(w,o,p)}return p}function Bo(r,o,p){r.flags|=16384,r={getSnapshot:o,value:p},o=Pi.updateQueue,o===null?(o=Ul(),Pi.updateQueue=o,o.stores=[r]):(p=o.stores,p===null?o.stores=[r]:p.push(r))}function pc(r,o,p,w){o.value=p,o.getSnapshot=w,Xc(o)&&ig(r)}function yp(r,o,p){return p(function(){Xc(o)&&ig(r)})}function Xc(r){var o=r.getSnapshot;r=r.value;try{var p=o();return!Gs(r,p)}catch{return!0}}function ig(r){var o=pa(r,2);o!==null&&ga(o,r,2)}function lf(r){var o=lr();if(typeof r=="function"){var p=r;if(r=p(),Ds){Jt(!0);try{p()}finally{Jt(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:r},o}function $s(r,o,p,w){return r.baseState=p,Pu(r,yn,typeof w=="function"?w:fc)}function _p(r,o,p,w,P){if(pf(r))throw Error(l(485));if(r=o.action,r!==null){var D={payload:P,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){D.listeners.push(W)}};$e.T!==null?p(!0):D.isTransition=!1,w(D),p=o.pending,p===null?(D.next=o.pending=D,vp(o,D)):(D.next=p.next,o.pending=p.next=D)}}function vp(r,o){var p=o.action,w=o.payload,P=r.state;if(o.isTransition){var D=$e.T,W={};$e.T=W;try{var pe=p(P,w),De=$e.S;De!==null&&De(W,pe),Kc(r,o,pe)}catch(ft){hh(r,o,ft)}finally{D!==null&&W.types!==null&&(D.types=W.types),$e.T=D}}else try{D=p(P,w),Kc(r,o,D)}catch(ft){hh(r,o,ft)}}function Kc(r,o,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(w){Jc(r,o,w)},function(w){return hh(r,o,w)}):Jc(r,o,p)}function Jc(r,o,p){o.status="fulfilled",o.value=p,cf(o),r.state=p,o=r.pending,o!==null&&(p=o.next,p===o?r.pending=null:(p=p.next,o.next=p,vp(r,p)))}function hh(r,o,p){var w=r.pending;if(r.pending=null,w!==null){w=w.next;do o.status="rejected",o.reason=p,cf(o),o=o.next;while(o!==w)}r.action=null}function cf(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function xp(r,o){return o}function ng(r,o){if(Lt){var p=ps.formState;if(p!==null){e:{var w=Pi;if(Lt){if(Yi){t:{for(var P=Yi,D=zr;P.nodeType!==8;){if(!D){P=null;break t}if(P=Vt(P.nextSibling),P===null){P=null;break t}}D=P.data,P=D==="F!"||D==="F"?P:null}if(P){Yi=Vt(P.nextSibling),w=P.data==="F!";break e}}Jr(w)}w=!1}w&&(o=p[0])}}return p=lr(),p.memoizedState=p.baseState=o,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xp,lastRenderedState:o},p.queue=w,p=Ka.bind(null,Pi,w),w.dispatch=p,w=lf(!1),D=cd.bind(null,Pi,!1,w.queue),w=lr(),P={state:o,dispatch:null,action:r,pending:null},w.queue=P,p=_p.bind(null,Pi,P,D,p),P.dispatch=p,w.memoizedState=r,[o,p,!1]}function bp(r){var o=fs();return sg(o,yn,r)}function sg(r,o,p){if(o=Pu(r,o,xp)[0],r=uh(fc)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var w=Wc(o)}catch(W){throw W===O?H:W}else w=o;o=fs();var P=o.queue,D=P.dispatch;return p!==o.memoizedState&&(Pi.flags|=2048,Qc(9,{destroy:void 0},wp.bind(null,P,p),null)),[w,D,r]}function wp(r,o){r.action=o}function rg(r){var o=fs(),p=yn;if(p!==null)return sg(o,p,r);fs(),o=o.memoizedState,p=fs();var w=p.queue.dispatch;return p.memoizedState=r,[o,w,!1]}function Qc(r,o,p,w){return r={tag:r,create:p,deps:w,inst:o,next:null},o=Pi.updateQueue,o===null&&(o=Ul(),Pi.updateQueue=o),p=o.lastEffect,p===null?o.lastEffect=r.next=r:(w=p.next,p.next=r,r.next=w,o.lastEffect=r),r}function Sp(){return fs().memoizedState}function rd(r,o,p,w){var P=lr();Pi.flags|=r,P.memoizedState=Qc(1|o,{destroy:void 0},p,w===void 0?null:w)}function mc(r,o,p,w){var P=fs();w=w===void 0?null:w;var D=P.memoizedState.inst;yn!==null&&w!==null&&ch(w,yn.memoizedState.deps)?P.memoizedState=Qc(o,D,p,w):(Pi.flags|=r,P.memoizedState=Qc(1|o,D,p,w))}function ag(r,o){rd(8390656,8,r,o)}function Iu(r,o){mc(2048,8,r,o)}function uf(r){Pi.flags|=4;var o=Pi.updateQueue;if(o===null)o=Ul(),Pi.updateQueue=o,o.events=[r];else{var p=o.events;p===null?o.events=[r]:p.push(r)}}function ad(r){var o=fs().memoizedState;return uf({ref:o,nextImpl:r}),function(){if((Wn&2)!==0)throw Error(l(440));return o.impl.apply(void 0,arguments)}}function Tp(r,o){return mc(4,2,r,o)}function Ep(r,o){return mc(4,4,r,o)}function og(r,o){if(typeof o=="function"){r=r();var p=o(r);return function(){typeof p=="function"?p():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function ea(r,o,p){p=p!=null?p.concat([r]):null,mc(4,4,og.bind(null,o,r),p)}function eu(){}function hf(r,o){var p=fs();o=o===void 0?null:o;var w=p.memoizedState;return o!==null&&ch(o,w[1])?w[0]:(p.memoizedState=[r,o],r)}function kp(r,o){var p=fs();o=o===void 0?null:o;var w=p.memoizedState;if(o!==null&&ch(o,w[1]))return w[0];if(w=r(),Ds){Jt(!0);try{r()}finally{Jt(!1)}}return p.memoizedState=[w,o],w}function ju(r,o,p){return p===void 0||(vo&1073741824)!==0&&(kn&261930)===0?r.memoizedState=o:(r.memoizedState=p,r=Ef(),Pi.lanes|=r,ru|=r,p)}function lg(r,o,p,w){return Gs(p,o)?p:Fn.current!==null?(r=ju(r,p,w),Gs(r,o)||(Us=!0),r):(vo&42)===0||(vo&1073741824)!==0&&(kn&261930)===0?(Us=!0,r.memoizedState=p):(r=Ef(),Pi.lanes|=r,ru|=r,o)}function od(r,o,p,w,P){var D=ct.p;ct.p=D!==0&&8>D?D:8;var W=$e.T,pe={};$e.T=pe,cd(r,!1,o,p);try{var De=P(),ft=$e.S;if(ft!==null&&ft(pe,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var St=i(De,w);dh(r,o,St,wo(r))}else dh(r,o,w,wo(r))}catch(Rt){dh(r,o,{then:function(){},status:"rejected",reason:Rt},wo())}finally{ct.p=D,W!==null&&pe.types!==null&&(W.types=pe.types),$e.T=W}}function __(){}function df(r,o,p,w){if(r.tag!==5)throw Error(l(476));var P=Cp(r).queue;od(r,P,o,We,p===null?__:function(){return Ap(r),p(w)})}function Cp(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:We,baseState:We,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:We},next:null};var p={};return o.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:p},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function Ap(r){var o=Cp(r);o.next===null&&(o=r.alternate.memoizedState),dh(r,o.next.queue,{},wo())}function Mp(){return nn(Nh)}function ff(){return fs().memoizedState}function Pp(){return fs().memoizedState}function Ip(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var p=wo();r=Ut(p);var w=ni(o,r,p);w!==null&&(ga(w,o,p),ki(w,o,p)),o={cache:Ga()},r.payload=o;return}o=o.return}}function ld(r,o,p){var w=wo();p={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},pf(r)?jp(o,p):(p=dl(r,o,p,w),p!==null&&(ga(p,r,w),cg(p,o,w)))}function Ka(r,o,p){var w=wo();dh(r,o,p,w)}function dh(r,o,p,w){var P={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(pf(r))jp(o,P);else{var D=r.alternate;if(r.lanes===0&&(D===null||D.lanes===0)&&(D=o.lastRenderedReducer,D!==null))try{var W=o.lastRenderedState,pe=D(W,p);if(P.hasEagerState=!0,P.eagerState=pe,Gs(pe,W))return Ls(r,o,P,0),ps===null&&wr(),!1}catch{}if(p=dl(r,o,P,w),p!==null)return ga(p,r,w),cg(p,o,w),!0}return!1}function cd(r,o,p,w){if(w={lane:2,revertLane:Lh(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},pf(r)){if(o)throw Error(l(479))}else o=dl(r,p,w,2),o!==null&&ga(o,r,2)}function pf(r){var o=r.alternate;return r===Pi||o!==null&&o===Pi}function jp(r,o){zs=ma=!0;var p=r.pending;p===null?o.next=o:(o.next=p.next,p.next=o),r.pending=o}function cg(r,o,p){if((p&4194048)!==0){var w=o.lanes;w&=r.pendingLanes,p|=w,o.lanes=p,Le(r,p)}}var ud={readContext:nn,use:sd,useCallback:hs,useContext:hs,useEffect:hs,useImperativeHandle:hs,useLayoutEffect:hs,useInsertionEffect:hs,useMemo:hs,useReducer:hs,useRef:hs,useState:hs,useDebugValue:hs,useDeferredValue:hs,useTransition:hs,useSyncExternalStore:hs,useId:hs,useHostTransitionStatus:hs,useFormState:hs,useActionState:hs,useOptimistic:hs,useMemoCache:hs,useCacheRefresh:hs};ud.useEffectEvent=hs;var ug={readContext:nn,use:sd,useCallback:function(r,o){return lr().memoizedState=[r,o===void 0?null:o],r},useContext:nn,useEffect:ag,useImperativeHandle:function(r,o,p){p=p!=null?p.concat([r]):null,rd(4194308,4,og.bind(null,o,r),p)},useLayoutEffect:function(r,o){return rd(4194308,4,r,o)},useInsertionEffect:function(r,o){rd(4,2,r,o)},useMemo:function(r,o){var p=lr();o=o===void 0?null:o;var w=r();if(Ds){Jt(!0);try{r()}finally{Jt(!1)}}return p.memoizedState=[w,o],w},useReducer:function(r,o,p){var w=lr();if(p!==void 0){var P=p(o);if(Ds){Jt(!0);try{p(o)}finally{Jt(!1)}}}else P=o;return w.memoizedState=w.baseState=P,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:P},w.queue=r,r=r.dispatch=ld.bind(null,Pi,r),[w.memoizedState,r]},useRef:function(r){var o=lr();return r={current:r},o.memoizedState=r},useState:function(r){r=lf(r);var o=r.queue,p=Ka.bind(null,Pi,o);return o.dispatch=p,[r.memoizedState,p]},useDebugValue:eu,useDeferredValue:function(r,o){var p=lr();return ju(p,r,o)},useTransition:function(){var r=lf(!1);return r=od.bind(null,Pi,r.queue,!0,!1),lr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,p){var w=Pi,P=lr();if(Lt){if(p===void 0)throw Error(l(407));p=p()}else{if(p=o(),ps===null)throw Error(l(349));(kn&127)!==0||Bo(w,o,p)}P.memoizedState=p;var D={value:p,getSnapshot:o};return P.queue=D,ag(yp.bind(null,w,D,r),[r]),w.flags|=2048,Qc(9,{destroy:void 0},pc.bind(null,w,D,p,o),null),p},useId:function(){var r=lr(),o=ps.identifierPrefix;if(Lt){var p=Yt,w=wt;p=(w&~(1<<32-Bi(w)-1)).toString(32)+p,o="_"+o+"R_"+p,p=Or++,0<p&&(o+="H"+p.toString(32)),o+="_"}else p=Hc++,o="_"+o+"r_"+p.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:Mp,useFormState:ng,useActionState:ng,useOptimistic:function(r){var o=lr();o.memoizedState=o.baseState=r;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=p,o=cd.bind(null,Pi,!0,p),p.dispatch=o,[r,o]},useMemoCache:of,useCacheRefresh:function(){return lr().memoizedState=Ip.bind(null,Pi)},useEffectEvent:function(r){var o=lr(),p={impl:r};return o.memoizedState=p,function(){if((Wn&2)!==0)throw Error(l(440));return p.impl.apply(void 0,arguments)}}},Lp={readContext:nn,use:sd,useCallback:hf,useContext:nn,useEffect:Iu,useImperativeHandle:ea,useInsertionEffect:Tp,useLayoutEffect:Ep,useMemo:kp,useReducer:uh,useRef:Sp,useState:function(){return uh(fc)},useDebugValue:eu,useDeferredValue:function(r,o){var p=fs();return lg(p,yn.memoizedState,r,o)},useTransition:function(){var r=uh(fc)[0],o=fs().memoizedState;return[typeof r=="boolean"?r:Wc(r),o]},useSyncExternalStore:Fl,useId:ff,useHostTransitionStatus:Mp,useFormState:bp,useActionState:bp,useOptimistic:function(r,o){var p=fs();return $s(p,yn,r,o)},useMemoCache:of,useCacheRefresh:Pp};Lp.useEffectEvent=ad;var Rp={readContext:nn,use:sd,useCallback:hf,useContext:nn,useEffect:Iu,useImperativeHandle:ea,useInsertionEffect:Tp,useLayoutEffect:Ep,useMemo:kp,useReducer:Yc,useRef:Sp,useState:function(){return Yc(fc)},useDebugValue:eu,useDeferredValue:function(r,o){var p=fs();return yn===null?ju(p,r,o):lg(p,yn.memoizedState,r,o)},useTransition:function(){var r=Yc(fc)[0],o=fs().memoizedState;return[typeof r=="boolean"?r:Wc(r),o]},useSyncExternalStore:Fl,useId:ff,useHostTransitionStatus:Mp,useFormState:rg,useActionState:rg,useOptimistic:function(r,o){var p=fs();return yn!==null?$s(p,yn,r,o):(p.baseState=r,[r,p.queue.dispatch])},useMemoCache:of,useCacheRefresh:Pp};Rp.useEffectEvent=ad;function mf(r,o,p,w){o=r.memoizedState,p=p(w,o),p=p==null?o:N({},o,p),r.memoizedState=p,r.lanes===0&&(r.updateQueue.baseState=p)}var gc={enqueueSetState:function(r,o,p){r=r._reactInternals;var w=wo(),P=Ut(w);P.payload=o,p!=null&&(P.callback=p),o=ni(r,P,w),o!==null&&(ga(o,r,w),ki(o,r,w))},enqueueReplaceState:function(r,o,p){r=r._reactInternals;var w=wo(),P=Ut(w);P.tag=1,P.payload=o,p!=null&&(P.callback=p),o=ni(r,P,w),o!==null&&(ga(o,r,w),ki(o,r,w))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var p=wo(),w=Ut(p);w.tag=2,o!=null&&(w.callback=o),o=ni(r,w,p),o!==null&&(ga(o,r,p),ki(o,r,p))}};function fh(r,o,p,w,P,D,W){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(w,D,W):o.prototype&&o.prototype.isPureReactComponent?!cn(p,w)||!cn(P,D):!0}function hg(r,o,p,w){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(p,w),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(p,w),o.state!==r&&gc.enqueueReplaceState(o,o.state,null)}function Lu(r,o){var p=o;if("ref"in o){p={};for(var w in o)w!=="ref"&&(p[w]=o[w])}if(r=r.defaultProps){p===o&&(p=N({},p));for(var P in r)p[P]===void 0&&(p[P]=r[P])}return p}function dg(r){Aa(r)}function fg(r){console.error(r)}function pg(r){Aa(r)}function gf(r,o){try{var p=r.onUncaughtError;p(o.value,{componentStack:o.stack})}catch(w){setTimeout(function(){throw w})}}function mg(r,o,p){try{var w=r.onCaughtError;w(p.value,{componentStack:p.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(P){setTimeout(function(){throw P})}}function hd(r,o,p){return p=Ut(p),p.tag=3,p.payload={element:null},p.callback=function(){gf(r,o)},p}function gg(r){return r=Ut(r),r.tag=3,r}function Ru(r,o,p,w){var P=p.type.getDerivedStateFromError;if(typeof P=="function"){var D=w.value;r.payload=function(){return P(D)},r.callback=function(){mg(o,p,w)}}var W=p.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(r.callback=function(){mg(o,p,w),typeof P!="function"&&(bc===null?bc=new Set([this]):bc.add(this));var pe=w.stack;this.componentDidCatch(w.value,{componentStack:pe!==null?pe:""})})}function v_(r,o,p,w,P){if(p.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(o=p.alternate,o!==null&&qc(o,p,P,!0),p=ls.current,p!==null){switch(p.tag){case 31:case 13:return cs===null?kf():p.alternate===null&&Ms===0&&(Ms=3),p.flags&=-257,p.flags|=65536,p.lanes=P,w===Y?p.flags|=16384:(o=p.updateQueue,o===null?p.updateQueue=new Set([w]):o.add(w),Mf(r,w,P)),!1;case 22:return p.flags|=65536,w===Y?p.flags|=16384:(o=p.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([w])},p.updateQueue=o):(p=o.retryQueue,p===null?o.retryQueue=new Set([w]):p.add(w)),Mf(r,w,P)),!1}throw Error(l(435,p.tag))}return Mf(r,w,P),kf(),!1}if(Lt)return o=ls.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=P,w!==lc&&(r=Error(l(422),{cause:w}),gl(b(r,p)))):(w!==lc&&(o=Error(l(423),{cause:w}),gl(b(o,p))),r=r.current.alternate,r.flags|=65536,P&=-P,r.lanes|=P,w=b(w,p),P=hd(r.stateNode,w,P),Gt(r,P),Ms!==4&&(Ms=2)),!1;var D=Error(l(520),{cause:w});if(D=b(D,p),kh===null?kh=[D]:kh.push(D),Ms!==4&&(Ms=2),o===null)return!0;w=b(w,p),p=o;do{switch(p.tag){case 3:return p.flags|=65536,r=P&-P,p.lanes|=r,r=hd(p.stateNode,w,r),Gt(p,r),!1;case 1:if(o=p.type,D=p.stateNode,(p.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(bc===null||!bc.has(D))))return p.flags|=65536,P&=-P,p.lanes|=P,P=gg(P),Ru(P,r,p,w),Gt(p,P),!1}p=p.return}while(p!==null);return!1}var ks=Error(l(461)),Us=!1;function Nr(r,o,p,w){o.child=r===null?$t(o,null,p,w):bt(o,r.child,p,w)}function dd(r,o,p,w,P){p=p.render;var D=o.ref;if("ref"in w){var W={};for(var pe in w)pe!=="ref"&&(W[pe]=w[pe])}else W=w;return tr(o),w=id(r,o,p,W,D,P),pe=Zc(),r!==null&&!Us?(dc(r,o,P),Vl(r,o,P)):(Lt&&pe&&Ws(o),o.flags|=1,Nr(r,o,w,P),o.child)}function fd(r,o,p,w,P){if(r===null){var D=p.type;return typeof D=="function"&&!$l(D)&&D.defaultProps===void 0&&p.compare===null?(o.tag=15,o.type=D,ph(r,o,D,w,P)):(r=fl(p.type,null,w,o,o.mode,P),r.ref=o.ref,r.return=o,o.child=r)}if(D=r.child,!vf(r,P)){var W=D.memoizedProps;if(p=p.compare,p=p!==null?p:cn,p(W,w)&&r.ref===o.ref)return Vl(r,o,P)}return o.flags|=1,r=Xr(D,w),r.ref=o.ref,r.return=o,o.child=r}function ph(r,o,p,w,P){if(r!==null){var D=r.memoizedProps;if(cn(D,w)&&r.ref===o.ref)if(Us=!1,o.pendingProps=w=D,vf(r,P))(r.flags&131072)!==0&&(Us=!0);else return o.lanes=r.lanes,Vl(r,o,P)}return _f(r,o,p,w,P)}function zp(r,o,p,w){var P=w.children,D=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((o.flags&128)!==0){if(D=D!==null?D.baseLanes|p:p,r!==null){for(w=o.child=r.child,P=0;w!==null;)P=P|w.lanes|w.childLanes,w=w.sibling;w=P&~D}else w=0,o.child=null;return gh(r,o,D,p,w)}if((p&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&T(o,D!==null?D.cachePool:null),D!==null?Wa(o,D):ts(),uc(o);else return w=o.lanes=536870912,gh(r,o,D!==null?D.baseLanes|p:p,p,w)}else D!==null?(T(o,D.cachePool),Wa(o,D),_o(),o.memoizedState=null):(r!==null&&T(o,null),ts(),_o());return Nr(r,o,P,p),o.child}function mh(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function gh(r,o,p,w,P){var D=v();return D=D===null?null:{parent:ws._currentValue,pool:D},o.memoizedState={baseLanes:p,cachePool:D},r!==null&&T(o,null),ts(),uc(o),r!==null&&qc(r,o,w,!0),o.childLanes=P,null}function yh(r,o){return o=pd({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function yf(r,o,p){return bt(o,r.child,null,p),r=yh(o,o.pendingProps),r.flags|=2,or(o),o.memoizedState=null,r}function Dp(r,o,p){var w=o.pendingProps,P=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Lt){if(w.mode==="hidden")return r=yh(o,w),o.lanes=536870912,mh(null,r);if(Ya(o),(r=Yi)?(r=yt(r,zr),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:dt!==null?{id:wt,overflow:Yt}:null,retryLane:536870912,hydrationErrors:null},p=ml(r),p.return=o,o.child=p,bn=o,Yi=null)):r=null,r===null)throw Jr(o);return o.lanes=536870912,null}return yh(o,w)}var D=r.memoizedState;if(D!==null){var W=D.dehydrated;if(Ya(o),P)if(o.flags&256)o.flags&=-257,o=yf(r,o,p);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(l(558));else if(Us||qc(r,o,p,!1),P=(p&r.childLanes)!==0,Us||P){if(w=ps,w!==null&&(W=Ue(w,p),W!==0&&W!==D.retryLane))throw D.retryLane=W,pa(r,W),ga(w,r,W),ks;kf(),o=yf(r,o,p)}else r=D.treeContext,Yi=Vt(W.nextSibling),bn=o,Lt=!0,Ma=null,zr=!1,r!==null&&Tr(o,r),o=yh(o,w),o.flags|=4096;return o}return r=Xr(r.child,{mode:w.mode,children:w.children}),r.ref=o.ref,o.child=r,r.return=o,r}function _h(r,o){var p=o.ref;if(p===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(l(284));(r===null||r.ref!==p)&&(o.flags|=4194816)}}function _f(r,o,p,w,P){return tr(o),p=id(r,o,p,w,void 0,P),w=Zc(),r!==null&&!Us?(dc(r,o,P),Vl(r,o,P)):(Lt&&w&&Ws(o),o.flags|=1,Nr(r,o,p,P),o.child)}function Op(r,o,p,w,P,D){return tr(o),o.updateQueue=null,p=bl(o,w,p,P),nd(r),w=Zc(),r!==null&&!Us?(dc(r,o,D),Vl(r,o,D)):(Lt&&w&&Ws(o),o.flags|=1,Nr(r,o,p,D),o.child)}function yg(r,o,p,w,P){if(tr(o),o.stateNode===null){var D=Sr,W=p.contextType;typeof W=="object"&&W!==null&&(D=nn(W)),D=new p(w,D),o.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=gc,o.stateNode=D,D._reactInternals=o,D=o.stateNode,D.props=w,D.state=o.memoizedState,D.refs={},Qt(o),W=p.contextType,D.context=typeof W=="object"&&W!==null?nn(W):Sr,D.state=o.memoizedState,W=p.getDerivedStateFromProps,typeof W=="function"&&(mf(o,p,W,w),D.state=o.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(W=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),W!==D.state&&gc.enqueueReplaceState(D,D.state,null),Gn(o,w,D,P),Ei(),D.state=o.memoizedState),typeof D.componentDidMount=="function"&&(o.flags|=4194308),w=!0}else if(r===null){D=o.stateNode;var pe=o.memoizedProps,De=Lu(p,pe);D.props=De;var ft=D.context,St=p.contextType;W=Sr,typeof St=="object"&&St!==null&&(W=nn(St));var Rt=p.getDerivedStateFromProps;St=typeof Rt=="function"||typeof D.getSnapshotBeforeUpdate=="function",pe=o.pendingProps!==pe,St||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(pe||ft!==W)&&hg(o,D,w,W),Ht=!1;var mt=o.memoizedState;D.state=mt,Gn(o,w,D,P),Ei(),ft=o.memoizedState,pe||mt!==ft||Ht?(typeof Rt=="function"&&(mf(o,p,Rt,w),ft=o.memoizedState),(De=Ht||fh(o,p,De,w,mt,ft,W))?(St||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(o.flags|=4194308)):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=w,o.memoizedState=ft),D.props=w,D.state=ft,D.context=W,w=De):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),w=!1)}else{D=o.stateNode,Zt(r,o),W=o.memoizedProps,St=Lu(p,W),D.props=St,Rt=o.pendingProps,mt=D.context,ft=p.contextType,De=Sr,typeof ft=="object"&&ft!==null&&(De=nn(ft)),pe=p.getDerivedStateFromProps,(ft=typeof pe=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(W!==Rt||mt!==De)&&hg(o,D,w,De),Ht=!1,mt=o.memoizedState,D.state=mt,Gn(o,w,D,P),Ei();var vt=o.memoizedState;W!==Rt||mt!==vt||Ht||r!==null&&r.dependencies!==null&&oh(r.dependencies)?(typeof pe=="function"&&(mf(o,p,pe,w),vt=o.memoizedState),(St=Ht||fh(o,p,St,w,mt,vt,De)||r!==null&&r.dependencies!==null&&oh(r.dependencies))?(ft||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(w,vt,De),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(w,vt,De)),typeof D.componentDidUpdate=="function"&&(o.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof D.componentDidUpdate!="function"||W===r.memoizedProps&&mt===r.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||W===r.memoizedProps&&mt===r.memoizedState||(o.flags|=1024),o.memoizedProps=w,o.memoizedState=vt),D.props=w,D.state=vt,D.context=De,w=St):(typeof D.componentDidUpdate!="function"||W===r.memoizedProps&&mt===r.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||W===r.memoizedProps&&mt===r.memoizedState||(o.flags|=1024),w=!1)}return D=w,_h(r,o),w=(o.flags&128)!==0,D||w?(D=o.stateNode,p=w&&typeof p.getDerivedStateFromError!="function"?null:D.render(),o.flags|=1,r!==null&&w?(o.child=bt(o,r.child,null,P),o.child=bt(o,null,p,P)):Nr(r,o,p,P),o.memoizedState=D.state,r=o.child):r=Vl(r,o,P),r}function _g(r,o,p,w){return yo(),o.flags|=256,Nr(r,o,p,w),o.child}var Np={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bp(r){return{baseLanes:r,cachePool:R()}}function $p(r,o,p){return r=r!==null?r.childLanes&~p:0,o&&(r|=eo),r}function yc(r,o,p){var w=o.pendingProps,P=!1,D=(o.flags&128)!==0,W;if((W=D)||(W=r!==null&&r.memoizedState===null?!1:(Nn.current&2)!==0),W&&(P=!0,o.flags&=-129),W=(o.flags&32)!==0,o.flags&=-33,r===null){if(Lt){if(P?Rs(o):_o(),(r=Yi)?(r=yt(r,zr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:dt!==null?{id:wt,overflow:Yt}:null,retryLane:536870912,hydrationErrors:null},p=ml(r),p.return=o,o.child=p,bn=o,Yi=null)):r=null,r===null)throw Jr(o);return Kt(r)?o.lanes=32:o.lanes=536870912,null}var pe=w.children;return w=w.fallback,P?(_o(),P=o.mode,pe=pd({mode:"hidden",children:pe},P),w=Kr(w,P,p,null),pe.return=o,w.return=o,pe.sibling=w,o.child=pe,w=o.child,w.memoizedState=Bp(p),w.childLanes=$p(r,W,p),o.memoizedState=Np,mh(null,w)):(Rs(o),Up(o,pe))}var De=r.memoizedState;if(De!==null&&(pe=De.dehydrated,pe!==null)){if(D)o.flags&256?(Rs(o),o.flags&=-257,o=tu(r,o,p)):o.memoizedState!==null?(_o(),o.child=r.child,o.flags|=128,o=null):(_o(),pe=w.fallback,P=o.mode,w=pd({mode:"visible",children:w.children},P),pe=Kr(pe,P,p,null),pe.flags|=2,w.return=o,pe.return=o,w.sibling=pe,o.child=w,bt(o,r.child,null,p),w=o.child,w.memoizedState=Bp(p),w.childLanes=$p(r,W,p),o.memoizedState=Np,o=mh(null,w));else if(Rs(o),Kt(pe)){if(W=pe.nextSibling&&pe.nextSibling.dataset,W)var ft=W.dgst;W=ft,w=Error(l(419)),w.stack="",w.digest=W,gl({value:w,source:null,stack:null}),o=tu(r,o,p)}else if(Us||qc(r,o,p,!1),W=(p&r.childLanes)!==0,Us||W){if(W=ps,W!==null&&(w=Ue(W,p),w!==0&&w!==De.retryLane))throw De.retryLane=w,pa(r,w),ga(W,r,w),ks;zt(pe)||kf(),o=tu(r,o,p)}else zt(pe)?(o.flags|=192,o.child=r.child,o=null):(r=De.treeContext,Yi=Vt(pe.nextSibling),bn=o,Lt=!0,Ma=null,zr=!1,r!==null&&Tr(o,r),o=Up(o,w.children),o.flags|=4096);return o}return P?(_o(),pe=w.fallback,P=o.mode,De=r.child,ft=De.sibling,w=Xr(De,{mode:"hidden",children:w.children}),w.subtreeFlags=De.subtreeFlags&65011712,ft!==null?pe=Xr(ft,pe):(pe=Kr(pe,P,p,null),pe.flags|=2),pe.return=o,w.return=o,w.sibling=pe,o.child=w,mh(null,w),w=o.child,pe=r.child.memoizedState,pe===null?pe=Bp(p):(P=pe.cachePool,P!==null?(De=ws._currentValue,P=P.parent!==De?{parent:De,pool:De}:P):P=R(),pe={baseLanes:pe.baseLanes|p,cachePool:P}),w.memoizedState=pe,w.childLanes=$p(r,W,p),o.memoizedState=Np,mh(r.child,w)):(Rs(o),p=r.child,r=p.sibling,p=Xr(p,{mode:"visible",children:w.children}),p.return=o,p.sibling=null,r!==null&&(W=o.deletions,W===null?(o.deletions=[r],o.flags|=16):W.push(r)),o.child=p,o.memoizedState=null,p)}function Up(r,o){return o=pd({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function pd(r,o){return r=er(22,r,null,o),r.lanes=0,r}function tu(r,o,p){return bt(o,r.child,null,p),r=Up(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function vg(r,o,p){r.lanes|=o;var w=r.alternate;w!==null&&(w.lanes|=o),ed(r.return,o,p)}function Fp(r,o,p,w,P,D){var W=r.memoizedState;W===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:P,treeForkCount:D}:(W.isBackwards=o,W.rendering=null,W.renderingStartTime=0,W.last=w,W.tail=p,W.tailMode=P,W.treeForkCount=D)}function xg(r,o,p){var w=o.pendingProps,P=w.revealOrder,D=w.tail;w=w.children;var W=Nn.current,pe=(W&2)!==0;if(pe?(W=W&1|2,o.flags|=128):W&=1,st(Nn,W),Nr(r,o,w,p),w=Lt?ce:0,!pe&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&vg(r,p,o);else if(r.tag===19)vg(r,p,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(P){case"forwards":for(p=o.child,P=null;p!==null;)r=p.alternate,r!==null&&hc(r)===null&&(P=p),p=p.sibling;p=P,p===null?(P=o.child,o.child=null):(P=p.sibling,p.sibling=null),Fp(o,!1,P,p,D,w);break;case"backwards":case"unstable_legacy-backwards":for(p=null,P=o.child,o.child=null;P!==null;){if(r=P.alternate,r!==null&&hc(r)===null){o.child=P;break}r=P.sibling,P.sibling=p,p=P,P=r}Fp(o,!0,p,null,D,w);break;case"together":Fp(o,!1,null,null,void 0,w);break;default:o.memoizedState=null}return o.child}function Vl(r,o,p){if(r!==null&&(o.dependencies=r.dependencies),ru|=o.lanes,(p&o.childLanes)===0)if(r!==null){if(qc(r,o,p,!1),(p&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(l(153));if(o.child!==null){for(r=o.child,p=Xr(r,r.pendingProps),o.child=p,p.return=o;r.sibling!==null;)r=r.sibling,p=p.sibling=Xr(r,r.pendingProps),p.return=o;p.sibling=null}return o.child}function vf(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&oh(r)))}function x_(r,o,p){switch(o.tag){case 3:ei(o,o.stateNode.containerInfo),Oo(o,ws,r.memoizedState.cache),yo();break;case 27:case 5:Gi(o);break;case 4:ei(o,o.stateNode.containerInfo);break;case 10:Oo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Ya(o),null;break;case 13:var w=o.memoizedState;if(w!==null)return w.dehydrated!==null?(Rs(o),o.flags|=128,null):(p&o.child.childLanes)!==0?yc(r,o,p):(Rs(o),r=Vl(r,o,p),r!==null?r.sibling:null);Rs(o);break;case 19:var P=(r.flags&128)!==0;if(w=(p&o.childLanes)!==0,w||(qc(r,o,p,!1),w=(p&o.childLanes)!==0),P){if(w)return xg(r,o,p);o.flags|=128}if(P=o.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),st(Nn,Nn.current),w)break;return null;case 22:return o.lanes=0,zp(r,o,p,o.pendingProps);case 24:Oo(o,ws,r.memoizedState.cache)}return Vl(r,o,p)}function bg(r,o,p){if(r!==null)if(r.memoizedProps!==o.pendingProps)Us=!0;else{if(!vf(r,p)&&(o.flags&128)===0)return Us=!1,x_(r,o,p);Us=(r.flags&131072)!==0}else Us=!1,Lt&&(o.flags&1048576)!==0&&un(o,ce,o.index);switch(o.lanes=0,o.tag){case 16:e:{var w=o.pendingProps;if(r=fe(o.elementType),o.type=r,typeof r=="function")$l(r)?(w=Lu(r,w),o.tag=1,o=yg(null,o,r,w,p)):(o.tag=0,o=_f(null,o,r,w,p));else{if(r!=null){var P=r.$$typeof;if(P===me){o.tag=11,o=dd(null,o,r,w,p);break e}else if(P===Re){o.tag=14,o=fd(null,o,r,w,p);break e}}throw o=gt(r)||r,Error(l(306,o,""))}}return o;case 0:return _f(r,o,o.type,o.pendingProps,p);case 1:return w=o.type,P=Lu(w,o.pendingProps),yg(r,o,w,P,p);case 3:e:{if(ei(o,o.stateNode.containerInfo),r===null)throw Error(l(387));w=o.pendingProps;var D=o.memoizedState;P=D.element,Zt(r,o),Gn(o,w,null,p);var W=o.memoizedState;if(w=W.cache,Oo(o,ws,w),w!==D.cache&&Cu(o,[ws],p,!0),Ei(),w=W.element,D.isDehydrated)if(D={element:w,isDehydrated:!1,cache:W.cache},o.updateQueue.baseState=D,o.memoizedState=D,o.flags&256){o=_g(r,o,w,p);break e}else if(w!==P){P=b(Error(l(424)),o),gl(P),o=_g(r,o,w,p);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Yi=Vt(r.firstChild),bn=o,Lt=!0,Ma=null,zr=!0,p=$t(o,null,w,p),o.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(yo(),w===P){o=Vl(r,o,p);break e}Nr(r,o,w,p)}o=o.child}return o;case 26:return _h(r,o),r===null?(p=Ar(o.type,null,o.pendingProps,null))?o.memoizedState=p:Lt||(p=o.type,r=o.pendingProps,w=x(kt.current).createElement(p),w[At]=o,w[ti]=r,kr(w,p,r),Ft(w),o.stateNode=w):o.memoizedState=Ar(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Gi(o),r===null&&Lt&&(w=o.stateNode=ii(o.type,o.pendingProps,kt.current),bn=o,zr=!0,P=Yi,de(o.type)?(Wt=P,Yi=Vt(w.firstChild)):Yi=P),Nr(r,o,o.pendingProps.children,p),_h(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Lt&&((P=w=Yi)&&(w=Be(w,o.type,o.pendingProps,zr),w!==null?(o.stateNode=w,bn=o,Yi=Vt(w.firstChild),zr=!1,P=!0):P=!1),P||Jr(o)),Gi(o),P=o.type,D=o.pendingProps,W=r!==null?r.memoizedProps:null,w=D.children,j(P,D)?w=null:W!==null&&j(P,W)&&(o.flags|=32),o.memoizedState!==null&&(P=id(r,o,af,null,null,p),Nh._currentValue=P),_h(r,o),Nr(r,o,w,p),o.child;case 6:return r===null&&Lt&&((r=p=Yi)&&(p=Ke(p,o.pendingProps,zr),p!==null?(o.stateNode=p,bn=o,Yi=null,r=!0):r=!1),r||Jr(o)),null;case 13:return yc(r,o,p);case 4:return ei(o,o.stateNode.containerInfo),w=o.pendingProps,r===null?o.child=bt(o,null,w,p):Nr(r,o,w,p),o.child;case 11:return dd(r,o,o.type,o.pendingProps,p);case 7:return Nr(r,o,o.pendingProps,p),o.child;case 8:return Nr(r,o,o.pendingProps.children,p),o.child;case 12:return Nr(r,o,o.pendingProps.children,p),o.child;case 10:return w=o.pendingProps,Oo(o,o.type,w.value),Nr(r,o,w.children,p),o.child;case 9:return P=o.type._context,w=o.pendingProps.children,tr(o),P=nn(P),w=w(P),o.flags|=1,Nr(r,o,w,p),o.child;case 14:return fd(r,o,o.type,o.pendingProps,p);case 15:return ph(r,o,o.type,o.pendingProps,p);case 19:return xg(r,o,p);case 31:return Dp(r,o,p);case 22:return zp(r,o,p,o.pendingProps);case 24:return tr(o),w=nn(ws),r===null?(P=v(),P===null&&(P=ps,D=Ga(),P.pooledCache=D,D.refCount++,D!==null&&(P.pooledCacheLanes|=p),P=D),o.memoizedState={parent:w,cache:P},Qt(o),Oo(o,ws,P)):((r.lanes&p)!==0&&(Zt(r,o),Gn(o,null,null,p),Ei()),P=r.memoizedState,D=o.memoizedState,P.parent!==w?(P={parent:w,cache:w},o.memoizedState=P,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=P),Oo(o,ws,w)):(w=D.cache,Oo(o,ws,w),w!==P.cache&&Cu(o,[ws],p,!0))),Nr(r,o,o.pendingProps.children,p),o.child;case 29:throw o.pendingProps}throw Error(l(156,o.tag))}function _c(r){r.flags|=4}function Vp(r,o,p,w,P){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(P&335544128)===P)if(r.stateNode.complete)r.flags|=8192;else if(Og())r.flags|=8192;else throw _e=Y,U}else r.flags&=-16777217}function xf(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!mr(o))if(Og())r.flags|=8192;else throw _e=Y,U}function iu(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?we():536870912,r.lanes|=o,Eh|=o)}function zu(r,o){if(!Lt)switch(r.tailMode){case"hidden":o=r.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?r.tail=null:p.sibling=null;break;case"collapsed":p=r.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:w.sibling=null}}function Cs(r){var o=r.alternate!==null&&r.alternate.child===r.child,p=0,w=0;if(o)for(var P=r.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags&65011712,w|=P.flags&65011712,P.return=r,P=P.sibling;else for(P=r.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags,w|=P.flags,P.return=r,P=P.sibling;return r.subtreeFlags|=w,r.childLanes=p,o}function b_(r,o,p){var w=o.pendingProps;switch(Es(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cs(o),null;case 1:return Cs(o),null;case 3:return p=o.stateNode,w=null,r!==null&&(w=r.memoizedState.cache),o.memoizedState.cache!==w&&(o.flags|=2048),No(ws),li(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(r===null||r.child===null)&&(Oi(o)?_c(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,ku())),Cs(o),null;case 26:var P=o.type,D=o.memoizedState;return r===null?(_c(o),D!==null?(Cs(o),xf(o,D)):(Cs(o),Vp(o,P,null,w,p))):D?D!==r.memoizedState?(_c(o),Cs(o),xf(o,D)):(Cs(o),o.flags&=-16777217):(r=r.memoizedProps,r!==w&&_c(o),Cs(o),Vp(o,P,r,w,p)),null;case 27:if(Mi(o),p=kt.current,P=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==w&&_c(o);else{if(!w){if(o.stateNode===null)throw Error(l(166));return Cs(o),null}r=ot.current,Oi(o)?Do(o):(r=ii(P,w,p),o.stateNode=r,_c(o))}return Cs(o),null;case 5:if(Mi(o),P=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==w&&_c(o);else{if(!w){if(o.stateNode===null)throw Error(l(166));return Cs(o),null}if(D=ot.current,Oi(o))Do(o);else{var W=x(kt.current);switch(D){case 1:D=W.createElementNS("http://www.w3.org/2000/svg",P);break;case 2:D=W.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;default:switch(P){case"svg":D=W.createElementNS("http://www.w3.org/2000/svg",P);break;case"math":D=W.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;case"script":D=W.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof w.is=="string"?W.createElement("select",{is:w.is}):W.createElement("select"),w.multiple?D.multiple=!0:w.size&&(D.size=w.size);break;default:D=typeof w.is=="string"?W.createElement(P,{is:w.is}):W.createElement(P)}}D[At]=o,D[ti]=w;e:for(W=o.child;W!==null;){if(W.tag===5||W.tag===6)D.appendChild(W.stateNode);else if(W.tag!==4&&W.tag!==27&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===o)break e;for(;W.sibling===null;){if(W.return===null||W.return===o)break e;W=W.return}W.sibling.return=W.return,W=W.sibling}o.stateNode=D;e:switch(kr(D,P,w),P){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&_c(o)}}return Cs(o),Vp(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,p),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==w&&_c(o);else{if(typeof w!="string"&&o.stateNode===null)throw Error(l(166));if(r=kt.current,Oi(o)){if(r=o.stateNode,p=o.memoizedProps,w=null,P=bn,P!==null)switch(P.tag){case 27:case 5:w=P.memoizedProps}r[At]=o,r=!!(r.nodeValue===p||w!==null&&w.suppressHydrationWarning===!0||zh(r.nodeValue,p)),r||Jr(o,!0)}else r=x(r).createTextNode(w),r[At]=o,o.stateNode=r}return Cs(o),null;case 31:if(p=o.memoizedState,r===null||r.memoizedState!==null){if(w=Oi(o),p!==null){if(r===null){if(!w)throw Error(l(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(l(557));r[At]=o}else yo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Cs(o),r=!1}else p=ku(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),r=!0;if(!r)return o.flags&256?(or(o),o):(or(o),null);if((o.flags&128)!==0)throw Error(l(558))}return Cs(o),null;case 13:if(w=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(P=Oi(o),w!==null&&w.dehydrated!==null){if(r===null){if(!P)throw Error(l(318));if(P=o.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(l(317));P[At]=o}else yo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Cs(o),P=!1}else P=ku(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=P),P=!0;if(!P)return o.flags&256?(or(o),o):(or(o),null)}return or(o),(o.flags&128)!==0?(o.lanes=p,o):(p=w!==null,r=r!==null&&r.memoizedState!==null,p&&(w=o.child,P=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(P=w.alternate.memoizedState.cachePool.pool),D=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(D=w.memoizedState.cachePool.pool),D!==P&&(w.flags|=2048)),p!==r&&p&&(o.child.flags|=8192),iu(o,o.updateQueue),Cs(o),null);case 4:return li(),r===null&&dm(o.stateNode.containerInfo),Cs(o),null;case 10:return No(o.type),Cs(o),null;case 19:if(Ce(Nn),w=o.memoizedState,w===null)return Cs(o),null;if(P=(o.flags&128)!==0,D=w.rendering,D===null)if(P)zu(w,!1);else{if(Ms!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(D=hc(r),D!==null){for(o.flags|=128,zu(w,!1),r=D.updateQueue,o.updateQueue=r,iu(o,r),o.subtreeFlags=0,r=p,p=o.child;p!==null;)ac(p,r),p=p.sibling;return st(Nn,Nn.current&1|2),Lt&&_i(o,w.treeForkCount),o.child}r=r.sibling}w.tail!==null&&Xi()>Tf&&(o.flags|=128,P=!0,zu(w,!1),o.lanes=4194304)}else{if(!P)if(r=hc(D),r!==null){if(o.flags|=128,P=!0,r=r.updateQueue,o.updateQueue=r,iu(o,r),zu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!D.alternate&&!Lt)return Cs(o),null}else 2*Xi()-w.renderingStartTime>Tf&&p!==536870912&&(o.flags|=128,P=!0,zu(w,!1),o.lanes=4194304);w.isBackwards?(D.sibling=o.child,o.child=D):(r=w.last,r!==null?r.sibling=D:o.child=D,w.last=D)}return w.tail!==null?(r=w.tail,w.rendering=r,w.tail=r.sibling,w.renderingStartTime=Xi(),r.sibling=null,p=Nn.current,st(Nn,P?p&1|2:p&1),Lt&&_i(o,w.treeForkCount),r):(Cs(o),null);case 22:case 23:return or(o),Dr(),w=o.memoizedState!==null,r!==null?r.memoizedState!==null!==w&&(o.flags|=8192):w&&(o.flags|=8192),w?(p&536870912)!==0&&(o.flags&128)===0&&(Cs(o),o.subtreeFlags&6&&(o.flags|=8192)):Cs(o),p=o.updateQueue,p!==null&&iu(o,p.retryQueue),p=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),w=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(w=o.memoizedState.cachePool.pool),w!==p&&(o.flags|=2048),r!==null&&Ce(g),null;case 24:return p=null,r!==null&&(p=r.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),No(ws),Cs(o),null;case 25:return null;case 30:return null}throw Error(l(156,o.tag))}function wg(r,o){switch(Es(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return No(ws),li(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Mi(o),null;case 31:if(o.memoizedState!==null){if(or(o),o.alternate===null)throw Error(l(340));yo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(or(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(l(340));yo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Ce(Nn),null;case 4:return li(),null;case 10:return No(o.type),null;case 22:case 23:return or(o),Dr(),r!==null&&Ce(g),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return No(ws),null;case 25:return null;default:return null}}function Sg(r,o){switch(Es(o),o.tag){case 3:No(ws),li();break;case 26:case 27:case 5:Mi(o);break;case 4:li();break;case 31:o.memoizedState!==null&&or(o);break;case 13:or(o);break;case 19:Ce(Nn);break;case 10:No(o.type);break;case 22:case 23:or(o),Dr(),r!==null&&Ce(g);break;case 24:No(ws)}}function md(r,o){try{var p=o.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var P=w.next;p=P;do{if((p.tag&r)===r){w=void 0;var D=p.create,W=p.inst;w=D(),W.destroy=w}p=p.next}while(p!==P)}}catch(pe){ns(o,o.return,pe)}}function $o(r,o,p){try{var w=o.updateQueue,P=w!==null?w.lastEffect:null;if(P!==null){var D=P.next;w=D;do{if((w.tag&r)===r){var W=w.inst,pe=W.destroy;if(pe!==void 0){W.destroy=void 0,P=o;var De=p,ft=pe;try{ft()}catch(St){ns(P,De,St)}}}w=w.next}while(w!==D)}}catch(St){ns(o,o.return,St)}}function qp(r){var o=r.updateQueue;if(o!==null){var p=r.stateNode;try{dn(o,p)}catch(w){ns(r,r.return,w)}}}function Tg(r,o,p){p.props=Lu(r.type,r.memoizedProps),p.state=r.memoizedState;try{p.componentWillUnmount()}catch(w){ns(r,o,w)}}function gd(r,o){try{var p=r.ref;if(p!==null){switch(r.tag){case 26:case 27:case 5:var w=r.stateNode;break;case 30:w=r.stateNode;break;default:w=r.stateNode}typeof p=="function"?r.refCleanup=p(w):p.current=w}}catch(P){ns(r,o,P)}}function ql(r,o){var p=r.ref,w=r.refCleanup;if(p!==null)if(typeof w=="function")try{w()}catch(P){ns(r,o,P)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(P){ns(r,o,P)}else p.current=null}function Eg(r){var o=r.type,p=r.memoizedProps,w=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":p.autoFocus&&w.focus();break e;case"img":p.src?w.src=p.src:p.srcSet&&(w.srcset=p.srcSet)}}catch(P){ns(r,r.return,P)}}function Hp(r,o,p){try{var w=r.stateNode;A_(w,r.type,p,o),w[ti]=o}catch(P){ns(r,r.return,P)}}function kg(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&de(r.type)||r.tag===4}function bf(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||kg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&de(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function yd(r,o,p){var w=r.tag;if(w===5||w===6)r=r.stateNode,o?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(r,o):(o=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,o.appendChild(r),p=p._reactRootContainer,p!=null||o.onclick!==null||(o.onclick=qs));else if(w!==4&&(w===27&&de(r.type)&&(p=r.stateNode,o=null),r=r.child,r!==null))for(yd(r,o,p),r=r.sibling;r!==null;)yd(r,o,p),r=r.sibling}function _d(r,o,p){var w=r.tag;if(w===5||w===6)r=r.stateNode,o?p.insertBefore(r,o):p.appendChild(r);else if(w!==4&&(w===27&&de(r.type)&&(p=r.stateNode),r=r.child,r!==null))for(_d(r,o,p),r=r.sibling;r!==null;)_d(r,o,p),r=r.sibling}function Zp(r){var o=r.stateNode,p=r.memoizedProps;try{for(var w=r.type,P=o.attributes;P.length;)o.removeAttributeNode(P[0]);kr(o,w,p),o[At]=r,o[ti]=p}catch(D){ns(r,r.return,D)}}var Hl=!1,cr=!1,vh=!1,Cg=typeof WeakSet=="function"?WeakSet:Set,Er=null;function w_(r,o){if(r=r.containerInfo,c=Df,r=qa(r),fo(r)){if("selectionStart"in r)var p={start:r.selectionStart,end:r.selectionEnd};else e:{p=(p=r.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var P=w.anchorOffset,D=w.focusNode;w=w.focusOffset;try{p.nodeType,D.nodeType}catch{p=null;break e}var W=0,pe=-1,De=-1,ft=0,St=0,Rt=r,mt=null;t:for(;;){for(var vt;Rt!==p||P!==0&&Rt.nodeType!==3||(pe=W+P),Rt!==D||w!==0&&Rt.nodeType!==3||(De=W+w),Rt.nodeType===3&&(W+=Rt.nodeValue.length),(vt=Rt.firstChild)!==null;)mt=Rt,Rt=vt;for(;;){if(Rt===r)break t;if(mt===p&&++ft===P&&(pe=W),mt===D&&++St===w&&(De=W),(vt=Rt.nextSibling)!==null)break;Rt=mt,mt=Rt.parentNode}Rt=vt}p=pe===-1||De===-1?null:{start:pe,end:De}}else p=null}p=p||{start:0,end:0}}else p=null;for(m={focusedElem:r,selectionRange:p},Df=!1,Er=o;Er!==null;)if(o=Er,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Er=r;else for(;Er!==null;){switch(o=Er,D=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(p=0;p<r.length;p++)P=r[p],P.ref.impl=P.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&D!==null){r=void 0,p=o,P=D.memoizedProps,D=D.memoizedState,w=p.stateNode;try{var mi=Lu(p.type,P);r=w.getSnapshotBeforeUpdate(mi,D),w.__reactInternalSnapshotBeforeUpdate=r}catch(Ni){ns(p,p.return,Ni)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,p=r.nodeType,p===9)tt(r);else if(p===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":tt(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(l(163))}if(r=o.sibling,r!==null){r.return=o.return,Er=r;break}Er=o.return}}function Ag(r,o,p){var w=p.flags;switch(p.tag){case 0:case 11:case 15:Qa(r,p),w&4&&md(5,p);break;case 1:if(Qa(r,p),w&4)if(r=p.stateNode,o===null)try{r.componentDidMount()}catch(W){ns(p,p.return,W)}else{var P=Lu(p.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(P,o,r.__reactInternalSnapshotBeforeUpdate)}catch(W){ns(p,p.return,W)}}w&64&&qp(p),w&512&&gd(p,p.return);break;case 3:if(Qa(r,p),w&64&&(r=p.updateQueue,r!==null)){if(o=null,p.child!==null)switch(p.child.tag){case 27:case 5:o=p.child.stateNode;break;case 1:o=p.child.stateNode}try{dn(r,o)}catch(W){ns(p,p.return,W)}}break;case 27:o===null&&w&4&&Zp(p);case 26:case 5:Qa(r,p),o===null&&w&4&&Eg(p),w&512&&gd(p,p.return);break;case 12:Qa(r,p);break;case 31:Qa(r,p),w&4&&Ys(r,p);break;case 13:Qa(r,p),w&4&&Gp(r,p),w&64&&(r=p.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(p=$g.bind(null,p),bi(r,p))));break;case 22:if(w=p.memoizedState!==null||Hl,!w){o=o!==null&&o.memoizedState!==null||cr,P=Hl;var D=cr;Hl=w,(cr=o)&&!D?xc(r,p,(p.subtreeFlags&8772)!==0):Qa(r,p),Hl=P,cr=D}break;case 30:break;default:Qa(r,p)}}function Mg(r){var o=r.alternate;o!==null&&(r.alternate=null,Mg(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&Qe(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var As=null,Ja=!1;function vc(r,o,p){for(p=p.child;p!==null;)xh(r,o,p),p=p.sibling}function xh(r,o,p){if(ri&&typeof ri.onCommitFiberUnmount=="function")try{ri.onCommitFiberUnmount(jt,p)}catch{}switch(p.tag){case 26:cr||ql(p,o),vc(r,o,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:cr||ql(p,o);var w=As,P=Ja;de(p.type)&&(As=p.stateNode,Ja=!1),vc(r,o,p),xt(p.stateNode),As=w,Ja=P;break;case 5:cr||ql(p,o);case 6:if(w=As,P=Ja,As=null,vc(r,o,p),As=w,Ja=P,As!==null)if(Ja)try{(As.nodeType===9?As.body:As.nodeName==="HTML"?As.ownerDocument.body:As).removeChild(p.stateNode)}catch(D){ns(p,o,D)}else try{As.removeChild(p.stateNode)}catch(D){ns(p,o,D)}break;case 18:As!==null&&(Ja?(r=As,Te(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,p.stateNode),$f(r)):Te(As,p.stateNode));break;case 4:w=As,P=Ja,As=p.stateNode.containerInfo,Ja=!0,vc(r,o,p),As=w,Ja=P;break;case 0:case 11:case 14:case 15:$o(2,p,o),cr||$o(4,p,o),vc(r,o,p);break;case 1:cr||(ql(p,o),w=p.stateNode,typeof w.componentWillUnmount=="function"&&Tg(p,o,w)),vc(r,o,p);break;case 21:vc(r,o,p);break;case 22:cr=(w=cr)||p.memoizedState!==null,vc(r,o,p),cr=w;break;default:vc(r,o,p)}}function Ys(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{$f(r)}catch(p){ns(o,o.return,p)}}}function Gp(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{$f(r)}catch(p){ns(o,o.return,p)}}function Pg(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new Cg),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new Cg),o;default:throw Error(l(435,r.tag))}}function vd(r,o){var p=Pg(r);o.forEach(function(w){if(!p.has(w)){p.add(w);var P=k_.bind(null,r,w);w.then(P,P)}})}function rn(r,o){var p=o.deletions;if(p!==null)for(var w=0;w<p.length;w++){var P=p[w],D=r,W=o,pe=W;e:for(;pe!==null;){switch(pe.tag){case 27:if(de(pe.type)){As=pe.stateNode,Ja=!1;break e}break;case 5:As=pe.stateNode,Ja=!1;break e;case 3:case 4:As=pe.stateNode.containerInfo,Ja=!0;break e}pe=pe.return}if(As===null)throw Error(l(160));xh(D,W,P),As=null,Ja=!1,D=P.alternate,D!==null&&(D.return=null),P.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Wp(o,r),o=o.sibling}var xo=null;function Wp(r,o){var p=r.alternate,w=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:rn(o,r),Pa(r),w&4&&($o(3,r,r.return),md(3,r),$o(5,r,r.return));break;case 1:rn(o,r),Pa(r),w&512&&(cr||p===null||ql(p,p.return)),w&64&&Hl&&(r=r.updateQueue,r!==null&&(w=r.callbacks,w!==null&&(p=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=p===null?w:p.concat(w))));break;case 26:var P=xo;if(rn(o,r),Pa(r),w&512&&(cr||p===null||ql(p,p.return)),w&4){var D=p!==null?p.memoizedState:null;if(w=r.memoizedState,p===null)if(w===null)if(r.stateNode===null){e:{w=r.type,p=r.memoizedProps,P=P.ownerDocument||P;t:switch(w){case"title":D=P.getElementsByTagName("title")[0],(!D||D[on]||D[At]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=P.createElement(w),P.head.insertBefore(D,P.querySelector("head > title"))),kr(D,w,p),D[At]=r,Ft(D),w=D;break e;case"link":var W=Tl("link","href",P).get(w+(p.href||""));if(W){for(var pe=0;pe<W.length;pe++)if(D=W[pe],D.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&D.getAttribute("rel")===(p.rel==null?null:p.rel)&&D.getAttribute("title")===(p.title==null?null:p.title)&&D.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){W.splice(pe,1);break t}}D=P.createElement(w),kr(D,w,p),P.head.appendChild(D);break;case"meta":if(W=Tl("meta","content",P).get(w+(p.content||""))){for(pe=0;pe<W.length;pe++)if(D=W[pe],D.getAttribute("content")===(p.content==null?null:""+p.content)&&D.getAttribute("name")===(p.name==null?null:p.name)&&D.getAttribute("property")===(p.property==null?null:p.property)&&D.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&D.getAttribute("charset")===(p.charSet==null?null:p.charSet)){W.splice(pe,1);break t}}D=P.createElement(w),kr(D,w,p),P.head.appendChild(D);break;default:throw Error(l(468,w))}D[At]=r,Ft(D),w=D}r.stateNode=w}else To(P,r.type,r.stateNode);else r.stateNode=ds(P,w,r.memoizedProps);else D!==w?(D===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):D.count--,w===null?To(P,r.type,r.stateNode):ds(P,w,r.memoizedProps)):w===null&&r.stateNode!==null&&Hp(r,r.memoizedProps,p.memoizedProps)}break;case 27:rn(o,r),Pa(r),w&512&&(cr||p===null||ql(p,p.return)),p!==null&&w&4&&Hp(r,r.memoizedProps,p.memoizedProps);break;case 5:if(rn(o,r),Pa(r),w&512&&(cr||p===null||ql(p,p.return)),r.flags&32){P=r.stateNode;try{Zr(P,"")}catch(mi){ns(r,r.return,mi)}}w&4&&r.stateNode!=null&&(P=r.memoizedProps,Hp(r,P,p!==null?p.memoizedProps:P)),w&1024&&(vh=!0);break;case 6:if(rn(o,r),Pa(r),w&4){if(r.stateNode===null)throw Error(l(162));w=r.memoizedProps,p=r.stateNode;try{p.nodeValue=w}catch(mi){ns(r,r.return,mi)}}break;case 3:if(So=null,P=xo,xo=Ci(o.containerInfo),rn(o,r),xo=P,Pa(r),w&4&&p!==null&&p.memoizedState.isDehydrated)try{$f(o.containerInfo)}catch(mi){ns(r,r.return,mi)}vh&&(vh=!1,Zl(r));break;case 4:w=xo,xo=Ci(r.stateNode.containerInfo),rn(o,r),Pa(r),xo=w;break;case 12:rn(o,r),Pa(r);break;case 31:rn(o,r),Pa(r),w&4&&(w=r.updateQueue,w!==null&&(r.updateQueue=null,vd(r,w)));break;case 13:rn(o,r),Pa(r),r.child.flags&8192&&r.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Ch=Xi()),w&4&&(w=r.updateQueue,w!==null&&(r.updateQueue=null,vd(r,w)));break;case 22:P=r.memoizedState!==null;var De=p!==null&&p.memoizedState!==null,ft=Hl,St=cr;if(Hl=ft||P,cr=St||De,rn(o,r),cr=St,Hl=ft,Pa(r),w&8192)e:for(o=r.stateNode,o._visibility=P?o._visibility&-2:o._visibility|1,P&&(p===null||De||Hl||cr||nu(r)),p=null,o=r;;){if(o.tag===5||o.tag===26){if(p===null){De=p=o;try{if(D=De.stateNode,P)W=D.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none";else{pe=De.stateNode;var Rt=De.memoizedProps.style,mt=Rt!=null&&Rt.hasOwnProperty("display")?Rt.display:null;pe.style.display=mt==null||typeof mt=="boolean"?"":(""+mt).trim()}}catch(mi){ns(De,De.return,mi)}}}else if(o.tag===6){if(p===null){De=o;try{De.stateNode.nodeValue=P?"":De.memoizedProps}catch(mi){ns(De,De.return,mi)}}}else if(o.tag===18){if(p===null){De=o;try{var vt=De.stateNode;P?Me(vt,!0):Me(De.stateNode,!1)}catch(mi){ns(De,De.return,mi)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;p===o&&(p=null),o=o.return}p===o&&(p=null),o.sibling.return=o.return,o=o.sibling}w&4&&(w=r.updateQueue,w!==null&&(p=w.retryQueue,p!==null&&(w.retryQueue=null,vd(r,p))));break;case 19:rn(o,r),Pa(r),w&4&&(w=r.updateQueue,w!==null&&(r.updateQueue=null,vd(r,w)));break;case 30:break;case 21:break;default:rn(o,r),Pa(r)}}function Pa(r){var o=r.flags;if(o&2){try{for(var p,w=r.return;w!==null;){if(kg(w)){p=w;break}w=w.return}if(p==null)throw Error(l(160));switch(p.tag){case 27:var P=p.stateNode,D=bf(r);_d(r,D,P);break;case 5:var W=p.stateNode;p.flags&32&&(Zr(W,""),p.flags&=-33);var pe=bf(r);_d(r,pe,W);break;case 3:case 4:var De=p.stateNode.containerInfo,ft=bf(r);yd(r,ft,De);break;default:throw Error(l(161))}}catch(St){ns(r,r.return,St)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function Zl(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;Zl(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Qa(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Ag(r,o.alternate,o),o=o.sibling}function nu(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:$o(4,o,o.return),nu(o);break;case 1:ql(o,o.return);var p=o.stateNode;typeof p.componentWillUnmount=="function"&&Tg(o,o.return,p),nu(o);break;case 27:xt(o.stateNode);case 26:case 5:ql(o,o.return),nu(o);break;case 22:o.memoizedState===null&&nu(o);break;case 30:nu(o);break;default:nu(o)}r=r.sibling}}function xc(r,o,p){for(p=p&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var w=o.alternate,P=r,D=o,W=D.flags;switch(D.tag){case 0:case 11:case 15:xc(P,D,p),md(4,D);break;case 1:if(xc(P,D,p),w=D,P=w.stateNode,typeof P.componentDidMount=="function")try{P.componentDidMount()}catch(ft){ns(w,w.return,ft)}if(w=D,P=w.updateQueue,P!==null){var pe=w.stateNode;try{var De=P.shared.hiddenCallbacks;if(De!==null)for(P.shared.hiddenCallbacks=null,P=0;P<De.length;P++)Zi(De[P],pe)}catch(ft){ns(w,w.return,ft)}}p&&W&64&&qp(D),gd(D,D.return);break;case 27:Zp(D);case 26:case 5:xc(P,D,p),p&&w===null&&W&4&&Eg(D),gd(D,D.return);break;case 12:xc(P,D,p);break;case 31:xc(P,D,p),p&&W&4&&Ys(P,D);break;case 13:xc(P,D,p),p&&W&4&&Gp(P,D);break;case 22:D.memoizedState===null&&xc(P,D,p),gd(D,D.return);break;case 30:break;default:xc(P,D,p)}o=o.sibling}}function Yp(r,o){var p=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==p&&(r!=null&&r.refCount++,p!=null&&_l(p))}function Xp(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&_l(r))}function wl(r,o,p,w){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Ig(r,o,p,w),o=o.sibling}function Ig(r,o,p,w){var P=o.flags;switch(o.tag){case 0:case 11:case 15:wl(r,o,p,w),P&2048&&md(9,o);break;case 1:wl(r,o,p,w);break;case 3:wl(r,o,p,w),P&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&_l(r)));break;case 12:if(P&2048){wl(r,o,p,w),r=o.stateNode;try{var D=o.memoizedProps,W=D.id,pe=D.onPostCommit;typeof pe=="function"&&pe(W,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(De){ns(o,o.return,De)}}else wl(r,o,p,w);break;case 31:wl(r,o,p,w);break;case 13:wl(r,o,p,w);break;case 23:break;case 22:D=o.stateNode,W=o.alternate,o.memoizedState!==null?D._visibility&2?wl(r,o,p,w):xd(r,o):D._visibility&2?wl(r,o,p,w):(D._visibility|=2,bh(r,o,p,w,(o.subtreeFlags&10256)!==0||!1)),P&2048&&Yp(W,o);break;case 24:wl(r,o,p,w),P&2048&&Xp(o.alternate,o);break;default:wl(r,o,p,w)}}function bh(r,o,p,w,P){for(P=P&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var D=r,W=o,pe=p,De=w,ft=W.flags;switch(W.tag){case 0:case 11:case 15:bh(D,W,pe,De,P),md(8,W);break;case 23:break;case 22:var St=W.stateNode;W.memoizedState!==null?St._visibility&2?bh(D,W,pe,De,P):xd(D,W):(St._visibility|=2,bh(D,W,pe,De,P)),P&&ft&2048&&Yp(W.alternate,W);break;case 24:bh(D,W,pe,De,P),P&&ft&2048&&Xp(W.alternate,W);break;default:bh(D,W,pe,De,P)}o=o.sibling}}function xd(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var p=r,w=o,P=w.flags;switch(w.tag){case 22:xd(p,w),P&2048&&Yp(w.alternate,w);break;case 24:xd(p,w),P&2048&&Xp(w.alternate,w);break;default:xd(p,w)}o=o.sibling}}var bd=8192;function wh(r,o,p){if(r.subtreeFlags&bd)for(r=r.child;r!==null;)wd(r,o,p),r=r.sibling}function wd(r,o,p){switch(r.tag){case 26:wh(r,o,p),r.flags&bd&&r.memoizedState!==null&&wc(p,xo,r.memoizedState,r.memoizedProps);break;case 5:wh(r,o,p);break;case 3:case 4:var w=xo;xo=Ci(r.stateNode.containerInfo),wh(r,o,p),xo=w;break;case 22:r.memoizedState===null&&(w=r.alternate,w!==null&&w.memoizedState!==null?(w=bd,bd=16777216,wh(r,o,p),bd=w):wh(r,o,p));break;default:wh(r,o,p)}}function Du(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Sh(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var w=o[p];Er=w,jg(w,r)}Du(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)wf(r),r=r.sibling}function wf(r){switch(r.tag){case 0:case 11:case 15:Sh(r),r.flags&2048&&$o(9,r,r.return);break;case 3:Sh(r);break;case 12:Sh(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Th(r)):Sh(r);break;default:Sh(r)}}function Th(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var w=o[p];Er=w,jg(w,r)}Du(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:$o(8,o,o.return),Th(o);break;case 22:p=o.stateNode,p._visibility&2&&(p._visibility&=-3,Th(o));break;default:Th(o)}r=r.sibling}}function jg(r,o){for(;Er!==null;){var p=Er;switch(p.tag){case 0:case 11:case 15:$o(8,p,o);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var w=p.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:_l(p.memoizedState.cache)}if(w=p.child,w!==null)w.return=p,Er=w;else e:for(p=r;Er!==null;){w=Er;var P=w.sibling,D=w.return;if(Mg(w),w===p){Er=null;break e}if(P!==null){P.return=D,Er=P;break e}Er=D}}}var S_={getCacheForType:function(r){var o=nn(ws),p=o.data.get(r);return p===void 0&&(p=r(),o.data.set(r,p)),p},cacheSignal:function(){return nn(ws).controller.signal}},T_=typeof WeakMap=="function"?WeakMap:Map,Wn=0,ps=null,zi=null,kn=0,is=0,ur=null,Uo=!1,Gl=!1,su=!1,Fo=0,Ms=0,ru=0,Ou=0,Sf=0,eo=0,Eh=0,kh=null,Ia=null,Sd=!1,Ch=0,Lg=0,Tf=1/0,Td=null,bc=null,Fs=0,ta=null,bo=null,Wl=0,Ed=0,Kp=null,Rg=null,au=0,kd=null;function wo(){return(Wn&2)!==0&&kn!==0?kn&-kn:$e.T!==null?Lh():Bt()}function Ef(){if(eo===0)if((kn&536870912)===0||Lt){var r=$n;$n<<=1,($n&3932160)===0&&($n=262144),eo=r}else eo=536870912;return r=ls.current,r!==null&&(r.flags|=32),eo}function ga(r,o,p){(r===ps&&(is===2||is===9)||r.cancelPendingCommit!==null)&&(Bu(r,0),Yl(r,kn,eo,!1)),Ne(r,p),((Wn&2)===0||r!==ps)&&(r===ps&&((Wn&2)===0&&(Ou|=p),Ms===4&&Yl(r,kn,eo,!1)),Xl(r))}function Nu(r,o,p){if((Wn&6)!==0)throw Error(l(327));var w=!p&&(o&127)===0&&(o&r.expiredLanes)===0||te(r,o),P=w?tm(r,o):em(r,o,!0),D=w;do{if(P===0){Gl&&!w&&Yl(r,o,0,!1);break}else{if(p=r.current.alternate,D&&!zg(p)){P=em(r,o,!1),D=!1;continue}if(P===2){if(D=o,r.errorRecoveryDisabledLanes&D)var W=0;else W=r.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){o=W;e:{var pe=r;P=kh;var De=pe.current.memoizedState.isDehydrated;if(De&&(Bu(pe,W).flags|=256),W=em(pe,W,!1),W!==2){if(su&&!De){pe.errorRecoveryDisabledLanes|=D,Ou|=D,P=4;break e}D=Ia,Ia=P,D!==null&&(Ia===null?Ia=D:Ia.push.apply(Ia,D))}P=W}if(D=!1,P!==2)continue}}if(P===1){Bu(r,0),Yl(r,o,0,!0);break}e:{switch(w=r,D=P,D){case 0:case 1:throw Error(l(345));case 4:if((o&4194048)!==o)break;case 6:Yl(w,o,eo,!Uo);break e;case 2:Ia=null;break;case 3:case 5:break;default:throw Error(l(329))}if((o&62914560)===o&&(P=Ch+300-Xi(),10<P)){if(Yl(w,o,eo,!Uo),ie(w,0,!0)!==0)break e;Wl=o,w.timeoutHandle=q(Jp.bind(null,w,p,Ia,Td,Sd,o,eo,Ou,Eh,Uo,D,"Throttled",-0,0),P);break e}Jp(w,p,Ia,Td,Sd,o,eo,Ou,Eh,Uo,D,null,-0,0)}}break}while(!0);Xl(r)}function Jp(r,o,p,w,P,D,W,pe,De,ft,St,Rt,mt,vt){if(r.timeoutHandle=-1,Rt=o.subtreeFlags,Rt&8192||(Rt&16785408)===16785408){Rt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:qs},wd(o,D,Rt);var mi=(D&62914560)===D?Ch-Xi():(D&4194048)===D?Lg-Xi():0;if(mi=Zg(Rt,mi),mi!==null){Wl=D,r.cancelPendingCommit=mi(Cf.bind(null,r,o,D,p,w,P,W,pe,De,St,Rt,null,mt,vt)),Yl(r,D,W,!ft);return}}Cf(r,o,D,p,w,P,W,pe,De)}function zg(r){for(var o=r;;){var p=o.tag;if((p===0||p===11||p===15)&&o.flags&16384&&(p=o.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var w=0;w<p.length;w++){var P=p[w],D=P.getSnapshot;P=P.value;try{if(!Gs(D(),P))return!1}catch{return!1}}if(p=o.child,o.subtreeFlags&16384&&p!==null)p.return=o,o=p;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Yl(r,o,p,w){o&=~Sf,o&=~Ou,r.suspendedLanes|=o,r.pingedLanes&=~o,w&&(r.warmLanes|=o),w=r.expirationTimes;for(var P=o;0<P;){var D=31-Bi(P),W=1<<D;w[D]=-1,P&=~W}p!==0&&ee(r,p,o)}function Cd(){return(Wn&6)===0?(Ih(0),!1):!0}function Ah(){if(zi!==null){if(is===0)var r=zi.return;else r=zi,Za=Qr=null,Gc(r),Ie=null,ze=0,r=zi;for(;r!==null;)Sg(r.alternate,r),r=r.return;zi=null}}function Bu(r,o){var p=r.timeoutHandle;p!==-1&&(r.timeoutHandle=-1,G(p)),p=r.cancelPendingCommit,p!==null&&(r.cancelPendingCommit=null,p()),Wl=0,Ah(),ps=r,zi=p=Xr(r.current,null),kn=o,is=0,ur=null,Uo=!1,Gl=te(r,o),su=!1,Eh=eo=Sf=Ou=ru=Ms=0,Ia=kh=null,Sd=!1,(o&8)!==0&&(o|=o&32);var w=r.entangledLanes;if(w!==0)for(r=r.entanglements,w&=o;0<w;){var P=31-Bi(w),D=1<<P;o|=r[P],w&=~D}return Fo=o,wr(),p}function Dg(r,o){Pi=null,$e.H=ud,o===O||o===H?(o=Ee(),is=3):o===U?(o=Ee(),is=4):is=o===ks?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ur=o,zi===null&&(Ms=1,gf(r,b(o,r.current)))}function Og(){var r=ls.current;return r===null?!0:(kn&4194048)===kn?cs===null:(kn&62914560)===kn||(kn&536870912)!==0?r===cs:!1}function Qp(){var r=$e.H;return $e.H=ud,r===null?ud:r}function Ng(){var r=$e.A;return $e.A=S_,r}function kf(){Ms=4,Uo||(kn&4194048)!==kn&&ls.current!==null||(Gl=!0),(ru&134217727)===0&&(Ou&134217727)===0||ps===null||Yl(ps,kn,eo,!1)}function em(r,o,p){var w=Wn;Wn|=2;var P=Qp(),D=Ng();(ps!==r||kn!==o)&&(Td=null,Bu(r,o)),o=!1;var W=Ms;e:do try{if(is!==0&&zi!==null){var pe=zi,De=ur;switch(is){case 8:Ah(),W=6;break e;case 3:case 2:case 9:case 6:ls.current===null&&(o=!0);var ft=is;if(is=0,ur=null,$u(r,pe,De,ft),p&&Gl){W=0;break e}break;default:ft=is,is=0,ur=null,$u(r,pe,De,ft)}}E_(),W=Ms;break}catch(St){Dg(r,St)}while(!0);return o&&r.shellSuspendCounter++,Za=Qr=null,Wn=w,$e.H=P,$e.A=D,zi===null&&(ps=null,kn=0,wr()),W}function E_(){for(;zi!==null;)im(zi)}function tm(r,o){var p=Wn;Wn|=2;var w=Qp(),P=Ng();ps!==r||kn!==o?(Td=null,Tf=Xi()+500,Bu(r,o)):Gl=te(r,o);e:do try{if(is!==0&&zi!==null){o=zi;var D=ur;t:switch(is){case 1:is=0,ur=null,$u(r,o,D,1);break;case 2:case 9:if(X(D)){is=0,ur=null,nm(o);break}o=function(){is!==2&&is!==9||ps!==r||(is=7),Xl(r)},D.then(o,o);break e;case 3:is=7;break e;case 4:is=5;break e;case 7:X(D)?(is=0,ur=null,nm(o)):(is=0,ur=null,$u(r,o,D,7));break;case 5:var W=null;switch(zi.tag){case 26:W=zi.memoizedState;case 5:case 27:var pe=zi;if(W?mr(W):pe.stateNode.complete){is=0,ur=null;var De=pe.sibling;if(De!==null)zi=De;else{var ft=pe.return;ft!==null?(zi=ft,Ad(ft)):zi=null}break t}}is=0,ur=null,$u(r,o,D,5);break;case 6:is=0,ur=null,$u(r,o,D,6);break;case 8:Ah(),Ms=6;break e;default:throw Error(l(462))}}ou();break}catch(St){Dg(r,St)}while(!0);return Za=Qr=null,$e.H=w,$e.A=P,Wn=p,zi!==null?0:(ps=null,kn=0,wr(),Ms)}function ou(){for(;zi!==null&&!Hn();)im(zi)}function im(r){var o=bg(r.alternate,r,Fo);r.memoizedProps=r.pendingProps,o===null?Ad(r):zi=o}function nm(r){var o=r,p=o.alternate;switch(o.tag){case 15:case 0:o=Op(p,o,o.pendingProps,o.type,void 0,kn);break;case 11:o=Op(p,o,o.pendingProps,o.type.render,o.ref,kn);break;case 5:Gc(o);default:Sg(p,o),o=zi=ac(o,Fo),o=bg(p,o,Fo)}r.memoizedProps=r.pendingProps,o===null?Ad(r):zi=o}function $u(r,o,p,w){Za=Qr=null,Gc(o),Ie=null,ze=0;var P=o.return;try{if(v_(r,P,o,p,kn)){Ms=1,gf(r,b(p,r.current)),zi=null;return}}catch(D){if(P!==null)throw zi=P,D;Ms=1,gf(r,b(p,r.current)),zi=null;return}o.flags&32768?(Lt||w===1?r=!0:Gl||(kn&536870912)!==0?r=!1:(Uo=r=!0,(w===2||w===9||w===3||w===6)&&(w=ls.current,w!==null&&w.tag===13&&(w.flags|=16384))),sm(o,r)):Ad(o)}function Ad(r){var o=r;do{if((o.flags&32768)!==0){sm(o,Uo);return}r=o.return;var p=b_(o.alternate,o,Fo);if(p!==null){zi=p;return}if(o=o.sibling,o!==null){zi=o;return}zi=o=r}while(o!==null);Ms===0&&(Ms=5)}function sm(r,o){do{var p=wg(r.alternate,r);if(p!==null){p.flags&=32767,zi=p;return}if(p=r.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!o&&(r=r.sibling,r!==null)){zi=r;return}zi=r=p}while(r!==null);Ms=6,zi=null}function Cf(r,o,p,w,P,D,W,pe,De){r.cancelPendingCommit=null;do ya();while(Fs!==0);if((Wn&6)!==0)throw Error(l(327));if(o!==null){if(o===r.current)throw Error(l(177));if(D=o.lanes|o.childLanes,D|=os,Ze(r,p,D,W,pe,De),r===ps&&(zi=ps=null,kn=0),bo=o,ta=r,Wl=p,Ed=D,Kp=P,Rg=w,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Ug(Ct,function(){return Ph(),null})):(r.callbackNode=null,r.callbackPriority=0),w=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||w){w=$e.T,$e.T=null,P=ct.p,ct.p=2,W=Wn,Wn|=4;try{w_(r,o,p)}finally{Wn=W,ct.p=P,$e.T=w}}Fs=1,Mh(),rm(),Af()}}function Mh(){if(Fs===1){Fs=0;var r=ta,o=bo,p=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||p){p=$e.T,$e.T=null;var w=ct.p;ct.p=2;var P=Wn;Wn|=4;try{Wp(o,r);var D=m,W=qa(r.containerInfo),pe=D.focusedElem,De=D.selectionRange;if(W!==pe&&pe&&pe.ownerDocument&&nc(pe.ownerDocument.documentElement,pe)){if(De!==null&&fo(pe)){var ft=De.start,St=De.end;if(St===void 0&&(St=ft),"selectionStart"in pe)pe.selectionStart=ft,pe.selectionEnd=Math.min(St,pe.value.length);else{var Rt=pe.ownerDocument||document,mt=Rt&&Rt.defaultView||window;if(mt.getSelection){var vt=mt.getSelection(),mi=pe.textContent.length,Ni=Math.min(De.start,mi),Ss=De.end===void 0?Ni:Math.min(De.end,mi);!vt.extend&&Ni>Ss&&(W=Ss,Ss=Ni,Ni=W);var nt=ic(pe,Ni),qe=ic(pe,Ss);if(nt&&qe&&(vt.rangeCount!==1||vt.anchorNode!==nt.node||vt.anchorOffset!==nt.offset||vt.focusNode!==qe.node||vt.focusOffset!==qe.offset)){var ht=Rt.createRange();ht.setStart(nt.node,nt.offset),vt.removeAllRanges(),Ni>Ss?(vt.addRange(ht),vt.extend(qe.node,qe.offset)):(ht.setEnd(qe.node,qe.offset),vt.addRange(ht))}}}}for(Rt=[],vt=pe;vt=vt.parentNode;)vt.nodeType===1&&Rt.push({element:vt,left:vt.scrollLeft,top:vt.scrollTop});for(typeof pe.focus=="function"&&pe.focus(),pe=0;pe<Rt.length;pe++){var Mt=Rt[pe];Mt.element.scrollLeft=Mt.left,Mt.element.scrollTop=Mt.top}}Df=!!c,m=c=null}finally{Wn=P,ct.p=w,$e.T=p}}r.current=o,Fs=2}}function rm(){if(Fs===2){Fs=0;var r=ta,o=bo,p=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||p){p=$e.T,$e.T=null;var w=ct.p;ct.p=2;var P=Wn;Wn|=4;try{Ag(r,o.alternate,o)}finally{Wn=P,ct.p=w,$e.T=p}}Fs=3}}function Af(){if(Fs===4||Fs===3){Fs=0,es();var r=ta,o=bo,p=Wl,w=Rg;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Fs=5:(Fs=0,bo=ta=null,am(r,r.pendingLanes));var P=r.pendingLanes;if(P===0&&(bc=null),Ve(p),o=o.stateNode,ri&&typeof ri.onCommitFiberRoot=="function")try{ri.onCommitFiberRoot(jt,o,void 0,(o.current.flags&128)===128)}catch{}if(w!==null){o=$e.T,P=ct.p,ct.p=2,$e.T=null;try{for(var D=r.onRecoverableError,W=0;W<w.length;W++){var pe=w[W];D(pe.value,{componentStack:pe.stack})}}finally{$e.T=o,ct.p=P}}(Wl&3)!==0&&ya(),Xl(r),P=r.pendingLanes,(p&261930)!==0&&(P&42)!==0?r===kd?au++:(au=0,kd=r):au=0,Ih(0)}}function am(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,_l(o)))}function ya(){return Mh(),rm(),Af(),Ph()}function Ph(){if(Fs!==5)return!1;var r=ta,o=Ed;Ed=0;var p=Ve(Wl),w=$e.T,P=ct.p;try{ct.p=32>p?32:p,$e.T=null,p=Kp,Kp=null;var D=ta,W=Wl;if(Fs=0,bo=ta=null,Wl=0,(Wn&6)!==0)throw Error(l(331));var pe=Wn;if(Wn|=4,wf(D.current),Ig(D,D.current,W,p),Wn=pe,Ih(0,!1),ri&&typeof ri.onPostCommitFiberRoot=="function")try{ri.onPostCommitFiberRoot(jt,D)}catch{}return!0}finally{ct.p=P,$e.T=w,am(r,o)}}function om(r,o,p){o=b(p,o),o=hd(r.stateNode,o,2),r=ni(r,o,2),r!==null&&(Ne(r,2),Xl(r))}function ns(r,o,p){if(r.tag===3)om(r,r,p);else for(;o!==null;){if(o.tag===3){om(o,r,p);break}else if(o.tag===1){var w=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(bc===null||!bc.has(w))){r=b(p,r),p=gg(2),w=ni(o,p,2),w!==null&&(Ru(p,w,o,r),Ne(w,2),Xl(w));break}}o=o.return}}function Mf(r,o,p){var w=r.pingCache;if(w===null){w=r.pingCache=new T_;var P=new Set;w.set(o,P)}else P=w.get(o),P===void 0&&(P=new Set,w.set(o,P));P.has(p)||(su=!0,P.add(p),r=Bg.bind(null,r,o,p),o.then(r,r))}function Bg(r,o,p){var w=r.pingCache;w!==null&&w.delete(o),r.pingedLanes|=r.suspendedLanes&p,r.warmLanes&=~p,ps===r&&(kn&p)===p&&(Ms===4||Ms===3&&(kn&62914560)===kn&&300>Xi()-Ch?(Wn&2)===0&&Bu(r,0):Sf|=p,Eh===kn&&(Eh=0)),Xl(r)}function lm(r,o){o===0&&(o=we()),r=pa(r,o),r!==null&&(Ne(r,o),Xl(r))}function $g(r){var o=r.memoizedState,p=0;o!==null&&(p=o.retryLane),lm(r,p)}function k_(r,o){var p=0;switch(r.tag){case 31:case 13:var w=r.stateNode,P=r.memoizedState;P!==null&&(p=P.retryLane);break;case 19:w=r.stateNode;break;case 22:w=r.stateNode._retryCache;break;default:throw Error(l(314))}w!==null&&w.delete(o),lm(r,p)}function Ug(r,o){return fi(r,o)}var Sl=null,Uu=null,Pf=!1,Md=!1,If=!1,lu=0;function Xl(r){r!==Uu&&r.next===null&&(Uu===null?Sl=Uu=r:Uu=Uu.next=r),Md=!0,Pf||(Pf=!0,jf())}function Ih(r,o){if(!If&&Md){If=!0;do for(var p=!1,w=Sl;w!==null;){if(r!==0){var P=w.pendingLanes;if(P===0)var D=0;else{var W=w.suspendedLanes,pe=w.pingedLanes;D=(1<<31-Bi(42|r)+1)-1,D&=P&~(W&~pe),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(p=!0,Id(w,D))}else D=kn,D=ie(w,w===ps?D:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(D&3)===0||te(w,D)||(p=!0,Id(w,D));w=w.next}while(p);If=!1}}function jh(){cm()}function cm(){Md=Pf=!1;var r=0;lu!==0&&F()&&(r=lu);for(var o=Xi(),p=null,w=Sl;w!==null;){var P=w.next,D=Pd(w,o);D===0?(w.next=null,p===null?Sl=P:p.next=P,P===null&&(Uu=p)):(p=w,(r!==0||(D&3)!==0)&&(Md=!0)),w=P}Fs!==0&&Fs!==5||Ih(r),lu!==0&&(lu=0)}function Pd(r,o){for(var p=r.suspendedLanes,w=r.pingedLanes,P=r.expirationTimes,D=r.pendingLanes&-62914561;0<D;){var W=31-Bi(D),pe=1<<W,De=P[W];De===-1?((pe&p)===0||(pe&w)!==0)&&(P[W]=he(pe,o)):De<=o&&(r.expiredLanes|=pe),D&=~pe}if(o=ps,p=kn,p=ie(r,r===o?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),w=r.callbackNode,p===0||r===o&&(is===2||is===9)||r.cancelPendingCommit!==null)return w!==null&&w!==null&&xn(w),r.callbackNode=null,r.callbackPriority=0;if((p&3)===0||te(r,p)){if(o=p&-p,o===r.callbackPriority)return o;switch(w!==null&&xn(w),Ve(p)){case 2:case 8:p=gs;break;case 32:p=Ct;break;case 268435456:p=an;break;default:p=Ct}return w=um.bind(null,r),p=fi(p,w),r.callbackPriority=o,r.callbackNode=p,o}return w!==null&&w!==null&&xn(w),r.callbackPriority=2,r.callbackNode=null,2}function um(r,o){if(Fs!==0&&Fs!==5)return r.callbackNode=null,r.callbackPriority=0,null;var p=r.callbackNode;if(ya()&&r.callbackNode!==p)return null;var w=kn;return w=ie(r,r===ps?w:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),w===0?null:(Nu(r,w,o),Pd(r,Xi()),r.callbackNode!=null&&r.callbackNode===p?um.bind(null,r):null)}function Id(r,o){if(ya())return null;Nu(r,o,!0)}function jf(){ae(function(){(Wn&6)!==0?fi(Wi,jh):cm()})}function Lh(){if(lu===0){var r=vl;r===0&&(r=Dn,Dn<<=1,(Dn&261888)===0&&(Dn=256)),lu=r}return lu}function Fg(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:jl(""+r)}function Vg(r,o){var p=o.ownerDocument.createElement("input");return p.name=o.name,p.value=o.value,r.id&&p.setAttribute("form",r.id),o.parentNode.insertBefore(p,o),r=new FormData(r),p.parentNode.removeChild(p),r}function C_(r,o,p,w,P){if(o==="submit"&&p&&p.stateNode===P){var D=Fg((P[ti]||null).action),W=w.submitter;W&&(o=(o=W[ti]||null)?Fg(o.formAction):W.getAttribute("formAction"),o!==null&&(D=o,W=null));var pe=new zc("action","action",null,w,P);r.push({event:pe,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(lu!==0){var De=W?Vg(P,W):new FormData(P);df(p,{pending:!0,data:De,method:P.method,action:D},null,De)}}else typeof D=="function"&&(pe.preventDefault(),De=W?Vg(P,W):new FormData(P),df(p,{pending:!0,data:De,method:P.method,action:D},D,De))},currentTarget:P}]})}}for(var cu=0;cu<fa.length;cu++){var hr=fa[cu],uu=hr.toLowerCase(),hm=hr[0].toUpperCase()+hr.slice(1);Kn(uu,"on"+hm)}Kn(Ro,"onAnimationEnd"),Kn(rc,"onAnimationIteration"),Kn(hl,"onAnimationStart"),Kn("dblclick","onDoubleClick"),Kn("focusin","onFocus"),Kn("focusout","onBlur"),Kn(Qh,"onTransitionRun"),Kn(Tu,"onTransitionStart"),Kn(Vc,"onTransitionCancel"),Kn(zo,"onTransitionEnd"),vr("onMouseEnter",["mouseout","mouseover"]),vr("onMouseLeave",["mouseout","mouseover"]),vr("onPointerEnter",["pointerout","pointerover"]),vr("onPointerLeave",["pointerout","pointerover"]),Li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Li("onBeforeInput",["compositionend","keypress","textInput","paste"]),Li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rh));function Lf(r,o){o=(o&4)!==0;for(var p=0;p<r.length;p++){var w=r[p],P=w.event;w=w.listeners;e:{var D=void 0;if(o)for(var W=w.length-1;0<=W;W--){var pe=w[W],De=pe.instance,ft=pe.currentTarget;if(pe=pe.listener,De!==D&&P.isPropagationStopped())break e;D=pe,P.currentTarget=ft;try{D(P)}catch(St){Aa(St)}P.currentTarget=null,D=De}else for(W=0;W<w.length;W++){if(pe=w[W],De=pe.instance,ft=pe.currentTarget,pe=pe.listener,De!==D&&P.isPropagationStopped())break e;D=pe,P.currentTarget=ft;try{D(P)}catch(St){Aa(St)}P.currentTarget=null,D=De}}}}function Mn(r,o){var p=o[ji];p===void 0&&(p=o[ji]=new Set);var w=r+"__bubble";p.has(w)||(fm(o,r,2,!1),p.add(w))}function Rf(r,o,p){var w=0;o&&(w|=4),fm(p,r,w,o)}var jd="_reactListening"+Math.random().toString(36).slice(2);function dm(r){if(!r[jd]){r[jd]=!0,Ti.forEach(function(p){p!=="selectionchange"&&(qg.has(p)||Rf(p,!1,r),Rf(p,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[jd]||(o[jd]=!0,Rf("selectionchange",!1,o))}}function fm(r,o,p,w){switch(Br(o)){case 2:var P=El;break;case 8:P=Of;break;default:P=Nf}p=P.bind(null,o,p,r),P=void 0,!Ll||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(P=!0),w?P!==void 0?r.addEventListener(o,p,{capture:!0,passive:P}):r.addEventListener(o,p,!0):P!==void 0?r.addEventListener(o,p,{passive:P}):r.addEventListener(o,p,!1)}function Ld(r,o,p,w,P){var D=w;if((o&1)===0&&(o&2)===0&&w!==null)e:for(;;){if(w===null)return;var W=w.tag;if(W===3||W===4){var pe=w.stateNode.containerInfo;if(pe===P)break;if(W===4)for(W=w.return;W!==null;){var De=W.tag;if((De===3||De===4)&&W.stateNode.containerInfo===P)return;W=W.return}for(;pe!==null;){if(W=Ot(pe),W===null)return;if(De=W.tag,De===5||De===6||De===26||De===27){w=D=W;continue e}pe=pe.parentNode}}w=w.return}Lc(function(){var ft=D,St=Hs(p),Rt=[];e:{var mt=Bl.get(r);if(mt!==void 0){var vt=zc,mi=r;switch(r){case"keypress":if(Ko(p)===0)break e;case"keydown":case"keyup":vt=sh;break;case"focusin":mi="focus",vt=Dc;break;case"focusout":mi="blur",vt=Dc;break;case"beforeblur":case"afterblur":vt=Dc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=Jo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=Qu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=rh;break;case Ro:case rc:case hl:vt=Oc;break;case zo:vt=wu;break;case"scroll":case"scrollend":vt=tn;break;case"wheel":vt=xr;break;case"copy":case"cut":case"paste":vt=Ta;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=bu;break;case"toggle":case"beforetoggle":vt=tl}var Ni=(o&4)!==0,Ss=!Ni&&(r==="scroll"||r==="scrollend"),nt=Ni?mt!==null?mt+"Capture":null:mt;Ni=[];for(var qe=ft,ht;qe!==null;){var Mt=qe;if(ht=Mt.stateNode,Mt=Mt.tag,Mt!==5&&Mt!==26&&Mt!==27||ht===null||nt===null||(Mt=aa(qe,nt),Mt!=null&&Ni.push(Fu(qe,Mt,ht))),Ss)break;qe=qe.return}0<Ni.length&&(mt=new vt(mt,mi,null,p,St),Rt.push({event:mt,listeners:Ni}))}}if((o&7)===0){e:{if(mt=r==="mouseover"||r==="pointerover",vt=r==="mouseout"||r==="pointerout",mt&&p!==Ao&&(mi=p.relatedTarget||p.fromElement)&&(Ot(mi)||mi[pi]))break e;if((vt||mt)&&(mt=St.window===St?St:(mt=St.ownerDocument)?mt.defaultView||mt.parentWindow:window,vt?(mi=p.relatedTarget||p.toElement,vt=ft,mi=mi?Ot(mi):null,mi!==null&&(Ss=_(mi),Ni=mi.tag,mi!==Ss||Ni!==5&&Ni!==27&&Ni!==6)&&(mi=null)):(vt=null,mi=ft),vt!==mi)){if(Ni=Jo,Mt="onMouseLeave",nt="onMouseEnter",qe="mouse",(r==="pointerout"||r==="pointerover")&&(Ni=bu,Mt="onPointerLeave",nt="onPointerEnter",qe="pointer"),Ss=vt==null?mt:ln(vt),ht=mi==null?mt:ln(mi),mt=new Ni(Mt,qe+"leave",vt,p,St),mt.target=Ss,mt.relatedTarget=ht,Mt=null,Ot(St)===ft&&(Ni=new Ni(nt,qe+"enter",mi,p,St),Ni.target=ht,Ni.relatedTarget=Ss,Mt=Ni),Ss=Mt,vt&&mi)t:{for(Ni=zd,nt=vt,qe=mi,ht=0,Mt=nt;Mt;Mt=Ni(Mt))ht++;Mt=0;for(var Ri=qe;Ri;Ri=Ni(Ri))Mt++;for(;0<ht-Mt;)nt=Ni(nt),ht--;for(;0<Mt-ht;)qe=Ni(qe),Mt--;for(;ht--;){if(nt===qe||qe!==null&&nt===qe.alternate){Ni=nt;break t}nt=Ni(nt),qe=Ni(qe)}Ni=null}else Ni=null;vt!==null&&zf(Rt,mt,vt,Ni,!1),mi!==null&&Ss!==null&&zf(Rt,Ss,mi,Ni,!0)}}e:{if(mt=ft?ln(ft):window,vt=mt.nodeName&&mt.nodeName.toLowerCase(),vt==="select"||vt==="input"&&mt.type==="file")var rs=rl;else if(Rr(mt))if(Uc)rs=Ol;else{rs=Fc;var Si=Gr}else vt=mt.nodeName,!vt||vt.toLowerCase()!=="input"||mt.type!=="checkbox"&&mt.type!=="radio"?ft&&Il(ft.elementType)&&(rs=rl):rs=ka;if(rs&&(rs=rs(r,ft))){zl(Rt,rs,p,St);break e}Si&&Si(r,mt,ft),r==="focusout"&&ft&&mt.type==="number"&&ft.memoizedProps.value!=null&&wa(mt,"number",mt.value)}switch(Si=ft?ln(ft):window,r){case"focusin":(Rr(Si)||Si.contentEditable==="true")&&(po=Si,sc=ft,Lo=null);break;case"focusout":Lo=sc=po=null;break;case"mousedown":mo=!0;break;case"contextmenu":case"mouseup":case"dragend":mo=!1,cl(Rt,p,St);break;case"selectionchange":if(ll)break;case"keydown":case"keyup":cl(Rt,p,St)}var wn;if(il)e:{switch(r){case"compositionstart":var Bn="onCompositionStart";break e;case"compositionend":Bn="onCompositionEnd";break e;case"compositionupdate":Bn="onCompositionUpdate";break e}Bn=void 0}else ho?ah(r,p)&&(Bn="onCompositionEnd"):r==="keydown"&&p.keyCode===229&&(Bn="onCompositionStart");Bn&&(Rl&&p.locale!=="ko"&&(ho||Bn!=="onCompositionStart"?Bn==="onCompositionEnd"&&ho&&(wn=la()):($a=St,Xo="value"in $a?$a.value:$a.textContent,ho=!0)),Si=Rd(ft,Bn),0<Si.length&&(Bn=new co(Bn,r,null,p,St),Rt.push({event:Bn,listeners:Si}),wn?Bn.data=wn:(wn=Hi(p),wn!==null&&(Bn.data=wn)))),(wn=nl?gn(r,p):En(r,p))&&(Bn=Rd(ft,"onBeforeInput"),0<Bn.length&&(Si=new co("onBeforeInput","beforeinput",null,p,St),Rt.push({event:Si,listeners:Bn}),Si.data=wn)),C_(Rt,r,ft,p,St)}Lf(Rt,o)})}function Fu(r,o,p){return{instance:r,listener:o,currentTarget:p}}function Rd(r,o){for(var p=o+"Capture",w=[];r!==null;){var P=r,D=P.stateNode;if(P=P.tag,P!==5&&P!==26&&P!==27||D===null||(P=aa(r,p),P!=null&&w.unshift(Fu(r,P,D)),P=aa(r,o),P!=null&&w.push(Fu(r,P,D))),r.tag===3)return w;r=r.return}return[]}function zd(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function zf(r,o,p,w,P){for(var D=o._reactName,W=[];p!==null&&p!==w;){var pe=p,De=pe.alternate,ft=pe.stateNode;if(pe=pe.tag,De!==null&&De===w)break;pe!==5&&pe!==26&&pe!==27||ft===null||(De=ft,P?(ft=aa(p,D),ft!=null&&W.unshift(Fu(p,ft,De))):P||(ft=aa(p,D),ft!=null&&W.push(Fu(p,ft,De)))),p=p.return}W.length!==0&&r.push({event:o,listeners:W})}var Hg=/\r\n?/g,pm=/\u0000|\uFFFD/g;function Dd(r){return(typeof r=="string"?r:""+r).replace(Hg,`
`).replace(pm,"")}function zh(r,o){return o=Dd(o),Dd(r)===o}function ss(r,o,p,w,P,D){switch(p){case"children":typeof w=="string"?o==="body"||o==="textarea"&&w===""||Zr(r,w):(typeof w=="number"||typeof w=="bigint")&&o!=="body"&&Zr(r,""+w);break;case"className":An(r,"class",w);break;case"tabIndex":An(r,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":An(r,p,w);break;case"style":lo(r,w,D);break;case"data":if(o!=="object"){An(r,"data",w);break}case"src":case"href":if(w===""&&(o!=="a"||p!=="href")){r.removeAttribute(p);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){r.removeAttribute(p);break}w=jl(""+w),r.setAttribute(p,w);break;case"action":case"formAction":if(typeof w=="function"){r.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(p==="formAction"?(o!=="input"&&ss(r,o,"name",P.name,P,null),ss(r,o,"formEncType",P.formEncType,P,null),ss(r,o,"formMethod",P.formMethod,P,null),ss(r,o,"formTarget",P.formTarget,P,null)):(ss(r,o,"encType",P.encType,P,null),ss(r,o,"method",P.method,P,null),ss(r,o,"target",P.target,P,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){r.removeAttribute(p);break}w=jl(""+w),r.setAttribute(p,w);break;case"onClick":w!=null&&(r.onclick=qs);break;case"onScroll":w!=null&&Mn("scroll",r);break;case"onScrollEnd":w!=null&&Mn("scrollend",r);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(l(61));if(p=w.__html,p!=null){if(P.children!=null)throw Error(l(60));r.innerHTML=p}}break;case"multiple":r.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":r.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){r.removeAttribute("xlink:href");break}p=jl(""+w),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?r.setAttribute(p,""+w):r.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?r.setAttribute(p,""):r.removeAttribute(p);break;case"capture":case"download":w===!0?r.setAttribute(p,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?r.setAttribute(p,w):r.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?r.setAttribute(p,w):r.removeAttribute(p);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?r.removeAttribute(p):r.setAttribute(p,w);break;case"popover":Mn("beforetoggle",r),Mn("toggle",r),yi(r,"popover",w);break;case"xlinkActuate":bs(r,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":bs(r,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":bs(r,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":bs(r,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":bs(r,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":bs(r,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":bs(r,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":bs(r,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":bs(r,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":yi(r,"is",w);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Ic.get(p)||p,yi(r,p,w))}}function Od(r,o,p,w,P,D){switch(p){case"style":lo(r,w,D);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(l(61));if(p=w.__html,p!=null){if(P.children!=null)throw Error(l(60));r.innerHTML=p}}break;case"children":typeof w=="string"?Zr(r,w):(typeof w=="number"||typeof w=="bigint")&&Zr(r,""+w);break;case"onScroll":w!=null&&Mn("scroll",r);break;case"onScrollEnd":w!=null&&Mn("scrollend",r);break;case"onClick":w!=null&&(r.onclick=qs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!en.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(P=p.endsWith("Capture"),o=p.slice(2,P?p.length-7:void 0),D=r[ti]||null,D=D!=null?D[p]:null,typeof D=="function"&&r.removeEventListener(o,D,P),typeof w=="function")){typeof D!="function"&&D!==null&&(p in r?r[p]=null:r.hasAttribute(p)&&r.removeAttribute(p)),r.addEventListener(o,w,P);break e}p in r?r[p]=w:w===!0?r.setAttribute(p,""):yi(r,p,w)}}}function kr(r,o,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mn("error",r),Mn("load",r);var w=!1,P=!1,D;for(D in p)if(p.hasOwnProperty(D)){var W=p[D];if(W!=null)switch(D){case"src":w=!0;break;case"srcSet":P=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,o));default:ss(r,o,D,W,p,null)}}P&&ss(r,o,"srcSet",p.srcSet,p,null),w&&ss(r,o,"src",p.src,p,null);return;case"input":Mn("invalid",r);var pe=D=W=P=null,De=null,ft=null;for(w in p)if(p.hasOwnProperty(w)){var St=p[w];if(St!=null)switch(w){case"name":P=St;break;case"type":W=St;break;case"checked":De=St;break;case"defaultChecked":ft=St;break;case"value":D=St;break;case"defaultValue":pe=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(l(137,o));break;default:ss(r,o,w,St,p,null)}}mn(r,D,pe,De,ft,W,P,!1);return;case"select":Mn("invalid",r),w=W=D=null;for(P in p)if(p.hasOwnProperty(P)&&(pe=p[P],pe!=null))switch(P){case"value":D=pe;break;case"defaultValue":W=pe;break;case"multiple":w=pe;default:ss(r,o,P,pe,p,null)}o=D,p=W,r.multiple=!!w,o!=null?Xn(r,!!w,o,!1):p!=null&&Xn(r,!!w,p,!0);return;case"textarea":Mn("invalid",r),D=P=w=null;for(W in p)if(p.hasOwnProperty(W)&&(pe=p[W],pe!=null))switch(W){case"value":w=pe;break;case"defaultValue":P=pe;break;case"children":D=pe;break;case"dangerouslySetInnerHTML":if(pe!=null)throw Error(l(91));break;default:ss(r,o,W,pe,p,null)}Co(r,w,P,D);return;case"option":for(De in p)p.hasOwnProperty(De)&&(w=p[De],w!=null)&&(De==="selected"?r.selected=w&&typeof w!="function"&&typeof w!="symbol":ss(r,o,De,w,p,null));return;case"dialog":Mn("beforetoggle",r),Mn("toggle",r),Mn("cancel",r),Mn("close",r);break;case"iframe":case"object":Mn("load",r);break;case"video":case"audio":for(w=0;w<Rh.length;w++)Mn(Rh[w],r);break;case"image":Mn("error",r),Mn("load",r);break;case"details":Mn("toggle",r);break;case"embed":case"source":case"link":Mn("error",r),Mn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ft in p)if(p.hasOwnProperty(ft)&&(w=p[ft],w!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,o));default:ss(r,o,ft,w,p,null)}return;default:if(Il(o)){for(St in p)p.hasOwnProperty(St)&&(w=p[St],w!==void 0&&Od(r,o,St,w,p,void 0));return}}for(pe in p)p.hasOwnProperty(pe)&&(w=p[pe],w!=null&&ss(r,o,pe,w,p,null))}function A_(r,o,p,w){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var P=null,D=null,W=null,pe=null,De=null,ft=null,St=null;for(vt in p){var Rt=p[vt];if(p.hasOwnProperty(vt)&&Rt!=null)switch(vt){case"checked":break;case"value":break;case"defaultValue":De=Rt;default:w.hasOwnProperty(vt)||ss(r,o,vt,null,w,Rt)}}for(var mt in w){var vt=w[mt];if(Rt=p[mt],w.hasOwnProperty(mt)&&(vt!=null||Rt!=null))switch(mt){case"type":D=vt;break;case"name":P=vt;break;case"checked":ft=vt;break;case"defaultChecked":St=vt;break;case"value":W=vt;break;case"defaultValue":pe=vt;break;case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(l(137,o));break;default:vt!==Rt&&ss(r,o,mt,vt,w,Rt)}}Ba(r,W,pe,De,ft,St,D,P);return;case"select":vt=W=pe=mt=null;for(D in p)if(De=p[D],p.hasOwnProperty(D)&&De!=null)switch(D){case"value":break;case"multiple":vt=De;default:w.hasOwnProperty(D)||ss(r,o,D,null,w,De)}for(P in w)if(D=w[P],De=p[P],w.hasOwnProperty(P)&&(D!=null||De!=null))switch(P){case"value":mt=D;break;case"defaultValue":pe=D;break;case"multiple":W=D;default:D!==De&&ss(r,o,P,D,w,De)}o=pe,p=W,w=vt,mt!=null?Xn(r,!!p,mt,!1):!!w!=!!p&&(o!=null?Xn(r,!!p,o,!0):Xn(r,!!p,p?[]:"",!1));return;case"textarea":vt=mt=null;for(pe in p)if(P=p[pe],p.hasOwnProperty(pe)&&P!=null&&!w.hasOwnProperty(pe))switch(pe){case"value":break;case"children":break;default:ss(r,o,pe,null,w,P)}for(W in w)if(P=w[W],D=p[W],w.hasOwnProperty(W)&&(P!=null||D!=null))switch(W){case"value":mt=P;break;case"defaultValue":vt=P;break;case"children":break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(l(91));break;default:P!==D&&ss(r,o,W,P,w,D)}Hr(r,mt,vt);return;case"option":for(var mi in p)mt=p[mi],p.hasOwnProperty(mi)&&mt!=null&&!w.hasOwnProperty(mi)&&(mi==="selected"?r.selected=!1:ss(r,o,mi,null,w,mt));for(De in w)mt=w[De],vt=p[De],w.hasOwnProperty(De)&&mt!==vt&&(mt!=null||vt!=null)&&(De==="selected"?r.selected=mt&&typeof mt!="function"&&typeof mt!="symbol":ss(r,o,De,mt,w,vt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ni in p)mt=p[Ni],p.hasOwnProperty(Ni)&&mt!=null&&!w.hasOwnProperty(Ni)&&ss(r,o,Ni,null,w,mt);for(ft in w)if(mt=w[ft],vt=p[ft],w.hasOwnProperty(ft)&&mt!==vt&&(mt!=null||vt!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(l(137,o));break;default:ss(r,o,ft,mt,w,vt)}return;default:if(Il(o)){for(var Ss in p)mt=p[Ss],p.hasOwnProperty(Ss)&&mt!==void 0&&!w.hasOwnProperty(Ss)&&Od(r,o,Ss,void 0,w,mt);for(St in w)mt=w[St],vt=p[St],!w.hasOwnProperty(St)||mt===vt||mt===void 0&&vt===void 0||Od(r,o,St,mt,w,vt);return}}for(var nt in p)mt=p[nt],p.hasOwnProperty(nt)&&mt!=null&&!w.hasOwnProperty(nt)&&ss(r,o,nt,null,w,mt);for(Rt in w)mt=w[Rt],vt=p[Rt],!w.hasOwnProperty(Rt)||mt===vt||mt==null&&vt==null||ss(r,o,Rt,mt,w,vt)}function a(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function n(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,p=performance.getEntriesByType("resource"),w=0;w<p.length;w++){var P=p[w],D=P.transferSize,W=P.initiatorType,pe=P.duration;if(D&&pe&&a(W)){for(W=0,pe=P.responseEnd,w+=1;w<p.length;w++){var De=p[w],ft=De.startTime;if(ft>pe)break;var St=De.transferSize,Rt=De.initiatorType;St&&a(Rt)&&(De=De.responseEnd,W+=St*(De<pe?1:(pe-ft)/(De-ft)))}if(--w,o+=8*(D+W)/(P.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var c=null,m=null;function x(r){return r.nodeType===9?r:r.ownerDocument}function k(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function C(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function j(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var z=null;function F(){var r=window.event;return r&&r.type==="popstate"?r===z?!1:(z=r,!0):(z=null,!1)}var q=typeof setTimeout=="function"?setTimeout:void 0,G=typeof clearTimeout=="function"?clearTimeout:void 0,J=typeof Promise=="function"?Promise:void 0,ae=typeof queueMicrotask=="function"?queueMicrotask:typeof J<"u"?function(r){return J.resolve(null).then(r).catch(ue)}:q;function ue(r){setTimeout(function(){throw r})}function de(r){return r==="head"}function Te(r,o){var p=o,w=0;do{var P=p.nextSibling;if(r.removeChild(p),P&&P.nodeType===8)if(p=P.data,p==="/$"||p==="/&"){if(w===0){r.removeChild(P),$f(o);return}w--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")w++;else if(p==="html")xt(r.ownerDocument.documentElement);else if(p==="head"){p=r.ownerDocument.head,xt(p);for(var D=p.firstChild;D;){var W=D.nextSibling,pe=D.nodeName;D[on]||pe==="SCRIPT"||pe==="STYLE"||pe==="LINK"&&D.rel.toLowerCase()==="stylesheet"||p.removeChild(D),D=W}}else p==="body"&&xt(r.ownerDocument.body);p=P}while(p);$f(o)}function Me(r,o){var p=r;r=0;do{var w=p.nextSibling;if(p.nodeType===1?o?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(o?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),w&&w.nodeType===8)if(p=w.data,p==="/$"){if(r===0)break;r--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||r++;p=w}while(p)}function tt(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var p=o;switch(o=o.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":tt(p),Qe(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}r.removeChild(p)}}function Be(r,o,p,w){for(;r.nodeType===1;){var P=p;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!w&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(w){if(!r[on])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(D=r.getAttribute("rel"),D==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(D!==P.rel||r.getAttribute("href")!==(P.href==null||P.href===""?null:P.href)||r.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin)||r.getAttribute("title")!==(P.title==null?null:P.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(D=r.getAttribute("src"),(D!==(P.src==null?null:P.src)||r.getAttribute("type")!==(P.type==null?null:P.type)||r.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin))&&D&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var D=P.name==null?null:""+P.name;if(P.type==="hidden"&&r.getAttribute("name")===D)return r}else return r;if(r=Vt(r.nextSibling),r===null)break}return null}function Ke(r,o,p){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!p||(r=Vt(r.nextSibling),r===null))return null;return r}function yt(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Vt(r.nextSibling),r===null))return null;return r}function zt(r){return r.data==="$?"||r.data==="$~"}function Kt(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function bi(r,o){var p=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||p.readyState!=="loading")o();else{var w=function(){o(),p.removeEventListener("DOMContentLoaded",w)};p.addEventListener("DOMContentLoaded",w),r._reactRetry=w}}function Vt(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var Wt=null;function di(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var p=r.data;if(p==="/$"||p==="/&"){if(o===0)return Vt(r.nextSibling);o--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||o++}r=r.nextSibling}return null}function ai(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var p=r.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(o===0)return r;o--}else p!=="/$"&&p!=="/&"||o++}r=r.previousSibling}return null}function ii(r,o,p){switch(o=x(p),r){case"html":if(r=o.documentElement,!r)throw Error(l(452));return r;case"head":if(r=o.head,!r)throw Error(l(453));return r;case"body":if(r=o.body,!r)throw Error(l(454));return r;default:throw Error(l(451))}}function xt(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);Qe(r)}var si=new Map,hi=new Set;function Ci(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Cn=ct.d;ct.d={f:Jn,r:dr,D:fr,C:_a,L:va,m:xa,X:pr,S:Os,M:na};function Jn(){var r=Cn.f(),o=Cd();return r||o}function dr(r){var o=ui(r);o!==null&&o.tag===5&&o.type==="form"?Ap(o):Cn.r(r)}var ia=typeof document>"u"?null:document;function Cr(r,o,p){var w=ia;if(w&&typeof o=="string"&&o){var P=Un(o);P='link[rel="'+r+'"][href="'+P+'"]',typeof p=="string"&&(P+='[crossorigin="'+p+'"]'),hi.has(P)||(hi.add(P),r={rel:r,crossOrigin:p,href:o},w.querySelector(P)===null&&(o=w.createElement("link"),kr(o,"link",r),Ft(o),w.head.appendChild(o)))}}function fr(r){Cn.D(r),Cr("dns-prefetch",r,null)}function _a(r,o){Cn.C(r,o),Cr("preconnect",r,o)}function va(r,o,p){Cn.L(r,o,p);var w=ia;if(w&&r&&o){var P='link[rel="preload"][as="'+Un(o)+'"]';o==="image"&&p&&p.imageSrcSet?(P+='[imagesrcset="'+Un(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(P+='[imagesizes="'+Un(p.imageSizes)+'"]')):P+='[href="'+Un(r)+'"]';var D=P;switch(o){case"style":D=nr(r);break;case"script":D=_n(r)}si.has(D)||(r=N({rel:"preload",href:o==="image"&&p&&p.imageSrcSet?void 0:r,as:o},p),si.set(D,r),w.querySelector(P)!==null||o==="style"&&w.querySelector(Xs(D))||o==="script"&&w.querySelector(Vn(D))||(o=w.createElement("link"),kr(o,"link",r),Ft(o),w.head.appendChild(o)))}}function xa(r,o){Cn.m(r,o);var p=ia;if(p&&r){var w=o&&typeof o.as=="string"?o.as:"script",P='link[rel="modulepreload"][as="'+Un(w)+'"][href="'+Un(r)+'"]',D=P;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=_n(r)}if(!si.has(D)&&(r=N({rel:"modulepreload",href:r},o),si.set(D,r),p.querySelector(P)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Vn(D)))return}w=p.createElement("link"),kr(w,"link",r),Ft(w),p.head.appendChild(w)}}}function Os(r,o,p){Cn.S(r,o,p);var w=ia;if(w&&r){var P=ut(w).hoistableStyles,D=nr(r);o=o||"default";var W=P.get(D);if(!W){var pe={loading:0,preload:null};if(W=w.querySelector(Xs(D)))pe.loading=5;else{r=N({rel:"stylesheet",href:r,"data-precedence":o},p),(p=si.get(D))&&vs(r,p);var De=W=w.createElement("link");Ft(De),kr(De,"link",r),De._p=new Promise(function(ft,St){De.onload=ft,De.onerror=St}),De.addEventListener("load",function(){pe.loading|=1}),De.addEventListener("error",function(){pe.loading|=2}),pe.loading|=4,sa(W,o,w)}W={type:"stylesheet",instance:W,count:1,state:pe},P.set(D,W)}}}function pr(r,o){Cn.X(r,o);var p=ia;if(p&&r){var w=ut(p).hoistableScripts,P=_n(r),D=w.get(P);D||(D=p.querySelector(Vn(P)),D||(r=N({src:r,async:!0},o),(o=si.get(P))&&hu(r,o),D=p.createElement("script"),Ft(D),kr(D,"link",r),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(P,D))}}function na(r,o){Cn.M(r,o);var p=ia;if(p&&r){var w=ut(p).hoistableScripts,P=_n(r),D=w.get(P);D||(D=p.querySelector(Vn(P)),D||(r=N({src:r,async:!0,type:"module"},o),(o=si.get(P))&&hu(r,o),D=p.createElement("script"),Ft(D),kr(D,"link",r),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(P,D))}}function Ar(r,o,p,w){var P=(P=kt.current)?Ci(P):null;if(!P)throw Error(l(446));switch(r){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(o=nr(p.href),p=ut(P).hoistableStyles,w=p.get(o),w||(w={type:"style",instance:null,count:0,state:null},p.set(o,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){r=nr(p.href);var D=ut(P).hoistableStyles,W=D.get(r);if(W||(P=P.ownerDocument||P,W={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(r,W),(D=P.querySelector(Xs(r)))&&!D._p&&(W.instance=D,W.state.loading=5),si.has(r)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},si.set(r,p),D||ja(P,r,p,W.state))),o&&w===null)throw Error(l(528,""));return W}if(o&&w!==null)throw Error(l(529,""));return null;case"script":return o=p.async,p=p.src,typeof p=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=_n(p),p=ut(P).hoistableScripts,w=p.get(o),w||(w={type:"script",instance:null,count:0,state:null},p.set(o,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,r))}}function nr(r){return'href="'+Un(r)+'"'}function Xs(r){return'link[rel="stylesheet"]['+r+"]"}function to(r){return N({},r,{"data-precedence":r.precedence,precedence:null})}function ja(r,o,p,w){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?w.loading=1:(o=r.createElement("link"),w.preload=o,o.addEventListener("load",function(){return w.loading|=1}),o.addEventListener("error",function(){return w.loading|=2}),kr(o,"link",p),Ft(o),r.head.appendChild(o))}function _n(r){return'[src="'+Un(r)+'"]'}function Vn(r){return"script[async]"+r}function ds(r,o,p){if(o.count++,o.instance===null)switch(o.type){case"style":var w=r.querySelector('style[data-href~="'+Un(p.href)+'"]');if(w)return o.instance=w,Ft(w),w;var P=N({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return w=(r.ownerDocument||r).createElement("style"),Ft(w),kr(w,"style",P),sa(w,p.precedence,r),o.instance=w;case"stylesheet":P=nr(p.href);var D=r.querySelector(Xs(P));if(D)return o.state.loading|=4,o.instance=D,Ft(D),D;w=to(p),(P=si.get(P))&&vs(w,P),D=(r.ownerDocument||r).createElement("link"),Ft(D);var W=D;return W._p=new Promise(function(pe,De){W.onload=pe,W.onerror=De}),kr(D,"link",w),o.state.loading|=4,sa(D,p.precedence,r),o.instance=D;case"script":return D=_n(p.src),(P=r.querySelector(Vn(D)))?(o.instance=P,Ft(P),P):(w=p,(P=si.get(D))&&(w=N({},p),hu(w,P)),r=r.ownerDocument||r,P=r.createElement("script"),Ft(P),kr(P,"link",w),r.head.appendChild(P),o.instance=P);case"void":return null;default:throw Error(l(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(w=o.instance,o.state.loading|=4,sa(w,p.precedence,r));return o.instance}function sa(r,o,p){for(var w=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),P=w.length?w[w.length-1]:null,D=P,W=0;W<w.length;W++){var pe=w[W];if(pe.dataset.precedence===o)D=pe;else if(D!==P)break}D?D.parentNode.insertBefore(r,D.nextSibling):(o=p.nodeType===9?p.head:p,o.insertBefore(r,o.firstChild))}function vs(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function hu(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var So=null;function Tl(r,o,p){if(So===null){var w=new Map,P=So=new Map;P.set(p,w)}else P=So,w=P.get(p),w||(w=new Map,P.set(p,w));if(w.has(r))return w;for(w.set(r,null),p=p.getElementsByTagName(r),P=0;P<p.length;P++){var D=p[P];if(!(D[on]||D[At]||r==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var W=D.getAttribute(o)||"";W=r+W;var pe=w.get(W);pe?pe.push(D):w.set(W,[D])}}return w}function To(r,o,p){r=r.ownerDocument||r,r.head.insertBefore(p,o==="title"?r.querySelector("head > title"):null)}function Eo(r,o,p){if(p===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function mr(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function wc(r,o,p,w){if(p.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var P=nr(w.href),D=o.querySelector(Xs(P));if(D){o=D._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=Nd.bind(r),o.then(r,r)),p.state.loading|=4,p.instance=D,Ft(D);return}D=o.ownerDocument||o,w=to(w),(P=si.get(P))&&vs(w,P),D=D.createElement("link"),Ft(D);var W=D;W._p=new Promise(function(pe,De){W.onload=pe,W.onerror=De}),kr(D,"link",w),p.instance=D}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(p,o),(o=p.state.preload)&&(p.state.loading&3)===0&&(r.count++,p=Nd.bind(r),o.addEventListener("load",p),o.addEventListener("error",p))}}var Vu=0;function Zg(r,o){return r.stylesheets&&r.count===0&&Oh(r,r.stylesheets),0<r.count||0<r.imgCount?function(p){var w=setTimeout(function(){if(r.stylesheets&&Oh(r,r.stylesheets),r.unsuspend){var D=r.unsuspend;r.unsuspend=null,D()}},6e4+o);0<r.imgBytes&&Vu===0&&(Vu=62500*n());var P=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Oh(r,r.stylesheets),r.unsuspend)){var D=r.unsuspend;r.unsuspend=null,D()}},(r.imgBytes>Vu?50:800)+o);return r.unsuspend=p,function(){r.unsuspend=null,clearTimeout(w),clearTimeout(P)}}:null}function Nd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Oh(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Dh=null;function Oh(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Dh=new Map,o.forEach(Sc,r),Dh=null,Nd.call(r))}function Sc(r,o){if(!(o.state.loading&4)){var p=Dh.get(r);if(p)var w=p.get(null);else{p=new Map,Dh.set(r,p);for(var P=r.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<P.length;D++){var W=P[D];(W.nodeName==="LINK"||W.getAttribute("media")!=="not all")&&(p.set(W.dataset.precedence,W),w=W)}w&&p.set(null,w)}P=o.instance,W=P.getAttribute("data-precedence"),D=p.get(W)||w,D===w&&p.set(null,P),p.set(W,P),this.count++,w=Nd.bind(this),P.addEventListener("load",w),P.addEventListener("error",w),D?D.parentNode.insertBefore(P,D.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(P,r.firstChild)),o.state.loading|=4}}var Nh={$$typeof:oe,Provider:null,Consumer:null,_currentValue:We,_currentValue2:We,_threadCount:0};function Gg(r,o,p,w,P,D,W,pe,De){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=je(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=je(0),this.hiddenUpdates=je(null),this.identifierPrefix=w,this.onUncaughtError=P,this.onCaughtError=D,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function Wg(r,o,p,w,P,D,W,pe,De,ft,St,Rt){return r=new Gg(r,o,p,W,De,ft,St,Rt,pe),o=1,D===!0&&(o|=24),D=er(3,null,null,o),r.current=D,D.stateNode=r,o=Ga(),o.refCount++,r.pooledCache=o,o.refCount++,D.memoizedState={element:w,isDehydrated:p,cache:o},Qt(D),r}function Yg(r){return r?(r=Sr,r):Sr}function Xg(r,o,p,w,P,D){P=Yg(P),w.context===null?w.context=P:w.pendingContext=P,w=Ut(o),w.payload={element:p},D=D===void 0?null:D,D!==null&&(w.callback=D),p=ni(r,w,o),p!==null&&(ga(p,r,o),ki(p,r,o))}function Kg(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var p=r.retryLane;r.retryLane=p!==0&&p<o?p:o}}function mm(r,o){Kg(r,o),(r=r.alternate)&&Kg(r,o)}function Jg(r){if(r.tag===13||r.tag===31){var o=pa(r,67108864);o!==null&&ga(o,r,67108864),mm(r,67108864)}}function Qg(r){if(r.tag===13||r.tag===31){var o=wo();o=Oe(o);var p=pa(r,o);p!==null&&ga(p,r,o),mm(r,o)}}var Df=!0;function El(r,o,p,w){var P=$e.T;$e.T=null;var D=ct.p;try{ct.p=2,Nf(r,o,p,w)}finally{ct.p=D,$e.T=P}}function Of(r,o,p,w){var P=$e.T;$e.T=null;var D=ct.p;try{ct.p=8,Nf(r,o,p,w)}finally{ct.p=D,$e.T=P}}function Nf(r,o,p,w){if(Df){var P=gm(w);if(P===null)Ld(r,o,w,Bf,p),Kx(r,w);else if(k2(P,r,o,p,w))w.stopPropagation();else if(Kx(r,w),o&4&&-1<E2.indexOf(r)){for(;P!==null;){var D=ui(P);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var W=be(D.pendingLanes);if(W!==0){var pe=D;for(pe.pendingLanes|=2,pe.entangledLanes|=2;W;){var De=1<<31-Bi(W);pe.entanglements[1]|=De,W&=~De}Xl(D),(Wn&6)===0&&(Tf=Xi()+500,Ih(0))}}break;case 31:case 13:pe=pa(D,2),pe!==null&&ga(pe,D,2),Cd(),mm(D,2)}if(D=gm(w),D===null&&Ld(r,o,w,Bf,p),D===P)break;P=D}P!==null&&w.stopPropagation()}else Ld(r,o,w,null,p)}}function gm(r){return r=Hs(r),ym(r)}var Bf=null;function ym(r){if(Bf=null,r=Ot(r),r!==null){var o=_(r);if(o===null)r=null;else{var p=o.tag;if(p===13){if(r=y(o),r!==null)return r;r=null}else if(p===31){if(r=d(o),r!==null)return r;r=null}else if(p===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Bf=r,null}function Br(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ki()){case Wi:return 2;case gs:return 8;case Ct:case In:return 32;case an:return 268435456;default:return 32}default:return 32}}var La=!1,io=null,$r=null,no=null,so=new Map,_m=new Map,Bh=[],E2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Kx(r,o){switch(r){case"focusin":case"focusout":io=null;break;case"dragenter":case"dragleave":$r=null;break;case"mouseover":case"mouseout":no=null;break;case"pointerover":case"pointerout":so.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":_m.delete(o.pointerId)}}function vm(r,o,p,w,P,D){return r===null||r.nativeEvent!==D?(r={blockedOn:o,domEventName:p,eventSystemFlags:w,nativeEvent:D,targetContainers:[P]},o!==null&&(o=ui(o),o!==null&&Jg(o)),r):(r.eventSystemFlags|=w,o=r.targetContainers,P!==null&&o.indexOf(P)===-1&&o.push(P),r)}function k2(r,o,p,w,P){switch(o){case"focusin":return io=vm(io,r,o,p,w,P),!0;case"dragenter":return $r=vm($r,r,o,p,w,P),!0;case"mouseover":return no=vm(no,r,o,p,w,P),!0;case"pointerover":var D=P.pointerId;return so.set(D,vm(so.get(D)||null,r,o,p,w,P)),!0;case"gotpointercapture":return D=P.pointerId,_m.set(D,vm(_m.get(D)||null,r,o,p,w,P)),!0}return!1}function Jx(r){var o=Ot(r.target);if(o!==null){var p=_(o);if(p!==null){if(o=p.tag,o===13){if(o=y(p),o!==null){r.blockedOn=o,qt(r.priority,function(){Qg(p)});return}}else if(o===31){if(o=d(p),o!==null){r.blockedOn=o,qt(r.priority,function(){Qg(p)});return}}else if(o===3&&p.stateNode.current.memoizedState.isDehydrated){r.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ey(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var p=gm(r.nativeEvent);if(p===null){p=r.nativeEvent;var w=new p.constructor(p.type,p);Ao=w,p.target.dispatchEvent(w),Ao=null}else return o=ui(p),o!==null&&Jg(o),r.blockedOn=p,!1;o.shift()}return!0}function Qx(r,o,p){ey(r)&&p.delete(o)}function C2(){La=!1,io!==null&&ey(io)&&(io=null),$r!==null&&ey($r)&&($r=null),no!==null&&ey(no)&&(no=null),so.forEach(Qx),_m.forEach(Qx)}function ty(r,o){r.blockedOn===o&&(r.blockedOn=null,La||(La=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,C2)))}var iy=null;function eb(r){iy!==r&&(iy=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){iy===r&&(iy=null);for(var o=0;o<r.length;o+=3){var p=r[o],w=r[o+1],P=r[o+2];if(typeof w!="function"){if(ym(w||p)===null)continue;break}var D=ui(p);D!==null&&(r.splice(o,3),o-=3,df(D,{pending:!0,data:P,method:p.method,action:w},w,P))}}))}function $f(r){function o(De){return ty(De,r)}io!==null&&ty(io,r),$r!==null&&ty($r,r),no!==null&&ty(no,r),so.forEach(o),_m.forEach(o);for(var p=0;p<Bh.length;p++){var w=Bh[p];w.blockedOn===r&&(w.blockedOn=null)}for(;0<Bh.length&&(p=Bh[0],p.blockedOn===null);)Jx(p),p.blockedOn===null&&Bh.shift();if(p=(r.ownerDocument||r).$$reactFormReplay,p!=null)for(w=0;w<p.length;w+=3){var P=p[w],D=p[w+1],W=P[ti]||null;if(typeof D=="function")W||eb(p);else if(W){var pe=null;if(D&&D.hasAttribute("formAction")){if(P=D,W=D[ti]||null)pe=W.formAction;else if(ym(P)!==null)continue}else pe=W.action;typeof pe=="function"?p[w+1]=pe:(p.splice(w,3),w-=3),eb(p)}}}function tb(){function r(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(W){return P=W})},focusReset:"manual",scroll:"manual"})}function o(){P!==null&&(P(),P=null),w||setTimeout(p,20)}function p(){if(!w&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,P=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(p,100),function(){w=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),P!==null&&(P(),P=null)}}}function M_(r){this._internalRoot=r}ny.prototype.render=M_.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(l(409));var p=o.current,w=wo();Xg(p,w,r,o,null,null)},ny.prototype.unmount=M_.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;Xg(r.current,2,null,r,null,null),Cd(),o[pi]=null}};function ny(r){this._internalRoot=r}ny.prototype.unstable_scheduleHydration=function(r){if(r){var o=Bt();r={blockedOn:null,target:r,priority:o};for(var p=0;p<Bh.length&&o!==0&&o<Bh[p].priority;p++);Bh.splice(p,0,r),p===0&&Jx(r)}};var ib=e.version;if(ib!=="19.2.0")throw Error(l(527,ib,"19.2.0"));ct.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(l(188)):(r=Object.keys(r).join(","),Error(l(268,r)));return r=I(o),r=r!==null?B(r):null,r=r===null?null:r.stateNode,r};var A2={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$e,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sy.isDisabled&&sy.supportsFiber)try{jt=sy.inject(A2),ri=sy}catch{}}return bm.createRoot=function(r,o){if(!f(r))throw Error(l(299));var p=!1,w="",P=dg,D=fg,W=pg;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(w=o.identifierPrefix),o.onUncaughtError!==void 0&&(P=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&(W=o.onRecoverableError)),o=Wg(r,1,!1,null,null,p,w,null,P,D,W,tb),r[pi]=o.current,dm(r),new M_(o)},bm.hydrateRoot=function(r,o,p){if(!f(r))throw Error(l(299));var w=!1,P="",D=dg,W=fg,pe=pg,De=null;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(P=p.identifierPrefix),p.onUncaughtError!==void 0&&(D=p.onUncaughtError),p.onCaughtError!==void 0&&(W=p.onCaughtError),p.onRecoverableError!==void 0&&(pe=p.onRecoverableError),p.formState!==void 0&&(De=p.formState)),o=Wg(r,1,!0,o,p??null,w,P,De,D,W,pe,tb),o.context=Yg(null),p=o.current,w=wo(),w=Oe(w),P=Ut(w),P.callback=null,ni(p,P,w),p=w,o.current.lanes=p,Ne(o,p),Xl(o),r[pi]=o.current,dm(r),new ny(o)},bm.version="19.2.0",bm}var db;function O2(){if(db)return I_.exports;db=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),I_.exports=D2(),I_.exports}var N2=O2();const B2=Kh(N2);var Q=nx();const Nt=Kh(Q),$2="modulepreload",U2=function(t){return"/"+t},fb={},Ac=function(e,s,l){let f=Promise.resolve();if(s&&s.length>0){let A=function(I){return Promise.all(I.map(B=>Promise.resolve(B).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),d=y?.nonce||y?.getAttribute("nonce");f=A(s.map(I=>{if(I=U2(I),I in fb)return;fb[I]=!0;const B=I.endsWith(".css"),N=B?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${I}"]${N}`))return;const V=document.createElement("link");if(V.rel=B?"stylesheet":$2,B||(V.as="script"),V.crossOrigin="",V.href=I,d&&V.setAttribute("nonce",d),document.head.appendChild(V),B)return new Promise((K,se)=>{V.addEventListener("load",K),V.addEventListener("error",()=>se(new Error(`Unable to preload CSS for ${I}`)))})}))}function _(y){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=y,window.dispatchEvent(d),!d.defaultPrevented)throw y}return f.then(y=>{for(const d of y||[])d.status==="rejected"&&_(d.reason);return e().catch(_)})};var Mr={allRenderFn:!1,element:!0,event:!0,hasRenderFn:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,propChangeCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!0,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1},F2="app",V2=Object.defineProperty,q2=(t,e)=>{for(var s in e)V2(t,s,{get:e[s],enumerable:!0})},H2={isBrowser:!0},Z2="http://www.w3.org/2000/svg",G2="http://www.w3.org/1999/xhtml",W2=(t,e)=>{var s;const l=e.$cmpMeta$;Object.entries((s=l.$members$)!=null?s:{}).map(([_,[y]])=>{if(y&31||y&32){const d=t[_],A=Y2(Object.getPrototypeOf(t),_)||Object.getOwnPropertyDescriptor(t,_);A&&Object.defineProperty(t,_,{get(){return A.get.call(this)},set(I){A.set.call(this,I)},configurable:!0,enumerable:!0}),t[_]=e.$instanceValues$.has(_)?e.$instanceValues$.get(_):d}})};function Y2(t,e){for(;t;){const s=Object.getOwnPropertyDescriptor(t,e);if(s?.get)return s;t=Object.getPrototypeOf(t)}}var Wu=t=>{if(t.__stencil__getHostRef)return t.__stencil__getHostRef()},X2=(t,e)=>{const s={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map,$serializerValues$:new Map};s.$onReadyPromise$=new Promise(f=>s.$onReadyResolve$=f),t["s-p"]=[],t["s-rc"]=[];const l=s;return t.__stencil__getHostRef=()=>l,Mr.modernPropertyDecls&&Mr.state&&W2(t,s),l},pb=(t,e)=>e in t,Ym=(t,e)=>(0,console.error)(t,e),Iy=new Map,Ew=[],K2="slot-fb{display:contents}slot-fb[hidden]{display:none}",mb="http://www.w3.org/1999/xlink",yr=typeof window<"u"?window:{},Da=yr.HTMLElement||class{},Oa={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,s,l)=>t.addEventListener(e,s,l),rel:(t,e,s,l)=>t.removeEventListener(e,s,l),ce:(t,e)=>new CustomEvent(t,e)},J2=(()=>{var t;let e=!1;try{(t=yr.document)==null||t.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),Q2=t=>Promise.resolve(t),sx=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),yv=sx?!!yr.document&&Object.getOwnPropertyDescriptor(yr.document.adoptedStyleSheets,"length").writable:!1,_v=!1,vv=[],kw=[],Cw=(t,e)=>s=>{t.push(s),_v||(_v=!0,e&&Oa.$flags$&4?rx(xv):Oa.raf(xv))},gb=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(s){Ym(s)}t.length=0},xv=()=>{gb(vv),gb(kw),(_v=vv.length>0)&&Oa.raf(xv)},rx=t=>Q2().then(t),Sy=Cw(vv,!1),Rm=Cw(kw,!0),eT=t=>{const e=new URL(t,Oa.$resourcesUrl$);return e.origin!==yr.location.origin?e.href:e.pathname},tT=t=>t!=null&&t!==void 0,ax=t=>(t=typeof t,t==="object"||t==="function");function iT(t){var e,s,l;return(l=(s=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:s.getAttribute("content"))!=null?l:void 0}var nT=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),sT={};q2(sT,{err:()=>Aw,map:()=>rT,ok:()=>bv,unwrap:()=>aT,unwrapErr:()=>oT});var bv=t=>({isOk:!0,isErr:!1,value:t}),Aw=t=>({isOk:!1,isErr:!0,value:t});function rT(t,e){if(t.isOk){const s=e(t.value);return s instanceof Promise?s.then(l=>bv(l)):bv(s)}if(t.isErr){const s=t.value;return Aw(s)}throw"should never get here"}var aT=t=>{if(t.isOk)return t.value;throw t.value},oT=t=>{if(t.isErr)return t.value;throw t.value};var wm;function lT(t){var e;const s=this.attachShadow({mode:"open",delegatesFocus:!!(t.$flags$&16)});wm===void 0&&(wm=(e=void 0)!=null?e:null),wm&&(yv?s.adoptedStyleSheets.push(wm):s.adoptedStyleSheets=[...s.adoptedStyleSheets,wm])}var Mw=t=>{const e=_b(t,"childNodes");t.tagName&&t.tagName.includes("-")&&t["s-cr"]&&t.tagName!=="SLOT-FB"&&Pw(e,t.tagName).forEach(l=>{l.nodeType===1&&l.tagName==="SLOT-FB"&&(uT(l,ox(l),!1).length?l.hidden=!0:l.hidden=!1)});let s=0;for(s=0;s<e.length;s++){const l=e[s];l.nodeType===1&&_b(l,"childNodes").length&&Mw(l)}},cT=t=>{const e=[];for(let s=0;s<t.length;s++){const l=t[s]["s-nr"]||void 0;l&&l.isConnected&&e.push(l)}return e};function Pw(t,e,s){let l=0,f=[],_;for(;l<t.length;l++)_=t[l],_["s-sr"]&&(!e||_["s-hn"]===e)&&s===void 0&&f.push(_),f=[...f,...Pw(_.childNodes,e,s)];return f}var uT=(t,e,s=!0)=>{const l=[];(s&&t["s-sr"]||!t["s-sr"])&&l.push(t);let f=t;for(;f=f.nextSibling;)ox(f)===e&&(s||!f["s-sr"])&&l.push(f);return l},yb=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",ox=t=>typeof t["s-sn"]=="string"?t["s-sn"]:t.nodeType===1&&t.getAttribute("slot")||void 0;function hT(t){if(t.assignedElements||t.assignedNodes||!t["s-sr"])return;const e=s=>(function(l){const f=[],_=this["s-sn"];l?.flatten&&console.error(`
          Flattening is not supported for Stencil non-shadow slots.
          You can use \`.childNodes\` to nested slot fallback content.
          If you have a particular use case, please open an issue on the Stencil repo.
        `);const y=this["s-cr"].parentElement;return(y.__childNodes?y.childNodes:cT(y.childNodes)).forEach(A=>{_===ox(A)&&f.push(A)}),s?f.filter(A=>A.nodeType===1):f}).bind(t);t.assignedElements=e(!0),t.assignedNodes=e(!1)}function _b(t,e){if("__"+e in t){const s=t["__"+e];return typeof s!="function"?s:s.bind(t)}else return typeof t[e]!="function"?t[e]:t[e].bind(t)}var Kd=(t,e="")=>()=>{},ep=new WeakMap,dT=(t,e,s)=>{let l=Iy.get(t);sx&&s?(l=l||new CSSStyleSheet,typeof l=="string"?l=e:l.replaceSync(e)):l=e,Iy.set(t,l)},fT=(t,e,s)=>{var l;const f=Iw(e,s),_=Iy.get(f);if(!yr.document)return f;if(t=t.nodeType===11?t:yr.document,_)if(typeof _=="string"){t=t.head||t;let y=ep.get(t),d;if(y||ep.set(t,y=new Set),!y.has(f)){{d=yr.document.createElement("style"),d.innerHTML=_;const A=(l=Oa.$nonce$)!=null?l:iT(yr.document);if(A!=null&&d.setAttribute("nonce",A),!(e.$flags$&1))if(t.nodeName==="HEAD"){const I=t.querySelectorAll("link[rel=preconnect]"),B=I.length>0?I[I.length-1].nextSibling:t.querySelector("style");t.insertBefore(d,B?.parentNode===t?B:null)}else if("host"in t)if(sx){const I=new CSSStyleSheet;I.replaceSync(_),yv?t.adoptedStyleSheets.unshift(I):t.adoptedStyleSheets=[I,...t.adoptedStyleSheets]}else{const I=t.querySelector("style");I?I.innerHTML=_+I.innerHTML:t.prepend(d)}else t.append(d);e.$flags$&1&&t.insertBefore(d,null)}e.$flags$&4&&(d.innerHTML+=K2),y&&y.add(f)}}else t.adoptedStyleSheets.includes(_)||(yv?t.adoptedStyleSheets.push(_):t.adoptedStyleSheets=[...t.adoptedStyleSheets,_]);return f},pT=t=>{const e=t.$cmpMeta$,s=t.$hostElement$,l=e.$flags$,f=Kd("attachStyles",e.$tagName$),_=fT(s.shadowRoot?s.shadowRoot:s.getRootNode(),e,t.$modeName$);l&10&&(s["s-sc"]=_,s.classList.add(_+"-h")),f()},Iw=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),xi=(t,e,...s)=>{let l=null,f=null,_=null,y=!1,d=!1;const A=[],I=N=>{for(let V=0;V<N.length;V++)l=N[V],Array.isArray(l)?I(l):l!=null&&typeof l!="boolean"&&((y=typeof t!="function"&&!ax(l))&&(l=String(l)),y&&d?A[A.length-1].$text$+=l:A.push(y?jy(null,l):l),d=y)};if(I(s),e){e.key&&(f=e.key),e.name&&(_=e.name);{const N=e.className||e.class;N&&(e.class=typeof N!="object"?N:Object.keys(N).filter(V=>N[V]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,A,gT);const B=jy(t,null);return B.$attrs$=e,A.length>0&&(B.$children$=A),B.$key$=f,B.$name$=_,B},jy=(t,e)=>{const s={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return s.$attrs$=null,s.$key$=null,s.$name$=null,s},Go={},mT=t=>t&&t.$tag$===Go,gT={forEach:(t,e)=>t.map(vb).forEach(e),map:(t,e)=>t.map(vb).map(e).map(yT)},vb=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),yT=t=>{if(typeof t.vtag=="function"){const s={...t.vattrs};return t.vkey&&(s.key=t.vkey),t.vname&&(s.name=t.vname),xi(t.vtag,s,...t.vchildren||[])}const e=jy(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},lx=t=>{const e=nT(t);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${e}))(${e}\\b)`,"g")};lx("::slotted");lx(":host");lx(":host-context");var _T=t=>Ew.map(e=>e(t)).find(e=>!!e),vT=t=>Ew.push(t),xT=t=>{var e;return(e=Wu(t))==null?void 0:e.$modeName$},jw=(t,e,s)=>t!=null&&!ax(t)?e&4?t==="false"?!1:t===""||!!t:e&2?typeof t=="string"?parseFloat(t):typeof t=="number"?t:NaN:e&1?String(t):t:t,bT=t=>t,Yn=(t,e,s)=>{const l=bT(t);return{emit:f=>Lw(l,e,{bubbles:!!(s&4),composed:!!(s&2),cancelable:!!(s&1),detail:f})}},Lw=(t,e,s)=>{const l=Oa.ce(e,s);return t.dispatchEvent(l),l},xb=(t,e,s,l,f,_,y)=>{if(s===l)return;let d=pb(t,e),A=e.toLowerCase();if(e==="class"){const I=t.classList,B=bb(s);let N=bb(l);I.remove(...B.filter(V=>V&&!N.includes(V))),I.add(...N.filter(V=>V&&!B.includes(V)))}else if(e==="style"){for(const I in s)(!l||l[I]==null)&&(I.includes("-")?t.style.removeProperty(I):t.style[I]="");for(const I in l)(!s||l[I]!==s[I])&&(I.includes("-")?t.style.setProperty(I,l[I]):t.style[I]=l[I])}else if(e!=="key")if(e==="ref")l&&l(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):pb(yr,A)?e=A.slice(2):e=A[2]+e.slice(3),s||l){const I=e.endsWith(Rw);e=e.replace(ST,""),s&&Oa.rel(t,e,s,I),l&&Oa.ael(t,e,l,I)}}else{const I=ax(l);if((d||I&&l!==null)&&!f)try{if(t.tagName.includes("-"))t[e]!==l&&(t[e]=l);else{const N=l??"";e==="list"?d=!1:(s==null||t[e]!=N)&&(typeof t.__lookupSetter__(e)=="function"?t[e]=N:t.setAttribute(e,N))}}catch{}let B=!1;A!==(A=A.replace(/^xlink\:?/,""))&&(e=A,B=!0),l==null||l===!1?(l!==!1||t.getAttribute(e)==="")&&(B?t.removeAttributeNS(mb,e):t.removeAttribute(e)):(!d||_&4||f)&&!I&&t.nodeType===1&&(l=l===!0?"":l,B?t.setAttributeNS(mb,e,l):t.setAttribute(e,l))}},wT=/\s/,bb=t=>(typeof t=="object"&&t&&"baseVal"in t&&(t=t.baseVal),!t||typeof t!="string"?[]:t.split(wT)),Rw="Capture",ST=new RegExp(Rw+"$"),wv=(t,e,s,l)=>{const f=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,_=t&&t.$attrs$||{},y=e.$attrs$||{};for(const d of wb(Object.keys(_)))d in y||xb(f,d,_[d],void 0,s,e.$flags$);for(const d of wb(Object.keys(y)))xb(f,d,_[d],y[d],s,e.$flags$)};function wb(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var Ty,Ly,zm,Sv=!1,Ry=!1,cx=!1,qo=!1,zy=(t,e,s)=>{var l;const f=e.$children$[s];let _=0,y,d,A;if(Sv||(cx=!0,f.$tag$==="slot"&&(f.$flags$|=f.$children$?2:1)),f.$text$!==null)y=f.$elm$=yr.document.createTextNode(f.$text$);else if(f.$flags$&1)y=f.$elm$=yr.document.createTextNode(""),wv(null,f,qo);else{if(qo||(qo=f.$tag$==="svg"),!yr.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(y=f.$elm$=yr.document.createElementNS(qo?Z2:G2,!Sv&&Mr.slotRelocation&&f.$flags$&2?"slot-fb":f.$tag$),qo&&f.$tag$==="foreignObject"&&(qo=!1),wv(null,f,qo),tT(Ty)&&y["s-si"]!==Ty&&y.classList.add(y["s-si"]=Ty),f.$children$)for(_=0;_<f.$children$.length;++_)d=zy(t,f,_),d&&y.appendChild(d);f.$tag$==="svg"?qo=!1:y.tagName==="foreignObject"&&(qo=!0)}return y["s-hn"]=zm,f.$flags$&3&&(y["s-sr"]=!0,y["s-cr"]=Ly,y["s-sn"]=f.$name$||"",y["s-rf"]=(l=f.$attrs$)==null?void 0:l.ref,hT(y),A=t&&t.$children$&&t.$children$[s],A&&A.$tag$===f.$tag$&&t.$elm$&&Dm(t.$elm$,!1),Bw(Ly,y,e.$elm$,t?.$elm$)),y},Dm=(t,e)=>{Oa.$flags$|=1;const s=Array.from(t.__childNodes||t.childNodes);t["s-sr"]&&Mr.experimentalSlotFixes;for(let l=s.length-1;l>=0;l--){const f=s[l];f["s-hn"]!==zm&&f["s-ol"]&&(Hh(Om(f).parentNode,f,Om(f)),f["s-ol"].remove(),f["s-ol"]=void 0,f["s-sh"]=void 0,cx=!0),e&&Dm(f,e)}Oa.$flags$&=-2},zw=(t,e,s,l,f,_)=>{let y=t["s-cr"]&&t["s-cr"].parentNode||t,d;for(y.shadowRoot&&y.tagName===zm&&(y=y.shadowRoot);f<=_;++f)l[f]&&(d=zy(null,s,f),d&&(l[f].$elm$=d,Hh(y,d,Om(e))))},Dw=(t,e,s)=>{for(let l=e;l<=s;++l){const f=t[l];if(f){const _=f.$elm$;Nw(f),_&&(Ry=!0,_["s-ol"]?_["s-ol"].remove():Dm(_,!0),_.remove())}}},TT=(t,e,s,l,f=!1)=>{let _=0,y=0,d=0,A=0,I=e.length-1,B=e[0],N=e[I],V=l.length-1,K=l[0],se=l[V],ne,ve;for(;_<=I&&y<=V;)if(B==null)B=e[++_];else if(N==null)N=e[--I];else if(K==null)K=l[++y];else if(se==null)se=l[--V];else if(ry(B,K,f))Wf(B,K,f),B=e[++_],K=l[++y];else if(ry(N,se,f))Wf(N,se,f),N=e[--I],se=l[--V];else if(ry(B,se,f))(B.$tag$==="slot"||se.$tag$==="slot")&&Dm(B.$elm$.parentNode,!1),Wf(B,se,f),Hh(t,B.$elm$,N.$elm$.nextSibling),B=e[++_],se=l[--V];else if(ry(N,K,f))(B.$tag$==="slot"||se.$tag$==="slot")&&Dm(N.$elm$.parentNode,!1),Wf(N,K,f),Hh(t,N.$elm$,B.$elm$),N=e[--I],K=l[++y];else{for(d=-1,A=_;A<=I;++A)if(e[A]&&e[A].$key$!==null&&e[A].$key$===K.$key$){d=A;break}d>=0?(ve=e[d],ve.$tag$!==K.$tag$?ne=zy(e&&e[y],s,d):(Wf(ve,K,f),e[d]=void 0,ne=ve.$elm$),K=l[++y]):(ne=zy(e&&e[y],s,y),K=l[++y]),ne&&Hh(Om(B.$elm$).parentNode,ne,Om(B.$elm$))}_>I?zw(t,l[V+1]==null?null:l[V+1].$elm$,s,l,y,V):y>V&&Dw(e,_,I)},ry=(t,e,s=!1)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:s?(s&&!t.$key$&&e.$key$&&(t.$key$=e.$key$),!0):t.$key$===e.$key$:!1,Om=t=>t&&t["s-ol"]||t,Wf=(t,e,s=!1)=>{const l=e.$elm$=t.$elm$,f=t.$children$,_=e.$children$,y=e.$tag$,d=e.$text$;let A;d===null?(qo=y==="svg"?!0:y==="foreignObject"?!1:qo,wv(t,e,qo),f!==null&&_!==null?TT(l,f,e,_,s):_!==null?(t.$text$!==null&&(l.textContent=""),zw(l,null,e,_,0,_.length-1)):!s&&Mr.updatable&&f!==null&&Dw(f,0,f.length-1),qo&&y==="svg"&&(qo=!1)):(A=l["s-cr"])?A.parentNode.textContent=d:t.$text$!==d&&(l.data=d)},Hu=[],Ow=t=>{let e,s,l;const f=t.__childNodes||t.childNodes;for(const _ of f){if(_["s-sr"]&&(e=_["s-cr"])&&e.parentNode){s=e.parentNode.__childNodes||e.parentNode.childNodes;const y=_["s-sn"];for(l=s.length-1;l>=0;l--)if(e=s[l],!e["s-cn"]&&!e["s-nr"]&&e["s-hn"]!==_["s-hn"])if(yb(e,y)){let d=Hu.find(A=>A.$nodeToRelocate$===e);Ry=!0,e["s-sn"]=e["s-sn"]||y,d?(d.$nodeToRelocate$["s-sh"]=_["s-hn"],d.$slotRefNode$=_):(e["s-sh"]=_["s-hn"],Hu.push({$slotRefNode$:_,$nodeToRelocate$:e})),e["s-sr"]&&Hu.map(A=>{yb(A.$nodeToRelocate$,e["s-sn"])&&(d=Hu.find(I=>I.$nodeToRelocate$===e),d&&!A.$slotRefNode$&&(A.$slotRefNode$=d.$slotRefNode$))})}else Hu.some(d=>d.$nodeToRelocate$===e)||Hu.push({$nodeToRelocate$:e})}_.nodeType===1&&Ow(_)}},Nw=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(Nw)},Hh=(t,e,s)=>(typeof e["s-sn"]=="string"&&e["s-sr"]&&e["s-cr"]&&Bw(e["s-cr"],e,t,e.parentElement),t?.insertBefore(e,s));function Bw(t,e,s,l){var f,_;let y;if(t&&typeof e["s-sn"]=="string"&&e["s-sr"]&&t.parentNode&&t.parentNode["s-sc"]&&(y=e["s-si"]||t.parentNode["s-sc"])){const d=e["s-sn"],A=e["s-hn"];if((f=s.classList)==null||f.add(y+"-s"),l&&((_=l.classList)!=null&&_.contains(y+"-s"))){let I=(l.__childNodes||l.childNodes)[0],B=!1;for(;I;){if(I["s-sn"]!==d&&I["s-hn"]===A&&I["s-sr"]){B=!0;break}I=I.nextSibling}B||l.classList.remove(y+"-s")}}}var ET=(t,e,s=!1)=>{var l,f,_,y,d;const A=t.$hostElement$,I=t.$cmpMeta$,B=t.$vnode$||jy(null,null),V=mT(e)?e:xi(null,null,e);if(zm=A.tagName,I.$attrsToReflect$&&(V.$attrs$=V.$attrs$||{},I.$attrsToReflect$.forEach(([K,se])=>{Mr.serializer&&t.$serializerValues$.has(K)?V.$attrs$[se]=t.$serializerValues$.get(K):V.$attrs$[se]=A[K]})),s&&V.$attrs$)for(const K of Object.keys(V.$attrs$))A.hasAttribute(K)&&!["key","ref","style","class"].includes(K)&&(V.$attrs$[K]=A[K]);V.$tag$=null,V.$flags$|=4,t.$vnode$=V,V.$elm$=B.$elm$=A.shadowRoot||A,Ty=A["s-sc"],Sv=!!(I.$flags$&1)&&!(I.$flags$&128),Ly=A["s-cr"],Ry=!1,Wf(B,V,s);{if(Oa.$flags$|=1,cx){Ow(V.$elm$);for(const K of Hu){const se=K.$nodeToRelocate$;if(!se["s-ol"]&&yr.document){const ne=yr.document.createTextNode("");ne["s-nr"]=se,Hh(se.parentNode,se["s-ol"]=ne,se)}}for(const K of Hu){const se=K.$nodeToRelocate$,ne=K.$slotRefNode$;if(ne){const ve=ne.parentNode;let re=ne.nextSibling;{let me=(l=se["s-ol"])==null?void 0:l.previousSibling;for(;me;){let ye=(f=me["s-nr"])!=null?f:null;if(ye&&ye["s-sn"]===se["s-sn"]&&ve===(ye.__parentNode||ye.parentNode)){for(ye=ye.nextSibling;ye===se||ye?.["s-sr"];)ye=ye?.nextSibling;if(!ye||!ye["s-nr"]){re=ye;break}}me=me.previousSibling}}const ge=se.__parentNode||se.parentNode,oe=se.__nextSibling||se.nextSibling;(!re&&ve!==ge||oe!==re)&&se!==re&&(!se["s-hn"]&&se["s-ol"]&&(se["s-hn"]=se["s-ol"].parentNode.nodeName),Hh(ve,se,re),se.nodeType===1&&se.tagName!=="SLOT-FB"&&(se.hidden=(_=se["s-ih"])!=null?_:!1)),se&&typeof ne["s-rf"]=="function"&&ne["s-rf"](ne)}else se.nodeType===1&&(s&&(se["s-ih"]=(y=se.hidden)!=null?y:!1),se.hidden=!0)}}Ry&&Mw(V.$elm$),Oa.$flags$&=-2,Hu.length=0}if(Mr.experimentalScopedSlotChanges&&I.$flags$&2){const K=V.$elm$.__childNodes||V.$elm$.childNodes;for(const se of K)se["s-hn"]!==zm&&!se["s-sh"]&&(s&&se["s-ih"]==null&&(se["s-ih"]=(d=se.hidden)!=null?d:!1),se.hidden=!0)}Ly=void 0},$w=(t,e)=>{if(e&&!t.$onRenderResolve$&&e["s-p"]){const s=e["s-p"].push(new Promise(l=>t.$onRenderResolve$=()=>{e["s-p"].splice(s-1,1),l()}))}},i_=(t,e)=>{if(t.$flags$|=16,t.$flags$&4){t.$flags$|=512;return}$w(t,t.$ancestorComponent$);const s=()=>kT(t,e);if(e){queueMicrotask(()=>{s()});return}return Rm(s)},kT=(t,e)=>{const s=t.$hostElement$,l=Kd("scheduleUpdate",t.$cmpMeta$.$tagName$),f=s;if(!f)throw new Error(`Can't render component <${s.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let _;return e?_=sp(f,"componentWillLoad",void 0,s):_=sp(f,"componentWillUpdate",void 0,s),_=Sb(_,()=>sp(f,"componentWillRender",void 0,s)),l(),Sb(_,()=>AT(t,f,e))},Sb=(t,e)=>CT(t)?t.then(e).catch(s=>{console.error(s),e()}):e(),CT=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",AT=async(t,e,s)=>{var l;const f=t.$hostElement$,_=Kd("update",t.$cmpMeta$.$tagName$),y=f["s-rc"];s&&pT(t);const d=Kd("render",t.$cmpMeta$.$tagName$);MT(t,e,f,s),y&&(y.map(A=>A()),f["s-rc"]=void 0),d(),_();{const A=(l=f["s-p"])!=null?l:[],I=()=>PT(t);A.length===0?I():(Promise.all(A).then(I),t.$flags$|=4,A.length=0)}},Tb=null,MT=(t,e,s,l)=>{try{Tb=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(Mr.hasRenderFn||Mr.reflect)&&(Mr.vdomRender||Mr.reflect)&&(Mr.hydrateServerSide||ET(t,e,l))}catch(A){Ym(A,t.$hostElement$)}return Tb=null,null},PT=t=>{const e=t.$cmpMeta$.$tagName$,s=t.$hostElement$,l=Kd("postUpdate",e),f=s,_=t.$ancestorComponent$;sp(f,"componentDidRender",void 0,s),t.$flags$&64?(sp(f,"componentDidUpdate",void 0,s),l()):(t.$flags$|=64,jT(s),sp(f,"componentDidLoad",void 0,s),l(),t.$onReadyResolve$(s),_||IT()),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),t.$flags$&512&&rx(()=>i_(t,!1)),t.$flags$&=-517},Eb=t=>{var e;{const s=Wu(t),l=(e=s?.$hostElement$)==null?void 0:e.isConnected;return l&&(s.$flags$&18)===2&&i_(s,!1),l}},IT=t=>{rx(()=>Lw(yr,"appload",{detail:{namespace:F2}}))},sp=(t,e,s,l)=>{if(t&&t[e])try{return t[e](s)}catch(f){Ym(f,l)}},jT=t=>{var e;return t.classList.add((e=Mr.hydratedSelectorName)!=null?e:"hydrated")},LT=(t,e)=>Wu(t).$instanceValues$.get(e),kb=(t,e,s,l)=>{const f=Wu(t);if(!f||Mr.serializer&&f.$serializerValues$.has(e)&&f.$serializerValues$.get(e)===s)return;const _=t,y=f.$instanceValues$.get(e),d=f.$flags$,A=_;s=jw(s,l.$members$[e][0]);const I=Number.isNaN(y)&&Number.isNaN(s);if(s!==y&&!I){if(f.$instanceValues$.set(e,s),Mr.serializer&&Mr.reflect&&l.$attrsToReflect$&&A&&l.$serializers$&&l.$serializers$[e]){let N=s;for(const V of l.$serializers$[e])N=A[V](N,e);f.$serializerValues$.set(e,N)}{if(l.$watchers$&&d&128){const N=l.$watchers$[e];N&&N.map(V=>{try{A[V](s,y,e)}catch(K){Ym(K,_)}})}if((d&18)===2){if(A.componentShouldUpdate&&A.componentShouldUpdate(s,y,e)===!1)return;i_(f,!1)}}}},RT=(t,e,s)=>{var l,f;const _=t.prototype;if(e.$members$||Mr.propChangeCallback){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers),t.deserializers&&!e.$deserializers$&&(e.$deserializers$=t.deserializers),t.serializers&&!e.$serializers$&&(e.$serializers$=t.serializers);const y=Object.entries((l=e.$members$)!=null?l:{});y.map(([d,[A]])=>{if(A&31||A&32){const{get:I,set:B}=Object.getOwnPropertyDescriptor(_,d)||{};I&&(e.$members$[d][0]|=2048),B&&(e.$members$[d][0]|=4096),Object.defineProperty(_,d,{get(){return I?I.apply(this):LT(this,d)},configurable:!0,enumerable:!0}),Object.defineProperty(_,d,{set(N){const V=Wu(this);if(V){if(B){typeof(A&32?this[d]:V.$hostElement$[d])>"u"&&V.$instanceValues$.get(d)&&(N=V.$instanceValues$.get(d)),B.apply(this,[jw(N,A)]),N=A&32?this[d]:V.$hostElement$[d],kb(this,d,N,e);return}{kb(this,d,N,e);return}}}})}});{const d=new Map;_.attributeChangedCallback=function(A,I,B){Oa.jmp(()=>{var N;const V=d.get(A),K=Wu(this);if(Mr.serializer&&K.$serializerValues$.has(V)&&K.$serializerValues$.get(V)===B)return;if(this.hasOwnProperty(V)&&Mr.lazyLoad,Mr.deserializer&&e.$deserializers$&&e.$deserializers$[V]){const ne=(ve,re)=>{const ge=re?.[ve](B,V);ge!==this[V]&&(this[V]=ge)};for(const ve of e.$deserializers$[V])ne(ve,this);return}else{if(_.hasOwnProperty(V)&&typeof this[V]=="number"&&this[V]==B)return;if(V==null){const ne=K?.$flags$;if(K&&ne&&!(ne&8)&&ne&128&&B!==I){const re=this,ge=(N=e.$watchers$)==null?void 0:N[A];ge?.forEach(oe=>{re[oe]!=null&&re[oe].call(re,B,I,A)})}return}}const se=Object.getOwnPropertyDescriptor(_,V);B=B===null&&typeof this[V]=="boolean"?!1:B,B!=this[V]&&(!se.get||se.set)&&(this[V]=B)})},t.observedAttributes=Array.from(new Set([...Object.keys((f=e.$watchers$)!=null?f:{}),...y.filter(([A,I])=>I[0]&31).map(([A,I])=>{var B;const N=I[1]||A;return d.set(N,A),I[0]&512&&((B=e.$attrsToReflect$)==null||B.push([A,N])),N})]))}}return t},zT=async(t,e,s,l)=>{let f;if((e.$flags$&32)===0){e.$flags$|=32,s.$lazyBundleId$;{f=t.constructor;const d=t.localName;customElements.whenDefined(d).then(()=>e.$flags$|=128)}if(f&&f.style){let d;typeof f.style=="string"?d=f.style:typeof f.style!="string"&&(e.$modeName$=_T(t),e.$modeName$&&(d=f.style[e.$modeName$]));const A=Iw(s,e.$modeName$);if(!Iy.has(A)){const I=Kd("registerStyles",s.$tagName$);dT(A,d,!!(s.$flags$&1)),I()}}}const _=e.$ancestorComponent$,y=()=>i_(e,!0);_&&_["s-rc"]?_["s-rc"].push(y):y()},Cb=(t,e)=>{},DT=t=>{if((Oa.$flags$&1)===0){const e=Wu(t);if(!e)return;const s=e.$cmpMeta$,l=Kd("connectedCallback",s.$tagName$);if(e.$flags$&1)Uw(t,e,s.$listeners$),e?.$lazyInstance$?Cb(e.$lazyInstance$):e?.$onReadyPromise$&&e.$onReadyPromise$.then(()=>Cb(e.$lazyInstance$));else{e.$flags$|=1,s.$flags$&12&&OT(t);{let f=t;for(;f=f.parentNode||f.host;)if(f["s-p"]){$w(e,e.$ancestorComponent$=f);break}}s.$members$&&Object.entries(s.$members$).map(([f,[_]])=>{if(_&31&&f in t&&t[f]!==Object.prototype[f]){const y=t[f];delete t[f],t[f]=y}}),zT(t,e,s)}l()}},OT=t=>{if(!yr.document)return;const e=t["s-cr"]=yr.document.createComment("");e["s-cn"]=!0,Hh(t,e,t.firstChild)},NT=async t=>{if((Oa.$flags$&1)===0){const e=Wu(t);e?.$rmListeners$&&(e.$rmListeners$.map(s=>s()),e.$rmListeners$=void 0)}ep.has(t)&&ep.delete(t),t.shadowRoot&&ep.has(t.shadowRoot)&&ep.delete(t.shadowRoot)},ko=(t,e)=>{const s={$flags$:e[0],$tagName$:e[1]};s.$members$=e[2],s.$listeners$=e[3],s.$watchers$=t.$watchers$,s.$deserializers$=t.$deserializers$,s.$serializers$=t.$serializers$,s.$attrsToReflect$=[],!(s.$flags$&1)&&s.$flags$&256;const l=t.prototype.connectedCallback,f=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__hasHostListenerAttached:!1,__registerHost(){X2(this,s)},connectedCallback(){if(!this.__hasHostListenerAttached){const _=Wu(this);if(!_)return;Uw(this,_,s.$listeners$),this.__hasHostListenerAttached=!0}DT(this),l&&l.call(this)},disconnectedCallback(){NT(this),f&&f.call(this)},__attachShadow(){if(!this.shadowRoot)lT.call(this,s);else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${s.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=s.$tagName$,RT(t,s)},Uw=(t,e,s,l)=>{s&&yr.document&&s.map(([f,_,y])=>{const d=$T(yr.document,t,f),A=BT(e,y),I=UT(f);Oa.ael(d,_,A,I),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>Oa.rel(d,_,A,I))})},BT=(t,e)=>s=>{var l;try{Mr.lazyLoad||t.$hostElement$[e](s)}catch(f){Ym(f,t.$hostElement$)}},$T=(t,e,s)=>s&4?t:s&8?yr:s&16?t.body:e,UT=t=>J2?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0;class FT{constructor(){this.m=new Map}reset(e){this.m=new Map(Object.entries(e))}get(e,s){const l=this.m.get(e);return l!==void 0?l:s}getBoolean(e,s=!1){const l=this.m.get(e);return l===void 0?s:typeof l=="string"?l==="true":!!l}getNumber(e,s){const l=parseFloat(this.m.get(e));return isNaN(l)?s!==void 0?s:NaN:l}set(e,s){this.m.set(e,s)}}const Sn=new FT,VT=t=>{try{const e=t.sessionStorage.getItem(Fw);return e!==null?JSON.parse(e):{}}catch{return{}}},qT=(t,e)=>{try{t.sessionStorage.setItem(Fw,JSON.stringify(e))}catch{return}},HT=t=>{const e={};return t.location.search.slice(1).split("&").map(s=>s.split("=")).map(([s,l])=>{try{return[decodeURIComponent(s),decodeURIComponent(l)]}catch{return["",""]}}).filter(([s])=>ZT(s,Ab)).map(([s,l])=>[s.slice(Ab.length),l]).forEach(([s,l])=>{e[s]=l}),e},ZT=(t,e)=>t.substr(0,e.length)===e,Ab="ionic:",Fw="ionic-persist-config";var Yd;(function(t){t.OFF="OFF",t.ERROR="ERROR",t.WARN="WARN"})(Yd||(Yd={}));const Ml=(t,...e)=>{const s=Sn.get("logLevel",Yd.WARN);if([Yd.WARN].includes(s))return console.warn(`[Ionic Warning]: ${t}`,...e)},Ku=(t,...e)=>{const s=Sn.get("logLevel",Yd.ERROR);if([Yd.ERROR,Yd.WARN].includes(s))return console.error(`[Ionic Error]: ${t}`,...e)},GT=(t,...e)=>console.error(`<${t.tagName.toLowerCase()}> must be used inside ${e.join(" or ")}.`);const Vs=typeof window<"u"?window:void 0,Mm=typeof document<"u"?document:void 0;let D_;const WT=t=>{if(D_===void 0){const e=t.style.animationName!==void 0,s=t.style.webkitAnimationName!==void 0;D_=!e&&s?"-webkit-":""}return D_},O_=(t,e,s)=>{const l=e.startsWith("animation")?WT(t):"";t.style.setProperty(l+e,s)},ay=(t=[],e)=>{if(e!==void 0){const s=Array.isArray(e)?e:[e];return[...t,...s]}return t},vn=t=>{let e,s,l,f,_,y,d=[],A=[],I=[],B=!1,N,V={},K=[],se=[],ne={},ve=0,re=!1,ge=!1,oe,me,ye,ke=!0,Re=!1,Ge=!0,He,Xe=!1;const at=t,et=[],Et=[],gt=[],pt=[],$e=[],ct=[],We=[],Tt=[],lt=[],xe=[],Ce=[],st=typeof AnimationEffect=="function"||Vs!==void 0&&typeof Vs.AnimationEffect=="function",ot=typeof Element=="function"&&typeof Element.prototype.animate=="function"&&st,_t=()=>Ce,kt=Qe=>($e.forEach(Ot=>{Ot.destroy(Qe)}),It(Qe),pt.length=0,$e.length=0,d.length=0,Pn(),B=!1,Ge=!0,He),It=Qe=>{hn(),Qe&&zn()},ei=()=>{re=!1,ge=!1,Ge=!0,oe=void 0,me=void 0,ye=void 0,ve=0,Re=!1,ke=!0,Xe=!1},li=()=>ve!==0&&!Xe,Gi=(Qe,Ot)=>{const ui=Ot.findIndex(ln=>ln.c===Qe);ui>-1&&Ot.splice(ui,1)},Mi=(Qe,Ot)=>(gt.push({c:Qe,o:Ot}),He),Di=(Qe,Ot)=>((Ot?.oneTimeCallback?Et:et).push({c:Qe,o:Ot}),He),Pn=()=>(et.length=0,Et.length=0,He),hn=()=>{ot&&(Ce.forEach(Qe=>{Qe.cancel()}),Ce.length=0)},zn=()=>{ct.forEach(Qe=>{Qe?.parentNode&&Qe.parentNode.removeChild(Qe)}),ct.length=0},it=Qe=>(We.push(Qe),He),Qn=Qe=>(Tt.push(Qe),He),qn=Qe=>(lt.push(Qe),He),wi=Qe=>(xe.push(Qe),He),fi=Qe=>(A=ay(A,Qe),He),xn=Qe=>(I=ay(I,Qe),He),Hn=(Qe={})=>(V=Qe,He),es=(Qe=[])=>{for(const Ot of Qe)V[Ot]="";return He},Xi=Qe=>(K=ay(K,Qe),He),Ki=Qe=>(se=ay(se,Qe),He),Wi=(Qe={})=>(ne=Qe,He),gs=(Qe=[])=>{for(const Ot of Qe)ne[Ot]="";return He},Ct=()=>_!==void 0?_:N?N.getFill():"both",In=()=>oe!==void 0?oe:y!==void 0?y:N?N.getDirection():"normal",an=()=>re?"linear":l!==void 0?l:N?N.getEasing():"linear",Tn=()=>ge?0:me!==void 0?me:s!==void 0?s:N?N.getDuration():0,Zn=()=>f!==void 0?f:N?N.getIterations():1,jt=()=>ye!==void 0?ye:e!==void 0?e:N?N.getDelay():0,ri=()=>d,Jt=Qe=>(y=Qe,Ue(!0),He),Bi=Qe=>(_=Qe,Ue(!0),He),jn=Qe=>(e=Qe,Ue(!0),He),ci=Qe=>(l=Qe,Ue(!0),He),xs=Qe=>(!ot&&Qe===0&&(Qe=1),s=Qe,Ue(!0),He),Dn=Qe=>(f=Qe,Ue(!0),He),$n=Qe=>(N=Qe,He),Ji=Qe=>{if(Qe!=null)if(Qe.nodeType===1)pt.push(Qe);else if(Qe.length>=0)for(let Ot=0;Ot<Qe.length;Ot++)pt.push(Qe[Ot]);else Ku("createAnimation - Invalid addElement value.");return He},be=Qe=>{if(Qe!=null)if(Array.isArray(Qe))for(const Ot of Qe)Ot.parent(He),$e.push(Ot);else Qe.parent(He),$e.push(Qe);return He},ie=Qe=>{const Ot=d!==Qe;return d=Qe,Ot&&te(d),He},te=Qe=>{ot&&_t().forEach(Ot=>{const ui=Ot.effect;if(ui.setKeyframes)ui.setKeyframes(Qe);else{const ln=new KeyframeEffect(ui.target,Qe,ui.getTiming());Ot.effect=ln}})},he=()=>{We.forEach(ln=>ln()),Tt.forEach(ln=>ln());const Qe=A,Ot=I,ui=V;pt.forEach(ln=>{const ut=ln.classList;Qe.forEach(Ft=>ut.add(Ft)),Ot.forEach(Ft=>ut.remove(Ft));for(const Ft in ui)ui.hasOwnProperty(Ft)&&O_(ln,Ft,ui[Ft])})},we=()=>{lt.forEach(ut=>ut()),xe.forEach(ut=>ut());const Qe=ke?1:0,Ot=K,ui=se,ln=ne;pt.forEach(ut=>{const Ft=ut.classList;Ot.forEach(Ti=>Ft.add(Ti)),ui.forEach(Ti=>Ft.remove(Ti));for(const Ti in ln)ln.hasOwnProperty(Ti)&&O_(ut,Ti,ln[Ti])}),me=void 0,oe=void 0,ye=void 0,et.forEach(ut=>ut.c(Qe,He)),Et.forEach(ut=>ut.c(Qe,He)),Et.length=0,Ge=!0,ke&&(Re=!0),ke=!0},je=()=>{ve!==0&&(ve--,ve===0&&(we(),N&&N.animationFinish()))},Ne=()=>{pt.forEach(Qe=>{const Ot=Qe.animate(d,{id:at,delay:jt(),duration:Tn(),easing:an(),iterations:Zn(),fill:Ct(),direction:In()});Ot.pause(),Ce.push(Ot)}),Ce.length>0&&(Ce[0].onfinish=()=>{je()})},Ze=()=>{he(),d.length>0&&ot&&Ne(),B=!0},ee=Qe=>{Qe=Math.min(Math.max(Qe,0),.9999),ot&&Ce.forEach(Ot=>{Ot.currentTime=Ot.effect.getComputedTiming().delay+Tn()*Qe,Ot.pause()})},Le=Qe=>{Ce.forEach(Ot=>{Ot.effect.updateTiming({delay:jt(),duration:Tn(),easing:an(),iterations:Zn(),fill:Ct(),direction:In()})}),Qe!==void 0&&ee(Qe)},Ue=(Qe=!1,Ot=!0,ui)=>(Qe&&$e.forEach(ln=>{ln.update(Qe,Ot,ui)}),ot&&Le(ui),He),Oe=(Qe=!1,Ot)=>($e.forEach(ui=>{ui.progressStart(Qe,Ot)}),qt(),re=Qe,B||Ze(),Ue(!1,!0,Ot),He),Ve=Qe=>($e.forEach(Ot=>{Ot.progressStep(Qe)}),ee(Qe),He),Bt=(Qe,Ot,ui)=>(re=!1,$e.forEach(ln=>{ln.progressEnd(Qe,Ot,ui)}),ui!==void 0&&(me=ui),Re=!1,ke=!0,Qe===0?(oe=In()==="reverse"?"normal":"reverse",oe==="reverse"&&(ke=!1),ot?(Ue(),ee(1-Ot)):(ye=(1-Ot)*Tn()*-1,Ue(!1,!1))):Qe===1&&(ot?(Ue(),ee(Ot)):(ye=Ot*Tn()*-1,Ue(!1,!1))),Qe!==void 0&&!N&&ji(),He),qt=()=>{B&&(ot?Ce.forEach(Qe=>{Qe.pause()}):pt.forEach(Qe=>{O_(Qe,"animation-play-state","paused")}),Xe=!0)},Dt=()=>($e.forEach(Qe=>{Qe.pause()}),qt(),He),At=()=>{je()},ti=()=>{Ce.forEach(Qe=>{Qe.play()}),(d.length===0||pt.length===0)&&je()},pi=()=>{ot&&(ee(0),Le())},ji=Qe=>new Promise(Ot=>{Qe?.sync&&(ge=!0,Di(()=>ge=!1,{oneTimeCallback:!0})),B||Ze(),Re&&(pi(),Re=!1),Ge&&(ve=$e.length+1,Ge=!1);const ui=()=>{Gi(ln,Et),Ot()},ln=()=>{Gi(ui,gt),Ot()};Di(ln,{oneTimeCallback:!0}),Mi(ui,{oneTimeCallback:!0}),$e.forEach(ut=>{ut.play()}),ot?ti():At(),Xe=!1}),Qi=()=>{$e.forEach(Qe=>{Qe.stop()}),B&&(hn(),B=!1),ei(),gt.forEach(Qe=>Qe.c(0,He)),gt.length=0},gi=(Qe,Ot)=>{const ui=d[0];return ui!==void 0&&(ui.offset===void 0||ui.offset===0)?ui[Qe]=Ot:d=[{offset:0,[Qe]:Ot},...d],He};return He={parentAnimation:N,elements:pt,childAnimations:$e,id:at,animationFinish:je,from:gi,to:(Qe,Ot)=>{const ui=d[d.length-1];return ui!==void 0&&(ui.offset===void 0||ui.offset===1)?ui[Qe]=Ot:d=[...d,{offset:1,[Qe]:Ot}],He},fromTo:(Qe,Ot,ui)=>gi(Qe,Ot).to(Qe,ui),parent:$n,play:ji,pause:Dt,stop:Qi,destroy:kt,keyframes:ie,addAnimation:be,addElement:Ji,update:Ue,fill:Bi,direction:Jt,iterations:Dn,duration:xs,easing:ci,delay:jn,getWebAnimations:_t,getKeyframes:ri,getFill:Ct,getDirection:In,getDelay:jt,getIterations:Zn,getEasing:an,getDuration:Tn,afterAddRead:qn,afterAddWrite:wi,afterClearStyles:gs,afterStyles:Wi,afterRemoveClass:Ki,afterAddClass:Xi,beforeAddRead:it,beforeAddWrite:Qn,beforeClearStyles:es,beforeStyles:Hn,beforeRemoveClass:xn,beforeAddClass:fi,onFinish:Di,isRunning:li,progressStart:Oe,progressStep:Ve,progressEnd:Bt}};const Jd=(t,e)=>{t.componentOnReady?t.componentOnReady().then(s=>e(s)):pu(()=>e(t))},Dy=t=>t.componentOnReady!==void 0,ux=(t,e=[])=>{const s={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(s[l]=t.getAttribute(l)),t.removeAttribute(l))}),s},YT=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],Vw=(t,e)=>ux(t,YT),XT=(t,e,s,l)=>t.addEventListener(e,s,l),KT=(t,e,s,l)=>t.removeEventListener(e,s,l),Pr=(t,e=t)=>t.shadowRoot||e,pu=t=>typeof __zone_symbol__requestAnimationFrame=="function"?__zone_symbol__requestAnimationFrame(t):typeof requestAnimationFrame=="function"?requestAnimationFrame(t):setTimeout(t),qw=t=>{if(t.focus(),t.classList.contains("ion-focusable")){const e=t.closest("ion-app");e&&e.setFocus([t])}},Oy=(t,e,s)=>Math.max(t,Math.min(e,s)),Vo=(t,e)=>{if(!t){const s="ASSERT: "+e;Ku(s);debugger;throw new Error(s)}},LD=t=>{if(t){const e=t.changedTouches;if(e&&e.length>0){const s=e[0];return{x:s.clientX,y:s.clientY}}if(t.pageX!==void 0)return{x:t.pageX,y:t.pageY}}return{x:0,y:0}},Hw=(t,e)=>{if(t??(t={}),e??(e={}),t===e)return!0;const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!1;for(const l of s)if(!(l in e)||t[l]!==e[l])return!1;return!0},JT="ionViewWillEnter",QT="ionViewDidEnter",Zw="ionViewWillLeave",Gw="ionViewDidLeave",N_="ionViewWillUnload",Sm=t=>{t.tabIndex=-1,t.focus()},oy=t=>t.offsetParent!==null,eE=()=>({saveViewFocus:s=>{if(Sn.get("focusManagerPriority",!1)){const f=document.activeElement;f!==null&&s?.contains(f)&&f.setAttribute(Mb,"true")}},setViewFocus:s=>{const l=Sn.get("focusManagerPriority",!1);if(Array.isArray(l)&&!s.contains(document.activeElement)){const f=s.querySelector(`[${Mb}]`);if(f&&oy(f)){Sm(f);return}for(const _ of l)switch(_){case"content":const y=s.querySelector('main, [role="main"]');if(y&&oy(y)){Sm(y);return}break;case"heading":const d=s.querySelector('h1, [role="heading"][aria-level="1"]');if(d&&oy(d)){Sm(d);return}break;case"banner":const A=s.querySelector('header, [role="banner"]');if(A&&oy(A)){Sm(A);return}break;default:Ml(`Unrecognized focus manager priority value ${_}`);break}Sm(s)}}}),Mb="ion-last-focus",tE=()=>Ac(()=>import("./ios.transition-DNo0rc3Z.js"),[]),iE=()=>Ac(()=>import("./md.transition-BUkoOIBG.js"),[]),Ww=eE(),Yw=t=>new Promise((e,s)=>{Rm(()=>{const l=dE(t);nE(t,l),sE(t).then(f=>{f.animation&&f.animation.destroy(),Pb(t),e(f)},f=>{Pb(t),s(f)}).finally(()=>{Qw(l,!1)})})}),nE=(t,e)=>{const s=t.enteringEl,l=t.leavingEl;Ww.saveViewFocus(l),hE(s,l,t.direction),Qw(e,!0),t.showGoBack?s.classList.add("can-go-back"):s.classList.remove("can-go-back"),Tv(s,!1),s.style.setProperty("pointer-events","none"),l&&(Tv(l,!1),l.style.setProperty("pointer-events","none"))},sE=async t=>{const e=await rE(t);return e&&H2.isBrowser?aE(e,t):oE(t)},Pb=t=>{const e=t.enteringEl,s=t.leavingEl;e.classList.remove("ion-page-invisible"),e.style.removeProperty("pointer-events"),s!==void 0&&(s.classList.remove("ion-page-invisible"),s.style.removeProperty("pointer-events")),Ww.setViewFocus(e)},rE=async t=>!t.leavingEl||!t.animated||t.duration===0?void 0:t.animationBuilder?t.animationBuilder:t.mode==="ios"?(await tE()).iosTransitionAnimation:(await iE()).mdTransitionAnimation,aE=async(t,e)=>{await Xw(e,!0);const s=t(e.baseEl,e);Kw(e.enteringEl,e.leavingEl);const l=await cE(s,e);return e.progressCallback&&e.progressCallback(void 0),l&&Jw(e.enteringEl,e.leavingEl),{hasCompleted:l,animation:s}},oE=async t=>{const e=t.enteringEl,s=t.leavingEl,l=Sn.get("focusManagerPriority",!1);return await Xw(t,l),Kw(e,s),Jw(e,s),{hasCompleted:!0}},Xw=async(t,e)=>{(t.deepWait!==void 0?t.deepWait:e)&&await Promise.all([Ny(t.enteringEl),Ny(t.leavingEl)]),await lE(t.viewIsReady,t.enteringEl)},lE=async(t,e)=>{t&&await t(e)},cE=(t,e)=>{const s=e.progressCallback,l=new Promise(f=>{t.onFinish(_=>f(_===1))});return s?(t.progressStart(!0),s(t)):t.play(),l},Kw=(t,e)=>{Zu(e,Zw),Zu(t,JT)},Jw=(t,e)=>{Zu(t,QT),Zu(e,Gw)},Zu=(t,e)=>{if(t){const s=new CustomEvent(e,{bubbles:!1,cancelable:!1});t.dispatchEvent(s)}},uE=()=>new Promise(t=>pu(()=>pu(()=>t()))),Ny=async t=>{const e=t;if(e){if(e.componentOnReady!=null){if(await e.componentOnReady()!=null)return}else if(e.__registerHost!=null){await new Promise(l=>pu(l));return}await Promise.all(Array.from(e.children).map(Ny))}},Tv=(t,e)=>{e?(t.setAttribute("aria-hidden","true"),t.classList.add("ion-page-hidden")):(t.hidden=!1,t.removeAttribute("aria-hidden"),t.classList.remove("ion-page-hidden"))},hE=(t,e,s)=>{t!==void 0&&(t.style.zIndex=s==="back"?"99":"101"),e!==void 0&&(e.style.zIndex="100")},Qw=(t,e)=>{if(!t)return;const s="header-transitioning";e?t.classList.add(s):t.classList.remove(s)},RD=t=>{if(t.classList.contains("ion-page"))return t;const e=t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return e||t},dE=t=>{const e=t.enteringEl,s=t.leavingEl,l=t.direction;if(t.mode!=="ios")return null;const _=l==="back"?s:e;return _?_.querySelector("ion-header"):null};const up=(t,e,s,l,f)=>pE(t[1],e[1],s[1],l[1],f).map(_=>fE(t[0],e[0],s[0],l[0],_)),fE=(t,e,s,l,f)=>{const _=3*e*Math.pow(f-1,2),y=-3*s*f+3*s+l*f,d=t*Math.pow(f-1,3);return f*(_+f*y)-d},pE=(t,e,s,l,f)=>(t-=f,e-=f,s-=f,l-=f,gE(l-3*s+3*e-t,3*s-6*e+3*t,3*e-3*t,t).filter(y=>y>=0&&y<=1)),mE=(t,e,s)=>{const l=e*e-4*t*s;return l<0?[]:[(-e+Math.sqrt(l))/(2*t),(-e-Math.sqrt(l))/(2*t)]},gE=(t,e,s,l)=>{if(t===0)return mE(e,s,l);e/=t,s/=t,l/=t;const f=(3*s-e*e)/3,_=(2*e*e*e-9*e*s+27*l)/27;if(f===0)return[Math.pow(-_,1/3)];if(_===0)return[Math.sqrt(-f),-Math.sqrt(-f)];const y=Math.pow(_/2,2)+Math.pow(f/3,3);if(y===0)return[Math.pow(_/2,1/2)-e/3];if(y>0)return[Math.pow(-(_/2)+Math.sqrt(y),1/3)-Math.pow(_/2+Math.sqrt(y),1/3)-e/3];const d=Math.sqrt(Math.pow(-(f/3),3)),A=Math.acos(-(_/(2*Math.sqrt(Math.pow(-(f/3),3))))),I=2*Math.pow(d,1/3);return[I*Math.cos(A/3)-e/3,I*Math.cos((A+2*Math.PI)/3)-e/3,I*Math.cos((A+4*Math.PI)/3)-e/3]};class yE{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(e){var s;return new _E(this,this.newID(),e.name,(s=e.priority)!==null&&s!==void 0?s:0,!!e.disableScroll)}createBlocker(e={}){return new vE(this,this.newID(),e.disable,!!e.disableScroll)}start(e,s,l){return this.canStart(e)?(this.requestedStart.set(s,l),!0):(this.requestedStart.delete(s),!1)}capture(e,s,l){if(!this.start(e,s,l))return!1;const f=this.requestedStart;let _=-1e4;if(f.forEach(y=>{_=Math.max(_,y)}),_===l){this.capturedId=s,f.clear();const y=new CustomEvent("ionGestureCaptured",{detail:{gestureName:e}});return document.dispatchEvent(y),!0}return f.delete(s),!1}release(e){this.requestedStart.delete(e),this.capturedId===e&&(this.capturedId=void 0)}disableGesture(e,s){let l=this.disabledGestures.get(e);l===void 0&&(l=new Set,this.disabledGestures.set(e,l)),l.add(s)}enableGesture(e,s){const l=this.disabledGestures.get(e);l!==void 0&&l.delete(s)}disableScroll(e){this.disabledScroll.add(e),this.disabledScroll.size===1&&document.body.classList.add(By)}enableScroll(e){this.disabledScroll.delete(e),this.disabledScroll.size===0&&document.body.classList.remove(By)}canStart(e){return!(this.capturedId!==void 0||this.isDisabled(e))}isCaptured(){return this.capturedId!==void 0}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(e){const s=this.disabledGestures.get(e);return!!(s&&s.size>0)}newID(){return this.gestureId++,this.gestureId}}class _E{constructor(e,s,l,f,_){this.id=s,this.name=l,this.disableScroll=_,this.priority=f*1e6+s,this.ctrl=e}canStart(){return this.ctrl?this.ctrl.canStart(this.name):!1}start(){return this.ctrl?this.ctrl.start(this.name,this.id,this.priority):!1}capture(){if(!this.ctrl)return!1;const e=this.ctrl.capture(this.name,this.id,this.priority);return e&&this.disableScroll&&this.ctrl.disableScroll(this.id),e}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class vE{constructor(e,s,l,f){this.id=s,this.disable=l,this.disableScroll=f,this.ctrl=e}block(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.disableGesture(e,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.enableGesture(e,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const By="backdrop-no-scroll",xE=new yE;const Bd=(t,e,s,l)=>{const f=bE(t)?{capture:!1,passive:!!l.passive}:!1;let _,y;return t.__zone_symbol__addEventListener?(_="__zone_symbol__addEventListener",y="__zone_symbol__removeEventListener"):(_="addEventListener",y="removeEventListener"),t[_](e,s,f),()=>{t[y](e,s,f)}},bE=t=>{if(ly===void 0)try{const e=Object.defineProperty({},"passive",{get:()=>{ly=!0}});t.addEventListener("optsTest",()=>{},e)}catch{ly=!1}return!!ly};let ly;const wE=2e3,SE=(t,e,s,l,f)=>{let _,y,d,A,I,B,N,V=0;const K=ke=>{V=Date.now()+wE,e(ke)&&(!y&&s&&(y=Bd(t,"touchmove",s,f)),d||(d=Bd(ke.target,"touchend",ne,f)),A||(A=Bd(ke.target,"touchcancel",ne,f)))},se=ke=>{V>Date.now()||e(ke)&&(!B&&s&&(B=Bd(Ib(t),"mousemove",s,f)),N||(N=Bd(Ib(t),"mouseup",ve,f)))},ne=ke=>{re(),l&&l(ke)},ve=ke=>{ge(),l&&l(ke)},re=()=>{y&&y(),d&&d(),A&&A(),y=d=A=void 0},ge=()=>{B&&B(),N&&N(),B=N=void 0},oe=()=>{re(),ge()},me=(ke=!0)=>{ke?(_||(_=Bd(t,"touchstart",K,f)),I||(I=Bd(t,"mousedown",se,f))):(_&&_(),I&&I(),_=I=void 0,oe())};return{enable:me,stop:oe,destroy:()=>{me(!1),l=s=e=void 0}}},Ib=t=>t instanceof Document?t:t.ownerDocument,TE=(t,e,s)=>{const l=s*(Math.PI/180),f=t==="x",_=Math.cos(l),y=e*e;let d=0,A=0,I=!1,B=0;return{start(N,V){d=N,A=V,B=0,I=!0},detect(N,V){if(!I)return!1;const K=N-d,se=V-A,ne=K*K+se*se;if(ne<y)return!1;const ve=Math.sqrt(ne),re=(f?K:se)/ve;return re>_?B=1:re<-_?B=-1:B=0,I=!1,!0},isGesture(){return B!==0},getDirection(){return B}}},hx=t=>{let e=!1,s=!1,l=!0,f=!1;const _=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},t),y=_.canStart,d=_.onWillStart,A=_.onStart,I=_.onEnd,B=_.notCaptured,N=_.onMove,V=_.threshold,K=_.passive,se=_.blurOnStart,ne={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},ve=TE(_.direction,_.threshold,_.maxAngle),re=xE.createGesture({name:t.gestureName,priority:t.gesturePriority,disableScroll:t.disableScroll}),ge=et=>{const Et=t1(et);return s||!l||(e1(et,ne),ne.startX=ne.currentX,ne.startY=ne.currentY,ne.startTime=ne.currentTime=Et,ne.velocityX=ne.velocityY=ne.deltaX=ne.deltaY=0,ne.event=et,y&&y(ne)===!1)||(re.release(),!re.start())?!1:(s=!0,V===0?ye():(ve.start(ne.startX,ne.startY),!0))},oe=et=>{if(e){!f&&l&&(f=!0,B_(ne,et),requestAnimationFrame(me));return}B_(ne,et),ve.detect(ne.currentX,ne.currentY)&&(!ve.isGesture()||!ye())&&at()},me=()=>{e&&(f=!1,N&&N(ne))},ye=()=>re.capture()?(e=!0,l=!1,ne.startX=ne.currentX,ne.startY=ne.currentY,ne.startTime=ne.currentTime,d?d(ne).then(Re):Re(),!0):!1,ke=()=>{if(typeof document<"u"){const et=document.activeElement;et?.blur&&et.blur()}},Re=()=>{se&&ke(),A&&A(ne),l=!0},Ge=()=>{e=!1,s=!1,f=!1,l=!0,re.release()},He=et=>{const Et=e,gt=l;if(Ge(),!!gt){if(B_(ne,et),Et){I&&I(ne);return}B&&B(ne)}},Xe=SE(_.el,ge,oe,He,{passive:K}),at=()=>{Ge(),Xe.stop(),B&&B(ne)};return{enable(et=!0){et||(e&&He(void 0),Ge()),Xe.enable(et)},destroy(){re.destroy(),Xe.destroy()}}},B_=(t,e)=>{if(!e)return;const s=t.currentX,l=t.currentY,f=t.currentTime;e1(e,t);const _=t.currentX,y=t.currentY,A=(t.currentTime=t1(e))-f;if(A>0&&A<100){const I=(_-s)/A,B=(y-l)/A;t.velocityX=I*.7+t.velocityX*.3,t.velocityY=B*.7+t.velocityY*.3}t.deltaX=_-t.startX,t.deltaY=y-t.startY,t.event=e},e1=(t,e)=>{let s=0,l=0;if(t){const f=t.changedTouches;if(f&&f.length>0){const _=f[0];s=_.clientX,l=_.clientY}else t.pageX!==void 0&&(s=t.pageX,l=t.pageY)}e.currentX=s,e.currentY=l},t1=t=>t.timeStamp||Date.now();const EE=t=>i1(t),Vh=(t,e)=>(typeof t=="string"&&(e=t,t=void 0),EE(t).includes(e)),i1=(t=window)=>{if(typeof t>"u")return[];t.Ionic=t.Ionic||{};let e=t.Ionic.platforms;return e==null&&(e=t.Ionic.platforms=kE(t),e.forEach(s=>t.document.documentElement.classList.add(`plt-${s}`))),e},kE=t=>{const e=Sn.get("platform");return Object.keys(jb).filter(s=>{const l=e?.[s];return typeof l=="function"?l(t):jb[s](t)})},CE=t=>n_(t)&&!s1(t),dx=t=>!!(Qd(t,/iPad/i)||Qd(t,/Macintosh/i)&&n_(t)),AE=t=>Qd(t,/iPhone/i),ME=t=>Qd(t,/iPhone|iPod/i)||dx(t),n1=t=>Qd(t,/android|sink/i),PE=t=>n1(t)&&!Qd(t,/mobile/i),IE=t=>{const e=t.innerWidth,s=t.innerHeight,l=Math.min(e,s),f=Math.max(e,s);return l>390&&l<520&&f>620&&f<800},jE=t=>{const e=t.innerWidth,s=t.innerHeight,l=Math.min(e,s),f=Math.max(e,s);return dx(t)||PE(t)||l>460&&l<820&&f>780&&f<1400},n_=t=>DE(t,"(any-pointer:coarse)"),LE=t=>!n_(t),s1=t=>r1(t)||a1(t),r1=t=>!!(t.cordova||t.phonegap||t.PhoneGap),a1=t=>{const e=t.Capacitor;return!!(e?.isNative||e?.isNativePlatform&&e.isNativePlatform())},RE=t=>Qd(t,/electron/i),zE=t=>{var e;return!!(!((e=t.matchMedia)===null||e===void 0)&&e.call(t,"(display-mode: standalone)").matches||t.navigator.standalone)},Qd=(t,e)=>e.test(t.navigator.userAgent),DE=(t,e)=>{var s;return(s=t.matchMedia)===null||s===void 0?void 0:s.call(t,e).matches},jb={ipad:dx,iphone:AE,ios:ME,android:n1,phablet:IE,tablet:jE,cordova:r1,capacitor:a1,electron:RE,pwa:zE,mobile:n_,mobileweb:CE,desktop:LE,hybrid:s1};let Yf;const Ps=t=>t&&xT(t)||Yf,OE=(t={})=>{if(typeof window>"u")return;const e=window.document,s=window,l=s.Ionic=s.Ionic||{},f=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},VT(s)),{persistConfig:!1}),l.config),HT(s)),t);Sn.reset(f),Sn.getBoolean("persistConfig")&&qT(s,f),i1(s),l.config=Sn,l.mode=Yf=Sn.get("mode",e.documentElement.getAttribute("mode")||(Vh(s,"ios")?"ios":"md")),Sn.set("mode",Yf),e.documentElement.setAttribute("mode",Yf),e.documentElement.classList.add(Yf),Sn.getBoolean("_testing")&&Sn.set("animated",!1);const _=d=>{var A;return(A=d.tagName)===null||A===void 0?void 0:A.startsWith("ION-")},y=d=>["ios","md"].includes(d);vT(d=>{for(;d;){const A=d.mode||d.getAttribute("mode");if(A){if(y(A))return A;_(d)&&Ml('Invalid ionic mode: "'+A+'", expected: "ios" or "md"')}d=d.parentElement}return Yf})};const NE=t=>{try{if(t instanceof FE)return t.value;if(!BE()||typeof t!="string"||t==="")return t;if(t.includes("onload="))return"";const e=document.createDocumentFragment(),s=document.createElement("div");e.appendChild(s),s.innerHTML=t,UE.forEach(y=>{const d=e.querySelectorAll(y);for(let A=d.length-1;A>=0;A--){const I=d[A];I.parentNode?I.parentNode.removeChild(I):e.removeChild(I);const B=kv(I);for(let N=0;N<B.length;N++)Ev(B[N])}});const l=kv(e);for(let y=0;y<l.length;y++)Ev(l[y]);const f=document.createElement("div");f.appendChild(e);const _=f.querySelector("div");return _!==null?_.innerHTML:f.innerHTML}catch(e){return Ku("sanitizeDOMString",e),""}},Ev=t=>{if(t.nodeType&&t.nodeType!==1)return;if(typeof NamedNodeMap<"u"&&!(t.attributes instanceof NamedNodeMap)){t.remove();return}for(let s=t.attributes.length-1;s>=0;s--){const l=t.attributes.item(s),f=l.name;if(!$E.includes(f.toLowerCase())){t.removeAttribute(f);continue}const _=l.value,y=t[f];(_!=null&&_.toLowerCase().includes("javascript:")||y!=null&&y.toLowerCase().includes("javascript:"))&&t.removeAttribute(f)}const e=kv(t);for(let s=0;s<e.length;s++)Ev(e[s])},kv=t=>t.children!=null?t.children:t.childNodes,BE=()=>{var t;const e=window,s=(t=e?.Ionic)===null||t===void 0?void 0:t.config;return s?s.get?s.get("sanitizerEnabled",!0):s.sanitizerEnabled===!0||s.sanitizerEnabled===void 0:!0},$E=["class","id","href","src","name","slot"],UE=["script","style","iframe","meta","link","object","embed"];class FE{constructor(e){this.value=e}}const VE=!1;const Cv=(t,e)=>e.closest(t)!==null,Xm=(t,e)=>typeof t=="string"&&t.length>0?Object.assign({"ion-color":!0,[`ion-color-${t}`]:!0},e):e,qE=t=>t!==void 0?(Array.isArray(t)?t:t.split(" ")).filter(s=>s!=null).map(s=>s.trim()).filter(s=>s!==""):[],o1=t=>{const e={};return qE(t).forEach(s=>e[s]=!0),e},HE=/^[a-z][a-z0-9+\-.]*:/,ZE=async(t,e,s,l)=>{if(t!=null&&t[0]!=="#"&&!HE.test(t)){const f=document.querySelector("ion-router");if(f)return e?.preventDefault(),f.push(t,s,l)}return!1};const Nm=()=>Sn.get("experimentalCloseWatcher",!1)&&Vs!==void 0&&"CloseWatcher"in Vs,GE=()=>{document.addEventListener("backbutton",()=>{})},WE=()=>{const t=document;let e=!1;const s=()=>{if(e)return;let l=0,f=[];const _=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(A,I){f.push({priority:A,handler:I,id:l++})}}});t.dispatchEvent(_);const y=async A=>{try{if(A?.handler){const I=A.handler(d);I!=null&&await I}}catch(I){Ku("[ion-app] - Exception in startHardwareBackButton:",I)}},d=()=>{if(f.length>0){let A={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};f.forEach(I=>{I.priority>=A.priority&&(A=I)}),e=!0,f=f.filter(I=>I.id!==A.id),y(A).then(()=>e=!1)}};d()};if(Nm()){let l;const f=()=>{l?.destroy(),l=new Vs.CloseWatcher,l.onclose=()=>{s(),f()}};f()}else t.addEventListener("backbutton",s)},l1=100,YE=99,XE=Object.freeze(Object.defineProperty({__proto__:null,MENU_BACK_BUTTON_PRIORITY:YE,OVERLAY_BACK_BUTTON_PRIORITY:l1,blockHardwareBackButton:GE,shouldUseCloseWatcher:Nm,startHardwareBackButton:WE},Symbol.toStringTag,{value:"Module"}));const s_=async(t,e,s,l,f,_)=>{var y;if(t)return t.attachViewToDom(e,s,f,l);if(!_&&typeof s!="string"&&!(s instanceof HTMLElement))throw new Error("framework delegate is missing");const d=typeof s=="string"?(y=e.ownerDocument)===null||y===void 0?void 0:y.createElement(s):s;return l&&l.forEach(A=>d.classList.add(A)),f&&Object.assign(d,f),e.appendChild(d),await new Promise(A=>Jd(d,A)),d},c1=(t,e)=>{if(e){if(t){const s=e.parentElement;return t.removeViewFromDom(s,e)}e.remove()}return Promise.resolve()},u1=()=>{let t,e;return{attachViewToDom:async(f,_,y={},d=[])=>{var A,I;t=f;let B;if(_){const V=typeof _=="string"?(A=t.ownerDocument)===null||A===void 0?void 0:A.createElement(_):_;d.forEach(K=>V.classList.add(K)),Object.assign(V,y),t.appendChild(V),B=V,await new Promise(K=>Jd(V,K))}else if(t.children.length>0&&(t.tagName==="ION-MODAL"||t.tagName==="ION-POPOVER")&&!(B=t.children[0]).classList.contains("ion-delegate-host")){const K=(I=t.ownerDocument)===null||I===void 0?void 0:I.createElement("div");K.classList.add("ion-delegate-host"),d.forEach(se=>K.classList.add(se)),K.append(...t.children),t.appendChild(K),B=K}const N=document.querySelector("ion-app")||document.body;return e=document.createComment("ionic teleport"),t.parentNode.insertBefore(e,t),N.appendChild(t),B??t},removeViewFromDom:()=>(t&&e&&(e.parentNode.insertBefore(t,e),e.remove()),Promise.resolve())}};const Km='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-checkbox:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-radio:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Lb=(t,e)=>{const s=t.querySelector(Km);h1(s,e??t)},Rb=(t,e)=>{const s=Array.from(t.querySelectorAll(Km)),l=s.length>0?s[s.length-1]:null;h1(l,e??t)},h1=(t,e)=>{let s=t;const l=t?.shadowRoot;if(l&&(s=l.querySelector(Km)||t),s){const f=s.closest("ion-radio-group");f?f.setFocus():qw(s)}else e.focus()};let Av=0,KE=0;const $y=new WeakMap,Mv=t=>{var e;return t.showBackdrop!==!1&&!(((e=t.backdropBreakpoint)!==null&&e!==void 0?e:0)>0)},JE=t=>({create(e){return ek(t,e)},dismiss(e,s,l){return sk(document,e,s,t,l)},async getTop(){return Bm(document,t)}}),QE=JE("ion-toast"),d1=t=>{typeof document<"u"&&nk(document);const e=Av++;t.overlayIndex=e},f1=t=>(t.hasAttribute("id")||(t.id=`ion-overlay-${++KE}`),t.id),ek=(t,e)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(t).then(()=>{const s=document.createElement(t);return s.classList.add("overlay-hidden"),Object.assign(s,Object.assign(Object.assign({},e),{hasController:!0})),fx(document).appendChild(s),new Promise(l=>Jd(s,l))}):Promise.resolve(),tk=t=>t.classList.contains("overlay-hidden"),zb=(t,e)=>{let s=t;const l=t?.shadowRoot;l&&(s=l.querySelector(Km)||t),s?qw(s):e.focus()},ik=(t,e)=>{const s=Bm(e,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover"),l=t.target;if(!s||!l||s.classList.contains(Vy))return;const f=()=>{if(s===l)s.lastFocus=void 0;else if(l.tagName==="ION-TOAST")zb(s.lastFocus,s);else{const y=Pr(s);if(!y.contains(l))return;const d=y.querySelector(".ion-overlay-wrapper");if(!d)return;if(d.contains(l)||l===y.querySelector("ion-backdrop"))s.lastFocus=l;else{const A=s.lastFocus;Lb(d,s),A===e.activeElement&&Rb(d,s),s.lastFocus=e.activeElement}}},_=()=>{if(s.contains(l))s.lastFocus=l;else if(l.tagName==="ION-TOAST")zb(s.lastFocus,s);else{const y=s.lastFocus;Lb(s),y===e.activeElement&&Rb(s),s.lastFocus=e.activeElement}};s.shadowRoot?_():f()},nk=t=>{Av===0&&(Av=1,t.addEventListener("focus",e=>{ik(e,t)},!0),t.addEventListener("ionBackButton",e=>{const s=Bm(t);s?.backdropDismiss&&e.detail.register(l1,()=>{s.dismiss(void 0,Fy)})}),Nm()||t.addEventListener("keydown",e=>{if(e.key==="Escape"){const s=Bm(t);s?.backdropDismiss&&s.dismiss(void 0,Fy)}}))},sk=(t,e,s,l,f)=>{const _=Bm(t,l,f);return _?_.dismiss(e,s):Promise.reject("overlay does not exist")},rk=(t,e)=>(e===void 0&&(e="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover,ion-toast"),Array.from(t.querySelectorAll(e)).filter(s=>s.overlayIndex>0)),p1=(t,e)=>rk(t,e).filter(s=>!tk(s)),Bm=(t,e,s)=>{const l=p1(t,e);return(s===void 0?l:l.filter(f=>f.id===s)).slice(-1)[0]},m1=(t=!1)=>{const s=fx(document).querySelector("ion-router-outlet, #ion-view-container-root");s&&(t?s.setAttribute("aria-hidden","true"):s.removeAttribute("aria-hidden"))},g1=async(t,e,s,l,f)=>{var _,y;if(t.presented)return;t.el.tagName!=="ION-TOAST"&&ak(t.el);const d=t.el,I=d.tagName!=="ION-TOAST"&&d.focusTrap!==!1&&Mv(d);if(t.presented=!0,t.willPresent.emit(),I){const se=fx(document).querySelector("ion-router-outlet, #ion-view-container-root");se&&se.contains(d)||m1(!0),document.body.classList.add(By)}(_=t.willPresentShorthand)===null||_===void 0||_.emit();const B=Ps(t),N=t.enterAnimation?t.enterAnimation:Sn.get(e,B==="ios"?s:l);await _1(t,N,t.el,f)&&(t.didPresent.emit(),(y=t.didPresentShorthand)===null||y===void 0||y.emit()),t.keyboardClose&&(document.activeElement===null||!t.el.contains(document.activeElement))&&t.el.focus(),t.el.removeAttribute("aria-hidden"),t.el.removeAttribute("inert")},ak=async t=>{let e=document.activeElement;if(!e)return;e.blur();const s=e?.shadowRoot;s&&(e=s.querySelector(Km)||e),await t.onDidDismiss(),(document.activeElement===null||document.activeElement===document.body)&&e.focus()},y1=async(t,e,s,l,f,_,y)=>{var d,A;if(!t.presented)return!1;const B=(Mm!==void 0?p1(Mm):[]).filter(se=>{const ne=se;return ne.tagName!=="ION-TOAST"&&ne.focusTrap!==!1&&Mv(ne)}),N=t.el;N.tagName!=="ION-TOAST"&&N.focusTrap!==!1&&Mv(N)&&B.length===1&&B[0].id===N.id&&(m1(!1),document.body.classList.remove(By)),t.presented=!1;try{t.el.style.setProperty("pointer-events","none"),t.willDismiss.emit({data:e,role:s}),(d=t.willDismissShorthand)===null||d===void 0||d.emit({data:e,role:s});const se=Ps(t),ne=t.leaveAnimation?t.leaveAnimation:Sn.get(l,se==="ios"?f:_);s!==rp&&await _1(t,ne,t.el,y),t.didDismiss.emit({data:e,role:s}),(A=t.didDismissShorthand)===null||A===void 0||A.emit({data:e,role:s}),($y.get(t)||[]).forEach(re=>re.destroy()),$y.delete(t),t.el.classList.add("overlay-hidden"),t.el.style.removeProperty("pointer-events"),t.el.lastFocus!==void 0&&(t.el.lastFocus=void 0)}catch(se){Ku(`[${t.el.tagName.toLowerCase()}] - `,se)}return t.el.remove(),!0},fx=t=>t.querySelector("ion-app")||t.body,_1=async(t,e,s,l)=>{s.classList.remove("overlay-hidden");const f=t.el,_=e(f,l);(!t.animated||!Sn.getBoolean("animated",!0))&&_.duration(0),t.keyboardClose&&_.beforeAddWrite(()=>{const d=s.ownerDocument.activeElement;d?.matches("input,ion-input, ion-textarea")&&d.blur()});const y=$y.get(t)||[];return $y.set(t,[...y,_]),await _.play(),!0},Uy=(t,e)=>{let s;const l=new Promise(f=>s=f);return ok(t,e,f=>{s(f.detail)}),l},ok=(t,e,s)=>{const l=f=>{KT(t,e,l),s(f)};XT(t,e,l)},Pv=t=>t==="cancel"||t===Fy,lk=t=>t(),ck=(t,e)=>{if(typeof t=="function")return Sn.get("_zoneGate",lk)(()=>{try{return t(e)}catch(l){throw l}})},Fy="backdrop",rp="gesture",v1=39,uk=t=>{let e=!1,s;const l=u1(),f=(d=!1)=>{if(s&&!d)return{delegate:s,inline:e};const{el:A,hasController:I,delegate:B}=t;return e=A.parentNode!==null&&!I,s=e?B||l:B,{inline:e,delegate:s}};return{attachViewToDom:async d=>{const{delegate:A}=f(!0);if(A)return await A.attachViewToDom(t.el,d);const{hasController:I}=t;if(I&&d!==void 0)throw new Error("framework delegate is missing");return null},removeViewFromDom:()=>{const{delegate:d}=f();d&&t.el!==void 0&&d.removeViewFromDom(t.el.parentElement,t.el)}}},x1=()=>{let t;const e=()=>{t&&(t(),t=void 0)};return{addClickListener:(l,f)=>{e();const _=f!==void 0?document.getElementById(f):null;if(!_){Ml(`[${l.tagName.toLowerCase()}] - A trigger element with the ID "${f}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,l);return}t=((d,A)=>{const I=()=>{A.present()};return d.addEventListener("click",I),()=>{d.removeEventListener("click",I)}})(_,l)},removeClickListener:e}},Vy="ion-disable-focus-trap";var b1=Tw();const hk=Kh(b1);const dk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M244 400 100 256l144-144M120 256h292' stroke-linecap='square' stroke-miterlimit='10' stroke-width='48px' class='ionicon-fill-none'/></svg>",fk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M328 112 184 256l144 144' stroke-linecap='round' stroke-linejoin='round' stroke-width='48px' class='ionicon-fill-none'/></svg>";let $_;const pk=()=>{if(typeof window>"u")return new Map;if(!$_){const t=window;t.Ionicons=t.Ionicons||{},$_=t.Ionicons.map=t.Ionicons.map||new Map}return $_},mk=t=>{let e=U_(t.src);return e||(e=w1(t.name,t.icon,t.mode,t.ios,t.md),e?gk(e,t):t.icon&&(e=U_(t.icon),e||(e=U_(t.icon[t.mode]),e))?e:null)},gk=(t,e)=>{const s=pk().get(t);if(s)return s;try{return eT(`svg/${t}.svg`)}catch(l){console.log("e",l),console.warn(`[Ionicons Warning]: Could not load icon with name "${t}". Ensure that the icon is registered using addIcons or that the icon SVG data is passed directly to the icon component.`,e)}},w1=(t,e,s,l,f)=>(s=(s&&cy(s))==="ios"?"ios":"md",l&&s==="ios"?t=cy(l):f&&s==="md"?t=cy(f):(!t&&e&&!S1(e)&&(t=e),qy(t)&&(t=cy(t))),!qy(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),U_=t=>qy(t)&&(t=t.trim(),S1(t))?t:null,S1=t=>t.length>0&&/(\/|\.)/.test(t),qy=t=>typeof t=="string",cy=t=>t.toLowerCase(),yk=(t,e=[])=>{const s={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(s[l]=t.getAttribute(l)),t.removeAttribute(l))}),s},_k=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl",vk=t=>{const e=document.createElement("div");e.innerHTML=t;for(let l=e.childNodes.length-1;l>=0;l--)e.childNodes[l].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[l]);const s=e.firstElementChild;if(s&&s.nodeName.toLowerCase()==="svg"){const l=s.getAttribute("class")||"";if(s.setAttribute("class",(l+" s-ion-icon").trim()),T1(s))return e.innerHTML}return""},T1=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const s=t.attributes[e].name;if(qy(s)&&s.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!T1(t.childNodes[e]))return!1}return!0},xk=t=>t.startsWith("data:image/svg+xml"),bk=t=>t.indexOf(";utf8,")!==-1,ap=new Map,E1=new Map;let F_;function Iv(t){return ap.set(t,""),""}const wk=(t,e)=>{const s=E1.get(t);return s||(typeof fetch<"u"&&typeof document<"u"?xk(t)&&bk(t)?Promise.resolve(Sk(t)):Tk(t,e):Promise.resolve(Iv(t)))};function Sk(t){F_||(F_=new DOMParser);const s=F_.parseFromString(t,"text/html").querySelector("svg");if(s)return ap.set(t,s.outerHTML),s.outerHTML;throw new Error(`Could not parse svg from ${t}`)}function Tk(t,e){const s=fetch(t).then(l=>l.text().then(f=>{f&&e!==!1&&(f=vk(f));const _=f||"";return ap.set(t,_),_}).catch(()=>Iv(t))).catch(()=>Iv(t));return E1.set(t,s),s}const Ek=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:1.125rem !important}:host(.icon-large){font-size:2rem !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",kk=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.didLoadIcon=!1,this.isVisible=!1,this.mode=Ck(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=yk(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}componentDidLoad(){this.didLoadIcon||this.loadIcon()}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,s,l){if(!!!(this.lazy&&typeof window<"u"&&window.IntersectionObserver))return l();const _=this.io=new window.IntersectionObserver(y=>{y[0].isIntersecting&&(_.disconnect(),this.io=void 0,l())},{rootMargin:s});_.observe(e)}loadIcon(){if(this.isVisible){const e=mk(this);e&&(ap.has(e)?this.svgContent=ap.get(e):wk(e,this.sanitize).then(()=>this.svgContent=ap.get(e)),this.didLoadIcon=!0)}this.iconName=w1(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:s,inheritedAttributes:l,el:f}=this,_=this.mode||"md",y=s?(s.includes("arrow")||s.includes("chevron"))&&e!==!1:!1,d=e||y;return xi(Go,Object.assign({key:"0578c899781ca145dd8205acd9670af39b57cf2e",role:"img",class:Object.assign(Object.assign({[_]:!0},Ak(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":d,"icon-rtl":d&&_k(f)})},l),this.svgContent?xi("div",{class:"icon-inner",innerHTML:this.svgContent}):xi("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return Ek}},[257,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},void 0,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]),Ck=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",Ak=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function k1(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{e==="ion-icon"&&(customElements.get(e)||customElements.define(e,kk))})}const Mk=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",Pk=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",Ik=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionBackdropTap=Yn(this,"ionBackdropTap",7),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}onMouseDown(e){this.emitTap(e)}emitTap(e){this.stopPropagation&&(e.preventDefault(),e.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const e=Ps(this);return xi(Go,{key:"7abaf2c310aa399607451b14063265e8a5846938","aria-hidden":"true",class:{[e]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:Mk,md:Pk}}},[289,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]);function jk(){if(typeof customElements>"u")return;["ion-backdrop"].forEach(e=>{e==="ion-backdrop"&&(customElements.get(e)||customElements.define(e,Ik))})}const Lk=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}",Rk=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(e,s){return new Promise(l=>{Sy(()=>{const f=this.el.getBoundingClientRect(),_=f.width,y=f.height,d=Math.sqrt(_*_+y*y),A=Math.max(y,_),I=this.unbounded?A:d+Dk,B=Math.floor(A*Ok),N=I/B;let V=e-f.left,K=s-f.top;this.unbounded&&(V=_*.5,K=y*.5);const se=V-B*.5,ne=K-B*.5,ve=_*.5-V,re=y*.5-K;Rm(()=>{const ge=document.createElement("div");ge.classList.add("ripple-effect");const oe=ge.style;oe.top=ne+"px",oe.left=se+"px",oe.width=oe.height=B+"px",oe.setProperty("--final-scale",`${N}`),oe.setProperty("--translate-end",`${ve}px, ${re}px`),(this.el.shadowRoot||this.el).appendChild(ge),setTimeout(()=>{l(()=>{zk(ge)})},325)})})})}get unbounded(){return this.type==="unbounded"}render(){const e=Ps(this);return xi(Go,{key:"ae9d3b1ed6773a9b9bb2267129f7e9af23b6c9fc",role:"presentation",class:{[e]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return Lk}},[257,"ion-ripple-effect",{type:[1],addRipple:[64]}]),zk=t=>{t.classList.add("fade-out"),setTimeout(()=>{t.remove()},200)},Dk=10,Ok=.5;function px(){if(typeof customElements>"u")return;["ion-ripple-effect"].forEach(e=>{e==="ion-ripple-effect"&&(customElements.get(e)||customElements.define(e,Rk))})}const uy=typeof window<"u"?window:void 0;uy&&(uy.CSS&&uy.CSS.supports&&uy.CSS.supports("--a: 0"));const Nk=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl";const Bk=':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-ms-touch-action:pan-x pan-y pinch-zoom;touch-action:pan-x pan-y pinch-zoom}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;z-index:0;will-change:scroll-position}.scroll-y{overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{overflow-x:var(--overflow);overscroll-behavior-x:contain}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:0;contain:none}:host(.content-sizing) .inner-scroll{position:relative;top:0;bottom:0;margin-top:calc(var(--offset-top) * -1);margin-bottom:calc(var(--offset-bottom) * -1)}.transition-effect{display:none;position:absolute;width:100%;height:100vh;opacity:0;pointer-events:none}:host(.content-ltr) .transition-effect{left:-100%;}:host(.content-rtl) .transition-effect{right:-100%;}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;width:100%;height:100%;-webkit-box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03);box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03)}:host(.content-ltr) .transition-shadow{right:0;}:host(.content-rtl) .transition-shadow{left:0;-webkit-transform:scaleX(-1);transform:scaleX(-1)}::slotted([slot=fixed]){position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}',$k=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionScrollStart=Yn(this,"ionScrollStart",7),this.ionScroll=Yn(this,"ionScroll",7),this.ionScrollEnd=Yn(this,"ionScrollEnd",7),this.watchDog=null,this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.isMainContent=!0,this.resizeTimeout=null,this.inheritedAttributes={},this.tabsElement=null,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.fullscreen=!1,this.fixedSlotPlacement="after",this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1}componentWillLoad(){this.inheritedAttributes=Vw(this.el)}connectedCallback(){if(this.isMainContent=this.el.closest("ion-menu, ion-popover, ion-modal")===null,Dy(this.el)){const e=this.tabsElement=this.el.closest("ion-tabs");e!==null&&(this.tabsLoadCallback=()=>this.resize(),e.addEventListener("ionTabBarLoaded",this.tabsLoadCallback))}}disconnectedCallback(){if(this.onScrollEnd(),Dy(this.el)){const{tabsElement:e,tabsLoadCallback:s}=this;e!==null&&s!==void 0&&e.removeEventListener("ionTabBarLoaded",s),this.tabsElement=null,this.tabsLoadCallback=void 0}}onResize(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeTimeout=setTimeout(()=>{this.el.offsetParent!==null&&this.resize()},100)}shouldForceOverscroll(){const{forceOverscroll:e}=this,s=Ps(this);return e===void 0?s==="ios"&&Vh("ios"):e}resize(){this.fullscreen?Sy(()=>this.readDimensions()):(this.cTop!==0||this.cBottom!==0)&&(this.cTop=this.cBottom=0,Eb(this))}async recalculateDimensions(){Sy(()=>this.readDimensions())}readDimensions(){const e=Fk(this.el),s=Math.max(this.el.offsetTop,0),l=Math.max(e.offsetHeight-s-this.el.offsetHeight,0);(s!==this.cTop||l!==this.cBottom)&&(this.cTop=s,this.cBottom=l,Eb(this))}onScroll(e){const s=Date.now(),l=!this.isScrolling;this.lastScroll=s,l&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,Sy(f=>{this.queued=!1,this.detail.event=e,Vk(this.detail,this.scrollEl,f,l),this.ionScroll.emit(this.detail)}))}async getScrollElement(){return this.scrollEl||await new Promise(e=>Jd(this.el,e)),Promise.resolve(this.scrollEl)}async getBackgroundElement(){return this.backgroundContentEl||await new Promise(e=>Jd(this.el,e)),Promise.resolve(this.backgroundContentEl)}scrollToTop(e=0){return this.scrollToPoint(void 0,0,e)}async scrollToBottom(e=0){const s=await this.getScrollElement(),l=s.scrollHeight-s.clientHeight;return this.scrollToPoint(void 0,l,e)}async scrollByPoint(e,s,l){const f=await this.getScrollElement();return this.scrollToPoint(e+f.scrollLeft,s+f.scrollTop,l)}async scrollToPoint(e,s,l=0){const f=await this.getScrollElement();if(l<32){s!=null&&(f.scrollTop=s),e!=null&&(f.scrollLeft=e);return}let _,y=0;const d=new Promise(K=>_=K),A=f.scrollTop,I=f.scrollLeft,B=s!=null?s-A:0,N=e!=null?e-I:0,V=K=>{const se=Math.min(1,(K-y)/l)-1,ne=Math.pow(se,3)+1;B!==0&&(f.scrollTop=Math.floor(ne*B+A)),N!==0&&(f.scrollLeft=Math.floor(ne*N+I)),ne<1?requestAnimationFrame(V):_()};return requestAnimationFrame(K=>{y=K,V(K)}),d}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval(()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()},100)}onScrollEnd(){this.watchDog&&clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{fixedSlotPlacement:e,inheritedAttributes:s,isMainContent:l,scrollX:f,scrollY:_,el:y}=this,d=Nk(y)?"rtl":"ltr",A=Ps(this),I=this.shouldForceOverscroll(),B=A==="ios";return this.resize(),xi(Go,Object.assign({key:"cd8781f848d8dc926fe66f43d43c49564425a507",role:l?"main":void 0,class:Xm(this.color,{[A]:!0,"content-sizing":Cv("ion-popover",this.el),overscroll:I,[`content-${d}`]:!0}),style:{"--offset-top":`${this.cTop}px`,"--offset-bottom":`${this.cBottom}px`}},s),xi("div",{key:"95b112d7cae30f22ef778ceffb88edb4d941c170",ref:N=>this.backgroundContentEl=N,id:"background-content",part:"background"}),e==="before"?xi("slot",{name:"fixed"}):null,xi("div",{key:"2fdfcbc39fb66f11b6191911f2941c660f4c12e5",class:{"inner-scroll":!0,"scroll-x":f,"scroll-y":_,overscroll:(f||_)&&I},ref:N=>this.scrollEl=N,onScroll:this.scrollEvents?N=>this.onScroll(N):void 0,part:"scroll"},xi("slot",{key:"6bc77e0054ec8e21635a7f2abfe0ca46e0962e03"})),B?xi("div",{class:"transition-effect"},xi("div",{class:"transition-cover"}),xi("div",{class:"transition-shadow"})):null,e==="after"?xi("slot",{name:"fixed"}):null)}get el(){return this}static get style(){return Bk}},[257,"ion-content",{color:[513],fullscreen:[4],fixedSlotPlacement:[1,"fixed-slot-placement"],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"],recalculateDimensions:[64],getScrollElement:[64],getBackgroundElement:[64],scrollToTop:[64],scrollToBottom:[64],scrollByPoint:[64],scrollToPoint:[64]},[[9,"resize","onResize"]]]),Uk=t=>{var e;return t.parentElement?t.parentElement:!((e=t.parentNode)===null||e===void 0)&&e.host?t.parentNode.host:null},Fk=t=>{const e=t.closest("ion-tabs");if(e)return e;const s=t.closest("ion-app, ion-page, .ion-page, page-inner, .popover-content");return s||Uk(t)},Vk=(t,e,s,l)=>{const f=t.currentX,_=t.currentY,y=t.currentTime,d=e.scrollLeft,A=e.scrollTop,I=s-y;if(l&&(t.startTime=s,t.startX=d,t.startY=A,t.velocityX=t.velocityY=0),t.currentTime=s,t.currentX=t.scrollLeft=d,t.currentY=t.scrollTop=A,t.deltaX=d-t.startX,t.deltaY=A-t.startY,I>0&&I<100){const B=(d-f)/I,N=(A-_)/I;t.velocityX=B*.7+t.velocityX*.3,t.velocityY=N*.7+t.velocityY*.3}};function qk(){if(typeof customElements>"u")return;["ion-content"].forEach(e=>{e==="ion-content"&&(customElements.get(e)||customElements.define(e,$k))})}const Hk=qk;const C1=()=>{if(Vs!==void 0)return Vs.Capacitor};const mx=()=>{let t;return{lock:async()=>{const s=t;let l;return t=new Promise(f=>l=f),s!==void 0&&await s,l}}};const Zk="ION-CONTENT",A1="ion-content",M1=".ion-content-scroll-host",P1=`${A1}, ${M1}`,mu=t=>t.tagName===Zk,BD=async t=>mu(t)?(await new Promise(e=>Jd(t,e)),t.getScrollElement()):t,Gk=t=>{const e=t.querySelector(M1);return e||t.querySelector(P1)},jv=t=>t.closest(P1),$D=(t,e)=>mu(t)?t.scrollToTop(e):Promise.resolve(t.scrollTo({top:0,left:0,behavior:"smooth"})),UD=(t,e,s,l)=>mu(t)?t.scrollByPoint(e,s,l):Promise.resolve(t.scrollBy({top:s,left:e,behavior:l>0?"smooth":"auto"})),Wk=t=>GT(t,A1),Db=t=>{if(mu(t)){const e=t,s=e.scrollY;return e.scrollY=!1,s}else return t.style.setProperty("overflow","hidden"),!0},Yk=(t,e)=>{mu(t)?t.scrollY=e:t.style.removeProperty("overflow")};var Lv;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Lv||(Lv={}));var Rv;(function(t){t.Body="body",t.Ionic="ionic",t.Native="native",t.None="none"})(Rv||(Rv={}));const I1={getEngine(){const t=C1();if(t?.isPluginAvailable("Keyboard"))return t.Plugins.Keyboard},getResizeMode(){const t=this.getEngine();return t?.getResizeMode?t.getResizeMode().catch(e=>{if(e.code!==Lv.Unimplemented)throw e}):Promise.resolve(void 0)}};const j1=t=>{if(Mm===void 0||t===Rv.None||t===void 0)return null;const e=Mm.querySelector("ion-app");return e??Mm.body},Ob=t=>{const e=j1(t);return e===null?0:e.clientHeight},Xk=async t=>{let e,s,l,f;const _=async()=>{const B=await I1.getResizeMode(),N=B===void 0?void 0:B.mode;e=()=>{f===void 0&&(f=Ob(N)),l=!0,y(l,N)},s=()=>{l=!1,y(l,N)},Vs?.addEventListener("keyboardWillShow",e),Vs?.addEventListener("keyboardWillHide",s)},y=(B,N)=>{t&&t(B,d(N))},d=B=>{if(f===0||f===Ob(B))return;const N=j1(B);if(N!==null)return new Promise(V=>{const K=()=>{N.clientHeight===f&&(se.disconnect(),V())},se=new ResizeObserver(K);se.observe(N)})},A=()=>{Vs?.removeEventListener("keyboardWillShow",e),Vs?.removeEventListener("keyboardWillHide",s),e=s=void 0},I=()=>l;return await _(),{init:_,destroy:A,isKeyboardVisible:I}};const Kk={bubbles:{dur:1e3,circles:9,fn:(t,e,s)=>{const l=`${t*e/s-t}ms`,f=2*Math.PI*e/s;return{r:5,style:{top:`${32*Math.sin(f)}%`,left:`${32*Math.cos(f)}%`,"animation-delay":l}}}},circles:{dur:1e3,circles:8,fn:(t,e,s)=>{const l=e/s,f=`${t*l-t}ms`,_=2*Math.PI*l;return{r:5,style:{top:`${32*Math.sin(_)}%`,left:`${32*Math.cos(_)}%`,"animation-delay":f}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(t,e)=>{const s=-(110*e)+"ms";return{r:6,style:{left:`${32-32*e}%`,"animation-delay":s}}}},lines:{dur:1e3,lines:8,fn:(t,e,s)=>{const l=`rotate(${360/s*e+(e<s/2?180:-180)}deg)`,f=`${t*e/s-t}ms`;return{y1:14,y2:26,style:{transform:l,"animation-delay":f}}}},"lines-small":{dur:1e3,lines:8,fn:(t,e,s)=>{const l=`rotate(${360/s*e+(e<s/2?180:-180)}deg)`,f=`${t*e/s-t}ms`;return{y1:12,y2:20,style:{transform:l,"animation-delay":f}}}},"lines-sharp":{dur:1e3,lines:12,fn:(t,e,s)=>{const l=`rotate(${30*e+(e<6?180:-180)}deg)`,f=`${t*e/s-t}ms`;return{y1:17,y2:29,style:{transform:l,"animation-delay":f}}}},"lines-sharp-small":{dur:1e3,lines:12,fn:(t,e,s)=>{const l=`rotate(${30*e+(e<6?180:-180)}deg)`,f=`${t*e/s-t}ms`;return{y1:12,y2:20,style:{transform:l,"animation-delay":f}}}}},Nb=Kk,Jk=":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{-webkit-transform-origin:center;transform-origin:center;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}[dir=rtl] svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}@supports selector(:dir(rtl)){svg:dir(rtl){-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:7px}:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-width:4px}:host(.spinner-lines) line,:host(.spinner-lines-small) line,:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg,:host(.spinner-lines-sharp) svg,:host(.spinner-lines-sharp-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular) svg{-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}",Qk=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.paused=!1}getName(){const e=this.name||Sn.get("spinner"),s=Ps(this);return e||(s==="ios"?"lines":"circular")}render(){var e;const s=this,l=Ps(s),f=s.getName(),_=(e=Nb[f])!==null&&e!==void 0?e:Nb.lines,y=typeof s.duration=="number"&&s.duration>10?s.duration:_.dur,d=[];if(_.circles!==void 0)for(let A=0;A<_.circles;A++)d.push(eC(_,y,A,_.circles));else if(_.lines!==void 0)for(let A=0;A<_.lines;A++)d.push(tC(_,y,A,_.lines));return xi(Go,{key:"a33d6421fcc885995fbc7a348516525f68ca496c",class:Xm(s.color,{[l]:!0,[`spinner-${f}`]:!0,"spinner-paused":s.paused||Sn.getBoolean("_testing")}),role:"progressbar",style:_.elmDuration?{animationDuration:y+"ms"}:{}},d)}static get style(){return Jk}},[257,"ion-spinner",{color:[513],duration:[2],name:[1],paused:[4]}]),eC=(t,e,s,l)=>{const f=t.fn(e,s,l);return f.style["animation-duration"]=e+"ms",xi("svg",{viewBox:f.viewBox||"0 0 64 64",style:f.style},xi("circle",{transform:f.transform||"translate(32,32)",cx:f.cx,cy:f.cy,r:f.r,style:t.elmDuration?{animationDuration:e+"ms"}:{}}))},tC=(t,e,s,l)=>{const f=t.fn(e,s,l);return f.style["animation-duration"]=e+"ms",xi("svg",{viewBox:f.viewBox||"0 0 64 64",style:f.style},xi("line",{transform:"translate(32,32)",y1:f.y1,y2:f.y2}))};function iC(){if(typeof customElements>"u")return;["ion-spinner"].forEach(e=>{e==="ion-spinner"&&(customElements.get(e)||customElements.define(e,Qk))})}const L1=1,R1=2,Hy=3;class zv{constructor(e,s){this.component=e,this.params=s,this.state=L1}async init(e){if(this.state=R1,!this.element){const s=this.component;this.element=await s_(this.delegate,e,s,["ion-page","ion-page-invisible"],this.params)}}_destroy(){Vo(this.state!==Hy,"view state must be ATTACHED");const e=this.element;e&&(this.delegate?this.delegate.removeViewFromDom(e.parentElement,e):e.remove()),this.nav=void 0,this.state=Hy}}const Bb=(t,e,s)=>!t||t.component!==e?!1:Hw(t.params,s),$b=(t,e)=>t?t instanceof zv?t:new zv(t,e):null,nC=t=>t.map(e=>e instanceof zv?e:"component"in e?$b(e.component,e.componentProps===null?void 0:e.componentProps):$b(e,void 0)).filter(e=>e!==null),sC=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",rC=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Yn(this,"ionNavWillLoad",7),this.ionNavWillChange=Yn(this,"ionNavWillChange",3),this.ionNavDidChange=Yn(this,"ionNavDidChange",3),this.transInstr=[],this.gestureOrAnimationInProgress=!1,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.animated=!0}swipeGestureChanged(){this.gesture&&this.gesture.enable(this.swipeGesture===!0)}rootChanged(){this.root!==void 0&&this.didLoad!==!1&&(this.useRouter||this.root!==void 0&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=document.querySelector("ion-router")!==null&&this.el.closest("[no-router]")===null,this.swipeGesture===void 0){const e=Ps(this);this.swipeGesture=Sn.getBoolean("swipeBackEnabled",e==="ios")}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await Ac(async()=>{const{createSwipeBackGesture:e}=await import("./swipe-back-Ds_qBFTx.js");return{createSwipeBackGesture:e}},[])).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const e of this.views)Zu(e.element,N_),e._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(e,s,l,f){return this.insert(-1,e,s,l,f)}insert(e,s,l,f,_){return this.insertPages(e,[{component:s,componentProps:l}],f,_)}insertPages(e,s,l,f){return this.queueTrns({insertStart:e,insertViews:s,opts:l},f)}pop(e,s){return this.removeIndex(-1,1,e,s)}popTo(e,s,l){const f={removeStart:-1,removeCount:-1,opts:s};return typeof e=="object"&&e.component?(f.removeView=e,f.removeStart=1):typeof e=="number"&&(f.removeStart=e+1),this.queueTrns(f,l)}popToRoot(e,s){return this.removeIndex(1,-1,e,s)}removeIndex(e,s=1,l,f){return this.queueTrns({removeStart:e,removeCount:s,opts:l},f)}setRoot(e,s,l,f){return this.setPages([{component:e,componentProps:s}],l,f)}setPages(e,s,l){return s??(s={}),s.animated!==!0&&(s.animated=!1),this.queueTrns({insertStart:0,insertViews:e,removeStart:0,removeCount:-1,opts:s},l)}setRouteId(e,s,l,f){const _=this.getActiveSync();if(Bb(_,e,s))return Promise.resolve({changed:!1,element:_.element});let y;const d=new Promise(B=>y=B);let A;const I={updateURL:!1,viewIsReady:B=>{let N;const V=new Promise(K=>N=K);return y({changed:!0,element:B,markVisible:async()=>{N(),await A}}),V}};if(l==="root")A=this.setRoot(e,s,I);else{const B=this.views.find(N=>Bb(N,e,s));B?A=this.popTo(B,Object.assign(Object.assign({},I),{direction:"back",animationBuilder:f})):l==="forward"?A=this.push(e,s,Object.assign(Object.assign({},I),{animationBuilder:f})):l==="back"&&(A=this.setRoot(e,s,Object.assign(Object.assign({},I),{direction:"back",animated:!0,animationBuilder:f})))}return d}async getRouteId(){const e=this.getActiveSync();if(e)return{id:e.element.tagName,params:e.params,element:e.element}}async getActive(){return this.getActiveSync()}async getByIndex(e){return this.views[e]}async canGoBack(e){return this.canGoBackSync(e)}async getPrevious(e){return this.getPreviousSync(e)}async getLength(){return Promise.resolve(this.views.length)}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(e=this.getActiveSync()){return!!(e&&this.getPreviousSync(e))}getPreviousSync(e=this.getActiveSync()){if(!e)return;const s=this.views,l=s.indexOf(e);return l>0?s[l-1]:void 0}async queueTrns(e,s){var l,f;if(this.isTransitioning&&(!((l=e.opts)===null||l===void 0)&&l.skipIfBusy))return!1;const _=new Promise((y,d)=>{e.resolve=y,e.reject=d});if(e.done=s,e.opts&&e.opts.updateURL!==!1&&this.useRouter){const y=document.querySelector("ion-router");if(y){const d=await y.canTransition();if(d===!1)return!1;if(typeof d=="string")return y.push(d,e.opts.direction||"back"),!1}}return((f=e.insertViews)===null||f===void 0?void 0:f.length)===0&&(e.insertViews=void 0),this.transInstr.push(e),this.nextTrns(),_}success(e,s){if(this.destroyed){this.fireError("nav controller was destroyed",s);return}if(s.done&&s.done(e.hasCompleted,e.requiresTransition,e.enteringView,e.leavingView,e.direction),s.resolve(e.hasCompleted),s.opts.updateURL!==!1&&this.useRouter){const l=document.querySelector("ion-router");if(l){const f=e.direction==="back"?"back":"forward";l.navChanged(f)}}}failed(e,s){if(this.destroyed){this.fireError("nav controller was destroyed",s);return}this.transInstr.length=0,this.fireError(e,s)}fireError(e,s){s.done&&s.done(!1,!1,e),s.reject&&!this.destroyed?s.reject(e):s.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const e=this.transInstr.shift();return e?(this.runTransition(e),!0):!1}async runTransition(e){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(e);const s=this.getActiveSync(),l=this.getEnteringView(e,s);if(!s&&!l)throw new Error("no views in the stack to be removed");l&&l.state===L1&&await l.init(this.el),this.postViewInit(l,s,e);const f=(e.enteringRequiresTransition||e.leavingRequiresTransition)&&l!==s;f&&e.opts&&s&&(e.opts.direction==="back"&&(e.opts.animationBuilder=e.opts.animationBuilder||l?.animationBuilder),s.animationBuilder=e.opts.animationBuilder);let _;f?_=await this.transition(l,s,e):_={hasCompleted:!0,requiresTransition:!1},this.success(_,e),this.ionNavDidChange.emit()}catch(s){this.failed(s,e)}this.isTransitioning=!1,this.nextTrns()}prepareTI(e){var s,l,f;const _=this.views.length;if((s=e.opts)!==null&&s!==void 0||(e.opts={}),(l=(f=e.opts).delegate)!==null&&l!==void 0||(f.delegate=this.delegate),e.removeView!==void 0){Vo(e.removeStart!==void 0,"removeView needs removeStart"),Vo(e.removeCount!==void 0,"removeView needs removeCount");const A=this.views.indexOf(e.removeView);if(A<0)throw new Error("removeView was not found");e.removeStart+=A}e.removeStart!==void 0&&(e.removeStart<0&&(e.removeStart=_-1),e.removeCount<0&&(e.removeCount=_-e.removeStart),e.leavingRequiresTransition=e.removeCount>0&&e.removeStart+e.removeCount===_),e.insertViews&&((e.insertStart<0||e.insertStart>_)&&(e.insertStart=_),e.enteringRequiresTransition=e.insertStart===_);const y=e.insertViews;if(!y)return;Vo(y.length>0,"length can not be zero");const d=nC(y);if(d.length===0)throw new Error("invalid views to insert");for(const A of d){A.delegate=e.opts.delegate;const I=A.nav;if(I&&I!==this)throw new Error("inserted view was already inserted");if(A.state===Hy)throw new Error("inserted view was already destroyed")}e.insertViews=d}getEnteringView(e,s){const l=e.insertViews;if(l!==void 0)return l[l.length-1];const f=e.removeStart;if(f!==void 0){const _=this.views,y=f+e.removeCount;for(let d=_.length-1;d>=0;d--){const A=_[d];if((d<f||d>=y)&&A!==s)return A}}}postViewInit(e,s,l){var f,_,y;Vo(s||e,"Both leavingView and enteringView are null"),Vo(l.resolve,"resolve must be valid"),Vo(l.reject,"reject must be valid");const d=l.opts,{insertViews:A,removeStart:I,removeCount:B}=l;let N;if(I!==void 0&&B!==void 0){Vo(I>=0,"removeStart can not be negative"),Vo(B>=0,"removeCount can not be negative"),N=[];for(let K=I;K<I+B;K++){const se=this.views[K];se!==void 0&&se!==e&&se!==s&&N.push(se)}(f=d.direction)!==null&&f!==void 0||(d.direction="back")}const V=this.views.length+((_=A?.length)!==null&&_!==void 0?_:0)-(B??0);if(Vo(V>=0,"final balance can not be negative"),V===0)throw Ml("[ion-nav] - You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(A){let K=l.insertStart;for(const se of A)this.insertViewAt(se,K),K++;l.enteringRequiresTransition&&((y=d.direction)!==null&&y!==void 0||(d.direction="forward"))}if(N&&N.length>0){for(const K of N)Zu(K.element,Zw),Zu(K.element,Gw),Zu(K.element,N_);for(const K of N)this.destroyView(K)}}async transition(e,s,l){const f=l.opts,_=f.progressAnimation?N=>{N!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,N.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0}),N.progressEnd(0,0,0)):this.sbAni=N}:void 0,y=Ps(this),d=e.element,A=s&&s.element,I=Object.assign(Object.assign({mode:y,showGoBack:this.canGoBackSync(e),baseEl:this.el,progressCallback:_,animated:this.animated&&Sn.getBoolean("animated",!0),enteringEl:d,leavingEl:A},f),{animationBuilder:f.animationBuilder||this.animation||Sn.get("navAnimation")}),{hasCompleted:B}=await Yw(I);return this.transitionFinish(B,e,s,f)}transitionFinish(e,s,l,f){const _=e?s:l;return _&&this.unmountInactiveViews(_),{hasCompleted:e,requiresTransition:!0,enteringView:s,leavingView:l,direction:f.direction}}insertViewAt(e,s){const l=this.views,f=l.indexOf(e);f>-1?(Vo(e.nav===this,"view is not part of the nav"),l.splice(f,1),l.splice(s,0,e)):(Vo(!e.nav,"nav is used"),e.nav=this,l.splice(s,0,e))}removeView(e){Vo(e.state===R1||e.state===Hy,"view state should be loaded or destroyed");const s=this.views,l=s.indexOf(e);Vo(l>-1,"view must be part of the stack"),l>=0&&s.splice(l,1)}destroyView(e){e._destroy(),this.removeView(e)}unmountInactiveViews(e){if(this.destroyed)return;const s=this.views,l=s.indexOf(e);for(let f=s.length-1;f>=0;f--){const _=s[f],y=_.element;y&&(f>l?(Zu(y,N_),this.destroyView(_)):f<l&&Tv(y,!0))}}canStart(){return!this.gestureOrAnimationInProgress&&!!this.swipeGesture&&!this.isTransitioning&&this.transInstr.length===0&&this.canGoBackSync()}onStart(){this.gestureOrAnimationInProgress=!0,this.pop({direction:"back",progressAnimation:!0})}onMove(e){this.sbAni&&this.sbAni.progressStep(e)}onEnd(e,s,l){if(this.sbAni){this.sbAni.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0});let f=e?-.001:.001;e?f+=up([0,0],[.32,.72],[0,1],[1,1],s)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),f+=up([0,0],[1,0],[.68,.28],[1,1],s)[0]),this.sbAni.progressEnd(e?1:0,f,l)}else this.gestureOrAnimationInProgress=!1}render(){return xi("slot",{key:"8067c9835d255daec61f33dba200fd3a6ff839a0"})}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return sC}},[257,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64],getLength:[64]},void 0,{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}]);function aC(){if(typeof customElements>"u")return;["ion-nav"].forEach(e=>{e==="ion-nav"&&(customElements.get(e)||customElements.define(e,rC))})}const oC=aC;const Zy="ionKeyboardDidShow",z1="ionKeyboardDidHide",lC=150;let Gy={},Gu={},fp=!1;const cC=()=>{Gy={},Gu={},fp=!1},uC=t=>{if(I1.getEngine())hC(t);else{if(!t.visualViewport)return;Gu=vx(t.visualViewport),t.visualViewport.onresize=()=>{N1(t),D1()||O1(t)?gx(t):_x(t)&&yx(t)}}},hC=t=>{t.addEventListener("keyboardDidShow",e=>gx(t,e)),t.addEventListener("keyboardDidHide",()=>yx(t))},gx=(t,e)=>{dC(t,e),fp=!0},yx=t=>{fC(t),fp=!1},D1=()=>{const t=(Gy.height-Gu.height)*Gu.scale;return!fp&&Gy.width===Gu.width&&t>lC},O1=t=>fp&&!_x(t),_x=t=>fp&&Gu.height===t.innerHeight,dC=(t,e)=>{const s=e?e.keyboardHeight:t.innerHeight-Gu.height,l=new CustomEvent(Zy,{detail:{keyboardHeight:s}});t.dispatchEvent(l)},fC=t=>{const e=new CustomEvent(z1);t.dispatchEvent(e)},N1=t=>{Gy=Object.assign({},Gu),Gu=vx(t.visualViewport)},vx=t=>({width:Math.round(t.width),height:Math.round(t.height),offsetTop:t.offsetTop,offsetLeft:t.offsetLeft,pageTop:t.pageTop,pageLeft:t.pageLeft,scale:t.scale}),pC=Object.freeze(Object.defineProperty({__proto__:null,KEYBOARD_DID_CLOSE:z1,KEYBOARD_DID_OPEN:Zy,copyVisualViewport:vx,keyboardDidClose:_x,keyboardDidOpen:D1,keyboardDidResize:O1,resetKeyboardAssist:cC,setKeyboardClose:yx,setKeyboardOpen:gx,startKeyboardAssist:uC,trackViewportChanges:N1},Symbol.toStringTag,{value:"Module"}));var hp;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(hp||(hp={}));const xx={getEngine(){const t=C1();if(t?.isPluginAvailable("StatusBar"))return t.Plugins.StatusBar},setStyle(t){const e=this.getEngine();e&&e.setStyle(t)},getStyle:async function(){const t=this.getEngine();if(!t)return hp.Default;const{style:e}=await t.getInfo();return e}},Dv=(t,e)=>{if(e===1)return 0;const s=1/(1-e),l=-(e*s);return t*s+l},B1=()=>{!Vs||Vs.innerWidth>=768||xx.setStyle({style:hp.Dark})},Ov=(t=hp.Default)=>{!Vs||Vs.innerWidth>=768||xx.setStyle({style:t})},$1=async(t,e)=>{typeof t.canDismiss!="function"||!await t.canDismiss(void 0,rp)||(e.isRunning()?e.onFinish(()=>{t.dismiss(void 0,"handler")},{oneTimeCallback:!0}):t.dismiss(void 0,"handler"))},Nv=t=>.00255275*2.71828**(-14.9619*t)-1.00255*2.71828**(-.0380968*t)+1,Yu={MIN_PRESENTING_SCALE:.915},mC=(t,e,s,l)=>{const _=t.offsetHeight;let y=!1,d=!1,A=null,I=null;const B=.2;let N=!0,V=0;const K=()=>A&&mu(A)?A.scrollY:!0,ge=hx({el:t,gestureName:"modalSwipeToClose",gesturePriority:v1,direction:"y",threshold:10,canStart:oe=>{const me=oe.event.target;return me===null||!me.closest?!0:(A=jv(me),A?(mu(A)?I=Pr(A).querySelector(".inner-scroll"):I=A,!!!A.querySelector("ion-refresher")&&I.scrollTop===0):me.closest("ion-footer")===null)},onStart:oe=>{const{deltaY:me}=oe;N=K(),d=t.canDismiss!==void 0&&t.canDismiss!==!0,me>0&&A&&Db(A),e.progressStart(!0,y?1:0)},onMove:oe=>{const{deltaY:me}=oe;me>0&&A&&Db(A);const ye=oe.deltaY/_,ke=ye>=0&&d,Re=ke?B:.9999,Ge=ke?Nv(ye/Re):ye,He=Oy(1e-4,Ge,Re);e.progressStep(He),He>=.5&&V<.5?Ov(s):He<.5&&V>=.5&&B1(),V=He},onEnd:oe=>{const me=oe.velocityY,ye=oe.deltaY/_,ke=ye>=0&&d,Re=ke?B:.9999,Ge=ke?Nv(ye/Re):ye,He=Oy(1e-4,Ge,Re),Xe=(oe.deltaY+me*1e3)/_,at=!ke&&Xe>=.5;let et=at?-.001:.001;at?(e.easing("cubic-bezier(0.32, 0.72, 0, 1)"),et+=up([0,0],[.32,.72],[0,1],[1,1],He)[0]):(e.easing("cubic-bezier(1, 0, 0.68, 0.28)"),et+=up([0,0],[1,0],[.68,.28],[1,1],He)[0]);const Et=Ub(at?ye*_:(1-He)*_,me);y=at,ge.enable(!1),A&&Yk(A,N),e.onFinish(()=>{at||ge.enable(!0)}).progressEnd(at?1:0,et,Et),ke&&He>Re/4?$1(t,e):at&&l()}});return ge},Ub=(t,e)=>Oy(400,t/Math.abs(e*1.1),500),U1=t=>{const{currentBreakpoint:e,backdropBreakpoint:s,expandToScroll:l}=t,f=s===void 0||s<e,_=f?`calc(var(--backdrop-opacity) * ${e})`:"0",y=vn("backdropAnimation").fromTo("opacity",0,_);f&&y.beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]);const d=vn("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:`translateY(${100-e*100}%)`}]),A=l?void 0:vn("contentAnimation").keyframes([{offset:0,opacity:1,maxHeight:`${(1-e)*100}%`},{offset:1,opacity:1,maxHeight:`${e*100}%`}]);return{wrapperAnimation:d,backdropAnimation:y,contentAnimation:A}},F1=t=>{const{currentBreakpoint:e,backdropBreakpoint:s}=t,l=`calc(var(--backdrop-opacity) * ${Dv(e,s)})`,f=[{offset:0,opacity:l},{offset:1,opacity:0}],_=[{offset:0,opacity:l},{offset:s,opacity:0},{offset:1,opacity:0}],y=vn("backdropAnimation").keyframes(s!==0?_:f);return{wrapperAnimation:vn("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:`translateY(${100-e*100}%)`},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:y}},gC=()=>{const t=vn().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=vn().fromTo("transform","translateY(100vh)","translateY(0vh)");return{backdropAnimation:t,wrapperAnimation:e,contentAnimation:void 0}},Fb=(t,e)=>{const{presentingEl:s,currentBreakpoint:l,expandToScroll:f}=e,_=Pr(t),{wrapperAnimation:y,backdropAnimation:d,contentAnimation:A}=l!==void 0?U1(e):gC();d.addElement(_.querySelector("ion-backdrop")),y.addElement(_.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1}),!f&&A?.addElement(t.querySelector(".ion-page"));const I=vn("entering-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation([y]);if(A&&I.addAnimation(A),s){const B=window.innerWidth<768,N=s.tagName==="ION-MODAL"&&s.presentingElement!==void 0,V=Pr(s),K=vn().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),se=document.body;if(B){const ne=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",ve=N?"-10px":ne,re=Yu.MIN_PRESENTING_SCALE,ge=`translateY(${ve}) scale(${re})`;K.afterStyles({transform:ge}).beforeAddWrite(()=>se.style.setProperty("background-color","black")).addElement(s).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:ge,borderRadius:"10px 10px 0 0"}]),I.addAnimation(K)}else if(I.addAnimation(d),!N)y.fromTo("opacity","0","1");else{const ve=`translateY(-10px) scale(${N?Yu.MIN_PRESENTING_SCALE:1})`;K.afterStyles({transform:ve}).addElement(V.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:ve}]);const re=vn().afterStyles({transform:ve}).addElement(V.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:ve}]);I.addAnimation([K,re])}}else I.addAnimation(d);return I},yC=()=>{const t=vn().fromTo("opacity","var(--backdrop-opacity)",0),e=vn().fromTo("transform","translateY(0vh)","translateY(100vh)");return{backdropAnimation:t,wrapperAnimation:e}},Vb=(t,e,s=500)=>{const{presentingEl:l,currentBreakpoint:f}=e,_=Pr(t),{wrapperAnimation:y,backdropAnimation:d}=f!==void 0?F1(e):yC();d.addElement(_.querySelector("ion-backdrop")),y.addElement(_.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const A=vn("leaving-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(s).addAnimation(y);if(l){const I=window.innerWidth<768,B=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,N=Pr(l),V=vn().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish(se=>{if(se!==1)return;l.style.setProperty("overflow",""),Array.from(K.querySelectorAll("ion-modal:not(.overlay-hidden)")).filter(ve=>ve.presentingElement!==void 0).length<=1&&K.style.setProperty("background-color","")}),K=document.body;if(I){const se=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",ne=B?"-10px":se,ve=Yu.MIN_PRESENTING_SCALE,re=`translateY(${ne}) scale(${ve})`;V.addElement(l).keyframes([{offset:0,filter:"contrast(0.85)",transform:re,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),A.addAnimation(V)}else if(A.addAnimation(d),!B)y.fromTo("opacity","1","0");else{const ne=`translateY(-10px) scale(${B?Yu.MIN_PRESENTING_SCALE:1})`;V.addElement(N.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:ne},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const ve=vn().addElement(N.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:ne},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);A.addAnimation([V,ve])}}else A.addAnimation(d);return A},_C=(t,e,s=300)=>{const{presentingEl:l}=e;if(!l)return vn("portrait-to-landscape-transition");const f=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,_=Pr(l),y=document.body,d=vn("portrait-to-landscape-transition").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(s),A=vn().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"});if(f){const B=`translateY(-10px) scale(${Yu.MIN_PRESENTING_SCALE})`,N="translateY(0px) scale(1)";A.addElement(l).afterStyles({transform:N}).fromTo("transform",B,N).fromTo("filter","contrast(0.85)","contrast(1)");const V=vn().addElement(_.querySelector(".modal-shadow")).afterStyles({transform:N,opacity:"0"}).fromTo("transform",B,N);d.addAnimation([A,V])}else{const I=Pr(t),B=vn().addElement(I.querySelectorAll(".modal-wrapper, .modal-shadow")).fromTo("opacity","1","1"),N=vn().addElement(I.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)","var(--backdrop-opacity)"),V=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",K=Yu.MIN_PRESENTING_SCALE,se=`translateY(${V}) scale(${K})`;A.addElement(l).afterStyles({transform:"translateY(0px) scale(1)","border-radius":"0px"}).beforeAddWrite(()=>y.style.setProperty("background-color","")).fromTo("transform",se,"translateY(0px) scale(1)").fromTo("filter","contrast(0.85)","contrast(1)").fromTo("border-radius","10px 10px 0 0","0px"),d.addAnimation([A,B,N])}return d},vC=(t,e,s=300)=>{const{presentingEl:l}=e;if(!l)return vn("landscape-to-portrait-transition");const f=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,_=Pr(l),y=document.body,d=vn("landscape-to-portrait-transition").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(s),A=vn().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"});if(f){const B=`translateY(-10px) scale(${Yu.MIN_PRESENTING_SCALE})`,N="translateY(0) scale(1)";A.addElement(l).afterStyles({transform:N}).fromTo("transform",B,N);const V=vn().addElement(_.querySelector(".modal-shadow")).afterStyles({transform:N,opacity:"0"}).fromTo("transform",B,N);d.addAnimation([A,V])}else{const I=Pr(t),B=vn().addElement(I.querySelectorAll(".modal-wrapper, .modal-shadow")).fromTo("opacity","1","1"),N=vn().addElement(I.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)","var(--backdrop-opacity)"),V=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",K=Yu.MIN_PRESENTING_SCALE,se=`translateY(${V}) scale(${K})`;A.addElement(l).afterStyles({transform:se}).beforeAddWrite(()=>y.style.setProperty("background-color","black")).keyframes([{offset:0,transform:"translateY(0px) scale(1)",filter:"contrast(1)",borderRadius:"0px"},{offset:.2,transform:"translateY(0px) scale(1)",filter:"contrast(1)",borderRadius:"10px 10px 0 0"},{offset:1,transform:se,filter:"contrast(0.85)",borderRadius:"10px 10px 0 0"}]),d.addAnimation([A,B,N])}return d},xC=()=>{const t=vn().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=vn().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}]);return{backdropAnimation:t,wrapperAnimation:e,contentAnimation:void 0}},bC=(t,e)=>{const{currentBreakpoint:s,expandToScroll:l}=e,f=Pr(t),{wrapperAnimation:_,backdropAnimation:y,contentAnimation:d}=s!==void 0?U1(e):xC();y.addElement(f.querySelector("ion-backdrop")),_.addElement(f.querySelector(".modal-wrapper")),!l&&d?.addElement(t.querySelector(".ion-page"));const A=vn().addElement(t).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([y,_]);return d&&A.addAnimation(d),A},wC=()=>{const t=vn().fromTo("opacity","var(--backdrop-opacity)",0),e=vn().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}]);return{backdropAnimation:t,wrapperAnimation:e}},SC=(t,e)=>{const{currentBreakpoint:s}=e,l=Pr(t),{wrapperAnimation:f,backdropAnimation:_}=s!==void 0?F1(e):wC();return _.addElement(l.querySelector("ion-backdrop")),f.addElement(l.querySelector(".modal-wrapper")),vn().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([_,f])},TC=(t,e,s,l,f,_,y=[],d,A,I,B)=>{const N=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}],V=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-f,opacity:0},{offset:1,opacity:0}],K={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:f!==0?V:N,CONTENT_KEYFRAMES:[{offset:0,maxHeight:"100%"},{offset:1,maxHeight:"0%"}]},se=t.querySelector("ion-content"),ne=s.clientHeight;let ve=l,re=0,ge=!1,oe=null,me=null,ye=null,ke=null;const Re=.95,Ge=y[y.length-1],He=y[0],Xe=_.childAnimations.find(Ce=>Ce.id==="wrapperAnimation"),at=_.childAnimations.find(Ce=>Ce.id==="backdropAnimation"),et=_.childAnimations.find(Ce=>Ce.id==="contentAnimation"),Et=()=>{const Ce=t;Ce.focusTrap===!1||Ce.showBackdrop===!1||(t.style.setProperty("pointer-events","auto"),e.style.setProperty("pointer-events","auto"),t.classList.remove(Vy))},gt=()=>{t.style.setProperty("pointer-events","none"),e.style.setProperty("pointer-events","none"),t.classList.add(Vy)},pt=Ce=>{if(!me&&(me=Array.from(t.querySelectorAll("ion-footer")),!me.length))return;const st=t.querySelector(".ion-page");if(ke=Ce,Ce==="stationary")me.forEach(ot=>{ot.classList.remove("modal-footer-moving"),ot.style.removeProperty("position"),ot.style.removeProperty("width"),ot.style.removeProperty("height"),ot.style.removeProperty("top"),ot.style.removeProperty("left"),st?.style.removeProperty("padding-bottom"),st?.appendChild(ot)});else{let ot=0;me.forEach((_t,kt)=>{const It=_t.getBoundingClientRect(),ei=document.body.getBoundingClientRect();ot+=_t.clientHeight;const li=It.top-ei.top,Gi=It.left-ei.left;if(_t.style.setProperty("--pinned-width",`${_t.clientWidth}px`),_t.style.setProperty("--pinned-height",`${_t.clientHeight}px`),_t.style.setProperty("--pinned-top",`${li}px`),_t.style.setProperty("--pinned-left",`${Gi}px`),kt===0){ye=li;const Mi=t.querySelector("ion-header");Mi&&(ye-=Mi.clientHeight)}}),me.forEach(_t=>{st?.style.setProperty("padding-bottom",`${ot}px`),_t.classList.add("modal-footer-moving"),_t.style.setProperty("position","absolute"),_t.style.setProperty("width","var(--pinned-width)"),_t.style.setProperty("height","var(--pinned-height)"),_t.style.setProperty("top","var(--pinned-top)"),_t.style.setProperty("left","var(--pinned-left)"),document.body.appendChild(_t)})}};Xe&&at&&(Xe.keyframes([...K.WRAPPER_KEYFRAMES]),at.keyframes([...K.BACKDROP_KEYFRAMES]),et?.keyframes([...K.CONTENT_KEYFRAMES]),_.progressStart(!0,1-ve),ve>f&&t.focusTrap!==!1&&t.showBackdrop!==!1?Et():gt()),se&&ve!==Ge&&d&&(se.scrollY=!1);const $e=Ce=>{const st=jv(Ce.event.target);if(ve=A(),!d&&st)return(mu(st)?Pr(st).querySelector(".inner-scroll"):st).scrollTop===0;if(ve===1&&st){const ot=mu(st)?Pr(st).querySelector(".inner-scroll"):st;return!!!st.querySelector("ion-refresher")&&ot.scrollTop===0}return!0},ct=Ce=>{if(ge=t.canDismiss!==void 0&&t.canDismiss!==!0&&He===0,!d){const st=jv(Ce.event.target);oe=st&&mu(st)?Pr(st).querySelector(".inner-scroll"):st}d||pt("moving"),Ce.deltaY>0&&se&&(se.scrollY=!1),pu(()=>{t.focus()}),_.progressStart(!0,1-ve)},We=Ce=>{if(!d&&ye!==null&&ke!==null&&(Ce.currentY>=ye&&ke==="moving"?pt("stationary"):Ce.currentY<ye&&ke==="stationary"&&pt("moving")),!d&&Ce.deltaY<=0&&oe)return;Ce.deltaY>0&&se&&(se.scrollY=!1);const st=1-ve,ot=y.length>1?1-y[1]:void 0,_t=st+Ce.deltaY/ne,kt=ot!==void 0&&_t>=ot&&ge,It=kt?Re:.9999,ei=kt&&ot!==void 0?ot+Nv((_t-ot)/(It-ot)):_t;re=Oy(1e-4,ei,It),_.progressStep(re)},Tt=Ce=>{if(!d&&Ce.deltaY<=0&&oe&&oe.scrollTop>0){pt("stationary");return}const st=Ce.velocityY,ot=(Ce.deltaY+st*350)/ne,_t=ve-ot,kt=y.reduce((It,ei)=>Math.abs(ei-_t)<Math.abs(It-_t)?ei:It);lt({breakpoint:kt,breakpointOffset:re,canDismiss:ge,animated:!0})},lt=Ce=>{const{breakpoint:st,canDismiss:ot,breakpointOffset:_t,animated:kt}=Ce,It=ot&&st===0,ei=It?ve:st,li=ei!==0;return ve=0,Xe&&at&&(Xe.keyframes([{offset:0,transform:`translateY(${_t*100}%)`},{offset:1,transform:`translateY(${(1-ei)*100}%)`}]),at.keyframes([{offset:0,opacity:`calc(var(--backdrop-opacity) * ${Dv(1-_t,f)})`},{offset:1,opacity:`calc(var(--backdrop-opacity) * ${Dv(ei,f)})`}]),et&&et.keyframes([{offset:0,maxHeight:`${(1-_t)*100}%`},{offset:1,maxHeight:`${ei*100}%`}]),_.progressStep(0)),xe.enable(!1),It?$1(t,_):li||I(),se&&(ei===y[y.length-1]||!d)&&(se.scrollY=!0),!d&&ei===0&&pt("stationary"),new Promise(Gi=>{_.onFinish(()=>{li?(d||pt("stationary"),Xe&&at?pu(()=>{Xe.keyframes([...K.WRAPPER_KEYFRAMES]),at.keyframes([...K.BACKDROP_KEYFRAMES]),et?.keyframes([...K.CONTENT_KEYFRAMES]),_.progressStart(!0,1-ei),ve=ei,B(ve),ve>f&&t.focusTrap!==!1&&t.showBackdrop!==!1?Et():gt(),xe.enable(!0),Gi()}):(xe.enable(!0),Gi())):Gi()},{oneTimeCallback:!0}).progressEnd(1,0,kt?500:0)})},xe=hx({el:s,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:$e,onStart:ct,onMove:We,onEnd:Tt});return{gesture:xe,moveSheetToBreakpoint:lt}},EC=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, var(--ion-background-color-step-350, #c0c0be));cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host(.modal-sheet.modal-no-expand-scroll) ion-footer{position:absolute;bottom:0;width:var(--width)}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-start-start-radius:var(--border-radius);border-start-end-radius:var(--border-radius);border-end-end-radius:0;border-end-start-radius:0}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-start-start-radius:var(--border-radius);border-start-end-radius:var(--border-radius);border-end-end-radius:0;border-end-start-radius:0}',kC=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, var(--ion-background-color-step-350, #c0c0be));cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host(.modal-sheet.modal-no-expand-scroll) ion-footer{position:absolute;bottom:0;width:var(--width)}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}',CC=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.didPresent=Yn(this,"ionModalDidPresent",7),this.willPresent=Yn(this,"ionModalWillPresent",7),this.willDismiss=Yn(this,"ionModalWillDismiss",7),this.didDismiss=Yn(this,"ionModalDidDismiss",7),this.ionBreakpointDidChange=Yn(this,"ionBreakpointDidChange",7),this.didPresentShorthand=Yn(this,"didPresent",7),this.willPresentShorthand=Yn(this,"willPresent",7),this.willDismissShorthand=Yn(this,"willDismiss",7),this.didDismissShorthand=Yn(this,"didDismiss",7),this.ionMount=Yn(this,"ionMount",7),this.lockController=mx(),this.triggerController=x1(),this.coreDelegate=u1(),this.isSheetModal=!1,this.inheritedAttributes={},this.inline=!1,this.gestureAnimationDismissing=!1,this.presented=!1,this.hasController=!1,this.keyboardClose=!0,this.expandToScroll=!0,this.backdropBreakpoint=0,this.handleBehavior="none",this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.isOpen=!1,this.keepContentsMounted=!1,this.focusTrap=!0,this.canDismiss=!0,this.onHandleClick=()=>{const{sheetTransition:s,handleBehavior:l}=this;l!=="cycle"||s!==void 0||this.moveToNextBreakpoint()},this.onBackdropTap=()=>{const{sheetTransition:s}=this;s===void 0&&this.dismiss(void 0,Fy)},this.onLifecycle=s=>{const l=this.usersElement,f=AC[s.type];if(l&&f){const _=new CustomEvent(f,{bubbles:!1,cancelable:!1,detail:s.detail});l.dispatchEvent(_)}},this.onModalFocus=s=>{const{dragHandleEl:l,el:f}=this;s.target===f&&l&&l.tabIndex!==-1&&l.focus()},this.onSlotChange=({target:s})=>{s.assignedElements().forEach(f=>{f.querySelectorAll("ion-modal").forEach(_=>{_.getAttribute("data-parent-ion-modal")===null&&_.setAttribute("data-parent-ion-modal",this.el.id)})})}}onIsOpenChange(e,s){e===!0&&s===!1?this.present():e===!1&&s===!0&&this.dismiss()}triggerChanged(){const{trigger:e,el:s,triggerController:l}=this;e&&l.addClickListener(s,e)}onWindowResize(){Ps(this)!=="ios"||!this.presentingElement||this.enterAnimation||this.leaveAnimation||(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.handleViewTransition()},50))}breakpointsChanged(e){e!==void 0&&(this.sortedBreakpoints=e.sort((s,l)=>s-l))}connectedCallback(){const{el:e}=this;d1(e),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener(),this.cleanupViewTransitionListener(),this.cleanupParentRemovalObserver()}componentWillLoad(){var e;const{breakpoints:s,initialBreakpoint:l,el:f,htmlAttributes:_}=this,y=this.isSheetModal=s!==void 0&&l!==void 0,d=["aria-label","role"];this.inheritedAttributes=ux(f,d),f.parentNode&&(this.cachedOriginalParent=f.parentNode),_!==void 0&&d.forEach(A=>{_[A]&&(this.inheritedAttributes=Object.assign(Object.assign({},this.inheritedAttributes),{[A]:_[A]}),delete _[A])}),y&&(this.currentBreakpoint=this.initialBreakpoint),s!==void 0&&l!==void 0&&!s.includes(l)&&Ml("[ion-modal] - Your breakpoints array must include the initialBreakpoint value."),!((e=this.htmlAttributes)===null||e===void 0)&&e.id||f1(this.el)}componentDidLoad(){this.isOpen===!0&&pu(()=>this.present()),this.breakpointsChanged(this.breakpoints),this.triggerChanged()}getDelegate(e=!1){if(this.workingDelegate&&!e)return{delegate:this.workingDelegate,inline:this.inline};const s=this.el.parentNode,l=this.inline=s!==null&&!this.hasController,f=this.workingDelegate=l?this.delegate||this.coreDelegate:this.delegate;return{inline:l,delegate:f}}async checkCanDismiss(e,s){const{canDismiss:l}=this;return typeof l=="function"?l(e,s):l}async present(){const e=await this.lockController.lock();if(this.presented){e();return}const{presentingElement:s,el:l}=this;this.currentBreakpoint=this.initialBreakpoint;const{inline:f,delegate:_}=this.getDelegate(!0);this.ionMount.emit(),this.usersElement=await s_(_,l,this.component,["ion-page"],this.componentProps,f),Dy(l)?await Ny(this.usersElement):this.keepContentsMounted||await uE(),Rm(()=>this.el.classList.add("show-modal"));const y=s!==void 0;y&&Ps(this)==="ios"&&(this.statusBarStyle=await xx.getStyle(),B1()),await g1(this,"modalEnter",Fb,bC,{presentingEl:s,currentBreakpoint:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint,expandToScroll:this.expandToScroll}),typeof window<"u"&&(this.keyboardOpenCallback=()=>{this.gesture&&(this.gesture.enable(!1),pu(()=>{this.gesture&&this.gesture.enable(!0)}))},window.addEventListener(Zy,this.keyboardOpenCallback));const d=this.breakpoints!==void 0&&this.initialBreakpoint!==void 0;this.isSheetModal=d,d?this.initSheetGesture():y&&this.initSwipeToClose(),this.initViewTransitionListener(),this.initParentRemovalObserver(),e()}initSwipeToClose(){var e;if(Ps(this)!=="ios")return;const{el:s}=this,l=this.leaveAnimation||Sn.get("modalLeave",Vb),f=this.animation=l(s,{presentingEl:this.presentingElement,expandToScroll:this.expandToScroll});if(!Gk(s)){Wk(s);return}const y=(e=this.statusBarStyle)!==null&&e!==void 0?e:hp.Default;this.gesture=mC(s,f,y,()=>{this.gestureAnimationDismissing=!0,Ov(this.statusBarStyle),this.animation.onFinish(async()=>{await this.dismiss(void 0,rp),this.gestureAnimationDismissing=!1})}),this.gesture.enable(!0)}initSheetGesture(){const{wrapperEl:e,initialBreakpoint:s,backdropBreakpoint:l}=this;if(!e||s===void 0)return;const f=this.enterAnimation||Sn.get("modalEnter",Fb),_=this.animation=f(this.el,{presentingEl:this.presentingElement,currentBreakpoint:s,backdropBreakpoint:l,expandToScroll:this.expandToScroll});_.progressStart(!0,1);const{gesture:y,moveSheetToBreakpoint:d}=TC(this.el,this.backdropEl,e,s,l,_,this.sortedBreakpoints,this.expandToScroll,()=>{var I;return(I=this.currentBreakpoint)!==null&&I!==void 0?I:0},()=>this.sheetOnDismiss(),I=>{this.currentBreakpoint!==I&&(this.currentBreakpoint=I,this.ionBreakpointDidChange.emit({breakpoint:I}))});this.gesture=y,this.moveSheetToBreakpoint=d,this.gesture.enable(!0),(this.showBackdrop===!1||this.focusTrap===!1||l>0)&&this.setupChildRoutePassthrough()}setupChildRoutePassthrough(){var e;this.cachedPageParent=this.getOriginalPageParent();const s=this.cachedPageParent;if(!s||s.tagName==="ION-APP"||Array.from(s.children).some(_=>{var y;return _!==this.el&&!(_ instanceof Da&&window.getComputedStyle(_).display==="none")&&_.tagName!=="TEMPLATE"&&_.tagName!=="SLOT"&&!(_.nodeType===Node.TEXT_NODE&&!(!((y=_.textContent)===null||y===void 0)&&y.trim()))}))return;s.classList.add("ion-page-overlay-passthrough");const f=s.parentElement;f?.tagName==="ION-ROUTER-OUTLET"&&((e=f.parentElement)===null||e===void 0?void 0:e.tagName)!=="ION-APP"&&(f.style.setProperty("pointer-events","none"),f.setAttribute("data-overlay-passthrough","true"))}getOriginalPageParent(){if(!this.cachedOriginalParent)return null;let e=this.cachedOriginalParent;for(;e&&!e.classList.contains("ion-page");)e=e.parentElement;return e}cleanupChildRoutePassthrough(){const e=this.cachedPageParent;if(!e)return;e.classList.remove("ion-page-overlay-passthrough");const s=e.parentElement;s?.hasAttribute("data-overlay-passthrough")&&(s.style.removeProperty("pointer-events"),s.removeAttribute("data-overlay-passthrough")),this.cachedPageParent=void 0}sheetOnDismiss(){this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{this.currentBreakpoint=0,this.ionBreakpointDidChange.emit({breakpoint:this.currentBreakpoint}),await this.dismiss(void 0,rp),this.gestureAnimationDismissing=!1})}async dismiss(e,s){var l;if(this.gestureAnimationDismissing&&s!==rp)return!1;const f=await this.lockController.lock();if(await this.dismissNestedModals(),s!=="handler"&&!await this.checkCanDismiss(e,s))return f(),!1;const{presentingElement:_}=this;_!==void 0&&Ps(this)==="ios"&&Ov(this.statusBarStyle),typeof window<"u"&&this.keyboardOpenCallback&&(window.removeEventListener(Zy,this.keyboardOpenCallback),this.keyboardOpenCallback=void 0);const d=await y1(this,e,s,"modalLeave",Vb,SC,{presentingEl:_,currentBreakpoint:(l=this.currentBreakpoint)!==null&&l!==void 0?l:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint,expandToScroll:this.expandToScroll});if(d){const{delegate:A}=this.getDelegate();await c1(A,this.usersElement),Rm(()=>this.el.classList.remove("show-modal")),this.animation&&this.animation.destroy(),this.gesture&&this.gesture.destroy(),this.cleanupViewTransitionListener(),this.cleanupParentRemovalObserver(),this.cleanupChildRoutePassthrough()}return this.currentBreakpoint=void 0,this.animation=void 0,f(),d}onDidDismiss(){return Uy(this.el,"ionModalDidDismiss")}onWillDismiss(){return Uy(this.el,"ionModalWillDismiss")}async setCurrentBreakpoint(e){if(!this.isSheetModal){Ml("[ion-modal] - setCurrentBreakpoint is only supported on sheet modals.");return}if(!this.breakpoints.includes(e)){Ml(`[ion-modal] - Attempted to set invalid breakpoint value ${e}. Please double check that the breakpoint value is part of your defined breakpoints.`);return}const{currentBreakpoint:s,moveSheetToBreakpoint:l,canDismiss:f,breakpoints:_,animated:y}=this;s!==e&&l&&(this.sheetTransition=l({breakpoint:e,breakpointOffset:1-s,canDismiss:f!==void 0&&f!==!0&&_[0]===0,animated:y}),await this.sheetTransition,this.sheetTransition=void 0)}async getCurrentBreakpoint(){return this.currentBreakpoint}async moveToNextBreakpoint(){const{breakpoints:e,currentBreakpoint:s}=this;if(!e||s==null)return!1;const l=e.filter(d=>d!==0),_=(l.indexOf(s)+1)%l.length,y=l[_];return await this.setCurrentBreakpoint(y),!0}initViewTransitionListener(){Ps(this)!=="ios"||!this.presentingElement||this.enterAnimation||this.leaveAnimation||(this.currentViewIsPortrait=window.innerWidth<768)}handleViewTransition(){if(!this.presented)return;const e=window.innerWidth<768;if(this.currentViewIsPortrait===e)return;this.viewTransitionAnimation&&(this.viewTransitionAnimation.destroy(),this.viewTransitionAnimation=void 0);const{presentingElement:s}=this;if(!s)return;let l;this.currentViewIsPortrait&&!e?l=_C(this.el,{presentingEl:s}):l=vC(this.el,{presentingEl:s}),this.currentViewIsPortrait=e,this.viewTransitionAnimation=l,l.play().then(()=>{this.viewTransitionAnimation=void 0,this.reinitSwipeToClose()})}cleanupViewTransitionListener(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=void 0),this.viewTransitionAnimation&&(this.viewTransitionAnimation.destroy(),this.viewTransitionAnimation=void 0)}reinitSwipeToClose(){Ps(this)!=="ios"||!this.presentingElement||(this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.animation&&(this.animation.progressEnd(0,0,0),this.animation.destroy(),this.animation=void 0),pu(()=>{this.ensureCorrectModalPosition(),this.initSwipeToClose()}))}ensureCorrectModalPosition(){const{el:e,presentingElement:s}=this,f=Pr(e).querySelector(".modal-wrapper");if(f&&(f.style.transform="translateY(0vh)",f.style.opacity="1"),s?.tagName==="ION-MODAL")if(window.innerWidth<768){const y=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",d=Yu.MIN_PRESENTING_SCALE;s.style.transform=`translateY(${y}) scale(${d})`}else s.style.transform="translateY(0px) scale(1)"}async dismissNestedModals(){const e=document.querySelectorAll(`ion-modal[data-parent-ion-modal="${this.el.id}"]`);e?.forEach(async s=>{await s.dismiss(void 0,"parent-dismissed")})}initParentRemovalObserver(){typeof MutationObserver>"u"||typeof window>"u"||!this.cachedOriginalParent||this.cachedOriginalParent.nodeType===Node.DOCUMENT_NODE||this.cachedOriginalParent.nodeType===Node.DOCUMENT_FRAGMENT_NODE||this.hasController||this.cachedOriginalParent===document.body||this.cachedOriginalParent.tagName==="ION-APP"||(this.parentRemovalObserver=new MutationObserver(e=>{e.forEach(s=>{if(s.type==="childList"&&s.removedNodes.length>0){const l=Array.from(s.removedNodes).some(_=>{var y,d;const A=_===this.cachedOriginalParent,I=this.cachedOriginalParent?(d=(y=_).contains)===null||d===void 0?void 0:d.call(y,this.cachedOriginalParent):!1;return A||I}),f=this.cachedOriginalParent&&!this.cachedOriginalParent.isConnected;(l||f)&&(this.dismiss(void 0,"parent-removed"),this.cachedOriginalParent=void 0)}})}),this.parentRemovalObserver.observe(document.body,{childList:!0,subtree:!0}))}cleanupParentRemovalObserver(){var e;(e=this.parentRemovalObserver)===null||e===void 0||e.disconnect(),this.parentRemovalObserver=void 0}render(){const{handle:e,isSheetModal:s,presentingElement:l,htmlAttributes:f,handleBehavior:_,inheritedAttributes:y,focusTrap:d,expandToScroll:A}=this,I=e!==!1&&s,B=Ps(this),N=l!==void 0&&B==="ios",V=_==="cycle";return xi(Go,Object.assign({key:"87328006ea6c75ebc518ace300438492a567223e","no-router":!0,tabIndex:V&&(s&&I)?0:-1},f,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[B]:!0,"modal-default":!N&&!s,"modal-card":N,"modal-sheet":s,"modal-no-expand-scroll":s&&!A,"overlay-hidden":!0,[Vy]:d===!1},o1(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle,onFocus:this.onModalFocus}),xi("ion-backdrop",{key:"ee94ff8e09b691dd4ad4e4db1720f06bc3c5a469",ref:se=>this.backdropEl=se,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),B==="ios"&&xi("div",{key:"bffd69b4635c22d9f249725bd952c1e93d5615c7",class:"modal-shadow"}),xi("div",Object.assign({key:"1d394d3c68916e464ff1fbf5242419f4a3d3cca1",role:"dialog"},y,{"aria-modal":"true",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:se=>this.wrapperEl=se}),I&&xi("button",{key:"2dcf58792018e557e0c323baad2d672bc99c0bb1",class:"modal-handle",tabIndex:V?0:-1,"aria-label":"Activate to adjust the size of the dialog overlaying the screen",onClick:V?this.onHandleClick:void 0,part:"handle",ref:se=>this.dragHandleEl=se}),xi("slot",{key:"44164b1e8710c3895400ad9f44ecd99873874ad5",onSlotchange:this.onSlotChange})))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:EC,md:kC}}},[289,"ion-modal",{hasController:[4,"has-controller"],overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],breakpoints:[16],expandToScroll:[4,"expand-to-scroll"],initialBreakpoint:[2,"initial-breakpoint"],backdropBreakpoint:[2,"backdrop-breakpoint"],handle:[4],handleBehavior:[1,"handle-behavior"],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],presentingElement:[16],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],keepContentsMounted:[4,"keep-contents-mounted"],focusTrap:[4,"focus-trap"],canDismiss:[4,"can-dismiss"],isSheetModal:[32],presented:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64],setCurrentBreakpoint:[64],getCurrentBreakpoint:[64]},[[9,"resize","onWindowResize"]],{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}]),AC={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"};function MC(){if(typeof customElements>"u")return;["ion-modal","ion-backdrop"].forEach(e=>{switch(e){case"ion-modal":customElements.get(e)||customElements.define(e,CC);break;case"ion-backdrop":customElements.get(e)||jk();break}})}const PC=iC;const IC=":host(.tab-hidden){display:none !important}",jC=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.loaded=!1,this.active=!1}async componentWillLoad(){this.active&&await this.setActive()}async setActive(){await this.prepareLazyLoaded(),this.active=!0}changeActive(e){e&&this.prepareLazyLoaded()}prepareLazyLoaded(){if(!this.loaded&&this.component!=null){this.loaded=!0;try{return s_(this.delegate,this.el,this.component,["ion-page"])}catch(e){Ku("[ion-tab] - Exception in prepareLazyLoaded:",e)}}return Promise.resolve(void 0)}render(){const{tab:e,active:s,component:l}=this;return xi(Go,{key:"dbad8fe9f1566277d14647626308eaf1601ab01f",role:"tabpanel","aria-hidden":s?null:"true","aria-labelledby":`tab-button-${e}`,class:{"ion-page":l===void 0,"tab-hidden":!s}},xi("slot",{key:"3be64f4e7161f6769aaf8e4dcb5293fcaa09af45"}))}get el(){return this}static get watchers(){return{active:["changeActive"]}}static get style(){return IC}},[257,"ion-tab",{active:[1028],delegate:[16],tab:[1],component:[1],setActive:[64]},void 0,{active:["changeActive"]}]);function LC(){if(typeof customElements>"u")return;["ion-tab"].forEach(e=>{e==="ion-tab"&&(customElements.get(e)||customElements.define(e,jC))})}const RC=LC;function zC(t,e,s,l){let f;if(s==="md"?f=t==="top"?8:-8:f=t==="top"?10:-10,e&&Vs){DC(e,l);const _=e.getBoundingClientRect();return t==="top"?f+=_.bottom:t==="bottom"&&(f-=Vs.innerHeight-_.top),{top:`${f}px`,bottom:`${f}px`}}else return{top:`calc(${f}px + var(--ion-safe-area-top, 0px))`,bottom:`calc(${f}px - var(--ion-safe-area-bottom, 0px))`}}function DC(t,e){t.offsetParent===null&&Ml("[ion-toast] - The positionAnchor element for ion-toast was found in the DOM, but appears to be hidden. This may lead to unexpected positioning of the toast.",e)}const bx=(t,e)=>Math.floor(t/2-e/2),OC=(t,e)=>{const s=vn(),l=vn(),{position:f,top:_,bottom:y}=e,A=Pr(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":l.fromTo("transform","translateY(-100%)",`translateY(${_})`);break;case"middle":const I=bx(t.clientHeight,A.clientHeight);A.style.top=`${I}px`,l.fromTo("opacity",.01,1);break;default:l.fromTo("transform","translateY(100%)",`translateY(${y})`);break}return s.easing("cubic-bezier(.155,1.105,.295,1.12)").duration(400).addAnimation(l)},NC=(t,e)=>{const s=vn(),l=vn(),{position:f,top:_,bottom:y}=e,A=Pr(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":l.fromTo("transform",`translateY(${_})`,"translateY(-100%)");break;case"middle":l.fromTo("opacity",.99,0);break;default:l.fromTo("transform",`translateY(${y})`,"translateY(100%)");break}return s.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(l)},BC=(t,e)=>{const s=vn(),l=vn(),{position:f,top:_,bottom:y}=e,A=Pr(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":A.style.setProperty("transform",`translateY(${_})`),l.fromTo("opacity",.01,1);break;case"middle":const I=bx(t.clientHeight,A.clientHeight);A.style.top=`${I}px`,l.fromTo("opacity",.01,1);break;default:A.style.setProperty("transform",`translateY(${y})`),l.fromTo("opacity",.01,1);break}return s.easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation(l)},$C=t=>{const e=vn(),s=vn(),f=Pr(t).querySelector(".toast-wrapper");return s.addElement(f).fromTo("opacity",.99,0),e.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(s)},UC=(t,e,s)=>{const l=Pr(t).querySelector(".toast-wrapper"),f=t.clientHeight,_=l.getBoundingClientRect();let y=0;const d=.5,A=t.position==="middle"?.5:0,I=t.position==="top"?-1:1,B=bx(f,_.height),N=[{offset:0,transform:`translateY(-${B+_.height}px)`},{offset:.5,transform:"translateY(0px)"},{offset:1,transform:`translateY(${B+_.height}px)`}],V=vn("toast-swipe-to-dismiss-animation").addElement(l).duration(100);switch(t.position){case"middle":y=f+_.height,V.keyframes(N),V.progressStart(!0,.5);break;case"top":y=_.bottom,V.keyframes([{offset:0,transform:`translateY(${e.top})`},{offset:1,transform:"translateY(-100%)"}]),V.progressStart(!0,0);break;default:y=f-_.top,V.keyframes([{offset:0,transform:`translateY(${e.bottom})`},{offset:1,transform:"translateY(100%)"}]),V.progressStart(!0,0);break}const K=re=>re*I/y,ve=hx({el:l,gestureName:"toast-swipe-to-dismiss",gesturePriority:v1,direction:"y",onMove:re=>{const ge=A+K(re.deltaY);V.progressStep(ge)},onEnd:re=>{const ge=re.velocityY,oe=(re.deltaY+ge*1e3)/y*I;ve.enable(!1);let me=!0,ye=1,ke=0,Re=0;if(t.position==="middle"){me=oe>=d/2||oe<=-.5/2,ye=1,ke=0;const He=l.getBoundingClientRect(),Xe=He.top-B,at=`${Xe}px`,et=re.deltaY<=0?-1:1,Et=(B+He.height)*et,gt=me?`${Et}px`:"0px",pt=[{offset:0,transform:`translateY(${at})`},{offset:1,transform:`translateY(${gt})`}];V.keyframes(pt),Re=Et-Xe}else me=oe>=d,ye=me?1:0,ke=K(re.deltaY),Re=(me?1-ke:ke)*y;const Ge=Math.min(Math.abs(Re)/Math.abs(ge),200);V.onFinish(()=>{me?(s(),V.destroy()):(t.position==="middle"?V.keyframes(N).progressStart(!0,.5):V.progressStart(!0,0),ve.enable(!0))},{oneTimeCallback:!0}).progressEnd(ye,ke,Ge)}});return ve},FC=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host{inset-inline-start:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);pointer-events:auto}.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-content{min-width:0}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-50, var(--ion-background-color-step-50, #f2f2f2));--border-radius:14px;--button-color:var(--ion-color-primary, #0054e9);--color:var(--ion-color-step-850, var(--ion-text-color-step-150, #262626));--max-width:700px;--max-height:478px;--start:10px;--end:10px;font-size:clamp(14px, 0.875rem, 43.4px)}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;z-index:10}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.toast-translucent) .toast-wrapper{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}:host(.ion-color.toast-translucent) .toast-wrapper{background:rgba(var(--ion-color-base-rgb), 0.8)}}.toast-wrapper.toast-middle{opacity:0.01}.toast-content{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:15px;padding-bottom:15px}.toast-header{margin-bottom:2px;font-weight:500}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;min-height:44px;-webkit-transition:background-color, opacity 100ms linear;transition:background-color, opacity 100ms linear;border:0;background-color:transparent;font-family:var(--ion-font-family);font-size:clamp(17px, 1.0625rem, 21.998px);font-weight:500;overflow:hidden}.toast-button.ion-activated{opacity:0.4}@media (any-hover: hover){.toast-button:hover{opacity:0.6}}",VC=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host{inset-inline-start:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);pointer-events:auto}.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-content{min-width:0}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-800, var(--ion-background-color-step-800, #333333));--border-radius:4px;--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--button-color:var(--ion-color-primary, #0054e9);--color:var(--ion-color-step-50, var(--ion-text-color-step-950, #f2f2f2));--max-width:700px;--start:8px;--end:8px;font-size:0.875rem}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;opacity:0.01;z-index:10}.toast-content{-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px;padding-top:14px;padding-bottom:14px}.toast-header{margin-bottom:2px;font-weight:500;line-height:1.25rem}.toast-message{line-height:1.25rem}.toast-layout-baseline .toast-button-group-start{-webkit-margin-start:8px;margin-inline-start:8px}.toast-layout-stacked .toast-button-group-start{-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px}.toast-layout-baseline .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px}.toast-layout-stacked .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px;margin-bottom:8px}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;font-family:var(--ion-font-family);font-size:0.875rem;font-weight:500;letter-spacing:0.84px;text-transform:uppercase;overflow:hidden}.toast-button-cancel{color:var(--ion-color-step-100, var(--ion-text-color-step-900, #e6e6e6))}.toast-button-icon-only{border-radius:50%;-webkit-padding-start:9px;padding-inline-start:9px;-webkit-padding-end:9px;padding-inline-end:9px;padding-top:9px;padding-bottom:9px;width:36px;height:36px}@media (any-hover: hover){.toast-button:hover{background-color:rgba(var(--ion-color-primary-rgb, 0, 84, 233), 0.08)}.toast-button-cancel:hover{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.08)}}",qC=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.didPresent=Yn(this,"ionToastDidPresent",7),this.willPresent=Yn(this,"ionToastWillPresent",7),this.willDismiss=Yn(this,"ionToastWillDismiss",7),this.didDismiss=Yn(this,"ionToastDidDismiss",7),this.didPresentShorthand=Yn(this,"didPresent",7),this.willPresentShorthand=Yn(this,"willPresent",7),this.willDismissShorthand=Yn(this,"willDismiss",7),this.didDismissShorthand=Yn(this,"didDismiss",7),this.delegateController=uk(this),this.lockController=mx(),this.triggerController=x1(),this.customHTMLEnabled=Sn.get("innerHTMLTemplatesEnabled",VE),this.presented=!1,this.revealContentToScreenReader=!1,this.hasController=!1,this.duration=Sn.getNumber("toastDuration",0),this.layout="baseline",this.keyboardClose=!1,this.position="bottom",this.translucent=!1,this.animated=!0,this.isOpen=!1,this.dispatchCancelHandler=s=>{const l=s.detail.role;if(Pv(l)){const f=this.getButtons().find(_=>_.role==="cancel");this.callButtonHandler(f)}},this.createSwipeGesture=s=>{(this.gesture=UC(this.el,s,()=>{this.dismiss(void 0,rp)})).enable(!0)},this.destroySwipeGesture=()=>{const{gesture:s}=this;s!==void 0&&(s.destroy(),this.gesture=void 0)},this.prefersSwipeGesture=()=>{const{swipeGesture:s}=this;return s==="vertical"}}swipeGestureChanged(){this.destroySwipeGesture(),this.presented&&this.prefersSwipeGesture()&&this.createSwipeGesture(this.lastPresentedPosition)}onIsOpenChange(e,s){e===!0&&s===!1?this.present():e===!1&&s===!0&&this.dismiss()}triggerChanged(){const{trigger:e,el:s,triggerController:l}=this;e&&l.addClickListener(s,e)}connectedCallback(){d1(this.el),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){var e;!((e=this.htmlAttributes)===null||e===void 0)&&e.id||f1(this.el)}componentDidLoad(){this.isOpen===!0&&pu(()=>this.present()),this.triggerChanged()}async present(){const e=await this.lockController.lock();await this.delegateController.attachViewToDom();const{el:s,position:l}=this,f=this.getAnchorElement(),_=zC(l,f,Ps(this),s);this.lastPresentedPosition=_,await g1(this,"toastEnter",OC,BC,{position:l,top:_.top,bottom:_.bottom}),this.revealContentToScreenReader=!0,this.duration>0&&(this.durationTimeout=setTimeout(()=>this.dismiss(void 0,"timeout"),this.duration)),this.prefersSwipeGesture()&&this.createSwipeGesture(_),e()}async dismiss(e,s){var l,f;const _=await this.lockController.lock(),{durationTimeout:y,position:d,lastPresentedPosition:A}=this;y&&clearTimeout(y);const I=await y1(this,e,s,"toastLeave",NC,$C,{position:d,top:(l=A?.top)!==null&&l!==void 0?l:"",bottom:(f=A?.bottom)!==null&&f!==void 0?f:""});return I&&(this.delegateController.removeViewFromDom(),this.revealContentToScreenReader=!1),this.lastPresentedPosition=void 0,this.destroySwipeGesture(),_(),I}onDidDismiss(){return Uy(this.el,"ionToastDidDismiss")}onWillDismiss(){return Uy(this.el,"ionToastWillDismiss")}getButtons(){return this.buttons?this.buttons.map(s=>typeof s=="string"?{text:s}:s):[]}getAnchorElement(){const{position:e,positionAnchor:s,el:l}=this;if(s!==void 0){if(e==="middle"&&s!==void 0){Ml('[ion-toast] - The positionAnchor property is ignored when using position="middle".',this.el);return}if(typeof s=="string"){const f=document.getElementById(s);if(f===null){Ml(`[ion-toast] - An anchor element with an ID of "${s}" was not found in the DOM.`,l);return}return f}if(s instanceof Da)return s;Ml("[ion-toast] - Invalid positionAnchor value:",s,l)}}async buttonClick(e){const s=e.role;return Pv(s)?this.dismiss(void 0,s):await this.callButtonHandler(e)?this.dismiss(void 0,s):Promise.resolve()}async callButtonHandler(e){if(e?.handler)try{if(await ck(e.handler)===!1)return!1}catch(s){Ku("[ion-toast] - Exception in callButtonHandler:",s)}return!0}renderButtons(e,s){if(e.length===0)return;const l=Ps(this),f={"toast-button-group":!0,[`toast-button-group-${s}`]:!0};return xi("div",{class:f},e.map(_=>xi("button",Object.assign({},_.htmlAttributes,{type:"button",class:HC(_),tabIndex:0,onClick:()=>this.buttonClick(_),part:ZC(_)}),xi("div",{class:"toast-button-inner"},_.icon&&xi("ion-icon",{"aria-hidden":"true",icon:_.icon,slot:_.text===void 0?"icon-only":void 0,class:"toast-button-icon"}),_.text),l==="md"&&xi("ion-ripple-effect",{type:_.icon!==void 0&&_.text===void 0?"unbounded":"bounded"}))))}renderToastMessage(e,s=null){const{customHTMLEnabled:l,message:f}=this;return l?xi("div",{key:e,"aria-hidden":s,class:"toast-message",part:"message",innerHTML:NE(f)}):xi("div",{key:e,"aria-hidden":s,class:"toast-message",part:"message"},f)}renderHeader(e,s=null){return xi("div",{key:e,class:"toast-header","aria-hidden":s,part:"header"},this.header)}render(){const{layout:e,el:s,revealContentToScreenReader:l,header:f,message:_}=this,y=this.getButtons(),d=y.filter(N=>N.side==="start"),A=y.filter(N=>N.side!=="start"),I=Ps(this),B={"toast-wrapper":!0,[`toast-${this.position}`]:!0,[`toast-layout-${e}`]:!0};return e==="stacked"&&d.length>0&&A.length>0&&Ml("[ion-toast] - This toast is using start and end buttons with the stacked toast layout. We recommend following the best practice of using either start or end buttons with the stacked toast layout.",s),xi(Go,Object.assign({key:"d1ecd90c87700aad4685e230cdd430aa286b8791",tabindex:"-1"},this.htmlAttributes,{style:{zIndex:`${6e4+this.overlayIndex}`},class:Xm(this.color,Object.assign(Object.assign({[I]:!0},o1(this.cssClass)),{"overlay-hidden":!0,"toast-translucent":this.translucent})),onIonToastWillDismiss:this.dispatchCancelHandler}),xi("div",{key:"4bfc863417324de69e222054d5cf9c452038b41e",class:B},xi("div",{key:"3417940afec0392e81b7d54c7cb00f3ab6c30d47",class:"toast-container",part:"container"},this.renderButtons(d,"start"),this.icon!==void 0&&xi("ion-icon",{key:"6bf878fbc85c01e1e5faa9d97d46255a6511a952",class:"toast-icon",part:"icon",icon:this.icon,lazy:!1,"aria-hidden":"true"}),xi("div",{key:"54b500348a9c37660c3aff37436d9188e4374947",class:"toast-content",role:"status","aria-atomic":"true","aria-live":"polite"},!l&&f!==void 0&&this.renderHeader("oldHeader","true"),!l&&_!==void 0&&this.renderToastMessage("oldMessage","true"),l&&f!==void 0&&this.renderHeader("header"),l&&_!==void 0&&this.renderToastMessage("header")),this.renderButtons(A,"end"))))}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:FC,md:VC}}},[289,"ion-toast",{overlayIndex:[2,"overlay-index"],delegate:[16],hasController:[4,"has-controller"],color:[513],enterAnimation:[16],leaveAnimation:[16],cssClass:[1,"css-class"],duration:[2],header:[1],layout:[1],message:[1],keyboardClose:[4,"keyboard-close"],position:[1],positionAnchor:[1,"position-anchor"],buttons:[16],translucent:[4],animated:[4],icon:[1],htmlAttributes:[16],swipeGesture:[1,"swipe-gesture"],isOpen:[4,"is-open"],trigger:[1],revealContentToScreenReader:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64]},void 0,{swipeGesture:["swipeGestureChanged"],isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}]),HC=t=>({"toast-button":!0,"toast-button-icon-only":t.icon!==void 0&&t.text===void 0,[`toast-button-${t.role}`]:t.role!==void 0,"ion-focusable":!0,"ion-activatable":!0}),ZC=t=>Pv(t.role)?"button cancel":"button";function GC(){if(typeof customElements>"u")return;["ion-toast","ion-icon","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-toast":customElements.get(e)||customElements.define(e,qC);break;case"ion-icon":customElements.get(e)||k1();break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const WC=GC;const YC=MC,XC="html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html.plt-mobile ion-app [contenteditable]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}",KC=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost()}componentDidLoad(){QC(async()=>{const e=Vh(window,"hybrid");if(Sn.getBoolean("_testing")||Ac(()=>import("./index7-ptwLAhlH.js"),[]).then(f=>f.startTapClick(Sn)),Sn.getBoolean("statusTap",e)&&Ac(()=>import("./status-tap-D9Q25Nhf.js"),[]).then(f=>f.startStatusTap()),Sn.getBoolean("inputShims",JC())){const f=Vh(window,"ios")?"ios":"android";Ac(()=>import("./input-shims-BXD3pn76.js"),[]).then(_=>_.startInputShims(Sn,f))}const s=await Ac(()=>Promise.resolve().then(()=>XE),void 0),l=e||Nm();Sn.getBoolean("hardwareBackButton",l)?s.startHardwareBackButton():(Nm()&&Ml("[ion-app] - experimentalCloseWatcher was set to `true`, but hardwareBackButton was set to `false`. Both config options must be `true` for the Close Watcher API to be used."),s.blockHardwareBackButton()),typeof window<"u"&&Ac(()=>Promise.resolve().then(()=>pC),void 0).then(f=>f.startKeyboardAssist(window)),Ac(()=>import("./focus-visible-DY9QzpaF.js"),[]).then(f=>this.focusVisible=f.startFocusVisible())})}async setFocus(e){this.focusVisible&&this.focusVisible.setFocus(e)}render(){const e=Ps(this);return xi(Go,{key:"9be440c65819e4fa67c2c3c6477ab40b3ad3eed3",class:{[e]:!0,"ion-page":!0,"force-statusbar-padding":Sn.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return XC}},[256,"ion-app",{setFocus:[64]}]),JC=()=>!!(Vh(window,"ios")&&Vh(window,"mobile")||Vh(window,"android")&&Vh(window,"mobileweb")),QC=t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,32)};function eA(){if(typeof customElements>"u")return;["ion-app"].forEach(e=>{e==="ion-app"&&(customElements.get(e)||customElements.define(e,KC))})}const tA=eA;const iA=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}ion-ripple-effect{color:var(--ripple-color)}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--background-hover:transparent;--background-hover-opacity:1;--background-focused:currentColor;--background-focused-opacity:.1;--border-radius:4px;--color:var(--ion-color-primary, #0054e9);--icon-margin-end:1px;--icon-margin-start:-4px;--icon-font-size:1.6em;--min-height:32px;font-size:clamp(17px, 1.0625rem, 21.998px)}.button-native{-webkit-transform:translateZ(0);transform:translateZ(0);overflow:visible;z-index:99}:host(.ion-activated) .button-native{opacity:0.4}@media (any-hover: hover){:host(:hover){opacity:0.6}}',nA=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}ion-ripple-effect{color:var(--ripple-color)}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--border-radius:4px;--background-focused:currentColor;--background-focused-opacity:.12;--background-hover:currentColor;--background-hover-opacity:0.04;--color:currentColor;--icon-margin-end:0;--icon-margin-start:0;--icon-font-size:1.5rem;--icon-font-weight:normal;--min-height:32px;--min-width:44px;--padding-start:12px;--padding-end:12px;font-size:0.875rem;font-weight:500;text-transform:uppercase}:host(.back-button-has-icon-only){--border-radius:50%;min-width:48px;min-height:48px;aspect-ratio:1/1}.button-native{-webkit-box-shadow:none;box-shadow:none}.button-text{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:0;padding-bottom:0}ion-icon{line-height:0.67;text-align:start}@media (any-hover: hover){:host(.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}',sA=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.inheritedAttributes={},this.disabled=!1,this.type="button",this.onClick=async s=>{const l=this.el.closest("ion-nav");return s.preventDefault(),l&&await l.canGoBack()?l.pop({animationBuilder:this.routerAnimation,skipIfBusy:!0}):ZE(this.defaultHref,s,"back",this.routerAnimation)}}componentWillLoad(){this.inheritedAttributes=Vw(this.el),this.defaultHref===void 0&&(this.defaultHref=Sn.get("backButtonDefaultHref"))}get backButtonIcon(){const e=this.icon;return e??(Ps(this)==="ios"?Sn.get("backButtonIcon",fk):Sn.get("backButtonIcon",dk))}get backButtonText(){const e=Ps(this)==="ios"?"Back":null;return this.text!=null?this.text:Sn.get("backButtonText",e)}get hasIconOnly(){return this.backButtonIcon&&!this.backButtonText}get rippleType(){return this.hasIconOnly?"unbounded":"bounded"}render(){const{color:e,defaultHref:s,disabled:l,type:f,hasIconOnly:_,backButtonIcon:y,backButtonText:d,icon:A,inheritedAttributes:I}=this,B=s!==void 0,N=Ps(this),V=I["aria-label"]||d||"back";return xi(Go,{key:"5466624a10f1ab56f5469e6dc07080303880f2fe",onClick:this.onClick,class:Xm(e,{[N]:!0,button:!0,"back-button-disabled":l,"back-button-has-icon-only":_,"in-toolbar":Cv("ion-toolbar",this.el),"in-toolbar-color":Cv("ion-toolbar[color]",this.el),"ion-activatable":!0,"ion-focusable":!0,"show-back-button":B})},xi("button",{key:"63bc75ef0ad7cc9fb79e58217a3314b20acd73e3",type:f,disabled:l,class:"button-native",part:"native","aria-label":V},xi("span",{key:"5d3eacbd11af2245c6e1151cab446a0d96559ad8",class:"button-inner"},y&&xi("ion-icon",{key:"6439af0ae463764174e7d3207f02267811df666d",part:"icon",icon:y,"aria-hidden":"true",lazy:!1,"flip-rtl":A===void 0}),d&&xi("span",{key:"8ee89fb18dfdb5b75948a8b197ff4cdbc008742f",part:"text","aria-hidden":"true",class:"button-text"},d)),N==="md"&&xi("ion-ripple-effect",{key:"63803a884998bc73bea5afe0b2a0a14e3fa4d6bf",type:this.rippleType})))}get el(){return this}static get style(){return{ios:iA,md:nA}}},[289,"ion-back-button",{color:[513],defaultHref:[1025,"default-href"],disabled:[516],icon:[1],text:[1],type:[1],routerAnimation:[16]}]);function rA(){if(typeof customElements>"u")return;["ion-back-button","ion-icon","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-back-button":customElements.get(e)||customElements.define(e,sA);break;case"ion-icon":customElements.get(e)||k1();break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const aA=rA,oA=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",lA=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Yn(this,"ionNavWillLoad",7),this.ionNavWillChange=Yn(this,"ionNavWillChange",3),this.ionNavDidChange=Yn(this,"ionNavDidChange",3),this.lockController=mx(),this.gestureOrAnimationInProgress=!1,this.mode=Ps(this),this.animated=!0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(this.swipeHandler!==void 0)}async connectedCallback(){const e=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await Ac(async()=>{const{createSwipeBackGesture:s}=await import("./swipe-back-Ds_qBFTx.js");return{createSwipeBackGesture:s}},[])).createSwipeBackGesture(this.el,()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart(),()=>e(),s=>{var l;return(l=this.ani)===null||l===void 0?void 0:l.progressStep(s)},(s,l,f)=>{if(this.ani){this.ani.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(s)},{oneTimeCallback:!0});let _=s?-.001:.001;s?_+=up([0,0],[.32,.72],[0,1],[1,1],l)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),_+=up([0,0],[1,0],[.68,.28],[1,1],l)[0]),this.ani.progressEnd(s?1:0,_,f)}else this.gestureOrAnimationInProgress=!1}),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(e,s,l){const f=await this.lockController.lock();let _=!1;try{_=await this.transition(e,s,l)}catch(y){Ku("[ion-router-outlet] - Exception in commit:",y)}return f(),_}async setRouteId(e,s,l,f){return{changed:await this.setRoot(e,s,{duration:l==="root"?0:void 0,direction:l==="back"?"back":"forward",animationBuilder:f}),element:this.activeEl}}async getRouteId(){const e=this.activeEl;return e?{id:e.tagName,element:e,params:this.activeParams}:void 0}async setRoot(e,s,l){if(this.activeComponent===e&&Hw(s,this.activeParams))return!1;const f=this.activeEl,_=await s_(this.delegate,this.el,e,["ion-page","ion-page-invisible"],s);return this.activeComponent=e,this.activeEl=_,this.activeParams=s,await this.commit(_,f,l),await c1(this.delegate,f),!0}async transition(e,s,l={}){if(s===e)return!1;this.ionNavWillChange.emit();const{el:f,mode:_}=this,y=this.animated&&Sn.getBoolean("animated",!0),d=l.animationBuilder||this.animation||Sn.get("navAnimation");return await Yw(Object.assign(Object.assign({mode:_,animated:y,enteringEl:e,leavingEl:s,baseEl:f,deepWait:Dy(f),progressCallback:l.progressAnimation?A=>{A!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,A.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)},{oneTimeCallback:!0}),A.progressEnd(0,0,0)):this.ani=A}:void 0},l),{animationBuilder:d})),this.ionNavDidChange.emit(),!0}render(){return xi("slot",{key:"84b50f1155b0d780dff802ee13223287259fd525"})}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return oA}},[257,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]},void 0,{swipeHandler:["swipeHandlerChanged"]}]);function cA(){if(typeof customElements>"u")return;["ion-router-outlet"].forEach(e=>{e==="ion-router-outlet"&&(customElements.get(e)||customElements.define(e,lA))})}const uA=cA;const hA=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, var(--ion-background-color-step-50, #f7f7f7)));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, var(--ion-background-color-step-150, rgba(0, 0, 0, 0.2)))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, var(--ion-text-color-step-400, #666666)));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #0054e9));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",dA=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, var(--ion-background-color-step-150, rgba(0, 0, 0, 0.07)))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, var(--ion-text-color-step-350, #595959)));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #0054e9));height:56px}",fA=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=Yn(this,"ionTabBarChanged",7),this.ionTabBarLoaded=Yn(this,"ionTabBarLoaded",7),this.keyboardCtrl=null,this.didLoad=!1,this.keyboardVisible=!1,this.translucent=!1}selectedTabChanged(){this.didLoad&&this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentDidLoad(){this.ionTabBarLoaded.emit(),this.didLoad=!0,this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}async connectedCallback(){this.keyboardCtrl=await Xk(async(e,s)=>{e===!1&&s!==void 0&&await s,this.keyboardVisible=e})}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}render(){const{color:e,translucent:s,keyboardVisible:l}=this,f=Ps(this),_=l&&this.el.getAttribute("slot")!=="top";return xi(Go,{key:"388ec37ce308035bab78d6c9a016bb616e9517a9",role:"tablist","aria-hidden":_?"true":null,class:Xm(e,{[f]:!0,"tab-bar-translucent":s,"tab-bar-hidden":_})},xi("slot",{key:"ce10ade2b86725e24f3254516483eeedd8ecb16a"}))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:hA,md:dA}}},[289,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]},void 0,{selectedTab:["selectedTabChanged"]}]);function pA(){if(typeof customElements>"u")return;["ion-tab-bar"].forEach(e=>{e==="ion-tab-bar"&&(customElements.get(e)||customElements.define(e,fA))})}const mA=pA;const gA=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:24px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){font-size:30px}',yA=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}',_A=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=Yn(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.disabled=!1,this.selected=!1,this.onKeyUp=s=>{(s.key==="Enter"||s.key===" ")&&this.selectTab(s)},this.onClick=s=>{this.selectTab(s)}}onTabBarChanged(e){const s=e.target,l=this.el.parentElement;(e.composedPath().includes(l)||s?.contains(this.el))&&(this.selected=this.tab===e.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},ux(this.el,["aria-label"])),this.layout===void 0&&(this.layout=Sn.get("tabButtonLayout","icon-top"))}selectTab(e){this.tab!==void 0&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),e.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:e,hasIcon:s,hasLabel:l,href:f,rel:_,target:y,layout:d,selected:A,tab:I,inheritedAttributes:B}=this,N=Ps(this),V={download:this.download,href:f,rel:_,target:y};return xi(Go,{key:"ce9d29ced0c781d6b2fa62cd5feb801c11fc42e8",onClick:this.onClick,onKeyup:this.onKeyUp,id:I!==void 0?`tab-button-${I}`:null,class:{[N]:!0,"tab-selected":A,"tab-disabled":e,"tab-has-label":l,"tab-has-icon":s,"tab-has-label-only":l&&!s,"tab-has-icon-only":s&&!l,[`tab-layout-${d}`]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},xi("a",Object.assign({key:"01cb0ed2e77c5c1a8abd48da1bb07ac1b305d0b6"},V,{class:"button-native",part:"native",role:"tab","aria-selected":A?"true":null,"aria-disabled":e?"true":null,tabindex:e?"-1":void 0},B),xi("span",{key:"d0240c05f42217cfb186b86ff8a0c9cd70b9c8df",class:"button-inner"},xi("slot",{key:"0a20b84925037dbaa8bb4a495b813d3f7c2e58ac"})),N==="md"&&xi("ion-ripple-effect",{key:"4c92c27178cdac89d69cffef8d2c39c3644914e8",type:"unbounded"})))}get el(){return this}static get style(){return{ios:gA,md:yA}}},[289,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]);function vA(){if(typeof customElements>"u")return;["ion-tab-button","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-tab-button":customElements.get(e)||customElements.define(e,_A);break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const xA=vA;const bA=":host{left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%;contain:layout size style;z-index:0}.tabs-inner{position:relative;-ms-flex:1;flex:1;contain:layout size style}",wA=ko(class extends Da{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Yn(this,"ionNavWillLoad",7),this.ionTabsWillChange=Yn(this,"ionTabsWillChange",3),this.ionTabsDidChange=Yn(this,"ionTabsDidChange",3),this.transitioning=!1,this.useRouter=!1,this.onTabClicked=s=>{const{href:l,tab:f}=s.detail;if(this.useRouter&&l!==void 0){const _=document.querySelector("ion-router");_&&_.push(l)}else this.select(f)}}async componentWillLoad(){if(this.useRouter||(this.useRouter=(!!this.el.querySelector("ion-router-outlet")||!!document.querySelector("ion-router"))&&!this.el.closest("[no-router]")),!this.useRouter){const e=this.tabs;e.length>0&&await this.select(e[0])}this.ionNavWillLoad.emit()}componentDidLoad(){this.updateTabBar()}componentDidUpdate(){this.updateTabBar()}updateTabBar(){const e=this.el.querySelector("ion-tab-bar");if(!e)return;const s=this.selectedTab?this.selectedTab.tab:void 0;s!==void 0&&e.selectedTab!==s&&(e.selectedTab=s)}async select(e){const s=V_(this.tabs,e);return this.shouldSwitch(s)?(await this.setActive(s),await this.notifyRouter(),this.tabSwitch(),!0):!1}async getTab(e){return V_(this.tabs,e)}getSelected(){return Promise.resolve(this.selectedTab?this.selectedTab.tab:void 0)}async setRouteId(e){const s=V_(this.tabs,e);return this.shouldSwitch(s)?(await this.setActive(s),{changed:!0,element:this.selectedTab,markVisible:()=>this.tabSwitch()}):{changed:!1,element:this.selectedTab}}async getRouteId(){var e;const s=(e=this.selectedTab)===null||e===void 0?void 0:e.tab;return s!==void 0?{id:s,element:this.selectedTab}:void 0}setActive(e){return this.transitioning?Promise.reject("transitioning already happening"):(this.transitioning=!0,this.leavingTab=this.selectedTab,this.selectedTab=e,this.ionTabsWillChange.emit({tab:e.tab}),e.active=!0,this.updateTabBar(),Promise.resolve())}tabSwitch(){const e=this.selectedTab,s=this.leavingTab;this.leavingTab=void 0,this.transitioning=!1,e&&s!==e&&(s&&(s.active=!1),this.ionTabsDidChange.emit({tab:e.tab}))}notifyRouter(){if(this.useRouter){const e=document.querySelector("ion-router");if(e)return e.navChanged("forward")}return Promise.resolve(!1)}shouldSwitch(e){const s=this.selectedTab;return e!==void 0&&e!==s&&!this.transitioning}get tabs(){return Array.from(this.el.querySelectorAll("ion-tab"))}render(){return xi(Go,{key:"7b4b302f2942d8d131f6fc24e817989a8be08867",onIonTabButtonClick:this.onTabClicked},xi("slot",{key:"2c51cf14c0f17a8ddf2d879858c984cdf8fd3147",name:"top"}),xi("div",{key:"7e9d6055092d41bd9bc80ae15965f77e216feb84",class:"tabs-inner"},xi("slot",{key:"c308a787e37ff7f6653531d70deca597a7602d26"})),xi("slot",{key:"d5f5e693710c853570811602f859cf3e88272684",name:"bottom"}))}get el(){return this}static get style(){return bA}},[257,"ion-tabs",{useRouter:[1028,"use-router"],selectedTab:[32],select:[64],getTab:[64],getSelected:[64],setRouteId:[64],getRouteId:[64]}]),V_=(t,e)=>{const s=typeof e=="string"?t.find(l=>l.tab===e):e;return s||Ku(`[ion-tabs] - Tab with id: "${s}" does not exist`),s};function SA(){if(typeof customElements>"u")return;["ion-tabs"].forEach(e=>{e==="ion-tabs"&&(customElements.get(e)||customElements.define(e,wA))})}const TA=SA,EA="ionicons",r_={hydratedSelectorName:"hydrated",lazyLoad:!1,updatable:!0};var kA=Object.defineProperty,CA=(t,e)=>{for(var s in e)kA(t,s,{get:e[s],enumerable:!0})},ef=t=>{if(t.__stencil__getHostRef)return t.__stencil__getHostRef()},AA=(t,e)=>{const s={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};s.$onReadyPromise$=new Promise(f=>s.$onReadyResolve$=f),t["s-p"]=[],t["s-rc"]=[];const l=s;return t.__stencil__getHostRef=()=>l,l},qb=(t,e)=>e in t,a_=(t,e)=>(0,console.error)(t,e),Wy=new Map,MA="slot-fb{display:contents}slot-fb[hidden]{display:none}",Hb="http://www.w3.org/1999/xlink",Mc=typeof window<"u"?window:{},PA=Mc.HTMLElement||class{},Gh={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,s,l)=>t.addEventListener(e,s,l),rel:(t,e,s,l)=>t.removeEventListener(e,s,l),ce:(t,e)=>new CustomEvent(t,e)},IA=t=>Promise.resolve(t),V1=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),Bv=!1,Zb=[],q1=[],jA=(t,e)=>s=>{t.push(s),Bv||(Bv=!0,Gh.raf(H1))},Gb=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(s){a_(s)}t.length=0},H1=()=>{Gb(Zb),Gb(q1),(Bv=Zb.length>0)&&Gh.raf(H1)},wx=t=>IA().then(t),LA=jA(q1),RA=t=>{const e=new URL(t,Gh.$resourcesUrl$);return e.origin!==Mc.location.origin?e.href:e.pathname},Sx=t=>(t=typeof t,t==="object"||t==="function");function zA(t){var e,s,l;return(l=(s=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:s.getAttribute("content"))!=null?l:void 0}var DA=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),OA={};CA(OA,{err:()=>Z1,map:()=>NA,ok:()=>$v,unwrap:()=>BA,unwrapErr:()=>$A});var $v=t=>({isOk:!0,isErr:!1,value:t}),Z1=t=>({isOk:!1,isErr:!0,value:t});function NA(t,e){if(t.isOk){const s=e(t.value);return s instanceof Promise?s.then(l=>$v(l)):$v(s)}if(t.isErr){const s=t.value;return Z1(s)}throw"should never get here"}var BA=t=>{if(t.isOk)return t.value;throw t.value},$A=t=>{if(t.isErr)return t.value;throw t.value};var hy;function UA(t){var e;const s=this.attachShadow({mode:"open"});hy===void 0&&(hy=(e=void 0)!=null?e:null),hy&&s.adoptedStyleSheets.push(hy)}var tf=(t,e="")=>()=>{},tp=new WeakMap,FA=(t,e,s)=>{let l=Wy.get(t);V1&&s?(l=l||new CSSStyleSheet,typeof l=="string"?l=e:l.replaceSync(e)):l=e,Wy.set(t,l)},VA=(t,e,s)=>{var l;const f=G1(e),_=Wy.get(f);if(!Mc.document)return f;if(t=t.nodeType===11?t:Mc.document,_)if(typeof _=="string"){t=t.head||t;let y=tp.get(t),d;if(y||tp.set(t,y=new Set),!y.has(f)){{d=Mc.document.createElement("style"),d.innerHTML=_;const A=(l=Gh.$nonce$)!=null?l:zA(Mc.document);if(A!=null&&d.setAttribute("nonce",A),!(e.$flags$&1))if(t.nodeName==="HEAD"){const I=t.querySelectorAll("link[rel=preconnect]"),B=I.length>0?I[I.length-1].nextSibling:t.querySelector("style");t.insertBefore(d,B?.parentNode===t?B:null)}else if("host"in t)if(V1){const I=new CSSStyleSheet;I.replaceSync(_),t.adoptedStyleSheets.unshift(I)}else{const I=t.querySelector("style");I?I.innerHTML=_+I.innerHTML:t.prepend(d)}else t.append(d);e.$flags$&1&&t.insertBefore(d,null)}e.$flags$&4&&(d.innerHTML+=MA),y&&y.add(f)}}else t.adoptedStyleSheets.includes(_)||t.adoptedStyleSheets.push(_);return f},qA=t=>{const e=t.$cmpMeta$,s=t.$hostElement$,l=e.$flags$,f=tf("attachStyles",e.$tagName$),_=VA(s.shadowRoot?s.shadowRoot:s.getRootNode(),e);l&10&&(s["s-sc"]=_,s.classList.add(_+"-h")),f()},G1=(t,e)=>"sc-"+t.$tagName$,Ey=(t,e,...s)=>{let l=null,f=null,_=!1,y=!1;const d=[],A=B=>{for(let N=0;N<B.length;N++)l=B[N],Array.isArray(l)?A(l):l!=null&&typeof l!="boolean"&&((_=typeof t!="function"&&!Sx(l))&&(l=String(l)),_&&y?d[d.length-1].$text$+=l:d.push(_?Uv(null,l):l),y=_)};if(A(s),e){e.key&&(f=e.key);{const B=e.className||e.class;B&&(e.class=typeof B!="object"?B:Object.keys(B).filter(N=>B[N]).join(" "))}}const I=Uv(t,null);return I.$attrs$=e,d.length>0&&(I.$children$=d),I.$key$=f,I},Uv=(t,e)=>{const s={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return s.$attrs$=null,s.$key$=null,s},W1={},HA=t=>t&&t.$tag$===W1,Tx=t=>{const e=DA(t);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${e}))(${e}\\b)`,"g")};Tx("::slotted");Tx(":host");Tx(":host-context");var Y1=(t,e,s)=>t!=null&&!Sx(t)?e&4?t==="false"?!1:t===""||!!t:e&1?String(t):t:t,ZA=(t,e,s)=>{const l=Gh.ce(e,s);return t.dispatchEvent(l),l},Wb=(t,e,s,l,f,_,y)=>{if(s===l)return;let d=qb(t,e),A=e.toLowerCase();if(e==="class"){const I=t.classList,B=Yb(s);let N=Yb(l);I.remove(...B.filter(V=>V&&!N.includes(V))),I.add(...N.filter(V=>V&&!B.includes(V)))}else if(e==="style"){for(const I in s)(!l||l[I]==null)&&(I.includes("-")?t.style.removeProperty(I):t.style[I]="");for(const I in l)(!s||l[I]!==s[I])&&(I.includes("-")?t.style.setProperty(I,l[I]):t.style[I]=l[I])}else if(e!=="key")if(e==="ref")l&&l(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):qb(Mc,A)?e=A.slice(2):e=A[2]+e.slice(3),s||l){const I=e.endsWith(X1);e=e.replace(WA,""),s&&Gh.rel(t,e,s,I),l&&Gh.ael(t,e,l,I)}}else{const I=Sx(l);if(d||I&&l!==null)try{if(t.tagName.includes("-"))t[e]!==l&&(t[e]=l);else{const N=l??"";e==="list"?d=!1:(s==null||t[e]!=N)&&(typeof t.__lookupSetter__(e)=="function"?t[e]=N:t.setAttribute(e,N))}}catch{}let B=!1;A!==(A=A.replace(/^xlink\:?/,""))&&(e=A,B=!0),l==null||l===!1?(l!==!1||t.getAttribute(e)==="")&&(B?t.removeAttributeNS(Hb,e):t.removeAttribute(e)):(!d||_&4||f)&&!I&&t.nodeType===1&&(l=l===!0?"":l,B?t.setAttributeNS(Hb,e,l):t.setAttribute(e,l))}},GA=/\s/,Yb=t=>(typeof t=="object"&&t&&"baseVal"in t&&(t=t.baseVal),!t||typeof t!="string"?[]:t.split(GA)),X1="Capture",WA=new RegExp(X1+"$"),K1=(t,e,s,l)=>{const f=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,_=t&&t.$attrs$||{},y=e.$attrs$||{};for(const d of Xb(Object.keys(_)))d in y||Wb(f,d,_[d],void 0,s,e.$flags$);for(const d of Xb(Object.keys(y)))Wb(f,d,_[d],y[d],s,e.$flags$)};function Xb(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var Ex,J1=!1,Yy=(t,e,s)=>{const l=e.$children$[s];let f=0,_,y;if(l.$text$!==null)_=l.$elm$=Mc.document.createTextNode(l.$text$);else{if(!Mc.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(_=l.$elm$=Mc.document.createElement(l.$tag$),K1(null,l,J1),l.$children$)for(f=0;f<l.$children$.length;++f)y=Yy(t,l,f),y&&_.appendChild(y)}return _["s-hn"]=Ex,_},Q1=(t,e,s,l,f,_)=>{let y=t,d;for(y.shadowRoot&&y.tagName===Ex&&(y=y.shadowRoot);f<=_;++f)l[f]&&(d=Yy(null,s,f),d&&(l[f].$elm$=d,ky(y,d,e)))},eS=(t,e,s)=>{for(let l=e;l<=s;++l){const f=t[l];if(f){const _=f.$elm$;tS(f),_&&_.remove()}}},YA=(t,e,s,l,f=!1)=>{let _=0,y=0,d=0,A=0,I=e.length-1,B=e[0],N=e[I],V=l.length-1,K=l[0],se=l[V],ne,ve;for(;_<=I&&y<=V;)if(B==null)B=e[++_];else if(N==null)N=e[--I];else if(K==null)K=l[++y];else if(se==null)se=l[--V];else if(dy(B,K,f))Xf(B,K,f),B=e[++_],K=l[++y];else if(dy(N,se,f))Xf(N,se,f),N=e[--I],se=l[--V];else if(dy(B,se,f))Xf(B,se,f),ky(t,B.$elm$,N.$elm$.nextSibling),B=e[++_],se=l[--V];else if(dy(N,K,f))Xf(N,K,f),ky(t,N.$elm$,B.$elm$),N=e[--I],K=l[++y];else{for(d=-1,A=_;A<=I;++A)if(e[A]&&e[A].$key$!==null&&e[A].$key$===K.$key$){d=A;break}d>=0?(ve=e[d],ve.$tag$!==K.$tag$?ne=Yy(e&&e[y],s,d):(Xf(ve,K,f),e[d]=void 0,ne=ve.$elm$),K=l[++y]):(ne=Yy(e&&e[y],s,y),K=l[++y]),ne&&ky(B.$elm$.parentNode,ne,B.$elm$)}_>I?Q1(t,l[V+1]==null?null:l[V+1].$elm$,s,l,y,V):y>V&&eS(e,_,I)},dy=(t,e,s=!1)=>t.$tag$===e.$tag$?s?(s&&!t.$key$&&e.$key$&&(t.$key$=e.$key$),!0):t.$key$===e.$key$:!1,Xf=(t,e,s=!1)=>{const l=e.$elm$=t.$elm$,f=t.$children$,_=e.$children$,y=e.$text$;y===null?(K1(t,e,J1),f!==null&&_!==null?YA(l,f,e,_,s):_!==null?(t.$text$!==null&&(l.textContent=""),Q1(l,null,e,_,0,_.length-1)):!s&&r_.updatable&&f!==null&&eS(f,0,f.length-1)):t.$text$!==y&&(l.data=y)},tS=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(tS)},ky=(t,e,s)=>t?.insertBefore(e,s),XA=(t,e,s=!1)=>{const l=t.$hostElement$,f=t.$cmpMeta$,_=t.$vnode$||Uv(null,null),d=HA(e)?e:Ey(null,null,e);if(Ex=l.tagName,f.$attrsToReflect$&&(d.$attrs$=d.$attrs$||{},f.$attrsToReflect$.map(([A,I])=>d.$attrs$[I]=l[A])),s&&d.$attrs$)for(const A of Object.keys(d.$attrs$))l.hasAttribute(A)&&!["key","ref","style","class"].includes(A)&&(d.$attrs$[A]=l[A]);d.$tag$=null,d.$flags$|=4,t.$vnode$=d,d.$elm$=_.$elm$=l.shadowRoot||l,Xf(_,d,s)},iS=(t,e)=>{if(e&&!t.$onRenderResolve$&&e["s-p"]){const s=e["s-p"].push(new Promise(l=>t.$onRenderResolve$=()=>{e["s-p"].splice(s-1,1),l()}))}},kx=(t,e)=>{if(t.$flags$|=16,t.$flags$&4){t.$flags$|=512;return}return iS(t,t.$ancestorComponent$),LA(()=>KA(t,e))},KA=(t,e)=>{const s=t.$hostElement$,l=tf("scheduleUpdate",t.$cmpMeta$.$tagName$),f=s;if(!f)throw new Error(`Can't render component <${s.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let _;return e?_=op(f,"componentWillLoad",void 0,s):_=op(f,"componentWillUpdate",void 0,s),_=Kb(_,()=>op(f,"componentWillRender",void 0,s)),l(),Kb(_,()=>QA(t,f,e))},Kb=(t,e)=>JA(t)?t.then(e).catch(s=>{console.error(s),e()}):e(),JA=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",QA=async(t,e,s)=>{var l;const f=t.$hostElement$,_=tf("update",t.$cmpMeta$.$tagName$),y=f["s-rc"];s&&qA(t);const d=tf("render",t.$cmpMeta$.$tagName$);eM(t,e,f,s),y&&(y.map(A=>A()),f["s-rc"]=void 0),d(),_();{const A=(l=f["s-p"])!=null?l:[],I=()=>tM(t);A.length===0?I():(Promise.all(A).then(I),t.$flags$|=4,A.length=0)}},eM=(t,e,s,l)=>{try{e=e.render(),t.$flags$&=-17,t.$flags$|=2,XA(t,e,l)}catch(f){a_(f,t.$hostElement$)}return null},tM=t=>{const e=t.$cmpMeta$.$tagName$,s=t.$hostElement$,l=tf("postUpdate",e),f=s,_=t.$ancestorComponent$;op(f,"componentDidRender",void 0,s),t.$flags$&64?(op(f,"componentDidUpdate",void 0,s),l()):(t.$flags$|=64,nM(s),op(f,"componentDidLoad",void 0,s),l(),t.$onReadyResolve$(s),_||iM()),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),t.$flags$&512&&wx(()=>kx(t,!1)),t.$flags$&=-517},iM=t=>{wx(()=>ZA(Mc,"appload",{detail:{namespace:EA}}))},op=(t,e,s,l)=>{if(t&&t[e])try{return t[e](s)}catch(f){a_(f,l)}},nM=t=>{var e;return t.classList.add((e=r_.hydratedSelectorName)!=null?e:"hydrated")},sM=(t,e)=>ef(t).$instanceValues$.get(e),Jb=(t,e,s,l)=>{const f=ef(t),_=t,y=f.$instanceValues$.get(e),d=f.$flags$,A=_;s=Y1(s,l.$members$[e][0]);const I=Number.isNaN(y)&&Number.isNaN(s);if(s!==y&&!I){f.$instanceValues$.set(e,s);{if(l.$watchers$&&d&128){const N=l.$watchers$[e];N&&N.map(V=>{try{A[V](s,y,e)}catch(K){a_(K,_)}})}if((d&18)===2){if(A.componentShouldUpdate&&A.componentShouldUpdate(s,y,e)===!1)return;kx(f,!1)}}}},rM=(t,e,s)=>{var l,f;const _=t.prototype;if(e.$members$||e.$watchers$||t.watchers){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers);const y=Object.entries((l=e.$members$)!=null?l:{});y.map(([d,[A]])=>{if(A&31||A&32){const{get:I,set:B}=Object.getOwnPropertyDescriptor(_,d)||{};I&&(e.$members$[d][0]|=2048),B&&(e.$members$[d][0]|=4096),Object.defineProperty(_,d,{get(){return I?I.apply(this):sM(this,d)},configurable:!0,enumerable:!0}),Object.defineProperty(_,d,{set(N){const V=ef(this);if(B){const K=A&32?this[d]:V.$hostElement$[d];typeof K>"u"&&V.$instanceValues$.get(d)?N=V.$instanceValues$.get(d):!V.$instanceValues$.get(d)&&K&&V.$instanceValues$.set(d,K),B.apply(this,[Y1(N,A)]),N=A&32?this[d]:V.$hostElement$[d],Jb(this,d,N,e);return}{Jb(this,d,N,e);return}}})}});{const d=new Map;_.attributeChangedCallback=function(A,I,B){Gh.jmp(()=>{var N;const V=d.get(A);if(!(this.hasOwnProperty(V)&&r_.lazyLoad)){if(_.hasOwnProperty(V)&&typeof this[V]=="number"&&this[V]==B)return;if(V==null){const se=ef(this),ne=se?.$flags$;if(ne&&!(ne&8)&&ne&128&&B!==I){const re=this,ge=(N=e.$watchers$)==null?void 0:N[A];ge?.forEach(oe=>{re[oe]!=null&&re[oe].call(re,B,I,A)})}return}}const K=Object.getOwnPropertyDescriptor(_,V);B=B===null&&typeof this[V]=="boolean"?!1:B,B!==this[V]&&(!K.get||K.set)&&(this[V]=B)})},t.observedAttributes=Array.from(new Set([...Object.keys((f=e.$watchers$)!=null?f:{}),...y.filter(([A,I])=>I[0]&15).map(([A,I])=>{var B;const N=I[1]||A;return d.set(N,A),I[0]&512&&((B=e.$attrsToReflect$)==null||B.push([A,N])),N})]))}}return t},Qb=async(t,e,s,l)=>{let f;if((e.$flags$&32)===0){e.$flags$|=32;{f=t.constructor;const d=t.localName;customElements.whenDefined(d).then(()=>e.$flags$|=128)}if(f&&f.style){let d;typeof f.style=="string"&&(d=f.style);const A=G1(s);if(!Wy.has(A)){const I=tf("registerStyles",s.$tagName$);FA(A,d,!!(s.$flags$&1)),I()}}}const _=e.$ancestorComponent$,y=()=>kx(e,!0);_&&_["s-rc"]?_["s-rc"].push(y):y()},aM=(t,e)=>{},oM=t=>{{const e=ef(t),s=e.$cmpMeta$,l=tf("connectedCallback",s.$tagName$);if(e.$flags$&1)e?.$lazyInstance$||e?.$onReadyPromise$&&e.$onReadyPromise$.then(()=>aM());else{e.$flags$|=1;{let f=t;for(;f=f.parentNode||f.host;)if(f["s-p"]){iS(e,e.$ancestorComponent$=f);break}}s.$members$&&Object.entries(s.$members$).map(([f,[_]])=>{if(_&31&&t.hasOwnProperty(f)){const y=t[f];delete t[f],t[f]=y}}),r_.initializeNextTick?wx(()=>Qb(t,e,s)):Qb(t,e,s)}l()}},lM=async t=>{ef(t),tp.has(t)&&tp.delete(t),t.shadowRoot&&tp.has(t.shadowRoot)&&tp.delete(t.shadowRoot)},cM=(t,e)=>{const s={$flags$:e[0],$tagName$:e[1]};s.$members$=e[2],s.$watchers$=t.$watchers$,s.$attrsToReflect$=[];const l=t.prototype.connectedCallback,f=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__hasHostListenerAttached:!1,__registerHost(){AA(this,s)},connectedCallback(){this.__hasHostListenerAttached||(ef(this),this.__hasHostListenerAttached=!0),oM(this),l&&l.call(this)},disconnectedCallback(){lM(this),f&&f.call(this)},__attachShadow(){if(!this.shadowRoot)UA.call(this,s);else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${s.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=s.$tagName$,rM(t,s)};let q_;const uM=()=>{if(typeof window>"u")return new Map;if(!q_){const t=window;t.Ionicons=t.Ionicons||{},q_=t.Ionicons.map=t.Ionicons.map||new Map}return q_},hM=t=>{let e=H_(t.src);return e||(e=nS(t.name,t.icon,t.mode,t.ios,t.md),e?dM(e,t):t.icon&&(e=H_(t.icon),e||(e=H_(t.icon[t.mode]),e))?e:null)},dM=(t,e)=>{const s=uM().get(t);if(s)return s;try{return RA(`svg/${t}.svg`)}catch(l){console.log("e",l),console.warn(`[Ionicons Warning]: Could not load icon with name "${t}". Ensure that the icon is registered using addIcons or that the icon SVG data is passed directly to the icon component.`,e)}},nS=(t,e,s,l,f)=>(s=(s&&fy(s))==="ios"?"ios":"md",l&&s==="ios"?t=fy(l):f&&s==="md"?t=fy(f):(!t&&e&&!sS(e)&&(t=e),Xy(t)&&(t=fy(t))),!Xy(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),H_=t=>Xy(t)&&(t=t.trim(),sS(t))?t:null,sS=t=>t.length>0&&/(\/|\.)/.test(t),Xy=t=>typeof t=="string",fy=t=>t.toLowerCase(),fM=(t,e=[])=>{const s={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(s[l]=t.getAttribute(l)),t.removeAttribute(l))}),s},pM=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl",mM=t=>{const e=document.createElement("div");e.innerHTML=t;for(let l=e.childNodes.length-1;l>=0;l--)e.childNodes[l].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[l]);const s=e.firstElementChild;if(s&&s.nodeName.toLowerCase()==="svg"){const l=s.getAttribute("class")||"";if(s.setAttribute("class",(l+" s-ion-icon").trim()),rS(s))return e.innerHTML}return""},rS=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const s=t.attributes[e].name;if(Xy(s)&&s.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!rS(t.childNodes[e]))return!1}return!0},gM=t=>t.startsWith("data:image/svg+xml"),yM=t=>t.indexOf(";utf8,")!==-1,lp=new Map,aS=new Map;let Z_;function Fv(t){return lp.set(t,""),""}const _M=(t,e)=>{const s=aS.get(t);return s||(typeof fetch<"u"&&typeof document<"u"?gM(t)&&yM(t)?Promise.resolve(vM(t)):xM(t,e):Promise.resolve(Fv(t)))};function vM(t){Z_||(Z_=new DOMParser);const s=Z_.parseFromString(t,"text/html").querySelector("svg");if(s)return lp.set(t,s.outerHTML),s.outerHTML;throw new Error(`Could not parse svg from ${t}`)}function xM(t,e){const s=fetch(t).then(l=>l.text().then(f=>{f&&e!==!1&&(f=mM(f));const _=f||"";return lp.set(t,_),_}).catch(()=>Fv(t))).catch(()=>Fv(t));return aS.set(t,s),s}const bM=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{transform:scaleX(1)}}:host(.icon-small){font-size:1.125rem !important}:host(.icon-large){font-size:2rem !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",wM=cM(class extends PA{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.didLoadIcon=!1,this.isVisible=!1,this.mode=SM(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=fM(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}componentDidLoad(){this.didLoadIcon||this.loadIcon()}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,s,l){if(!!!(this.lazy&&typeof window<"u"&&window.IntersectionObserver))return l();const _=this.io=new window.IntersectionObserver(y=>{y[0].isIntersecting&&(_.disconnect(),this.io=void 0,l())},{rootMargin:s});_.observe(e)}loadIcon(){if(this.isVisible){const e=hM(this);e&&(lp.has(e)?this.svgContent=lp.get(e):_M(e,this.sanitize).then(()=>this.svgContent=lp.get(e)),this.didLoadIcon=!0)}this.iconName=nS(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:s,inheritedAttributes:l,el:f}=this,_=this.mode||"md",y=s?(s.includes("arrow")||s.includes("chevron"))&&e!==!1:!1,d=e||y;return Ey(W1,Object.assign({key:"0578c899781ca145dd8205acd9670af39b57cf2e",role:"img",class:Object.assign(Object.assign({[_]:!0},TM(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":d,"icon-rtl":d&&pM(f)})},l),this.svgContent?Ey("div",{class:"icon-inner",innerHTML:this.svgContent}):Ey("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return bM}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},void 0,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]),SM=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",TM=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function EM(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{e==="ion-icon"&&(customElements.get(e)||customElements.define(e,wM))})}const kM=EM,o_=Nt.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{},cleanupIonViewWillEnter:()=>{},cleanupIonViewDidEnter:()=>{},cleanupIonViewWillLeave:()=>{},cleanupIonViewDidLeave:()=>{}}),CM=class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[],this.ionViewWillEnterDestructorCallbacks=[],this.ionViewDidEnterDestructorCallbacks=[],this.ionViewWillLeaveDestructorCallbacks=[],this.ionViewDidLeaveDestructorCallbacks=[]}onIonViewWillEnter(t){if(t.id){const e=this.ionViewWillEnterCallbacks.findIndex(s=>s.id===t.id);e>-1?this.ionViewWillEnterCallbacks[e]=t:this.ionViewWillEnterCallbacks.push(t)}else this.ionViewWillEnterCallbacks.push(t)}teardownCallback(t,e){const s=e.filter(l=>l.id===t.id);s.length!==0&&(s.forEach(l=>{l&&typeof l.destructor=="function"&&l.destructor()}),e=e.filter(l=>l.id!==t.id))}cleanupIonViewWillEnter(t){this.teardownCallback(t,this.ionViewWillEnterDestructorCallbacks)}cleanupIonViewDidEnter(t){this.teardownCallback(t,this.ionViewDidEnterDestructorCallbacks)}cleanupIonViewWillLeave(t){this.teardownCallback(t,this.ionViewWillLeaveDestructorCallbacks)}cleanupIonViewDidLeave(t){this.teardownCallback(t,this.ionViewDidLeaveDestructorCallbacks)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewWillEnterDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewDidEnter(t){if(t.id){const e=this.ionViewDidEnterCallbacks.findIndex(s=>s.id===t.id);e>-1?this.ionViewDidEnterCallbacks[e]=t:this.ionViewDidEnterCallbacks.push(t)}else this.ionViewDidEnterCallbacks.push(t)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewDidEnterDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewWillLeave(t){if(t.id){const e=this.ionViewWillLeaveCallbacks.findIndex(s=>s.id===t.id);e>-1?this.ionViewWillLeaveCallbacks[e]=t:this.ionViewWillLeaveCallbacks.push(t)}else this.ionViewWillLeaveCallbacks.push(t)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewWillLeaveDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewDidLeave(t){if(t.id){const e=this.ionViewDidLeaveCallbacks.findIndex(s=>s.id===t.id);e>-1?this.ionViewDidLeaveCallbacks[e]=t:this.ionViewDidLeaveCallbacks.push(t)}else this.ionViewDidLeaveCallbacks.push(t)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewDidLeaveDestructorCallbacks.push({id:t.id,destructor:e})}),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(t){this.componentCanBeDestroyedCallback=t}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},AM=(t,e=[])=>{const s=Q.useContext(o_),l=Q.useRef();l.current=l.current||Math.floor(Math.random()*1e6),Q.useEffect(()=>(t.id=l.current,s.onIonViewDidEnter(t),()=>{s.cleanupIonViewDidEnter(t)}),e)},gu=Nt.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:t=>{typeof window<"u"&&(typeof t=="string"?window.location.pathname=t:window.history.back())},navigate:t=>{typeof window<"u"&&(window.location.pathname=t)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)},resetTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)}}),oS=t=>t.toLowerCase().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(""),Cx=t=>t.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`),Ax=(t,e,s={})=>{if(t instanceof Element){const l=MM(t.classList,e,s);l!==""&&(t.className=l),Object.keys(e).forEach(f=>{if(!(f==="children"||f==="style"||f==="ref"||f==="class"||f==="className"||f==="forwardedRef"))if(f.indexOf("on")===0&&f[2]===f[2].toUpperCase()){const _=f.substring(2),y=_[0].toLowerCase()+_.substring(1);l_(y)||IM(t,y,e[f])}else t[f]=e[f],typeof e[f]==="string"&&t.setAttribute(Cx(f),e[f])})}},MM=(t,e,s)=>{const l=e.className||e.class,f=s.className||s.class,_=G_(t),y=G_(l?l.split(" "):[]),d=G_(f?f.split(" "):[]),A=[];return _.forEach(I=>{y.has(I)?(A.push(I),y.delete(I)):d.has(I)||A.push(I)}),y.forEach(I=>A.push(I)),A.join(" ")},PM=t=>t==="doubleclick"?"dblclick":t;const l_=t=>{if(typeof document>"u")return!0;{const e="on"+PM(t);let s=e in document;if(!s){const l=document.createElement("div");l.setAttribute(e,"return;"),s=typeof l[e]=="function"}return s}},IM=(t,e,s)=>{const l=t.__events||(t.__events={}),f=l[e];f&&t.removeEventListener(e,f),t.addEventListener(e,l[e]=function(y){s&&s.call(this,y)})},G_=t=>{const e=new Map;return t.forEach(s=>e.set(s,s)),e},jM=(t,e)=>{typeof t=="function"?t(e):t!=null&&(t.current=e)},Mx=(...t)=>e=>{t.forEach(s=>{jM(s,e)})},LM=(t,e)=>{const s=(l,f)=>S.jsx(t,{...l,forwardedRef:f});return s.displayName=e,Nt.forwardRef(s)},Pc=(t,e,s,l)=>{l!==void 0&&l();const f=oS(t),_=class extends Nt.Component{constructor(y){super(y),this.setComponentElRef=d=>{this.componentEl=d}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(y){Ax(this.componentEl,this.props,y)}render(){const{children:y,forwardedRef:d,style:A,className:I,ref:B,...N}=this.props,K={...Object.keys(N).reduce((se,ne)=>{const ve=N[ne];if(ne.indexOf("on")===0&&ne[2]===ne[2].toUpperCase()){const re=ne.substring(2).toLowerCase();typeof document<"u"&&l_(re)&&(se[ne]=ve)}else{const re=typeof ve;(re==="string"||re==="boolean"||re==="number")&&(se[Cx(ne)]=ve)}return se},{}),ref:Mx(d,this.setComponentElRef),style:A};return Q.createElement(t,K,y)}static get displayName(){return f}};return LM(_,f)},Ql=Pc("ion-content",void 0,void 0,Hk),Js=Pc("ion-spinner",void 0,void 0,PC),RM=Pc("ion-tab",void 0,void 0,RC),pp=(t,e)=>{const s=(l,f)=>S.jsx(t,{...l,forwardedRef:f});return s.displayName=e,Nt.forwardRef(s)},Px=()=>{if(typeof window<"u"){const t=window.Ionic;if(t&&t.config)return t.config}return null},zM=(t,e)=>{t instanceof Element&&Object.keys(e).forEach(s=>{if(s.indexOf("on")===0&&s[2]===s[2].toUpperCase()){const l=s.substring(2),f=l[0].toLowerCase()+l.substring(1);l_(f)||DM(t,f)}})},DM=(t,e)=>{const s=t.__events||(t.__events={}),l=s[e];l&&(t.removeEventListener(e,l),s[e]=void 0)},OM=(t,e,s)=>{e&&e();const l=oS(t),f=class extends Nt.Component{constructor(_){super(_),this.handleIonMount=()=>{this.setState({isOpen:!0})},this.handleWillPresent=y=>{this.setState({isOpen:!0}),this.props.onWillPresent&&this.props.onWillPresent(y)},this.handleDidDismiss=y=>{const d=this.wrapperRef.current,A=this.ref.current;d&&A&&(A.append(d),this.setState({isOpen:!1})),this.props.onDidDismiss&&this.props.onDidDismiss(y)},this.ref=Nt.createRef(),this.stableMergedRefs=Mx(this.ref,this.props.forwardedRef),this.state={isOpen:!1},this.wrapperRef=Nt.createRef()}componentDidMount(){this.componentDidUpdate(this.props),this.ref.current?.addEventListener("ionMount",this.handleIonMount),this.ref.current?.addEventListener("willPresent",this.handleWillPresent),this.ref.current?.addEventListener("didDismiss",this.handleDidDismiss)}componentDidUpdate(_){const y=this.ref.current,{onDidDismiss:d,onWillPresent:A,...I}=this.props;Ax(y,I,_)}componentWillUnmount(){const _=this.ref.current;_&&this.state.isOpen&&(_.removeEventListener("didDismiss",this.handleDidDismiss),_.remove(),zM(_,this.props))}render(){const{children:_,forwardedRef:y,style:d,className:A,ref:I,...B}=this.props,V={...Object.keys(B).reduce((se,ne)=>{if(ne.indexOf("on")===0&&ne[2]===ne[2].toUpperCase()){const ve=ne.substring(2).toLowerCase();l_(ve)&&(se[ne]=B[ne])}else["string","boolean","number"].includes(typeof B[ne])&&(se[Cx(ne)]=B[ne]);return se},{}),ref:this.stableMergedRefs,style:d},K=()=>s?`${e0} ion-page`:e0;return Q.createElement("template",{},Q.createElement(t,V,this.state.isOpen||this.props.keepContentsMounted?Q.createElement("div",{ref:this.wrapperRef,className:K()},_):null))}static get displayName(){return l}};return pp(f,l)},e0="ion-delegate-host",c_=OM("ion-modal",YC,!0),NM=Nt.createContext({addOverlay:()=>{},removeOverlay:()=>{}}),BM=({onAddOverlay:t,onRemoveOverlay:e})=>{const[s,l]=Q.useState({}),f=Q.useRef({});Q.useEffect(()=>{t(_),e(y)},[]);const _=(A,I,B)=>{const N={...f.current};N[A]={component:I,containerElement:B},f.current=N,l(N)},y=A=>{const I={...f.current};delete I[A],f.current=I,l(I)},d=Object.keys(s);return S.jsx(S.Fragment,{children:d.map(A=>{const I=s[A];return hk.createPortal(I.component,I.containerElement,`overlay-${A}`)})})},$M=Pc("ion-tab-button",void 0,void 0,xA),UM=Pc("ion-tab-bar",void 0,void 0,mA),t0=Pc("ion-tabs",void 0,void 0,TA),FM=Pc("ion-back-button",void 0,void 0,aA),Vv=Pc("ion-router-outlet",void 0,void 0,uA),VM=Pc("ion-app",void 0,void 0,tA),qM=Pc("ion-icon",void 0,void 0,kM);class lS extends Nt.Component{constructor(e){super(e),this.ionContext={addOverlay:(s,l,f)=>{this.addOverlayCallback&&this.addOverlayCallback(s,l,f)},removeOverlay:s=>{this.removeOverlayCallback&&this.removeOverlayCallback(s)}}}render(){return S.jsxs(NM.Provider,{value:this.ionContext,children:[S.jsx(VM,{...this.props,children:this.props.children}),S.jsx(BM,{onAddOverlay:e=>{this.addOverlayCallback=e},onRemoveOverlay:e=>{this.removeOverlayCallback=e}})]})}}lS.displayName="IonApp";const Ix=Nt.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class jx extends Nt.PureComponent{constructor(e){super(e),this.ionPageElementRef=Nt.createRef(),this.stableMergedRefs=Mx(this.ionPageElementRef,this.props.forwardedRef),this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const{className:e,children:s,routeInfo:l,forwardedRef:f,..._}=this.props;return S.jsx(o_.Consumer,{children:y=>(this.ionLifeCycleContext=y,S.jsx("div",{className:e?`${e} ion-page`:"ion-page",ref:this.stableMergedRefs,..._,children:s}))})}static get contextType(){return Ix}}class HM extends Nt.Component{constructor(e){super(e)}render(){const{className:e,children:s,forwardedRef:l,...f}=this.props;return this.context.hasIonicRouter()?S.jsx(jx,{className:e?`${e}`:"",routeInfo:this.context.routeInfo,forwardedRef:l,...f,children:s}):S.jsx("div",{className:e?`ion-page ${e}`:"ion-page",ref:l,...f,children:s})}static get displayName(){return"IonPage"}static get contextType(){return gu}}const Zh=pp(HM,"IonPage"),i0={main:0},$m=(t="main")=>{const e=(i0[t]??0)+1;return i0[t]=e,e.toString()},ZM=(t,e)=>{const s=new WeakMap,l=`react-delegate-${$m()}`;let f=0;return{attachViewToDom:async(d,A,I,B)=>{const N=document.createElement("div");B&&N.classList.add(...B),d.appendChild(N);const V=A(I),K=`${l}-${f++}`,se=b1.createPortal(V,N,K);return s.set(N,se),t(se),Promise.resolve(N)},removeViewFromDom:(d,A)=>{const I=s.get(A);return I&&e(I),A.remove(),Promise.resolve()}}},GM=Pc("ion-nav",void 0,void 0,oC),WM=({children:t,forwardedRef:e,...s})=>{const[l,f]=Q.useState([]),_=A=>f(I=>[...I,A]),y=A=>f(I=>I.filter(B=>B!==A)),d=Q.useMemo(()=>ZM(_,y),[]);return S.jsx(GM,{delegate:d,ref:e,...s,children:l})};pp(WM,"IonNav");const cS=Nt.createContext({activeTab:void 0,selectTab:()=>!1,hasRouterOutlet:!1,tabBarProps:{ref:Nt.createRef()}}),YM=typeof HTMLElement<"u"?HTMLElement:class{};class XM extends Nt.Component{constructor(e){super(e),this.outletIsReady=!1,this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||Jd(this.ionRouterOutlet,()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)}),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const{StackManager:e,children:s,routeInfo:l,...f}=this.props;return S.jsx(o_.Consumer,{children:_=>(this.ionLifeCycleContext=_,S.jsx(e,{routeInfo:l,children:S.jsx(Vv,{setRef:y=>this.ionRouterOutlet=y,...f,children:s})}))})}static get contextType(){return Ix}}class KM extends Nt.Component{constructor(e){super(e)}render(){const e=this.context.getStackManager(),{children:s,forwardedRef:l,...f}=this.props;return this.context.hasIonicRouter()?f.ionPage?S.jsx(XM,{StackManager:e,routeInfo:this.context.routeInfo,...f,children:s}):S.jsx(e,{routeInfo:this.context.routeInfo,children:S.jsx(Vv,{...f,forwardedRef:l,children:s})}):S.jsx(Vv,{ref:l,...this.props,children:this.props.children})}static get contextType(){return gu}}const ip=pp(KM,"IonRouterOutlet");class JM extends YM{constructor(){super()}}typeof window<"u"&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",JM));class QM extends Nt.Component{shouldComponentUpdate(){return!0}constructor(e){super(e),this.routerOutletRef=Nt.createRef(),this.tabBarRef=Nt.createRef(),this.ionTabContextState={activeTab:void 0,selectTab:()=>!1,hasRouterOutlet:!1,tabBarProps:{ref:this.tabBarRef}}}componentDidMount(){this.tabBarRef.current&&(this.ionTabContextState.activeTab=this.tabBarRef.current.state.activeTab,this.tabBarRef.current.setActiveTabOnContext=e=>{this.ionTabContextState.activeTab=e},this.ionTabContextState.selectTab=this.tabBarRef.current.selectTab)}renderTabsInner(e,s){return S.jsx(t0,{...this.props,children:Nt.Children.map(e,l=>Nt.isValidElement(l)&&(l.type===ip||l.type.isRouterOutlet||l.type===Q.Fragment&&l.props.children[0].type===ip)?s:l)})}render(){let e,s=!1;const{className:l,onIonTabsDidChange:f,onIonTabsWillChange:_,...y}=this.props,d=typeof this.props.children=="function"?this.props.children(this.ionTabContextState):this.props.children;if(Nt.Children.forEach(d,A=>{if(A==null||typeof A!="object"||!A.hasOwnProperty("type"))return;A.type===ip||A.type.isRouterOutlet?e=Nt.cloneElement(A):A.type===Q.Fragment&&A.props.children[0].type===ip?e=Nt.cloneElement(A.props.children[0]):A.type===RM&&(s=!0),this.ionTabContextState.hasRouterOutlet=!!e;let I={...this.ionTabContextState.tabBarProps};f!==void 0&&(I={...I,onIonTabsDidChange:f}),_!==void 0&&(I={...I,onIonTabsWillChange:_}),this.ionTabContextState.tabBarProps=I}),!e&&!s)throw new Error("IonTabs must contain an IonRouterOutlet or an IonTab");if(e&&s)throw new Error("IonTabs cannot contain an IonRouterOutlet and an IonTab at the same time");return s?S.jsx(t0,{...this.props}):S.jsx(cS.Provider,{value:this.ionTabContextState,children:this.context.hasIonicRouter()?S.jsx(jx,{className:l?`${l}`:"",routeInfo:this.context.routeInfo,...y,children:this.renderTabsInner(d,e)}):this.renderTabsInner(d,e)})}static get contextType(){return gu}}class Zd extends Nt.Component{shouldComponentUpdate(){return!0}constructor(e){super(e),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const{onClick:e,...s}=this.props;return S.jsx($M,{onIonTabButtonClick:this.handleIonTabButtonClick,...s})}static get displayName(){return"IonTabButton"}}const n0=(t,e)=>{if(e===void 0)return!1;const s=e.endsWith("/")&&e!=="/"?e.slice(0,-1):e;return t===s||t.startsWith(s+"/")};class eP extends Nt.PureComponent{constructor(e){super(e),this.setActiveTabOnContext=l=>{};const s={};Nt.Children.forEach(e.children,l=>{l!=null&&typeof l=="object"&&l.props&&(l.type===Zd||l.type.isTabButton)&&(s[l.props.tab]={originalHref:l.props.href,currentHref:l.props.href,originalRouteOptions:l.props.href===e.routeInfo?.pathname?e.routeInfo?.routeOptions:void 0,currentRouteOptions:l.props.href===e.routeInfo?.pathname?e.routeInfo?.routeOptions:void 0})}),this.state={tabs:s},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const e=this.state.tabs,l=Object.keys(e).find(f=>{const _=e[f].originalHref;return n0(this.props.routeInfo.pathname,_)});l&&this.setState({activeTab:l})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(e){const s=this.state.tabs[e];return s?(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:s.currentHref,tab:e,selected:e===this.state.activeTab,routeOptions:void 0}})),!0):!1}static getDerivedStateFromProps(e,s){const l={...s.tabs},_=Object.keys(s.tabs).find(d=>{const A=s.tabs[d].originalHref;return n0(e.routeInfo.pathname,A)});Nt.Children.forEach(e.children,d=>{if(d!=null&&typeof d=="object"&&d.props&&(d.type===Zd||d.type.isTabButton)){const A=l[d.props.tab];(!A||A.originalHref!==d.props.href)&&(l[d.props.tab]={originalHref:d.props.href,currentHref:d.props.href,originalRouteOptions:d.props.routeOptions,currentRouteOptions:d.props.routeOptions})}});const{activeTab:y}=s;if(_&&y){const d=s.tabs[y].currentHref,A=s.tabs[y].currentRouteOptions;(_!==y||d!==e.routeInfo?.pathname||A!==e.routeInfo?.routeOptions)&&(l[_]={originalHref:l[_].originalHref,currentHref:e.routeInfo.pathname+(e.routeInfo.search||""),originalRouteOptions:l[_].originalRouteOptions,currentRouteOptions:e.routeInfo?.routeOptions},e.routeInfo.routeAction==="pop"&&_!==y&&(l[y]={originalHref:l[y].originalHref,currentHref:l[y].originalHref,originalRouteOptions:l[y].originalRouteOptions,currentRouteOptions:l[y].currentRouteOptions}))}return _&&e.onSetCurrentTab(_,e.routeInfo),{activeTab:_,tabs:l}}onTabButtonClick(e,s){const l=this.state.tabs[e.detail.tab],f=l.originalHref,_=this.props.tabsContext?.hasRouterOutlet,y=_?e.detail.href:"",{activeTab:d}=this.state;s&&s(e),d===e.detail.tab?f!==y&&this.context.resetTab(e.detail.tab,f,l.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:e.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:e.detail.tab}})),_&&(this.setActiveTabOnContext(e.detail.tab),this.context.changeTab(e.detail.tab,y,e.detail.routeOptions)))}renderTabButton(e){return s=>{if(s!=null&&s.props&&(s.type===Zd||s.type.isTabButton)){const l=s.props.tab===e?this.props.routeInfo?.pathname:this.state.tabs[s.props.tab].currentHref,f=s.props.tab===e?this.props.routeInfo?.routeOptions:this.state.tabs[s.props.tab].currentRouteOptions;return Nt.cloneElement(s,{href:l,routeOptions:f,onClick:_=>this.onTabButtonClick(_,s.props.onClick)})}return null}}render(){const{activeTab:e}=this.state;return S.jsx(UM,{...this.props,selectedTab:e,children:Nt.Children.map(this.props.children,this.renderTabButton(e))})}static get contextType(){return gu}}const tP=Nt.memo(({forwardedRef:t,...e})=>{const s=Q.useContext(gu),l=Q.useContext(cS),f=t||l.tabBarProps.ref,_={...l.tabBarProps,ref:f};return S.jsx(eP,{ref:f,...e,routeInfo:e.routeInfo||s.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:s.setCurrentTab,tabsContext:{...l,tabBarProps:_},children:e.children})}),iP=pp(tP,"IonTabBar");class eO extends Nt.Component{constructor(){super(...arguments),this.clickButton=e=>{if(e.target&&e.target.closest("ion-nav")!==null)return;const{defaultHref:s,routerAnimation:l}=this.props;this.context.hasIonicRouter()?(e.stopPropagation(),this.context.goBack(s,l)):s!==void 0&&(window.location.href=s)}}render(){return S.jsx(FM,{onClick:this.clickButton,...this.props})}static get displayName(){return"IonBackButton"}static get contextType(){return gu}shouldComponentUpdate(){return!0}}class nP extends Nt.PureComponent{constructor(e){super(e),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){const{icon:e,ios:s,md:l,mode:f,..._}=this.props;let y;const d=Px(),A=f||d?.get("mode");return s||l?A==="ios"?y=s??l??e:y=l??s??e:y=e,S.jsx(qM,{ref:this.props.forwardedRef,icon:y,..._,children:this.props.children})}static get contextType(){return gu}}pp(nP,"IonIcon");class Lx extends Nt.PureComponent{render(){const e=this.context.getIonRoute();return!this.context.hasIonicRouter()||!Lx?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null):S.jsx(e,{...this.props})}static get contextType(){return gu}}class uS extends Nt.PureComponent{render(){const e=this.context.getIonRedirect();return!this.context.hasIonicRouter()||!uS?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRedirect>"),null):S.jsx(e,{...this.props})}static get contextType(){return gu}}const hS=Nt.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});function dS(){const t=Q.useContext(hS);return Q.useMemo(()=>({back:t.back,push:t.push,goBack:t.back,canGoBack:t.canGoBack,routeInfo:t.routeInfo}),[t.back,t.push,t.canGoBack,t.routeInfo])}class tO extends Nt.PureComponent{constructor(e){super(e),this.nodes=new Map,this.animation=vn(e.id)}setupAnimation(e){const s=this.animation;this.nodes.size>0&&s.addElement(Array.from(this.nodes.values())),s0(s,e),r0(s,e)}componentDidMount(){const e=this.props;this.setupAnimation(e)}componentDidUpdate(e){const s=this.animation,l=this.props;s0(s,l,e),sP(s,l,e),r0(s,l,e)}render(){const{children:e}=this.props;return S.jsx(S.Fragment,{children:Nt.Children.map(e,(s,l)=>Nt.cloneElement(s,{ref:f=>this.nodes.set(l,f)}))})}}const s0=(t,e={},s={})=>{const l=["children","progressStart","progressStep","progressEnd","pause","stop","destroy","play","from","to","fromTo","onFinish"];for(const A in e)e.hasOwnProperty(A)&&!l.includes(A)&&e[A]!==s[A]&&t[A](e[A]);const f=e.from;f&&f!==s.from&&(Array.isArray(f)?f:[f]).forEach(I=>t.from(I.property,I.value));const _=e.to;_&&_!==s.to&&(Array.isArray(_)?_:[_]).forEach(I=>t.to(I.property,I.value));const y=e.fromTo;y&&y!==s.fromTo&&(Array.isArray(y)?y:[y]).forEach(I=>t.fromTo(I.property,I.fromValue,I.toValue));const d=e.onFinish;d&&d!==s.onFinish&&(Array.isArray(d)?d:[d]).forEach(I=>t.onFinish(I.callback,I.opts))},sP=(t,e={},s={})=>{const{progressStart:l,progressStep:f,progressEnd:_}=e;l&&(s.progressStart?.forceLinearEasing!==l?.forceLinearEasing||s.progressStart?.step!==l?.step)&&t.progressStart(l.forceLinearEasing,l.step),f&&s.progressStep?.step!==f?.step&&t.progressStep(f.step),_&&(s.progressEnd?.playTo!==_?.playTo||s.progressEnd?.step!==_?.step||s?.dur!==_?.dur)&&t.progressEnd(_.playTo,_.step,_.dur)},r0=(t,e={},s={})=>{!s.play&&e.play&&t.play(),!s.pause&&e.pause&&t.pause(),!s.stop&&e.stop&&t.stop(),!s.destroy&&e.destroy&&t.destroy()};function rP(t,e,s){const l=Q.useRef(),f=Q.useMemo(()=>`on${t}DidDismiss`,[t]),_=Q.useMemo(()=>`on${t}DidPresent`,[t]),y=Q.useMemo(()=>`on${t}WillDismiss`,[t]),d=Q.useMemo(()=>`on${t}WillPresent`,[t]);s();const A=Q.useCallback(async B=>{if(l.current)return;const{onDidDismiss:N,onWillDismiss:V,onDidPresent:K,onWillPresent:se,...ne}=B,ve=re=>{N&&N(re),l.current=void 0};l.current=await e.create({...ne}),Ax(l.current,{[f]:ve,[_]:re=>K&&K(re),[y]:re=>V&&V(re),[d]:re=>se&&se(re)}),l.current.present()},[e]),I=Q.useCallback(async()=>{l.current&&await l.current.dismiss(),l.current=void 0},[]);return{present:A,dismiss:I}}function aP(){const t=rP("IonToast",QE,WC);return[Q.useCallback((s,l)=>typeof s=="string"?t.present({message:s,duration:l}):t.present(s),[t.present]),t.dismiss]}const oP=(t={})=>{typeof document<"u"&&document.documentElement.classList.add("ion-ce"),OE({...t})},fS=Nt.createContext({addViewItem:()=>{},canGoBack:()=>{},clearOutlet:()=>{},createViewItem:()=>{},findViewItemByPathname:()=>{},findLeavingViewItemByRouteInfo:()=>{},findViewItemByRouteInfo:()=>{},getChildrenToRender:()=>{},goBack:()=>{},unMountViewItem:()=>{}});class a0 extends Nt.Component{constructor(e){super(e),this.ionLifeCycleContext=new CM,this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed(()=>{this.props.mount||this._isMounted&&this.setState({show:!1},()=>this.props.removeView())}),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:e}=this.state;return S.jsx(o_.Provider,{value:this.ionLifeCycleContext,children:e&&this.props.children})}}class lP{constructor(){this.locationHistory=[],this.tabHistory={}}add(e){e.routeAction==="push"||e.routeAction==null?this._add(e):e.routeAction==="pop"?this._pop(e):e.routeAction==="replace"&&this._replace(e),e.routeDirection==="root"&&(this._clear(),this._add(e))}clearTabStack(e){const s=this._getRouteInfosByKey(e);s&&(s.forEach(l=>{this.locationHistory=this.locationHistory.filter(f=>f.id!==l.id)}),this.tabHistory[e]=[])}update(e){const s=this.locationHistory.findIndex(f=>f.id===e.id);s>-1&&this.locationHistory.splice(s,1,e);const l=this.tabHistory[e.tab||""];if(l){const f=l.findIndex(_=>_.id===e.id);f>-1?l.splice(f,1,e):l.push(e)}else e.tab&&(this.tabHistory[e.tab]=[e])}_add(e){const s=this._getRouteInfosByKey(e.tab);s&&(this._areRoutesEqual(s[s.length-1],e)&&s.pop(),s.push(e)),this.locationHistory.push(e)}_areRoutesEqual(e,s){return!e||!s?!1:e.pathname===s.pathname&&e.search===s.search}_pop(e){const s=this._getRouteInfosByKey(e.tab);s&&(s.pop(),s.pop(),s.push(e)),this.locationHistory.pop(),this.locationHistory.pop(),this.locationHistory.push(e)}_replace(e){const s=this._getRouteInfosByKey(e.tab);s&&s.pop(),this.locationHistory.pop(),this._add(e)}_clear(){Object.keys(this.tabHistory).forEach(s=>this.tabHistory[s]=[]),this.locationHistory=[]}_getRouteInfosByKey(e){let s;return e&&(s=this.tabHistory[e],s||(s=this.tabHistory[e]=[])),s}getFirstRouteInfoForTab(e){const s=this._getRouteInfosByKey(e);if(s)return s[0]}getCurrentRouteInfoForTab(e){const s=this._getRouteInfosByKey(e);if(s)return s[s.length-1]}findLastLocation(e){const s=this._getRouteInfosByKey(e.tab);if(s)for(let l=s.length-2;l>=0;l--){const f=s[l];if(f&&f.pathname===e.pushedByRoute)return f}for(let l=this.locationHistory.length-2;l>=0;l--){const f=this.locationHistory[l];if(f&&f.pathname===e.pushedByRoute)return f}}previous(){return this.locationHistory[this.locationHistory.length-2]||this.locationHistory[this.locationHistory.length-1]}current(){return this.locationHistory[this.locationHistory.length-1]}canGoBack(){return this.locationHistory.length>1}}class cP extends Nt.PureComponent{constructor(e){super(e),this.ionRouterContextValue={push:(s,l,f,_,y)=>{this.navigate(s,l,f,y,_)},back:s=>{this.goBack(void 0,s)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){typeof document<"u"&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){typeof document<"u"&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(e){e.detail.register(0,s=>{this.nativeGoBack(),s()})}goBack(e,s){this.props.onNavigateBack(e,s)}nativeGoBack(){this.props.onNativeBack()}navigate(e,s="forward",l="push",f,_,y){this.props.onNavigate(e,l,s,f,_,y)}getPageManager(){return jx}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return S.jsx(gu.Provider,{value:{...this.state,routeInfo:this.props.routeInfo},children:S.jsx(hS.Provider,{value:{...this.ionRouterContextValue,routeInfo:this.props.routeInfo},children:this.props.children})})}}class uP{constructor(){this.viewStacks={},this.add=this.add.bind(this),this.clear=this.clear.bind(this),this.getViewItemsForOutlet=this.getViewItemsForOutlet.bind(this),this.remove=this.remove.bind(this)}add(e){const{outletId:s}=e;this.viewStacks[s]?this.viewStacks[s].push(e):this.viewStacks[s]=[e]}clear(e){return setTimeout(()=>{delete this.viewStacks[e]},500)}getViewItemsForOutlet(e){return this.viewStacks[e]||[]}remove(e){const{outletId:s}=e,l=this.viewStacks[s];if(l){const f=l.find(_=>_.id===e.id);f&&(f.mount=!1,this.viewStacks[s]=l.filter(_=>_.id!==f.id))}}getStackIds(){return Object.keys(this.viewStacks)}getAllViewItems(){const e=this.getStackIds(),s=[];return e.forEach(l=>{s.push(...this.viewStacks[l])}),s}}function Xu(t,e){var s={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(s[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(t);f<l.length;f++)e.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(t,l[f])&&(s[l[f]]=t[l[f]]);return s}function hP(t,e,s,l){function f(_){return _ instanceof s?_:new s(function(y){y(_)})}return new(s||(s=Promise))(function(_,y){function d(B){try{I(l.next(B))}catch(N){y(N)}}function A(B){try{I(l.throw(B))}catch(N){y(N)}}function I(B){B.done?_(B.value):f(B.value).then(d,A)}I((l=l.apply(t,e||[])).next())})}function Zo(){return Zo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var l in s)({}).hasOwnProperty.call(s,l)&&(t[l]=s[l])}return t},Zo.apply(null,arguments)}function py(t){return t.charAt(0)==="/"}function W_(t,e){for(var s=e,l=s+1,f=t.length;l<f;s+=1,l+=1)t[s]=t[l];t.pop()}function dP(t,e){e===void 0&&(e="");var s=t&&t.split("/")||[],l=e&&e.split("/")||[],f=t&&py(t),_=e&&py(e),y=f||_;if(t&&py(t)?l=s:s.length&&(l.pop(),l=l.concat(s)),!l.length)return"/";var d;if(l.length){var A=l[l.length-1];d=A==="."||A===".."||A===""}else d=!1;for(var I=0,B=l.length;B>=0;B--){var N=l[B];N==="."?W_(l,B):N===".."?(W_(l,B),I++):I&&(W_(l,B),I--)}if(!y)for(;I--;I)l.unshift("..");y&&l[0]!==""&&(!l[0]||!py(l[0]))&&l.unshift("");var V=l.join("/");return d&&V.substr(-1)!=="/"&&(V+="/"),V}function o0(t){return t.valueOf?t.valueOf():Object.prototype.valueOf.call(t)}function Cy(t,e){if(t===e)return!0;if(t==null||e==null)return!1;if(Array.isArray(t))return Array.isArray(e)&&t.length===e.length&&t.every(function(f,_){return Cy(f,e[_])});if(typeof t=="object"||typeof e=="object"){var s=o0(t),l=o0(e);return s!==t||l!==e?Cy(s,l):Object.keys(Object.assign({},t,e)).every(function(f){return Cy(t[f],e[f])})}return!1}var fP="Invariant failed";function nf(t,e){throw new Error(fP)}function Pm(t){return t.charAt(0)==="/"?t:"/"+t}function l0(t){return t.charAt(0)==="/"?t.substr(1):t}function pP(t,e){return t.toLowerCase().indexOf(e.toLowerCase())===0&&"/?#".indexOf(t.charAt(e.length))!==-1}function pS(t,e){return pP(t,e)?t.substr(e.length):t}function mS(t){return t.charAt(t.length-1)==="/"?t.slice(0,-1):t}function mP(t){var e=t||"/",s="",l="",f=e.indexOf("#");f!==-1&&(l=e.substr(f),e=e.substr(0,f));var _=e.indexOf("?");return _!==-1&&(s=e.substr(_),e=e.substr(0,_)),{pathname:e,search:s==="?"?"":s,hash:l==="#"?"":l}}function Kl(t){var e=t.pathname,s=t.search,l=t.hash,f=e||"/";return s&&s!=="?"&&(f+=s.charAt(0)==="?"?s:"?"+s),l&&l!=="#"&&(f+=l.charAt(0)==="#"?l:"#"+l),f}function Ho(t,e,s,l){var f;typeof t=="string"?(f=mP(t),f.state=e):(f=Zo({},t),f.pathname===void 0&&(f.pathname=""),f.search?f.search.charAt(0)!=="?"&&(f.search="?"+f.search):f.search="",f.hash?f.hash.charAt(0)!=="#"&&(f.hash="#"+f.hash):f.hash="",e!==void 0&&f.state===void 0&&(f.state=e));try{f.pathname=decodeURI(f.pathname)}catch(_){throw _ instanceof URIError?new URIError('Pathname "'+f.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):_}return s&&(f.key=s),l?f.pathname?f.pathname.charAt(0)!=="/"&&(f.pathname=dP(f.pathname,l.pathname)):f.pathname=l.pathname:f.pathname||(f.pathname="/"),f}function gP(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&Cy(t.state,e.state)}function Rx(){var t=null;function e(y){return t=y,function(){t===y&&(t=null)}}function s(y,d,A,I){if(t!=null){var B=typeof t=="function"?t(y,d):t;typeof B=="string"?typeof A=="function"?A(B,I):I(!0):I(B!==!1)}else I(!0)}var l=[];function f(y){var d=!0;function A(){d&&y.apply(void 0,arguments)}return l.push(A),function(){d=!1,l=l.filter(function(I){return I!==A})}}function _(){for(var y=arguments.length,d=new Array(y),A=0;A<y;A++)d[A]=arguments[A];l.forEach(function(I){return I.apply(void 0,d)})}return{setPrompt:e,confirmTransitionTo:s,appendListener:f,notifyListeners:_}}var gS=!!(typeof window<"u"&&window.document&&window.document.createElement);function yS(t,e){e(window.confirm(t))}function yP(){var t=window.navigator.userAgent;return(t.indexOf("Android 2.")!==-1||t.indexOf("Android 4.0")!==-1)&&t.indexOf("Mobile Safari")!==-1&&t.indexOf("Chrome")===-1&&t.indexOf("Windows Phone")===-1?!1:window.history&&"pushState"in window.history}function _P(){return window.navigator.userAgent.indexOf("Trident")===-1}function vP(){return window.navigator.userAgent.indexOf("Firefox")===-1}function xP(t){return t.state===void 0&&navigator.userAgent.indexOf("CriOS")===-1}var c0="popstate",u0="hashchange";function h0(){try{return window.history.state||{}}catch{return{}}}function bP(t){t===void 0&&(t={}),gS||nf();var e=window.history,s=yP(),l=!_P(),f=t,_=f.forceRefresh,y=_===void 0?!1:_,d=f.getUserConfirmation,A=d===void 0?yS:d,I=f.keyLength,B=I===void 0?6:I,N=t.basename?mS(Pm(t.basename)):"";function V(Tt){var lt=Tt||{},xe=lt.key,Ce=lt.state,st=window.location,ot=st.pathname,_t=st.search,kt=st.hash,It=ot+_t+kt;return N&&(It=pS(It,N)),Ho(It,Ce,xe)}function K(){return Math.random().toString(36).substr(2,B)}var se=Rx();function ne(Tt){Zo(We,Tt),We.length=e.length,se.notifyListeners(We.location,We.action)}function ve(Tt){xP(Tt)||oe(V(Tt.state))}function re(){oe(V(h0()))}var ge=!1;function oe(Tt){if(ge)ge=!1,ne();else{var lt="POP";se.confirmTransitionTo(Tt,lt,A,function(xe){xe?ne({action:lt,location:Tt}):me(Tt)})}}function me(Tt){var lt=We.location,xe=ke.indexOf(lt.key);xe===-1&&(xe=0);var Ce=ke.indexOf(Tt.key);Ce===-1&&(Ce=0);var st=xe-Ce;st&&(ge=!0,Xe(st))}var ye=V(h0()),ke=[ye.key];function Re(Tt){return N+Kl(Tt)}function Ge(Tt,lt){var xe="PUSH",Ce=Ho(Tt,lt,K(),We.location);se.confirmTransitionTo(Ce,xe,A,function(st){if(st){var ot=Re(Ce),_t=Ce.key,kt=Ce.state;if(s)if(e.pushState({key:_t,state:kt},null,ot),y)window.location.href=ot;else{var It=ke.indexOf(We.location.key),ei=ke.slice(0,It+1);ei.push(Ce.key),ke=ei,ne({action:xe,location:Ce})}else window.location.href=ot}})}function He(Tt,lt){var xe="REPLACE",Ce=Ho(Tt,lt,K(),We.location);se.confirmTransitionTo(Ce,xe,A,function(st){if(st){var ot=Re(Ce),_t=Ce.key,kt=Ce.state;if(s)if(e.replaceState({key:_t,state:kt},null,ot),y)window.location.replace(ot);else{var It=ke.indexOf(We.location.key);It!==-1&&(ke[It]=Ce.key),ne({action:xe,location:Ce})}else window.location.replace(ot)}})}function Xe(Tt){e.go(Tt)}function at(){Xe(-1)}function et(){Xe(1)}var Et=0;function gt(Tt){Et+=Tt,Et===1&&Tt===1?(window.addEventListener(c0,ve),l&&window.addEventListener(u0,re)):Et===0&&(window.removeEventListener(c0,ve),l&&window.removeEventListener(u0,re))}var pt=!1;function $e(Tt){Tt===void 0&&(Tt=!1);var lt=se.setPrompt(Tt);return pt||(gt(1),pt=!0),function(){return pt&&(pt=!1,gt(-1)),lt()}}function ct(Tt){var lt=se.appendListener(Tt);return gt(1),function(){gt(-1),lt()}}var We={length:e.length,action:"POP",location:ye,createHref:Re,push:Ge,replace:He,go:Xe,goBack:at,goForward:et,block:$e,listen:ct};return We}var d0="hashchange",wP={hashbang:{encodePath:function(e){return e.charAt(0)==="!"?e:"!/"+l0(e)},decodePath:function(e){return e.charAt(0)==="!"?e.substr(1):e}},noslash:{encodePath:l0,decodePath:Pm},slash:{encodePath:Pm,decodePath:Pm}};function _S(t){var e=t.indexOf("#");return e===-1?t:t.slice(0,e)}function Tm(){var t=window.location.href,e=t.indexOf("#");return e===-1?"":t.substring(e+1)}function SP(t){window.location.hash=t}function Y_(t){window.location.replace(_S(window.location.href)+"#"+t)}function TP(t){t===void 0&&(t={}),gS||nf();var e=window.history;vP();var s=t,l=s.getUserConfirmation,f=l===void 0?yS:l,_=s.hashType,y=_===void 0?"slash":_,d=t.basename?mS(Pm(t.basename)):"",A=wP[y],I=A.encodePath,B=A.decodePath;function N(){var lt=B(Tm());return d&&(lt=pS(lt,d)),Ho(lt)}var V=Rx();function K(lt){Zo(Tt,lt),Tt.length=e.length,V.notifyListeners(Tt.location,Tt.action)}var se=!1,ne=null;function ve(lt,xe){return lt.pathname===xe.pathname&&lt.search===xe.search&&lt.hash===xe.hash}function re(){var lt=Tm(),xe=I(lt);if(lt!==xe)Y_(xe);else{var Ce=N(),st=Tt.location;if(!se&&ve(st,Ce)||ne===Kl(Ce))return;ne=null,ge(Ce)}}function ge(lt){if(se)se=!1,K();else{var xe="POP";V.confirmTransitionTo(lt,xe,f,function(Ce){Ce?K({action:xe,location:lt}):oe(lt)})}}function oe(lt){var xe=Tt.location,Ce=Re.lastIndexOf(Kl(xe));Ce===-1&&(Ce=0);var st=Re.lastIndexOf(Kl(lt));st===-1&&(st=0);var ot=Ce-st;ot&&(se=!0,at(ot))}var me=Tm(),ye=I(me);me!==ye&&Y_(ye);var ke=N(),Re=[Kl(ke)];function Ge(lt){var xe=document.querySelector("base"),Ce="";return xe&&xe.getAttribute("href")&&(Ce=_S(window.location.href)),Ce+"#"+I(d+Kl(lt))}function He(lt,xe){var Ce="PUSH",st=Ho(lt,void 0,void 0,Tt.location);V.confirmTransitionTo(st,Ce,f,function(ot){if(ot){var _t=Kl(st),kt=I(d+_t),It=Tm()!==kt;if(It){ne=_t,SP(kt);var ei=Re.lastIndexOf(Kl(Tt.location)),li=Re.slice(0,ei+1);li.push(_t),Re=li,K({action:Ce,location:st})}else K()}})}function Xe(lt,xe){var Ce="REPLACE",st=Ho(lt,void 0,void 0,Tt.location);V.confirmTransitionTo(st,Ce,f,function(ot){if(ot){var _t=Kl(st),kt=I(d+_t),It=Tm()!==kt;It&&(ne=_t,Y_(kt));var ei=Re.indexOf(Kl(Tt.location));ei!==-1&&(Re[ei]=_t),K({action:Ce,location:st})}})}function at(lt){e.go(lt)}function et(){at(-1)}function Et(){at(1)}var gt=0;function pt(lt){gt+=lt,gt===1&&lt===1?window.addEventListener(d0,re):gt===0&&window.removeEventListener(d0,re)}var $e=!1;function ct(lt){lt===void 0&&(lt=!1);var xe=V.setPrompt(lt);return $e||(pt(1),$e=!0),function(){return $e&&($e=!1,pt(-1)),xe()}}function We(lt){var xe=V.appendListener(lt);return pt(1),function(){pt(-1),xe()}}var Tt={length:e.length,action:"POP",location:ke,createHref:Ge,push:He,replace:Xe,go:at,goBack:et,goForward:Et,block:ct,listen:We};return Tt}function f0(t,e,s){return Math.min(Math.max(t,e),s)}function EP(t){t===void 0&&(t={});var e=t,s=e.getUserConfirmation,l=e.initialEntries,f=l===void 0?["/"]:l,_=e.initialIndex,y=_===void 0?0:_,d=e.keyLength,A=d===void 0?6:d,I=Rx();function B(Ge){Zo(Re,Ge),Re.length=Re.entries.length,I.notifyListeners(Re.location,Re.action)}function N(){return Math.random().toString(36).substr(2,A)}var V=f0(y,0,f.length-1),K=f.map(function(Ge){return typeof Ge=="string"?Ho(Ge,void 0,N()):Ho(Ge,void 0,Ge.key||N())}),se=Kl;function ne(Ge,He){var Xe="PUSH",at=Ho(Ge,He,N(),Re.location);I.confirmTransitionTo(at,Xe,s,function(et){if(et){var Et=Re.index,gt=Et+1,pt=Re.entries.slice(0);pt.length>gt?pt.splice(gt,pt.length-gt,at):pt.push(at),B({action:Xe,location:at,index:gt,entries:pt})}})}function ve(Ge,He){var Xe="REPLACE",at=Ho(Ge,He,N(),Re.location);I.confirmTransitionTo(at,Xe,s,function(et){et&&(Re.entries[Re.index]=at,B({action:Xe,location:at}))})}function re(Ge){var He=f0(Re.index+Ge,0,Re.entries.length-1),Xe="POP",at=Re.entries[He];I.confirmTransitionTo(at,Xe,s,function(et){et?B({action:Xe,location:at,index:He}):B()})}function ge(){re(-1)}function oe(){re(1)}function me(Ge){var He=Re.index+Ge;return He>=0&&He<Re.entries.length}function ye(Ge){return Ge===void 0&&(Ge=!1),I.setPrompt(Ge)}function ke(Ge){return I.appendListener(Ge)}var Re={length:K.length,action:"POP",location:K[V],index:V,entries:K,createHref:se,push:ne,replace:ve,go:re,goBack:ge,goForward:oe,canGo:me,block:ye,listen:ke};return Re}function qv(t,e){return qv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,l){return s.__proto__=l,s},qv(t,e)}function Wh(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,qv(t,e)}var X_={exports:{}},K_,p0;function kP(){if(p0)return K_;p0=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K_=t,K_}var J_,m0;function CP(){if(m0)return J_;m0=1;var t=kP();function e(){}function s(){}return s.resetWarningCache=e,J_=function(){function l(y,d,A,I,B,N){if(N!==t){var V=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw V.name="Invariant Violation",V}}l.isRequired=l;function f(){return l}var _={array:l,bigint:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:f,element:l,elementType:l,instanceOf:f,node:l,objectOf:f,oneOf:f,oneOfType:f,shape:f,exact:f,checkPropTypes:s,resetWarningCache:e};return _.PropTypes=_,_},J_}var g0;function AP(){return g0||(g0=1,X_.exports=CP()()),X_.exports}var MP=AP();const y0=Kh(MP);var $d={exports:{}},Q_,_0;function PP(){return _0||(_0=1,Q_=Array.isArray||function(t){return Object.prototype.toString.call(t)=="[object Array]"}),Q_}var v0;function IP(){if(v0)return $d.exports;v0=1;var t=PP();$d.exports=ve,$d.exports.parse=s,$d.exports.compile=f,$d.exports.tokensToFunction=d,$d.exports.tokensToRegExp=ne;var e=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function s(re,ge){for(var oe=[],me=0,ye=0,ke="",Re=ge&&ge.delimiter||"/",Ge;(Ge=e.exec(re))!=null;){var He=Ge[0],Xe=Ge[1],at=Ge.index;if(ke+=re.slice(ye,at),ye=at+He.length,Xe){ke+=Xe[1];continue}var et=re[ye],Et=Ge[2],gt=Ge[3],pt=Ge[4],$e=Ge[5],ct=Ge[6],We=Ge[7];ke&&(oe.push(ke),ke="");var Tt=Et!=null&&et!=null&&et!==Et,lt=ct==="+"||ct==="*",xe=ct==="?"||ct==="*",Ce=Et||Re,st=pt||$e,ot=Et||(typeof oe[oe.length-1]=="string"?oe[oe.length-1]:"");oe.push({name:gt||me++,prefix:Et||"",delimiter:Ce,optional:xe,repeat:lt,partial:Tt,asterisk:!!We,pattern:st?I(st):We?".*":l(Ce,ot)})}return ye<re.length&&(ke+=re.substr(ye)),ke&&oe.push(ke),oe}function l(re,ge){return!ge||ge.indexOf(re)>-1?"[^"+A(re)+"]+?":A(ge)+"|(?:(?!"+A(ge)+")[^"+A(re)+"])+?"}function f(re,ge){return d(s(re,ge),ge)}function _(re){return encodeURI(re).replace(/[\/?#]/g,function(ge){return"%"+ge.charCodeAt(0).toString(16).toUpperCase()})}function y(re){return encodeURI(re).replace(/[?#]/g,function(ge){return"%"+ge.charCodeAt(0).toString(16).toUpperCase()})}function d(re,ge){for(var oe=new Array(re.length),me=0;me<re.length;me++)typeof re[me]=="object"&&(oe[me]=new RegExp("^(?:"+re[me].pattern+")$",N(ge)));return function(ye,ke){for(var Re="",Ge=ye||{},He=ke||{},Xe=He.pretty?_:encodeURIComponent,at=0;at<re.length;at++){var et=re[at];if(typeof et=="string"){Re+=et;continue}var Et=Ge[et.name],gt;if(Et==null)if(et.optional){et.partial&&(Re+=et.prefix);continue}else throw new TypeError('Expected "'+et.name+'" to be defined');if(t(Et)){if(!et.repeat)throw new TypeError('Expected "'+et.name+'" to not repeat, but received `'+JSON.stringify(Et)+"`");if(Et.length===0){if(et.optional)continue;throw new TypeError('Expected "'+et.name+'" to not be empty')}for(var pt=0;pt<Et.length;pt++){if(gt=Xe(Et[pt]),!oe[at].test(gt))throw new TypeError('Expected all "'+et.name+'" to match "'+et.pattern+'", but received `'+JSON.stringify(gt)+"`");Re+=(pt===0?et.prefix:et.delimiter)+gt}continue}if(gt=et.asterisk?y(Et):Xe(Et),!oe[at].test(gt))throw new TypeError('Expected "'+et.name+'" to match "'+et.pattern+'", but received "'+gt+'"');Re+=et.prefix+gt}return Re}}function A(re){return re.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function I(re){return re.replace(/([=!:$\/()])/g,"\\$1")}function B(re,ge){return re.keys=ge,re}function N(re){return re&&re.sensitive?"":"i"}function V(re,ge){var oe=re.source.match(/\((?!\?)/g);if(oe)for(var me=0;me<oe.length;me++)ge.push({name:me,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return B(re,ge)}function K(re,ge,oe){for(var me=[],ye=0;ye<re.length;ye++)me.push(ve(re[ye],ge,oe).source);var ke=new RegExp("(?:"+me.join("|")+")",N(oe));return B(ke,ge)}function se(re,ge,oe){return ne(s(re,oe),ge,oe)}function ne(re,ge,oe){t(ge)||(oe=ge||oe,ge=[]),oe=oe||{};for(var me=oe.strict,ye=oe.end!==!1,ke="",Re=0;Re<re.length;Re++){var Ge=re[Re];if(typeof Ge=="string")ke+=A(Ge);else{var He=A(Ge.prefix),Xe="(?:"+Ge.pattern+")";ge.push(Ge),Ge.repeat&&(Xe+="(?:"+He+Xe+")*"),Ge.optional?Ge.partial?Xe=He+"("+Xe+")?":Xe="(?:"+He+"("+Xe+"))?":Xe=He+"("+Xe+")",ke+=Xe}}var at=A(oe.delimiter||"/"),et=ke.slice(-at.length)===at;return me||(ke=(et?ke.slice(0,-at.length):ke)+"(?:"+at+"(?=$))?"),ye?ke+="$":ke+=me&&et?"":"(?="+at+"|$)",B(new RegExp("^"+ke,N(oe)),ge)}function ve(re,ge,oe){return t(ge)||(oe=ge||oe,ge=[]),oe=oe||{},re instanceof RegExp?V(re,ge):t(re)?K(re,ge,oe):se(re,ge,oe)}return $d.exports}var jP=IP();const vS=Kh(jP);var ev={exports:{}},ms={};var x0;function LP(){if(x0)return ms;x0=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,s=t?Symbol.for("react.portal"):60106,l=t?Symbol.for("react.fragment"):60107,f=t?Symbol.for("react.strict_mode"):60108,_=t?Symbol.for("react.profiler"):60114,y=t?Symbol.for("react.provider"):60109,d=t?Symbol.for("react.context"):60110,A=t?Symbol.for("react.async_mode"):60111,I=t?Symbol.for("react.concurrent_mode"):60111,B=t?Symbol.for("react.forward_ref"):60112,N=t?Symbol.for("react.suspense"):60113,V=t?Symbol.for("react.suspense_list"):60120,K=t?Symbol.for("react.memo"):60115,se=t?Symbol.for("react.lazy"):60116,ne=t?Symbol.for("react.block"):60121,ve=t?Symbol.for("react.fundamental"):60117,re=t?Symbol.for("react.responder"):60118,ge=t?Symbol.for("react.scope"):60119;function oe(ye){if(typeof ye=="object"&&ye!==null){var ke=ye.$$typeof;switch(ke){case e:switch(ye=ye.type,ye){case A:case I:case l:case _:case f:case N:return ye;default:switch(ye=ye&&ye.$$typeof,ye){case d:case B:case se:case K:case y:return ye;default:return ke}}case s:return ke}}}function me(ye){return oe(ye)===I}return ms.AsyncMode=A,ms.ConcurrentMode=I,ms.ContextConsumer=d,ms.ContextProvider=y,ms.Element=e,ms.ForwardRef=B,ms.Fragment=l,ms.Lazy=se,ms.Memo=K,ms.Portal=s,ms.Profiler=_,ms.StrictMode=f,ms.Suspense=N,ms.isAsyncMode=function(ye){return me(ye)||oe(ye)===A},ms.isConcurrentMode=me,ms.isContextConsumer=function(ye){return oe(ye)===d},ms.isContextProvider=function(ye){return oe(ye)===y},ms.isElement=function(ye){return typeof ye=="object"&&ye!==null&&ye.$$typeof===e},ms.isForwardRef=function(ye){return oe(ye)===B},ms.isFragment=function(ye){return oe(ye)===l},ms.isLazy=function(ye){return oe(ye)===se},ms.isMemo=function(ye){return oe(ye)===K},ms.isPortal=function(ye){return oe(ye)===s},ms.isProfiler=function(ye){return oe(ye)===_},ms.isStrictMode=function(ye){return oe(ye)===f},ms.isSuspense=function(ye){return oe(ye)===N},ms.isValidElementType=function(ye){return typeof ye=="string"||typeof ye=="function"||ye===l||ye===I||ye===_||ye===f||ye===N||ye===V||typeof ye=="object"&&ye!==null&&(ye.$$typeof===se||ye.$$typeof===K||ye.$$typeof===y||ye.$$typeof===d||ye.$$typeof===B||ye.$$typeof===ve||ye.$$typeof===re||ye.$$typeof===ge||ye.$$typeof===ne)},ms.typeOf=oe,ms}var b0;function xS(){return b0||(b0=1,ev.exports=LP()),ev.exports}xS();function bS(t,e){if(t==null)return{};var s={};for(var l in t)if({}.hasOwnProperty.call(t,l)){if(e.indexOf(l)!==-1)continue;s[l]=t[l]}return s}var tv,w0;function RP(){if(w0)return tv;w0=1;var t=xS(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},f={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},_={};_[t.ForwardRef]=l,_[t.Memo]=f;function y(se){return t.isMemo(se)?f:_[se.$$typeof]||e}var d=Object.defineProperty,A=Object.getOwnPropertyNames,I=Object.getOwnPropertySymbols,B=Object.getOwnPropertyDescriptor,N=Object.getPrototypeOf,V=Object.prototype;function K(se,ne,ve){if(typeof ne!="string"){if(V){var re=N(ne);re&&re!==V&&K(se,re,ve)}var ge=A(ne);I&&(ge=ge.concat(I(ne)));for(var oe=y(se),me=y(ne),ye=0;ye<ge.length;++ye){var ke=ge[ye];if(!s[ke]&&!(ve&&ve[ke])&&!(me&&me[ke])&&!(oe&&oe[ke])){var Re=B(ne,ke);try{d(se,ke,Re)}catch{}}}}return se}return tv=K,tv}var zP=RP();const DP=Kh(zP);var iv=1073741823,S0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{};function OP(){var t="__global_unique_id__";return S0[t]=(S0[t]||0)+1}function NP(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function BP(t){var e=[];return{on:function(l){e.push(l)},off:function(l){e=e.filter(function(f){return f!==l})},get:function(){return t},set:function(l,f){t=l,e.forEach(function(_){return _(t,f)})}}}function $P(t){return Array.isArray(t)?t[0]:t}function UP(t,e){var s,l,f="__create-react-context-"+OP()+"__",_=(function(d){Wh(A,d);function A(){for(var B,N=arguments.length,V=new Array(N),K=0;K<N;K++)V[K]=arguments[K];return B=d.call.apply(d,[this].concat(V))||this,B.emitter=BP(B.props.value),B}var I=A.prototype;return I.getChildContext=function(){var N;return N={},N[f]=this.emitter,N},I.componentWillReceiveProps=function(N){if(this.props.value!==N.value){var V=this.props.value,K=N.value,se;NP(V,K)?se=0:(se=typeof e=="function"?e(V,K):iv,se|=0,se!==0&&this.emitter.set(N.value,se))}},I.render=function(){return this.props.children},A})(Nt.Component);_.childContextTypes=(s={},s[f]=y0.object.isRequired,s);var y=(function(d){Wh(A,d);function A(){for(var B,N=arguments.length,V=new Array(N),K=0;K<N;K++)V[K]=arguments[K];return B=d.call.apply(d,[this].concat(V))||this,B.observedBits=void 0,B.state={value:B.getValue()},B.onUpdate=function(se,ne){var ve=B.observedBits|0;(ve&ne)!==0&&B.setState({value:B.getValue()})},B}var I=A.prototype;return I.componentWillReceiveProps=function(N){var V=N.observedBits;this.observedBits=V??iv},I.componentDidMount=function(){this.context[f]&&this.context[f].on(this.onUpdate);var N=this.props.observedBits;this.observedBits=N??iv},I.componentWillUnmount=function(){this.context[f]&&this.context[f].off(this.onUpdate)},I.getValue=function(){return this.context[f]?this.context[f].get():t},I.render=function(){return $P(this.props.children)(this.state.value)},A})(Nt.Component);return y.contextTypes=(l={},l[f]=y0.object,l),{Provider:_,Consumer:y}}var FP=Nt.createContext||UP,wS=function(e){var s=FP();return s.displayName=e,s},SS=wS("Router-History"),Yh=wS("Router"),Jm=(function(t){Wh(e,t),e.computeRootMatch=function(f){return{path:"/",url:"/",params:{},isExact:f==="/"}};function e(l){var f;return f=t.call(this,l)||this,f.state={location:l.history.location},f._isMounted=!1,f._pendingLocation=null,l.staticContext||(f.unlisten=l.history.listen(function(_){f._pendingLocation=_})),f}var s=e.prototype;return s.componentDidMount=function(){var f=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen(function(_){f._isMounted&&f.setState({location:_})})),this._pendingLocation&&this.setState({location:this._pendingLocation})},s.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},s.render=function(){return Nt.createElement(Yh.Provider,{value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},Nt.createElement(SS.Provider,{children:this.props.children||null,value:this.props.history}))},e})(Nt.Component);Nt.Component;var VP=(function(t){Wh(e,t);function e(){return t.apply(this,arguments)||this}var s=e.prototype;return s.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},s.componentDidUpdate=function(f){this.props.onUpdate&&this.props.onUpdate.call(this,this,f)},s.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},s.render=function(){return null},e})(Nt.Component),nv={},qP=1e4,T0=0;function HP(t){if(nv[t])return nv[t];var e=vS.compile(t);return T0<qP&&(nv[t]=e,T0++),e}function E0(t,e){return t===void 0&&(t="/"),e===void 0&&(e={}),t==="/"?t:HP(t)(e,{pretty:!0})}function Ec(t){var e=t.computedMatch,s=t.to,l=t.push,f=l===void 0?!1:l;return Nt.createElement(Yh.Consumer,null,function(_){_||nf();var y=_.history,d=_.staticContext,A=f?y.push:y.replace,I=Ho(e?typeof s=="string"?E0(s,e.params):Zo({},s,{pathname:E0(s.pathname,e.params)}):s);return d?(A(I),null):Nt.createElement(VP,{onMount:function(){A(I)},onUpdate:function(N,V){var K=Ho(V.to);gP(K,Zo({},I,{key:K.key}))||A(I)},to:s})})}var k0={},ZP=1e4,C0=0;function GP(t,e){var s=""+e.end+e.strict+e.sensitive,l=k0[s]||(k0[s]={});if(l[t])return l[t];var f=[],_=vS(t,f,e),y={regexp:_,keys:f};return C0<ZP&&(l[t]=y,C0++),y}function zx(t,e){e===void 0&&(e={}),(typeof e=="string"||Array.isArray(e))&&(e={path:e});var s=e,l=s.path,f=s.exact,_=f===void 0?!1:f,y=s.strict,d=y===void 0?!1:y,A=s.sensitive,I=A===void 0?!1:A,B=[].concat(l);return B.reduce(function(N,V){if(!V&&V!=="")return null;if(N)return N;var K=GP(V,{end:_,strict:d,sensitive:I}),se=K.regexp,ne=K.keys,ve=se.exec(t);if(!ve)return null;var re=ve[0],ge=ve.slice(1),oe=t===re;return _&&!oe?null:{path:V,url:V==="/"&&re===""?"/":re,isExact:oe,params:ne.reduce(function(me,ye,ke){return me[ye.name]=ge[ke],me},{})}},null)}function WP(t){return Nt.Children.count(t)===0}var Ks=(function(t){Wh(e,t);function e(){return t.apply(this,arguments)||this}var s=e.prototype;return s.render=function(){var f=this;return Nt.createElement(Yh.Consumer,null,function(_){_||nf();var y=f.props.location||_.location,d=f.props.computedMatch?f.props.computedMatch:f.props.path?zx(y.pathname,f.props):_.match,A=Zo({},_,{location:y,match:d}),I=f.props,B=I.children,N=I.component,V=I.render;return Array.isArray(B)&&WP(B)&&(B=null),Nt.createElement(Yh.Provider,{value:A},A.match?B?typeof B=="function"?B(A):B:N?Nt.createElement(N,A):V?V(A):null:typeof B=="function"?B(A):null)})},e})(Nt.Component);function Dx(t){return t.charAt(0)==="/"?t:"/"+t}function YP(t,e){return t?Zo({},e,{pathname:Dx(t)+e.pathname}):e}function XP(t,e){if(!t)return e;var s=Dx(t);return e.pathname.indexOf(s)!==0?e:Zo({},e,{pathname:e.pathname.substr(s.length)})}function A0(t){return typeof t=="string"?t:Kl(t)}function sv(t){return function(){nf()}}function M0(){}Nt.Component;Nt.Component;function KP(t){var e="withRouter("+(t.displayName||t.name)+")",s=function(f){var _=f.wrappedComponentRef,y=bS(f,["wrappedComponentRef"]);return Nt.createElement(Yh.Consumer,null,function(d){return d||nf(),Nt.createElement(t,Zo({},y,d,{ref:_}))})};return s.displayName=e,s.WrappedComponent=t,DP(s,t)}var Ox=Nt.useContext;function Fr(){return Ox(SS)}function sf(){return Ox(Yh).location}function Qm(){var t=Ox(Yh).match;return t?t.params:{}}class JP extends Nt.PureComponent{render(){return Nt.createElement(Ks,Object.assign({path:this.props.path,exact:this.props.exact,render:this.props.render},this.props.computedMatch!==void 0?{computedMatch:this.props.computedMatch}:{}))}}const Um=({pathname:t,componentProps:e})=>{const{exact:s,component:l}=e,f=e.path||e.from,y=zx(t,{exact:s,path:f,component:l});return y||!1};class QP extends uP{constructor(){super(),this.createViewItem=this.createViewItem.bind(this),this.findViewItemByRouteInfo=this.findViewItemByRouteInfo.bind(this),this.findLeavingViewItemByRouteInfo=this.findLeavingViewItemByRouteInfo.bind(this),this.getChildrenToRender=this.getChildrenToRender.bind(this),this.findViewItemByPathname=this.findViewItemByPathname.bind(this)}createViewItem(e,s,l,f){const _={id:$m("viewItem"),outletId:e,ionPageElement:f,reactElement:s,mount:!0,ionRoute:!1};return s.type===Lx&&(_.ionRoute=!0,_.disableIonPageManagement=s.props.disableIonPageManagement),_.routeData={match:Um({pathname:l.pathname,componentProps:s.props}),childProps:s.props},_}getChildrenToRender(e,s,l){const f=this.getViewItemsForOutlet(e);return Nt.Children.forEach(s.props.children,y=>{const d=f.find(A=>P0(y,A.routeData.childProps.path||A.routeData.childProps.from));d&&(d.reactElement=y)}),f.map(y=>{let d;if(y.ionRoute&&!y.disableIonPageManagement)d=Nt.createElement(a0,{key:`view-${y.id}`,mount:y.mount,removeView:()=>this.remove(y)},Nt.cloneElement(y.reactElement,{computedMatch:y.routeData.match}));else{const A=P0(y.reactElement,l.pathname);d=Nt.createElement(a0,{key:`view-${y.id}`,mount:y.mount,removeView:()=>this.remove(y)},Nt.cloneElement(y.reactElement,{computedMatch:y.routeData.match})),!A&&y.routeData.match&&(y.routeData.match=void 0,y.mount=!1)}return d})}findViewItemByRouteInfo(e,s,l){const{viewItem:f,match:_}=this.findViewItemByPath(e.pathname,s);return(l===void 0||l===!0)&&f&&_&&(f.routeData.match=_),f}findLeavingViewItemByRouteInfo(e,s,l=!0){const{viewItem:f}=this.findViewItemByPath(e.lastPathname,s,l);return f}findViewItemByPathname(e,s){const{viewItem:l}=this.findViewItemByPath(e,s);return l}findViewItemByPath(e,s,l){let f,_,y;if(s)y=this.getViewItemsForOutlet(s),y.some(d),f||y.some(A);else{const I=this.getAllViewItems();I.some(d),f||I.some(A)}return{viewItem:f,match:_};function d(I){var B,N;if(l&&!I.ionRoute)return!1;if(_=Um({pathname:e,componentProps:I.routeData.childProps}),_){const V=_.path.includes(":");if(!V||V&&_.url===((N=(B=I.routeData)===null||B===void 0?void 0:B.match)===null||N===void 0?void 0:N.url))return f=I,!0}return!1}function A(I){return!I.routeData.childProps.path&&!I.routeData.childProps.from?(_={path:e,url:e,isExact:!0,params:{}},f=I,!0):!1}}}function P0(t,e){return Um({pathname:e,componentProps:t.props})}function eI(t){let e;if(typeof t=="string"?e=t:e=t.outerHTML,document){const s=document.createElement("div");s.innerHTML=e,s.style.zIndex="";const l=s.getElementsByTagName("ion-back-button");return l[0]&&l[0].remove(),s.firstChild}}const I0=t=>!t.classList.contains("ion-page-invisible")&&!t.classList.contains("ion-page-hidden");class tI extends Nt.PureComponent{constructor(e){super(e),this.stackContextValue={registerIonPage:this.registerIonPage.bind(this),isInOutlet:()=>!0},this.pendingPageTransition=!1,this.registerIonPage=this.registerIonPage.bind(this),this.transitionPage=this.transitionPage.bind(this),this.handlePageTransition=this.handlePageTransition.bind(this),this.id=$m("routerOutlet"),this.prevProps=void 0,this.skipTransition=!1}componentDidMount(){this.clearOutletTimeout&&clearTimeout(this.clearOutletTimeout),this.routerOutletElement&&(this.setupRouterOutlet(this.routerOutletElement),this.handlePageTransition(this.props.routeInfo))}componentDidUpdate(e){const{pathname:s}=this.props.routeInfo,{pathname:l}=e.routeInfo;s!==l?(this.prevProps=e,this.handlePageTransition(this.props.routeInfo)):this.pendingPageTransition&&(this.handlePageTransition(this.props.routeInfo),this.pendingPageTransition=!1)}componentWillUnmount(){this.clearOutletTimeout=this.context.clearOutlet(this.id)}async handlePageTransition(e){var s,l;if(!this.routerOutletElement||!this.routerOutletElement.commit)this.pendingPageTransition=!0;else{let f=this.context.findViewItemByRouteInfo(e,this.id),_=this.context.findLeavingViewItemByRouteInfo(e,this.id);!_&&e.prevRouteLastPathname&&(_=this.context.findViewItemByPathname(e.prevRouteLastPathname,this.id)),_&&(e.routeAction==="replace"?_.mount=!1:e.routeAction==="push"&&e.routeDirection==="forward"?!((s=e.routeOptions)===null||s===void 0)&&s.unmount&&(_.mount=!1):e.routeDirection!=="none"&&f!==_&&(_.mount=!1));const y=iI((l=this.ionRouterOutlet)===null||l===void 0?void 0:l.props.children,e);if(f?f.reactElement=y:y&&(f=this.context.createViewItem(this.id,y,e),this.context.addViewItem(f)),f&&f.ionPageElement){if(f===_&&f.routeData.match.url!==e.pathname||(!_&&this.props.routeInfo.prevRouteLastPathname&&(_=this.context.findViewItemByPathname(this.props.routeInfo.prevRouteLastPathname,this.id)),I0(f.ionPageElement)&&_!==void 0&&!I0(_.ionPageElement)))return;this.transitionPage(e,f,_)}else _&&!y&&!f&&_.ionPageElement&&(_.ionPageElement.classList.add("ion-page-hidden"),_.ionPageElement.setAttribute("aria-hidden","true"));this.forceUpdate()}}registerIonPage(e,s){const l=this.context.findViewItemByRouteInfo(s,this.id);if(l){const f=l.ionPageElement;if(l.ionPageElement=e,l.ionRoute=!0,f===e)return}this.handlePageTransition(s)}async setupRouterOutlet(e){const s=()=>{const _=Px();if(!(_&&_.get("swipeBackEnabled",e.mode==="ios")))return!1;const{routeInfo:d}=this.props,A=this.prevProps&&this.prevProps.routeInfo.pathname===d.pushedByRoute?this.prevProps.routeInfo:{pathname:d.pushedByRoute||""},I=this.context.findViewItemByRouteInfo(A,this.id,!1);return!!I&&I.mount&&I.routeData.match.path!==d.pathname},l=async()=>{const{routeInfo:_}=this.props,y=this.prevProps&&this.prevProps.routeInfo.pathname===_.pushedByRoute?this.prevProps.routeInfo:{pathname:_.pushedByRoute||""},d=this.context.findViewItemByRouteInfo(y,this.id,!1),A=this.context.findViewItemByRouteInfo(_,this.id,!1);return d&&A&&await this.transitionPage(_,d,A,"back",!0),Promise.resolve()},f=_=>{if(_)this.skipTransition=!0,this.context.goBack();else{const{routeInfo:y}=this.props,d=this.prevProps&&this.prevProps.routeInfo.pathname===y.pushedByRoute?this.prevProps.routeInfo:{pathname:y.pushedByRoute||""},A=this.context.findViewItemByRouteInfo(d,this.id,!1),I=this.context.findViewItemByRouteInfo(y,this.id,!1);if(A!==I&&A?.ionPageElement!==void 0){const{ionPageElement:B}=A;B.setAttribute("aria-hidden","true"),B.classList.add("ion-page-hidden")}}};e.swipeHandler={canStart:s,onStart:l,onEnd:f}}async transitionPage(e,s,l,f,_=!1){const y=async(B,N)=>{const V=this.skipTransition;V?this.skipTransition=!1:(B.classList.add("ion-page"),B.classList.add("ion-page-invisible")),await d.commit(B,N,{duration:V||I===void 0?0:void 0,direction:I,showGoBack:!!e.pushedByRoute,progressAnimation:_,animationBuilder:e.routeAnimation})},d=this.routerOutletElement,A=e.routeDirection==="none"||e.routeDirection==="root"?void 0:e.routeDirection,I=f??A;if(s&&s.ionPageElement&&this.routerOutletElement)if(l&&l.ionPageElement&&s===l)if(nI(l.reactElement,e.pathname,!0)){const N=eI(l.ionPageElement.outerHTML);N&&(this.routerOutletElement.appendChild(N),await y(s.ionPageElement,N),this.routerOutletElement.removeChild(N))}else await y(s.ionPageElement,void 0);else await y(s.ionPageElement,l?.ionPageElement),l&&l.ionPageElement&&!_&&(l.ionPageElement.classList.add("ion-page-hidden"),l.ionPageElement.setAttribute("aria-hidden","true"))}render(){const{children:e}=this.props,s=Nt.Children.only(e);this.ionRouterOutlet=s;const l=this.context.getChildrenToRender(this.id,this.ionRouterOutlet,this.props.routeInfo,()=>{this.forceUpdate()});return Nt.createElement(Ix.Provider,{value:this.stackContextValue},Nt.cloneElement(s,{ref:f=>{s.props.setRef&&s.props.setRef(f),s.props.forwardedRef&&(s.props.forwardedRef.current=f),this.routerOutletElement=f;const{ref:_}=s;typeof _=="function"&&_(f)}},l))}static get contextType(){return fS}}function iI(t,e){let s;return Nt.Children.forEach(t,l=>{Um({pathname:e.pathname,componentProps:l.props})&&(s=l)}),s||(Nt.Children.forEach(t,l=>{l.props.path||l.props.from||(s=l)}),s)}function nI(t,e,s){return Um({pathname:e,componentProps:Object.assign(Object.assign({},t.props),{exact:s})})}class sI extends Nt.PureComponent{constructor(e){super(e),this.exitViewFromOtherOutletHandlers=[],this.locationHistory=new lP,this.viewStack=new QP,this.routeMangerContextState={canGoBack:()=>this.locationHistory.canGoBack(),clearOutlet:this.viewStack.clear,findViewItemByPathname:this.viewStack.findViewItemByPathname,getChildrenToRender:this.viewStack.getChildrenToRender,goBack:()=>this.handleNavigateBack(),createViewItem:this.viewStack.createViewItem,findViewItemByRouteInfo:this.viewStack.findViewItemByRouteInfo,findLeavingViewItemByRouteInfo:this.viewStack.findLeavingViewItemByRouteInfo,addViewItem:this.viewStack.add,unMountViewItem:this.viewStack.remove};const s={id:$m("routeInfo"),pathname:this.props.location.pathname,search:this.props.location.search};this.locationHistory.add(s),this.handleChangeTab=this.handleChangeTab.bind(this),this.handleResetTab=this.handleResetTab.bind(this),this.handleNativeBack=this.handleNativeBack.bind(this),this.handleNavigate=this.handleNavigate.bind(this),this.handleNavigateBack=this.handleNavigateBack.bind(this),this.props.registerHistoryListener(this.handleHistoryChange.bind(this)),this.handleSetCurrentTab=this.handleSetCurrentTab.bind(this),this.state={routeInfo:s}}handleChangeTab(e,s,l){if(!s)return;const f=this.locationHistory.getCurrentRouteInfoForTab(e),[_,y]=s.split("?");f?(this.incomingRouteParams=Object.assign(Object.assign({},f),{routeAction:"push",routeDirection:"none"}),f.pathname===_?(this.incomingRouteParams.routeOptions=l,this.props.history.push(f.pathname+(f.search||""))):(this.incomingRouteParams.pathname=_,this.incomingRouteParams.search=y?"?"+y:void 0,this.incomingRouteParams.routeOptions=l,this.props.history.push(_+(y?"?"+y:"")))):this.handleNavigate(_,"push","none",void 0,l,e)}handleHistoryChange(e,s){var l,f,_;let y;if(this.incomingRouteParams?this.incomingRouteParams.routeAction==="replace"?y=this.locationHistory.previous():y=this.locationHistory.current():y=this.locationHistory.current(),y.pathname+y.search!==e.pathname){if(!this.incomingRouteParams){if(s==="REPLACE"&&(this.incomingRouteParams={routeAction:"replace",routeDirection:"none",tab:this.currentTab}),s==="POP"){const I=this.locationHistory.current();if(I&&I.pushedByRoute){const B=this.locationHistory.findLastLocation(I);this.incomingRouteParams=Object.assign(Object.assign({},B),{routeAction:"pop",routeDirection:"back"})}else this.incomingRouteParams={routeAction:"pop",routeDirection:"none",tab:this.currentTab}}this.incomingRouteParams||(this.incomingRouteParams={routeAction:"push",routeDirection:((l=e.state)===null||l===void 0?void 0:l.direction)||"forward",routeOptions:(f=e.state)===null||f===void 0?void 0:f.routerOptions,tab:this.currentTab})}let A;if(!((_=this.incomingRouteParams)===null||_===void 0)&&_.id)A=Object.assign(Object.assign({},this.incomingRouteParams),{lastPathname:y.pathname}),this.locationHistory.add(A);else{const I=this.incomingRouteParams.routeAction==="push"&&this.incomingRouteParams.routeDirection==="forward";if(A=Object.assign(Object.assign({id:$m("routeInfo")},this.incomingRouteParams),{lastPathname:y.pathname,pathname:e.pathname,search:e.search,params:this.props.match.params,prevRouteLastPathname:y.lastPathname}),I)A.tab=y.tab,A.pushedByRoute=y.pathname;else if(A.routeAction==="pop"){const B=this.locationHistory.findLastLocation(A);A.pushedByRoute=B?.pushedByRoute}else if(A.routeAction==="push"&&A.tab!==y.tab){const B=this.locationHistory.getCurrentRouteInfoForTab(A.tab);A.pushedByRoute=B?.pushedByRoute}else if(A.routeAction==="replace"){const B=this.locationHistory.current(),N=B?.pushedByRoute,V=N!==void 0&&N!==A.pathname?N:A.pushedByRoute;A.lastPathname=B?.pathname||A.lastPathname,A.prevRouteLastPathname=B?.lastPathname,A.pushedByRoute=V,A.routeDirection=A.routeDirection||B?.routeDirection,A.routeAnimation=A.routeAnimation||B?.routeAnimation}this.locationHistory.add(A)}this.setState({routeInfo:A})}this.incomingRouteParams=void 0}handleNativeBack(){const e=this.props.history;(e.goBack||e.back)()}handleNavigate(e,s,l,f,_,y){this.incomingRouteParams=Object.assign(this.incomingRouteParams||{},{routeAction:s,routeDirection:l,routeOptions:_,routeAnimation:f,tab:y}),s==="push"?this.props.history.push(e):this.props.history.replace(e)}handleNavigateBack(e="/",s){const l=Px();e=e||l&&l.get("backButtonDefaultHref");const f=this.locationHistory.current();if(f&&f.pushedByRoute){const _=this.locationHistory.findLastLocation(f);if(_){const y=s||f.routeAnimation;if(this.incomingRouteParams=Object.assign(Object.assign({},_),{routeAction:"pop",routeDirection:"back",routeAnimation:y}),f.lastPathname===f.pushedByRoute||_.pathname===f.pushedByRoute&&f.tab===""&&_.tab===""){const d=this.props.history;(d.goBack||d.back)()}else this.handleNavigate(_.pathname+(_.search||""),"pop","back",y)}else this.handleNavigate(e,"pop","back",s)}else this.handleNavigate(e,"pop","back",s)}handleResetTab(e,s,l){const f=this.locationHistory.getFirstRouteInfoForTab(e);if(f){const _=Object.assign({},f);_.pathname=s,_.routeOptions=l,this.incomingRouteParams=Object.assign(Object.assign({},_),{routeAction:"pop",routeDirection:"back"}),this.props.history.push(_.pathname+(_.search||""))}}handleSetCurrentTab(e){this.currentTab=e;const s=Object.assign({},this.locationHistory.current());s.tab!==e&&(s.tab=e,this.locationHistory.update(s))}render(){return Nt.createElement(fS.Provider,{value:this.routeMangerContextState},Nt.createElement(cP,{ionRoute:JP,ionRedirect:{},stackManager:tI,routeInfo:this.state.routeInfo,onNativeBack:this.handleNativeBack,onNavigateBack:this.handleNavigateBack,onNavigate:this.handleNavigate,onSetCurrentTab:this.handleSetCurrentTab,onChangeTab:this.handleChangeTab,onResetTab:this.handleResetTab,locationHistory:this.locationHistory},this.props.children))}}const u_=KP(sI);u_.displayName="IonRouter";class rI extends Nt.Component{constructor(e){super(e);const{history:s}=e,l=Xu(e,["history"]);this.history=s||bP(l),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,s){const l=e.location||e,f=e.action||s;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:s}=e,l=Xu(e,["children"]);return Nt.createElement(Jm,Object.assign({history:this.history},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},s))}}class iO extends Nt.Component{constructor(e){super(e),this.history=e.history,this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,s){const l=e.location||e,f=e.action||s;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:s}=e,l=Xu(e,["children"]);return Nt.createElement(Jm,Object.assign({},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},s))}}class nO extends Nt.Component{constructor(e){super(e);const{history:s}=e,l=Xu(e,["history"]);this.history=s||TP(l),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,s){const l=e.location||e,f=e.action||s;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:s}=e,l=Xu(e,["children"]);return Nt.createElement(Jm,Object.assign({history:this.history},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},s))}}const ba=t=>({width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.8,strokeLinecap:"round",strokeLinejoin:"round"}),TS=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("rect",{x:"3",y:"5",width:"18",height:"16",rx:"3"}),S.jsx("path",{d:"M8 3v4M16 3v4M3 10h18"})]}),h_=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("path",{d:"M12 21s6-6.5 6-11a6 6 0 0 0-12 0c0 4.5 6 11 6 11z"}),S.jsx("circle",{cx:"12",cy:"10",r:"2.5"})]}),aI=({className:t,size:e=20})=>S.jsx("svg",{...ba(e),className:t,children:S.jsx("path",{d:"M12 5v14M5 12h14"})}),Ay=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"8",r:"3.5"}),S.jsx("path",{d:"M4 20c1.6-3.6 5-5 8-5s6.4 1.4 8 5"})]}),j0=({className:t,size:e=20})=>S.jsx("svg",{...ba(e),className:t,children:S.jsx("path",{d:"M8 6l10 6-10 6z"})}),ES=({className:t,size:e=20})=>S.jsx("svg",{...ba(e),className:t,children:S.jsx("path",{d:"M12 20s-7-4.6-7-9.5A4.5 4.5 0 0 1 12 7a4.5 4.5 0 0 1 7 3.5C19 15.4 12 20 12 20z"})}),kS=({className:t,size:e=20})=>S.jsx("svg",{...ba(e),className:t,children:S.jsx("path",{d:"M7 4h10a1 1 0 0 1 1 1v15l-6-3.8L6 20V5a1 1 0 0 1 1-1z"})}),oI=({className:t,size:e=20})=>S.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",className:t,fill:"currentColor",children:S.jsx("path",{d:"M7 4h10a1 1 0 0 1 1 1v15l-6-3.8L6 20V5a1 1 0 0 1 1-1z"})}),CS=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("path",{d:"M3 9.5a2.5 2.5 0 0 0 0 5v3a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-3a2.5 2.5 0 0 1 0-5v-3a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v3z"}),S.jsx("path",{d:"M9 7v10"})]}),AS=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("path",{d:"M16 6l-8 4 8 4"}),S.jsx("circle",{cx:"17.5",cy:"6",r:"2.5"}),S.jsx("circle",{cx:"6.5",cy:"12",r:"2.5"}),S.jsx("circle",{cx:"17.5",cy:"18",r:"2.5"})]}),lI=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("path",{d:"M12 20h9"}),S.jsx("path",{d:"M16.5 3.5l4 4L8 20l-5 1 1-5 12.5-12.5z"})]}),cI=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),S.jsx("path",{d:"M16 17l5-5-5-5"}),S.jsx("path",{d:"M21 12H9"})]}),uI=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),S.jsx("rect",{x:"5",y:"5",width:"10",height:"10",rx:"2"})]}),hI=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),S.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),dI=({className:t,size:e=20})=>S.jsx("svg",{...ba(e),className:t,children:S.jsx("path",{d:"M15 18l-6-6 6-6"})}),fI=({className:t,size:e=20})=>S.jsx("svg",{...ba(e),className:t,children:S.jsx("path",{d:"M6 9l6 6 6-6"})}),pI=({className:t,size:e=20})=>S.jsx("svg",{...ba(e),className:t,children:S.jsx("path",{d:"M18 15l-6-6-6 6"})}),L0=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2"}),S.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),mI=({className:t,size:e=20})=>S.jsxs("svg",{...ba(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M14.5 9.5l-1.3 3.7-3.7 1.3 1.3-3.7 3.7-1.3z"}),S.jsx("path",{d:"M12 3v2M21 12h-2M12 21v-2M3 12h2"})]}),gI=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Nx extends Error{constructor(e,s="FunctionsError",l){super(e),this.name=s,this.context=l}}class yI extends Nx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class R0 extends Nx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class z0 extends Nx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Hv;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Hv||(Hv={}));class _I{constructor(e,{headers:s={},customFetch:l,region:f=Hv.Any}={}){this.url=e,this.headers=s,this.region=f,this.fetch=gI(l)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return hP(this,arguments,void 0,function*(s,l={}){var f;let _,y;try{const{headers:d,method:A,body:I,signal:B,timeout:N}=l;let V={},{region:K}=l;K||(K=this.region);const se=new URL(`${this.url}/${s}`);K&&K!=="any"&&(V["x-region"]=K,se.searchParams.set("forceFunctionRegion",K));let ne;I&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&I instanceof Blob||I instanceof ArrayBuffer?(V["Content-Type"]="application/octet-stream",ne=I):typeof I=="string"?(V["Content-Type"]="text/plain",ne=I):typeof FormData<"u"&&I instanceof FormData?ne=I:(V["Content-Type"]="application/json",ne=JSON.stringify(I)):I&&typeof I!="string"&&!(typeof Blob<"u"&&I instanceof Blob)&&!(I instanceof ArrayBuffer)&&!(typeof FormData<"u"&&I instanceof FormData)?ne=JSON.stringify(I):ne=I;let ve=B;N&&(y=new AbortController,_=setTimeout(()=>y.abort(),N),B?(ve=y.signal,B.addEventListener("abort",()=>y.abort())):ve=y.signal);const re=yield this.fetch(se.toString(),{method:A||"POST",headers:Object.assign(Object.assign(Object.assign({},V),this.headers),d),body:ne,signal:ve}).catch(ye=>{throw new yI(ye)}),ge=re.headers.get("x-relay-error");if(ge&&ge==="true")throw new R0(re);if(!re.ok)throw new z0(re);let oe=((f=re.headers.get("Content-Type"))!==null&&f!==void 0?f:"text/plain").split(";")[0].trim(),me;return oe==="application/json"?me=yield re.json():oe==="application/octet-stream"||oe==="application/pdf"?me=yield re.blob():oe==="text/event-stream"?me=re:oe==="multipart/form-data"?me=yield re.formData():me=yield re.text(),{data:me,error:null,response:re}}catch(d){return{data:null,error:d,response:d instanceof z0||d instanceof R0?d.context:void 0}}finally{_&&clearTimeout(_)}})}}var vI=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},xI=class{constructor(t){var e,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(s=t.isMaybeSingle)!==null&&s!==void 0?s:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var s=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let f=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async _=>{let y=null,d=null,A=null,I=_.status,B=_.statusText;if(_.ok){var N,V;if(s.method!=="HEAD"){var K;const re=await _.text();re===""||(s.headers.get("Accept")==="text/csv"||s.headers.get("Accept")&&(!((K=s.headers.get("Accept"))===null||K===void 0)&&K.includes("application/vnd.pgrst.plan+text"))?d=re:d=JSON.parse(re))}const ne=(N=s.headers.get("Prefer"))===null||N===void 0?void 0:N.match(/count=(exact|planned|estimated)/),ve=(V=_.headers.get("content-range"))===null||V===void 0?void 0:V.split("/");ne&&ve&&ve.length>1&&(A=parseInt(ve[1])),s.isMaybeSingle&&s.method==="GET"&&Array.isArray(d)&&(d.length>1?(y={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,A=null,I=406,B="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var se;const ne=await _.text();try{y=JSON.parse(ne),Array.isArray(y)&&_.status===404&&(d=[],y=null,I=200,B="OK")}catch{_.status===404&&ne===""?(I=204,B="No Content"):y={message:ne}}if(y&&s.isMaybeSingle&&(!(y==null||(se=y.details)===null||se===void 0)&&se.includes("0 rows"))&&(y=null,I=200,B="OK"),y&&s.shouldThrowOnError)throw new vI(y)}return{error:y,data:d,count:A,status:I,statusText:B}});return this.shouldThrowOnError||(f=f.catch(_=>{var y;let d="";const A=_?.cause;if(A){var I,B,N,V;const se=(I=A?.message)!==null&&I!==void 0?I:"",ne=(B=A?.code)!==null&&B!==void 0?B:"";d=`${(N=_?.name)!==null&&N!==void 0?N:"FetchError"}: ${_?.message}`,d+=`

Caused by: ${(V=A?.name)!==null&&V!==void 0?V:"Error"}: ${se}`,ne&&(d+=` (${ne})`),A?.stack&&(d+=`
${A.stack}`)}else{var K;d=(K=_?.stack)!==null&&K!==void 0?K:""}return{error:{message:`${(y=_?.name)!==null&&y!==void 0?y:"FetchError"}: ${_?.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),f.then(t,e)}returns(){return this}overrideTypes(){return this}},bI=class extends xI{select(t){let e=!1;const s=(t??"*").split("").map(l=>/\s/.test(l)&&!e?"":(l==='"'&&(e=!e),l)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:s,foreignTable:l,referencedTable:f=l}={}){const _=f?`${f}.order`:"order",y=this.url.searchParams.get(_);return this.url.searchParams.set(_,`${y?`${y},`:""}${t}.${e?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:s=e}={}){const l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(l,`${t}`),this}range(t,e,{foreignTable:s,referencedTable:l=s}={}){const f=typeof l>"u"?"offset":`${l}.offset`,_=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(f,`${t}`),this.url.searchParams.set(_,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:s=!1,buffers:l=!1,wal:f=!1,format:_="text"}={}){var y;const d=[t?"analyze":null,e?"verbose":null,s?"settings":null,l?"buffers":null,f?"wal":null].filter(Boolean).join("|"),A=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${_}; for="${A}"; options=${d};`),_==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const D0=new RegExp("[,()]");var Kf=class extends bI{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const s=Array.from(new Set(e)).map(l=>typeof l=="string"&&D0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(t,`in.(${s})`),this}notIn(t,e){const s=Array.from(new Set(e)).map(l=>typeof l=="string"&&D0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(t,`not.in.(${s})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:s,type:l}={}){let f="";l==="plain"?f="pl":l==="phrase"?f="ph":l==="websearch"&&(f="w");const _=s===void 0?"":`(${s})`;return this.url.searchParams.append(t,`${f}fts${_}.${e}`),this}match(t){return Object.entries(t).forEach(([e,s])=>{this.url.searchParams.append(e,`eq.${s}`)}),this}not(t,e,s){return this.url.searchParams.append(t,`not.${e}.${s}`),this}or(t,{foreignTable:e,referencedTable:s=e}={}){const l=s?`${s}.or`:"or";return this.url.searchParams.append(l,`(${t})`),this}filter(t,e,s){return this.url.searchParams.append(t,`${e}.${s}`),this}},wI=class{constructor(t,{headers:e={},schema:s,fetch:l}){this.url=t,this.headers=new Headers(e),this.schema=s,this.fetch=l}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:s=!1,count:l}=e??{},f=s?"HEAD":"GET";let _=!1;const y=(t??"*").split("").map(I=>/\s/.test(I)&&!_?"":(I==='"'&&(_=!_),I)).join(""),{url:d,headers:A}=this.cloneRequestState();return d.searchParams.set("select",y),l&&A.append("Prefer",`count=${l}`),new Kf({method:f,url:d,headers:A,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:s=!0}={}){var l;const f="POST",{url:_,headers:y}=this.cloneRequestState();if(e&&y.append("Prefer",`count=${e}`),s||y.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((A,I)=>A.concat(Object.keys(I)),[]);if(d.length>0){const A=[...new Set(d)].map(I=>`"${I}"`);_.searchParams.set("columns",A.join(","))}}return new Kf({method:f,url:_,headers:y,schema:this.schema,body:t,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:s=!1,count:l,defaultToNull:f=!0}={}){var _;const y="POST",{url:d,headers:A}=this.cloneRequestState();if(A.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),e!==void 0&&d.searchParams.set("on_conflict",e),l&&A.append("Prefer",`count=${l}`),f||A.append("Prefer","missing=default"),Array.isArray(t)){const I=t.reduce((B,N)=>B.concat(Object.keys(N)),[]);if(I.length>0){const B=[...new Set(I)].map(N=>`"${N}"`);d.searchParams.set("columns",B.join(","))}}return new Kf({method:y,url:d,headers:A,schema:this.schema,body:t,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}update(t,{count:e}={}){var s;const l="PATCH",{url:f,headers:_}=this.cloneRequestState();return e&&_.append("Prefer",`count=${e}`),new Kf({method:l,url:f,headers:_,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:t}={}){var e;const s="DELETE",{url:l,headers:f}=this.cloneRequestState();return t&&f.append("Prefer",`count=${t}`),new Kf({method:s,url:l,headers:f,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},SI=class MS{constructor(e,{headers:s={},schema:l,fetch:f}={}){this.url=e,this.headers=new Headers(s),this.schemaName=l,this.fetch=f}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new wI(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new MS(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,s={},{head:l=!1,get:f=!1,count:_}={}){var y;let d;const A=new URL(`${this.url}/rpc/${e}`);let I;const B=K=>K!==null&&typeof K=="object"&&(!Array.isArray(K)||K.some(B)),N=l&&Object.values(s).some(B);N?(d="POST",I=s):l||f?(d=l?"HEAD":"GET",Object.entries(s).filter(([K,se])=>se!==void 0).map(([K,se])=>[K,Array.isArray(se)?`{${se.join(",")}}`:`${se}`]).forEach(([K,se])=>{A.searchParams.append(K,se)})):(d="POST",I=s);const V=new Headers(this.headers);return N?V.set("Prefer",_?`count=${_},return=minimal`:"return=minimal"):_&&V.set("Prefer",`count=${_}`),new Kf({method:d,url:A,headers:V,schema:this.schemaName,body:I,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}};class TI{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const s=globalThis.process;if(s){const l=s.versions;if(l&&l.node){const f=l.node,_=parseInt(f.replace(/^v/,"").split(".")[0]);return _>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${_} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${_} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let s=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(s+=`

Suggested solution: ${e.workaround}`),new Error(s)}static createWebSocket(e,s){const l=this.getWebSocketConstructor();return new l(e,s)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const EI="2.90.1",kI=`realtime-js/${EI}`,PS="1.0.0",CI="2.0.0",O0=PS,Zv=1e4,AI=1e3,MI=100;var Uh;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Uh||(Uh={}));var ra;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ra||(ra={}));var Cc;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Cc||(Cc={}));var Gv;(function(t){t.websocket="websocket"})(Gv||(Gv={}));var qd;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(qd||(qd={}));class PI{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,s){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(e));let l=[e.join_ref,e.ref,e.topic,e.event,e.payload];return s(JSON.stringify(l))}_binaryEncodeUserBroadcastPush(e){var s;return this._isArrayBuffer((s=e.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var s,l;const f=(l=(s=e.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,f)}_encodeJsonUserBroadcastPush(e){var s,l;const f=(l=(s=e.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},y=new TextEncoder().encode(JSON.stringify(f)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,y)}_encodeUserBroadcastPush(e,s,l){var f,_;const y=e.topic,d=(f=e.ref)!==null&&f!==void 0?f:"",A=(_=e.join_ref)!==null&&_!==void 0?_:"",I=e.payload.event,B=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},N=Object.keys(B).length===0?"":JSON.stringify(B);if(A.length>255)throw new Error(`joinRef length ${A.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`topic length ${y.length} exceeds maximum of 255`);if(I.length>255)throw new Error(`userEvent length ${I.length} exceeds maximum of 255`);if(N.length>255)throw new Error(`metadata length ${N.length} exceeds maximum of 255`);const V=this.USER_BROADCAST_PUSH_META_LENGTH+A.length+d.length+y.length+I.length+N.length,K=new ArrayBuffer(this.HEADER_LENGTH+V);let se=new DataView(K),ne=0;se.setUint8(ne++,this.KINDS.userBroadcastPush),se.setUint8(ne++,A.length),se.setUint8(ne++,d.length),se.setUint8(ne++,y.length),se.setUint8(ne++,I.length),se.setUint8(ne++,N.length),se.setUint8(ne++,s),Array.from(A,re=>se.setUint8(ne++,re.charCodeAt(0))),Array.from(d,re=>se.setUint8(ne++,re.charCodeAt(0))),Array.from(y,re=>se.setUint8(ne++,re.charCodeAt(0))),Array.from(I,re=>se.setUint8(ne++,re.charCodeAt(0))),Array.from(N,re=>se.setUint8(ne++,re.charCodeAt(0)));var ve=new Uint8Array(K.byteLength+l.byteLength);return ve.set(new Uint8Array(K),0),ve.set(new Uint8Array(l),K.byteLength),ve.buffer}decode(e,s){if(this._isArrayBuffer(e)){let l=this._binaryDecode(e);return s(l)}if(typeof e=="string"){const l=JSON.parse(e),[f,_,y,d,A]=l;return s({join_ref:f,ref:_,topic:y,event:d,payload:A})}return s({})}_binaryDecode(e){const s=new DataView(e),l=s.getUint8(0),f=new TextDecoder;if(l===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,s,f)}_decodeUserBroadcast(e,s,l){const f=s.getUint8(1),_=s.getUint8(2),y=s.getUint8(3),d=s.getUint8(4);let A=this.HEADER_LENGTH+4;const I=l.decode(e.slice(A,A+f));A=A+f;const B=l.decode(e.slice(A,A+_));A=A+_;const N=l.decode(e.slice(A,A+y));A=A+y;const V=e.slice(A,e.byteLength),K=d===this.JSON_ENCODING?JSON.parse(l.decode(V)):V,se={type:this.BROADCAST_EVENT,event:B,payload:K};return y>0&&(se.meta=JSON.parse(N)),{join_ref:null,ref:null,topic:I,event:this.BROADCAST_EVENT,payload:se}}_isArrayBuffer(e){var s;return e instanceof ArrayBuffer||((s=e?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}_pick(e,s){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([l])=>s.includes(l)))}}class IS{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ns;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ns||(Ns={}));const N0=(t,e,s={})=>{var l;const f=(l=s.skipTypes)!==null&&l!==void 0?l:[];return e?Object.keys(e).reduce((_,y)=>(_[y]=II(y,t,e,f),_),{}):{}},II=(t,e,s,l)=>{const f=e.find(d=>d.name===t),_=f?.type,y=s[t];return _&&!l.includes(_)?jS(_,y):Wv(y)},jS=(t,e)=>{if(t.charAt(0)==="_"){const s=t.slice(1,t.length);return zI(e,s)}switch(t){case Ns.bool:return jI(e);case Ns.float4:case Ns.float8:case Ns.int2:case Ns.int4:case Ns.int8:case Ns.numeric:case Ns.oid:return LI(e);case Ns.json:case Ns.jsonb:return RI(e);case Ns.timestamp:return DI(e);case Ns.abstime:case Ns.date:case Ns.daterange:case Ns.int4range:case Ns.int8range:case Ns.money:case Ns.reltime:case Ns.text:case Ns.time:case Ns.timestamptz:case Ns.timetz:case Ns.tsrange:case Ns.tstzrange:return Wv(e);default:return Wv(e)}},Wv=t=>t,jI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},LI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},RI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},zI=(t,e)=>{if(typeof t!="string")return t;const s=t.length-1,l=t[s];if(t[0]==="{"&&l==="}"){let _;const y=t.slice(1,s);try{_=JSON.parse("["+y+"]")}catch{_=y?y.split(","):[]}return _.map(d=>jS(e,d))}return t},DI=t=>typeof t=="string"?t.replace(" ","T"):t,LS=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class rv{constructor(e,s,l={},f=Zv){this.channel=e,this.event=s,this.payload=l,this.timeout=f,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var l;return this._hasReceived(e)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(l=>l.status===e).forEach(l=>l.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var B0;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(B0||(B0={}));class Im{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},f=>{const{onJoin:_,onLeave:y,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Im.syncState(this.state,f,_,y),this.pendingDiffs.forEach(A=>{this.state=Im.syncDiff(this.state,A,_,y)}),this.pendingDiffs=[],d()}),this.channel._on(l.diff,{},f=>{const{onJoin:_,onLeave:y,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(f):(this.state=Im.syncDiff(this.state,f,_,y),d())}),this.onJoin((f,_,y)=>{this.channel._trigger("presence",{event:"join",key:f,currentPresences:_,newPresences:y})}),this.onLeave((f,_,y)=>{this.channel._trigger("presence",{event:"leave",key:f,currentPresences:_,leftPresences:y})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,l,f){const _=this.cloneDeep(e),y=this.transformState(s),d={},A={};return this.map(_,(I,B)=>{y[I]||(A[I]=B)}),this.map(y,(I,B)=>{const N=_[I];if(N){const V=B.map(ve=>ve.presence_ref),K=N.map(ve=>ve.presence_ref),se=B.filter(ve=>K.indexOf(ve.presence_ref)<0),ne=N.filter(ve=>V.indexOf(ve.presence_ref)<0);se.length>0&&(d[I]=se),ne.length>0&&(A[I]=ne)}else d[I]=B}),this.syncDiff(_,{joins:d,leaves:A},l,f)}static syncDiff(e,s,l,f){const{joins:_,leaves:y}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),f||(f=()=>{}),this.map(_,(d,A)=>{var I;const B=(I=e[d])!==null&&I!==void 0?I:[];if(e[d]=this.cloneDeep(A),B.length>0){const N=e[d].map(K=>K.presence_ref),V=B.filter(K=>N.indexOf(K.presence_ref)<0);e[d].unshift(...V)}l(d,B,A)}),this.map(y,(d,A)=>{let I=e[d];if(!I)return;const B=A.map(N=>N.presence_ref);I=I.filter(N=>B.indexOf(N.presence_ref)<0),e[d]=I,f(d,I,A),I.length===0&&delete e[d]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(l=>s(l,e[l]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,l)=>{const f=e[l];return"metas"in f?s[l]=f.metas.map(_=>(_.presence_ref=_.phx_ref,delete _.phx_ref,delete _.phx_ref_prev,_)):s[l]=f,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $0;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})($0||($0={}));var jm;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(jm||(jm={}));var qu;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qu||(qu={}));class np{constructor(e,s={config:{}},l){var f,_;if(this.topic=e,this.params=s,this.socket=l,this.bindings={},this.state=ra.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new rv(this,Cc.join,this.params,this.timeout),this.rejoinTimer=new IS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ra.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(y=>y.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ra.closed,this.socket._remove(this)}),this._onError(y=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,y),this.state=ra.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ra.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",y=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,y),this.state=ra.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Cc.reply,{},(y,d)=>{this._trigger(this._replyEventName(d),y)}),this.presence=new Im(this),this.broadcastEndpointURL=LS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((_=(f=this.params.config)===null||f===void 0?void 0:f.broadcast)===null||_===void 0)&&_.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,s=this.timeout){var l,f,_;if(this.socket.isConnected()||this.socket.connect(),this.state==ra.closed){const{config:{broadcast:y,presence:d,private:A}}=this.params,I=(f=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(K=>K.filter))!==null&&f!==void 0?f:[],B=!!this.bindings[jm.PRESENCE]&&this.bindings[jm.PRESENCE].length>0||((_=this.params.config.presence)===null||_===void 0?void 0:_.enabled)===!0,N={},V={broadcast:y,presence:Object.assign(Object.assign({},d),{enabled:B}),postgres_changes:I,private:A};this.socket.accessTokenValue&&(N.access_token=this.socket.accessTokenValue),this._onError(K=>e?.(qu.CHANNEL_ERROR,K)),this._onClose(()=>e?.(qu.CLOSED)),this.updateJoinPayload(Object.assign({config:V},N)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:K})=>{var se;if(this.socket._isManualToken()||this.socket.setAuth(),K===void 0){e?.(qu.SUBSCRIBED);return}else{const ne=this.bindings.postgres_changes,ve=(se=ne?.length)!==null&&se!==void 0?se:0,re=[];for(let ge=0;ge<ve;ge++){const oe=ne[ge],{filter:{event:me,schema:ye,table:ke,filter:Re}}=oe,Ge=K&&K[ge];if(Ge&&Ge.event===me&&np.isFilterValueEqual(Ge.schema,ye)&&np.isFilterValueEqual(Ge.table,ke)&&np.isFilterValueEqual(Ge.filter,Re))re.push(Object.assign(Object.assign({},oe),{id:Ge.id}));else{this.unsubscribe(),this.state=ra.errored,e?.(qu.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=re,e&&e(qu.SUBSCRIBED);return}}).receive("error",K=>{this.state=ra.errored,e?.(qu.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(K).join(", ")||"error")))}).receive("timeout",()=>{e?.(qu.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,l){return this.state===ra.joined&&e===jm.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,s,l)}async httpSend(e,s,l={}){var f;if(s==null)return Promise.reject("Payload is required for httpSend()");const _={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(_.Authorization=`Bearer ${this.socket.accessTokenValue}`);const y={method:"POST",headers:_,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:s,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,y,(f=l.timeout)!==null&&f!==void 0?f:this.timeout);if(d.status===202)return{success:!0};let A=d.statusText;try{const I=await d.json();A=I.error||I.message||A}catch{}return Promise.reject(new Error(A))}async send(e,s={}){var l,f;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:_,payload:y}=e,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const A={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:_,payload:y,private:this.private}]})};try{const I=await this._fetchWithTimeout(this.broadcastEndpointURL,A,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((f=I.body)===null||f===void 0?void 0:f.cancel()),I.ok?"ok":"error"}catch(I){return I.name==="AbortError"?"timed out":"error"}}else return new Promise(_=>{var y,d,A;const I=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((A=(d=(y=this.params)===null||y===void 0?void 0:y.config)===null||d===void 0?void 0:d.broadcast)===null||A===void 0)&&A.ack)&&_("ok"),I.receive("ok",()=>_("ok")),I.receive("error",()=>_("error")),I.receive("timeout",()=>_("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ra.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Cc.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(f=>{l=new rv(this,Cc.leave,{},e),l.receive("ok",()=>{s(),f("ok")}).receive("timeout",()=>{s(),f("timed out")}).receive("error",()=>{f("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ra.closed,this.bindings={}}async _fetchWithTimeout(e,s,l){const f=new AbortController,_=setTimeout(()=>f.abort(),l),y=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:f.signal}));return clearTimeout(_),y}_push(e,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let f=new rv(this,e,s,l);return this._canPush()?f.send():this._addToPushBuffer(f),f}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>MI){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(e,s,l){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,l){var f,_;const y=e.toLocaleLowerCase(),{close:d,error:A,leave:I,join:B}=Cc;if(l&&[d,A,I,B].indexOf(y)>=0&&l!==this._joinRef())return;let V=this._onMessage(y,s,l);if(s&&!V)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(y)?(f=this.bindings.postgres_changes)===null||f===void 0||f.filter(K=>{var se,ne,ve;return((se=K.filter)===null||se===void 0?void 0:se.event)==="*"||((ve=(ne=K.filter)===null||ne===void 0?void 0:ne.event)===null||ve===void 0?void 0:ve.toLocaleLowerCase())===y}).map(K=>K.callback(V,l)):(_=this.bindings[y])===null||_===void 0||_.filter(K=>{var se,ne,ve,re,ge,oe,me,ye;if(["broadcast","presence","postgres_changes"].includes(y))if("id"in K){const ke=K.id,Re=(se=K.filter)===null||se===void 0?void 0:se.event;return ke&&((ne=s.ids)===null||ne===void 0?void 0:ne.includes(ke))&&(Re==="*"||Re?.toLocaleLowerCase()===((ve=s.data)===null||ve===void 0?void 0:ve.type.toLocaleLowerCase()))&&(!(!((re=K.filter)===null||re===void 0)&&re.table)||K.filter.table===((ge=s.data)===null||ge===void 0?void 0:ge.table))}else{const ke=(me=(oe=K?.filter)===null||oe===void 0?void 0:oe.event)===null||me===void 0?void 0:me.toLocaleLowerCase();return ke==="*"||ke===((ye=s?.event)===null||ye===void 0?void 0:ye.toLocaleLowerCase())}else return K.type.toLocaleLowerCase()===y}).map(K=>{if(typeof V=="object"&&"ids"in V){const se=V.data,{schema:ne,table:ve,commit_timestamp:re,type:ge,errors:oe}=se;V=Object.assign(Object.assign({},{schema:ne,table:ve,commit_timestamp:re,eventType:ge,new:{},old:{},errors:oe}),this._getPayloadRecords(se))}K.callback(V,l)})}_isClosed(){return this.state===ra.closed}_isJoined(){return this.state===ra.joined}_isJoining(){return this.state===ra.joining}_isLeaving(){return this.state===ra.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,l){const f=e.toLocaleLowerCase(),_={type:f,filter:s,callback:l};return this.bindings[f]?this.bindings[f].push(_):this.bindings[f]=[_],this}_off(e,s){const l=e.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(f=>{var _;return!(((_=f.type)===null||_===void 0?void 0:_.toLocaleLowerCase())===l&&np.isEqual(f.filter,s))})),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const l in e)if(e[l]!==s[l])return!1;return!0}static isFilterValueEqual(e,s){return(e??void 0)===(s??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Cc.close,{},e)}_onError(e){this._on(Cc.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ra.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=N0(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=N0(e.columns,e.old_record)),s}}const av=()=>{},my={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},OI=[1e3,2e3,5e3,1e4],NI=1e4,BI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $I{constructor(e,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zv,this.transport=null,this.heartbeatIntervalMs=my.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=av,this.ref=0,this.reconnectTimer=null,this.vsn=O0,this.logger=av,this.conn=null,this.sendBuffer=[],this.serializer=new PI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=f=>f?(..._)=>f(..._):(..._)=>fetch(..._),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${e}/${Gv.websocket}`,this.httpEndpoint=LS(e),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=TI.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const s=e.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,l){this.logger(e,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case Uh.connecting:return qd.Connecting;case Uh.open:return qd.Open;case Uh.closing:return qd.Closing;default:return qd.Closed}}isConnected(){return this.connectionState()===qd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,s={config:{}}){const l=`realtime:${e}`,f=this.getChannels().find(_=>_.topic===l);if(f)return f;{const _=new np(`realtime:${e}`,s,this);return this.channels.push(_),_}}push(e){const{topic:s,event:l,payload:f,ref:_}=e,y=()=>{this.encode(e,d=>{var A;(A=this.conn)===null||A===void 0||A.send(d)})};this.log("push",`${s} ${l} (${_})`,f),this.isConnected()?y():this.sendBuffer.push(y)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(AI,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},my.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(l=>l.topic===e&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply"&&s.ref&&s.ref===this.pendingHeartbeatRef){const I=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error",I)}catch(B){this.log("error","error in heartbeat callback",B)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:l,event:f,payload:_,ref:y}=s,d=y?`(${y})`:"",A=_.status||"";this.log("receive",`${A} ${l} ${f} ${d}`.trim(),_),this.channels.filter(I=>I._isMember(l)).forEach(I=>I._trigger(f,_,y)),this._triggerStateCallbacks("message",s)})}_clearTimer(e){var s;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Uh.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Uh.open||this.conn.readyState===Uh.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this._terminateWorker()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var s;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Cc.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const l=e.match(/\?/)?"&":"?",f=new URLSearchParams(s);return`${e}${l}${f}`}_workerObjectUrl(e){let s;if(e)s=e;else{const l=new Blob([BI],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(e,s=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(e=null){let s,l=!1;if(e)s=e,l=!0;else if(this.accessToken)try{s=await this.accessToken()}catch(f){this.log("error","Error fetching access token from callback",f),s=this.accessTokenValue}else s=this.accessTokenValue;l?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(f=>{const _={access_token:s,version:kI};s&&f.updateJoinPayload(_),f.joinedOnce&&f._isJoined()&&f._push(Cc.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(s=>{this.log("error",`Error setting auth in ${e}`,s)})}_triggerStateCallbacks(e,s){try{this.stateChangeCallbacks[e].forEach(l=>{try{l(s)}catch(f){this.log("error",`error in ${e} callback`,f)}})}catch(l){this.log("error",`error triggering ${e} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new IS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},my.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var s,l,f,_,y,d,A,I,B,N,V,K;switch(this.transport=(s=e?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=e?.timeout)!==null&&l!==void 0?l:Zv,this.heartbeatIntervalMs=(f=e?.heartbeatIntervalMs)!==null&&f!==void 0?f:my.HEARTBEAT_INTERVAL,this.worker=(_=e?.worker)!==null&&_!==void 0?_:!1,this.accessToken=(y=e?.accessToken)!==null&&y!==void 0?y:null,this.heartbeatCallback=(d=e?.heartbeatCallback)!==null&&d!==void 0?d:av,this.vsn=(A=e?.vsn)!==null&&A!==void 0?A:O0,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(I=e?.reconnectAfterMs)!==null&&I!==void 0?I:(se=>OI[se-1]||NI),this.vsn){case PS:this.encode=(B=e?.encode)!==null&&B!==void 0?B:((se,ne)=>ne(JSON.stringify(se))),this.decode=(N=e?.decode)!==null&&N!==void 0?N:((se,ne)=>ne(JSON.parse(se)));break;case CI:this.encode=(V=e?.encode)!==null&&V!==void 0?V:this.serializer.encode.bind(this.serializer),this.decode=(K=e?.decode)!==null&&K!==void 0?K:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Fm=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function UI(t,e,s){const l=new URL(e,t);if(s)for(const[f,_]of Object.entries(s))_!==void 0&&l.searchParams.set(f,_);return l.toString()}async function FI(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function VI(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:s,path:l,query:f,body:_,headers:y}){const d=UI(t.baseUrl,l,f),A=await FI(t.auth),I=await e(d,{method:s,headers:{..._?{"Content-Type":"application/json"}:{},...A,...y},body:_?JSON.stringify(_):void 0}),B=await I.text(),N=(I.headers.get("content-type")||"").includes("application/json"),V=N&&B?JSON.parse(B):B;if(!I.ok){const K=N?V:void 0,se=K?.error;throw new Fm(se?.message??`Request failed with status ${I.status}`,{status:I.status,icebergType:se?.type,icebergCode:se?.code,details:K})}return{status:I.status,headers:I.headers,data:V}}}}function gy(t){return t.join("")}var qI=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:gy(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(l=>({namespace:l}))}async createNamespace(t,e){const s={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:s})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${gy(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gy(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${gy(t.namespace)}`}),!0}catch(e){if(e instanceof Fm&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(s){if(s instanceof Fm&&s.status===409)return;throw s}}};function Uf(t){return t.join("")}var HI=class{constructor(t,e="",s){this.client=t,this.prefix=e,this.accessDelegation=s}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables`,body:e,headers:s})).data.metadata}async updateTable(t,e){const s=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":s.data["metadata-location"],metadata:s.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(s){if(s instanceof Fm&&s.status===404)return!1;throw s}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(s){if(s instanceof Fm&&s.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw s}}},ZI=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const s=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=VI({baseUrl:s,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new qI(this.client,e),this.tableOps=new HI(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},d_=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function sr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var GI=class extends d_{constructor(t,e,s){super(t),this.name="StorageApiError",this.status=e,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Yv=class extends d_{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Bx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),WI=()=>Response,Xv=t=>{if(Array.isArray(t))return t.map(s=>Xv(s));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([s,l])=>{const f=s.replace(/([-_][a-z])/gi,_=>_.toUpperCase().replace(/[-_]/g,""));e[f]=Xv(l)}),e},YI=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},XI=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Vm(t){"@babel/helpers - typeof";return Vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vm(t)}function KI(t,e){if(Vm(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var l=s.call(t,e);if(Vm(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JI(t){var e=KI(t,"string");return Vm(e)=="symbol"?e:e+""}function QI(t,e,s){return(e=JI(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function U0(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),s.push.apply(s,l)}return s}function Vi(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?U0(Object(s),!0).forEach(function(l){QI(t,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):U0(Object(s)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(s,l))})}return t}const ov=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},ej=async(t,e,s)=>{t instanceof await WI()&&!s?.noResolveJson?t.json().then(l=>{const f=t.status||500,_=l?.statusCode||f+"";e(new GI(ov(l),f,_))}).catch(l=>{e(new Yv(ov(l),l))}):e(new Yv(ov(t),t))},tj=(t,e,s,l)=>{const f={method:t,headers:e?.headers||{}};return t==="GET"||!l?f:(YI(l)?(f.headers=Vi({"Content-Type":"application/json"},e?.headers),f.body=JSON.stringify(l)):f.body=l,e?.duplex&&(f.duplex=e.duplex),Vi(Vi({},f),s))};async function eg(t,e,s,l,f,_){return new Promise((y,d)=>{t(s,tj(e,l,f,_)).then(A=>{if(!A.ok)throw A;return l?.noResolveJson?A:A.json()}).then(A=>y(A)).catch(A=>ej(A,d,l))})}async function qm(t,e,s,l){return eg(t,"GET",e,s,l)}async function kc(t,e,s,l,f){return eg(t,"POST",e,l,f,s)}async function Kv(t,e,s,l,f){return eg(t,"PUT",e,l,f,s)}async function ij(t,e,s,l){return eg(t,"HEAD",e,Vi(Vi({},s),{},{noResolveJson:!0}),l)}async function $x(t,e,s,l,f){return eg(t,"DELETE",e,l,f,s)}var nj=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(sr(e))return{data:null,error:e};throw e}}};let RS;RS=Symbol.toStringTag;var sj=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[RS]="BlobDownloadBuilder",this.promise=null}asStream(){return new nj(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(sr(e))return{data:null,error:e};throw e}}};const rj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},F0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var aj=class{constructor(t,e={},s,l){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=s,this.fetch=Bx(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,s,l){var f=this;try{let _;const y=Vi(Vi({},F0),l);let d=Vi(Vi({},f.headers),t==="POST"&&{"x-upsert":String(y.upsert)});const A=y.metadata;typeof Blob<"u"&&s instanceof Blob?(_=new FormData,_.append("cacheControl",y.cacheControl),A&&_.append("metadata",f.encodeMetadata(A)),_.append("",s)):typeof FormData<"u"&&s instanceof FormData?(_=s,_.has("cacheControl")||_.append("cacheControl",y.cacheControl),A&&!_.has("metadata")&&_.append("metadata",f.encodeMetadata(A))):(_=s,d["cache-control"]=`max-age=${y.cacheControl}`,d["content-type"]=y.contentType,A&&(d["x-metadata"]=f.toBase64(f.encodeMetadata(A))),(typeof ReadableStream<"u"&&_ instanceof ReadableStream||_&&typeof _=="object"&&"pipe"in _&&typeof _.pipe=="function")&&!y.duplex&&(y.duplex="half")),l?.headers&&(d=Vi(Vi({},d),l.headers));const I=f._removeEmptyFolders(e),B=f._getFinalPath(I),N=await(t=="PUT"?Kv:kc)(f.fetch,`${f.url}/object/${B}`,_,Vi({headers:d},y?.duplex?{duplex:y.duplex}:{}));return{data:{path:I,id:N.Id,fullPath:N.Key},error:null}}catch(_){if(f.shouldThrowOnError)throw _;if(sr(_))return{data:null,error:_};throw _}}async upload(t,e,s){return this.uploadOrUpdate("POST",t,e,s)}async uploadToSignedUrl(t,e,s,l){var f=this;const _=f._removeEmptyFolders(t),y=f._getFinalPath(_),d=new URL(f.url+`/object/upload/sign/${y}`);d.searchParams.set("token",e);try{let A;const I=Vi({upsert:F0.upsert},l),B=Vi(Vi({},f.headers),{"x-upsert":String(I.upsert)});return typeof Blob<"u"&&s instanceof Blob?(A=new FormData,A.append("cacheControl",I.cacheControl),A.append("",s)):typeof FormData<"u"&&s instanceof FormData?(A=s,A.append("cacheControl",I.cacheControl)):(A=s,B["cache-control"]=`max-age=${I.cacheControl}`,B["content-type"]=I.contentType),{data:{path:_,fullPath:(await Kv(f.fetch,d.toString(),A,{headers:B})).Key},error:null}}catch(A){if(f.shouldThrowOnError)throw A;if(sr(A))return{data:null,error:A};throw A}}async createSignedUploadUrl(t,e){var s=this;try{let l=s._getFinalPath(t);const f=Vi({},s.headers);e?.upsert&&(f["x-upsert"]="true");const _=await kc(s.fetch,`${s.url}/object/upload/sign/${l}`,{},{headers:f}),y=new URL(s.url+_.url),d=y.searchParams.get("token");if(!d)throw new d_("No token returned by API");return{data:{signedUrl:y.toString(),path:t,token:d},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(sr(l))return{data:null,error:l};throw l}}async update(t,e,s){return this.uploadOrUpdate("PUT",t,e,s)}async move(t,e,s){var l=this;try{return{data:await kc(l.fetch,`${l.url}/object/move`,{bucketId:l.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s?.destinationBucket},{headers:l.headers}),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(sr(f))return{data:null,error:f};throw f}}async copy(t,e,s){var l=this;try{return{data:{path:(await kc(l.fetch,`${l.url}/object/copy`,{bucketId:l.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s?.destinationBucket},{headers:l.headers})).Key},error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(sr(f))return{data:null,error:f};throw f}}async createSignedUrl(t,e,s){var l=this;try{let f=l._getFinalPath(t),_=await kc(l.fetch,`${l.url}/object/sign/${f}`,Vi({expiresIn:e},s?.transform?{transform:s.transform}:{}),{headers:l.headers});const y=s?.download?`&download=${s.download===!0?"":s.download}`:"";return _={signedUrl:encodeURI(`${l.url}${_.signedURL}${y}`)},{data:_,error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(sr(f))return{data:null,error:f};throw f}}async createSignedUrls(t,e,s){var l=this;try{const f=await kc(l.fetch,`${l.url}/object/sign/${l.bucketId}`,{expiresIn:e,paths:t},{headers:l.headers}),_=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:f.map(y=>Vi(Vi({},y),{},{signedUrl:y.signedURL?encodeURI(`${l.url}${y.signedURL}${_}`):null})),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(sr(f))return{data:null,error:f};throw f}}download(t,e){const s=typeof e?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(e?.transform||{}),f=l?`?${l}`:"",_=this._getFinalPath(t),y=()=>qm(this.fetch,`${this.url}/${s}/${_}${f}`,{headers:this.headers,noResolveJson:!0});return new sj(y,this.shouldThrowOnError)}async info(t){var e=this;const s=e._getFinalPath(t);try{return{data:Xv(await qm(e.fetch,`${e.url}/object/info/${s}`,{headers:e.headers})),error:null}}catch(l){if(e.shouldThrowOnError)throw l;if(sr(l))return{data:null,error:l};throw l}}async exists(t){var e=this;const s=e._getFinalPath(t);try{return await ij(e.fetch,`${e.url}/object/${s}`,{headers:e.headers}),{data:!0,error:null}}catch(l){if(e.shouldThrowOnError)throw l;if(sr(l)&&l instanceof Yv){const f=l.originalError;if([400,404].includes(f?.status))return{data:!1,error:l}}throw l}}getPublicUrl(t,e){const s=this._getFinalPath(t),l=[],f=e?.download?`download=${e.download===!0?"":e.download}`:"";f!==""&&l.push(f);const _=typeof e?.transform<"u"?"render/image":"object",y=this.transformOptsToQueryString(e?.transform||{});y!==""&&l.push(y);let d=l.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${_}/public/${s}${d}`)}}}async remove(t){var e=this;try{return{data:await $x(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}async list(t,e,s){var l=this;try{const f=Vi(Vi(Vi({},rj),e),{},{prefix:t||""});return{data:await kc(l.fetch,`${l.url}/object/list/${l.bucketId}`,f,{headers:l.headers},s),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(sr(f))return{data:null,error:f};throw f}}async listV2(t,e){var s=this;try{const l=Vi({},t);return{data:await kc(s.fetch,`${s.url}/object/list-v2/${s.bucketId}`,l,{headers:s.headers},e),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(sr(l))return{data:null,error:l};throw l}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const zS="2.90.1",DS={"X-Client-Info":`storage-js/${zS}`};var oj=class{constructor(t,e={},s,l){this.shouldThrowOnError=!1;const f=new URL(t);l?.useNewHostname&&/supabase\.(co|in|red)$/.test(f.hostname)&&!f.hostname.includes("storage.supabase.")&&(f.hostname=f.hostname.replace("supabase.","storage.supabase.")),this.url=f.href.replace(/\/$/,""),this.headers=Vi(Vi({},DS),e),this.fetch=Bx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const s=e.listBucketOptionsToQueryString(t);return{data:await qm(e.fetch,`${e.url}/bucket${s}`,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}async getBucket(t){var e=this;try{return{data:await qm(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}async createBucket(t,e={public:!1}){var s=this;try{return{data:await kc(s.fetch,`${s.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(sr(l))return{data:null,error:l};throw l}}async updateBucket(t,e){var s=this;try{return{data:await Kv(s.fetch,`${s.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(sr(l))return{data:null,error:l};throw l}}async emptyBucket(t){var e=this;try{return{data:await kc(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}async deleteBucket(t){var e=this;try{return{data:await $x(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},lj=class{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Vi(Vi({},DS),e),this.fetch=Bx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await kc(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}async listBuckets(t){var e=this;try{const s=new URLSearchParams;t?.limit!==void 0&&s.set("limit",t.limit.toString()),t?.offset!==void 0&&s.set("offset",t.offset.toString()),t?.sortColumn&&s.set("sortColumn",t.sortColumn),t?.sortOrder&&s.set("sortOrder",t.sortOrder),t?.search&&s.set("search",t.search);const l=s.toString(),f=l?`${e.url}/bucket?${l}`:`${e.url}/bucket`;return{data:await qm(e.fetch,f,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}async deleteBucket(t){var e=this;try{return{data:await $x(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s))return{data:null,error:s};throw s}}from(t){var e=this;if(!XI(t))throw new d_("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const s=new ZI({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),l=this.shouldThrowOnError;return new Proxy(s,{get(f,_){const y=f[_];return typeof y!="function"?y:async(...d)=>{try{return{data:await y.apply(f,d),error:null}}catch(A){if(l)throw A;return{data:null,error:A}}}}})}};const Ux={"X-Client-Info":`storage-js/${zS}`,"Content-Type":"application/json"};var OS=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Cl(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var lv=class extends OS{constructor(t,e,s){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},cj=class extends OS{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Fx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),uj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},V0=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),hj=async(t,e,s)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!s?.noResolveJson){const l=t.status||500,f=t;if(typeof f.json=="function")f.json().then(_=>{const y=_?.statusCode||_?.code||l+"";e(new lv(V0(_),l,y))}).catch(()=>{const _=l+"";e(new lv(f.statusText||`HTTP ${l} error`,l,_))});else{const _=l+"";e(new lv(f.statusText||`HTTP ${l} error`,l,_))}}else e(new cj(V0(t),t))},dj=(t,e,s,l)=>{const f={method:t,headers:e?.headers||{}};return l?(uj(l)?(f.headers=Vi({"Content-Type":"application/json"},e?.headers),f.body=JSON.stringify(l)):f.body=l,Vi(Vi({},f),s)):f};async function fj(t,e,s,l,f,_){return new Promise((y,d)=>{t(s,dj(e,l,f,_)).then(A=>{if(!A.ok)throw A;if(l?.noResolveJson)return A;const I=A.headers.get("content-type");return!I||!I.includes("application/json")?{}:A.json()}).then(A=>y(A)).catch(A=>hj(A,d,l))})}async function Al(t,e,s,l,f){return fj(t,"POST",e,l,f,s)}var pj=class{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Vi(Vi({},Ux),e),this.fetch=Fx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async getIndex(t,e){var s=this;try{return{data:await Al(s.fetch,`${s.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Cl(l))return{data:null,error:l};throw l}}async listIndexes(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async deleteIndex(t,e){var s=this;try{return{data:await Al(s.fetch,`${s.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:s.headers})||{},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Cl(l))return{data:null,error:l};throw l}}},mj=class{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Vi(Vi({},Ux),e),this.fetch=Fx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Al(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async getVectors(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Al(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async queryVectors(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Al(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}},gj=class{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Vi(Vi({},Ux),e),this.fetch=Fx(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async getBucket(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async listBuckets(t={}){var e=this;try{return{data:await Al(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}async deleteBucket(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Cl(s))return{data:null,error:s};throw s}}},yj=class extends gj{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new _j(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,s=this;return e().call(s,t)}async getBucket(t){var e=()=>super.getBucket,s=this;return e().call(s,t)}async listBuckets(t={}){var e=()=>super.listBuckets,s=this;return e().call(s,t)}async deleteBucket(t){var e=()=>super.deleteBucket,s=this;return e().call(s,t)}},_j=class extends pj{constructor(t,e,s,l){super(t,e,l),this.vectorBucketName=s}async createIndex(t){var e=()=>super.createIndex,s=this;return e().call(s,Vi(Vi({},t),{},{vectorBucketName:s.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,s=this;return e().call(s,Vi(Vi({},t),{},{vectorBucketName:s.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,s=this;return e().call(s,s.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,s=this;return e().call(s,s.vectorBucketName,t)}index(t){return new vj(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},vj=class extends mj{constructor(t,e,s,l,f){super(t,e,f),this.vectorBucketName=s,this.indexName=l}async putVectors(t){var e=()=>super.putVectors,s=this;return e().call(s,Vi(Vi({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async getVectors(t){var e=()=>super.getVectors,s=this;return e().call(s,Vi(Vi({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,s=this;return e().call(s,Vi(Vi({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,s=this;return e().call(s,Vi(Vi({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,s=this;return e().call(s,Vi(Vi({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}},xj=class extends oj{constructor(t,e={},s,l){super(t,e,s,l)}from(t){return new aj(this.url,this.headers,t,this.fetch)}get vectors(){return new yj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new lj(this.url+"/iceberg",this.headers,this.fetch)}};const NS="2.90.1",Jf=30*1e3,Jv=3,cv=Jv*Jf,bj="http://localhost:9999",wj="supabase.auth.token",Sj={"X-Client-Info":`gotrue-js/${NS}`},Qv="X-Supabase-Api-Version",BS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Tj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ej=600*1e3;class Hm extends Error{constructor(e,s,l){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function Ai(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class kj extends Hm{constructor(e,s,l){super(e,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function Cj(t){return Ai(t)&&t.name==="AuthApiError"}class Hd extends Hm{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class Ju extends Hm{constructor(e,s,l,f){super(e,l,f),this.name=s,this.status=l}}class kl extends Ju{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Aj(t){return Ai(t)&&t.name==="AuthSessionMissingError"}class Ff extends Ju{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class yy extends Ju{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class _y extends Ju{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Mj(t){return Ai(t)&&t.name==="AuthImplicitGrantRedirectError"}class q0 extends Ju{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pj extends Ju{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ex extends Ju{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function uv(t){return Ai(t)&&t.name==="AuthRetryableFetchError"}class H0 extends Ju{constructor(e,s,l){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class tx extends Ju{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ky="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Z0=` 	
\r=`.split(""),Ij=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Z0.length;e+=1)t[Z0[e].charCodeAt(0)]=-2;for(let e=0;e<Ky.length;e+=1)t[Ky[e].charCodeAt(0)]=e;return t})();function G0(t,e,s){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const l=e.queue>>e.queuedBits-6&63;s(Ky[l]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const l=e.queue>>e.queuedBits-6&63;s(Ky[l]),e.queuedBits-=6}}function $S(t,e,s){const l=Ij[t];if(l>-1)for(e.queue=e.queue<<6|l,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function W0(t){const e=[],s=y=>{e.push(String.fromCodePoint(y))},l={utf8seq:0,codepoint:0},f={queue:0,queuedBits:0},_=y=>{Rj(y,l,s)};for(let y=0;y<t.length;y+=1)$S(t.charCodeAt(y),f,_);return e.join("")}function jj(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Lj(t,e){for(let s=0;s<t.length;s+=1){let l=t.charCodeAt(s);if(l>55295&&l<=56319){const f=(l-55296)*1024&65535;l=(t.charCodeAt(s+1)-56320&65535|f)+65536,s+=1}jj(l,e)}}function Rj(t,e,s){if(e.utf8seq===0){if(t<=127){s(t);return}for(let l=1;l<6;l+=1)if((t>>7-l&1)===0){e.utf8seq=l;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function cp(t){const e=[],s={queue:0,queuedBits:0},l=f=>{e.push(f)};for(let f=0;f<t.length;f+=1)$S(t.charCodeAt(f),s,l);return new Uint8Array(e)}function zj(t){const e=[];return Lj(t,s=>e.push(s)),new Uint8Array(e)}function Gd(t){const e=[],s={queue:0,queuedBits:0},l=f=>{e.push(f)};return t.forEach(f=>G0(f,s,l)),G0(null,s,l),e.join("")}function Dj(t){return Math.round(Date.now()/1e3)+t}function Oj(){return Symbol("auth-callback")}const za=()=>typeof window<"u"&&typeof document<"u",Ud={tested:!1,writable:!1},US=()=>{if(!za())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ud.tested)return Ud.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ud.tested=!0,Ud.writable=!0}catch{Ud.tested=!0,Ud.writable=!1}return Ud.writable};function Nj(t){const e={},s=new URL(t);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((f,_)=>{e[_]=f})}catch{}return s.searchParams.forEach((l,f)=>{e[f]=l}),e}const FS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Bj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Qf=async(t,e,s)=>{await t.setItem(e,JSON.stringify(s))},Fd=async(t,e)=>{const s=await t.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Ra=async(t,e)=>{await t.removeItem(e)};class f_{constructor(){this.promise=new f_.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}f_.promiseConstructor=Promise;function hv(t){const e=t.split(".");if(e.length!==3)throw new tx("Invalid JWT structure");for(let l=0;l<e.length;l++)if(!Tj.test(e[l]))throw new tx("JWT not in base64url format");return{header:JSON.parse(W0(e[0])),payload:JSON.parse(W0(e[1])),signature:cp(e[2]),raw:{header:e[0],payload:e[1]}}}async function $j(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Uj(t,e){return new Promise((l,f)=>{(async()=>{for(let _=0;_<1/0;_++)try{const y=await t(_);if(!e(_,null,y)){l(y);return}}catch(y){if(!e(_,y)){f(y);return}}})()})}function Fj(t){return("0"+t.toString(16)).substr(-2)}function Vj(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let f="";for(let _=0;_<56;_++)f+=s.charAt(Math.floor(Math.random()*l));return f}return crypto.getRandomValues(e),Array.from(e,Fj).join("")}async function qj(t){const s=new TextEncoder().encode(t),l=await crypto.subtle.digest("SHA-256",s),f=new Uint8Array(l);return Array.from(f).map(_=>String.fromCharCode(_)).join("")}async function Hj(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const s=await qj(t);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vf(t,e,s=!1){const l=Vj();let f=l;s&&(f+="/PASSWORD_RECOVERY"),await Qf(t,`${e}-code-verifier`,f);const _=await Hj(l);return[_,l===_?"plain":"s256"]}const Zj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Gj(t){const e=t.headers.get(Qv);if(!e||!e.match(Zj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Wj(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Yj(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Xj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qf(t){if(!Xj.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dv(){const t={};return new Proxy(t,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Kj(t,e){return new Proxy(t,{get:(s,l,f)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const _=l.toString();if(_==="Symbol(Symbol.toPrimitive)"||_==="Symbol(Symbol.toStringTag)"||_==="Symbol(util.inspect.custom)"||_==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,f)}return!e.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(s,l,f)}})}function Y0(t){return JSON.parse(JSON.stringify(t))}const Vd=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Jj=[502,503,504];async function X0(t){var e;if(!Bj(t))throw new ex(Vd(t),0);if(Jj.includes(t.status))throw new ex(Vd(t),t.status);let s;try{s=await t.json()}catch(_){throw new Hd(Vd(_),_)}let l;const f=Gj(t);if(f&&f.getTime()>=BS["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new H0(Vd(s),t.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(l==="session_not_found")throw new kl}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((_,y)=>_&&typeof y=="string",!0))throw new H0(Vd(s),t.status,s.weak_password.reasons);throw new kj(Vd(s),t.status||500,l)}const Qj=(t,e,s,l)=>{const f={method:t,headers:e?.headers||{}};return t==="GET"?f:(f.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),f.body=JSON.stringify(l),Object.assign(Object.assign({},f),s))};async function Fi(t,e,s,l){var f;const _=Object.assign({},l?.headers);_[Qv]||(_[Qv]=BS["2024-01-01"].name),l?.jwt&&(_.Authorization=`Bearer ${l.jwt}`);const y=(f=l?.query)!==null&&f!==void 0?f:{};l?.redirectTo&&(y.redirect_to=l.redirectTo);const d=Object.keys(y).length?"?"+new URLSearchParams(y).toString():"",A=await eL(t,e,s+d,{headers:_,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(A):{data:Object.assign({},A),error:null}}async function eL(t,e,s,l,f,_){const y=Qj(e,l,f,_);let d;try{d=await t(s,Object.assign({},y))}catch(A){throw console.error(A),new ex(Vd(A),0)}if(d.ok||await X0(d),l?.noResolveJson)return d;try{return await d.json()}catch(A){await X0(A)}}function Tc(t){var e;let s=null;nL(t)&&(s=Object.assign({},t),t.expires_at||(s.expires_at=Dj(t.expires_in)));const l=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:s,user:l},error:null}}function K0(t){const e=Tc(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Fh(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function tL(t){return{data:t,error:null}}function iL(t){const{action_link:e,email_otp:s,hashed_token:l,redirect_to:f,verification_type:_}=t,y=Xu(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:s,hashed_token:l,redirect_to:f,verification_type:_},A=Object.assign({},y);return{data:{properties:d,user:A},error:null}}function J0(t){return t}function nL(t){return t.access_token&&t.refresh_token&&t.expires_in}const fv=["global","local","others"];class sL{constructor({url:e="",headers:s={},fetch:l}){this.url=e,this.headers=s,this.fetch=FS(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,s=fv[0]){if(fv.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fv.join(", ")}`);try{return await Fi(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Ai(l))return{data:null,error:l};throw l}}async inviteUserByEmail(e,s={}){try{return await Fi(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Fh})}catch(l){if(Ai(l))return{data:{user:null},error:l};throw l}}async generateLink(e){try{const{options:s}=e,l=Xu(e,["options"]),f=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(f.new_email=l?.newEmail,delete f.newEmail),await Fi(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:f,headers:this.headers,xform:iL,redirectTo:s?.redirectTo})}catch(s){if(Ai(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await Fi(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fh})}catch(s){if(Ai(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,l,f,_,y,d,A;try{const I={nextPage:null,lastPage:0,total:0},B=await Fi(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=e?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(_=(f=e?.perPage)===null||f===void 0?void 0:f.toString())!==null&&_!==void 0?_:""},xform:J0});if(B.error)throw B.error;const N=await B.json(),V=(y=B.headers.get("x-total-count"))!==null&&y!==void 0?y:0,K=(A=(d=B.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&A!==void 0?A:[];return K.length>0&&(K.forEach(se=>{const ne=parseInt(se.split(";")[0].split("=")[1].substring(0,1)),ve=JSON.parse(se.split(";")[1].split("=")[1]);I[`${ve}Page`]=ne}),I.total=parseInt(V)),{data:Object.assign(Object.assign({},N),I),error:null}}catch(I){if(Ai(I))return{data:{users:[]},error:I};throw I}}async getUserById(e){qf(e);try{return await Fi(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fh})}catch(s){if(Ai(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){qf(e);try{return await Fi(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:Fh})}catch(l){if(Ai(l))return{data:{user:null},error:l};throw l}}async deleteUser(e,s=!1){qf(e);try{return await Fi(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:Fh})}catch(l){if(Ai(l))return{data:{user:null},error:l};throw l}}async _listFactors(e){qf(e.userId);try{const{data:s,error:l}=await Fi(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:f=>({data:{factors:f},error:null})});return{data:s,error:l}}catch(s){if(Ai(s))return{data:null,error:s};throw s}}async _deleteFactor(e){qf(e.userId),qf(e.id);try{return{data:await Fi(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(Ai(s))return{data:null,error:s};throw s}}async _listOAuthClients(e){var s,l,f,_,y,d,A;try{const I={nextPage:null,lastPage:0,total:0},B=await Fi(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=e?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(_=(f=e?.perPage)===null||f===void 0?void 0:f.toString())!==null&&_!==void 0?_:""},xform:J0});if(B.error)throw B.error;const N=await B.json(),V=(y=B.headers.get("x-total-count"))!==null&&y!==void 0?y:0,K=(A=(d=B.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&A!==void 0?A:[];return K.length>0&&(K.forEach(se=>{const ne=parseInt(se.split(";")[0].split("=")[1].substring(0,1)),ve=JSON.parse(se.split(";")[1].split("=")[1]);I[`${ve}Page`]=ne}),I.total=parseInt(V)),{data:Object.assign(Object.assign({},N),I),error:null}}catch(I){if(Ai(I))return{data:{clients:[]},error:I};throw I}}async _createOAuthClient(e){try{return await Fi(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ai(s))return{data:null,error:s};throw s}}async _getOAuthClient(e){try{return await Fi(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ai(s))return{data:null,error:s};throw s}}async _updateOAuthClient(e,s){try{return await Fi(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Ai(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(e){try{return await Fi(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ai(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(e){try{return await Fi(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ai(s))return{data:null,error:s};throw s}}}function Q0(t={}){return{getItem:e=>t[e]||null,setItem:(e,s)=>{t[e]=s},removeItem:e=>{delete t[e]}}}const Hf={debug:!!(globalThis&&US()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class VS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class rL extends VS{}async function aL(t,e,s){Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const l=new globalThis.AbortController;return e>0&&setTimeout(()=>{l.abort(),Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async f=>{if(f){Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,f.name);try{return await s()}finally{Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,f.name)}}else{if(e===0)throw Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new rL(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Hf.debug)try{const _=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(_,null,"  "))}catch(_){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",_)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function oL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function qS(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function lL(t){return parseInt(t,16)}function cL(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,l=>l.toString(16).padStart(2,"0")).join("")}function uL(t){var e;const{chainId:s,domain:l,expirationTime:f,issuedAt:_=new Date,nonce:y,notBefore:d,requestId:A,resources:I,scheme:B,uri:N,version:V}=t;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(y&&y.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${y}`);if(!N)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(V!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${V}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const K=qS(t.address),se=B?`${B}://${l}`:l,ne=t.statement?`${t.statement}
`:"",ve=`${se} wants you to sign in with your Ethereum account:
${K}

${ne}`;let re=`URI: ${N}
Version: ${V}
Chain ID: ${s}${y?`
Nonce: ${y}`:""}
Issued At: ${_.toISOString()}`;if(f&&(re+=`
Expiration Time: ${f.toISOString()}`),d&&(re+=`
Not Before: ${d.toISOString()}`),A&&(re+=`
Request ID: ${A}`),I){let ge=`
Resources:`;for(const oe of I){if(!oe||typeof oe!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${oe}`);ge+=`
- ${oe}`}re+=ge}return`${ve}
${re}`}class Ur extends Error{constructor({message:e,code:s,cause:l,name:f}){var _;super(e,{cause:l}),this.__isWebAuthnError=!0,this.name=(_=f??(l instanceof Error?l.name:void 0))!==null&&_!==void 0?_:"Unknown Error",this.code=s}}class Jy extends Ur{constructor(e,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:e}),this.name="WebAuthnUnknownError",this.originalError=s}}function hL({error:t,options:e}){var s,l,f;const{publicKey:_}=e;if(!_)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ur({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((s=_.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Ur({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((l=_.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Ur({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((f=_.authenticatorSelection)===null||f===void 0?void 0:f.userVerification)==="required")return new Ur({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Ur({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Ur({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return _.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Ur({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Ur({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const y=window.location.hostname;if(HS(y)){if(_.rp.id!==y)return new Ur({message:`The RP ID "${_.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ur({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(_.user.id.byteLength<1||_.user.id.byteLength>64)return new Ur({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Ur({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ur({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function dL({error:t,options:e}){const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ur({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Ur({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(HS(l)){if(s.rpId!==l)return new Ur({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ur({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Ur({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ur({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class fL{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const pL=new fL;function mL(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:s,excludeCredentials:l}=t,f=Xu(t,["challenge","user","excludeCredentials"]),_=cp(e).buffer,y=Object.assign(Object.assign({},s),{id:cp(s.id).buffer}),d=Object.assign(Object.assign({},f),{challenge:_,user:y});if(l&&l.length>0){d.excludeCredentials=new Array(l.length);for(let A=0;A<l.length;A++){const I=l[A];d.excludeCredentials[A]=Object.assign(Object.assign({},I),{id:cp(I.id).buffer,type:I.type||"public-key",transports:I.transports})}}return d}function gL(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:s}=t,l=Xu(t,["challenge","allowCredentials"]),f=cp(e).buffer,_=Object.assign(Object.assign({},l),{challenge:f});if(s&&s.length>0){_.allowCredentials=new Array(s.length);for(let y=0;y<s.length;y++){const d=s[y];_.allowCredentials[y]=Object.assign(Object.assign({},d),{id:cp(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return _}function yL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const s=t;return{id:t.id,rawId:t.id,response:{attestationObject:Gd(new Uint8Array(t.response.attestationObject)),clientDataJSON:Gd(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=s.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function _L(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const s=t,l=t.getClientExtensionResults(),f=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Gd(new Uint8Array(f.authenticatorData)),clientDataJSON:Gd(new Uint8Array(f.clientDataJSON)),signature:Gd(new Uint8Array(f.signature)),userHandle:f.userHandle?Gd(new Uint8Array(f.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(e=s.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function HS(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function ew(){var t,e;return!!(za()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function vL(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Jy("Browser returned unexpected credential type",e)}:{data:null,error:new Jy("Empty credential response",e)}}catch(e){return{data:null,error:hL({error:e,options:t})}}}async function xL(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Jy("Browser returned unexpected credential type",e)}:{data:null,error:new Jy("Empty credential response",e)}}catch(e){return{data:null,error:dL({error:e,options:t})}}}const bL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},wL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Qy(...t){const e=f=>f!==null&&typeof f=="object"&&!Array.isArray(f),s=f=>f instanceof ArrayBuffer||ArrayBuffer.isView(f),l={};for(const f of t)if(f)for(const _ in f){const y=f[_];if(y!==void 0)if(Array.isArray(y))l[_]=y;else if(s(y))l[_]=y;else if(e(y)){const d=l[_];e(d)?l[_]=Qy(d,y):l[_]=Qy(y)}else l[_]=y}return l}function SL(t,e){return Qy(bL,t,e||{})}function TL(t,e){return Qy(wL,t,e||{})}class EL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:s,friendlyName:l,signal:f},_){try{const{data:y,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:s});if(!y)return{data:null,error:d};const A=f??pL.createNewAbortSignal();if(y.webauthn.type==="create"){const{user:I}=y.webauthn.credential_options.publicKey;I.name||(I.name=`${I.id}:${l}`),I.displayName||(I.displayName=I.name)}switch(y.webauthn.type){case"create":{const I=SL(y.webauthn.credential_options.publicKey,_?.create),{data:B,error:N}=await vL({publicKey:I,signal:A});return B?{data:{factorId:e,challengeId:y.id,webauthn:{type:y.webauthn.type,credential_response:B}},error:null}:{data:null,error:N}}case"request":{const I=TL(y.webauthn.credential_options.publicKey,_?.request),{data:B,error:N}=await xL(Object.assign(Object.assign({},y.webauthn.credential_options),{publicKey:I,signal:A}));return B?{data:{factorId:e,challengeId:y.id,webauthn:{type:y.webauthn.type,credential_response:B}},error:null}:{data:null,error:N}}}}catch(y){return Ai(y)?{data:null,error:y}:{data:null,error:new Hd("Unexpected error in challenge",y)}}}async _verify({challengeId:e,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:e,webauthn:l})}async _authenticate({factorId:e,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:f}={}},_){if(!s)return{data:null,error:new Hm("rpId is required for WebAuthn authentication")};try{if(!ew())return{data:null,error:new Hd("Browser does not support WebAuthn",null)};const{data:y,error:d}=await this.challenge({factorId:e,webauthn:{rpId:s,rpOrigins:l},signal:f},{request:_});if(!y)return{data:null,error:d};const{webauthn:A}=y;return this._verify({factorId:e,challengeId:y.challengeId,webauthn:{type:A.type,rpId:s,rpOrigins:l,credential_response:A.credential_response}})}catch(y){return Ai(y)?{data:null,error:y}:{data:null,error:new Hd("Unexpected error in authenticate",y)}}}async _register({friendlyName:e,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:f}={}},_){if(!s)return{data:null,error:new Hm("rpId is required for WebAuthn registration")};try{if(!ew())return{data:null,error:new Hd("Browser does not support WebAuthn",null)};const{data:y,error:d}=await this._enroll({friendlyName:e});if(!y)return await this.client.mfa.listFactors().then(B=>{var N;return(N=B.data)===null||N===void 0?void 0:N.all.find(V=>V.factor_type==="webauthn"&&V.friendly_name===e&&V.status!=="unverified")}).then(B=>B?this.client.mfa.unenroll({factorId:B?.id}):void 0),{data:null,error:d};const{data:A,error:I}=await this._challenge({factorId:y.id,friendlyName:y.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:f},{create:_});return A?this._verify({factorId:y.id,challengeId:A.challengeId,webauthn:{rpId:s,rpOrigins:l,type:A.webauthn.type,credential_response:A.webauthn.credential_response}}):{data:null,error:I}}catch(y){return Ai(y)?{data:null,error:y}:{data:null,error:new Hd("Unexpected error in register",y)}}}}oL();const kL={url:bj,storageKey:wj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Sj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function tw(t,e,s){return await s()}const Zf={};class Zm{get jwks(){var e,s;return(s=(e=Zf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){Zf[this.storageKey]=Object.assign(Object.assign({},Zf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=Zf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Zf[this.storageKey]=Object.assign(Object.assign({},Zf[this.storageKey]),{cachedAt:e})}constructor(e){var s,l,f;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const _=Object.assign(Object.assign({},kL),e);if(this.storageKey=_.storageKey,this.instanceID=(s=Zm.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,Zm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!_.debug,typeof _.debug=="function"&&(this.logger=_.debug),this.instanceID>0&&za()){const y=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(y),this.logDebugMessages&&console.trace(y)}if(this.persistSession=_.persistSession,this.autoRefreshToken=_.autoRefreshToken,this.admin=new sL({url:_.url,headers:_.headers,fetch:_.fetch}),this.url=_.url,this.headers=_.headers,this.fetch=FS(_.fetch),this.lock=_.lock||tw,this.detectSessionInUrl=_.detectSessionInUrl,this.flowType=_.flowType,this.hasCustomAuthorizationHeader=_.hasCustomAuthorizationHeader,this.throwOnError=_.throwOnError,this.lockAcquireTimeout=_.lockAcquireTimeout,_.lock?this.lock=_.lock:this.persistSession&&za()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=aL:this.lock=tw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new EL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(_.storage?this.storage=_.storage:US()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Q0(this.memoryStorage)),_.userStorage&&(this.userStorage=_.userStorage)):(this.memoryStorage={},this.storage=Q0(this.memoryStorage)),za()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(y){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",y)}(f=this.broadcastChannel)===null||f===void 0||f.addEventListener("message",async y=>{this._debug("received broadcast notification from other tab or client",y),await this._notifyAllSubscribers(y.data.event,y.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${NS}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let s={},l="none";if(za()&&(s=Nj(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),za()&&this.detectSessionInUrl&&l!=="none"){const{data:f,error:_}=await this._getSessionFromURL(s,l);if(_){if(this._debug("#_initialize()","error detecting session from URL",_),Mj(_)){const A=(e=_.details)===null||e===void 0?void 0:e.code;if(A==="identity_already_exists"||A==="identity_not_found"||A==="single_identity_not_deletable")return{error:_}}return{error:_}}const{session:y,redirectType:d}=f;return this._debug("#_initialize()","detected session in URL",y,"redirect type",d),await this._saveSession(y),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",y):await this._notifyAllSubscribers("SIGNED_IN",y)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return Ai(s)?this._returnResult({error:s}):this._returnResult({error:new Hd("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,l,f;try{const _=await Fi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=e?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(f=e?.options)===null||f===void 0?void 0:f.captchaToken}},xform:Tc}),{data:y,error:d}=_;if(d||!y)return this._returnResult({data:{user:null,session:null},error:d});const A=y.session,I=y.user;return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",A)),this._returnResult({data:{user:I,session:A},error:null})}catch(_){if(Ai(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signUp(e){var s,l,f;try{let _;if("email"in e){const{email:B,password:N,options:V}=e;let K=null,se=null;this.flowType==="pkce"&&([K,se]=await Vf(this.storage,this.storageKey)),_=await Fi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:V?.emailRedirectTo,body:{email:B,password:N,data:(s=V?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:V?.captchaToken},code_challenge:K,code_challenge_method:se},xform:Tc})}else if("phone"in e){const{phone:B,password:N,options:V}=e;_=await Fi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:B,password:N,data:(l=V?.data)!==null&&l!==void 0?l:{},channel:(f=V?.channel)!==null&&f!==void 0?f:"sms",gotrue_meta_security:{captcha_token:V?.captchaToken}},xform:Tc})}else throw new yy("You must provide either an email or phone number and a password");const{data:y,error:d}=_;if(d||!y)return await Ra(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const A=y.session,I=y.user;return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",A)),this._returnResult({data:{user:I,session:A},error:null})}catch(_){if(await Ra(this.storage,`${this.storageKey}-code-verifier`),Ai(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithPassword(e){try{let s;if("email"in e){const{email:_,password:y,options:d}=e;s=await Fi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:_,password:y,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:K0})}else if("phone"in e){const{phone:_,password:y,options:d}=e;s=await Fi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:_,password:y,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:K0})}else throw new yy("You must provide either an email or phone number and a password");const{data:l,error:f}=s;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!l||!l.session||!l.user){const _=new Ff;return this._returnResult({data:{user:null,session:null},error:_})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:f})}catch(s){if(Ai(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(e){var s,l,f,_;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:(_=e.options)===null||_===void 0?void 0:_.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;switch(s){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(e){var s,l,f,_,y,d,A,I,B,N,V;let K,se;if("message"in e)K=e.message,se=e.signature;else{const{chain:ne,wallet:ve,statement:re,options:ge}=e;let oe;if(za())if(typeof ve=="object")oe=ve;else{const He=window;if("ethereum"in He&&typeof He.ethereum=="object"&&"request"in He.ethereum&&typeof He.ethereum.request=="function")oe=He.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof ve!="object"||!ge?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");oe=ve}const me=new URL((s=ge?.url)!==null&&s!==void 0?s:window.location.href),ye=await oe.request({method:"eth_requestAccounts"}).then(He=>He).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ye||ye.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ke=qS(ye[0]);let Re=(l=ge?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!Re){const He=await oe.request({method:"eth_chainId"});Re=lL(He)}const Ge={domain:me.host,address:ke,statement:re,uri:me.href,version:"1",chainId:Re,nonce:(f=ge?.signInWithEthereum)===null||f===void 0?void 0:f.nonce,issuedAt:(y=(_=ge?.signInWithEthereum)===null||_===void 0?void 0:_.issuedAt)!==null&&y!==void 0?y:new Date,expirationTime:(d=ge?.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(A=ge?.signInWithEthereum)===null||A===void 0?void 0:A.notBefore,requestId:(I=ge?.signInWithEthereum)===null||I===void 0?void 0:I.requestId,resources:(B=ge?.signInWithEthereum)===null||B===void 0?void 0:B.resources};K=uL(Ge),se=await oe.request({method:"personal_sign",params:[cL(K),ke]})}try{const{data:ne,error:ve}=await Fi(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:K,signature:se},!((N=e.options)===null||N===void 0)&&N.captchaToken?{gotrue_meta_security:{captcha_token:(V=e.options)===null||V===void 0?void 0:V.captchaToken}}:null),xform:Tc});if(ve)throw ve;if(!ne||!ne.session||!ne.user){const re=new Ff;return this._returnResult({data:{user:null,session:null},error:re})}return ne.session&&(await this._saveSession(ne.session),await this._notifyAllSubscribers("SIGNED_IN",ne.session)),this._returnResult({data:Object.assign({},ne),error:ve})}catch(ne){if(Ai(ne))return this._returnResult({data:{user:null,session:null},error:ne});throw ne}}async signInWithSolana(e){var s,l,f,_,y,d,A,I,B,N,V,K;let se,ne;if("message"in e)se=e.message,ne=e.signature;else{const{chain:ve,wallet:re,statement:ge,options:oe}=e;let me;if(za())if(typeof re=="object")me=re;else{const ke=window;if("solana"in ke&&typeof ke.solana=="object"&&("signIn"in ke.solana&&typeof ke.solana.signIn=="function"||"signMessage"in ke.solana&&typeof ke.solana.signMessage=="function"))me=ke.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof re!="object"||!oe?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");me=re}const ye=new URL((s=oe?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in me&&me.signIn){const ke=await me.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},oe?.signInWithSolana),{version:"1",domain:ye.host,uri:ye.href}),ge?{statement:ge}:null));let Re;if(Array.isArray(ke)&&ke[0]&&typeof ke[0]=="object")Re=ke[0];else if(ke&&typeof ke=="object"&&"signedMessage"in ke&&"signature"in ke)Re=ke;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Re&&"signature"in Re&&(typeof Re.signedMessage=="string"||Re.signedMessage instanceof Uint8Array)&&Re.signature instanceof Uint8Array)se=typeof Re.signedMessage=="string"?Re.signedMessage:new TextDecoder().decode(Re.signedMessage),ne=Re.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in me)||typeof me.signMessage!="function"||!("publicKey"in me)||typeof me!="object"||!me.publicKey||!("toBase58"in me.publicKey)||typeof me.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");se=[`${ye.host} wants you to sign in with your Solana account:`,me.publicKey.toBase58(),...ge?["",ge,""]:[""],"Version: 1",`URI: ${ye.href}`,`Issued At: ${(f=(l=oe?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date().toISOString()}`,...!((_=oe?.signInWithSolana)===null||_===void 0)&&_.notBefore?[`Not Before: ${oe.signInWithSolana.notBefore}`]:[],...!((y=oe?.signInWithSolana)===null||y===void 0)&&y.expirationTime?[`Expiration Time: ${oe.signInWithSolana.expirationTime}`]:[],...!((d=oe?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${oe.signInWithSolana.chainId}`]:[],...!((A=oe?.signInWithSolana)===null||A===void 0)&&A.nonce?[`Nonce: ${oe.signInWithSolana.nonce}`]:[],...!((I=oe?.signInWithSolana)===null||I===void 0)&&I.requestId?[`Request ID: ${oe.signInWithSolana.requestId}`]:[],...!((N=(B=oe?.signInWithSolana)===null||B===void 0?void 0:B.resources)===null||N===void 0)&&N.length?["Resources",...oe.signInWithSolana.resources.map(Re=>`- ${Re}`)]:[]].join(`
`);const ke=await me.signMessage(new TextEncoder().encode(se),"utf8");if(!ke||!(ke instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");ne=ke}}try{const{data:ve,error:re}=await Fi(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:se,signature:Gd(ne)},!((V=e.options)===null||V===void 0)&&V.captchaToken?{gotrue_meta_security:{captcha_token:(K=e.options)===null||K===void 0?void 0:K.captchaToken}}:null),xform:Tc});if(re)throw re;if(!ve||!ve.session||!ve.user){const ge=new Ff;return this._returnResult({data:{user:null,session:null},error:ge})}return ve.session&&(await this._saveSession(ve.session),await this._notifyAllSubscribers("SIGNED_IN",ve.session)),this._returnResult({data:Object.assign({},ve),error:re})}catch(ve){if(Ai(ve))return this._returnResult({data:{user:null,session:null},error:ve});throw ve}}async _exchangeCodeForSession(e){const s=await Fd(this.storage,`${this.storageKey}-code-verifier`),[l,f]=(s??"").split("/");try{if(!l&&this.flowType==="pkce")throw new Pj;const{data:_,error:y}=await Fi(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:l},xform:Tc});if(await Ra(this.storage,`${this.storageKey}-code-verifier`),y)throw y;if(!_||!_.session||!_.user){const d=new Ff;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign(Object.assign({},_),{redirectType:f??null}),error:y})}catch(_){if(await Ra(this.storage,`${this.storageKey}-code-verifier`),Ai(_))return this._returnResult({data:{user:null,session:null,redirectType:null},error:_});throw _}}async signInWithIdToken(e){try{const{options:s,provider:l,token:f,access_token:_,nonce:y}=e,d=await Fi(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:f,access_token:_,nonce:y,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Tc}),{data:A,error:I}=d;if(I)return this._returnResult({data:{user:null,session:null},error:I});if(!A||!A.session||!A.user){const B=new Ff;return this._returnResult({data:{user:null,session:null},error:B})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:A,error:I})}catch(s){if(Ai(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(e){var s,l,f,_,y;try{if("email"in e){const{email:d,options:A}=e;let I=null,B=null;this.flowType==="pkce"&&([I,B]=await Vf(this.storage,this.storageKey));const{error:N}=await Fi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(s=A?.data)!==null&&s!==void 0?s:{},create_user:(l=A?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:A?.captchaToken},code_challenge:I,code_challenge_method:B},redirectTo:A?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:N})}if("phone"in e){const{phone:d,options:A}=e,{data:I,error:B}=await Fi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(f=A?.data)!==null&&f!==void 0?f:{},create_user:(_=A?.shouldCreateUser)!==null&&_!==void 0?_:!0,gotrue_meta_security:{captcha_token:A?.captchaToken},channel:(y=A?.channel)!==null&&y!==void 0?y:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:I?.message_id},error:B})}throw new yy("You must provide either an email or phone number.")}catch(d){if(await Ra(this.storage,`${this.storageKey}-code-verifier`),Ai(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var s,l;try{let f,_;"options"in e&&(f=(s=e.options)===null||s===void 0?void 0:s.redirectTo,_=(l=e.options)===null||l===void 0?void 0:l.captchaToken);const{data:y,error:d}=await Fi(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:_}}),redirectTo:f,xform:Tc});if(d)throw d;if(!y)throw new Error("An error occurred on token verification.");const A=y.session,I=y.user;return A?.access_token&&(await this._saveSession(A),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",A)),this._returnResult({data:{user:I,session:A},error:null})}catch(f){if(Ai(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async signInWithSSO(e){var s,l,f,_,y;try{let d=null,A=null;this.flowType==="pkce"&&([d,A]=await Vf(this.storage,this.storageKey));const I=await Fi(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(l=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((f=e?.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:A}),headers:this.headers,xform:tL});return!((_=I.data)===null||_===void 0)&&_.url&&za()&&!(!((y=e.options)===null||y===void 0)&&y.skipBrowserRedirect)&&window.location.assign(I.data.url),this._returnResult(I)}catch(d){if(await Ra(this.storage,`${this.storageKey}-code-verifier`),Ai(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:l}=e;if(l)throw l;if(!s)throw new kl;const{error:f}=await Fi(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:f})})}catch(e){if(Ai(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:l,type:f,options:_}=e,{error:y}=await Fi(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:f,gotrue_meta_security:{captcha_token:_?.captchaToken}},redirectTo:_?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}else if("phone"in e){const{phone:l,type:f,options:_}=e,{data:y,error:d}=await Fi(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:f,gotrue_meta_security:{captcha_token:_?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:y?.message_id},error:d})}throw new yy("You must provide either an email or phone number and a type")}catch(s){if(Ai(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),f=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await f}catch{}})()),f}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const f=[...this.pendingInLock];await Promise.all(f),this.pendingInLock.splice(0,f.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await Fd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const l=e.expires_at?e.expires_at*1e3-Date.now()<cv:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",e.expires_at),!l){if(this.userStorage){const y=await Fd(this.userStorage,this.storageKey+"-user");y?.user?e.user=y.user:e.user=dv()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const y={value:this.suppressGetSessionWarning};e.user=Kj(e.user,y),y.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:f,error:_}=await this._callRefreshToken(e.refresh_token);return _?this._returnResult({data:{session:null},error:_}):this._returnResult({data:{session:f},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const s=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return s.data.user&&(this.suppressGetSessionWarning=!0),s}async _getUser(e){try{return e?await Fi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fh}):await this._useSession(async s=>{var l,f,_;const{data:y,error:d}=s;if(d)throw d;return!(!((l=y.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kl}:await Fi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(_=(f=y.session)===null||f===void 0?void 0:f.access_token)!==null&&_!==void 0?_:void 0,xform:Fh})})}catch(s){if(Ai(s))return Aj(s)&&(await this._removeSession(),await Ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async l=>{const{data:f,error:_}=l;if(_)throw _;if(!f.session)throw new kl;const y=f.session;let d=null,A=null;this.flowType==="pkce"&&e.email!=null&&([d,A]=await Vf(this.storage,this.storageKey));const{data:I,error:B}=await Fi(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:A}),jwt:y.access_token,xform:Fh});if(B)throw B;return y.user=I.user,await this._saveSession(y),await this._notifyAllSubscribers("USER_UPDATED",y),this._returnResult({data:{user:y.user},error:null})})}catch(l){if(await Ra(this.storage,`${this.storageKey}-code-verifier`),Ai(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kl;const s=Date.now()/1e3;let l=s,f=!0,_=null;const{payload:y}=hv(e.access_token);if(y.exp&&(l=y.exp,f=l<=s),f){const{data:d,error:A}=await this._callRefreshToken(e.refresh_token);if(A)return this._returnResult({data:{user:null,session:null},error:A});if(!d)return{data:{user:null,session:null},error:null};_=d}else{const{data:d,error:A}=await this._getUser(e.access_token);if(A)throw A;_={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(_),await this._notifyAllSubscribers("SIGNED_IN",_)}return this._returnResult({data:{user:_.user,session:_},error:null})}catch(s){if(Ai(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var l;if(!e){const{data:y,error:d}=s;if(d)throw d;e=(l=y.session)!==null&&l!==void 0?l:void 0}if(!e?.refresh_token)throw new kl;const{data:f,error:_}=await this._callRefreshToken(e.refresh_token);return _?this._returnResult({data:{user:null,session:null},error:_}):f?this._returnResult({data:{user:f.user,session:f},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(Ai(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(e,s){try{if(!za())throw new _y("No browser detected.");if(e.error||e.error_description||e.error_code)throw new _y(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new q0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new _y("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new q0("No code detected.");const{data:ge,error:oe}=await this._exchangeCodeForSession(e.code);if(oe)throw oe;const me=new URL(window.location.href);return me.searchParams.delete("code"),window.history.replaceState(window.history.state,"",me.toString()),{data:{session:ge.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:f,access_token:_,refresh_token:y,expires_in:d,expires_at:A,token_type:I}=e;if(!_||!d||!y||!I)throw new _y("No session defined in URL");const B=Math.round(Date.now()/1e3),N=parseInt(d);let V=B+N;A&&(V=parseInt(A));const K=V-B;K*1e3<=Jf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${K}s, should have been closer to ${N}s`);const se=V-N;B-se>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",se,V,B):B-se<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",se,V,B);const{data:ne,error:ve}=await this._getUser(_);if(ve)throw ve;const re={provider_token:l,provider_refresh_token:f,access_token:_,expires_in:N,expires_at:V,refresh_token:y,token_type:I,user:ne.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:re,redirectType:e.type},error:null})}catch(l){if(Ai(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await Fd(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:f,error:_}=s;if(_)return this._returnResult({error:_});const y=(l=f.session)===null||l===void 0?void 0:l.access_token;if(y){const{error:d}=await this.admin.signOut(y,e);if(d&&!(Cj(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await Ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const s=Oj(),l={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(e){return await this._useSession(async s=>{var l,f;try{const{data:{session:_},error:y}=s;if(y)throw y;await((l=this.stateChangeEmitters.get(e))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",_)),this._debug("INITIAL_SESSION","callback id",e,"session",_)}catch(_){await((f=this.stateChangeEmitters.get(e))===null||f===void 0?void 0:f.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",_),console.error(_)}})}async resetPasswordForEmail(e,s={}){let l=null,f=null;this.flowType==="pkce"&&([l,f]=await Vf(this.storage,this.storageKey,!0));try{return await Fi(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:l,code_challenge_method:f,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(_){if(await Ra(this.storage,`${this.storageKey}-code-verifier`),Ai(_))return this._returnResult({data:null,error:_});throw _}}async getUserIdentities(){var e;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var s;try{const{data:l,error:f}=await this._useSession(async _=>{var y,d,A,I,B;const{data:N,error:V}=_;if(V)throw V;const K=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(y=e.options)===null||y===void 0?void 0:y.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(A=e.options)===null||A===void 0?void 0:A.queryParams,skipBrowserRedirect:!0});return await Fi(this.fetch,"GET",K,{headers:this.headers,jwt:(B=(I=N.session)===null||I===void 0?void 0:I.access_token)!==null&&B!==void 0?B:void 0})});if(f)throw f;return za()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:e.provider,url:l?.url},error:null})}catch(l){if(Ai(l))return this._returnResult({data:{provider:e.provider,url:null},error:l});throw l}}async linkIdentityIdToken(e){return await this._useSession(async s=>{var l;try{const{error:f,data:{session:_}}=s;if(f)throw f;const{options:y,provider:d,token:A,access_token:I,nonce:B}=e,N=await Fi(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=_?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:d,id_token:A,access_token:I,nonce:B,link_identity:!0,gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Tc}),{data:V,error:K}=N;return K?this._returnResult({data:{user:null,session:null},error:K}):!V||!V.session||!V.user?this._returnResult({data:{user:null,session:null},error:new Ff}):(V.session&&(await this._saveSession(V.session),await this._notifyAllSubscribers("USER_UPDATED",V.session)),this._returnResult({data:V,error:K}))}catch(f){if(await Ra(this.storage,`${this.storageKey}-code-verifier`),Ai(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}})}async unlinkIdentity(e){try{return await this._useSession(async s=>{var l,f;const{data:_,error:y}=s;if(y)throw y;return await Fi(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(f=(l=_.session)===null||l===void 0?void 0:l.access_token)!==null&&f!==void 0?f:void 0})})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Uj(async f=>(f>0&&await $j(200*Math.pow(2,f-1)),this._debug(s,"refreshing attempt",f),await Fi(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Tc})),(f,_)=>{const y=200*Math.pow(2,f);return _&&uv(_)&&Date.now()+y-l<Jf})}catch(l){if(this._debug(s,"error",l),Ai(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",l),za()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:e,url:l},error:null}}async _recoverAndRefresh(){var e,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const f=await Fd(this.storage,this.storageKey);if(f&&this.userStorage){let y=await Fd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!y&&(y={user:f.user},await Qf(this.userStorage,this.storageKey+"-user",y)),f.user=(e=y?.user)!==null&&e!==void 0?e:dv()}else if(f&&!f.user&&!f.user){const y=await Fd(this.storage,this.storageKey+"-user");y&&y?.user?(f.user=y.user,await Ra(this.storage,this.storageKey+"-user"),await Qf(this.storage,this.storageKey,f)):f.user=dv()}if(this._debug(l,"session from storage",f),!this._isValidSession(f)){this._debug(l,"session is not valid"),f!==null&&await this._removeSession();return}const _=((s=f.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<cv;if(this._debug(l,`session has${_?"":" not"} expired with margin of ${cv}s`),_){if(this.autoRefreshToken&&f.refresh_token){const{error:y}=await this._callRefreshToken(f.refresh_token);y&&(console.error(y),uv(y)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",y),await this._removeSession()))}}else if(f.user&&f.user.__isUserNotAvailableProxy===!0)try{const{data:y,error:d}=await this._getUser(f.access_token);!d&&y?.user?(f.user=y.user,await this._saveSession(f),await this._notifyAllSubscribers("SIGNED_IN",f)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(y){console.error("Error getting user data:",y),this._debug(l,"error getting user data, skipping SIGNED_IN notification",y)}else await this._notifyAllSubscribers("SIGNED_IN",f)}catch(f){this._debug(l,"error",f),console.error(f);return}finally{this._debug(l,"end")}}async _callRefreshToken(e){var s,l;if(!e)throw new kl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const f=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(f,"begin");try{this.refreshingDeferred=new f_;const{data:_,error:y}=await this._refreshAccessToken(e);if(y)throw y;if(!_.session)throw new kl;await this._saveSession(_.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",_.session);const d={data:_.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(_){if(this._debug(f,"error",_),Ai(_)){const y={data:null,error:_};return uv(_)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(y),y}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(_),_}finally{this.refreshingDeferred=null,this._debug(f,"end")}}async _notifyAllSubscribers(e,s,l=!0){const f=`#_notifyAllSubscribers(${e})`;this._debug(f,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:e,session:s});const _=[],y=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,s)}catch(A){_.push(A)}});if(await Promise.all(y),_.length>0){for(let d=0;d<_.length;d+=1)console.error(_[d]);throw _[0]}}finally{this._debug(f,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ra(this.storage,`${this.storageKey}-code-verifier`);const s=Object.assign({},e),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await Qf(this.userStorage,this.storageKey+"-user",{user:s.user});const f=Object.assign({},s);delete f.user;const _=Y0(f);await Qf(this.storage,this.storageKey,_)}else{const f=Y0(s);await Qf(this.storage,this.storageKey,f)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ra(this.storage,this.storageKey),await Ra(this.storage,this.storageKey+"-code-verifier"),await Ra(this.storage,this.storageKey+"-user"),this.userStorage&&await Ra(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&za()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Jf);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const s=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const s=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,s&&clearTimeout(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const f=Math.floor((l.expires_at*1e3-e)/Jf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${f} ticks, a tick lasts ${Jf}ms, refresh threshold is ${Jv} ticks`),f<=Jv&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof VS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!za()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,l){const f=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&f.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&f.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[_,y]=await Vf(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(_)}`,code_challenge_method:`${encodeURIComponent(y)}`});f.push(d.toString())}if(l?.queryParams){const _=new URLSearchParams(l.queryParams);f.push(_.toString())}return l?.skipBrowserRedirect&&f.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${e}?${f.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var l;const{data:f,error:_}=s;return _?this._returnResult({data:null,error:_}):await Fi(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(e){try{return await this._useSession(async s=>{var l,f;const{data:_,error:y}=s;if(y)return this._returnResult({data:null,error:y});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:A,error:I}=await Fi(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(l=_?.session)===null||l===void 0?void 0:l.access_token});return I?this._returnResult({data:null,error:I}):(e.factorType==="totp"&&A.type==="totp"&&(!((f=A?.totp)===null||f===void 0)&&f.qr_code)&&(A.totp.qr_code=`data:image/svg+xml;utf-8,${A.totp.qr_code}`),this._returnResult({data:A,error:null}))})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var l;const{data:f,error:_}=s;if(_)return this._returnResult({data:null,error:_});const y=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?yL(e.webauthn.credential_response):_L(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:A}=await Fi(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:y,headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token});return A?this._returnResult({data:null,error:A}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:A}))})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var l;const{data:f,error:_}=s;if(_)return this._returnResult({data:null,error:_});const y=await Fi(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token});if(y.error)return y;const{data:d}=y;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:mL(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:gL(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(e){const{data:s,error:l}=await this._challenge({factorId:e.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){var e;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const f={all:[],phone:[],totp:[],webauthn:[]};for(const _ of(e=s?.factors)!==null&&e!==void 0?e:[])f.all.push(_),_.status==="verified"&&f[_.factor_type].push(_);return{data:f,error:null}}async _getAuthenticatorAssuranceLevel(){var e,s;const{data:{session:l},error:f}=await this.getSession();if(f)return this._returnResult({data:null,error:f});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:_}=hv(l.access_token);let y=null;_.aal&&(y=_.aal);let d=y;((s=(e=l.user.factors)===null||e===void 0?void 0:e.filter(B=>B.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(d="aal2");const I=_.amr||[];return{data:{currentLevel:y,nextLevel:d,currentAuthenticationMethods:I},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async s=>{const{data:{session:l},error:f}=s;return f?this._returnResult({data:null,error:f}):l?await Fi(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:l.access_token,xform:_=>({data:_,error:null})}):this._returnResult({data:null,error:new kl})})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(e,s){try{return await this._useSession(async l=>{const{data:{session:f},error:_}=l;if(_)return this._returnResult({data:null,error:_});if(!f)return this._returnResult({data:null,error:new kl});const y=await Fi(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:f.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return y.data&&y.data.redirect_url&&za()&&!s?.skipBrowserRedirect&&window.location.assign(y.data.redirect_url),y})}catch(l){if(Ai(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(e,s){try{return await this._useSession(async l=>{const{data:{session:f},error:_}=l;if(_)return this._returnResult({data:null,error:_});if(!f)return this._returnResult({data:null,error:new kl});const y=await Fi(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:f.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return y.data&&y.data.redirect_url&&za()&&!s?.skipBrowserRedirect&&window.location.assign(y.data.redirect_url),y})}catch(l){if(Ai(l))return this._returnResult({data:null,error:l});throw l}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:s},error:l}=e;return l?this._returnResult({data:null,error:l}):s?await Fi(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,xform:f=>({data:f,error:null})}):this._returnResult({data:null,error:new kl})})}catch(e){if(Ai(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async s=>{const{data:{session:l},error:f}=s;return f?this._returnResult({data:null,error:f}):l?(await Fi(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:l.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new kl})})}catch(s){if(Ai(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,s={keys:[]}){let l=s.keys.find(d=>d.kid===e);if(l)return l;const f=Date.now();if(l=this.jwks.keys.find(d=>d.kid===e),l&&this.jwks_cached_at+Ej>f)return l;const{data:_,error:y}=await Fi(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(y)throw y;return!_.keys||_.keys.length===0||(this.jwks=_,this.jwks_cached_at=f,l=_.keys.find(d=>d.kid===e),!l)?null:l}async getClaims(e,s={}){try{let l=e;if(!l){const{data:K,error:se}=await this.getSession();if(se||!K.session)return this._returnResult({data:null,error:se});l=K.session.access_token}const{header:f,payload:_,signature:y,raw:{header:d,payload:A}}=hv(l);s?.allowExpired||Wj(_.exp);const I=!f.alg||f.alg.startsWith("HS")||!f.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(f.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!I){const{error:K}=await this.getUser(l);if(K)throw K;return{data:{claims:_,header:f,signature:y},error:null}}const B=Yj(f.alg),N=await crypto.subtle.importKey("jwk",I,B,!0,["verify"]);if(!await crypto.subtle.verify(B,N,y,zj(`${d}.${A}`)))throw new tx("Invalid JWT signature");return{data:{claims:_,header:f,signature:y},error:null}}catch(l){if(Ai(l))return this._returnResult({data:null,error:l});throw l}}}Zm.nextInstanceID={};const CL=Zm,AL="2.90.1";let km="";typeof Deno<"u"?km="deno":typeof document<"u"?km="web":typeof navigator<"u"&&navigator.product==="ReactNative"?km="react-native":km="node";const ML={"X-Client-Info":`supabase-js-${km}/${AL}`},PL={headers:ML},IL={schema:"public"},jL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},LL={};function Gm(t){"@babel/helpers - typeof";return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gm(t)}function RL(t,e){if(Gm(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var l=s.call(t,e);if(Gm(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zL(t){var e=RL(t,"string");return Gm(e)=="symbol"?e:e+""}function DL(t,e,s){return(e=zL(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function iw(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),s.push.apply(s,l)}return s}function gr(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?iw(Object(s),!0).forEach(function(l){DL(t,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):iw(Object(s)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(s,l))})}return t}const OL=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),NL=()=>Headers,BL=(t,e,s)=>{const l=OL(s),f=NL();return async(_,y)=>{var d;const A=(d=await e())!==null&&d!==void 0?d:t;let I=new f(y?.headers);return I.has("apikey")||I.set("apikey",t),I.has("Authorization")||I.set("Authorization",`Bearer ${A}`),l(_,gr(gr({},y),{},{headers:I}))}};function $L(t){return t.endsWith("/")?t:t+"/"}function UL(t,e){var s,l;const{db:f,auth:_,realtime:y,global:d}=t,{db:A,auth:I,realtime:B,global:N}=e,V={db:gr(gr({},A),f),auth:gr(gr({},I),_),realtime:gr(gr({},B),y),storage:{},global:gr(gr(gr({},N),d),{},{headers:gr(gr({},(s=N?.headers)!==null&&s!==void 0?s:{}),(l=d?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return t.accessToken?V.accessToken=t.accessToken:delete V.accessToken,V}function FL(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL($L(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var VL=class extends CL{constructor(t){super(t)}},qL=class{constructor(t,e,s){var l,f;this.supabaseUrl=t,this.supabaseKey=e;const _=FL(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",_),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",_),this.storageUrl=new URL("storage/v1",_),this.functionsUrl=new URL("functions/v1",_);const y=`sb-${_.hostname.split(".")[0]}-auth-token`,d={db:IL,realtime:LL,auth:gr(gr({},jL),{},{storageKey:y}),global:PL},A=UL(s??{},d);if(this.storageKey=(l=A.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(f=A.global.headers)!==null&&f!==void 0?f:{},A.accessToken)this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(B,N)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(N)} is not possible`)}});else{var I;this.auth=this._initSupabaseAuthClient((I=A.auth)!==null&&I!==void 0?I:{},this.headers,A.global.fetch)}this.fetch=BL(e,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(gr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.accessToken&&this.accessToken().then(B=>this.realtime.setAuth(B)).catch(B=>console.warn("Failed to set initial Realtime auth token:",B)),this.rest=new SI(new URL("rest/v1",_).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new xj(this.storageUrl.href,this.headers,this.fetch,s?.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new _I(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,s)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,s;if(t.accessToken)return await t.accessToken();const{data:l}=await t.auth.getSession();return(e=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:l,userStorage:f,storageKey:_,flowType:y,lock:d,debug:A,throwOnError:I},B,N){const V={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new VL({url:this.authUrl.href,headers:gr(gr({},V),B),storageKey:_,autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:l,userStorage:f,flowType:y,lock:d,debug:A,throwOnError:I,fetch:N,hasCustomAuthorizationHeader:Object.keys(this.headers).some(K=>K.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new $I(this.realtimeUrl.href,gr(gr({},t),{},{params:gr(gr({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const HL=(t,e,s)=>new qL(t,e,s);function ZL(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const s=e.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}ZL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const GL={DEV:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFlc2Nva2xrZHllaHlmcHNxbnRyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1Njk4MTEsImV4cCI6MjA4MDE0NTgxMX0.9rWg2urAfOCc3qZs7_yXNPjRjCm9WP7bcD1qQ20CxFM",VITE_SUPABASE_URL:"https://aescoklkdyehyfpsqntr.supabase.co"},Wm=GL||{},e_=Wm.VITE_SUPABASE_URL||Wm.NEXT_PUBLIC_SUPABASE_URL||"",Lm=Wm.VITE_SUPABASE_ANON_KEY||Wm.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",p_=!!Wm.DEV,WL=!!(e_&&Lm),YL=async(...t)=>{if(p_){const e=t[0],s=typeof e=="string"?e:e instanceof URL?e.toString():e.url;console.info("[supabase] request",s)}return fetch(...t)},XL=async(t,e,s)=>s(),Pt=HL(e_,Lm,{global:{fetch:p_?YL:fetch},auth:{lock:XL}});if(p_){let t="missing";if(e_)try{t=new URL(e_).host}catch{t="invalid-url"}const e=Lm?`${Lm.slice(0,6)}...${Lm.slice(-4)}`:"missing";console.info("[supabase] config",{host:t,key:e,isConfigured:WL})}p_&&(window.supabase=Pt);const Wd=new Map,Xd=new Map,_r=async(t,e,s)=>{const l=s?.ttlMs??15e3,f=Date.now(),_=Xd.get(t);if(_&&_.expiresAt>f)return _.value;const y=Wd.get(t);if(y)return y;const d=e().then(A=>(Wd.delete(t),Xd.set(t,{value:A,expiresAt:f+l}),A)).catch(A=>{throw Wd.delete(t),Xd.delete(t),A});return Wd.set(t,d),d},ix=(t,e,s)=>{const l=s?.ttlMs??15e3;Xd.set(t,{value:e,expiresAt:Date.now()+l})},ZS=t=>{if(!t){Wd.clear(),Xd.clear();return}for(const e of Array.from(Wd.keys()))e.startsWith(t)&&Wd.delete(e);for(const e of Array.from(Xd.keys()))e.startsWith(t)&&Xd.delete(e)},KL={auth:{userId:null},workspace:{activeWorkspaceId:null}},JL=(t,e)=>{switch(e.type){case"auth/setUserId":return{...t,auth:{userId:e.payload}};case"workspace/setActiveId":return{...t,workspace:{activeWorkspaceId:e.payload}};case"workspace/reset":return{...t,workspace:{activeWorkspaceId:null}};default:return t}},GS=Q.createContext(void 0),WS=Q.createContext(void 0),QL=({children:t})=>{const[e,s]=Q.useReducer(JL,KL),l=Q.useMemo(()=>e,[e]);return S.jsx(WS.Provider,{value:s,children:S.jsx(GS.Provider,{value:l,children:t})})},YS=()=>{const t=Q.useContext(GS);if(!t)throw new Error("useAppStore must be used within AppStoreProvider");return t},XS=()=>{const t=Q.useContext(WS);if(!t)throw new Error("useAppDispatch must be used within AppStoreProvider");return t},eR=()=>{const{auth:t}=YS(),e=XS();return{userId:t.userId,setUserId:s=>e({type:"auth/setUserId",payload:s})}},KS=()=>{const{workspace:t}=YS(),e=XS();return{activeWorkspaceId:t.activeWorkspaceId,setActiveWorkspaceId:s=>e({type:"workspace/setActiveId",payload:s}),resetWorkspace:()=>e({type:"workspace/reset"})}},JS=Q.createContext(void 0),Vr=()=>{const t=Q.useContext(JS);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},tR=({children:t})=>{const{setUserId:e}=eR(),{resetWorkspace:s}=KS(),[l,f]=Q.useState({user:null,profile:null,loading:!0}),_=!1,y=Q.useRef(null),d=Q.useRef(null),A=async(re,ge,oe)=>{if(oe&&!(y.current===re&&l.profile&&!l.loading)&&d.current!==re){d.current=re,e(re),f(me=>({...me,user:ge,loading:!0}));try{const me=`profiles:${re}`,ye=await _r(me,async()=>{const{data:Xe,error:at}=await Pt.from("profiles").select("*").eq("id",re).maybeSingle();if(at)throw at;return Xe},{ttlMs:3e4});if(!oe||d.current!==re)return;let ke=ye;if(!ke){const Xe=ge.user_metadata??{},{data:at,error:et}=await Pt.from("profiles").insert({id:re,username:Xe.username??null,display_name:Xe.display_name??Xe.displayName??null,primary_city:Xe.primary_city??Xe.primaryCity??null}).select("*").single();if(et)throw et;ke=at,ix(me,at,{ttlMs:3e4})}const Re=`subject:user:${re}`,Ge=await _r(Re,async()=>{const{data:Xe,error:at}=await Pt.rpc("get_or_create_user_subject",{p_profile_id:re});if(at)throw at;return Xe},{ttlMs:1440*60*1e3});if(!oe||d.current!==re)return;const He=ke?{...ke,subject_id:Ge}:null;y.current=re,f({user:ge,profile:He??null,loading:!1})}catch(me){console.error("[auth] failed to load profile",me),oe&&f(ye=>({...ye,loading:!1}))}finally{d.current===re&&(d.current=null)}}};Q.useEffect(()=>{let re=!0,ge=null;return(async()=>{const{data:{session:me}}=await Pt.auth.getSession();re&&(me?.user?await A(me.user.id,me.user,re):(e(null),s(),f({user:null,profile:null,loading:!1})));const{data:ye}=Pt.auth.onAuthStateChange(async(ke,Re)=>{re&&(ke==="SIGNED_IN"||ke==="TOKEN_REFRESHED"||ke==="USER_UPDATED"?Re?.user&&await A(Re.user.id,Re.user,re):ke==="SIGNED_OUT"&&(y.current=null,e(null),s(),f({user:null,profile:null,loading:!1})))});ge=ye})(),()=>{re=!1,ge&&ge.subscription.unsubscribe()}},[]),Q.useEffect(()=>{const re=()=>{document.visibilityState==="visible"&&ne().catch(()=>{})};return window.addEventListener("focus",re),document.addEventListener("visibilitychange",re),()=>{window.removeEventListener("focus",re),document.removeEventListener("visibilitychange",re)}},[l.user]);const I=async(re,ge)=>{const{error:oe}=await Pt.auth.signInWithPassword({email:re,password:ge});return{error:oe}},B=async(re,ge,oe)=>{const{error:me}=await Pt.auth.signUp({email:re,password:ge,options:{data:{username:oe.username||null,display_name:oe.displayName||null,primary_city:oe.primaryCity||null}}});return{error:me}},N=async re=>{const{error:ge}=await Pt.auth.resetPasswordForEmail(re,{redirectTo:`${window.location.origin}/reset`});return{error:ge}},V=async re=>{const{error:ge}=await Pt.auth.updateUser({password:re});return{error:ge}},K=async()=>{try{const{error:re}=await Pt.auth.signOut();re&&await Pt.auth.signOut({scope:"local"})}finally{y.current=null,e(null),s(),f({user:null,profile:null,loading:!1})}},se=async re=>{if(!l.user)return{error:{message:"No user logged in"}};const{role:ge,...oe}=re,me={id:l.user.id,...oe};_&&ge&&(me.role=ge);const{data:ye,error:ke}=await Pt.from("profiles").upsert(me,{onConflict:"id"}).select("*").single();return!ke&&ye&&f(Re=>({...Re,profile:ye})),{error:ke}},ne=async()=>{if(!l.user)return;const{data:re}=await Pt.from("profiles").select("*").eq("id",l.user.id).single();re&&f(ge=>({...ge,profile:re}))},ve={...l,signIn:I,signUp:B,sendPasswordReset:N,updatePassword:V,signOut:K,updateProfile:se,refreshProfile:ne};return S.jsx(JS.Provider,{value:ve,children:t})},Cm={async getManagedEntities(t){const e=await _r(`subject:user:${t}`,async()=>{const{data:f,error:_}=await Pt.rpc("get_or_create_user_subject",{p_profile_id:t});if(_)throw _;return f},{ttlMs:864e5}),{data:s,error:l}=await Pt.from("entity_members").select(`
        admin_subject_id,
        entity_subject_id,
        role,
        subjects:entity_subject_id (
          id,
          type
        )
      `).eq("admin_subject_id",e);if(l)throw l;return Promise.all(s.map(async f=>{const _=f.subjects.type,y={subject_id:f.entity_subject_id,role:f.role,type:_};if(_==="artist"){const d=await _r(`v_subject_artists:by_subject:${f.entity_subject_id}`,async()=>{const{data:A,error:I}=await Pt.from("v_subject_artists").select("*").eq("subject_id",f.entity_subject_id).maybeSingle();if(I)throw I;return A},{ttlMs:6e4});d&&(y.artist={...d,id:d.artist_id??d.id})}else if(_==="venue"){const d=await _r(`v_subject_venues:by_subject:${f.entity_subject_id}`,async()=>{const{data:A,error:I}=await Pt.from("v_subject_venues").select("*").eq("subject_id",f.entity_subject_id).maybeSingle();if(I)throw I;return A},{ttlMs:6e4});d&&(y.venue={...d,id:d.venue_place_id??d.id})}return y}))},async adminGrantEntityAccess(t,e,s,l="admin"){const{error:f}=await Pt.rpc("admin_grant_entity_access",{p_target_profile_id:t,p_entity_type:e,p_entity_id:s,p_role:l});if(f)throw f},async removeMember(t,e){const{error:s}=await Pt.from("entity_members").delete().match({admin_subject_id:t,entity_subject_id:e});if(s)throw s},async searchProfiles(t){const{data:e,error:s}=await Pt.from("profiles").select("id, username, display_name, avatar_url").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(10);if(s)throw s;return e},async searchArtists(t){const{data:e,error:s}=await Pt.from("artists").select("id, name, artist_type, city, avatar_url").ilike("name",`%${t}%`).order("name",{ascending:!0}).limit(10);if(s)throw s;return e?.map(l=>({...l,image_url:l.avatar_url??null}))},async searchVenues(t){const{data:e,error:s}=await Pt.from("venue_places").select("id, name, city, photos, venue_type").or(`name.ilike.%${t}%,city.ilike.%${t}%`).order("name",{ascending:!0}).limit(10);if(s)throw s;return e?.map(l=>({...l,image_url:l.photos?.[0]??null}))}},QS=Q.createContext(void 0),iR="live_space.workspace.",nR=({children:t})=>{const{profile:e}=Vr(),{activeWorkspaceId:s,setActiveWorkspaceId:l}=KS(),[f,_]=Q.useState([]),[y,d]=Q.useState(!0),[A,I]=Q.useState(null),B=e?.id?`${iR}${e.id}`:null,N=oe=>{if(!(!B||typeof window>"u"))try{oe?window.localStorage.setItem(B,oe):window.localStorage.removeItem(B)}catch{}},V=oe=>{console.log("[workspace] setActiveWorkspace ->",oe);const me=oe?.subject_id??null;l(me),N(me)},K=()=>{if(!B||typeof window>"u")return null;try{return window.localStorage.getItem(B)}catch{return null}},se=async()=>{if(!e?.id){_([]),l(null),N(null),d(!1),I(null);return}try{d(!0);const oe=await Cm.getManagedEntities(e.id);if(console.log("[workspace] fetched entities",oe),_(oe),s)oe.find(ye=>ye.subject_id===s)||(l(null),N(null));else{const me=K();if(me){const ye=oe.find(ke=>ke.subject_id===me);ye&&(console.log("[workspace] restoring stored workspace",me),l(ye.subject_id))}}}catch(oe){console.error("Error fetching managed entities:",oe)}finally{d(!1),I(e.id)}};Q.useEffect(()=>{se()},[e?.id]),Q.useEffect(()=>{const oe=()=>{document.visibilityState==="visible"&&e?.id&&se().catch(()=>{})};return window.addEventListener("focus",oe),document.addEventListener("visibilitychange",oe),()=>{window.removeEventListener("focus",oe),document.removeEventListener("visibilitychange",oe)}},[e?.id]);const ne=Q.useMemo(()=>s?f.find(oe=>oe.subject_id===s)??null:null,[s,f]),ve=ne!==null,re=ne!==null&&["owner","admin","editor"].includes(ne.role),ge=!!(e?.id&&A===e.id);return S.jsx(QS.Provider,{value:{managedEntities:f,activeWorkspace:ne,setActiveWorkspace:V,loading:y,ready:ge,refreshWorkspaces:se,isActingAsEntity:ve,canCreateEvent:re},children:t})},mp=()=>{const t=Q.useContext(QS);if(t===void 0)throw new Error("useWorkspace must be used within a WorkspaceProvider");return t},nw="/tabs/events",sR=()=>{const t=dS(),e=sf(),s=Q.useRef(e.pathname);return Q.useEffect(()=>{s.current=e.pathname},[e.pathname]),Q.useEffect(()=>{const l=f=>{f.detail?.register(10,()=>{if(t.canGoBack()){t.goBack();return}s.current!==nw&&t.push(nw,"root","replace")})};return document.addEventListener("ionBackButton",l),()=>{document.removeEventListener("ionBackButton",l)}},[t]),null},rR=()=>S.jsxs("div",{className:"inline-flex items-center gap-2",children:[S.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-[10px] bg-white/10 text-[11px] font-bold uppercase tracking-[0.2em] text-white","aria-hidden":"true",children:"icon"}),S.jsx("span",{className:"font-display text-sm font-semibold uppercase tracking-[0.2em] text-white/90",children:"Live Space"})]}),aR=()=>{const{managedEntities:t,activeWorkspace:e,setActiveWorkspace:s}=mp(),[l,f]=Q.useState(!1),_=Fr(),y=d=>{console.log("[workspace-switcher] selecting",d),s(d?{...d,artist:d.artist?{...d.artist,id:d.artist.id??d.artist.artist_id}:void 0,venue:d.venue?{...d.venue,id:d.venue.id??d.venue.venue_place_id}:void 0}:null),f(!1),d?.type==="artist"&&d.artist?.id?_.replace(`/tabs/artist/${d.artist.id}`):d?.type==="venue"&&d.venue?.id?_.replace(`/tabs/venue/${d.venue.id}`):_.replace("/tabs/profile")};return t.length===0?null:S.jsxs("div",{className:"relative",children:[S.jsxs("button",{onClick:()=>f(!l),className:"flex items-center gap-2 px-2 py-1 text-white/80 transition-colors hover:text-white",children:[S.jsx("div",{className:"flex h-5 w-5 items-center justify-center text-white/70",children:e?S.jsx(L0,{size:12}):S.jsx(Ay,{size:12})}),S.jsx("span",{className:"max-w-[120px] truncate text-xs font-medium text-white/80",children:e?e.artist?.name||e.venue?.name||"Workspace":"Personal Profile"}),l?S.jsx(pI,{size:14,className:"text-white/50"}):S.jsx(fI,{size:14,className:"text-white/50"})]}),l&&S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>f(!1)}),S.jsxs("div",{className:"absolute right-0 top-full z-40 mt-2 w-64 overflow-hidden rounded-xl bg-black/95",children:[S.jsx("div",{className:"px-4 pb-2 pt-4 text-[10px] font-semibold uppercase tracking-[0.24em] text-white/40",children:"Personal"}),S.jsxs("button",{onClick:()=>y(null),className:`flex w-full items-center gap-3 px-4 py-3 text-left transition-colors hover:bg-white/5 ${e?"text-white/80":"text-white"}`,children:[S.jsx("div",{className:"flex h-8 w-8 items-center justify-center bg-white/10 text-white/80",children:S.jsx(Ay,{size:16})}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("div",{className:"truncate text-sm font-medium",children:"Personal Profile"}),S.jsx("div",{className:"text-[10px] text-white/50",children:"Viewing as yourself"})]})]}),S.jsx("div",{className:"px-4 pb-2 pt-4 text-[10px] font-semibold uppercase tracking-[0.24em] text-white/40",children:"Workspaces"}),S.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.map(d=>S.jsxs("button",{onClick:()=>y(d),className:`flex w-full items-center gap-3 px-4 py-3 text-left transition-colors hover:bg-white/5 ${e?.subject_id===d.subject_id?"text-white":"text-white/80"}`,children:[S.jsx("div",{className:"relative",children:d.type==="artist"?d.artist?.avatar_url?S.jsx("img",{src:d.artist.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-white/10 text-white/70",children:S.jsx(Ay,{size:16})}):d.venue?.photos?.[0]?S.jsx("img",{src:d.venue.photos[0],alt:"",className:"h-8 w-8 rounded object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded bg-white/10 text-white/70",children:S.jsx(L0,{size:16})})}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("div",{className:"truncate text-sm font-medium",children:d.type==="artist"?d.artist?.name:d.venue?.name}),S.jsx("div",{className:"text-[10px] uppercase tracking-[0.22em] text-white/45",children:d.role})]})]},d.subject_id))})]})]})]})},oR=({title:t,rightSlot:e,showBack:s})=>{const l=Fr(),f=sf(),_=s??!["/tabs/feed","/tabs/events","/tabs/map","/tabs/upload","/tabs/profile","/tabs/discover "].includes(f.pathname),y=()=>{l.push("/")},d=()=>{l.goBack()};return S.jsx("header",{className:"sticky top-0 z-20 bg-app-bg px-4 py-3 pt-[calc(12px+env(safe-area-inset-top,0px))]",children:S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[_?S.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-3 py-2 text-sm font-semibold text-white/80 disabled:cursor-not-allowed disabled:opacity-60",onClick:d,"aria-label":"Go back",children:S.jsx(dI,{className:"h-4 w-4"})}):null,t?S.jsx("h1",{className:"text-lg font-bold text-app-light",children:t}):S.jsx("button",{type:"button",className:"flex items-center",onClick:y,"aria-label":"Go to home",children:S.jsx(rR,{})})]}),S.jsxs("div",{className:"inline-flex items-center gap-2",children:[S.jsx(aR,{}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-3 py-2 text-sm font-semibold text-white/80 disabled:cursor-not-allowed disabled:opacity-60","aria-label":"Notifications",disabled:!0,children:S.jsx(hI,{className:"h-4 w-4"})}),e]})]})})},ao=({children:t,headerProps:e={},headerPlacement:s="inside",contentClassName:l,contentFullscreen:f=!0,contentWrapperClassName:_="min-h-full"})=>{const y=e?S.jsx(oR,{...e}):null,d=S.jsxs(S.Fragment,{children:[s==="inside"?y:null,t]});return S.jsxs(Zh,{children:[s==="outside"?y:null,S.jsx(Ql,{fullscreen:f,className:l,children:_===!1?d:S.jsx("div",{className:_,children:d})})]})},lR=()=>{const[t,e]=Q.useState(!1),[s,l]=Q.useState(""),[f,_]=Q.useState(""),[y,d]=Q.useState(""),[A,I]=Q.useState(""),[B,N]=Q.useState(""),[V,K]=Q.useState(!1),[se,ne]=Q.useState(""),[ve,re]=Q.useState(!1),[ge,oe]=Q.useState(""),[me,ye]=Q.useState(!1),ke=Fr(),{signIn:Re,signUp:Ge,sendPasswordReset:He}=Vr(),Xe=async()=>{K(!0),ne("");try{if(!s||!f||t&&!y){ne("Please fill in all required fields");return}if(t){const{error:et}=await Ge(s,f,{username:y,displayName:A,primaryCity:B});if(et){ne(et.message);return}}else{const{error:et}=await Re(s,f);if(et){ne(et.message);return}}ke.replace("/tabs/events")}catch{ne("An unexpected error occurred")}finally{K(!1)}},at=async()=>{K(!0),ne(""),ye(!1);try{const et=ge||s;if(!et){ne("Enter your email to reset password");return}const{error:Et}=await He(et);if(Et){ne(Et.message);return}ye(!0)}catch{ne("Could not send reset email")}finally{K(!1)}};return S.jsx(ao,{children:S.jsx("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:S.jsxs("div",{className:"relative min-h-full",children:[S.jsxs("div",{className:"mx-auto max-w-md text-center",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"Your concert archive"}),S.jsx("h1",{className:"mt-4 font-display text-4xl font-bold leading-tight text-white",children:"Live Space"}),S.jsx("p",{className:"mt-3 text-sm text-white/70",children:"Keep what happened last night  and relive it when you want."})]}),S.jsxs("div",{className:"mt-8 space-y-4 rounded-2xl bg-white/5 p-5",children:[S.jsx("h2",{className:"font-display text-base font-semibold text-white",children:t?"Create Account":"Sign In"}),S.jsxs("div",{className:"space-y-3",children:[t&&S.jsxs(S.Fragment,{children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{value:y,onChange:et=>d(et.target.value),placeholder:"Choose a username",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Display name"}),S.jsx("input",{value:A,onChange:et=>I(et.target.value),placeholder:"How should we call you?",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Primary city"}),S.jsx("input",{value:B,onChange:et=>N(et.target.value),placeholder:"Barcelona",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Email"}),S.jsx("input",{type:"email",value:s,onChange:et=>l(et.target.value),placeholder:"your@email.com",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Password"}),S.jsx("input",{type:"password",value:f,onChange:et=>_(et.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),se&&S.jsx("p",{className:"text-sm text-rose-400",children:se}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:Xe,disabled:V||!s||!f||t&&!y,children:V?S.jsxs("span",{className:"flex items-center gap-2",children:[S.jsx(Js,{name:"crescent"}),"Loading..."]}):t?"Sign Up":"Sign In"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>e(!t),children:t?"Already have an account? Sign In":"Don't have an account? Sign Up"}),!t&&S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>re(et=>!et),children:"Forgot your password?"}),ve&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Reset email"}),S.jsx("input",{type:"email",value:ge||s,onChange:et=>oe(et.target.value),placeholder:"you@email.com",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:at,disabled:V,children:"Send reset link"}),me&&S.jsx("p",{className:"text-sm text-emerald-400",children:"Check your inbox for the reset link."})]})]})]})})})},pv=6,cR=()=>{const{profile:t}=Vr(),[e,s]=Q.useState([]),[l,f]=Q.useState(0),[_,y]=Q.useState(!0),[d,A]=Q.useState(!1),[I,B]=Q.useState(""),[N,V]=Q.useState(!0),K=Q.useRef(null),se=Fr(),ne=async(re,ge=!1)=>{const oe=re*pv,me=oe+pv-1,{data:ye,error:ke}=await Pt.from("posts").select(`
        id,
        user_id,
        event_id,
        media_url,
        media_type,
        thumbnail_url,
        caption,
        created_at,
        profiles:profiles!posts_user_id_fkey (
          id,
          username,
          display_name,
          avatar_url
        ),
        events:events!posts_event_id_fkey (
          id,
          name,
          city,
          starts_at,
          cover_image_url
        )
        `).order("created_at",{ascending:!1}).range(oe,me);if(ke)throw ke;ye&&(s(Re=>ge?ye:[...Re,...ye]),V(ye.length===pv))};Q.useEffect(()=>{(async()=>{y(!0),B("");try{await ne(0,!0)}catch{V(!1),B("Could not load the feed. Check your Supabase connection.")}finally{y(!1)}})()},[]),Q.useEffect(()=>{!_&&e.length===0&&(B(""),V(!0),f(0),ne(0,!0).catch(()=>{V(!1),B("Could not load the feed. Check your Supabase connection.")}))},[_,e.length]);const ve=async()=>{if(d||!N)return;const re=l+1;A(!0);try{await ne(re),f(re)}catch{V(!1),B("Could not load more posts.")}finally{A(!1)}};return Q.useEffect(()=>{if(!N||_||d)return;const re=K.current;if(!re)return;const ge=new IntersectionObserver(oe=>{oe[0].isIntersecting&&ve()},{rootMargin:"200px"});return ge.observe(re),()=>ge.disconnect()},[N,_,d,l]),S.jsx(ao,{children:S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("header",{className:"space-y-2",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:t?.primary_city?`Tonight in ${t.primary_city}`:"Tonight"}),S.jsx("p",{className:"text-sm text-white/55",children:"Relive what people lived."})]}),_?S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})}):S.jsxs("div",{className:"space-y-4",children:[I&&S.jsx("p",{className:"text-sm text-rose-400",children:I}),e.map(re=>{const ge=re.profiles?.username?`@${re.profiles.username}`:re.profiles?.display_name||"Anonymous",oe=re.caption||re.events?.name||"Relive the moment",me=`${re.events?.city||"Unknown"}  ${new Date(re.created_at).toLocaleDateString()}`,ye=re.thumbnail_url||re.events?.cover_image_url||null;return S.jsx("button",{type:"button",className:"-mx-4 block w-[calc(100%+2rem)] text-left",onClick:()=>se.push(`/post/${re.id}`),children:S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[re.media_type==="image"?S.jsx("img",{src:re.media_url,alt:oe,className:"absolute inset-0 h-full w-full object-cover"}):ye?S.jsx("img",{src:ye,alt:oe,className:"absolute inset-0 h-full w-full object-cover"}):S.jsx("video",{muted:!0,playsInline:!0,preload:"metadata",className:"absolute inset-0 h-full w-full object-cover",children:S.jsx("source",{src:re.media_url})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:ge}),S.jsx("h3",{className:"mt-2 font-display text-2xl font-bold text-white line-clamp-2",children:oe}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:me})]})]})},re.id)})]}),N&&S.jsx("div",{ref:K,className:"flex items-center justify-center py-6",children:d&&S.jsx(Js,{name:"crescent"})})]})})},e2="live_space.last_location",uR=()=>{try{const t=window.localStorage.getItem(e2);if(!t)return null;const e=JSON.parse(t),s=typeof e.lat=="number"?e.lat:Number(e.lat),l=typeof e.lng=="number"?e.lng:Number(e.lng),f=typeof e.ts=="number"?e.ts:Number(e.ts);if(!Number.isFinite(s)||!Number.isFinite(l)||!Number.isFinite(f))return null;const _=Date.now()-f;return _<0||_>1e3*60*60*24*30?null:{lat:s,lng:l}}catch{return null}},t2=()=>{const[t,e]=Q.useState(null);return Q.useEffect(()=>{e(uR())},[]),t},hR=t=>{try{window.localStorage.setItem(e2,JSON.stringify({...t,ts:Date.now()}))}catch{}},dR=()=>{const t=t2(),[e,s]=Q.useState(null),[l,f]=Q.useState(!1),[_,y]=Q.useState("");Q.useEffect(()=>{t&&s(t)},[t]);const d=Q.useCallback(()=>{if(!navigator.geolocation){y("Location is not supported on this device.");return}f(!0),y(""),navigator.geolocation.getCurrentPosition(A=>{const I={lat:A.coords.latitude,lng:A.coords.longitude};s(I),hR(I),f(!1)},()=>{f(!1),y("Enable location to see concerts near you.")},{enableHighAccuracy:!0,timeout:5e3})},[]);return{location:e,loading:l,error:_,requestLocation:d}},fu={async follow(t,e){const{error:s}=await Pt.from("follows").insert({follower_subject_id:t,target_subject_id:e});if(s)throw s},async unfollow(t,e){const{error:s}=await Pt.from("follows").delete().match({follower_subject_id:t,target_subject_id:e});if(s)throw s},async isFollowing(t,e){const{data:s,error:l}=await Pt.from("follows").select("created_at").match({follower_subject_id:t,target_subject_id:e}).maybeSingle();if(l)throw l;return!!s},async getFollowersCount(t){const{count:e,error:s}=await Pt.from("follows").select("*",{count:"exact",head:!0}).eq("target_subject_id",t);if(s)throw s;return e||0},async getFollowingCount(t){const{count:e,error:s}=await Pt.from("follows").select("*",{count:"exact",head:!0}).eq("follower_subject_id",t);if(s)throw s;return e||0}},i2=()=>{const{user:t,profile:e}=Vr(),s=e?.subject_id||null,[l,f]=Q.useState(new Set),[_,y]=Q.useState(!1),[d,A]=Q.useState(new Set),I=!!(t&&s);Q.useEffect(()=>{if(!s)return;let K=!1;return y(!0),_r(`follows:${s}`,async()=>{const{data:se,error:ne}=await Pt.from("follows").select("target_subject_id").eq("follower_subject_id",s);if(ne)throw ne;return(se||[]).map(ve=>ve.target_subject_id).filter(Boolean)},{ttlMs:1e4}).then(se=>{K||f(new Set(se))}).catch(()=>{K||f(new Set)}).finally(()=>{K||y(!1)}),()=>{K=!0}},[s]);const B=Q.useCallback(K=>l.has(K),[l]),N=Q.useCallback(K=>d.has(K),[d]),V=Q.useCallback(async K=>{if(!t||!s)return{ok:!1,reason:"not-authenticated"};if(!K)return{ok:!1,reason:"invalid-target"};const se=new Set(l),ne=se.has(K);ne?se.delete(K):se.add(K),f(se),A(ve=>new Set(ve).add(K));try{return ne?await fu.unfollow(s,K):await fu.follow(s,K),ix(`follows:${s}`,Array.from(se),{ttlMs:1e4}),{ok:!0}}catch{const re=new Set(se);return ne?re.add(K):re.delete(K),f(re),ix(`follows:${s}`,Array.from(re),{ttlMs:2e3}),{ok:!1,reason:"network"}}finally{A(ve=>{const re=new Set(ve);return re.delete(K),re})}},[s,l,t]);return Q.useMemo(()=>({canFollow:I,loading:_,followedSubjectIds:l,isFollowing:B,isToggling:N,toggleFollowSubject:V}),[I,l,B,N,_,V])},qh=t=>{if(t==null)return null;if(typeof t=="number")return t;const e=Number(t);return Number.isNaN(e)?null:e},Vx=(t,e,s,l)=>{const _=(s-t)*Math.PI/180,y=(l-e)*Math.PI/180,d=Math.sin(_/2)*Math.sin(_/2)+Math.cos(t*Math.PI/180)*Math.cos(s*Math.PI/180)*Math.sin(y/2)*Math.sin(y/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},m_=t=>{const e=new Date(t);try{return new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric"}).format(e)}catch{return e.toLocaleDateString()}},fR=t=>t<1?`${(t*1e3).toFixed(0)} m`:t<10?`${t.toFixed(1)} km`:`${t.toFixed(0)} km`,g_=t=>(t.event_artists||[]).find(s=>s.artist?.name)?.artist?.name||t.name,dp=t=>t.cover_image_url||(t.event_artists||[]).find(e=>e.artist?.avatar_url)?.artist?.avatar_url||null,pR=t=>new Date(t).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric"}),mR=t=>t?.display_name||t?.username||null,gR=t=>{const e=t.event_artists?.find(s=>s.artist)?.artist;return e?.name?e.name:t.organizer&&t.organizer.role!=="venue"?mR(t.organizer):null},yR=t=>t.venue_place?.name||t.address||t.city||null,Jl=({event:t,onSelect:e,className:s,title:l,subtitle:f,kicker:_,badge:y})=>{const d=t.cover_image_url||t.event_artists?.find(N=>N.artist?.avatar_url)?.artist?.avatar_url||null,A=Q.useMemo(()=>l||gR(t)||t.name,[t.name,l]),I=Q.useMemo(()=>f||yR(t)||"Venue",[t,f]),B=Q.useMemo(()=>_||pR(t.starts_at),[t.starts_at,_]);return S.jsx("button",{type:"button",className:s||"w-[220px] shrink-0",onClick:()=>e(t),children:S.jsxs("div",{className:"relative aspect-[4/5] overflow-hidden",children:[d?S.jsx("img",{src:d,alt:t.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),y&&S.jsx("div",{className:"absolute left-3 top-3",children:S.jsx("span",{className:"rounded-md bg-black/60 px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-white/90",children:y})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4 text-left",children:[S.jsx("p",{className:"font-display text-lg font-bold text-white line-clamp-2",children:A}),S.jsx("p",{className:"mt-1 text-xs font-semibold uppercase tracking-[0.18em] text-white/80 line-clamp-1",children:I}),S.jsx("p",{className:"mt-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65 line-clamp-1",children:B})]})]})})},_R=({canCreateEvent:t,loading:e,loadError:s,location:l,locationLoading:f,locationError:_,onRequestLocation:y,nearbyUpcoming:d})=>{const A=Fr();return S.jsxs("section",{className:"animate-fade-up motion-reduce:animate-none space-y-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Concerts near you"}),S.jsx("p",{className:"mt-2 text-sm text-white/55",children:"Today + the next two weeks."})]}),t&&S.jsx("div",{className:"flex flex-col items-end gap-2",children:S.jsx("button",{type:"button",className:"inline-flex items-center gap-2 bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>A.push("/create-event"),children:"Create event"})})]}),_&&S.jsx("p",{className:"text-xs text-rose-400",children:_}),e?S.jsx("div",{className:"flex items-center justify-center py-8",children:S.jsx(Js,{name:"crescent"})}):S.jsxs(S.Fragment,{children:[s&&S.jsx("p",{className:"text-sm text-rose-400",children:s}),l?d.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No concerts nearby today"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Try the map to explore whats happening around you."}),S.jsx("div",{className:"mt-4 flex items-center gap-3",children:S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>A.push("/tabs/map"),children:"Explore map"})})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:d.slice(0,10).map(I=>S.jsx(Jl,{event:{...I,cover_image_url:dp(I)},className:"w-[220px] shrink-0",kicker:m_(I.starts_at),title:g_(I),subtitle:I.venue_place?.name||I.city,badge:fR(I.distanceKm),onSelect:B=>A.push(`/event/${B.id}`)},I.id))}):S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"See concerts near you"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Use your location to get nearby events and distances."}),S.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:opacity-60",onClick:y,disabled:f,children:"Use my location"}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white/90",onClick:()=>A.push("/tabs/map"),children:"Explore map"})]})]})]})]})};function vR(t,e){const s=Q.useRef(e);Q.useEffect(function(){e!==s.current&&t.attributionControl!=null&&(s.current!=null&&t.attributionControl.removeAttribution(s.current),e!=null&&t.attributionControl.addAttribution(e)),s.current=e},[t,e])}function xR(t,e,s){e.center!==s.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==s.radius&&t.setRadius(e.radius)}const bR=1;function wR(t){return Object.freeze({__version:bR,map:t})}function n2(t,e){return Object.freeze({...t,...e})}const qx=Q.createContext(null);function Hx(){const t=Q.use(qx);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function s2(t){function e(s,l){const{instance:f,context:_}=t(s).current;Q.useImperativeHandle(l,()=>f);const{children:y}=s;return y==null?null:Nt.createElement(qx,{value:_},y)}return Q.forwardRef(e)}function SR(t){function e(s,l){const{instance:f}=t(s).current;return Q.useImperativeHandle(l,()=>f),null}return Q.forwardRef(e)}function r2(t,e){const s=Q.useRef(void 0);Q.useEffect(function(){return e!=null&&t.instance.on(e),s.current=e,function(){s.current!=null&&t.instance.off(s.current),s.current=null}},[t,e])}function Zx(t,e){const s=t.pane??e.pane;return s?{...t,pane:s}:t}var Am={exports:{}};var TR=Am.exports,sw;function a2(){return sw||(sw=1,(function(t,e){(function(s,l){l(e)})(TR,(function(s){var l="1.9.4";function f(u){var b,M,$,Z;for(M=1,$=arguments.length;M<$;M++){Z=arguments[M];for(b in Z)u[b]=Z[b]}return u}var _=Object.create||(function(){function u(){}return function(b){return u.prototype=b,new u}})();function y(u,b){var M=Array.prototype.slice;if(u.bind)return u.bind.apply(u,M.call(arguments,1));var $=M.call(arguments,2);return function(){return u.apply(b,$.length?$.concat(M.call(arguments)):arguments)}}var d=0;function A(u){return"_leaflet_id"in u||(u._leaflet_id=++d),u._leaflet_id}function I(u,b,M){var $,Z,ce,Ae;return Ae=function(){$=!1,Z&&(ce.apply(M,Z),Z=!1)},ce=function(){$?Z=arguments:(u.apply(M,arguments),setTimeout(Ae,b),$=!0)},ce}function B(u,b,M){var $=b[1],Z=b[0],ce=$-Z;return u===$&&M?u:((u-Z)%ce+ce)%ce+Z}function N(){return!1}function V(u,b){if(b===!1)return u;var M=Math.pow(10,b===void 0?6:b);return Math.round(u*M)/M}function K(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function se(u){return K(u).split(/\s+/)}function ne(u,b){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?_(u.options):{});for(var M in b)u.options[M]=b[M];return u.options}function ve(u,b,M){var $=[];for(var Z in u)$.push(encodeURIComponent(M?Z.toUpperCase():Z)+"="+encodeURIComponent(u[Z]));return(!b||b.indexOf("?")===-1?"?":"&")+$.join("&")}var re=/\{ *([\w_ -]+) *\}/g;function ge(u,b){return u.replace(re,function(M,$){var Z=b[$];if(Z===void 0)throw new Error("No value provided for variable "+M);return typeof Z=="function"&&(Z=Z(b)),Z})}var oe=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function me(u,b){for(var M=0;M<u.length;M++)if(u[M]===b)return M;return-1}var ye="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ke(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var Re=0;function Ge(u){var b=+new Date,M=Math.max(0,16-(b-Re));return Re=b+M,window.setTimeout(u,M)}var He=window.requestAnimationFrame||ke("RequestAnimationFrame")||Ge,Xe=window.cancelAnimationFrame||ke("CancelAnimationFrame")||ke("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function at(u,b,M){if(M&&He===Ge)u.call(b);else return He.call(window,y(u,b))}function et(u){u&&Xe.call(window,u)}var Et={__proto__:null,extend:f,create:_,bind:y,get lastId(){return d},stamp:A,throttle:I,wrapNum:B,falseFn:N,formatNum:V,trim:K,splitWords:se,setOptions:ne,getParamString:ve,template:ge,isArray:oe,indexOf:me,emptyImageUrl:ye,requestFn:He,cancelFn:Xe,requestAnimFrame:at,cancelAnimFrame:et};function gt(){}gt.extend=function(u){var b=function(){ne(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},M=b.__super__=this.prototype,$=_(M);$.constructor=b,b.prototype=$;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(b[Z]=this[Z]);return u.statics&&f(b,u.statics),u.includes&&(pt(u.includes),f.apply(null,[$].concat(u.includes))),f($,u),delete $.statics,delete $.includes,$.options&&($.options=M.options?_(M.options):{},f($.options,u.options)),$._initHooks=[],$.callInitHooks=function(){if(!this._initHooksCalled){M.callInitHooks&&M.callInitHooks.call(this),this._initHooksCalled=!0;for(var ce=0,Ae=$._initHooks.length;ce<Ae;ce++)$._initHooks[ce].call(this)}},b},gt.include=function(u){var b=this.prototype.options;return f(this.prototype,u),u.options&&(this.prototype.options=b,this.mergeOptions(u.options)),this},gt.mergeOptions=function(u){return f(this.prototype.options,u),this},gt.addInitHook=function(u){var b=Array.prototype.slice.call(arguments,1),M=typeof u=="function"?u:function(){this[u].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(M),this};function pt(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=oe(u)?u:[u];for(var b=0;b<u.length;b++)u[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var $e={on:function(u,b,M){if(typeof u=="object")for(var $ in u)this._on($,u[$],b);else{u=se(u);for(var Z=0,ce=u.length;Z<ce;Z++)this._on(u[Z],b,M)}return this},off:function(u,b,M){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var $ in u)this._off($,u[$],b);else{u=se(u);for(var Z=arguments.length===1,ce=0,Ae=u.length;ce<Ae;ce++)Z?this._off(u[ce]):this._off(u[ce],b,M)}return this},_on:function(u,b,M,$){if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}if(this._listens(u,b,M)===!1){M===this&&(M=void 0);var Z={fn:b,ctx:M};$&&(Z.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(Z)}},_off:function(u,b,M){var $,Z,ce;if(this._events&&($=this._events[u],!!$)){if(arguments.length===1){if(this._firingCount)for(Z=0,ce=$.length;Z<ce;Z++)$[Z].fn=N;delete this._events[u];return}if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}var Ae=this._listens(u,b,M);if(Ae!==!1){var Je=$[Ae];this._firingCount&&(Je.fn=N,this._events[u]=$=$.slice()),$.splice(Ae,1)}}},fire:function(u,b,M){if(!this.listens(u,M))return this;var $=f({},b,{type:u,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events){var Z=this._events[u];if(Z){this._firingCount=this._firingCount+1||1;for(var ce=0,Ae=Z.length;ce<Ae;ce++){var Je=Z[ce],dt=Je.fn;Je.once&&this.off(u,dt,Je.ctx),dt.call(Je.ctx||this,$)}this._firingCount--}}return M&&this._propagateEvent($),this},listens:function(u,b,M,$){typeof u!="string"&&console.warn('"string" type argument expected');var Z=b;typeof b!="function"&&($=!!b,Z=void 0,M=void 0);var ce=this._events&&this._events[u];if(ce&&ce.length&&this._listens(u,Z,M)!==!1)return!0;if($){for(var Ae in this._eventParents)if(this._eventParents[Ae].listens(u,b,M,$))return!0}return!1},_listens:function(u,b,M){if(!this._events)return!1;var $=this._events[u]||[];if(!b)return!!$.length;M===this&&(M=void 0);for(var Z=0,ce=$.length;Z<ce;Z++)if($[Z].fn===b&&$[Z].ctx===M)return Z;return!1},once:function(u,b,M){if(typeof u=="object")for(var $ in u)this._on($,u[$],b,!0);else{u=se(u);for(var Z=0,ce=u.length;Z<ce;Z++)this._on(u[Z],b,M,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[A(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[A(u)],this},_propagateEvent:function(u){for(var b in this._eventParents)this._eventParents[b].fire(u.type,f({layer:u.target,propagatedFrom:u.target},u),!0)}};$e.addEventListener=$e.on,$e.removeEventListener=$e.clearAllEventListeners=$e.off,$e.addOneTimeEventListener=$e.once,$e.fireEvent=$e.fire,$e.hasEventListeners=$e.listens;var ct=gt.extend($e);function We(u,b,M){this.x=M?Math.round(u):u,this.y=M?Math.round(b):b}var Tt=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};We.prototype={clone:function(){return new We(this.x,this.y)},add:function(u){return this.clone()._add(lt(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(lt(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new We(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new We(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Tt(this.x),this.y=Tt(this.y),this},distanceTo:function(u){u=lt(u);var b=u.x-this.x,M=u.y-this.y;return Math.sqrt(b*b+M*M)},equals:function(u){return u=lt(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=lt(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+V(this.x)+", "+V(this.y)+")"}};function lt(u,b,M){return u instanceof We?u:oe(u)?new We(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new We(u.x,u.y):new We(u,b,M)}function xe(u,b){if(u)for(var M=b?[u,b]:u,$=0,Z=M.length;$<Z;$++)this.extend(M[$])}xe.prototype={extend:function(u){var b,M;if(!u)return this;if(u instanceof We||typeof u[0]=="number"||"x"in u)b=M=lt(u);else if(u=Ce(u),b=u.min,M=u.max,!b||!M)return this;return!this.min&&!this.max?(this.min=b.clone(),this.max=M.clone()):(this.min.x=Math.min(b.x,this.min.x),this.max.x=Math.max(M.x,this.max.x),this.min.y=Math.min(b.y,this.min.y),this.max.y=Math.max(M.y,this.max.y)),this},getCenter:function(u){return lt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return lt(this.min.x,this.max.y)},getTopRight:function(){return lt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var b,M;return typeof u[0]=="number"||u instanceof We?u=lt(u):u=Ce(u),u instanceof xe?(b=u.min,M=u.max):b=M=u,b.x>=this.min.x&&M.x<=this.max.x&&b.y>=this.min.y&&M.y<=this.max.y},intersects:function(u){u=Ce(u);var b=this.min,M=this.max,$=u.min,Z=u.max,ce=Z.x>=b.x&&$.x<=M.x,Ae=Z.y>=b.y&&$.y<=M.y;return ce&&Ae},overlaps:function(u){u=Ce(u);var b=this.min,M=this.max,$=u.min,Z=u.max,ce=Z.x>b.x&&$.x<M.x,Ae=Z.y>b.y&&$.y<M.y;return ce&&Ae},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var b=this.min,M=this.max,$=Math.abs(b.x-M.x)*u,Z=Math.abs(b.y-M.y)*u;return Ce(lt(b.x-$,b.y-Z),lt(M.x+$,M.y+Z))},equals:function(u){return u?(u=Ce(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function Ce(u,b){return!u||u instanceof xe?u:new xe(u,b)}function st(u,b){if(u)for(var M=b?[u,b]:u,$=0,Z=M.length;$<Z;$++)this.extend(M[$])}st.prototype={extend:function(u){var b=this._southWest,M=this._northEast,$,Z;if(u instanceof _t)$=u,Z=u;else if(u instanceof st){if($=u._southWest,Z=u._northEast,!$||!Z)return this}else return u?this.extend(kt(u)||ot(u)):this;return!b&&!M?(this._southWest=new _t($.lat,$.lng),this._northEast=new _t(Z.lat,Z.lng)):(b.lat=Math.min($.lat,b.lat),b.lng=Math.min($.lng,b.lng),M.lat=Math.max(Z.lat,M.lat),M.lng=Math.max(Z.lng,M.lng)),this},pad:function(u){var b=this._southWest,M=this._northEast,$=Math.abs(b.lat-M.lat)*u,Z=Math.abs(b.lng-M.lng)*u;return new st(new _t(b.lat-$,b.lng-Z),new _t(M.lat+$,M.lng+Z))},getCenter:function(){return new _t((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new _t(this.getNorth(),this.getWest())},getSouthEast:function(){return new _t(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof _t||"lat"in u?u=kt(u):u=ot(u);var b=this._southWest,M=this._northEast,$,Z;return u instanceof st?($=u.getSouthWest(),Z=u.getNorthEast()):$=Z=u,$.lat>=b.lat&&Z.lat<=M.lat&&$.lng>=b.lng&&Z.lng<=M.lng},intersects:function(u){u=ot(u);var b=this._southWest,M=this._northEast,$=u.getSouthWest(),Z=u.getNorthEast(),ce=Z.lat>=b.lat&&$.lat<=M.lat,Ae=Z.lng>=b.lng&&$.lng<=M.lng;return ce&&Ae},overlaps:function(u){u=ot(u);var b=this._southWest,M=this._northEast,$=u.getSouthWest(),Z=u.getNorthEast(),ce=Z.lat>b.lat&&$.lat<M.lat,Ae=Z.lng>b.lng&&$.lng<M.lng;return ce&&Ae},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,b){return u?(u=ot(u),this._southWest.equals(u.getSouthWest(),b)&&this._northEast.equals(u.getNorthEast(),b)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ot(u,b){return u instanceof st?u:new st(u,b)}function _t(u,b,M){if(isNaN(u)||isNaN(b))throw new Error("Invalid LatLng object: ("+u+", "+b+")");this.lat=+u,this.lng=+b,M!==void 0&&(this.alt=+M)}_t.prototype={equals:function(u,b){if(!u)return!1;u=kt(u);var M=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return M<=(b===void 0?1e-9:b)},toString:function(u){return"LatLng("+V(this.lat,u)+", "+V(this.lng,u)+")"},distanceTo:function(u){return ei.distance(this,kt(u))},wrap:function(){return ei.wrapLatLng(this)},toBounds:function(u){var b=180*u/40075017,M=b/Math.cos(Math.PI/180*this.lat);return ot([this.lat-b,this.lng-M],[this.lat+b,this.lng+M])},clone:function(){return new _t(this.lat,this.lng,this.alt)}};function kt(u,b,M){return u instanceof _t?u:oe(u)&&typeof u[0]!="object"?u.length===3?new _t(u[0],u[1],u[2]):u.length===2?new _t(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new _t(u.lat,"lng"in u?u.lng:u.lon,u.alt):b===void 0?null:new _t(u,b,M)}var It={latLngToPoint:function(u,b){var M=this.projection.project(u),$=this.scale(b);return this.transformation._transform(M,$)},pointToLatLng:function(u,b){var M=this.scale(b),$=this.transformation.untransform(u,M);return this.projection.unproject($)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var b=this.projection.bounds,M=this.scale(u),$=this.transformation.transform(b.min,M),Z=this.transformation.transform(b.max,M);return new xe($,Z)},infinite:!1,wrapLatLng:function(u){var b=this.wrapLng?B(u.lng,this.wrapLng,!0):u.lng,M=this.wrapLat?B(u.lat,this.wrapLat,!0):u.lat,$=u.alt;return new _t(M,b,$)},wrapLatLngBounds:function(u){var b=u.getCenter(),M=this.wrapLatLng(b),$=b.lat-M.lat,Z=b.lng-M.lng;if($===0&&Z===0)return u;var ce=u.getSouthWest(),Ae=u.getNorthEast(),Je=new _t(ce.lat-$,ce.lng-Z),dt=new _t(Ae.lat-$,Ae.lng-Z);return new st(Je,dt)}},ei=f({},It,{wrapLng:[-180,180],R:6371e3,distance:function(u,b){var M=Math.PI/180,$=u.lat*M,Z=b.lat*M,ce=Math.sin((b.lat-u.lat)*M/2),Ae=Math.sin((b.lng-u.lng)*M/2),Je=ce*ce+Math.cos($)*Math.cos(Z)*Ae*Ae,dt=2*Math.atan2(Math.sqrt(Je),Math.sqrt(1-Je));return this.R*dt}}),li=6378137,Gi={R:li,MAX_LATITUDE:85.0511287798,project:function(u){var b=Math.PI/180,M=this.MAX_LATITUDE,$=Math.max(Math.min(M,u.lat),-M),Z=Math.sin($*b);return new We(this.R*u.lng*b,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(u){var b=180/Math.PI;return new _t((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*b,u.x*b/this.R)},bounds:(function(){var u=li*Math.PI;return new xe([-u,-u],[u,u])})()};function Mi(u,b,M,$){if(oe(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=b,this._c=M,this._d=$}Mi.prototype={transform:function(u,b){return this._transform(u.clone(),b)},_transform:function(u,b){return b=b||1,u.x=b*(this._a*u.x+this._b),u.y=b*(this._c*u.y+this._d),u},untransform:function(u,b){return b=b||1,new We((u.x/b-this._b)/this._a,(u.y/b-this._d)/this._c)}};function Di(u,b,M,$){return new Mi(u,b,M,$)}var Pn=f({},ei,{code:"EPSG:3857",projection:Gi,transformation:(function(){var u=.5/(Math.PI*Gi.R);return Di(u,.5,-u,.5)})()}),hn=f({},Pn,{code:"EPSG:900913"});function zn(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function it(u,b){var M="",$,Z,ce,Ae,Je,dt;for($=0,ce=u.length;$<ce;$++){for(Je=u[$],Z=0,Ae=Je.length;Z<Ae;Z++)dt=Je[Z],M+=(Z?"L":"M")+dt.x+" "+dt.y;M+=b?Ve.svg?"z":"x":""}return M||"M0 0"}var Qn=document.documentElement.style,qn="ActiveXObject"in window,wi=qn&&!document.addEventListener,fi="msLaunchUri"in navigator&&!("documentMode"in document),xn=Oe("webkit"),Hn=Oe("android"),es=Oe("android 2")||Oe("android 3"),Xi=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ki=Hn&&Oe("Google")&&Xi<537&&!("AudioNode"in window),Wi=!!window.opera,gs=!fi&&Oe("chrome"),Ct=Oe("gecko")&&!xn&&!Wi&&!qn,In=!gs&&Oe("safari"),an=Oe("phantom"),Tn="OTransition"in Qn,Zn=navigator.platform.indexOf("Win")===0,jt=qn&&"transition"in Qn,ri="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!es,Jt="MozPerspective"in Qn,Bi=!window.L_DISABLE_3D&&(jt||ri||Jt)&&!Tn&&!an,jn=typeof orientation<"u"||Oe("mobile"),ci=jn&&xn,xs=jn&&ri,Dn=!window.PointerEvent&&window.MSPointerEvent,$n=!!(window.PointerEvent||Dn),Ji="ontouchstart"in window||!!window.TouchEvent,be=!window.L_NO_TOUCH&&(Ji||$n),ie=jn&&Wi,te=jn&&Ct,he=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,we=(function(){var u=!1;try{var b=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",N,b),window.removeEventListener("testPassiveEventSupport",N,b)}catch{}return u})(),je=(function(){return!!document.createElement("canvas").getContext})(),Ne=!!(document.createElementNS&&zn("svg").createSVGRect),Ze=!!Ne&&(function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ee=!Ne&&(function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var b=u.firstChild;return b.style.behavior="url(#default#VML)",b&&typeof b.adj=="object"}catch{return!1}})(),Le=navigator.platform.indexOf("Mac")===0,Ue=navigator.platform.indexOf("Linux")===0;function Oe(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var Ve={ie:qn,ielt9:wi,edge:fi,webkit:xn,android:Hn,android23:es,androidStock:Ki,opera:Wi,chrome:gs,gecko:Ct,safari:In,phantom:an,opera12:Tn,win:Zn,ie3d:jt,webkit3d:ri,gecko3d:Jt,any3d:Bi,mobile:jn,mobileWebkit:ci,mobileWebkit3d:xs,msPointer:Dn,pointer:$n,touch:be,touchNative:Ji,mobileOpera:ie,mobileGecko:te,retina:he,passiveEvents:we,canvas:je,svg:Ne,vml:ee,inlineSvg:Ze,mac:Le,linux:Ue},Bt=Ve.msPointer?"MSPointerDown":"pointerdown",qt=Ve.msPointer?"MSPointerMove":"pointermove",Dt=Ve.msPointer?"MSPointerUp":"pointerup",At=Ve.msPointer?"MSPointerCancel":"pointercancel",ti={touchstart:Bt,touchmove:qt,touchend:Dt,touchcancel:At},pi={touchstart:ut,touchmove:ln,touchend:ln,touchcancel:ln},ji={},Qi=!1;function gi(u,b,M){return b==="touchstart"&&ui(),pi[b]?(M=pi[b].bind(this,M),u.addEventListener(ti[b],M,!1),M):(console.warn("wrong event specified:",b),N)}function qi(u,b,M){if(!ti[b]){console.warn("wrong event specified:",b);return}u.removeEventListener(ti[b],M,!1)}function on(u){ji[u.pointerId]=u}function Qe(u){ji[u.pointerId]&&(ji[u.pointerId]=u)}function Ot(u){delete ji[u.pointerId]}function ui(){Qi||(document.addEventListener(Bt,on,!0),document.addEventListener(qt,Qe,!0),document.addEventListener(Dt,Ot,!0),document.addEventListener(At,Ot,!0),Qi=!0)}function ln(u,b){if(b.pointerType!==(b.MSPOINTER_TYPE_MOUSE||"mouse")){b.touches=[];for(var M in ji)b.touches.push(ji[M]);b.changedTouches=[b],u(b)}}function ut(u,b){b.MSPOINTER_TYPE_TOUCH&&b.pointerType===b.MSPOINTER_TYPE_TOUCH&&Ts(b),ln(u,b)}function Ft(u){var b={},M,$;for($ in u)M=u[$],b[$]=M&&M.bind?M.bind(u):M;return u=b,b.type="dblclick",b.detail=2,b.isTrusted=!1,b._simulated=!0,b}var Ti=200;function en(u,b){u.addEventListener("dblclick",b);var M=0,$;function Z(ce){if(ce.detail!==1){$=ce.detail;return}if(!(ce.pointerType==="mouse"||ce.sourceCapabilities&&!ce.sourceCapabilities.firesTouchEvents)){var Ae=Ko(ce);if(!(Ae.some(function(dt){return dt instanceof HTMLLabelElement&&dt.attributes.for})&&!Ae.some(function(dt){return dt instanceof HTMLInputElement||dt instanceof HTMLSelectElement}))){var Je=Date.now();Je-M<=Ti?($++,$===2&&b(Ft(ce))):$=1,M=Je}}}return u.addEventListener("click",Z),{dblclick:b,simDblclick:Z}}function Li(u,b){u.removeEventListener("dblclick",b.dblclick),u.removeEventListener("click",b.simDblclick)}var vr=mn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),On=mn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Is=On==="webkitTransition"||On==="OTransition"?On+"End":"transitionend";function Ir(u){return typeof u=="string"?document.getElementById(u):u}function rr(u,b){var M=u.style[b]||u.currentStyle&&u.currentStyle[b];if((!M||M==="auto")&&document.defaultView){var $=document.defaultView.getComputedStyle(u,null);M=$?$[b]:null}return M==="auto"?null:M}function yi(u,b,M){var $=document.createElement(u);return $.className=b||"",M&&M.appendChild($),$}function An(u){var b=u.parentNode;b&&b.removeChild(u)}function bs(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function pn(u){var b=u.parentNode;b&&b.lastChild!==u&&b.appendChild(u)}function Na(u){var b=u.parentNode;b&&b.firstChild!==u&&b.insertBefore(u,b.firstChild)}function qr(u,b){if(u.classList!==void 0)return u.classList.contains(b);var M=Wo(u);return M.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(M)}function $i(u,b){if(u.classList!==void 0)for(var M=se(b),$=0,Z=M.length;$<Z;$++)u.classList.add(M[$]);else if(!qr(u,b)){var ce=Wo(u);Pl(u,(ce?ce+" ":"")+b)}}function Ln(u,b){u.classList!==void 0?u.classList.remove(b):Pl(u,K((" "+Wo(u)+" ").replace(" "+b+" "," ")))}function Pl(u,b){u.className.baseVal===void 0?u.className=b:u.className.baseVal=b}function Wo(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function Un(u,b){"opacity"in u.style?u.style.opacity=b:"filter"in u.style&&Ba(u,b)}function Ba(u,b){var M=!1,$="DXImageTransform.Microsoft.Alpha";try{M=u.filters.item($)}catch{if(b===1)return}b=Math.round(b*100),M?(M.Enabled=b!==100,M.Opacity=b):u.style.filter+=" progid:"+$+"(opacity="+b+")"}function mn(u){for(var b=document.documentElement.style,M=0;M<u.length;M++)if(u[M]in b)return u[M];return!1}function wa(u,b,M){var $=b||new We(0,0);u.style[vr]=(Ve.ie3d?"translate("+$.x+"px,"+$.y+"px)":"translate3d("+$.x+"px,"+$.y+"px,0)")+(M?" scale("+M+")":"")}function Xn(u,b){u._leaflet_pos=b,Ve.any3d?wa(u,b):(u.style.left=b.x+"px",u.style.top=b.y+"px")}function Hr(u){return u._leaflet_pos||new We(0,0)}var Co,Zr,Yo;if("onselectstart"in document)Co=function(){Ii(window,"selectstart",Ts)},Zr=function(){Rn(window,"selectstart",Ts)};else{var oo=mn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Co=function(){if(oo){var u=document.documentElement.style;Yo=u[oo],u[oo]="none"}},Zr=function(){oo&&(document.documentElement.style[oo]=Yo,Yo=void 0)}}function lo(){Ii(window,"dragstart",Ts)}function Il(){Rn(window,"dragstart",Ts)}var Ic,jc;function jl(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&(qs(),Ic=u,jc=u.style.outlineStyle,u.style.outlineStyle="none",Ii(window,"keydown",qs))}function qs(){Ic&&(Ic.style.outlineStyle=jc,Ic=void 0,jc=void 0,Rn(window,"keydown",qs))}function Ao(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function Hs(u){var b=u.getBoundingClientRect();return{x:b.width/u.offsetWidth||1,y:b.height/u.offsetHeight||1,boundingClientRect:b}}var Bs={__proto__:null,TRANSFORM:vr,TRANSITION:On,TRANSITION_END:Is,get:Ir,getStyle:rr,create:yi,remove:An,empty:bs,toFront:pn,toBack:Na,hasClass:qr,addClass:$i,removeClass:Ln,setClass:Pl,getClass:Wo,setOpacity:Un,testProp:mn,setTransform:wa,setPosition:Xn,getPosition:Hr,get disableTextSelection(){return Co},get enableTextSelection(){return Zr},disableImageDrag:lo,enableImageDrag:Il,preventOutline:jl,restoreOutline:qs,getSizedParentNode:Ao,getScale:Hs};function Ii(u,b,M,$){if(b&&typeof b=="object")for(var Z in b)Sa(u,Z,b[Z],M);else{b=se(b);for(var ce=0,Ae=b.length;ce<Ae;ce++)Sa(u,b[ce],M,$)}return this}var jr="_leaflet_events";function Rn(u,b,M,$){if(arguments.length===1)Lc(u),delete u[jr];else if(b&&typeof b=="object")for(var Z in b)Ll(u,Z,b[Z],M);else if(b=se(b),arguments.length===2)Lc(u,function(Je){return me(b,Je)!==-1});else for(var ce=0,Ae=b.length;ce<Ae;ce++)Ll(u,b[ce],M,$);return this}function Lc(u,b){for(var M in u[jr]){var $=M.split(/\d/)[0];(!b||b($))&&Ll(u,$,null,null,M)}}var aa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Sa(u,b,M,$){var Z=b+A(M)+($?"_"+A($):"");if(u[jr]&&u[jr][Z])return this;var ce=function(Je){return M.call($||u,Je||window.event)},Ae=ce;!Ve.touchNative&&Ve.pointer&&b.indexOf("touch")===0?ce=gi(u,b,ce):Ve.touch&&b==="dblclick"?ce=en(u,ce):"addEventListener"in u?b==="touchstart"||b==="touchmove"||b==="wheel"||b==="mousewheel"?u.addEventListener(aa[b]||b,ce,Ve.passiveEvents?{passive:!1}:!1):b==="mouseenter"||b==="mouseleave"?(ce=function(Je){Je=Je||window.event,Zs(u,Je)&&Ae(Je)},u.addEventListener(aa[b],ce,!1)):u.addEventListener(b,Ae,!1):u.attachEvent("on"+b,ce),u[jr]=u[jr]||{},u[jr][Z]=ce}function Ll(u,b,M,$,Z){Z=Z||b+A(M)+($?"_"+A($):"");var ce=u[jr]&&u[jr][Z];if(!ce)return this;!Ve.touchNative&&Ve.pointer&&b.indexOf("touch")===0?qi(u,b,ce):Ve.touch&&b==="dblclick"?Li(u,ce):"removeEventListener"in u?u.removeEventListener(aa[b]||b,ce,!1):u.detachEvent("on"+b,ce),u[jr][Z]=null}function oa(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function $a(u){return Sa(u,"wheel",oa),this}function Xo(u){return Ii(u,"mousedown touchstart dblclick contextmenu",oa),u._leaflet_disable_click=!0,this}function Ts(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function la(u){return Ts(u),oa(u),this}function Ko(u){if(u.composedPath)return u.composedPath();for(var b=[],M=u.target;M;)b.push(M),M=M.parentNode;return b}function Mo(u,b){if(!b)return new We(u.clientX,u.clientY);var M=Hs(b),$=M.boundingClientRect;return new We((u.clientX-$.left)/M.x-b.clientLeft,(u.clientY-$.top)/M.y-b.clientTop)}var Rc=Ve.linux&&Ve.chrome?window.devicePixelRatio:Ve.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Qs(u){return Ve.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/Rc:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function Zs(u,b){var M=b.relatedTarget;if(!M)return!0;try{for(;M&&M!==u;)M=M.parentNode}catch{return!1}return M!==u}var zc={__proto__:null,on:Ii,off:Rn,stopPropagation:oa,disableScrollPropagation:$a,disableClickPropagation:Xo,preventDefault:Ts,stop:la,getPropagationPath:Ko,getMousePosition:Mo,getWheelDelta:Qs,isExternalTarget:Zs,addListener:Ii,removeListener:Rn},Po=ct.extend({run:function(u,b,M,$){this.stop(),this._el=u,this._inProgress=!0,this._duration=M||.25,this._easeOutPower=1/Math.max($||.5,.2),this._startPos=Hr(u),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=at(this._animate,this),this._step()},_step:function(u){var b=+new Date-this._startTime,M=this._duration*1e3;b<M?this._runFrame(this._easeOut(b/M),u):(this._runFrame(1),this._complete())},_runFrame:function(u,b){var M=this._startPos.add(this._offset.multiplyBy(u));b&&M._round(),Xn(this._el,M),this.fire("step")},_complete:function(){et(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),tn=ct.extend({options:{crs:Pn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,b){b=ne(this,b),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=y(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==void 0&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==void 0&&this.setView(kt(b.center),b.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=On&&Ve.any3d&&!Ve.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ii(this._proxy,Is,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,b,M){if(b=b===void 0?this._zoom:this._limitZoom(b),u=this._limitCenter(kt(u),b,this.options.maxBounds),M=M||{},this._stop(),this._loaded&&!M.reset&&M!==!0){M.animate!==void 0&&(M.zoom=f({animate:M.animate},M.zoom),M.pan=f({animate:M.animate,duration:M.duration},M.pan));var $=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,b,M.zoom):this._tryAnimatedPan(u,M.pan);if($)return clearTimeout(this._sizeTimer),this}return this._resetView(u,b,M.pan&&M.pan.noMoveStart),this},setZoom:function(u,b){return this._loaded?this.setView(this.getCenter(),u,{zoom:b}):(this._zoom=u,this)},zoomIn:function(u,b){return u=u||(Ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,b)},zoomOut:function(u,b){return u=u||(Ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,b)},setZoomAround:function(u,b,M){var $=this.getZoomScale(b),Z=this.getSize().divideBy(2),ce=u instanceof We?u:this.latLngToContainerPoint(u),Ae=ce.subtract(Z).multiplyBy(1-1/$),Je=this.containerPointToLatLng(Z.add(Ae));return this.setView(Je,b,{zoom:M})},_getBoundsCenterZoom:function(u,b){b=b||{},u=u.getBounds?u.getBounds():ot(u);var M=lt(b.paddingTopLeft||b.padding||[0,0]),$=lt(b.paddingBottomRight||b.padding||[0,0]),Z=this.getBoundsZoom(u,!1,M.add($));if(Z=typeof b.maxZoom=="number"?Math.min(b.maxZoom,Z):Z,Z===1/0)return{center:u.getCenter(),zoom:Z};var ce=$.subtract(M).divideBy(2),Ae=this.project(u.getSouthWest(),Z),Je=this.project(u.getNorthEast(),Z),dt=this.unproject(Ae.add(Je).divideBy(2).add(ce),Z);return{center:dt,zoom:Z}},fitBounds:function(u,b){if(u=ot(u),!u.isValid())throw new Error("Bounds are not valid.");var M=this._getBoundsCenterZoom(u,b);return this.setView(M.center,M.zoom,b)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,b){return this.setView(u,this._zoom,{pan:b})},panBy:function(u,b){if(u=lt(u).round(),b=b||{},!u.x&&!u.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Po,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){$i(this._mapPane,"leaflet-pan-anim");var M=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,M,b.duration||.25,b.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,b,M){if(M=M||{},M.animate===!1||!Ve.any3d)return this.setView(u,b,M);this._stop();var $=this.project(this.getCenter()),Z=this.project(u),ce=this.getSize(),Ae=this._zoom;u=kt(u),b=b===void 0?Ae:b;var Je=Math.max(ce.x,ce.y),dt=Je*this.getZoomScale(Ae,b),wt=Z.distanceTo($)||1,Yt=1.42,_i=Yt*Yt;function un(_s){var Oi=_s?-1:1,yo=_s?dt:Je,ku=dt*dt-Je*Je+Oi*_i*_i*wt*wt,gl=2*yo*_i*wt,cc=ku/gl,Qr=Math.sqrt(cc*cc+1)-cc,Za=Qr<1e-9?-18:Math.log(Qr);return Za}function Ws(_s){return(Math.exp(_s)-Math.exp(-_s))/2}function Es(_s){return(Math.exp(_s)+Math.exp(-_s))/2}function Tr(_s){return Ws(_s)/Es(_s)}var bn=un(0);function Yi(_s){return Je*(Es(bn)/Es(bn+Yt*_s))}function Lt(_s){return Je*(Es(bn)*Tr(bn+Yt*_s)-Ws(bn))/_i}function Ma(_s){return 1-Math.pow(1-_s,1.5)}var zr=Date.now(),lc=(un(1)-bn)/Yt,Jr=M.duration?1e3*M.duration:1e3*lc*.8;function Do(){var _s=(Date.now()-zr)/Jr,Oi=Ma(_s)*lc;_s<=1?(this._flyToFrame=at(Do,this),this._move(this.unproject($.add(Z.subtract($).multiplyBy(Lt(Oi)/wt)),Ae),this.getScaleZoom(Je/Yi(Oi),Ae),{flyTo:!0})):this._move(u,b)._moveEnd(!0)}return this._moveStart(!0,M.noMoveStart),Do.call(this),this},flyToBounds:function(u,b){var M=this._getBoundsCenterZoom(u,b);return this.flyTo(M.center,M.zoom,b)},setMaxBounds:function(u){return u=ot(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var b=this.options.minZoom;return this.options.minZoom=u,this._loaded&&b!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var b=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&b!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,b){this._enforcingBounds=!0;var M=this.getCenter(),$=this._limitCenter(M,this._zoom,ot(u));return M.equals($)||this.panTo($,b),this._enforcingBounds=!1,this},panInside:function(u,b){b=b||{};var M=lt(b.paddingTopLeft||b.padding||[0,0]),$=lt(b.paddingBottomRight||b.padding||[0,0]),Z=this.project(this.getCenter()),ce=this.project(u),Ae=this.getPixelBounds(),Je=Ce([Ae.min.add(M),Ae.max.subtract($)]),dt=Je.getSize();if(!Je.contains(ce)){this._enforcingBounds=!0;var wt=ce.subtract(Je.getCenter()),Yt=Je.extend(ce).getSize().subtract(dt);Z.x+=wt.x<0?-Yt.x:Yt.x,Z.y+=wt.y<0?-Yt.y:Yt.y,this.panTo(this.unproject(Z),b),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=f({animate:!1,pan:!0},u===!0?{animate:!0}:u);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var M=this.getSize(),$=b.divideBy(2).round(),Z=M.divideBy(2).round(),ce=$.subtract(Z);return!ce.x&&!ce.y?this:(u.animate&&u.pan?this.panBy(ce):(u.pan&&this._rawPanBy(ce),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(y(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:M}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=f({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=y(this._handleGeolocationResponse,this),M=y(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,M,u):navigator.geolocation.getCurrentPosition(b,M,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var b=u.code,M=u.message||(b===1?"permission denied":b===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+M+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var b=u.coords.latitude,M=u.coords.longitude,$=new _t(b,M),Z=$.toBounds(u.coords.accuracy*2),ce=this._locateOptions;if(ce.setView){var Ae=this.getBoundsZoom(Z);this.setView($,ce.maxZoom?Math.min(Ae,ce.maxZoom):Ae)}var Je={latlng:$,bounds:Z,timestamp:u.timestamp};for(var dt in u.coords)typeof u.coords[dt]=="number"&&(Je[dt]=u.coords[dt]);this.fire("locationfound",Je)}},addHandler:function(u,b){if(!b)return this;var M=this[u]=new b(this);return this._handlers.push(M),this.options[u]&&M.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),An(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(et(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)An(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,b){var M="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),$=yi("div",M,b||this._mapPane);return u&&(this._panes[u]=$),$},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),b=this.unproject(u.getBottomLeft()),M=this.unproject(u.getTopRight());return new st(b,M)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,b,M){u=ot(u),M=lt(M||[0,0]);var $=this.getZoom()||0,Z=this.getMinZoom(),ce=this.getMaxZoom(),Ae=u.getNorthWest(),Je=u.getSouthEast(),dt=this.getSize().subtract(M),wt=Ce(this.project(Je,$),this.project(Ae,$)).getSize(),Yt=Ve.any3d?this.options.zoomSnap:1,_i=dt.x/wt.x,un=dt.y/wt.y,Ws=b?Math.max(_i,un):Math.min(_i,un);return $=this.getScaleZoom(Ws,$),Yt&&($=Math.round($/(Yt/100))*(Yt/100),$=b?Math.ceil($/Yt)*Yt:Math.floor($/Yt)*Yt),Math.max(Z,Math.min(ce,$))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new We(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,b){var M=this._getTopLeftPoint(u,b);return new xe(M,M.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,b){var M=this.options.crs;return b=b===void 0?this._zoom:b,M.scale(u)/M.scale(b)},getScaleZoom:function(u,b){var M=this.options.crs;b=b===void 0?this._zoom:b;var $=M.zoom(u*M.scale(b));return isNaN($)?1/0:$},project:function(u,b){return b=b===void 0?this._zoom:b,this.options.crs.latLngToPoint(kt(u),b)},unproject:function(u,b){return b=b===void 0?this._zoom:b,this.options.crs.pointToLatLng(lt(u),b)},layerPointToLatLng:function(u){var b=lt(u).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(u){var b=this.project(kt(u))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(kt(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(ot(u))},distance:function(u,b){return this.options.crs.distance(kt(u),kt(b))},containerPointToLayerPoint:function(u){return lt(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return lt(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var b=this.containerPointToLayerPoint(lt(u));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(kt(u)))},mouseEventToContainerPoint:function(u){return Mo(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var b=this._container=Ir(u);if(b){if(b._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ii(b,"scroll",this._onScroll,this),this._containerId=A(b)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ve.any3d,$i(u,"leaflet-container"+(Ve.touch?" leaflet-touch":"")+(Ve.retina?" leaflet-retina":"")+(Ve.ielt9?" leaflet-oldie":"")+(Ve.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=rr(u,"position");b!=="absolute"&&b!=="relative"&&b!=="fixed"&&b!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Xn(this._mapPane,new We(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||($i(u.markerPane,"leaflet-zoom-hide"),$i(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,b,M){Xn(this._mapPane,new We(0,0));var $=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var Z=this._zoom!==b;this._moveStart(Z,M)._move(u,b)._moveEnd(Z),this.fire("viewreset"),$&&this.fire("load")},_moveStart:function(u,b){return u&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(u,b,M,$){b===void 0&&(b=this._zoom);var Z=this._zoom!==b;return this._zoom=b,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),$?M&&M.pinch&&this.fire("zoom",M):((Z||M&&M.pinch)&&this.fire("zoom",M),this.fire("move",M)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return et(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){Xn(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[A(this._container)]=this;var b=u?Rn:Ii;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),Ve.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){et(this._resizeRequest),this._resizeRequest=at(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,b){for(var M=[],$,Z=b==="mouseout"||b==="mouseover",ce=u.target||u.srcElement,Ae=!1;ce;){if($=this._targets[A(ce)],$&&(b==="click"||b==="preclick")&&this._draggableMoved($)){Ae=!0;break}if($&&$.listens(b,!0)&&(Z&&!Zs(ce,u)||(M.push($),Z))||ce===this._container)break;ce=ce.parentNode}return!M.length&&!Ae&&!Z&&this.listens(b,!0)&&(M=[this]),M},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var b=u.target||u.srcElement;if(!(!this._loaded||b._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(b))){var M=u.type;M==="mousedown"&&jl(b),this._fireDOMEvent(u,M)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,b,M){if(u.type==="click"){var $=f({},u);$.type="preclick",this._fireDOMEvent($,$.type,M)}var Z=this._findEventTargets(u,b);if(M){for(var ce=[],Ae=0;Ae<M.length;Ae++)M[Ae].listens(b,!0)&&ce.push(M[Ae]);Z=ce.concat(Z)}if(Z.length){b==="contextmenu"&&Ts(u);var Je=Z[0],dt={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var wt=Je.getLatLng&&(!Je._radius||Je._radius<=10);dt.containerPoint=wt?this.latLngToContainerPoint(Je.getLatLng()):this.mouseEventToContainerPoint(u),dt.layerPoint=this.containerPointToLayerPoint(dt.containerPoint),dt.latlng=wt?Je.getLatLng():this.layerPointToLatLng(dt.layerPoint)}for(Ae=0;Ae<Z.length;Ae++)if(Z[Ae].fire(b,dt,!0),dt.originalEvent._stopped||Z[Ae].options.bubblingMouseEvents===!1&&me(this._mouseEvents,b)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,b=this._handlers.length;u<b;u++)this._handlers[u].disable()},whenReady:function(u,b){return this._loaded?u.call(b||this,{target:this}):this.on("load",u,b),this},_getMapPanePos:function(){return Hr(this._mapPane)||new We(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,b){var M=u&&b!==void 0?this._getNewPixelOrigin(u,b):this.getPixelOrigin();return M.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,b){var M=this.getSize()._divideBy(2);return this.project(u,b)._subtract(M)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,b,M){var $=this._getNewPixelOrigin(M,b);return this.project(u,b)._subtract($)},_latLngBoundsToNewLayerBounds:function(u,b,M){var $=this._getNewPixelOrigin(M,b);return Ce([this.project(u.getSouthWest(),b)._subtract($),this.project(u.getNorthWest(),b)._subtract($),this.project(u.getSouthEast(),b)._subtract($),this.project(u.getNorthEast(),b)._subtract($)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,b,M){if(!M)return u;var $=this.project(u,b),Z=this.getSize().divideBy(2),ce=new xe($.subtract(Z),$.add(Z)),Ae=this._getBoundsOffset(ce,M,b);return Math.abs(Ae.x)<=1&&Math.abs(Ae.y)<=1?u:this.unproject($.add(Ae),b)},_limitOffset:function(u,b){if(!b)return u;var M=this.getPixelBounds(),$=new xe(M.min.add(u),M.max.add(u));return u.add(this._getBoundsOffset($,b))},_getBoundsOffset:function(u,b,M){var $=Ce(this.project(b.getNorthEast(),M),this.project(b.getSouthWest(),M)),Z=$.min.subtract(u.min),ce=$.max.subtract(u.max),Ae=this._rebound(Z.x,-ce.x),Je=this._rebound(Z.y,-ce.y);return new We(Ae,Je)},_rebound:function(u,b){return u+b>0?Math.round(u-b)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(b))},_limitZoom:function(u){var b=this.getMinZoom(),M=this.getMaxZoom(),$=Ve.any3d?this.options.zoomSnap:1;return $&&(u=Math.round(u/$)*$),Math.max(b,Math.min(M,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ln(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,b){var M=this._getCenterOffset(u)._trunc();return(b&&b.animate)!==!0&&!this.getSize().contains(M)?!1:(this.panBy(M,b),!0)},_createAnimProxy:function(){var u=this._proxy=yi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(b){var M=vr,$=this._proxy.style[M];wa(this._proxy,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),$===this._proxy.style[M]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){An(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),b=this.getZoom();wa(this._proxy,this.project(u,b),this.getZoomScale(b,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,b,M){if(this._animatingZoom)return!0;if(M=M||{},!this._zoomAnimated||M.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var $=this.getZoomScale(b),Z=this._getCenterOffset(u)._divideBy(1-1/$);return M.animate!==!0&&!this.getSize().contains(Z)?!1:(at(function(){this._moveStart(!0,M.noMoveStart||!1)._animateZoom(u,b,!0)},this),!0)},_animateZoom:function(u,b,M,$){this._mapPane&&(M&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=b,$i(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:b,noUpdate:$}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(y(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ln(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ua(u,b){return new tn(u,b)}var Ui=gt.extend({options:{position:"topright"},initialize:function(u){ne(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var b=this._map;return b&&b.removeControl(this),this.options.position=u,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var b=this._container=this.onAdd(u),M=this.getPosition(),$=u._controlCorners[M];return $i(b,"leaflet-control"),M.indexOf("bottom")!==-1?$.insertBefore(b,$.firstChild):$.appendChild(b),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(An(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),ca=function(u){return new Ui(u)};tn.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},b="leaflet-",M=this._controlContainer=yi("div",b+"control-container",this._container);function $(Z,ce){var Ae=b+Z+" "+b+ce;u[Z+ce]=yi("div",Ae,M)}$("top","left"),$("top","right"),$("bottom","left"),$("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)An(this._controlCorners[u]);An(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ec=Ui.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,b,M,$){return M<$?-1:$<M?1:0}},initialize:function(u,b,M){ne(this,M),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var $ in u)this._addLayer(u[$],$);for($ in b)this._addLayer(b[$],$,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return Ui.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,b){return this._addLayer(u,b),this._map?this._update():this},addOverlay:function(u,b){return this._addLayer(u,b,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var b=this._getLayer(A(u));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){$i(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?($i(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):Ln(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ln(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",b=this._container=yi("div",u),M=this.options.collapsed;b.setAttribute("aria-haspopup",!0),Xo(b),$a(b);var $=this._section=yi("section",u+"-list");M&&(this._map.on("click",this.collapse,this),Ii(b,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=yi("a",u+"-toggle",b);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),Ii(Z,{keydown:function(ce){ce.keyCode===13&&this._expandSafely()},click:function(ce){Ts(ce),this._expandSafely()}},this),M||this.expand(),this._baseLayersList=yi("div",u+"-base",$),this._separator=yi("div",u+"-separator",$),this._overlaysList=yi("div",u+"-overlays",$),b.appendChild($)},_getLayer:function(u){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&A(this._layers[b].layer)===u)return this._layers[b]},_addLayer:function(u,b,M){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:b,overlay:M}),this.options.sortLayers&&this._layers.sort(y(function($,Z){return this.options.sortFunction($.layer,Z.layer,$.name,Z.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;bs(this._baseLayersList),bs(this._overlaysList),this._layerControlInputs=[];var u,b,M,$,Z=0;for(M=0;M<this._layers.length;M++)$=this._layers[M],this._addItem($),b=b||$.overlay,u=u||!$.overlay,Z+=$.overlay?0:1;return this.options.hideSingleBase&&(u=u&&Z>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=b&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var b=this._getLayer(A(u.target)),M=b.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;M&&this._map.fire(M,b)},_createRadioElement:function(u,b){var M='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(b?' checked="checked"':"")+"/>",$=document.createElement("div");return $.innerHTML=M,$.firstChild},_addItem:function(u){var b=document.createElement("label"),M=this._map.hasLayer(u.layer),$;u.overlay?($=document.createElement("input"),$.type="checkbox",$.className="leaflet-control-layers-selector",$.defaultChecked=M):$=this._createRadioElement("leaflet-base-layers_"+A(this),M),this._layerControlInputs.push($),$.layerId=A(u.layer),Ii($,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+u.name;var ce=document.createElement("span");b.appendChild(ce),ce.appendChild($),ce.appendChild(Z);var Ae=u.overlay?this._overlaysList:this._baseLayersList;return Ae.appendChild(b),this._checkDisabledLayers(),b},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,b,M,$=[],Z=[];this._handlingClick=!0;for(var ce=u.length-1;ce>=0;ce--)b=u[ce],M=this._getLayer(b.layerId).layer,b.checked?$.push(M):b.checked||Z.push(M);for(ce=0;ce<Z.length;ce++)this._map.hasLayer(Z[ce])&&this._map.removeLayer(Z[ce]);for(ce=0;ce<$.length;ce++)this._map.hasLayer($[ce])||this._map.addLayer($[ce]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,b,M,$=this._map.getZoom(),Z=u.length-1;Z>=0;Z--)b=u[Z],M=this._getLayer(b.layerId).layer,b.disabled=M.options.minZoom!==void 0&&$<M.options.minZoom||M.options.maxZoom!==void 0&&$>M.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,Ii(u,"click",Ts),this.expand();var b=this;setTimeout(function(){Rn(u,"click",Ts),b._preventClick=!1})}}),Jo=function(u,b,M){return new ec(u,b,M)},yu=Ui.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var b="leaflet-control-zoom",M=yi("div",b+" leaflet-bar"),$=this.options;return this._zoomInButton=this._createButton($.zoomInText,$.zoomInTitle,b+"-in",M,this._zoomIn),this._zoomOutButton=this._createButton($.zoomOutText,$.zoomOutTitle,b+"-out",M,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),M},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,b,M,$,Z){var ce=yi("a",M,$);return ce.innerHTML=u,ce.href="#",ce.title=b,ce.setAttribute("role","button"),ce.setAttribute("aria-label",b),Xo(ce),Ii(ce,"click",la),Ii(ce,"click",Z,this),Ii(ce,"click",this._refocusOnMap,this),ce},_updateDisabled:function(){var u=this._map,b="leaflet-disabled";Ln(this._zoomInButton,b),Ln(this._zoomOutButton,b),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&($i(this._zoomOutButton,b),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&($i(this._zoomInButton,b),this._zoomInButton.setAttribute("aria-disabled","true"))}});tn.mergeOptions({zoomControl:!0}),tn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new yu,this.addControl(this.zoomControl))});var Qu=function(u){return new yu(u)},eh=Ui.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var b="leaflet-control-scale",M=yi("div",b),$=this.options;return this._addScales($,b+"-line",M),u.on($.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),M},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,b,M){u.metric&&(this._mScale=yi("div",b,M)),u.imperial&&(this._iScale=yi("div",b,M))},_update:function(){var u=this._map,b=u.getSize().y/2,M=u.distance(u.containerPointToLatLng([0,b]),u.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(M)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var b=this._getRoundNum(u),M=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,M,b/u)},_updateImperial:function(u){var b=u*3.2808399,M,$,Z;b>5280?(M=b/5280,$=this._getRoundNum(M),this._updateScale(this._iScale,$+" mi",$/M)):(Z=this._getRoundNum(b),this._updateScale(this._iScale,Z+" ft",Z/b))},_updateScale:function(u,b,M){u.style.width=Math.round(this.options.maxWidth*M)+"px",u.innerHTML=b},_getRoundNum:function(u){var b=Math.pow(10,(Math.floor(u)+"").length-1),M=u/b;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:1,b*M}}),Dc=function(u){return new eh(u)},_u='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Oc=Ui.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ve.inlineSvg?_u+" ":"")+"Leaflet</a>"},initialize:function(u){ne(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=yi("div","leaflet-control-attribution"),Xo(this._container);for(var b in u._layers)u._layers[b].getAttribution&&this.addAttribution(u._layers[b].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var b in this._attributions)this._attributions[b]&&u.push(b);var M=[];this.options.prefix&&M.push(this.options.prefix),u.length&&M.push(u.join(", ")),this._container.innerHTML=M.join(' <span aria-hidden="true">|</span> ')}}});tn.mergeOptions({attributionControl:!0}),tn.addInitHook(function(){this.options.attributionControl&&new Oc().addTo(this)});var th=function(u){return new Oc(u)};Ui.Layers=ec,Ui.Zoom=yu,Ui.Scale=eh,Ui.Attribution=Oc,ca.layers=Jo,ca.zoom=Qu,ca.scale=Dc,ca.attribution=th;var Ta=gt.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ta.addTo=function(u,b){return u.addHandler(b,this),this};var ih={Events:$e},co=Ve.touch?"touchstart mousedown":"mousedown",uo=ct.extend({options:{clickTolerance:3},initialize:function(u,b,M,$){ne(this,$),this._element=u,this._dragStartTarget=b||u,this._preventOutline=M},enable:function(){this._enabled||(Ii(this._dragStartTarget,co,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(uo._dragging===this&&this.finishDrag(!0),Rn(this._dragStartTarget,co,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!qr(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){uo._dragging===this&&this.finishDrag();return}if(!(uo._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(uo._dragging=this,this._preventOutline&&jl(this._element),lo(),Co(),!this._moving)){this.fire("down");var b=u.touches?u.touches[0]:u,M=Ao(this._element);this._startPoint=new We(b.clientX,b.clientY),this._startPos=Hr(this._element),this._parentScale=Hs(M);var $=u.type==="mousedown";Ii(document,$?"mousemove":"touchmove",this._onMove,this),Ii(document,$?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var b=u.touches&&u.touches.length===1?u.touches[0]:u,M=new We(b.clientX,b.clientY)._subtract(this._startPoint);!M.x&&!M.y||Math.abs(M.x)+Math.abs(M.y)<this.options.clickTolerance||(M.x/=this._parentScale.x,M.y/=this._parentScale.y,Ts(u),this._moved||(this.fire("dragstart"),this._moved=!0,$i(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),$i(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(M),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),Xn(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){Ln(document.body,"leaflet-dragging"),this._lastTarget&&(Ln(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Rn(document,"mousemove touchmove",this._onMove,this),Rn(document,"mouseup touchend touchcancel",this._onUp,this),Il(),Zr();var b=this._moved&&this._moving;this._moving=!1,uo._dragging=!1,b&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function nh(u,b,M){var $,Z=[1,4,2,8],ce,Ae,Je,dt,wt,Yt,_i,un;for(ce=0,Yt=u.length;ce<Yt;ce++)u[ce]._code=xr(u[ce],b);for(Je=0;Je<4;Je++){for(_i=Z[Je],$=[],ce=0,Yt=u.length,Ae=Yt-1;ce<Yt;Ae=ce++)dt=u[ce],wt=u[Ae],dt._code&_i?wt._code&_i||(un=el(wt,dt,_i,b,M),un._code=xr(un,b),$.push(un)):(wt._code&_i&&(un=el(wt,dt,_i,b,M),un._code=xr(un,b),$.push(un)),$.push(dt));u=$}return u}function vu(u,b){var M,$,Z,ce,Ae,Je,dt,wt,Yt;if(!u||u.length===0)throw new Error("latlngs not passed");Lr(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var _i=kt([0,0]),un=ot(u),Ws=un.getNorthWest().distanceTo(un.getSouthWest())*un.getNorthEast().distanceTo(un.getNorthWest());Ws<1700&&(_i=Qo(u));var Es=u.length,Tr=[];for(M=0;M<Es;M++){var bn=kt(u[M]);Tr.push(b.project(kt([bn.lat-_i.lat,bn.lng-_i.lng])))}for(Je=dt=wt=0,M=0,$=Es-1;M<Es;$=M++)Z=Tr[M],ce=Tr[$],Ae=Z.y*ce.x-ce.y*Z.x,dt+=(Z.x+ce.x)*Ae,wt+=(Z.y+ce.y)*Ae,Je+=Ae*3;Je===0?Yt=Tr[0]:Yt=[dt/Je,wt/Je];var Yi=b.unproject(lt(Yt));return kt([Yi.lat+_i.lat,Yi.lng+_i.lng])}function Qo(u){for(var b=0,M=0,$=0,Z=0;Z<u.length;Z++){var ce=kt(u[Z]);b+=ce.lat,M+=ce.lng,$++}return kt([b/$,M/$])}var xu={__proto__:null,clipPolygon:nh,polygonCenter:vu,centroid:Qo};function tc(u,b){if(!b||!u.length)return u.slice();var M=b*b;return u=rh(u,M),u=bu(u,M),u}function sh(u,b,M){return Math.sqrt(tl(u,b,M,!0))}function Jh(u,b,M){return tl(u,b,M)}function bu(u,b){var M=u.length,$=typeof Uint8Array<"u"?Uint8Array:Array,Z=new $(M);Z[0]=Z[M-1]=1,Nc(u,Z,b,0,M-1);var ce,Ae=[];for(ce=0;ce<M;ce++)Z[ce]&&Ae.push(u[ce]);return Ae}function Nc(u,b,M,$,Z){var ce=0,Ae,Je,dt;for(Je=$+1;Je<=Z-1;Je++)dt=tl(u[Je],u[$],u[Z],!0),dt>ce&&(Ae=Je,ce=dt);ce>M&&(b[Ae]=1,Nc(u,b,M,$,Ae),Nc(u,b,M,Ae,Z))}function rh(u,b){for(var M=[u[0]],$=1,Z=0,ce=u.length;$<ce;$++)Su(u[$],u[Z])>b&&(M.push(u[$]),Z=$);return Z<ce-1&&M.push(u[ce-1]),M}var Bc;function wu(u,b,M,$,Z){var ce=$?Bc:xr(u,M),Ae=xr(b,M),Je,dt,wt;for(Bc=Ae;;){if(!(ce|Ae))return[u,b];if(ce&Ae)return!1;Je=ce||Ae,dt=el(u,b,Je,M,Z),wt=xr(dt,M),Je===ce?(u=dt,ce=wt):(b=dt,Ae=wt)}}function el(u,b,M,$,Z){var ce=b.x-u.x,Ae=b.y-u.y,Je=$.min,dt=$.max,wt,Yt;return M&8?(wt=u.x+ce*(dt.y-u.y)/Ae,Yt=dt.y):M&4?(wt=u.x+ce*(Je.y-u.y)/Ae,Yt=Je.y):M&2?(wt=dt.x,Yt=u.y+Ae*(dt.x-u.x)/ce):M&1&&(wt=Je.x,Yt=u.y+Ae*(Je.x-u.x)/ce),new We(wt,Yt,Z)}function xr(u,b){var M=0;return u.x<b.min.x?M|=1:u.x>b.max.x&&(M|=2),u.y<b.min.y?M|=4:u.y>b.max.y&&(M|=8),M}function Su(u,b){var M=b.x-u.x,$=b.y-u.y;return M*M+$*$}function tl(u,b,M,$){var Z=b.x,ce=b.y,Ae=M.x-Z,Je=M.y-ce,dt=Ae*Ae+Je*Je,wt;return dt>0&&(wt=((u.x-Z)*Ae+(u.y-ce)*Je)/dt,wt>1?(Z=M.x,ce=M.y):wt>0&&(Z+=Ae*wt,ce+=Je*wt)),Ae=u.x-Z,Je=u.y-ce,$?Ae*Ae+Je*Je:new We(Z,ce)}function Lr(u){return!oe(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function il(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Lr(u)}function Io(u,b){var M,$,Z,ce,Ae,Je,dt,wt;if(!u||u.length===0)throw new Error("latlngs not passed");Lr(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Yt=kt([0,0]),_i=ot(u),un=_i.getNorthWest().distanceTo(_i.getSouthWest())*_i.getNorthEast().distanceTo(_i.getNorthWest());un<1700&&(Yt=Qo(u));var Ws=u.length,Es=[];for(M=0;M<Ws;M++){var Tr=kt(u[M]);Es.push(b.project(kt([Tr.lat-Yt.lat,Tr.lng-Yt.lng])))}for(M=0,$=0;M<Ws-1;M++)$+=Es[M].distanceTo(Es[M+1])/2;if($===0)wt=Es[0];else for(M=0,ce=0;M<Ws-1;M++)if(Ae=Es[M],Je=Es[M+1],Z=Ae.distanceTo(Je),ce+=Z,ce>$){dt=(ce-$)/Z,wt=[Je.x-dt*(Je.x-Ae.x),Je.y-dt*(Je.y-Ae.y)];break}var bn=b.unproject(lt(wt));return kt([bn.lat+Yt.lat,bn.lng+Yt.lng])}var nl={__proto__:null,simplify:tc,pointToSegmentDistance:sh,closestPointOnSegment:Jh,clipSegment:wu,_getEdgeIntersection:el,_getBitCode:xr,_sqClosestPointOnSegment:tl,isFlat:Lr,_flat:il,polylineCenter:Io},Rl={project:function(u){return new We(u.lng,u.lat)},unproject:function(u){return new _t(u.y,u.x)},bounds:new xe([-180,-90],[180,90])},$c={R:6378137,R_MINOR:6356752314245179e-9,bounds:new xe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var b=Math.PI/180,M=this.R,$=u.lat*b,Z=this.R_MINOR/M,ce=Math.sqrt(1-Z*Z),Ae=ce*Math.sin($),Je=Math.tan(Math.PI/4-$/2)/Math.pow((1-Ae)/(1+Ae),ce/2);return $=-M*Math.log(Math.max(Je,1e-10)),new We(u.lng*b*M,$)},unproject:function(u){for(var b=180/Math.PI,M=this.R,$=this.R_MINOR/M,Z=Math.sqrt(1-$*$),ce=Math.exp(-u.y/M),Ae=Math.PI/2-2*Math.atan(ce),Je=0,dt=.1,wt;Je<15&&Math.abs(dt)>1e-7;Je++)wt=Z*Math.sin(Ae),wt=Math.pow((1-wt)/(1+wt),Z/2),dt=Math.PI/2-2*Math.atan(ce*wt)-Ae,Ae+=dt;return new _t(Ae*b,u.x*b/M)}},ys={__proto__:null,LonLat:Rl,Mercator:$c,SphericalMercator:Gi},ah=f({},ei,{code:"EPSG:3395",projection:$c,transformation:(function(){var u=.5/(Math.PI*$c.R);return Di(u,.5,-u,.5)})()}),Hi=f({},ei,{code:"EPSG:4326",projection:Rl,transformation:Di(1/180,1,-1/180,.5)}),ho=f({},It,{projection:Rl,transformation:Di(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,b){var M=b.lng-u.lng,$=b.lat-u.lat;return Math.sqrt(M*M+$*$)},infinite:!0});It.Earth=ei,It.EPSG3395=ah,It.EPSG3857=Pn,It.EPSG900913=hn,It.EPSG4326=Hi,It.Simple=ho;var gn=ct.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[A(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[A(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var b=u.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var M=this.getEvents();b.on(M,this),this.once("remove",function(){b.off(M,this)},this)}this.onAdd(b),this.fire("add"),b.fire("layeradd",{layer:this})}}});tn.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var b=A(u);return this._layers[b]?this:(this._layers[b]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var b=A(u);return this._layers[b]?(this._loaded&&u.onRemove(this),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return A(u)in this._layers},eachLayer:function(u,b){for(var M in this._layers)u.call(b,this._layers[M]);return this},_addLayers:function(u){u=u?oe(u)?u:[u]:[];for(var b=0,M=u.length;b<M;b++)this.addLayer(u[b])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[A(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var b=A(u);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,b=-1/0,M=this._getZoomSpan();for(var $ in this._zoomBoundLayers){var Z=this._zoomBoundLayers[$].options;u=Z.minZoom===void 0?u:Math.min(u,Z.minZoom),b=Z.maxZoom===void 0?b:Math.max(b,Z.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=u===1/0?void 0:u,M!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var En=gn.extend({initialize:function(u,b){ne(this,b),this._layers={};var M,$;if(u)for(M=0,$=u.length;M<$;M++)this.addLayer(u[M])},addLayer:function(u){var b=this.getLayerId(u);return this._layers[b]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var b=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(u){var b=typeof u=="number"?u:this.getLayerId(u);return b in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var b=Array.prototype.slice.call(arguments,1),M,$;for(M in this._layers)$=this._layers[M],$[u]&&$[u].apply($,b);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,b){for(var M in this._layers)u.call(b,this._layers[M]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return A(u)}}),sl=function(u,b){return new En(u,b)},Rr=En.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),En.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),En.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new st;for(var b in this._layers){var M=this._layers[b];u.extend(M.getBounds?M.getBounds():M.getLatLng())}return u}}),zl=function(u,b){return new Rr(u,b)},ua=gt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){ne(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,b){var M=this._getIconUrl(u);if(!M){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var $=this._createImg(M,b&&b.tagName==="IMG"?b:null);return this._setIconStyles($,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&($.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),$},_setIconStyles:function(u,b){var M=this.options,$=M[b+"Size"];typeof $=="number"&&($=[$,$]);var Z=lt($),ce=lt(b==="shadow"&&M.shadowAnchor||M.iconAnchor||Z&&Z.divideBy(2,!0));u.className="leaflet-marker-"+b+" "+(M.className||""),ce&&(u.style.marginLeft=-ce.x+"px",u.style.marginTop=-ce.y+"px"),Z&&(u.style.width=Z.x+"px",u.style.height=Z.y+"px")},_createImg:function(u,b){return b=b||document.createElement("img"),b.src=u,b},_getIconUrl:function(u){return Ve.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function Ea(u){return new ua(u)}var Fa=ua.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof Fa.imagePath!="string"&&(Fa.imagePath=this._detectIconPath()),(this.options.imagePath||Fa.imagePath)+ua.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var b=function(M,$,Z){var ce=$.exec(M);return ce&&ce[Z]};return u=b(u,/^url\((['"])?(.+)\1\)$/,2),u&&b(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=yi("div","leaflet-default-icon-path",document.body),b=rr(u,"background-image")||rr(u,"backgroundImage");if(document.body.removeChild(u),b=this._stripUrl(b),b)return b;var M=document.querySelector('link[href$="leaflet.css"]');return M?M.href.substring(0,M.href.length-11-1):""}}),ar=Ta.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new uo(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),$i(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ln(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var b=this._marker,M=b._map,$=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,ce=Hr(b._icon),Ae=M.getPixelBounds(),Je=M.getPixelOrigin(),dt=Ce(Ae.min._subtract(Je).add(Z),Ae.max._subtract(Je).subtract(Z));if(!dt.contains(ce)){var wt=lt((Math.max(dt.max.x,ce.x)-dt.max.x)/(Ae.max.x-dt.max.x)-(Math.min(dt.min.x,ce.x)-dt.min.x)/(Ae.min.x-dt.min.x),(Math.max(dt.max.y,ce.y)-dt.max.y)/(Ae.max.y-dt.max.y)-(Math.min(dt.min.y,ce.y)-dt.min.y)/(Ae.min.y-dt.min.y)).multiplyBy($);M.panBy(wt,{animate:!1}),this._draggable._newPos._add(wt),this._draggable._startPos._add(wt),Xn(b._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=at(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(et(this._panRequest),this._panRequest=at(this._adjustPan.bind(this,u)))},_onDrag:function(u){var b=this._marker,M=b._shadow,$=Hr(b._icon),Z=b._map.layerPointToLatLng($);M&&Xn(M,$),b._latlng=Z,u.latlng=Z,u.oldLatLng=this._oldLatLng,b.fire("move",u).fire("drag",u)},_onDragEnd:function(u){et(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),rl=gn.extend({options:{icon:new Fa,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,b){ne(this,b),this._latlng=kt(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var b=this._latlng;return this._latlng=kt(u),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),M=u.icon.createIcon(this._icon),$=!1;M!==this._icon&&(this._icon&&this._removeIcon(),$=!0,u.title&&(M.title=u.title),M.tagName==="IMG"&&(M.alt=u.alt||"")),$i(M,b),u.keyboard&&(M.tabIndex="0",M.setAttribute("role","button")),this._icon=M,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ii(M,"focus",this._panOnFocus,this);var Z=u.icon.createShadow(this._shadow),ce=!1;Z!==this._shadow&&(this._removeShadow(),ce=!0),Z&&($i(Z,b),Z.alt=""),this._shadow=Z,u.opacity<1&&this._updateOpacity(),$&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&ce&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Rn(this._icon,"focus",this._panOnFocus,this),An(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&An(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&Xn(this._icon,u),this._shadow&&Xn(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&($i(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ar)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ar(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&Un(this._icon,u),this._shadow&&Un(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var b=this.options.icon.options,M=b.iconSize?lt(b.iconSize):lt(0,0),$=b.iconAnchor?lt(b.iconAnchor):lt(0,0);u.panInside(this._latlng,{paddingTopLeft:$,paddingBottomRight:M.subtract($)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Uc(u,b){return new rl(u,b)}var ha=gn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return ne(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),da=ha.extend({options:{fill:!0,radius:10},initialize:function(u,b){ne(this,b),this._latlng=kt(u),this._radius=this.options.radius},setLatLng:function(u){var b=this._latlng;return this._latlng=kt(u),this.redraw(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var b=u&&u.radius||this._radius;return ha.prototype.setStyle.call(this,u),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,b=this._radiusY||u,M=this._clickTolerance(),$=[u+M,b+M];this._pxBounds=new xe(this._point.subtract($),this._point.add($))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Dl(u,b){return new da(u,b)}var jo=da.extend({initialize:function(u,b,M){if(typeof b=="number"&&(b=f({},M,{radius:b})),ne(this,b),this._latlng=kt(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new st(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:ha.prototype.setStyle,_project:function(){var u=this._latlng.lng,b=this._latlng.lat,M=this._map,$=M.options.crs;if($.distance===ei.distance){var Z=Math.PI/180,ce=this._mRadius/ei.R/Z,Ae=M.project([b+ce,u]),Je=M.project([b-ce,u]),dt=Ae.add(Je).divideBy(2),wt=M.unproject(dt).lat,Yt=Math.acos((Math.cos(ce*Z)-Math.sin(b*Z)*Math.sin(wt*Z))/(Math.cos(b*Z)*Math.cos(wt*Z)))/Z;(isNaN(Yt)||Yt===0)&&(Yt=ce/Math.cos(Math.PI/180*b)),this._point=dt.subtract(M.getPixelOrigin()),this._radius=isNaN(Yt)?0:dt.x-M.project([wt,u-Yt]).x,this._radiusY=dt.y-Ae.y}else{var _i=$.unproject($.project(this._latlng).subtract([this._mRadius,0]));this._point=M.latLngToLayerPoint(this._latlng),this._radius=this._point.x-M.latLngToLayerPoint(_i).x}this._updateBounds()}});function al(u,b,M){return new jo(u,b,M)}var Gr=ha.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,b){ne(this,b),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var b=1/0,M=null,$=tl,Z,ce,Ae=0,Je=this._parts.length;Ae<Je;Ae++)for(var dt=this._parts[Ae],wt=1,Yt=dt.length;wt<Yt;wt++){Z=dt[wt-1],ce=dt[wt];var _i=$(u,Z,ce,!0);_i<b&&(b=_i,M=$(u,Z,ce))}return M&&(M.distance=Math.sqrt(b)),M},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Io(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,b){return b=b||this._defaultShape(),u=kt(u),b.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new st,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return Lr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var b=[],M=Lr(u),$=0,Z=u.length;$<Z;$++)M?(b[$]=kt(u[$]),this._bounds.extend(b[$])):b[$]=this._convertLatLngs(u[$]);return b},_project:function(){var u=new xe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),b=new We(u,u);this._rawPxBounds&&(this._pxBounds=new xe([this._rawPxBounds.min.subtract(b),this._rawPxBounds.max.add(b)]))},_projectLatlngs:function(u,b,M){var $=u[0]instanceof _t,Z=u.length,ce,Ae;if($){for(Ae=[],ce=0;ce<Z;ce++)Ae[ce]=this._map.latLngToLayerPoint(u[ce]),M.extend(Ae[ce]);b.push(Ae)}else for(ce=0;ce<Z;ce++)this._projectLatlngs(u[ce],b,M)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var b=this._parts,M,$,Z,ce,Ae,Je,dt;for(M=0,Z=0,ce=this._rings.length;M<ce;M++)for(dt=this._rings[M],$=0,Ae=dt.length;$<Ae-1;$++)Je=wu(dt[$],dt[$+1],u,$,!0),Je&&(b[Z]=b[Z]||[],b[Z].push(Je[0]),(Je[1]!==dt[$+1]||$===Ae-2)&&(b[Z].push(Je[1]),Z++))}},_simplifyPoints:function(){for(var u=this._parts,b=this.options.smoothFactor,M=0,$=u.length;M<$;M++)u[M]=tc(u[M],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,b){var M,$,Z,ce,Ae,Je,dt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(M=0,ce=this._parts.length;M<ce;M++)for(Je=this._parts[M],$=0,Ae=Je.length,Z=Ae-1;$<Ae;Z=$++)if(!(!b&&$===0)&&sh(u,Je[Z],Je[$])<=dt)return!0;return!1}});function Fc(u,b){return new Gr(u,b)}Gr._flat=il;var ka=Gr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var b=Gr.prototype._convertLatLngs.call(this,u),M=b.length;return M>=2&&b[0]instanceof _t&&b[0].equals(b[M-1])&&b.pop(),b},_setLatLngs:function(u){Gr.prototype._setLatLngs.call(this,u),Lr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Lr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,b=this.options.weight,M=new We(b,b);if(u=new xe(u.min.subtract(M),u.max.add(M)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var $=0,Z=this._rings.length,ce;$<Z;$++)ce=nh(this._rings[$],u,!0),ce.length&&this._parts.push(ce)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var b=!1,M,$,Z,ce,Ae,Je,dt,wt;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(ce=0,dt=this._parts.length;ce<dt;ce++)for(M=this._parts[ce],Ae=0,wt=M.length,Je=wt-1;Ae<wt;Je=Ae++)$=M[Ae],Z=M[Je],$.y>u.y!=Z.y>u.y&&u.x<(Z.x-$.x)*(u.y-$.y)/(Z.y-$.y)+$.x&&(b=!b);return b||Gr.prototype._containsPoint.call(this,u,!0)}});function Ol(u,b){return new ka(u,b)}var Va=Rr.extend({initialize:function(u,b){ne(this,b),this._layers={},u&&this.addData(u)},addData:function(u){var b=oe(u)?u:u.features,M,$,Z;if(b){for(M=0,$=b.length;M<$;M++)Z=b[M],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var ce=this.options;if(ce.filter&&!ce.filter(u))return this;var Ae=Gs(u,ce);return Ae?(Ae.feature=ll(u),Ae.defaultOptions=Ae.options,this.resetStyle(Ae),ce.onEachFeature&&ce.onEachFeature(u,Ae),this.addLayer(Ae)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=f({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(b){this._setLayerStyle(b,u)},this)},_setLayerStyle:function(u,b){u.setStyle&&(typeof b=="function"&&(b=b(u.feature)),u.setStyle(b))}});function Gs(u,b){var M=u.type==="Feature"?u.geometry:u,$=M?M.coordinates:null,Z=[],ce=b&&b.pointToLayer,Ae=b&&b.coordsToLatLng||ol,Je,dt,wt,Yt;if(!$&&!M)return null;switch(M.type){case"Point":return Je=Ae($),cn(ce,u,Je,b);case"MultiPoint":for(wt=0,Yt=$.length;wt<Yt;wt++)Je=Ae($[wt]),Z.push(cn(ce,u,Je,b));return new Rr(Z);case"LineString":case"MultiLineString":return dt=ic($,M.type==="LineString"?0:1,Ae),new Gr(dt,b);case"Polygon":case"MultiPolygon":return dt=ic($,M.type==="Polygon"?1:2,Ae),new ka(dt,b);case"GeometryCollection":for(wt=0,Yt=M.geometries.length;wt<Yt;wt++){var _i=Gs({geometry:M.geometries[wt],type:"Feature",properties:u.properties},b);_i&&Z.push(_i)}return new Rr(Z);case"FeatureCollection":for(wt=0,Yt=M.features.length;wt<Yt;wt++){var un=Gs(M.features[wt],b);un&&Z.push(un)}return new Rr(Z);default:throw new Error("Invalid GeoJSON object.")}}function cn(u,b,M,$){return u?u(b,M):new rl(M,$&&$.markersInheritOptions&&$)}function ol(u){return new _t(u[1],u[0],u[2])}function ic(u,b,M){for(var $=[],Z=0,ce=u.length,Ae;Z<ce;Z++)Ae=b?ic(u[Z],b-1,M):(M||ol)(u[Z]),$.push(Ae);return $}function nc(u,b){return u=kt(u),u.alt!==void 0?[V(u.lng,b),V(u.lat,b),V(u.alt,b)]:[V(u.lng,b),V(u.lat,b)]}function qa(u,b,M,$){for(var Z=[],ce=0,Ae=u.length;ce<Ae;ce++)Z.push(b?qa(u[ce],Lr(u[ce])?0:b-1,M,$):nc(u[ce],$));return!b&&M&&Z.length>0&&Z.push(Z[0].slice()),Z}function fo(u,b){return u.feature?f({},u.feature,{geometry:b}):ll(b)}function ll(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var po={toGeoJSON:function(u){return fo(this,{type:"Point",coordinates:nc(this.getLatLng(),u)})}};rl.include(po),jo.include(po),da.include(po),Gr.include({toGeoJSON:function(u){var b=!Lr(this._latlngs),M=qa(this._latlngs,b?1:0,!1,u);return fo(this,{type:(b?"Multi":"")+"LineString",coordinates:M})}}),ka.include({toGeoJSON:function(u){var b=!Lr(this._latlngs),M=b&&!Lr(this._latlngs[0]),$=qa(this._latlngs,M?2:b?1:0,!0,u);return b||($=[$]),fo(this,{type:(M?"Multi":"")+"Polygon",coordinates:$})}}),En.include({toMultiPoint:function(u){var b=[];return this.eachLayer(function(M){b.push(M.toGeoJSON(u).geometry.coordinates)}),fo(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(u){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(b==="MultiPoint")return this.toMultiPoint(u);var M=b==="GeometryCollection",$=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var ce=Z.toGeoJSON(u);if(M)$.push(ce.geometry);else{var Ae=ll(ce);Ae.type==="FeatureCollection"?$.push.apply($,Ae.features):$.push(Ae)}}}),M?fo(this,{geometries:$,type:"GeometryCollection"}):{type:"FeatureCollection",features:$}}});function sc(u,b){return new Va(u,b)}var Lo=sc,mo=gn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,b,M){this._url=u,this._bounds=ot(b),ne(this,M)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&($i(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){An(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&pn(this._image),this},bringToBack:function(){return this._map&&Na(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=ot(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",b=this._image=u?this._url:yi("img");if($i(b,"leaflet-image-layer"),this._zoomAnimated&&$i(b,"leaflet-zoom-animated"),this.options.className&&$i(b,this.options.className),b.onselectstart=N,b.onmousemove=N,b.onload=y(this.fire,this,"load"),b.onerror=y(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=b.src;return}b.src=this._url,b.alt=this.options.alt},_animateZoom:function(u){var b=this._map.getZoomScale(u.zoom),M=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;wa(this._image,M,b)},_reset:function(){var u=this._image,b=new xe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),M=b.getSize();Xn(u,b.min),u.style.width=M.x+"px",u.style.height=M.y+"px"},_updateOpacity:function(){Un(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),cl=function(u,b,M){return new mo(u,b,M)},Wr=mo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",b=this._image=u?this._url:yi("video");if($i(b,"leaflet-image-layer"),this._zoomAnimated&&$i(b,"leaflet-zoom-animated"),this.options.className&&$i(b,this.options.className),b.onselectstart=N,b.onmousemove=N,b.onloadeddata=y(this.fire,this,"load"),u){for(var M=b.getElementsByTagName("source"),$=[],Z=0;Z<M.length;Z++)$.push(M[Z].src);this._url=M.length>0?$:[b.src];return}oe(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(b.style,"objectFit")&&(b.style.objectFit="fill"),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,b.muted=!!this.options.muted,b.playsInline=!!this.options.playsInline;for(var ce=0;ce<this._url.length;ce++){var Ae=yi("source");Ae.src=this._url[ce],b.appendChild(Ae)}}});function Ca(u,b,M){return new Wr(u,b,M)}var Nl=mo.extend({_initImage:function(){var u=this._image=this._url;$i(u,"leaflet-image-layer"),this._zoomAnimated&&$i(u,"leaflet-zoom-animated"),this.options.className&&$i(u,this.options.className),u.onselectstart=N,u.onmousemove=N}});function ul(u,b,M){return new Nl(u,b,M)}var js=gn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,b){u&&(u instanceof _t||oe(u))?(this._latlng=kt(u),ne(this,b)):(ne(this,u),this._source=b),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&Un(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&Un(this._container,1),this.bringToFront(),this.options.interactive&&($i(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(Un(this._container,0),this._removeTimeout=setTimeout(y(An,void 0,this._container),200)):An(this._container),this.options.interactive&&(Ln(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=kt(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&pn(this._container),this},bringToBack:function(){return this._map&&Na(this._container),this},_prepareOpen:function(u){var b=this._source;if(!b._map)return!1;if(b instanceof Rr){b=null;var M=this._source._layers;for(var $ in M)if(M[$]._map){b=M[$];break}if(!b)return!1;this._source=b}if(!u)if(b.getCenter)u=b.getCenter();else if(b.getLatLng)u=b.getLatLng();else if(b.getBounds)u=b.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,b=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof b=="string")u.innerHTML=b;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),b=lt(this.options.offset),M=this._getAnchor();this._zoomAnimated?Xn(this._container,u.add(M)):b=b.add(u).add(M);var $=this._containerBottom=-b.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=$+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});tn.include({_initOverlay:function(u,b,M,$){var Z=b;return Z instanceof u||(Z=new u($).setContent(b)),M&&Z.setLatLng(M),Z}}),gn.include({_initOverlay:function(u,b,M,$){var Z=M;return Z instanceof u?(ne(Z,$),Z._source=this):(Z=b&&!$?b:new u($,this),Z.setContent(M)),Z}});var Ro=js.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,js.prototype.openOn.call(this,u)},onAdd:function(u){js.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ha||this._source.on("preclick",oa))},onRemove:function(u){js.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ha||this._source.off("preclick",oa))},getEvents:function(){var u=js.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",b=this._container=yi("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),M=this._wrapper=yi("div",u+"-content-wrapper",b);if(this._contentNode=yi("div",u+"-content",M),Xo(b),$a(this._contentNode),Ii(b,"contextmenu",oa),this._tipContainer=yi("div",u+"-tip-container",b),this._tip=yi("div",u+"-tip",this._tipContainer),this.options.closeButton){var $=this._closeButton=yi("a",u+"-close-button",b);$.setAttribute("role","button"),$.setAttribute("aria-label","Close popup"),$.href="#close",$.innerHTML='<span aria-hidden="true">&#215;</span>',Ii($,"click",function(Z){Ts(Z),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,b=u.style;b.width="",b.whiteSpace="nowrap";var M=u.offsetWidth;M=Math.min(M,this.options.maxWidth),M=Math.max(M,this.options.minWidth),b.width=M+1+"px",b.whiteSpace="",b.height="";var $=u.offsetHeight,Z=this.options.maxHeight,ce="leaflet-popup-scrolled";Z&&$>Z?(b.height=Z+"px",$i(u,ce)):Ln(u,ce),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),M=this._getAnchor();Xn(this._container,b.add(M))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,b=parseInt(rr(this._container,"marginBottom"),10)||0,M=this._container.offsetHeight+b,$=this._containerWidth,Z=new We(this._containerLeft,-M-this._containerBottom);Z._add(Hr(this._container));var ce=u.layerPointToContainerPoint(Z),Ae=lt(this.options.autoPanPadding),Je=lt(this.options.autoPanPaddingTopLeft||Ae),dt=lt(this.options.autoPanPaddingBottomRight||Ae),wt=u.getSize(),Yt=0,_i=0;ce.x+$+dt.x>wt.x&&(Yt=ce.x+$-wt.x+dt.x),ce.x-Yt-Je.x<0&&(Yt=ce.x-Je.x),ce.y+M+dt.y>wt.y&&(_i=ce.y+M-wt.y+dt.y),ce.y-_i-Je.y<0&&(_i=ce.y-Je.y),(Yt||_i)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([Yt,_i]))}},_getAnchor:function(){return lt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),rc=function(u,b){return new Ro(u,b)};tn.mergeOptions({closePopupOnClick:!0}),tn.include({openPopup:function(u,b,M){return this._initOverlay(Ro,u,b,M).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),gn.include({bindPopup:function(u,b){return this._popup=this._initOverlay(Ro,this._popup,u,b),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof Rr||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){la(u);var b=u.layer||u.target;if(this._popup._source===b&&!(b instanceof ha)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=b,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var hl=js.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){js.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){js.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=js.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",b=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=yi("div",b),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+A(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var b,M,$=this._map,Z=this._container,ce=$.latLngToContainerPoint($.getCenter()),Ae=$.layerPointToContainerPoint(u),Je=this.options.direction,dt=Z.offsetWidth,wt=Z.offsetHeight,Yt=lt(this.options.offset),_i=this._getAnchor();Je==="top"?(b=dt/2,M=wt):Je==="bottom"?(b=dt/2,M=0):Je==="center"?(b=dt/2,M=wt/2):Je==="right"?(b=0,M=wt/2):Je==="left"?(b=dt,M=wt/2):Ae.x<ce.x?(Je="right",b=0,M=wt/2):(Je="left",b=dt+(Yt.x+_i.x)*2,M=wt/2),u=u.subtract(lt(b,M,!0)).add(Yt).add(_i),Ln(Z,"leaflet-tooltip-right"),Ln(Z,"leaflet-tooltip-left"),Ln(Z,"leaflet-tooltip-top"),Ln(Z,"leaflet-tooltip-bottom"),$i(Z,"leaflet-tooltip-"+Je),Xn(Z,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&Un(this._container,u)},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(b)},_getAnchor:function(){return lt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Qh=function(u,b){return new hl(u,b)};tn.include({openTooltip:function(u,b,M){return this._initOverlay(hl,u,b,M).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),gn.include({bindTooltip:function(u,b){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(hl,this._tooltip,u,b),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var b=u?"off":"on",M={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?M.add=this._openTooltip:(M.mouseover=this._openTooltip,M.mouseout=this.closeTooltip,M.click=this._openTooltip,this._map?this._addFocusListeners():M.add=this._addFocusListeners),this._tooltip.options.sticky&&(M.mousemove=this._moveTooltip),this[b](M),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof Rr||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var b=typeof u.getElement=="function"&&u.getElement();b&&(Ii(b,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),Ii(b,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var b=typeof u.getElement=="function"&&u.getElement();b&&b.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var b=this;this._map.once("moveend",function(){b._openOnceFlag=!1,b._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var b=u.latlng,M,$;this._tooltip.options.sticky&&u.originalEvent&&(M=this._map.mouseEventToContainerPoint(u.originalEvent),$=this._map.containerPointToLayerPoint(M),b=this._map.layerPointToLatLng($)),this._tooltip.setLatLng(b)}});var Tu=ua.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var b=u&&u.tagName==="DIV"?u:document.createElement("div"),M=this.options;if(M.html instanceof Element?(bs(b),b.appendChild(M.html)):b.innerHTML=M.html!==!1?M.html:"",M.bgPos){var $=lt(M.bgPos);b.style.backgroundPosition=-$.x+"px "+-$.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});function Vc(u){return new Tu(u)}ua.Default=Fa;var zo=gn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ve.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){ne(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),An(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(pn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Na(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=I(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof We?u:new We(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var b=this.getPane().children,M=-u(-1/0,1/0),$=0,Z=b.length,ce;$<Z;$++)ce=b[$].style.zIndex,b[$]!==this._container&&ce&&(M=u(M,+ce));isFinite(M)&&(this.options.zIndex=M+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ve.ielt9){Un(this._container,this.options.opacity);var u=+new Date,b=!1,M=!1;for(var $ in this._tiles){var Z=this._tiles[$];if(!(!Z.current||!Z.loaded)){var ce=Math.min(1,(u-Z.loaded)/200);Un(Z.el,ce),ce<1?b=!0:(Z.active?M=!0:this._onOpaqueTile(Z),Z.active=!0)}}M&&!this._noPrune&&this._pruneTiles(),b&&(et(this._fadeFrame),this._fadeFrame=at(this._updateOpacity,this))}},_onOpaqueTile:N,_initContainer:function(){this._container||(this._container=yi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,b=this.options.maxZoom;if(u!==void 0){for(var M in this._levels)M=Number(M),this._levels[M].el.children.length||M===u?(this._levels[M].el.style.zIndex=b-Math.abs(u-M),this._onUpdateLevel(M)):(An(this._levels[M].el),this._removeTilesAtZoom(M),this._onRemoveLevel(M),delete this._levels[M]);var $=this._levels[u],Z=this._map;return $||($=this._levels[u]={},$.el=yi("div","leaflet-tile-container leaflet-zoom-animated",this._container),$.el.style.zIndex=b,$.origin=Z.project(Z.unproject(Z.getPixelOrigin()),u).round(),$.zoom=u,this._setZoomTransform($,Z.getCenter(),Z.getZoom()),N($.el.offsetWidth),this._onCreateLevel($)),this._level=$,$}},_onUpdateLevel:N,_onRemoveLevel:N,_onCreateLevel:N,_pruneTiles:function(){if(this._map){var u,b,M=this._map.getZoom();if(M>this.options.maxZoom||M<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)b=this._tiles[u],b.retain=b.current;for(u in this._tiles)if(b=this._tiles[u],b.current&&!b.active){var $=b.coords;this._retainParent($.x,$.y,$.z,$.z-5)||this._retainChildren($.x,$.y,$.z,$.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var b in this._tiles)this._tiles[b].coords.z===u&&this._removeTile(b)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)An(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,b,M,$){var Z=Math.floor(u/2),ce=Math.floor(b/2),Ae=M-1,Je=new We(+Z,+ce);Je.z=+Ae;var dt=this._tileCoordsToKey(Je),wt=this._tiles[dt];return wt&&wt.active?(wt.retain=!0,!0):(wt&&wt.loaded&&(wt.retain=!0),Ae>$?this._retainParent(Z,ce,Ae,$):!1)},_retainChildren:function(u,b,M,$){for(var Z=2*u;Z<2*u+2;Z++)for(var ce=2*b;ce<2*b+2;ce++){var Ae=new We(Z,ce);Ae.z=M+1;var Je=this._tileCoordsToKey(Ae),dt=this._tiles[Je];if(dt&&dt.active){dt.retain=!0;continue}else dt&&dt.loaded&&(dt.retain=!0);M+1<$&&this._retainChildren(Z,ce,M+1,$)}},_resetView:function(u){var b=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var b=this.options;return b.minNativeZoom!==void 0&&u<b.minNativeZoom?b.minNativeZoom:b.maxNativeZoom!==void 0&&b.maxNativeZoom<u?b.maxNativeZoom:u},_setView:function(u,b,M,$){var Z=Math.round(b);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var ce=this.options.updateWhenZooming&&Z!==this._tileZoom;(!$||ce)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(u),M||this._pruneTiles(),this._noPrune=!!M),this._setZoomTransforms(u,b)},_setZoomTransforms:function(u,b){for(var M in this._levels)this._setZoomTransform(this._levels[M],u,b)},_setZoomTransform:function(u,b,M){var $=this._map.getZoomScale(M,u.zoom),Z=u.origin.multiplyBy($).subtract(this._map._getNewPixelOrigin(b,M)).round();Ve.any3d?wa(u.el,Z,$):Xn(u.el,Z)},_resetGrid:function(){var u=this._map,b=u.options.crs,M=this._tileSize=this.getTileSize(),$=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,b.wrapLng[0]],$).x/M.x),Math.ceil(u.project([0,b.wrapLng[1]],$).x/M.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([b.wrapLat[0],0],$).y/M.x),Math.ceil(u.project([b.wrapLat[1],0],$).y/M.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var b=this._map,M=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),$=b.getZoomScale(M,this._tileZoom),Z=b.project(u,this._tileZoom).floor(),ce=b.getSize().divideBy($*2);return new xe(Z.subtract(ce),Z.add(ce))},_update:function(u){var b=this._map;if(b){var M=this._clampZoom(b.getZoom());if(u===void 0&&(u=b.getCenter()),this._tileZoom!==void 0){var $=this._getTiledPixelBounds(u),Z=this._pxBoundsToTileRange($),ce=Z.getCenter(),Ae=[],Je=this.options.keepBuffer,dt=new xe(Z.getBottomLeft().subtract([Je,-Je]),Z.getTopRight().add([Je,-Je]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var wt in this._tiles){var Yt=this._tiles[wt].coords;(Yt.z!==this._tileZoom||!dt.contains(new We(Yt.x,Yt.y)))&&(this._tiles[wt].current=!1)}if(Math.abs(M-this._tileZoom)>1){this._setView(u,M);return}for(var _i=Z.min.y;_i<=Z.max.y;_i++)for(var un=Z.min.x;un<=Z.max.x;un++){var Ws=new We(un,_i);if(Ws.z=this._tileZoom,!!this._isValidTile(Ws)){var Es=this._tiles[this._tileCoordsToKey(Ws)];Es?Es.current=!0:Ae.push(Ws)}}if(Ae.sort(function(bn,Yi){return bn.distanceTo(ce)-Yi.distanceTo(ce)}),Ae.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Tr=document.createDocumentFragment();for(un=0;un<Ae.length;un++)this._addTile(Ae[un],Tr);this._level.el.appendChild(Tr)}}}},_isValidTile:function(u){var b=this._map.options.crs;if(!b.infinite){var M=this._globalTileRange;if(!b.wrapLng&&(u.x<M.min.x||u.x>M.max.x)||!b.wrapLat&&(u.y<M.min.y||u.y>M.max.y))return!1}if(!this.options.bounds)return!0;var $=this._tileCoordsToBounds(u);return ot(this.options.bounds).overlaps($)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var b=this._map,M=this.getTileSize(),$=u.scaleBy(M),Z=$.add(M),ce=b.unproject($,u.z),Ae=b.unproject(Z,u.z);return[ce,Ae]},_tileCoordsToBounds:function(u){var b=this._tileCoordsToNwSe(u),M=new st(b[0],b[1]);return this.options.noWrap||(M=this._map.wrapLatLngBounds(M)),M},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var b=u.split(":"),M=new We(+b[0],+b[1]);return M.z=+b[2],M},_removeTile:function(u){var b=this._tiles[u];b&&(An(b.el),delete this._tiles[u],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){$i(u,"leaflet-tile");var b=this.getTileSize();u.style.width=b.x+"px",u.style.height=b.y+"px",u.onselectstart=N,u.onmousemove=N,Ve.ielt9&&this.options.opacity<1&&Un(u,this.options.opacity)},_addTile:function(u,b){var M=this._getTilePos(u),$=this._tileCoordsToKey(u),Z=this.createTile(this._wrapCoords(u),y(this._tileReady,this,u));this._initTile(Z),this.createTile.length<2&&at(y(this._tileReady,this,u,null,Z)),Xn(Z,M),this._tiles[$]={el:Z,coords:u,current:!0},b.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:u})},_tileReady:function(u,b,M){b&&this.fire("tileerror",{error:b,tile:M,coords:u});var $=this._tileCoordsToKey(u);M=this._tiles[$],M&&(M.loaded=+new Date,this._map._fadeAnimated?(Un(M.el,0),et(this._fadeFrame),this._fadeFrame=at(this._updateOpacity,this)):(M.active=!0,this._pruneTiles()),b||($i(M.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:M.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ve.ielt9||!this._map._fadeAnimated?at(this._pruneTiles,this):setTimeout(y(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var b=new We(this._wrapX?B(u.x,this._wrapX):u.x,this._wrapY?B(u.y,this._wrapY):u.y);return b.z=u.z,b},_pxBoundsToTileRange:function(u){var b=this.getTileSize();return new xe(u.min.unscaleBy(b).floor(),u.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function Bl(u){return new zo(u)}var fa=zo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,b){this._url=u,b=ne(this,b),b.detectRetina&&Ve.retina&&b.maxZoom>0?(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom=Math.min(b.maxZoom,b.minZoom+1)):(b.zoomOffset++,b.maxZoom=Math.max(b.minZoom,b.maxZoom-1)),b.minZoom=Math.max(0,b.minZoom)):b.zoomReverse?b.minZoom=Math.min(b.maxZoom,b.minZoom):b.maxZoom=Math.max(b.minZoom,b.maxZoom),typeof b.subdomains=="string"&&(b.subdomains=b.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,b){return this._url===u&&b===void 0&&(b=!0),this._url=u,b||this.redraw(),this},createTile:function(u,b){var M=document.createElement("img");return Ii(M,"load",y(this._tileOnLoad,this,b,M)),Ii(M,"error",y(this._tileOnError,this,b,M)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(M.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(M.referrerPolicy=this.options.referrerPolicy),M.alt="",M.src=this.getTileUrl(u),M},getTileUrl:function(u){var b={r:Ve.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var M=this._globalTileRange.max.y-u.y;this.options.tms&&(b.y=M),b["-y"]=M}return ge(this._url,f(b,this.options))},_tileOnLoad:function(u,b){Ve.ielt9?setTimeout(y(u,this,null,b),0):u(null,b)},_tileOnError:function(u,b,M){var $=this.options.errorTileUrl;$&&b.getAttribute("src")!==$&&(b.src=$),u(M,b)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,b=this.options.maxZoom,M=this.options.zoomReverse,$=this.options.zoomOffset;return M&&(u=b-u),u+$},_getSubdomain:function(u){var b=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var u,b;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(b=this._tiles[u].el,b.onload=N,b.onerror=N,!b.complete)){b.src=ye;var M=this._tiles[u].coords;An(b),delete this._tiles[u],this.fire("tileabort",{tile:b,coords:M})}},_removeTile:function(u){var b=this._tiles[u];if(b)return b.el.setAttribute("src",ye),zo.prototype._removeTile.call(this,u)},_tileReady:function(u,b,M){if(!(!this._map||M&&M.getAttribute("src")===ye))return zo.prototype._tileReady.call(this,u,b,M)}});function Kn(u,b){return new fa(u,b)}var Aa=fa.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,b){this._url=u;var M=f({},this.defaultWmsParams);for(var $ in b)$ in this.options||(M[$]=b[$]);b=ne(this,b);var Z=b.detectRetina&&Ve.retina?2:1,ce=this.getTileSize();M.width=ce.x*Z,M.height=ce.y*Z,this.wmsParams=M},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,fa.prototype.onAdd.call(this,u)},getTileUrl:function(u){var b=this._tileCoordsToNwSe(u),M=this._crs,$=Ce(M.project(b[0]),M.project(b[1])),Z=$.min,ce=$.max,Ae=(this._wmsVersion>=1.3&&this._crs===Hi?[Z.y,Z.x,ce.y,ce.x]:[Z.x,Z.y,ce.x,ce.y]).join(","),Je=fa.prototype.getTileUrl.call(this,u);return Je+ve(this.wmsParams,Je,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ae},setParams:function(u,b){return f(this.wmsParams,u),b||this.redraw(),this}});function Yr(u,b){return new Aa(u,b)}fa.WMS=Aa,Kn.wms=Yr;var br=gn.extend({options:{padding:.1},initialize:function(u){ne(this,u),A(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),$i(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,b){var M=this._map.getZoomScale(b,this._zoom),$=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,b),ce=$.multiplyBy(-M).add(Z).subtract(this._map._getNewPixelOrigin(u,b));Ve.any3d?wa(this._container,ce,M):Xn(this._container,ce)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,b=this._map.getSize(),M=this._map.containerPointToLayerPoint(b.multiplyBy(-u)).round();this._bounds=new xe(M,M.add(b.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),os=br.extend({options:{tolerance:0},getEvents:function(){var u=br.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){br.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");Ii(u,"mousemove",this._onMouseMove,this),Ii(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ii(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){et(this._redrawRequest),delete this._ctx,An(this._container),Rn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var b in this._layers)u=this._layers[b],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){br.prototype._update.call(this);var u=this._bounds,b=this._container,M=u.getSize(),$=Ve.retina?2:1;Xn(b,u.min),b.width=$*M.x,b.height=$*M.y,b.style.width=M.x+"px",b.style.height=M.y+"px",Ve.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){br.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[A(u)]=u;var b=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var b=u._order,M=b.next,$=b.prev;M?M.prev=$:this._drawLast=$,$?$.next=M:this._drawFirst=M,delete u._order,delete this._layers[A(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var b=u.options.dashArray.split(/[, ]+/),M=[],$,Z;for(Z=0;Z<b.length;Z++){if($=Number(b[Z]),isNaN($))return;M.push($)}u.options._dashArray=M}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||at(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var b=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new xe,this._redrawBounds.extend(u._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(u._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var b=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,b.x,b.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,b=this._redrawBounds;if(this._ctx.save(),b){var M=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,M.x,M.y),this._ctx.clip()}this._drawing=!0;for(var $=this._drawFirst;$;$=$.next)u=$.layer,(!b||u._pxBounds&&u._pxBounds.intersects(b))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,b){if(this._drawing){var M,$,Z,ce,Ae=u._parts,Je=Ae.length,dt=this._ctx;if(Je){for(dt.beginPath(),M=0;M<Je;M++){for($=0,Z=Ae[M].length;$<Z;$++)ce=Ae[M][$],dt[$?"lineTo":"moveTo"](ce.x,ce.y);b&&dt.closePath()}this._fillStroke(dt,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var b=u._point,M=this._ctx,$=Math.max(Math.round(u._radius),1),Z=(Math.max(Math.round(u._radiusY),1)||$)/$;Z!==1&&(M.save(),M.scale(1,Z)),M.beginPath(),M.arc(b.x,b.y/Z,$,0,Math.PI*2,!1),Z!==1&&M.restore(),this._fillStroke(M,u)}},_fillStroke:function(u,b){var M=b.options;M.fill&&(u.globalAlpha=M.fillOpacity,u.fillStyle=M.fillColor||M.color,u.fill(M.fillRule||"evenodd")),M.stroke&&M.weight!==0&&(u.setLineDash&&u.setLineDash(b.options&&b.options._dashArray||[]),u.globalAlpha=M.opacity,u.lineWidth=M.weight,u.strokeStyle=M.color,u.lineCap=M.lineCap,u.lineJoin=M.lineJoin,u.stroke())},_onClick:function(u){for(var b=this._map.mouseEventToLayerPoint(u),M,$,Z=this._drawFirst;Z;Z=Z.next)M=Z.layer,M.options.interactive&&M._containsPoint(b)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(M))&&($=M);this._fireEvent($?[$]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var b=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,b)}},_handleMouseOut:function(u){var b=this._hoveredLayer;b&&(Ln(this._container,"leaflet-interactive"),this._fireEvent([b],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,b){if(!this._mouseHoverThrottled){for(var M,$,Z=this._drawFirst;Z;Z=Z.next)M=Z.layer,M.options.interactive&&M._containsPoint(b)&&($=M);$!==this._hoveredLayer&&(this._handleMouseOut(u),$&&($i(this._container,"leaflet-interactive"),this._fireEvent([$],u,"mouseover"),this._hoveredLayer=$)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(y(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,b,M){this._map._fireDOMEvent(b,M||b.type,u)},_bringToFront:function(u){var b=u._order;if(b){var M=b.next,$=b.prev;if(M)M.prev=$;else return;$?$.next=M:M&&(this._drawFirst=M),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(u)}},_bringToBack:function(u){var b=u._order;if(b){var M=b.next,$=b.prev;if($)$.next=M;else return;M?M.prev=$:$&&(this._drawLast=$),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(u)}}});function wr(u){return Ve.canvas?new os(u):null}var Ls=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),dl={_initContainer:function(){this._container=yi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(br.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var b=u._container=Ls("shape");$i(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",u._path=Ls("path"),b.appendChild(u._path),this._updateStyle(u),this._layers[A(u)]=u},_addPath:function(u){var b=u._container;this._container.appendChild(b),u.options.interactive&&u.addInteractiveTarget(b)},_removePath:function(u){var b=u._container;An(b),u.removeInteractiveTarget(b),delete this._layers[A(u)]},_updateStyle:function(u){var b=u._stroke,M=u._fill,$=u.options,Z=u._container;Z.stroked=!!$.stroke,Z.filled=!!$.fill,$.stroke?(b||(b=u._stroke=Ls("stroke")),Z.appendChild(b),b.weight=$.weight+"px",b.color=$.color,b.opacity=$.opacity,$.dashArray?b.dashStyle=oe($.dashArray)?$.dashArray.join(" "):$.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=$.lineCap.replace("butt","flat"),b.joinstyle=$.lineJoin):b&&(Z.removeChild(b),u._stroke=null),$.fill?(M||(M=u._fill=Ls("fill")),Z.appendChild(M),M.color=$.fillColor||$.color,M.opacity=$.fillOpacity):M&&(Z.removeChild(M),u._fill=null)},_updateCircle:function(u){var b=u._point.round(),M=Math.round(u._radius),$=Math.round(u._radiusY||M);this._setPath(u,u._empty()?"M0 0":"AL "+b.x+","+b.y+" "+M+","+$+" 0,"+65535*360)},_setPath:function(u,b){u._path.v=b},_bringToFront:function(u){pn(u._container)},_bringToBack:function(u){Na(u._container)}},pa=Ve.vml?Ls:zn,go=br.extend({_initContainer:function(){this._container=pa("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=pa("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){An(this._container),Rn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){br.prototype._update.call(this);var u=this._bounds,b=u.getSize(),M=this._container;(!this._svgSize||!this._svgSize.equals(b))&&(this._svgSize=b,M.setAttribute("width",b.x),M.setAttribute("height",b.y)),Xn(M,u.min),M.setAttribute("viewBox",[u.min.x,u.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(u){var b=u._path=pa("path");u.options.className&&$i(b,u.options.className),u.options.interactive&&$i(b,"leaflet-interactive"),this._updateStyle(u),this._layers[A(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){An(u._path),u.removeInteractiveTarget(u._path),delete this._layers[A(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var b=u._path,M=u.options;b&&(M.stroke?(b.setAttribute("stroke",M.color),b.setAttribute("stroke-opacity",M.opacity),b.setAttribute("stroke-width",M.weight),b.setAttribute("stroke-linecap",M.lineCap),b.setAttribute("stroke-linejoin",M.lineJoin),M.dashArray?b.setAttribute("stroke-dasharray",M.dashArray):b.removeAttribute("stroke-dasharray"),M.dashOffset?b.setAttribute("stroke-dashoffset",M.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),M.fill?(b.setAttribute("fill",M.fillColor||M.color),b.setAttribute("fill-opacity",M.fillOpacity),b.setAttribute("fill-rule",M.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(u,b){this._setPath(u,it(u._parts,b))},_updateCircle:function(u){var b=u._point,M=Math.max(Math.round(u._radius),1),$=Math.max(Math.round(u._radiusY),1)||M,Z="a"+M+","+$+" 0 1,0 ",ce=u._empty()?"M0 0":"M"+(b.x-M)+","+b.y+Z+M*2+",0 "+Z+-M*2+",0 ";this._setPath(u,ce)},_setPath:function(u,b){u._path.setAttribute("d",b)},_bringToFront:function(u){pn(u._path)},_bringToBack:function(u){Na(u._path)}});Ve.vml&&go.include(dl);function Ha(u){return Ve.svg||Ve.vml?new go(u):null}tn.include({getRenderer:function(u){var b=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var b=this._paneRenderers[u];return b===void 0&&(b=this._createRenderer({pane:u}),this._paneRenderers[u]=b),b},_createRenderer:function(u){return this.options.preferCanvas&&wr(u)||Ha(u)}});var Sr=ka.extend({initialize:function(u,b){ka.prototype.initialize.call(this,this._boundsToLatLngs(u),b)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=ot(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function Eu(u,b){return new Sr(u,b)}go.create=pa,go.pointsToPath=it,Va.geometryToLayer=Gs,Va.coordsToLatLng=ol,Va.coordsToLatLngs=ic,Va.latLngToCoords=nc,Va.latLngsToCoords=qa,Va.getFeature=fo,Va.asFeature=ll,tn.mergeOptions({boxZoom:!0});var er=Ta.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){Ii(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Rn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){An(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Co(),lo(),this._startPoint=this._map.mouseEventToContainerPoint(u),Ii(document,{contextmenu:la,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=yi("div","leaflet-zoom-box",this._container),$i(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var b=new xe(this._point,this._startPoint),M=b.getSize();Xn(this._box,b.min),this._box.style.width=M.x+"px",this._box.style.height=M.y+"px"},_finish:function(){this._moved&&(An(this._box),Ln(this._container,"leaflet-crosshair")),Zr(),Il(),Rn(document,{contextmenu:la,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(y(this._resetState,this),0);var b=new st(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});tn.addInitHook("addHandler","boxZoom",er),tn.mergeOptions({doubleClickZoom:!0});var $l=Ta.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var b=this._map,M=b.getZoom(),$=b.options.zoomDelta,Z=u.originalEvent.shiftKey?M-$:M+$;b.options.doubleClickZoom==="center"?b.setZoom(Z):b.setZoomAround(u.containerPoint,Z)}});tn.addInitHook("addHandler","doubleClickZoom",$l),tn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Xr=Ta.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new uo(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}$i(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ln(this._map._container,"leaflet-grab"),Ln(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=ot(this._map.options.maxBounds);this._offsetLimit=Ce(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var b=this._lastTime=+new Date,M=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(M),this._times.push(b),this._prunePositions(b)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,b){return u-(u-b)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;u.x<b.min.x&&(u.x=this._viscousLimit(u.x,b.min.x)),u.y<b.min.y&&(u.y=this._viscousLimit(u.y,b.min.y)),u.x>b.max.x&&(u.x=this._viscousLimit(u.x,b.max.x)),u.y>b.max.y&&(u.y=this._viscousLimit(u.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,b=Math.round(u/2),M=this._initialWorldOffset,$=this._draggable._newPos.x,Z=($-b+M)%u+b-M,ce=($+b+M)%u-b-M,Ae=Math.abs(Z+M)<Math.abs(ce+M)?Z:ce;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ae},_onDragEnd:function(u){var b=this._map,M=b.options,$=!M.inertia||u.noInertia||this._times.length<2;if(b.fire("dragend",u),$)b.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),ce=(this._lastTime-this._times[0])/1e3,Ae=M.easeLinearity,Je=Z.multiplyBy(Ae/ce),dt=Je.distanceTo([0,0]),wt=Math.min(M.inertiaMaxSpeed,dt),Yt=Je.multiplyBy(wt/dt),_i=wt/(M.inertiaDeceleration*Ae),un=Yt.multiplyBy(-_i/2).round();!un.x&&!un.y?b.fire("moveend"):(un=b._limitOffset(un,b.options.maxBounds),at(function(){b.panBy(un,{duration:_i,easeLinearity:Ae,noMoveStart:!0,animate:!0})}))}}});tn.addInitHook("addHandler","dragging",Xr),tn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ac=Ta.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),Ii(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Rn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,b=document.documentElement,M=u.scrollTop||b.scrollTop,$=u.scrollLeft||b.scrollLeft;this._map._container.focus(),window.scrollTo($,M)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var b=this._panKeys={},M=this.keyCodes,$,Z;for($=0,Z=M.left.length;$<Z;$++)b[M.left[$]]=[-1*u,0];for($=0,Z=M.right.length;$<Z;$++)b[M.right[$]]=[u,0];for($=0,Z=M.down.length;$<Z;$++)b[M.down[$]]=[0,u];for($=0,Z=M.up.length;$<Z;$++)b[M.up[$]]=[0,-1*u]},_setZoomDelta:function(u){var b=this._zoomKeys={},M=this.keyCodes,$,Z;for($=0,Z=M.zoomIn.length;$<Z;$++)b[M.zoomIn[$]]=u;for($=0,Z=M.zoomOut.length;$<Z;$++)b[M.zoomOut[$]]=-u},_addHooks:function(){Ii(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Rn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var b=u.keyCode,M=this._map,$;if(b in this._panKeys){if(!M._panAnim||!M._panAnim._inProgress)if($=this._panKeys[b],u.shiftKey&&($=lt($).multiplyBy(3)),M.options.maxBounds&&($=M._limitOffset(lt($),M.options.maxBounds)),M.options.worldCopyJump){var Z=M.wrapLatLng(M.unproject(M.project(M.getCenter()).add($)));M.panTo(Z)}else M.panBy($)}else if(b in this._zoomKeys)M.setZoom(M.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[b]);else if(b===27&&M._popup&&M._popup.options.closeOnEscapeKey)M.closePopup();else return;la(u)}}});tn.addInitHook("addHandler","keyboard",ac),tn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var fl=Ta.extend({addHooks:function(){Ii(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Rn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var b=Qs(u),M=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var $=Math.max(M-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(y(this._performZoom,this),$),la(u)},_performZoom:function(){var u=this._map,b=u.getZoom(),M=this._map.options.zoomSnap||0;u._stop();var $=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs($))))/Math.LN2,ce=M?Math.ceil(Z/M)*M:Z,Ae=u._limitZoom(b+(this._delta>0?ce:-ce))-b;this._delta=0,this._startTime=null,Ae&&(u.options.scrollWheelZoom==="center"?u.setZoom(b+Ae):u.setZoomAround(this._lastMousePos,b+Ae))}});tn.addInitHook("addHandler","scrollWheelZoom",fl);var Kr=600;tn.mergeOptions({tapHold:Ve.touchNative&&Ve.safari&&Ve.mobile,tapTolerance:15});var pl=Ta.extend({addHooks:function(){Ii(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Rn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var b=u.touches[0];this._startPos=this._newPos=new We(b.clientX,b.clientY),this._holdTimeout=setTimeout(y(function(){this._cancel(),this._isTapValid()&&(Ii(document,"touchend",Ts),Ii(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",b))},this),Kr),Ii(document,"touchend touchcancel contextmenu",this._cancel,this),Ii(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){Rn(document,"touchend",Ts),Rn(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),Rn(document,"touchend touchcancel contextmenu",this._cancel,this),Rn(document,"touchmove",this._onMove,this)},_onMove:function(u){var b=u.touches[0];this._newPos=new We(b.clientX,b.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,b){var M=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY});M._simulated=!0,b.target.dispatchEvent(M)}});tn.addInitHook("addHandler","tapHold",pl),tn.mergeOptions({touchZoom:Ve.touch,bounceAtZoomLimits:!0});var ml=Ta.extend({addHooks:function(){$i(this._map._container,"leaflet-touch-zoom"),Ii(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ln(this._map._container,"leaflet-touch-zoom"),Rn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var b=this._map;if(!(!u.touches||u.touches.length!==2||b._animatingZoom||this._zooming)){var M=b.mouseEventToContainerPoint(u.touches[0]),$=b.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),b.options.touchZoom!=="center"&&(this._pinchStartLatLng=b.containerPointToLatLng(M.add($)._divideBy(2))),this._startDist=M.distanceTo($),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),Ii(document,"touchmove",this._onTouchMove,this),Ii(document,"touchend touchcancel",this._onTouchEnd,this),Ts(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var b=this._map,M=b.mouseEventToContainerPoint(u.touches[0]),$=b.mouseEventToContainerPoint(u.touches[1]),Z=M.distanceTo($)/this._startDist;if(this._zoom=b.getScaleZoom(Z,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&Z<1||this._zoom>b.getMaxZoom()&&Z>1)&&(this._zoom=b._limitZoom(this._zoom)),b.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var ce=M._add($)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&ce.x===0&&ce.y===0)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(ce),this._zoom)}this._moved||(b._moveStart(!0,!1),this._moved=!0),et(this._animRequest);var Ae=y(b._move,b,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=at(Ae,this,!0),Ts(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,et(this._animRequest),Rn(document,"touchmove",this._onTouchMove,this),Rn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});tn.addInitHook("addHandler","touchZoom",ml),tn.BoxZoom=er,tn.DoubleClickZoom=$l,tn.Drag=Xr,tn.Keyboard=ac,tn.ScrollWheelZoom=fl,tn.TapHold=pl,tn.TouchZoom=ml,s.Bounds=xe,s.Browser=Ve,s.CRS=It,s.Canvas=os,s.Circle=jo,s.CircleMarker=da,s.Class=gt,s.Control=Ui,s.DivIcon=Tu,s.DivOverlay=js,s.DomEvent=zc,s.DomUtil=Bs,s.Draggable=uo,s.Evented=ct,s.FeatureGroup=Rr,s.GeoJSON=Va,s.GridLayer=zo,s.Handler=Ta,s.Icon=ua,s.ImageOverlay=mo,s.LatLng=_t,s.LatLngBounds=st,s.Layer=gn,s.LayerGroup=En,s.LineUtil=nl,s.Map=tn,s.Marker=rl,s.Mixin=ih,s.Path=ha,s.Point=We,s.PolyUtil=xu,s.Polygon=ka,s.Polyline=Gr,s.Popup=Ro,s.PosAnimation=Po,s.Projection=ys,s.Rectangle=Sr,s.Renderer=br,s.SVG=go,s.SVGOverlay=Nl,s.TileLayer=fa,s.Tooltip=hl,s.Transformation=Mi,s.Util=Et,s.VideoOverlay=Wr,s.bind=y,s.bounds=Ce,s.canvas=wr,s.circle=al,s.circleMarker=Dl,s.control=ca,s.divIcon=Vc,s.extend=f,s.featureGroup=zl,s.geoJSON=sc,s.geoJson=Lo,s.gridLayer=Bl,s.icon=Ea,s.imageOverlay=cl,s.latLng=kt,s.latLngBounds=ot,s.layerGroup=sl,s.map=Ua,s.marker=Uc,s.point=lt,s.polygon=Ol,s.polyline=Fc,s.popup=rc,s.rectangle=Eu,s.setOptions=ne,s.stamp=A,s.svg=Ha,s.svgOverlay=ul,s.tileLayer=Kn,s.tooltip=Qh,s.transformation=Di,s.version=l,s.videoOverlay=Ca;var oc=window.L;s.noConflict=function(){return window.L=oc,this},window.L=s}))})(Am,Am.exports)),Am.exports}var tg=a2();const Xh=Kh(tg);function Gx(t,e,s){return Object.freeze({instance:t,context:e,container:s})}function Wx(t,e){return e==null?function(l,f){const _=Q.useRef(void 0);return _.current||(_.current=t(l,f)),_}:function(l,f){const _=Q.useRef(void 0);_.current||(_.current=t(l,f));const y=Q.useRef(l),{instance:d}=_.current;return Q.useEffect(function(){y.current!==l&&(e(d,l,y.current),y.current=l)},[d,l,e]),_}}function o2(t,e){Q.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function l2(t){return function(s){const l=Hx(),f=t(Zx(s,l),l);return vR(l.map,s.attribution),r2(f.current,s.eventHandlers),o2(f.current,l),f}}function ER(t,e){const s=Q.useRef(void 0);Q.useEffect(function(){if(e.pathOptions!==s.current){const f=e.pathOptions??{};t.instance.setStyle(f),s.current=f}},[t,e])}function kR(t){return function(s){const l=Hx(),f=t(Zx(s,l),l);return r2(f.current,s.eventHandlers),o2(f.current,l),ER(f.current,s),f}}function CR(t,e){const s=Wx(t,e),l=l2(s);return s2(l)}function AR(t,e){const s=Wx(t,e),l=kR(s);return s2(l)}function MR(t,e){const s=Wx(t,e),l=l2(s);return SR(l)}function PR(t,e,s){const{opacity:l,zIndex:f}=e;l!=null&&l!==s.opacity&&t.setOpacity(l),f!=null&&f!==s.zIndex&&t.setZIndex(f)}function gp(){return Hx().map}function c2(t){const e=gp();return Q.useEffect(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}const rw=AR(function({center:e,children:s,...l},f){const _=new tg.CircleMarker(e,l);return Gx(_,n2(f,{overlayContainer:_}))},xR);function IR({bounds:t,boundsOptions:e,center:s,children:l,className:f,id:_,placeholder:y,style:d,whenReady:A,zoom:I,...B},N){const[V]=Q.useState({className:f,id:_,style:d}),[K,se]=Q.useState(null),ne=Q.useRef(void 0);Q.useImperativeHandle(N,()=>K?.map??null,[K]);const ve=Q.useCallback(ge=>{if(ge!==null&&!ne.current){const oe=new tg.Map(ge,B);ne.current=oe,s!=null&&I!=null?oe.setView(s,I):t!=null&&oe.fitBounds(t,e),A!=null&&oe.whenReady(A),se(wR(oe))}},[]);Q.useEffect(()=>()=>{K?.map.remove()},[K]);const re=K?Nt.createElement(qx,{value:K},l):y??null;return Nt.createElement("div",{...V,ref:ve},re)}const Yx=Q.forwardRef(IR),t_=CR(function({position:e,...s},l){const f=new tg.Marker(e,s);return Gx(f,n2(l,{overlayContainer:f}))},function(e,s,l){s.position!==l.position&&e.setLatLng(s.position),s.icon!=null&&s.icon!==l.icon&&e.setIcon(s.icon),s.zIndexOffset!=null&&s.zIndexOffset!==l.zIndexOffset&&e.setZIndexOffset(s.zIndexOffset),s.opacity!=null&&s.opacity!==l.opacity&&e.setOpacity(s.opacity),e.dragging!=null&&s.draggable!==l.draggable&&(s.draggable===!0?e.dragging.enable():e.dragging.disable())}),jR=MR(function({url:e,...s},l){const f=new tg.TileLayer(e,Zx(s,l));return Gx(f,l)},function(e,s,l){PR(e,s,l);const{url:f}=s;f!=null&&f!==l.url&&e.setUrl(f)}),Xx=()=>{const t=gp();return Q.useEffect(()=>{const e=t.getContainer();if(!e)return;let s=0;const l=()=>{s&&cancelAnimationFrame(s),s=requestAnimationFrame(()=>{t.invalidateSize();const _=t._maplibreMap;_?.resize&&_.resize()})};l();let f=null;return"ResizeObserver"in window?(f=new ResizeObserver(()=>l()),f.observe(e)):window.addEventListener("resize",l),()=>{f?f.disconnect():window.removeEventListener("resize",l),s&&cancelAnimationFrame(s)}},[t]),null},LR=({center:t,pins:e})=>{const s=gp();return Q.useEffect(()=>{const l=[];t&&l.push([t.lat,t.lng]);for(const _ of e)l.push([_.lat,_.lng]);if(l.length===0)return;const f=Xh.latLngBounds(l);s.fitBounds(f,{padding:[18,18],maxZoom:13,animate:!1})},[t,s,e]),null},RR=({center:t,pins:e,onOpenMap:s})=>{const l=Q.useMemo(()=>t?[t.lat,t.lng]:e.length>0?[e[0].lat,e[0].lng]:[37.3891,-5.9845],[t,e]);return S.jsx("section",{className:"space-y-3",children:S.jsx("button",{type:"button",onClick:s,className:"relative w-full overflow-hidden text-left",children:S.jsxs("div",{className:"relative h-44 w-full overflow-hidden bg-black",children:[S.jsx("div",{className:"pointer-events-none absolute inset-0",children:S.jsxs(Yx,{center:l,zoom:12,className:"h-full w-full",zoomControl:!1,dragging:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,keyboard:!1,attributionControl:!1,children:[S.jsx(Xx,{}),S.jsx(jR,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),S.jsx(LR,{center:t,pins:e}),t&&S.jsx(rw,{center:[t.lat,t.lng],radius:6,pathOptions:{color:"#ffffff",fillColor:"#ffffff",fillOpacity:1,weight:2}}),e.map(f=>S.jsx(rw,{center:[f.lat,f.lng],radius:7,pathOptions:{color:"#ff6b4a",fillColor:"#ff6b4a",fillOpacity:.95,weight:2}},f.id))]})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Map"}),S.jsx("p",{className:"mt-1 text-sm font-semibold text-white/90",children:e.length>0?`${e.length} nearby`:"Open the map to explore"})]})]})})})},zR=({loading:t,trending:e,meta:s})=>{const l=Fr();return S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Trending"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Trending this week"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>l.push("/tabs/map"),children:"Explore"})]}),t?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(Js,{name:"crescent"})}):e.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No trending nights yet"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Open the map to see what people are going to."})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:e.map(f=>{const _=s[f.id],d=[_?.saves?`${_.saves} likes`:null,_?.going?`${_.going} going`:null,_?.attended?`${_.attended} attended`:null,_?.moments?`${_.moments} moments`:null].filter(Boolean).slice(0,2).join("  ");return S.jsx(Jl,{event:{...f,cover_image_url:dp(f)},className:"w-[220px] shrink-0",kicker:m_(f.starts_at),title:g_(f),subtitle:f.venue_place?.name||f.city,badge:d||void 0,onSelect:A=>l.push(`/event/${A.id}`)},f.id)})})]})},DR=({loading:t,canFollow:e,followedSubjectIds:s,suggestedArtists:l,suggestedVenues:f,onToggleFollowSubject:_})=>{const y=Fr();return S.jsxs("section",{className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Discover"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Artists & venues"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Follow to keep them close."})]}),t?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(Js,{name:"crescent"})}):S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Artists"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>y.push("/tabs/discover",{initialTab:"artists"}),children:"Explore"})]}),l.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No suggestions yet."}):S.jsx("div",{className:"space-y-2",children:l.slice(0,6).map(d=>{const A=s.has(d.subject_id);return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:()=>y.push(`/artist/${d.id}`),children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:d.avatar_url?S.jsx("img",{src:d.avatar_url,alt:d.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:d.name}),S.jsxs("p",{className:"text-xs text-white/55",children:[d.upcomingCount," upcoming"]})]})]}),S.jsx("button",{type:"button",className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${A?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,onClick:()=>_(d.subject_id),disabled:!e,children:A?"Following":"Follow"})]},d.id)})})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venues"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>y.push("/tabs/discover",{initialTab:"venues"}),children:"Explore"})]}),f.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No suggestions yet."}):S.jsx("div",{className:"space-y-2",children:f.slice(0,6).map(d=>{const A=s.has(d.subject_id);return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"min-w-0 flex-1 text-left",onClick:()=>y.push(`/venue/${d.id}`),children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:d.name}),S.jsxs("p",{className:"mt-1 text-xs text-white/55",children:[d.city,"  ",d.upcomingCount," upcoming"]})]}),S.jsx("button",{type:"button",className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${A?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,onClick:()=>_(d.subject_id),disabled:!e,children:A?"Following":"Follow"})]},d.id)})})]})]})]})},OR=({visible:t,events:e})=>{const s=Fr();return t?S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Following"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"From artists you follow"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>s.push("/tabs/map"),children:"Explore"})]}),e.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No upcoming shows from artists you follow"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Open the map to find something new."})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:e.map(l=>S.jsx(Jl,{event:{...l,cover_image_url:dp(l)},className:"w-[220px] shrink-0",kicker:m_(l.starts_at),title:g_(l),subtitle:l.venue_place?.name||l.city,onSelect:f=>s.push(`/event/${f.id}`)},l.id))})]}):null},u2=()=>{const[t,e]=Q.useState(0);return Q.useEffect(()=>{const s=()=>{document.visibilityState&&document.visibilityState!=="visible"||e(l=>l+1)};return window.addEventListener("focus",s),document.addEventListener("visibilitychange",s),()=>{window.removeEventListener("focus",s),document.removeEventListener("visibilitychange",s)}},[]),t},NR=t=>{const{loading:e}=Vr(),s=u2(),[l,f]=Q.useState([]),[_,y]=Q.useState(!0),[d,A]=Q.useState("");return Q.useEffect(()=>{if(e)return;let I=!1;return y(!0),A(""),_r(`events:list:${t.startIso}:${t.endIso}`,async()=>{const{data:B,error:N}=await Pt.from("events").select(`
            *,
            organizer:profiles!events_organizer_id_fkey (
              id,
              username,
              display_name,
              role
            ),
            venue_place:venue_places!events_venue_place_id_fkey (
              id,
              name,
              city,
              address,
              latitude,
              longitude
            ),
            event_artists (
              artist:artists!event_artists_artist_entity_fk (
                id,
                name,
                avatar_url
              )
            )
          `).gte("starts_at",t.startIso).lte("starts_at",t.endIso).order("starts_at",{ascending:!0});if(N)throw N;return B||[]},{ttlMs:1e4}).then(B=>{I||f(B)}).catch(()=>{I||(A("Could not load events. Check your Supabase connection."),f([]))}).finally(()=>{I||y(!1)}),()=>{I=!0}},[e,t.endIso,t.startIso,s]),{events:l,loading:_,error:d}},BR=(t,e)=>{const[s,l]=Q.useState([]),[f,_]=Q.useState({}),[y,d]=Q.useState(!1);return Q.useEffect(()=>{if(t.length===0){l([]),_({});return}let A=!1;return(async()=>{d(!0);try{const B=new Date(Date.now()-2592e5).toISOString(),[N,V,K]=await _r(`trending:since:${B}`,async()=>{const[oe,me,ye]=await Promise.all([Pt.from("event_saves").select("event_id,created_at").gte("created_at",B).limit(1e3),Pt.from("event_attendance").select("event_id,status,created_at").gte("created_at",B).limit(1e3),Pt.from("posts").select("event_id,created_at").gte("created_at",B).limit(1e3)]);return[oe.data||[],me.data||[],ye.data||[]]},{ttlMs:1e4}),se={},ne=(oe,me)=>{se[oe]||={saves:0,going:0,attended:0,moments:0,score:0},se[oe][me]+=1};for(const oe of N)oe?.event_id&&ne(oe.event_id,"saves");for(const oe of V)oe?.event_id&&ne(oe.event_id,oe.status==="attended"?"attended":"going");for(const oe of K)oe?.event_id&&ne(oe.event_id,"moments");for(const[oe,me]of Object.entries(se)){me.score=me.saves*2+me.going*3+me.attended*4+me.moments*4;const ye=t.find(Ge=>Ge.id===oe);if(!ye){me.score=0;continue}const ke=new Date(ye.starts_at);ke.getTime()>=e.getTime()-1e3*60*60*24&&ke.getTime()<=e.getTime()+1e3*60*60*24*7||(me.score=0)}const ve=Object.entries(se).filter(([,oe])=>oe.score>0).sort((oe,me)=>me[1].score-oe[1].score).slice(0,6).map(([oe])=>oe),re=ve.map(oe=>t.find(me=>me.id===oe)).filter(Boolean),ge={};for(const oe of ve){const me=se[oe];me&&(ge[oe]={saves:me.saves,going:me.going,attended:me.attended,moments:me.moments})}if(A)return;l(re),_(ge)}catch{if(A)return;l([]),_({})}finally{A||d(!1)}})(),()=>{A=!0}},[t,e]),{trending:s,meta:f,loading:y}},$R=(t,e)=>{const[s,l]=Q.useState([]),[f,_]=Q.useState([]),[y,d]=Q.useState(!1);return Q.useEffect(()=>{if(t.length===0){l([]),_([]);return}let A=!1;return(async()=>{d(!0);try{const B=t.filter(re=>{const ge=new Date(re.starts_at);return ge>=e.startOfToday&&ge<=e.endOfEventsWindow}),N=new Map,V=new Map;for(const re of B){for(const ge of re.event_artists||[]){if(!ge?.artist?.id)continue;const oe=N.get(ge.artist.id);N.set(ge.artist.id,{id:ge.artist.id,count:(oe?.count||0)+1})}if(re.venue_place?.id){const ge=V.get(re.venue_place.id);V.set(re.venue_place.id,{id:re.venue_place.id,name:re.venue_place.name,city:re.venue_place.city,count:(ge?.count||0)+1})}}const K=Array.from(N.values()).sort((re,ge)=>ge.count-re.count).slice(0,10).map(re=>re.id),se=await(async()=>{if(K.length===0)return[];const re=Array.from(new Set(K)).sort(),ge=re.join(","),oe=await _r(`artists:by_ids:${ge}`,async()=>{const{data:ye,error:ke}=await Pt.from("v_subject_artists").select("artist_id,name,avatar_url,subject_id").in("artist_id",re);if(ke)throw ke;return ye||[]},{ttlMs:6e4}),me=new Map;for(const ye of oe)ye.artist_id&&me.set(ye.artist_id,ye);return K.map(ye=>{const ke=me.get(ye),Re=N.get(ye);return!ke?.subject_id||!Re?null:{id:ye,subject_id:ke.subject_id,name:ke.name,avatar_url:ke.avatar_url,upcomingCount:Re.count}}).filter(Boolean)})(),ne=Array.from(V.values()).sort((re,ge)=>ge.count-re.count).slice(0,10),ve=await _r(`home:suggested:venues:${ne.map(re=>re.id).join(",")}`,async()=>{if(ne.length===0)return[];const re=ne.map(oe=>oe.id),ge=new Map;try{const{data:oe,error:me}=await Pt.from("subjects").select("id,venue_place_id,type").eq("type","venue").in("venue_place_id",re);if(me)throw me;for(const ye of oe||[]){const ke=ye.venue_place_id,Re=ye.id;ke&&Re&&ge.set(ke,Re)}}catch{}for(const oe of ne){if(ge.has(oe.id))continue;const me=await _r(`subject:venue:${oe.id}`,async()=>{const{data:ye,error:ke}=await Pt.rpc("get_or_create_venue_subject",{p_venue_place_id:oe.id});if(ke)throw ke;return ye},{ttlMs:1440*60*1e3}).catch(()=>null);typeof me=="string"&&ge.set(oe.id,me)}return ne.map(oe=>{const me=ge.get(oe.id);return me?{id:oe.id,subject_id:me,name:oe.name,city:oe.city,upcomingCount:oe.count}:null}).filter(Boolean)},{ttlMs:3e4});if(A)return;l(se),_(ve)}catch{if(A)return;l([]),_([])}finally{A||d(!1)}})(),()=>{A=!0}},[t,e.endOfEventsWindow,e.startOfToday]),{suggestedArtists:s,suggestedVenues:f,loading:y}},UR=t=>{const[e,s]=Q.useState(new Set);return Q.useEffect(()=>{const l=Array.from(t);if(l.length===0){s(new Set);return}let f=!1;return _r(`subjects:artist_ids:${l.sort().join(",")}`,async()=>{const{data:_,error:y}=await Pt.from("subjects").select("id,type,artist_id").in("id",l);if(y)throw y;return(_||[]).filter(d=>d.type==="artist"&&d.artist_id).map(d=>d.artist_id)},{ttlMs:1e4}).then(_=>{f||s(new Set(_))}).catch(()=>{f||s(new Set)}),()=>{f=!0}},[t]),e},h2="live_space.pending_moments.dismissed",FR=()=>{try{const t=window.localStorage.getItem(h2);if(!t)return{};const e=JSON.parse(t);return e&&typeof e=="object"?e:{}}catch{return{}}},VR=t=>{try{window.localStorage.setItem(h2,JSON.stringify(t))}catch{}},qR=t=>{const e=new Date(t.starts_at);return t.ends_at?new Date(t.ends_at):new Date(e.getTime()+360*60*1e3)},HR=t=>t<24?"You attended yesterday":t<48?"You attended 2 days ago":"You attended recently",ZR=async(t,e)=>await _r(`posts:count:user:${t}:event:${e}`,async()=>{const{count:l,error:f}=await Pt.from("posts").select("id",{count:"exact",head:!0}).eq("user_id",t).eq("event_id",e);if(f)throw f;return l||0},{ttlMs:1e4})>0,GR=async t=>_r(`attendance:user:${t}`,async()=>{const{data:e,error:s}=await Pt.from("event_attendance").select("event_id,status,created_at").eq("user_id",t).in("status",["going","attended"]).order("created_at",{ascending:!1}).limit(50);if(s)throw s;return e||[]},{ttlMs:1e4}),WR=async t=>_r(`event:detail:${t}`,async()=>{const{data:e,error:s}=await Pt.from("events").select(`
          *,
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `).eq("id",t).maybeSingle();if(s)throw s;return e||null},{ttlMs:6e4}),YR=t=>{const{user:e}=Vr(),s=e?.id||null,l=t.now?t.now.getTime():null,[f,_]=Q.useState({});Q.useEffect(()=>{_(FR())},[]);const y=V=>{const K={...f,[V]:Date.now()};_(K),VR(K)},[d,A]=Q.useState({kind:"loading"}),[I,B]=Q.useState(null);Q.useEffect(()=>{if(!s){A({kind:"cold_start"}),B(null);return}let V=!1;return(async()=>{A({kind:"loading"}),B(null);try{const se=new Date(l??Date.now()),ne=await GR(s);if(V)return;const ve=new Map;for(const Re of t.events)ve.set(Re.id,Re);const re=async Re=>{const Ge=ve.get(Re);if(Ge)return Ge;const He=await WR(Re);return He&&ve.set(Re,He),He},ge=ne.filter(Re=>Re.status==="attended"),oe=[];for(const Re of ge){const Ge=await re(Re.event_id);if(!Ge)continue;const He=qR(Ge),Xe=(se.getTime()-He.getTime())/(1e3*60*60);Xe<0||Xe>72||oe.push({event:Ge,hoursSinceEnd:Xe})}oe.sort((Re,Ge)=>Re.hoursSinceEnd-Ge.hoursSinceEnd);const me=async()=>{const Re=ne.filter(He=>He.status==="going"),Ge=[];for(const He of Re){const Xe=await re(He.event_id);!Xe||new Date(Xe.starts_at).getTime()<se.getTime()||Ge.push(Xe)}return Ge.sort((He,Xe)=>new Date(He.starts_at).getTime()-new Date(Xe.starts_at).getTime()),Ge};for(const Re of oe){const Ge=f[Re.event.id];if(Ge&&Date.now()-Ge<1e3*60*60*24*7||await ZR(s,Re.event.id))continue;const Xe=await me();B(Xe[0]||null);const at=Re.hoursSinceEnd<=36?"hero":"compact",et=HR(Re.hoursSinceEnd);A({kind:"just_attended",event:Re.event,hoursSinceEnd:Re.hoursSinceEnd,timeLabel:et,size:at});return}const ye=await me(),ke=ye[0]||null;if(B(ye[1]||null),ke){A({kind:"upcoming",event:ke});return}A({kind:"cold_start"})}catch{if(V)return;A({kind:"cold_start"}),B(null)}})(),()=>{V=!0}},[f,l,t.events,s]);const N=V=>{s&&ZS(`posts:count:user:${s}:event:${V}`)};return Q.useMemo(()=>({hero:d,nextUpcoming:I,dismissPendingMoments:y,refreshMomentsForEvent:N}),[y,d,I])},aw=t=>t.venue_place?.name||t.address||t.city||"Venue",ow=t=>t.event_artists?.find(s=>s.artist)?.artist?.name||t.name,lw=t=>new Date(t).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),XR=({state:t,onDismissPendingMoments:e})=>{const s=Fr(),l=Q.useMemo(()=>{if(t.kind==="loading")return S.jsx("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("div",{className:"h-8 w-3/4 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-3 h-4 w-1/2 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-2 h-3 w-1/3 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-5 h-11 w-full animate-pulse rounded bg-white/10"})]})});if(t.kind==="cold_start")return S.jsx("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:"Discover concerts near you"}),S.jsxs("div",{className:"mt-5 flex items-center gap-3",children:[S.jsx("button",{type:"button",className:"rounded bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>s.push("/tabs/map"),children:"Explore map"}),S.jsx("button",{type:"button",className:"rounded bg-white/10 px-4 py-2 text-sm font-semibold text-white/90",onClick:()=>s.push("/tabs/discover"),children:"Discover"})]})]})});if(t.kind==="upcoming"){const A=dp(t.event),I=ow(t.event),B=aw(t.event),N=lw(t.event.starts_at);return S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[A?S.jsx("img",{src:A,alt:t.event.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Youre going to"}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:I}),S.jsx("p",{className:"mt-2 text-sm font-semibold uppercase tracking-[0.18em] text-white/80",children:B}),S.jsx("p",{className:"mt-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:N}),S.jsx("div",{className:"mt-5",children:S.jsx("button",{type:"button",className:"w-full rounded bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>s.push(`/event/${t.event.id}`),children:"View event"})})]})]})}const f=dp(t.event),_=ow(t.event),y=aw(t.event),d=lw(t.event.starts_at);return S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[f?S.jsx("img",{src:f,alt:t.event.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),e&&S.jsx("button",{type:"button",className:"absolute right-4 top-4 z-10 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>e(t.event.id),children:"Dismiss"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:["Last night at ",y]}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:_}),S.jsx("p",{className:"mt-2 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:d}),S.jsx("div",{className:"mt-5",children:S.jsx("button",{type:"button",className:"w-full rounded bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white",onClick:()=>s.push(`/event/${t.event.id}`,{openAddMoments:!0}),children:"Add your moments"})})]})]})},[s,e,t]);return S.jsx("section",{children:l})},KR=50,JR=4,QR=()=>{const t=Fr(),{canCreateEvent:e}=mp(),s=Q.useMemo(()=>{const gt=new Date;return gt.setHours(0,0,0,0),gt},[]),l=Q.useMemo(()=>{const gt=new Date(s);return gt.setDate(gt.getDate()+14),gt.setHours(23,59,59,999),gt},[s]),f=Q.useMemo(()=>{const gt=new Date(s);return gt.setDate(gt.getDate()+30),gt.setHours(23,59,59,999),gt},[s]),_=Q.useMemo(()=>new Date(s.getTime()-1e3*60*60*24*JR).toISOString(),[s]),y=Q.useMemo(()=>f.toISOString(),[f]),{location:d,loading:A,error:I,requestLocation:B}=dR(),{events:N,loading:V,error:K}=NR({startIso:_,endIso:y}),{hero:se,nextUpcoming:ne,dismissPendingMoments:ve}=YR({events:N}),re=Q.useMemo(()=>{if(!d)return[];const gt=[];for(const pt of N){const $e=new Date(pt.starts_at);if($e<s||$e>l)continue;const ct=qh(pt.latitude??pt.venue_place?.latitude??null),We=qh(pt.longitude??pt.venue_place?.longitude??null);if(ct===null||We===null)continue;const Tt=Vx(d.lat,d.lng,ct,We);Tt>KR||gt.push({...pt,distanceKm:Tt})}return gt.sort((pt,$e)=>new Date(pt.starts_at).getTime()-new Date($e.starts_at).getTime()||pt.distanceKm-$e.distanceKm),gt},[l,N,d,s]),ge=Q.useMemo(()=>re.map(gt=>{const pt=qh(gt.latitude??gt.venue_place?.latitude??null),$e=qh(gt.longitude??gt.venue_place?.longitude??null);return pt===null||$e===null?null:{id:gt.id,lat:pt,lng:$e}}).filter(Boolean).slice(0,12),[re]),{trending:oe,meta:me,loading:ye}=BR(N,s),{suggestedArtists:ke,suggestedVenues:Re,loading:Ge}=$R(N,{startOfToday:s,endOfEventsWindow:f}),{canFollow:He,followedSubjectIds:Xe,toggleFollowSubject:at}=i2(),et=UR(Xe),Et=Q.useMemo(()=>{if(et.size===0)return[];const gt=N.filter(pt=>{const $e=new Date(pt.starts_at);return $e<s||$e>f?!1:(pt.event_artists||[]).some(ct=>ct.artist?.id&&et.has(ct.artist.id))});return gt.sort((pt,$e)=>new Date(pt.starts_at).getTime()-new Date($e.starts_at).getTime()),gt.slice(0,6)},[f,N,et,s]);return S.jsxs(ao,{children:[S.jsx(XR,{state:se,onDismissPendingMoments:se.kind==="just_attended"?ve:void 0}),se.kind!=="just_attended"&&S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[se.kind!=="cold_start"&&ne&&S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Next"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Coming up"})]}),S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:S.jsx(Jl,{event:{...ne,cover_image_url:dp(ne)},className:"w-[220px] shrink-0",kicker:m_(ne.starts_at),title:g_(ne),subtitle:ne.venue_place?.name||ne.city,onSelect:gt=>t.push(`/event/${gt.id}`)})})]}),se.kind==="cold_start"&&S.jsx(_R,{canCreateEvent:e,loading:V,loadError:K,location:d,locationLoading:A,locationError:I,onRequestLocation:B,nearbyUpcoming:re}),S.jsx(RR,{center:d,pins:ge,onOpenMap:()=>t.push("/tabs/map")}),S.jsx(zR,{loading:ye,trending:oe,meta:me}),S.jsx(DR,{loading:Ge,canFollow:He,followedSubjectIds:Xe,suggestedArtists:ke,suggestedVenues:Re,onToggleFollowSubject:gt=>{at(gt)}}),S.jsx(OR,{visible:et.size>0,events:Et})]})]})},ez=()=>{const{user:t,profile:e,updateProfile:s,signOut:l,refreshProfile:f}=Vr(),{managedEntities:_,activeWorkspace:y,setActiveWorkspace:d}=mp(),[A,I]=Q.useState(!1),B=Fr(),N=sf(),V=!1,[K,se]=Q.useState([]),[ne,ve]=Q.useState([]),[re,ge]=Q.useState([]),[oe,me]=Q.useState([]),[ye,ke]=Q.useState([]),[Re,Ge]=Q.useState(!0),[He,Xe]=Q.useState(""),[at,et]=Q.useState("moments"),[Et,gt]=Q.useState(!1),[pt,$e]=Q.useState(e?.display_name||""),[ct,We]=Q.useState(e?.username||""),[Tt,lt]=Q.useState(e?.primary_city||""),[xe,Ce]=Q.useState(e?.bio||""),[st,ot]=Q.useState(e?.role||"user"),[_t,kt]=Q.useState(e?.external_links?.website||""),[It,ei]=Q.useState(e?.external_links?.instagram||""),[li,Gi]=Q.useState(e?.external_links?.spotify||""),[Mi,Di]=Q.useState(null),[Pn,hn]=Q.useState(""),[zn,it]=Q.useState(""),[Qn,qn]=Q.useState(""),[wi,fi]=Q.useState(""),[xn,Hn]=Q.useState(""),[es,Xi]=Q.useState(""),[Ki,Wi]=Q.useState(""),[gs,Ct]=Q.useState(""),[In,an]=Q.useState(""),[Tn,Zn]=Q.useState(""),[jt,ri]=Q.useState(""),[Jt,Bi]=Q.useState(!1),[jn,ci]=Q.useState(!1);Q.useEffect(()=>{I(!!y)},[y]),Q.useEffect(()=>{if(y){if(y.type==="artist"&&y.artist?.id){const ee=`/tabs/artist/${y.artist.id}`;N.pathname.startsWith(ee)||B.replace(ee)}else if(y.type==="venue"&&y.venue?.id){const ee=`/tabs/venue/${y.venue.id}`;N.pathname.startsWith(ee)||B.replace(ee)}}},[y,B,N.pathname]);const xs=A&&y?y.type==="user"?y.profile:null:e,Dn=Nt.useRef(""),$n=async(ee=!1)=>{if(!t?.id)return;const Le=`${t.id}-${A}-${y?.subject_id}`;if(!(!ee&&Dn.current===Le)){Ge(!0),Xe("");try{const Ue=`
        id,
        name,
        city,
        address,
        starts_at,
        cover_image_url,
        venue_place:venue_places!events_venue_place_id_fkey (
          id,
          name,
          city,
          address
        ),
        event_artists (
          artist:artists!event_artists_artist_entity_fk (
            id,
            name,
            avatar_url
          )
        )
      `,Oe=Le;let Ve=Pt.from("posts").select("id, media_url, media_type, caption, created_at, event_offset_ms, song_title");A&&y?Ve=Ve.eq("actor_subject_id",y.subject_id):Ve=Ve.eq("user_id",t.id);const[Bt,qt,Dt]=await Promise.all([Ve.order("created_at",{ascending:!1}).limit(12),Pt.from("event_saves").select(`events!inner (${Ue})`).eq("user_id",t.id),Pt.from("event_attendance").select(`status, events!inner (${Ue})`).eq("user_id",t.id)]);if(Dn.current!==Oe&&!ee)return;const At=Bt.data,ti=qt.data,pi=Dt.data;let ji=[],Qi=[];const gi=A&&y?y.type:e?.role;if(gi==="artist"){const Qe=A&&y?y.artist?.id:null;if(Qe){const{data:Ot}=await Pt.from("event_artists").select(`
                events!inner (
                  ${Ue}
                )
              `).eq("artist_entity_id",Qe);ji=(Ot||[]).map(ui=>ui.events).filter(ui=>!!ui)}}if(gi==="venue"){const Qe=A&&y?y.venue?.id:null;if(Qe){const{data:Ot}=await Pt.from("events").select(Ue).eq("venue_place_id",Qe).order("starts_at",{ascending:!1});Qi=Ot||[]}}if(Dn.current!==Oe&&!ee)return;se(At||[]);const qi=(ti||[]).map(Qe=>Qe.events).filter(Qe=>!!Qe),on=(pi||[]).map(Qe=>Qe.events).filter(Qe=>!!Qe);ve(qi),ge([...on,...ji]),me(ji),ke(Qi),Dn.current=Oe}catch{Xe("Could not load profile data. Check your Supabase connection.")}finally{Ge(!1)}}};Q.useEffect(()=>{t?.id&&$n()},[t?.id,e?.role,A,y?.subject_id]),Q.useEffect(()=>{$e(e?.display_name||""),We(e?.username||""),lt(e?.primary_city||""),Ce(e?.bio||""),ot(e?.role||"user"),kt(e?.external_links?.website||""),ei(e?.external_links?.instagram||""),Gi(e?.external_links?.spotify||"")},[e]);const Ji=_.find(ee=>ee.venue?.id===Mi)?.venue||null,be=Ji??_.find(ee=>ee.type==="venue")?.venue??null;Q.useEffect(()=>{if(!Ji){hn(""),it(""),qn(""),fi(""),Hn(""),Xi(""),Wi(""),Ct(""),an("");return}hn(Ji.name||""),it(Ji.city||""),qn(Ji.address||""),fi(Ji.website_url||""),Hn(Ji.capacity!==null?Ji.capacity.toString():""),Xi(Ji.venue_type||""),Wi(Ji.latitude!==null?Ji.latitude.toString():""),Ct(Ji.longitude!==null?Ji.longitude.toString():""),an((Ji.photos||[]).join(`
`))},[Ji]);const ie=ee=>{const Le=ee.trim();if(!Le)return null;const Ue=Number(Le);return Number.isNaN(Ue)?null:Ue},te=ee=>{const Le=ee.trim();if(!Le)return null;const Ue=Number(Le);return Number.isFinite(Ue)?Math.round(Ue):null},he=async()=>{ri(""),Zn(""),Bi(!0);const ee={...xs?.external_links||{}},Le=(Ve,Bt)=>{const qt=Bt.trim();qt?ee[Ve]=qt:delete ee[Ve]};Le("website",_t),Le("instagram",It),Le("spotify",li);const Ue={display_name:pt||null,username:ct||null,primary_city:Tt||null,bio:xe||null,external_links:ee};V&&(Ue.role=st);const{error:Oe}=await s(Ue);if(Oe){ri(Oe.message),Bi(!1);return}if(e?.role==="venue"&&t&&Mi){if(!Pn.trim()||!zn.trim()){ri("Venue name and city are required."),Bi(!1);return}const Ve=In.split(/\n|,/).map(qt=>qt.trim()).filter(Boolean),{error:Bt}=await Pt.from("venue_places").update({name:Pn.trim()||null,city:zn.trim()||Tt||"",address:Qn.trim()||null,website_url:wi.trim()||null,capacity:te(xn),venue_type:es.trim()||null,latitude:ie(Ki),longitude:ie(gs),photos:Ve}).eq("id",Mi);if(Bt){ri(Bt.message),Bi(!1);return}}await f(),await $n(),Zn("Profile updated."),gt(!1),Bi(!1)},we=async()=>{ri(""),Zn(""),ci(!0);try{await l(),B.replace("/welcome")}catch{ri("Sign out failed. Check your Supabase connection.")}finally{ci(!1)}},je=()=>e?.role==="artist"?"Concerts":e?.role==="venue"?"Events":"Attended",Ne=()=>e?.role==="artist"?j0:TS,Ze=()=>Re?S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})}):He?S.jsx("p",{className:"text-sm text-rose-400",children:He}):e?.role==="artist"&&at==="attended"?oe.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No shows here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Find a show"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:oe.map(ee=>S.jsx(Jl,{event:ee,className:"w-full",onSelect:Le=>B.push(`/event/${Le.id}`)},ee.id))}):e?.role==="venue"&&at==="attended"?ye.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No nights here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Explore nearby"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:ye.map(ee=>S.jsx(Jl,{event:ee,className:"w-full",onSelect:Le=>B.push(`/event/${Le.id}`)},ee.id))}):at==="liked"?ne.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"Nothing saved yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/discover"),children:"Discover concerts"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:ne.map(ee=>S.jsx(Jl,{event:ee,className:"w-full",onSelect:Le=>B.push(`/event/${Le.id}`)},ee.id))}):at==="attended"?re.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No nights here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Find a show"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:re.map(ee=>S.jsx(Jl,{event:ee,className:"w-full",onSelect:Le=>B.push(`/event/${Le.id}`)},ee.id))}):K.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"Your concert memories start after the show."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/events"),children:"Go to Main"})]}):S.jsx("div",{className:"grid grid-cols-3 gap-2",children:K.map(ee=>S.jsx("button",{type:"button",onClick:()=>B.push(`/post/${ee.id}`),className:"overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:ee.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:ee.media_url})}):S.jsx("img",{src:ee.media_url,alt:ee.caption||"Moment",className:"h-full w-full object-cover"})},ee.id))});return S.jsx(ao,{children:S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[!A&&S.jsxs("div",{className:"space-y-4 animate-fade-up motion-reduce:animate-none",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:S.jsx("img",{src:e?.avatar_url||`https://picsum.photos/seed/${e?.id}/120/120`,alt:"Profile avatar",className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"min-w-0 flex-1",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Profile"}),S.jsx("h2",{className:"mt-2 font-display text-2xl font-bold text-white line-clamp-1",children:e?.username?`@${e.username}`:e?.display_name||"You"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:e?.primary_city||""})]}),S.jsx("button",{type:"button",className:"px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>gt(ee=>!ee),children:"Edit"})]}),S.jsx("p",{className:"text-sm text-white/70",children:"Your concert memories live here."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/discover"),children:"Discover concerts"})]}),A&&S.jsxs("div",{className:"flex items-center gap-4 animate-fade-up motion-reduce:animate-none",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:S.jsx("img",{src:y?y.type==="artist"?y.artist?.avatar_url||`https://picsum.photos/seed/artist-${y.subject_id}/120/120`:y.venue?.photos?.[0]||`https://picsum.photos/seed/venue-${y.subject_id}/120/120`:e?.avatar_url||`https://picsum.photos/seed/${e?.id}/120/120`,alt:"Profile avatar",className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"flex-1",children:[S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:y?y.type==="artist"?y.artist?.name:y.venue?.name:e?.display_name||e?.username||"Your profile"}),S.jsx("p",{className:"text-sm text-white/55",children:y?y.type==="artist"?"Managed artist":"Managed venue":""})]}),S.jsxs("div",{className:"flex flex-col gap-2",children:[y?.type==="artist"&&y.artist?.id&&S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>B.push(`/tabs/artist/${y.artist.id||y.artist.artist_id}`),children:"View profile"}),y?.type==="venue"&&y.venue?.id&&S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>B.push(`/tabs/venue/${y.venue.id||y.venue.venue_place_id}`),children:"View profile"}),S.jsx("button",{type:"button",className:"px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>gt(ee=>!ee),children:"Edit"})]})]}),A&&_.length>1&&S.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 animate-fade-in",children:_.map(ee=>S.jsx("button",{type:"button",className:`flex-shrink-0 rounded-xl px-4 py-1.5 text-xs font-semibold transition ${y?.subject_id===ee.subject_id?"bg-white/10 text-app-accent":"bg-white/5 text-white/60 hover:bg-white/10 hover:text-white/80"}`,onClick:()=>d(ee),children:ee.type==="artist"?ee.artist?.name:ee.venue?.name},ee.subject_id))}),e?.role==="artist"&&(_t||It||li)&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artist links"}),S.jsxs("div",{className:"space-y-2 text-sm text-white/80",children:[_t&&S.jsx("a",{href:_t,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:_t.replace(/^https?:\/\//,"")}),It&&S.jsx("a",{href:It,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:It.replace(/^https?:\/\//,"")}),li&&S.jsx("a",{href:li,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:li.replace(/^https?:\/\//,"")})]})]}),e?.role==="venue"&&be&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue details"}),S.jsxs("div",{className:"space-y-2 text-sm text-white/80",children:[(be.address||e.primary_city)&&S.jsx("p",{children:be.address||e.primary_city}),be.website_url&&S.jsx("a",{href:be.website_url,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:be.website_url.replace(/^https?:\/\//,"")})]}),(be.photos??[]).length>0&&S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:(be.photos??[]).map((ee,Le)=>S.jsx("div",{className:"h-24 w-40 flex-shrink-0 overflow-hidden rounded-2xl bg-black/30",children:S.jsx("img",{src:ee,alt:"Venue",className:"h-full w-full object-cover"})},`${ee}-${Le}`))})]}),Et&&S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Display name"}),S.jsx("input",{value:pt,onChange:ee=>$e(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{value:ct,onChange:ee=>We(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Primary city"}),S.jsx("input",{value:Tt,onChange:ee=>lt(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Bio"}),S.jsx("textarea",{value:xe,onChange:ee=>Ce(ee.target.value),className:"min-h-[96px] w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),V&&S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Role (dev)"}),S.jsxs("select",{value:st,onChange:ee=>ot(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",children:[S.jsx("option",{value:"user",children:"User"}),S.jsx("option",{value:"artist",children:"Artist"}),S.jsx("option",{value:"venue",children:"Venue"}),S.jsx("option",{value:"label",children:"Label"})]}),S.jsx("span",{className:"text-xs text-white/60",children:"Solo para testing. En prod queda bloqueado."})]}),e?.role==="artist"&&S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artist links"}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Website"}),S.jsx("input",{value:_t,onChange:ee=>kt(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://your-site.com"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Instagram"}),S.jsx("input",{value:It,onChange:ee=>ei(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://instagram.com/you"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Spotify"}),S.jsx("input",{value:li,onChange:ee=>Gi(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://open.spotify.com/artist/..."})]})]}),e?.role==="venue"&&S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue management"}),_.filter(ee=>ee.type==="venue").length===0?S.jsx("p",{className:"text-sm text-white/60",children:"No managed venue place yet. Create or claim a venue to edit its details."}):S.jsxs(S.Fragment,{children:[_.filter(ee=>ee.type==="venue").length>1&&S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Managed venue"}),S.jsx("select",{value:Mi||"",onChange:ee=>Di(ee.target.value||null),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",children:_.filter(ee=>ee.type==="venue").map(ee=>S.jsx("option",{value:ee.venue?.id,children:ee.venue?.name},ee.venue?.id))})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue name"}),S.jsx("input",{value:Pn,onChange:ee=>hn(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Venue name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("input",{value:zn,onChange:ee=>it(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"City"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue type"}),S.jsx("input",{value:es,onChange:ee=>Xi(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Club, hall, theatre..."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Capacity"}),S.jsx("input",{value:xn,onChange:ee=>Hn(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"450"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Address"}),S.jsx("input",{value:Qn,onChange:ee=>qn(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Street address"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Website"}),S.jsx("input",{value:wi,onChange:ee=>fi(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://venue-site.com"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Latitude"}),S.jsx("input",{value:Ki,onChange:ee=>Wi(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Longitude"}),S.jsx("input",{value:gs,onChange:ee=>Ct(ee.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue photos (URLs)"}),S.jsx("textarea",{value:In,onChange:ee=>an(ee.target.value),className:"min-h-[96px] w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"One URL per line"})]})]})]}),jt&&S.jsx("p",{className:"text-sm text-rose-400",children:jt}),Tn&&S.jsx("p",{className:"text-sm text-emerald-400",children:Tn}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:he,disabled:Jt,children:Jt?"Saving...":"Save changes"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>gt(!1),children:"Cancel"})]}),S.jsxs("div",{className:"flex gap-2 animate-fade-up motion-reduce:animate-none",style:{animationDelay:"0.16s"},children:[S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${at==="moments"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>et("moments"),children:[S.jsx(j0,{className:"h-4 w-4"}),"Moments"]}),S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${at==="attended"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>et("attended"),children:[Nt.createElement(Ne(),{className:"h-4 w-4"}),je()]}),S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${at==="liked"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>et("liked"),children:[S.jsx(ES,{className:"h-4 w-4"}),"Liked"]})]}),S.jsx("div",{className:"animate-fade-up motion-reduce:animate-none",style:{animationDelay:"0.24s"},children:Ze()}),!Et&&jt&&S.jsx("p",{className:"text-sm text-rose-400",children:jt}),!Et&&Tn&&S.jsx("p",{className:"text-sm text-emerald-400",children:Tn}),S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:we,disabled:jn,children:[S.jsx(cI,{className:"h-4 w-4"}),jn?"Signing out...":"Log out"]})]})})};var My={exports:{}};var tz=My.exports,cw;function f2(){return cw||(cw=1,(function(t,e){(function(s,l){t.exports=l()})(tz,(function(){var s={},l={};function f(y,d,A){if(l[y]=A,y==="index"){var I="var sharedModule = {}; ("+l.shared+")(sharedModule); ("+l.worker+")(sharedModule);",B={};return l.shared(B),l.index(s,B),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([I],{type:"text/javascript"}))),s}}f("shared",["exports"],(function(y){function d(a,n,c,m){return new(c||(c=Promise))((function(x,k){function C(F){try{z(m.next(F))}catch(q){k(q)}}function j(F){try{z(m.throw(F))}catch(q){k(q)}}function z(F){var q;F.done?x(F.value):(q=F.value,q instanceof c?q:new c((function(G){G(q)}))).then(C,j)}z((m=m.apply(a,n||[])).next())}))}function A(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var I=B;function B(a,n){this.x=a,this.y=n}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,n){return this.clone()._rotateAround(a,n)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var n=a.x-this.x,c=a.y-this.y;return n*n+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,n){return Math.atan2(this.x*n-this.y*a,this.x*a+this.y*n)},_matMult:function(a){var n=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=n,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var n=Math.cos(a),c=Math.sin(a),m=c*this.x+n*this.y;return this.x=n*this.x-c*this.y,this.y=m,this},_rotateAround:function(a,n){var c=Math.cos(a),m=Math.sin(a),x=n.y+m*(this.x-n.x)+c*(this.y-n.y);return this.x=n.x+c*(this.x-n.x)-m*(this.y-n.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(a){return a instanceof B?a:Array.isArray(a)?new B(a[0],a[1]):a};var N=A(I),V=K;function K(a,n,c,m){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=n,this.p2x=c,this.p2y=m}K.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,n){if(n===void 0&&(n=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,m=0;m<8;m++){var x=this.sampleCurveX(c)-a;if(Math.abs(x)<n)return c;var k=this.sampleCurveDerivativeX(c);if(Math.abs(k)<1e-6)break;c-=x/k}var C=0,j=1;for(c=a,m=0;m<20&&(x=this.sampleCurveX(c),!(Math.abs(x-a)<n));m++)a>x?C=c:j=c,c=.5*(j-C)+C;return c},solve:function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))}};var se=A(V);let ne,ve;function re(){return ne==null&&(ne=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ne}function ge(){if(ve==null&&(ve=!1,re())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let m=0;m<25;m++){const x=4*m;n.fillStyle=`rgb(${x},${x+1},${x+2})`,n.fillRect(m%5,Math.floor(m/5),1,1)}const c=n.getImageData(0,0,5,5).data;for(let m=0;m<100;m++)if(m%4!=3&&c[m]!==m){ve=!0;break}}}return ve||!1}function oe(a,n,c,m){const x=new se(a,n,c,m);return k=>x.solve(k)}const me=oe(.25,.1,.25,1);function ye(a,n,c){return Math.min(c,Math.max(n,a))}function ke(a,n,c){const m=c-n,x=((a-n)%m+m)%m+n;return x===n?c:x}function Re(a,...n){for(const c of n)for(const m in c)a[m]=c[m];return a}let Ge=1;function He(a,n,c){const m={};for(const x in a)m[x]=n.call(this,a[x],x,a);return m}function Xe(a,n,c){const m={};for(const x in a)n.call(this,a[x],x,a)&&(m[x]=a[x]);return m}function at(a){return Array.isArray(a)?a.map(at):typeof a=="object"&&a?He(a,at):a}const et={};function Et(a){et[a]||(typeof console<"u"&&console.warn(a),et[a]=!0)}function gt(a,n,c){return(c.y-a.y)*(n.x-a.x)>(n.y-a.y)*(c.x-a.x)}function pt(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let $e=null;function ct(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Tt(a,n,c,m,x){return d(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const k=new VideoFrame(a,{timestamp:0});try{const C=k?.format;if(!C||!C.startsWith("BGR")&&!C.startsWith("RGB"))throw new Error(`Unrecognized format ${C}`);const j=C.startsWith("BGR"),z=new Uint8ClampedArray(m*x*4);if(yield k.copyTo(z,(function(F,q,G,J,ae){const ue=4*Math.max(-q,0),de=(Math.max(0,G)-G)*J*4+ue,Te=4*J,Me=Math.max(0,q),tt=Math.max(0,G);return{rect:{x:Me,y:tt,width:Math.min(F.width,q+J)-Me,height:Math.min(F.height,G+ae)-tt},layout:[{offset:de,stride:Te}]}})(a,n,c,m,x)),j)for(let F=0;F<z.length;F+=4){const q=z[F];z[F]=z[F+2],z[F+2]=q}return z}finally{k.close()}}))}let lt,xe;const Ce="AbortError";function st(){return new Error(Ce)}const ot={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function _t(a){return ot.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const kt="global-dispatcher";class It extends Error{constructor(n,c,m,x){super(`AJAXError: ${c} (${n}): ${m}`),this.status=n,this.statusText=c,this.url=m,this.body=x}}const ei=()=>pt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,li=function(a,n){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const m=_t(a.url);if(m)return m(a,n);if(pt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:kt},n)}if(!(/^file:/.test(c=a.url)||/^file:/.test(ei())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(m,x){return d(this,void 0,void 0,(function*(){const k=new Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,cache:m.cache,referrer:ei(),signal:x.signal});m.type!=="json"||k.headers.has("Accept")||k.headers.set("Accept","application/json");const C=yield fetch(k);if(!C.ok){const F=yield C.blob();throw new It(C.status,C.statusText,m.url,F)}let j;j=m.type==="arrayBuffer"||m.type==="image"?C.arrayBuffer():m.type==="json"?C.json():C.text();const z=yield j;if(x.signal.aborted)throw st();return{data:z,cacheControl:C.headers.get("Cache-Control"),expires:C.headers.get("Expires")}}))})(a,n);if(pt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:kt},n)}var c;return(function(m,x){return new Promise(((k,C)=>{var j;const z=new XMLHttpRequest;z.open(m.method||"GET",m.url,!0),m.type!=="arrayBuffer"&&m.type!=="image"||(z.responseType="arraybuffer");for(const F in m.headers)z.setRequestHeader(F,m.headers[F]);m.type==="json"&&(z.responseType="text",!((j=m.headers)===null||j===void 0)&&j.Accept||z.setRequestHeader("Accept","application/json")),z.withCredentials=m.credentials==="include",z.onerror=()=>{C(new Error(z.statusText))},z.onload=()=>{if(!x.signal.aborted)if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let F=z.response;if(m.type==="json")try{F=JSON.parse(z.response)}catch(q){return void C(q)}k({data:F,cacheControl:z.getResponseHeader("Cache-Control"),expires:z.getResponseHeader("Expires")})}else{const F=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});C(new It(z.status,z.statusText,m.url,F))}},x.signal.addEventListener("abort",(()=>{z.abort(),C(st())})),z.send(m.body)}))})(a,n)};function Gi(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const n=new URL(a),c=window.location;return n.protocol===c.protocol&&n.host===c.host}function Mi(a,n,c){c[a]&&c[a].indexOf(n)!==-1||(c[a]=c[a]||[],c[a].push(n))}function Di(a,n,c){if(c&&c[a]){const m=c[a].indexOf(n);m!==-1&&c[a].splice(m,1)}}class Pn{constructor(n,c={}){Re(this,c),this.type=n}}class hn extends Pn{constructor(n,c={}){super("error",Re({error:n},c))}}class zn{on(n,c){return this._listeners=this._listeners||{},Mi(n,c,this._listeners),this}off(n,c){return Di(n,c,this._listeners),Di(n,c,this._oneTimeListeners),this}once(n,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Mi(n,c,this._oneTimeListeners),this):new Promise((m=>this.once(n,m)))}fire(n,c){typeof n=="string"&&(n=new Pn(n,c||{}));const m=n.type;if(this.listens(m)){n.target=this;const x=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const j of x)j.call(this,n);const k=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const j of k)Di(m,j,this._oneTimeListeners),j.call(this,n);const C=this._eventedParent;C&&(Re(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(n))}else n instanceof hn&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,c){return this._eventedParent=n,this._eventedParentData=c,this}}var it={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Qn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function qn(a,n){const c={};for(const m in a)m!=="ref"&&(c[m]=a[m]);return Qn.forEach((m=>{m in n&&(c[m]=n[m])})),c}function wi(a,n){if(Array.isArray(a)){if(!Array.isArray(n)||a.length!==n.length)return!1;for(let c=0;c<a.length;c++)if(!wi(a[c],n[c]))return!1;return!0}if(typeof a=="object"&&a!==null&&n!==null){if(typeof n!="object"||Object.keys(a).length!==Object.keys(n).length)return!1;for(const c in a)if(!wi(a[c],n[c]))return!1;return!0}return a===n}function fi(a,n){a.push(n)}function xn(a,n,c){fi(c,{command:"addSource",args:[a,n[a]]})}function Hn(a,n,c){fi(n,{command:"removeSource",args:[a]}),c[a]=!0}function es(a,n,c,m){Hn(a,c,m),xn(a,n,c)}function Xi(a,n,c){let m;for(m in a[c])if(Object.prototype.hasOwnProperty.call(a[c],m)&&m!=="data"&&!wi(a[c][m],n[c][m]))return!1;for(m in n[c])if(Object.prototype.hasOwnProperty.call(n[c],m)&&m!=="data"&&!wi(a[c][m],n[c][m]))return!1;return!0}function Ki(a,n,c,m,x,k){a=a||{},n=n||{};for(const C in a)Object.prototype.hasOwnProperty.call(a,C)&&(wi(a[C],n[C])||c.push({command:k,args:[m,C,n[C],x]}));for(const C in n)Object.prototype.hasOwnProperty.call(n,C)&&!Object.prototype.hasOwnProperty.call(a,C)&&(wi(a[C],n[C])||c.push({command:k,args:[m,C,n[C],x]}))}function Wi(a){return a.id}function gs(a,n){return a[n.id]=n,a}class Ct{constructor(n,c,m,x){this.message=(n?`${n}: `:"")+m,x&&(this.identifier=x),c!=null&&c.__line__&&(this.line=c.__line__)}}function In(a,...n){for(const c of n)for(const m in c)a[m]=c[m];return a}class an extends Error{constructor(n,c){super(c),this.message=c,this.key=n}}class Tn{constructor(n,c=[]){this.parent=n,this.bindings={};for(const[m,x]of c)this.bindings[m]=x}concat(n){return new Tn(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Zn={kind:"null"},jt={kind:"number"},ri={kind:"string"},Jt={kind:"boolean"},Bi={kind:"color"},jn={kind:"object"},ci={kind:"value"},xs={kind:"collator"},Dn={kind:"formatted"},$n={kind:"padding"},Ji={kind:"resolvedImage"},be={kind:"variableAnchorOffsetCollection"};function ie(a,n){return{kind:"array",itemType:a,N:n}}function te(a){if(a.kind==="array"){const n=te(a.itemType);return typeof a.N=="number"?`array<${n}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${n}>`}return a.kind}const he=[Zn,jt,ri,Jt,Bi,Dn,jn,ie(ci),$n,Ji,be];function we(a,n){if(n.kind==="error")return null;if(a.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!we(a.itemType,n.itemType))&&(typeof a.N!="number"||a.N===n.N))return null}else{if(a.kind===n.kind)return null;if(a.kind==="value"){for(const c of he)if(!we(c,n))return null}}return`Expected ${te(a)} but found ${te(n)} instead.`}function je(a,n){return n.some((c=>c.kind===a.kind))}function Ne(a,n){return n.some((c=>c==="null"?a===null:c==="array"?Array.isArray(a):c==="object"?a&&!Array.isArray(a)&&typeof a=="object":c===typeof a))}function Ze(a,n){return a.kind==="array"&&n.kind==="array"?a.itemType.kind===n.itemType.kind&&typeof a.N=="number":a.kind===n.kind}const ee=.96422,Le=.82521,Ue=4/29,Oe=6/29,Ve=3*Oe*Oe,Bt=Oe*Oe*Oe,qt=Math.PI/180,Dt=180/Math.PI;function At(a){return(a%=360)<0&&(a+=360),a}function ti([a,n,c,m]){let x,k;const C=ji((.2225045*(a=pi(a))+.7168786*(n=pi(n))+.0606169*(c=pi(c)))/1);a===n&&n===c?x=k=C:(x=ji((.4360747*a+.3850649*n+.1430804*c)/ee),k=ji((.0139322*a+.0971045*n+.7141733*c)/Le));const j=116*C-16;return[j<0?0:j,500*(x-C),200*(C-k),m]}function pi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function ji(a){return a>Bt?Math.pow(a,1/3):a/Ve+Ue}function Qi([a,n,c,m]){let x=(a+16)/116,k=isNaN(n)?x:x+n/500,C=isNaN(c)?x:x-c/200;return x=1*qi(x),k=ee*qi(k),C=Le*qi(C),[gi(3.1338561*k-1.6168667*x-.4906146*C),gi(-.9787684*k+1.9161415*x+.033454*C),gi(.0719453*k-.2289914*x+1.4052427*C),m]}function gi(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function qi(a){return a>Oe?a*a*a:Ve*(a-Ue)}function on(a){return parseInt(a.padEnd(2,a),16)/255}function Qe(a,n){return Ot(n?a/100:a,0,1)}function Ot(a,n,c){return Math.min(Math.max(n,a),c)}function ui(a){return!a.some(Number.isNaN)}const ln={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class ut{constructor(n,c,m,x=1,k=!0){this.r=n,this.g=c,this.b=m,this.a=x,k||(this.r*=x,this.g*=x,this.b*=x,x||this.overwriteGetter("rgb",[n,c,m,x]))}static parse(n){if(n instanceof ut)return n;if(typeof n!="string")return;const c=(function(m){if((m=m.toLowerCase().trim())==="transparent")return[0,0,0,0];const x=ln[m];if(x){const[C,j,z]=x;return[C/255,j/255,z/255,1]}if(m.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(m)){const C=m.length<6?1:2;let j=1;return[on(m.slice(j,j+=C)),on(m.slice(j,j+=C)),on(m.slice(j,j+=C)),on(m.slice(j,j+C)||"ff")]}if(m.startsWith("rgb")){const C=m.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[j,z,F,q,G,J,ae,ue,de,Te,Me,tt]=C,Be=[q||" ",ae||" ",Te].join("");if(Be==="  "||Be==="  /"||Be===",,"||Be===",,,"){const Ke=[F,J,de].join(""),yt=Ke==="%%%"?100:Ke===""?255:0;if(yt){const zt=[Ot(+z/yt,0,1),Ot(+G/yt,0,1),Ot(+ue/yt,0,1),Me?Qe(+Me,tt):1];if(ui(zt))return zt}}return}}const k=m.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[C,j,z,F,q,G,J,ae,ue]=k,de=[z||" ",q||" ",J].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const Te=[+j,Ot(+F,0,100),Ot(+G,0,100),ae?Qe(+ae,ue):1];if(ui(Te))return(function([Me,tt,Be,Ke]){function yt(zt){const Kt=(zt+Me/30)%12,bi=tt*Math.min(Be,1-Be);return Be-bi*Math.max(-1,Math.min(Kt-3,9-Kt,1))}return Me=At(Me),tt/=100,Be/=100,[yt(0),yt(8),yt(4),Ke]})(Te)}}})(n);return c?new ut(...c,!1):void 0}get rgb(){const{r:n,g:c,b:m,a:x}=this,k=x||1/0;return this.overwriteGetter("rgb",[n/k,c/k,m/k,x])}get hcl(){return this.overwriteGetter("hcl",(function(n){const[c,m,x,k]=ti(n),C=Math.sqrt(m*m+x*x);return[Math.round(1e4*C)?At(Math.atan2(x,m)*Dt):NaN,C,c,k]})(this.rgb))}get lab(){return this.overwriteGetter("lab",ti(this.rgb))}overwriteGetter(n,c){return Object.defineProperty(this,n,{value:c}),c}toString(){const[n,c,m,x]=this.rgb;return`rgba(${[n,c,m].map((k=>Math.round(255*k))).join(",")},${x})`}}ut.black=new ut(0,0,0,1),ut.white=new ut(1,1,1,1),ut.transparent=new ut(0,0,0,0),ut.red=new ut(1,0,0,1);class Ft{constructor(n,c,m){this.sensitivity=n?c?"variant":"case":c?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,c){return this.collator.compare(n,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ti{constructor(n,c,m,x,k){this.text=n,this.image=c,this.scale=m,this.fontStack=x,this.textColor=k}}class en{constructor(n){this.sections=n}static fromString(n){return new en([new Ti(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((n=>n.text.length!==0||n.image&&n.image.name.length!==0))}static factory(n){return n instanceof en?n:en.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map((n=>n.text)).join("")}}class Li{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Li)return n;if(typeof n=="number")return new Li([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const c of n)if(typeof c!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Li(n)}}toString(){return JSON.stringify(this.values)}}const vr=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class On{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof On)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let c=0;c<n.length;c+=2){const m=n[c],x=n[c+1];if(typeof m!="string"||!vr.has(m)||!Array.isArray(x)||x.length!==2||typeof x[0]!="number"||typeof x[1]!="number")return}return new On(n)}}toString(){return JSON.stringify(this.values)}}class Is{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Is({name:n,available:!1}):null}}function Ir(a,n,c,m){return typeof a=="number"&&a>=0&&a<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof c=="number"&&c>=0&&c<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[a,n,c,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[a,n,c,m]:[a,n,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function rr(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof ut||a instanceof Ft||a instanceof en||a instanceof Li||a instanceof On||a instanceof Is)return!0;if(Array.isArray(a)){for(const n of a)if(!rr(n))return!1;return!0}if(typeof a=="object"){for(const n in a)if(!rr(a[n]))return!1;return!0}return!1}function yi(a){if(a===null)return Zn;if(typeof a=="string")return ri;if(typeof a=="boolean")return Jt;if(typeof a=="number")return jt;if(a instanceof ut)return Bi;if(a instanceof Ft)return xs;if(a instanceof en)return Dn;if(a instanceof Li)return $n;if(a instanceof On)return be;if(a instanceof Is)return Ji;if(Array.isArray(a)){const n=a.length;let c;for(const m of a){const x=yi(m);if(c){if(c===x)continue;c=ci;break}c=x}return ie(c||ci,n)}return jn}function An(a){const n=typeof a;return a===null?"":n==="string"||n==="number"||n==="boolean"?String(a):a instanceof ut||a instanceof en||a instanceof Li||a instanceof On||a instanceof Is?a.toString():JSON.stringify(a)}class bs{constructor(n,c){this.type=n,this.value=c}static parse(n,c){if(n.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!rr(n[1]))return c.error("invalid value");const m=n[1];let x=yi(m);const k=c.expectedType;return x.kind!=="array"||x.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(x=k),new bs(x,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class pn{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Na={string:ri,number:jt,boolean:Jt,object:jn};class qr{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");let m,x=1;const k=n[0];if(k==="array"){let j,z;if(n.length>2){const F=n[1];if(typeof F!="string"||!(F in Na)||F==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);j=Na[F],x++}else j=ci;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return c.error('The length argument to "array" must be a positive integer literal',2);z=n[2],x++}m=ie(j,z)}else{if(!Na[k])throw new Error(`Types doesn't contain name = ${k}`);m=Na[k]}const C=[];for(;x<n.length;x++){const j=c.parse(n[x],x,ci);if(!j)return null;C.push(j)}return new qr(m,C)}evaluate(n){for(let c=0;c<this.args.length;c++){const m=this.args[c].evaluate(n);if(!we(this.type,yi(m)))return m;if(c===this.args.length-1)throw new pn(`Expected value to be of type ${te(this.type)}, but found ${te(yi(m))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const $i={"to-boolean":Jt,"to-color":Bi,"to-number":jt,"to-string":ri};class Ln{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");const m=n[0];if(!$i[m])throw new Error(`Can't parse ${m} as it is not part of the known types`);if((m==="to-boolean"||m==="to-string")&&n.length!==2)return c.error("Expected one argument.");const x=$i[m],k=[];for(let C=1;C<n.length;C++){const j=c.parse(n[C],C,ci);if(!j)return null;k.push(j)}return new Ln(x,k)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let c,m;for(const x of this.args){if(c=x.evaluate(n),m=null,c instanceof ut)return c;if(typeof c=="string"){const k=n.parseColor(c);if(k)return k}else if(Array.isArray(c)&&(m=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Ir(c[0],c[1],c[2],c[3]),!m))return new ut(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new pn(m||`Could not parse color from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"padding":{let c;for(const m of this.args){c=m.evaluate(n);const x=Li.parse(c);if(x)return x}throw new pn(`Could not parse padding from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"variableAnchorOffsetCollection":{let c;for(const m of this.args){c=m.evaluate(n);const x=On.parse(c);if(x)return x}throw new pn(`Could not parse variableAnchorOffsetCollection from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"number":{let c=null;for(const m of this.args){if(c=m.evaluate(n),c===null)return 0;const x=Number(c);if(!isNaN(x))return x}throw new pn(`Could not convert ${JSON.stringify(c)} to number.`)}case"formatted":return en.fromString(An(this.args[0].evaluate(n)));case"resolvedImage":return Is.fromString(An(this.args[0].evaluate(n)));default:return An(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const Pl=["Unknown","Point","LineString","Polygon"];class Wo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Pl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let c=this._parseColorCache[n];return c||(c=this._parseColorCache[n]=ut.parse(n)),c}}class Un{constructor(n,c,m=[],x,k=new Tn,C=[]){this.registry=n,this.path=m,this.key=m.map((j=>`[${j}]`)).join(""),this.scope=k,this.errors=C,this.expectedType=x,this._isConstant=c}parse(n,c,m,x,k={}){return c?this.concat(c,m,x)._parse(n,k):this._parse(n,k)}_parse(n,c){function m(x,k,C){return C==="assert"?new qr(k,[x]):C==="coerce"?new Ln(k,[x]):x}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const x=n[0];if(typeof x!="string")return this.error(`Expression name must be a string, but found ${typeof x} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[x];if(k){let C=k.parse(n,this);if(!C)return null;if(this.expectedType){const j=this.expectedType,z=C.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||z.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||z.kind!=="value"&&z.kind!=="string")if(j.kind!=="padding"||z.kind!=="value"&&z.kind!=="number"&&z.kind!=="array")if(j.kind!=="variableAnchorOffsetCollection"||z.kind!=="value"&&z.kind!=="array"){if(this.checkSubtype(j,z))return null}else C=m(C,j,c.typeAnnotation||"coerce");else C=m(C,j,c.typeAnnotation||"coerce");else C=m(C,j,c.typeAnnotation||"coerce");else C=m(C,j,c.typeAnnotation||"assert")}if(!(C instanceof bs)&&C.type.kind!=="resolvedImage"&&this._isConstant(C)){const j=new Wo;try{C=new bs(C.type,C.evaluate(j))}catch(z){return this.error(z.message),null}}return C}return this.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,c,m){const x=typeof n=="number"?this.path.concat(n):this.path,k=m?this.scope.concat(m):this.scope;return new Un(this.registry,this._isConstant,x,c||null,k,this.errors)}error(n,...c){const m=`${this.key}${c.map((x=>`[${x}]`)).join("")}`;this.errors.push(new an(m,n))}checkSubtype(n,c){const m=we(n,c);return m&&this.error(m),m}}class Ba{constructor(n,c){this.type=c.type,this.bindings=[].concat(n),this.result=c}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const c of this.bindings)n(c[1]);n(this.result)}static parse(n,c){if(n.length<4)return c.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const m=[];for(let k=1;k<n.length-1;k+=2){const C=n[k];if(typeof C!="string")return c.error(`Expected string, but found ${typeof C} instead.`,k);if(/[^a-zA-Z0-9_]/.test(C))return c.error("Variable names must contain only alphanumeric characters or '_'.",k);const j=c.parse(n[k+1],k+1);if(!j)return null;m.push([C,j])}const x=c.parse(n[n.length-1],n.length-1,c.expectedType,m);return x?new Ba(m,x):null}outputDefined(){return this.result.outputDefined()}}class mn{constructor(n,c){this.type=c.type,this.name=n,this.boundExpression=c}static parse(n,c){if(n.length!==2||typeof n[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const m=n[1];return c.scope.has(m)?new mn(m,c.scope.get(m)):c.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class wa{constructor(n,c,m){this.type=n,this.index=c,this.input=m}static parse(n,c){if(n.length!==3)return c.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,jt),x=c.parse(n[2],2,ie(c.expectedType||ci));return m&&x?new wa(x.type.itemType,m,x):null}evaluate(n){const c=this.index.evaluate(n),m=this.input.evaluate(n);if(c<0)throw new pn(`Array index out of bounds: ${c} < 0.`);if(c>=m.length)throw new pn(`Array index out of bounds: ${c} > ${m.length-1}.`);if(c!==Math.floor(c))throw new pn(`Array index must be an integer, but found ${c} instead.`);return m[c]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Xn{constructor(n,c){this.type=Jt,this.needle=n,this.haystack=c}static parse(n,c){if(n.length!==3)return c.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,ci),x=c.parse(n[2],2,ci);return m&&x?je(m.type,[Jt,ri,jt,Zn,ci])?new Xn(m,x):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(m.type)} instead`):null}evaluate(n){const c=this.needle.evaluate(n),m=this.haystack.evaluate(n);if(!m)return!1;if(!Ne(c,["boolean","string","number","null"]))throw new pn(`Expected first argument to be of type boolean, string, number or null, but found ${te(yi(c))} instead.`);if(!Ne(m,["string","array"]))throw new pn(`Expected second argument to be of type array or string, but found ${te(yi(m))} instead.`);return m.indexOf(c)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Hr{constructor(n,c,m){this.type=jt,this.needle=n,this.haystack=c,this.fromIndex=m}static parse(n,c){if(n.length<=2||n.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,ci),x=c.parse(n[2],2,ci);if(!m||!x)return null;if(!je(m.type,[Jt,ri,jt,Zn,ci]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(m.type)} instead`);if(n.length===4){const k=c.parse(n[3],3,jt);return k?new Hr(m,x,k):null}return new Hr(m,x)}evaluate(n){const c=this.needle.evaluate(n),m=this.haystack.evaluate(n);if(!Ne(c,["boolean","string","number","null"]))throw new pn(`Expected first argument to be of type boolean, string, number or null, but found ${te(yi(c))} instead.`);let x;if(this.fromIndex&&(x=this.fromIndex.evaluate(n)),Ne(m,["string"])){const k=m.indexOf(c,x);return k===-1?-1:[...m.slice(0,k)].length}if(Ne(m,["array"]))return m.indexOf(c,x);throw new pn(`Expected second argument to be of type array or string, but found ${te(yi(m))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Co{constructor(n,c,m,x,k,C){this.inputType=n,this.type=c,this.input=m,this.cases=x,this.outputs=k,this.otherwise=C}static parse(n,c){if(n.length<5)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return c.error("Expected an even number of arguments.");let m,x;c.expectedType&&c.expectedType.kind!=="value"&&(x=c.expectedType);const k={},C=[];for(let F=2;F<n.length-1;F+=2){let q=n[F];const G=n[F+1];Array.isArray(q)||(q=[q]);const J=c.concat(F);if(q.length===0)return J.error("Expected at least one branch label.");for(const ue of q){if(typeof ue!="number"&&typeof ue!="string")return J.error("Branch labels must be numbers or strings.");if(typeof ue=="number"&&Math.abs(ue)>Number.MAX_SAFE_INTEGER)return J.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ue=="number"&&Math.floor(ue)!==ue)return J.error("Numeric branch labels must be integer values.");if(m){if(J.checkSubtype(m,yi(ue)))return null}else m=yi(ue);if(k[String(ue)]!==void 0)return J.error("Branch labels must be unique.");k[String(ue)]=C.length}const ae=c.parse(G,F,x);if(!ae)return null;x=x||ae.type,C.push(ae)}const j=c.parse(n[1],1,ci);if(!j)return null;const z=c.parse(n[n.length-1],n.length-1,x);return z?j.type.kind!=="value"&&c.concat(1).checkSubtype(m,j.type)?null:new Co(m,x,j,k,C,z):null}evaluate(n){const c=this.input.evaluate(n);return(yi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))&&this.otherwise.outputDefined()}}class Zr{constructor(n,c,m){this.type=n,this.branches=c,this.otherwise=m}static parse(n,c){if(n.length<4)return c.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return c.error("Expected an odd number of arguments.");let m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const x=[];for(let C=1;C<n.length-1;C+=2){const j=c.parse(n[C],C,Jt);if(!j)return null;const z=c.parse(n[C+1],C+1,m);if(!z)return null;x.push([j,z]),m=m||z.type}const k=c.parse(n[n.length-1],n.length-1,m);if(!k)return null;if(!m)throw new Error("Can't infer output type");return new Zr(m,x,k)}evaluate(n){for(const[c,m]of this.branches)if(c.evaluate(n))return m.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[c,m]of this.branches)n(c),n(m);n(this.otherwise)}outputDefined(){return this.branches.every((([n,c])=>c.outputDefined()))&&this.otherwise.outputDefined()}}class Yo{constructor(n,c,m,x){this.type=n,this.input=c,this.beginIndex=m,this.endIndex=x}static parse(n,c){if(n.length<=2||n.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,ci),x=c.parse(n[2],2,jt);if(!m||!x)return null;if(!je(m.type,[ie(ci),ri,ci]))return c.error(`Expected first argument to be of type array or string, but found ${te(m.type)} instead`);if(n.length===4){const k=c.parse(n[3],3,jt);return k?new Yo(m.type,m,x,k):null}return new Yo(m.type,m,x)}evaluate(n){const c=this.input.evaluate(n),m=this.beginIndex.evaluate(n);let x;if(this.endIndex&&(x=this.endIndex.evaluate(n)),Ne(c,["string"]))return[...c].slice(m,x).join("");if(Ne(c,["array"]))return c.slice(m,x);throw new pn(`Expected first argument to be of type array or string, but found ${te(yi(c))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function oo(a,n){const c=a.length-1;let m,x,k=0,C=c,j=0;for(;k<=C;)if(j=Math.floor((k+C)/2),m=a[j],x=a[j+1],m<=n){if(j===c||n<x)return j;k=j+1}else{if(!(m>n))throw new pn("Input is not a number.");C=j-1}return 0}class lo{constructor(n,c,m){this.type=n,this.input=c,this.labels=[],this.outputs=[];for(const[x,k]of m)this.labels.push(x),this.outputs.push(k)}static parse(n,c){if(n.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return c.error("Expected an even number of arguments.");const m=c.parse(n[1],1,jt);if(!m)return null;const x=[];let k=null;c.expectedType&&c.expectedType.kind!=="value"&&(k=c.expectedType);for(let C=1;C<n.length;C+=2){const j=C===1?-1/0:n[C],z=n[C+1],F=C,q=C+1;if(typeof j!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(x.length&&x[x.length-1][0]>=j)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const G=c.parse(z,q,k);if(!G)return null;k=k||G.type,x.push([j,G])}return new lo(k,m,x)}evaluate(n){const c=this.labels,m=this.outputs;if(c.length===1)return m[0].evaluate(n);const x=this.input.evaluate(n);if(x<=c[0])return m[0].evaluate(n);const k=c.length;return x>=c[k-1]?m[k-1].evaluate(n):m[oo(c,x)].evaluate(n)}eachChild(n){n(this.input);for(const c of this.outputs)n(c)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function Il(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ic=jc;function jc(a,n,c,m){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=n,this.p2x=c,this.p2y=m}jc.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,n){if(n===void 0&&(n=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,m=0;m<8;m++){var x=this.sampleCurveX(c)-a;if(Math.abs(x)<n)return c;var k=this.sampleCurveDerivativeX(c);if(Math.abs(k)<1e-6)break;c-=x/k}var C=0,j=1;for(c=a,m=0;m<20&&(x=this.sampleCurveX(c),!(Math.abs(x-a)<n));m++)a>x?C=c:j=c,c=.5*(j-C)+C;return c},solve:function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))}};var jl=Il(Ic);function qs(a,n,c){return a+c*(n-a)}function Ao(a,n,c){return a.map(((m,x)=>qs(m,n[x],c)))}const Hs={number:qs,color:function(a,n,c,m="rgb"){switch(m){case"rgb":{const[x,k,C,j]=Ao(a.rgb,n.rgb,c);return new ut(x,k,C,j,!1)}case"hcl":{const[x,k,C,j]=a.hcl,[z,F,q,G]=n.hcl;let J,ae;if(isNaN(x)||isNaN(z))isNaN(x)?isNaN(z)?J=NaN:(J=z,C!==1&&C!==0||(ae=F)):(J=x,q!==1&&q!==0||(ae=k));else{let tt=z-x;z>x&&tt>180?tt-=360:z<x&&x-z>180&&(tt+=360),J=x+c*tt}const[ue,de,Te,Me]=(function([tt,Be,Ke,yt]){return tt=isNaN(tt)?0:tt*qt,Qi([Ke,Math.cos(tt)*Be,Math.sin(tt)*Be,yt])})([J,ae??qs(k,F,c),qs(C,q,c),qs(j,G,c)]);return new ut(ue,de,Te,Me,!1)}case"lab":{const[x,k,C,j]=Qi(Ao(a.lab,n.lab,c));return new ut(x,k,C,j,!1)}}},array:Ao,padding:function(a,n,c){return new Li(Ao(a.values,n.values,c))},variableAnchorOffsetCollection:function(a,n,c){const m=a.values,x=n.values;if(m.length!==x.length)throw new pn(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${n.toString()}`);const k=[];for(let C=0;C<m.length;C+=2){if(m[C]!==x[C])throw new pn(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${m[C]}, to[${C}]: ${x[C]}`);k.push(m[C]);const[j,z]=m[C+1],[F,q]=x[C+1];k.push([qs(j,F,c),qs(z,q,c)])}return new On(k)}};class Bs{constructor(n,c,m,x,k){this.type=n,this.operator=c,this.interpolation=m,this.input=x,this.labels=[],this.outputs=[];for(const[C,j]of k)this.labels.push(C),this.outputs.push(j)}static interpolationFactor(n,c,m,x){let k=0;if(n.name==="exponential")k=Ii(c,n.base,m,x);else if(n.name==="linear")k=Ii(c,1,m,x);else if(n.name==="cubic-bezier"){const C=n.controlPoints;k=new jl(C[0],C[1],C[2],C[3]).solve(Ii(c,1,m,x))}return k}static parse(n,c){let[m,x,k,...C]=n;if(!Array.isArray(x)||x.length===0)return c.error("Expected an interpolation type expression.",1);if(x[0]==="linear")x={name:"linear"};else if(x[0]==="exponential"){const F=x[1];if(typeof F!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);x={name:"exponential",base:F}}else{if(x[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(x[0])}`,1,0);{const F=x.slice(1);if(F.length!==4||F.some((q=>typeof q!="number"||q<0||q>1)))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);x={name:"cubic-bezier",controlPoints:F}}}if(n.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(k=c.parse(k,2,jt),!k)return null;const j=[];let z=null;m==="interpolate-hcl"||m==="interpolate-lab"?z=Bi:c.expectedType&&c.expectedType.kind!=="value"&&(z=c.expectedType);for(let F=0;F<C.length;F+=2){const q=C[F],G=C[F+1],J=F+3,ae=F+4;if(typeof q!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',J);if(j.length&&j[j.length-1][0]>=q)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',J);const ue=c.parse(G,ae,z);if(!ue)return null;z=z||ue.type,j.push([q,ue])}return Ze(z,jt)||Ze(z,Bi)||Ze(z,$n)||Ze(z,be)||Ze(z,ie(jt))?new Bs(z,m,x,k,j):c.error(`Type ${te(z)} is not interpolatable.`)}evaluate(n){const c=this.labels,m=this.outputs;if(c.length===1)return m[0].evaluate(n);const x=this.input.evaluate(n);if(x<=c[0])return m[0].evaluate(n);const k=c.length;if(x>=c[k-1])return m[k-1].evaluate(n);const C=oo(c,x),j=Bs.interpolationFactor(this.interpolation,x,c[C],c[C+1]),z=m[C].evaluate(n),F=m[C+1].evaluate(n);switch(this.operator){case"interpolate":return Hs[this.type.kind](z,F,j);case"interpolate-hcl":return Hs.color(z,F,j,"hcl");case"interpolate-lab":return Hs.color(z,F,j,"lab")}}eachChild(n){n(this.input);for(const c of this.outputs)n(c)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function Ii(a,n,c,m){const x=m-c,k=a-c;return x===0?0:n===1?k/x:(Math.pow(n,k)-1)/(Math.pow(n,x)-1)}class jr{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expectected at least one argument.");let m=null;const x=c.expectedType;x&&x.kind!=="value"&&(m=x);const k=[];for(const j of n.slice(1)){const z=c.parse(j,1+k.length,m,void 0,{typeAnnotation:"omit"});if(!z)return null;m=m||z.type,k.push(z)}if(!m)throw new Error("No output type");const C=x&&k.some((j=>we(x,j.type)));return new jr(C?ci:m,k)}evaluate(n){let c,m=null,x=0;for(const k of this.args)if(x++,m=k.evaluate(n),m&&m instanceof Is&&!m.available&&(c||(c=m.name),m=null,x===this.args.length&&(m=c)),m!==null)break;return m}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}function Rn(a,n){return a==="=="||a==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Lc(a,n,c,m){return m.compare(n,c)===0}function aa(a,n,c){const m=a!=="=="&&a!=="!=";return class d2{constructor(k,C,j){this.type=Jt,this.lhs=k,this.rhs=C,this.collator=j,this.hasUntypedArgument=k.type.kind==="value"||C.type.kind==="value"}static parse(k,C){if(k.length!==3&&k.length!==4)return C.error("Expected two or three arguments.");const j=k[0];let z=C.parse(k[1],1,ci);if(!z)return null;if(!Rn(j,z.type))return C.concat(1).error(`"${j}" comparisons are not supported for type '${te(z.type)}'.`);let F=C.parse(k[2],2,ci);if(!F)return null;if(!Rn(j,F.type))return C.concat(2).error(`"${j}" comparisons are not supported for type '${te(F.type)}'.`);if(z.type.kind!==F.type.kind&&z.type.kind!=="value"&&F.type.kind!=="value")return C.error(`Cannot compare types '${te(z.type)}' and '${te(F.type)}'.`);m&&(z.type.kind==="value"&&F.type.kind!=="value"?z=new qr(F.type,[z]):z.type.kind!=="value"&&F.type.kind==="value"&&(F=new qr(z.type,[F])));let q=null;if(k.length===4){if(z.type.kind!=="string"&&F.type.kind!=="string"&&z.type.kind!=="value"&&F.type.kind!=="value")return C.error("Cannot use collator to compare non-string types.");if(q=C.parse(k[3],3,xs),!q)return null}return new d2(z,F,q)}evaluate(k){const C=this.lhs.evaluate(k),j=this.rhs.evaluate(k);if(m&&this.hasUntypedArgument){const z=yi(C),F=yi(j);if(z.kind!==F.kind||z.kind!=="string"&&z.kind!=="number")throw new pn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${z.kind}, ${F.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const z=yi(C),F=yi(j);if(z.kind!=="string"||F.kind!=="string")return n(k,C,j)}return this.collator?c(k,C,j,this.collator.evaluate(k)):n(k,C,j)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const Sa=aa("==",(function(a,n,c){return n===c}),Lc),Ll=aa("!=",(function(a,n,c){return n!==c}),(function(a,n,c,m){return!Lc(0,n,c,m)})),oa=aa("<",(function(a,n,c){return n<c}),(function(a,n,c,m){return m.compare(n,c)<0})),$a=aa(">",(function(a,n,c){return n>c}),(function(a,n,c,m){return m.compare(n,c)>0})),Xo=aa("<=",(function(a,n,c){return n<=c}),(function(a,n,c,m){return m.compare(n,c)<=0})),Ts=aa(">=",(function(a,n,c){return n>=c}),(function(a,n,c,m){return m.compare(n,c)>=0}));class la{constructor(n,c,m){this.type=xs,this.locale=m,this.caseSensitive=n,this.diacriticSensitive=c}static parse(n,c){if(n.length!==2)return c.error("Expected one argument.");const m=n[1];if(typeof m!="object"||Array.isArray(m))return c.error("Collator options argument must be an object.");const x=c.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,Jt);if(!x)return null;const k=c.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,Jt);if(!k)return null;let C=null;return m.locale&&(C=c.parse(m.locale,1,ri),!C)?null:new la(x,k,C)}evaluate(n){return new Ft(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Ko{constructor(n,c,m,x,k){this.type=ri,this.number=n,this.locale=c,this.currency=m,this.minFractionDigits=x,this.maxFractionDigits=k}static parse(n,c){if(n.length!==3)return c.error("Expected two arguments.");const m=c.parse(n[1],1,jt);if(!m)return null;const x=n[2];if(typeof x!="object"||Array.isArray(x))return c.error("NumberFormat options argument must be an object.");let k=null;if(x.locale&&(k=c.parse(x.locale,1,ri),!k))return null;let C=null;if(x.currency&&(C=c.parse(x.currency,1,ri),!C))return null;let j=null;if(x["min-fraction-digits"]&&(j=c.parse(x["min-fraction-digits"],1,jt),!j))return null;let z=null;return x["max-fraction-digits"]&&(z=c.parse(x["max-fraction-digits"],1,jt),!z)?null:new Ko(m,k,C,j,z)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Mo{constructor(n){this.type=Dn,this.sections=n}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");const m=n[1];if(!Array.isArray(m)&&typeof m=="object")return c.error("First argument must be an image or text section.");const x=[];let k=!1;for(let C=1;C<=n.length-1;++C){const j=n[C];if(k&&typeof j=="object"&&!Array.isArray(j)){k=!1;let z=null;if(j["font-scale"]&&(z=c.parse(j["font-scale"],1,jt),!z))return null;let F=null;if(j["text-font"]&&(F=c.parse(j["text-font"],1,ie(ri)),!F))return null;let q=null;if(j["text-color"]&&(q=c.parse(j["text-color"],1,Bi),!q))return null;const G=x[x.length-1];G.scale=z,G.font=F,G.textColor=q}else{const z=c.parse(n[C],1,ci);if(!z)return null;const F=z.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,x.push({content:z,scale:null,font:null,textColor:null})}}return new Mo(x)}evaluate(n){return new en(this.sections.map((c=>{const m=c.content.evaluate(n);return yi(m)===Ji?new Ti("",m,null,null,null):new Ti(An(m),null,c.scale?c.scale.evaluate(n):null,c.font?c.font.evaluate(n).join(","):null,c.textColor?c.textColor.evaluate(n):null)})))}eachChild(n){for(const c of this.sections)n(c.content),c.scale&&n(c.scale),c.font&&n(c.font),c.textColor&&n(c.textColor)}outputDefined(){return!1}}class Rc{constructor(n){this.type=Ji,this.input=n}static parse(n,c){if(n.length!==2)return c.error("Expected two arguments.");const m=c.parse(n[1],1,ri);return m?new Rc(m):c.error("No image name provided.")}evaluate(n){const c=this.input.evaluate(n),m=Is.fromString(c);return m&&n.availableImages&&(m.available=n.availableImages.indexOf(c)>-1),m}eachChild(n){n(this.input)}outputDefined(){return!1}}class Qs{constructor(n){this.type=jt,this.input=n}static parse(n,c){if(n.length!==2)return c.error(`Expected 1 argument, but found ${n.length-1} instead.`);const m=c.parse(n[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${te(m.type)} instead.`):new Qs(m):null}evaluate(n){const c=this.input.evaluate(n);if(typeof c=="string")return[...c].length;if(Array.isArray(c))return c.length;throw new pn(`Expected value to be of type string or array, but found ${te(yi(c))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Zs=8192;function zc(a,n){const c=(180+a[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,x=Math.pow(2,n.z);return[Math.round(c*x*Zs),Math.round(m*x*Zs)]}function Po(a,n){const c=Math.pow(2,n.z);return[(x=(a[0]/Zs+n.x)/c,360*x-180),(m=(a[1]/Zs+n.y)/c,360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90)];var m,x}function tn(a,n){a[0]=Math.min(a[0],n[0]),a[1]=Math.min(a[1],n[1]),a[2]=Math.max(a[2],n[0]),a[3]=Math.max(a[3],n[1])}function Ua(a,n){return!(a[0]<=n[0]||a[2]>=n[2]||a[1]<=n[1]||a[3]>=n[3])}function Ui(a,n,c){const m=a[0]-n[0],x=a[1]-n[1],k=a[0]-c[0],C=a[1]-c[1];return m*C-k*x==0&&m*k<=0&&x*C<=0}function ca(a,n,c,m){return(x=[m[0]-c[0],m[1]-c[1]])[0]*(k=[n[0]-a[0],n[1]-a[1]])[1]-x[1]*k[0]!=0&&!(!Dc(a,n,c,m)||!Dc(c,m,a,n));var x,k}function ec(a,n,c){for(const m of c)for(let x=0;x<m.length-1;++x)if(ca(a,n,m[x],m[x+1]))return!0;return!1}function Jo(a,n,c=!1){let m=!1;for(const j of n)for(let z=0;z<j.length-1;z++){if(Ui(a,j[z],j[z+1]))return c;(k=j[z])[1]>(x=a)[1]!=(C=j[z+1])[1]>x[1]&&x[0]<(C[0]-k[0])*(x[1]-k[1])/(C[1]-k[1])+k[0]&&(m=!m)}var x,k,C;return m}function yu(a,n){for(const c of n)if(Jo(a,c))return!0;return!1}function Qu(a,n){for(const c of a)if(!Jo(c,n))return!1;for(let c=0;c<a.length-1;++c)if(ec(a[c],a[c+1],n))return!1;return!0}function eh(a,n){for(const c of n)if(Qu(a,c))return!0;return!1}function Dc(a,n,c,m){const x=m[0]-c[0],k=m[1]-c[1],C=(a[0]-c[0])*k-x*(a[1]-c[1]),j=(n[0]-c[0])*k-x*(n[1]-c[1]);return C>0&&j<0||C<0&&j>0}function _u(a,n,c){const m=[];for(let x=0;x<a.length;x++){const k=[];for(let C=0;C<a[x].length;C++){const j=zc(a[x][C],c);tn(n,j),k.push(j)}m.push(k)}return m}function Oc(a,n,c){const m=[];for(let x=0;x<a.length;x++){const k=_u(a[x],n,c);m.push(k)}return m}function th(a,n,c,m){if(a[0]<c[0]||a[0]>c[2]){const x=.5*m;let k=a[0]-c[0]>x?-m:c[0]-a[0]>x?m:0;k===0&&(k=a[0]-c[2]>x?-m:c[2]-a[0]>x?m:0),a[0]+=k}tn(n,a)}function Ta(a,n,c,m){const x=Math.pow(2,m.z)*Zs,k=[m.x*Zs,m.y*Zs],C=[];for(const j of a)for(const z of j){const F=[z.x+k[0],z.y+k[1]];th(F,n,c,x),C.push(F)}return C}function ih(a,n,c,m){const x=Math.pow(2,m.z)*Zs,k=[m.x*Zs,m.y*Zs],C=[];for(const z of a){const F=[];for(const q of z){const G=[q.x+k[0],q.y+k[1]];tn(n,G),F.push(G)}C.push(F)}if(n[2]-n[0]<=x/2){(j=n)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const z of C)for(const F of z)th(F,n,c,x)}var j;return C}class co{constructor(n,c){this.type=Jt,this.geojson=n,this.geometries=c}static parse(n,c){if(n.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(rr(n[1])){const m=n[1];if(m.type==="FeatureCollection"){const x=[];for(const k of m.features){const{type:C,coordinates:j}=k.geometry;C==="Polygon"&&x.push(j),C==="MultiPolygon"&&x.push(...j)}if(x.length)return new co(m,{type:"MultiPolygon",coordinates:x})}else if(m.type==="Feature"){const x=m.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new co(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new co(m,m)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(c,m){const x=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],C=c.canonicalID();if(m.type==="Polygon"){const j=_u(m.coordinates,k,C),z=Ta(c.geometry(),x,k,C);if(!Ua(x,k))return!1;for(const F of z)if(!Jo(F,j))return!1}if(m.type==="MultiPolygon"){const j=Oc(m.coordinates,k,C),z=Ta(c.geometry(),x,k,C);if(!Ua(x,k))return!1;for(const F of z)if(!yu(F,j))return!1}return!0})(n,this.geometries);if(n.geometryType()==="LineString")return(function(c,m){const x=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],C=c.canonicalID();if(m.type==="Polygon"){const j=_u(m.coordinates,k,C),z=ih(c.geometry(),x,k,C);if(!Ua(x,k))return!1;for(const F of z)if(!Qu(F,j))return!1}if(m.type==="MultiPolygon"){const j=Oc(m.coordinates,k,C),z=ih(c.geometry(),x,k,C);if(!Ua(x,k))return!1;for(const F of z)if(!eh(F,j))return!1}return!0})(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let uo=class{constructor(a=[],n=((c,m)=>c<m?-1:c>m?1:0)){if(this.data=a,this.length=this.data.length,this.compare=n,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:n,compare:c}=this,m=n[a];for(;a>0;){const x=a-1>>1,k=n[x];if(c(m,k)>=0)break;n[a]=k,a=x}n[a]=m}_down(a){const{data:n,compare:c}=this,m=this.length>>1,x=n[a];for(;a<m;){let k=1+(a<<1);const C=k+1;if(C<this.length&&c(n[C],n[k])<0&&(k=C),c(n[k],x)>=0)break;n[a]=n[k],a=k}n[a]=x}};function nh(a,n,c,m,x){vu(a,n,c,m||a.length-1,x||xu)}function vu(a,n,c,m,x){for(;m>c;){if(m-c>600){var k=m-c+1,C=n-c+1,j=Math.log(k),z=.5*Math.exp(2*j/3),F=.5*Math.sqrt(j*z*(k-z)/k)*(C-k/2<0?-1:1);vu(a,n,Math.max(c,Math.floor(n-C*z/k+F)),Math.min(m,Math.floor(n+(k-C)*z/k+F)),x)}var q=a[n],G=c,J=m;for(Qo(a,c,n),x(a[m],q)>0&&Qo(a,c,m);G<J;){for(Qo(a,G,J),G++,J--;x(a[G],q)<0;)G++;for(;x(a[J],q)>0;)J--}x(a[c],q)===0?Qo(a,c,J):Qo(a,++J,m),J<=n&&(c=J+1),n<=J&&(m=J-1)}}function Qo(a,n,c){var m=a[n];a[n]=a[c],a[c]=m}function xu(a,n){return a<n?-1:a>n?1:0}function tc(a,n){if(a.length<=1)return[a];const c=[];let m,x;for(const k of a){const C=Jh(k);C!==0&&(k.area=Math.abs(C),x===void 0&&(x=C<0),x===C<0?(m&&c.push(m),m=[k]):m.push(k))}if(m&&c.push(m),n>1)for(let k=0;k<c.length;k++)c[k].length<=n||(nh(c[k],n,1,c[k].length-1,sh),c[k]=c[k].slice(0,n));return c}function sh(a,n){return n.area-a.area}function Jh(a){let n=0;for(let c,m,x=0,k=a.length,C=k-1;x<k;C=x++)c=a[x],m=a[C],n+=(m.x-c.x)*(c.y+m.y);return n}const bu=1/298.257223563,Nc=bu*(2-bu),rh=Math.PI/180;class Bc{constructor(n){const c=6378.137*rh*1e3,m=Math.cos(n*rh),x=1/(1-Nc*(1-m*m)),k=Math.sqrt(x);this.kx=c*k*m,this.ky=c*k*x*(1-Nc)}distance(n,c){const m=this.wrap(n[0]-c[0])*this.kx,x=(n[1]-c[1])*this.ky;return Math.sqrt(m*m+x*x)}pointOnLine(n,c){let m,x,k,C,j=1/0;for(let z=0;z<n.length-1;z++){let F=n[z][0],q=n[z][1],G=this.wrap(n[z+1][0]-F)*this.kx,J=(n[z+1][1]-q)*this.ky,ae=0;G===0&&J===0||(ae=(this.wrap(c[0]-F)*this.kx*G+(c[1]-q)*this.ky*J)/(G*G+J*J),ae>1?(F=n[z+1][0],q=n[z+1][1]):ae>0&&(F+=G/this.kx*ae,q+=J/this.ky*ae)),G=this.wrap(c[0]-F)*this.kx,J=(c[1]-q)*this.ky;const ue=G*G+J*J;ue<j&&(j=ue,m=F,x=q,k=z,C=ae)}return{point:[m,x],index:k,t:Math.max(0,Math.min(1,C))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function wu(a,n){return n[0]-a[0]}function el(a){return a[1]-a[0]+1}function xr(a,n){return a[1]>=a[0]&&a[1]<n}function Su(a,n){if(a[0]>a[1])return[null,null];const c=el(a);if(n){if(c===2)return[a,null];const x=Math.floor(c/2);return[[a[0],a[0]+x],[a[0]+x,a[1]]]}if(c===1)return[a,null];const m=Math.floor(c/2)-1;return[[a[0],a[0]+m],[a[0]+m+1,a[1]]]}function tl(a,n){if(!xr(n,a.length))return[1/0,1/0,-1/0,-1/0];const c=[1/0,1/0,-1/0,-1/0];for(let m=n[0];m<=n[1];++m)tn(c,a[m]);return c}function Lr(a){const n=[1/0,1/0,-1/0,-1/0];for(const c of a)for(const m of c)tn(n,m);return n}function il(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Io(a,n,c){if(!il(a)||!il(n))return NaN;let m=0,x=0;return a[2]<n[0]&&(m=n[0]-a[2]),a[0]>n[2]&&(m=a[0]-n[2]),a[1]>n[3]&&(x=a[1]-n[3]),a[3]<n[1]&&(x=n[1]-a[3]),c.distance([0,0],[m,x])}function nl(a,n,c){const m=c.pointOnLine(n,a);return c.distance(a,m.point)}function Rl(a,n,c,m,x){const k=Math.min(nl(a,[c,m],x),nl(n,[c,m],x)),C=Math.min(nl(c,[a,n],x),nl(m,[a,n],x));return Math.min(k,C)}function $c(a,n,c,m,x){if(!xr(n,a.length)||!xr(m,c.length))return 1/0;let k=1/0;for(let C=n[0];C<n[1];++C){const j=a[C],z=a[C+1];for(let F=m[0];F<m[1];++F){const q=c[F],G=c[F+1];if(ca(j,z,q,G))return 0;k=Math.min(k,Rl(j,z,q,G,x))}}return k}function ys(a,n,c,m,x){if(!xr(n,a.length)||!xr(m,c.length))return NaN;let k=1/0;for(let C=n[0];C<=n[1];++C)for(let j=m[0];j<=m[1];++j)if(k=Math.min(k,x.distance(a[C],c[j])),k===0)return k;return k}function ah(a,n,c){if(Jo(a,n,!0))return 0;let m=1/0;for(const x of n){const k=x[0],C=x[x.length-1];if(k!==C&&(m=Math.min(m,nl(a,[C,k],c)),m===0))return m;const j=c.pointOnLine(x,a);if(m=Math.min(m,c.distance(a,j.point)),m===0)return m}return m}function Hi(a,n,c,m){if(!xr(n,a.length))return NaN;for(let k=n[0];k<=n[1];++k)if(Jo(a[k],c,!0))return 0;let x=1/0;for(let k=n[0];k<n[1];++k){const C=a[k],j=a[k+1];for(const z of c)for(let F=0,q=z.length,G=q-1;F<q;G=F++){const J=z[G],ae=z[F];if(ca(C,j,J,ae))return 0;x=Math.min(x,Rl(C,j,J,ae,m))}}return x}function ho(a,n){for(const c of a)for(const m of c)if(Jo(m,n,!0))return!0;return!1}function gn(a,n,c,m=1/0){const x=Lr(a),k=Lr(n);if(m!==1/0&&Io(x,k,c)>=m)return m;if(Ua(x,k)){if(ho(a,n))return 0}else if(ho(n,a))return 0;let C=1/0;for(const j of a)for(let z=0,F=j.length,q=F-1;z<F;q=z++){const G=j[q],J=j[z];for(const ae of n)for(let ue=0,de=ae.length,Te=de-1;ue<de;Te=ue++){const Me=ae[Te],tt=ae[ue];if(ca(G,J,Me,tt))return 0;C=Math.min(C,Rl(G,J,Me,tt,c))}}return C}function En(a,n,c,m,x,k){if(!k)return;const C=Io(tl(m,k),x,c);C<n&&a.push([C,k,[0,0]])}function sl(a,n,c,m,x,k,C){if(!k||!C)return;const j=Io(tl(m,k),tl(x,C),c);j<n&&a.push([j,k,C])}function Rr(a,n,c,m,x=1/0){let k=Math.min(m.distance(a[0],c[0][0]),x);if(k===0)return k;const C=new uo([[0,[0,a.length-1],[0,0]]],wu),j=Lr(c);for(;C.length>0;){const z=C.pop();if(z[0]>=k)continue;const F=z[1],q=n?50:100;if(el(F)<=q){if(!xr(F,a.length))return NaN;if(n){const G=Hi(a,F,c,m);if(isNaN(G)||G===0)return G;k=Math.min(k,G)}else for(let G=F[0];G<=F[1];++G){const J=ah(a[G],c,m);if(k=Math.min(k,J),k===0)return 0}}else{const G=Su(F,n);En(C,k,m,a,j,G[0]),En(C,k,m,a,j,G[1])}}return k}function zl(a,n,c,m,x,k=1/0){let C=Math.min(k,x.distance(a[0],c[0]));if(C===0)return C;const j=new uo([[0,[0,a.length-1],[0,c.length-1]]],wu);for(;j.length>0;){const z=j.pop();if(z[0]>=C)continue;const F=z[1],q=z[2],G=n?50:100,J=m?50:100;if(el(F)<=G&&el(q)<=J){if(!xr(F,a.length)&&xr(q,c.length))return NaN;let ae;if(n&&m)ae=$c(a,F,c,q,x),C=Math.min(C,ae);else if(n&&!m){const ue=a.slice(F[0],F[1]+1);for(let de=q[0];de<=q[1];++de)if(ae=nl(c[de],ue,x),C=Math.min(C,ae),C===0)return C}else if(!n&&m){const ue=c.slice(q[0],q[1]+1);for(let de=F[0];de<=F[1];++de)if(ae=nl(a[de],ue,x),C=Math.min(C,ae),C===0)return C}else ae=ys(a,F,c,q,x),C=Math.min(C,ae)}else{const ae=Su(F,n),ue=Su(q,m);sl(j,C,x,a,c,ae[0],ue[0]),sl(j,C,x,a,c,ae[0],ue[1]),sl(j,C,x,a,c,ae[1],ue[0]),sl(j,C,x,a,c,ae[1],ue[1])}}return C}function ua(a){return a.type==="MultiPolygon"?a.coordinates.map((n=>({type:"Polygon",coordinates:n}))):a.type==="MultiLineString"?a.coordinates.map((n=>({type:"LineString",coordinates:n}))):a.type==="MultiPoint"?a.coordinates.map((n=>({type:"Point",coordinates:n}))):[a]}class Ea{constructor(n,c){this.type=jt,this.geojson=n,this.geometries=c}static parse(n,c){if(n.length!==2)return c.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(rr(n[1])){const m=n[1];if(m.type==="FeatureCollection")return new Ea(m,m.features.map((x=>ua(x.geometry))).flat());if(m.type==="Feature")return new Ea(m,ua(m.geometry));if("type"in m&&"coordinates"in m)return new Ea(m,ua(m))}return c.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(c,m){const x=c.geometry(),k=x.flat().map((z=>Po([z.x,z.y],c.canonical)));if(x.length===0)return NaN;const C=new Bc(k[0][1]);let j=1/0;for(const z of m){switch(z.type){case"Point":j=Math.min(j,zl(k,!1,[z.coordinates],!1,C,j));break;case"LineString":j=Math.min(j,zl(k,!1,z.coordinates,!0,C,j));break;case"Polygon":j=Math.min(j,Rr(k,!1,z.coordinates,C,j))}if(j===0)return j}return j})(n,this.geometries);if(n.geometryType()==="LineString")return(function(c,m){const x=c.geometry(),k=x.flat().map((z=>Po([z.x,z.y],c.canonical)));if(x.length===0)return NaN;const C=new Bc(k[0][1]);let j=1/0;for(const z of m){switch(z.type){case"Point":j=Math.min(j,zl(k,!0,[z.coordinates],!1,C,j));break;case"LineString":j=Math.min(j,zl(k,!0,z.coordinates,!0,C,j));break;case"Polygon":j=Math.min(j,Rr(k,!0,z.coordinates,C,j))}if(j===0)return j}return j})(n,this.geometries);if(n.geometryType()==="Polygon")return(function(c,m){const x=c.geometry();if(x.length===0||x[0].length===0)return NaN;const k=tc(x,0).map((z=>z.map((F=>F.map((q=>Po([q.x,q.y],c.canonical))))))),C=new Bc(k[0][0][0][1]);let j=1/0;for(const z of m)for(const F of k){switch(z.type){case"Point":j=Math.min(j,Rr([z.coordinates],!1,F,C,j));break;case"LineString":j=Math.min(j,Rr(z.coordinates,!0,F,C,j));break;case"Polygon":j=Math.min(j,gn(F,z.coordinates,C,j))}if(j===0)return j}return j})(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Fa={"==":Sa,"!=":Ll,">":$a,"<":oa,">=":Ts,"<=":Xo,array:qr,at:wa,boolean:qr,case:Zr,coalesce:jr,collator:la,format:Mo,image:Rc,in:Xn,"index-of":Hr,interpolate:Bs,"interpolate-hcl":Bs,"interpolate-lab":Bs,length:Qs,let:Ba,literal:bs,match:Co,number:qr,"number-format":Ko,object:qr,slice:Yo,step:lo,string:qr,"to-boolean":Ln,"to-color":Ln,"to-number":Ln,"to-string":Ln,var:mn,within:co,distance:Ea};class ar{constructor(n,c,m,x){this.name=n,this.type=c,this._evaluate=m,this.args=x}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,c){const m=n[0],x=ar.definitions[m];if(!x)return c.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(x)?x[0]:x.type,C=Array.isArray(x)?[[x[1],x[2]]]:x.overloads,j=C.filter((([F])=>!Array.isArray(F)||F.length===n.length-1));let z=null;for(const[F,q]of j){z=new Un(c.registry,Dl,c.path,null,c.scope);const G=[];let J=!1;for(let ae=1;ae<n.length;ae++){const ue=n[ae],de=Array.isArray(F)?F[ae-1]:F.type,Te=z.parse(ue,1+G.length,de);if(!Te){J=!0;break}G.push(Te)}if(!J)if(Array.isArray(F)&&F.length!==G.length)z.error(`Expected ${F.length} arguments, but found ${G.length} instead.`);else{for(let ae=0;ae<G.length;ae++){const ue=Array.isArray(F)?F[ae]:F.type,de=G[ae];z.concat(ae+1).checkSubtype(ue,de.type)}if(z.errors.length===0)return new ar(m,k,q,G)}}if(j.length===1)c.errors.push(...z.errors);else{const F=(j.length?j:C).map((([G])=>{return J=G,Array.isArray(J)?`(${J.map(te).join(", ")})`:`(${te(J.type)}...)`;var J})).join(" | "),q=[];for(let G=1;G<n.length;G++){const J=c.parse(n[G],1+q.length);if(!J)return null;q.push(te(J.type))}c.error(`Expected arguments of type ${F}, but found (${q.join(", ")}) instead.`)}return null}static register(n,c){ar.definitions=c;for(const m in c)n[m]=ar}}function rl(a,[n,c,m,x]){n=n.evaluate(a),c=c.evaluate(a),m=m.evaluate(a);const k=x?x.evaluate(a):1,C=Ir(n,c,m,k);if(C)throw new pn(C);return new ut(n/255,c/255,m/255,k,!1)}function Uc(a,n){return a in n}function ha(a,n){const c=n[a];return c===void 0?null:c}function da(a){return{type:a}}function Dl(a){if(a instanceof mn)return Dl(a.boundExpression);if(a instanceof ar&&a.name==="error"||a instanceof la||a instanceof co||a instanceof Ea)return!1;const n=a instanceof Ln||a instanceof qr;let c=!0;return a.eachChild((m=>{c=n?c&&Dl(m):c&&m instanceof bs})),!!c&&jo(a)&&Gr(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function jo(a){if(a instanceof ar&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof co||a instanceof Ea)return!1;let n=!0;return a.eachChild((c=>{n&&!jo(c)&&(n=!1)})),n}function al(a){if(a instanceof ar&&a.name==="feature-state")return!1;let n=!0;return a.eachChild((c=>{n&&!al(c)&&(n=!1)})),n}function Gr(a,n){if(a instanceof ar&&n.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild((m=>{c&&!Gr(m,n)&&(c=!1)})),c}function Fc(a){return{result:"success",value:a}}function ka(a){return{result:"error",value:a}}function Ol(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Va(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Gs(a){return!!a.expression&&a.expression.interpolated}function cn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ol(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function ic(a){return a}function nc(a,n){const c=n.type==="color",m=a.stops&&typeof a.stops[0][0]=="object",x=m||!(m||a.property!==void 0),k=a.type||(Gs(n)?"exponential":"interval");if(c||n.type==="padding"){const q=c?ut.parse:Li.parse;(a=In({},a)).stops&&(a.stops=a.stops.map((G=>[G[0],q(G[1])]))),a.default=q(a.default?a.default:n.default)}if(a.colorSpace&&(C=a.colorSpace)!=="rgb"&&C!=="hcl"&&C!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var C;let j,z,F;if(k==="exponential")j=po;else if(k==="interval")j=ll;else if(k==="categorical"){j=fo,z=Object.create(null);for(const q of a.stops)z[q[0]]=q[1];F=typeof a.stops[0][0]}else{if(k!=="identity")throw new Error(`Unknown function type "${k}"`);j=sc}if(m){const q={},G=[];for(let ue=0;ue<a.stops.length;ue++){const de=a.stops[ue],Te=de[0].zoom;q[Te]===void 0&&(q[Te]={zoom:Te,type:a.type,property:a.property,default:a.default,stops:[]},G.push(Te)),q[Te].stops.push([de[0].value,de[1]])}const J=[];for(const ue of G)J.push([q[ue].zoom,nc(q[ue],n)]);const ae={name:"linear"};return{kind:"composite",interpolationType:ae,interpolationFactor:Bs.interpolationFactor.bind(void 0,ae),zoomStops:J.map((ue=>ue[0])),evaluate:({zoom:ue},de)=>po({stops:J,base:a.base},n,ue).evaluate(ue,de)}}if(x){const q=k==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:q,interpolationFactor:Bs.interpolationFactor.bind(void 0,q),zoomStops:a.stops.map((G=>G[0])),evaluate:({zoom:G})=>j(a,n,G,z,F)}}return{kind:"source",evaluate(q,G){const J=G&&G.properties?G.properties[a.property]:void 0;return J===void 0?qa(a.default,n.default):j(a,n,J,z,F)}}}function qa(a,n,c){return a!==void 0?a:n!==void 0?n:c!==void 0?c:void 0}function fo(a,n,c,m,x){return qa(typeof c===x?m[c]:void 0,a.default,n.default)}function ll(a,n,c){if(cn(c)!=="number")return qa(a.default,n.default);const m=a.stops.length;if(m===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[m-1][0])return a.stops[m-1][1];const x=oo(a.stops.map((k=>k[0])),c);return a.stops[x][1]}function po(a,n,c){const m=a.base!==void 0?a.base:1;if(cn(c)!=="number")return qa(a.default,n.default);const x=a.stops.length;if(x===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[x-1][0])return a.stops[x-1][1];const k=oo(a.stops.map((q=>q[0])),c),C=(function(q,G,J,ae){const ue=ae-J,de=q-J;return ue===0?0:G===1?de/ue:(Math.pow(G,de)-1)/(Math.pow(G,ue)-1)})(c,m,a.stops[k][0],a.stops[k+1][0]),j=a.stops[k][1],z=a.stops[k+1][1],F=Hs[n.type]||ic;return typeof j.evaluate=="function"?{evaluate(...q){const G=j.evaluate.apply(void 0,q),J=z.evaluate.apply(void 0,q);if(G!==void 0&&J!==void 0)return F(G,J,C,a.colorSpace)}}:F(j,z,C,a.colorSpace)}function sc(a,n,c){switch(n.type){case"color":c=ut.parse(c);break;case"formatted":c=en.fromString(c.toString());break;case"resolvedImage":c=Is.fromString(c.toString());break;case"padding":c=Li.parse(c);break;default:cn(c)===n.type||n.type==="enum"&&n.values[c]||(c=void 0)}return qa(c,a.default,n.default)}ar.register(Fa,{error:[{kind:"error"},[ri],(a,[n])=>{throw new pn(n.evaluate(a))}],typeof:[ri,[ci],(a,[n])=>te(yi(n.evaluate(a)))],"to-rgba":[ie(jt,4),[Bi],(a,[n])=>{const[c,m,x,k]=n.evaluate(a).rgb;return[255*c,255*m,255*x,k]}],rgb:[Bi,[jt,jt,jt],rl],rgba:[Bi,[jt,jt,jt,jt],rl],has:{type:Jt,overloads:[[[ri],(a,[n])=>Uc(n.evaluate(a),a.properties())],[[ri,jn],(a,[n,c])=>Uc(n.evaluate(a),c.evaluate(a))]]},get:{type:ci,overloads:[[[ri],(a,[n])=>ha(n.evaluate(a),a.properties())],[[ri,jn],(a,[n,c])=>ha(n.evaluate(a),c.evaluate(a))]]},"feature-state":[ci,[ri],(a,[n])=>ha(n.evaluate(a),a.featureState||{})],properties:[jn,[],a=>a.properties()],"geometry-type":[ri,[],a=>a.geometryType()],id:[ci,[],a=>a.id()],zoom:[jt,[],a=>a.globals.zoom],"heatmap-density":[jt,[],a=>a.globals.heatmapDensity||0],"line-progress":[jt,[],a=>a.globals.lineProgress||0],accumulated:[ci,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[jt,da(jt),(a,n)=>{let c=0;for(const m of n)c+=m.evaluate(a);return c}],"*":[jt,da(jt),(a,n)=>{let c=1;for(const m of n)c*=m.evaluate(a);return c}],"-":{type:jt,overloads:[[[jt,jt],(a,[n,c])=>n.evaluate(a)-c.evaluate(a)],[[jt],(a,[n])=>-n.evaluate(a)]]},"/":[jt,[jt,jt],(a,[n,c])=>n.evaluate(a)/c.evaluate(a)],"%":[jt,[jt,jt],(a,[n,c])=>n.evaluate(a)%c.evaluate(a)],ln2:[jt,[],()=>Math.LN2],pi:[jt,[],()=>Math.PI],e:[jt,[],()=>Math.E],"^":[jt,[jt,jt],(a,[n,c])=>Math.pow(n.evaluate(a),c.evaluate(a))],sqrt:[jt,[jt],(a,[n])=>Math.sqrt(n.evaluate(a))],log10:[jt,[jt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN10],ln:[jt,[jt],(a,[n])=>Math.log(n.evaluate(a))],log2:[jt,[jt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN2],sin:[jt,[jt],(a,[n])=>Math.sin(n.evaluate(a))],cos:[jt,[jt],(a,[n])=>Math.cos(n.evaluate(a))],tan:[jt,[jt],(a,[n])=>Math.tan(n.evaluate(a))],asin:[jt,[jt],(a,[n])=>Math.asin(n.evaluate(a))],acos:[jt,[jt],(a,[n])=>Math.acos(n.evaluate(a))],atan:[jt,[jt],(a,[n])=>Math.atan(n.evaluate(a))],min:[jt,da(jt),(a,n)=>Math.min(...n.map((c=>c.evaluate(a))))],max:[jt,da(jt),(a,n)=>Math.max(...n.map((c=>c.evaluate(a))))],abs:[jt,[jt],(a,[n])=>Math.abs(n.evaluate(a))],round:[jt,[jt],(a,[n])=>{const c=n.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[jt,[jt],(a,[n])=>Math.floor(n.evaluate(a))],ceil:[jt,[jt],(a,[n])=>Math.ceil(n.evaluate(a))],"filter-==":[Jt,[ri,ci],(a,[n,c])=>a.properties()[n.value]===c.value],"filter-id-==":[Jt,[ci],(a,[n])=>a.id()===n.value],"filter-type-==":[Jt,[ri],(a,[n])=>a.geometryType()===n.value],"filter-<":[Jt,[ri,ci],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m<x}],"filter-id-<":[Jt,[ci],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c<m}],"filter->":[Jt,[ri,ci],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m>x}],"filter-id->":[Jt,[ci],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c>m}],"filter-<=":[Jt,[ri,ci],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m<=x}],"filter-id-<=":[Jt,[ci],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c<=m}],"filter->=":[Jt,[ri,ci],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m>=x}],"filter-id->=":[Jt,[ci],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c>=m}],"filter-has":[Jt,[ci],(a,[n])=>n.value in a.properties()],"filter-has-id":[Jt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Jt,[ie(ri)],(a,[n])=>n.value.indexOf(a.geometryType())>=0],"filter-id-in":[Jt,[ie(ci)],(a,[n])=>n.value.indexOf(a.id())>=0],"filter-in-small":[Jt,[ri,ie(ci)],(a,[n,c])=>c.value.indexOf(a.properties()[n.value])>=0],"filter-in-large":[Jt,[ri,ie(ci)],(a,[n,c])=>(function(m,x,k,C){for(;k<=C;){const j=k+C>>1;if(x[j]===m)return!0;x[j]>m?C=j-1:k=j+1}return!1})(a.properties()[n.value],c.value,0,c.value.length-1)],all:{type:Jt,overloads:[[[Jt,Jt],(a,[n,c])=>n.evaluate(a)&&c.evaluate(a)],[da(Jt),(a,n)=>{for(const c of n)if(!c.evaluate(a))return!1;return!0}]]},any:{type:Jt,overloads:[[[Jt,Jt],(a,[n,c])=>n.evaluate(a)||c.evaluate(a)],[da(Jt),(a,n)=>{for(const c of n)if(c.evaluate(a))return!0;return!1}]]},"!":[Jt,[Jt],(a,[n])=>!n.evaluate(a)],"is-supported-script":[Jt,[ri],(a,[n])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(n.evaluate(a))}],upcase:[ri,[ri],(a,[n])=>n.evaluate(a).toUpperCase()],downcase:[ri,[ri],(a,[n])=>n.evaluate(a).toLowerCase()],concat:[ri,da(ci),(a,n)=>n.map((c=>An(c.evaluate(a)))).join("")],"resolved-locale":[ri,[xs],(a,[n])=>n.evaluate(a).resolvedLocale()]});class Lo{constructor(n,c){var m;this.expression=n,this._warningHistory={},this._evaluator=new Wo,this._defaultValue=c?(m=c).type==="color"&&ol(m.default)?new ut(0,0,0,0):m.type==="color"?ut.parse(m.default)||null:m.type==="padding"?Li.parse(m.default)||null:m.type==="variableAnchorOffsetCollection"?On.parse(m.default)||null:m.default===void 0?null:m.default:null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._evaluator.globals=n,this._evaluator.feature=c,this._evaluator.featureState=m,this._evaluator.canonical=x,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)}evaluate(n,c,m,x,k,C){this._evaluator.globals=n,this._evaluator.feature=c||null,this._evaluator.featureState=m||null,this._evaluator.canonical=x,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=C||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new pn(`Expected value to be one of ${Object.keys(this._enumValues).map((z=>JSON.stringify(z))).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(j.message)),this._defaultValue}}}function mo(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Fa}function cl(a,n){const c=new Un(Fa,Dl,[],n?(function(x){const k={color:Bi,string:ri,number:jt,enum:ri,boolean:Jt,formatted:Dn,padding:$n,resolvedImage:Ji,variableAnchorOffsetCollection:be};return x.type==="array"?ie(k[x.value]||ci,x.length):k[x.type]})(n):void 0),m=c.parse(a,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?Fc(new Lo(m,n)):ka(c.errors)}class Wr{constructor(n,c){this.kind=n,this._styleExpression=c,this.isStateDependent=n!=="constant"&&!al(c.expression)}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._styleExpression.evaluateWithoutErrorHandling(n,c,m,x,k,C)}evaluate(n,c,m,x,k,C){return this._styleExpression.evaluate(n,c,m,x,k,C)}}class Ca{constructor(n,c,m,x){this.kind=n,this.zoomStops=m,this._styleExpression=c,this.isStateDependent=n!=="camera"&&!al(c.expression),this.interpolationType=x}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._styleExpression.evaluateWithoutErrorHandling(n,c,m,x,k,C)}evaluate(n,c,m,x,k,C){return this._styleExpression.evaluate(n,c,m,x,k,C)}interpolationFactor(n,c,m){return this.interpolationType?Bs.interpolationFactor(this.interpolationType,n,c,m):0}}function Nl(a,n){const c=cl(a,n);if(c.result==="error")return c;const m=c.value.expression,x=jo(m);if(!x&&!Ol(n))return ka([new an("","data expressions not supported")]);const k=Gr(m,["zoom"]);if(!k&&!Va(n))return ka([new an("","zoom expressions not supported")]);const C=js(m);return C||k?C instanceof an?ka([C]):C instanceof Bs&&!Gs(n)?ka([new an("",'"interpolate" expressions cannot be used with this property')]):Fc(C?new Ca(x?"camera":"composite",c.value,C.labels,C instanceof Bs?C.interpolation:void 0):new Wr(x?"constant":"source",c.value)):ka([new an("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ul{constructor(n,c){this._parameters=n,this._specification=c,In(this,nc(this._parameters,this._specification))}static deserialize(n){return new ul(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function js(a){let n=null;if(a instanceof Ba)n=js(a.result);else if(a instanceof jr){for(const c of a.args)if(n=js(c),n)break}else(a instanceof lo||a instanceof Bs)&&a.input instanceof ar&&a.input.name==="zoom"&&(n=a);return n instanceof an||a.eachChild((c=>{const m=js(c);m instanceof an?n=m:!n&&m?n=new an("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&m&&n!==m&&(n=new an("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}function Ro(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const n of a.slice(1))if(!Ro(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const rc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hl(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Ro(a)||(a=Vc(a));const n=cl(a,rc);if(n.result==="error")throw new Error(n.value.map((c=>`${c.key}: ${c.message}`)).join(", "));return{filter:(c,m,x)=>n.value.evaluate(c,m,{},x),needGeometry:Tu(a)}}function Qh(a,n){return a<n?-1:a>n?1:0}function Tu(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let n=1;n<a.length;n++)if(Tu(a[n]))return!0;return!1}function Vc(a){if(!a)return!0;const n=a[0];return a.length<=1?n!=="any":n==="=="?zo(a[1],a[2],"=="):n==="!="?Kn(zo(a[1],a[2],"==")):n==="<"||n===">"||n==="<="||n===">="?zo(a[1],a[2],n):n==="any"?(c=a.slice(1),["any"].concat(c.map(Vc))):n==="all"?["all"].concat(a.slice(1).map(Vc)):n==="none"?["all"].concat(a.slice(1).map(Vc).map(Kn)):n==="in"?Bl(a[1],a.slice(2)):n==="!in"?Kn(Bl(a[1],a.slice(2))):n==="has"?fa(a[1]):n!=="!has"||Kn(fa(a[1]));var c}function zo(a,n,c){switch(a){case"$type":return[`filter-type-${c}`,n];case"$id":return[`filter-id-${c}`,n];default:return[`filter-${c}`,a,n]}}function Bl(a,n){if(n.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some((c=>typeof c!=typeof n[0]))?["filter-in-large",a,["literal",n.sort(Qh)]]:["filter-in-small",a,["literal",n]]}}function fa(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Kn(a){return["!",a]}function Aa(a){const n=typeof a;if(n==="number"||n==="boolean"||n==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let x="[";for(const k of a)x+=`${Aa(k)},`;return`${x}]`}const c=Object.keys(a).sort();let m="{";for(let x=0;x<c.length;x++)m+=`${JSON.stringify(c[x])}:${Aa(a[c[x]])},`;return`${m}}`}function Yr(a){let n="";for(const c of Qn)n+=`/${Aa(a[c])}`;return n}function br(a){const n=a.value;return n?[new Ct(a.key,n,"constants have been deprecated as of v8")]:[]}function os(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function wr(a){if(Array.isArray(a))return a.map(wr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const n={};for(const c in a)n[c]=wr(a[c]);return n}return os(a)}function Ls(a){const n=a.key,c=a.value,m=a.valueSpec||{},x=a.objectElementValidators||{},k=a.style,C=a.styleSpec,j=a.validateSpec;let z=[];const F=cn(c);if(F!=="object")return[new Ct(n,c,`object expected, ${F} found`)];for(const q in c){const G=q.split(".")[0],J=m[G]||m["*"];let ae;if(x[G])ae=x[G];else if(m[G])ae=j;else if(x["*"])ae=x["*"];else{if(!m["*"]){z.push(new Ct(n,c[q],`unknown property "${q}"`));continue}ae=j}z=z.concat(ae({key:(n&&`${n}.`)+q,value:c[q],valueSpec:J,style:k,styleSpec:C,object:c,objectKey:q,validateSpec:j},c))}for(const q in m)x[q]||m[q].required&&m[q].default===void 0&&c[q]===void 0&&z.push(new Ct(n,c,`missing required property "${q}"`));return z}function dl(a){const n=a.value,c=a.valueSpec,m=a.style,x=a.styleSpec,k=a.key,C=a.arrayElementValidator||a.validateSpec;if(cn(n)!=="array")return[new Ct(k,n,`array expected, ${cn(n)} found`)];if(c.length&&n.length!==c.length)return[new Ct(k,n,`array length ${c.length} expected, length ${n.length} found`)];if(c["min-length"]&&n.length<c["min-length"])return[new Ct(k,n,`array length at least ${c["min-length"]} expected, length ${n.length} found`)];let j={type:c.value,values:c.values};x.$version<7&&(j.function=c.function),cn(c.value)==="object"&&(j=c.value);let z=[];for(let F=0;F<n.length;F++)z=z.concat(C({array:n,arrayIndex:F,value:n[F],valueSpec:j,validateSpec:a.validateSpec,style:m,styleSpec:x,key:`${k}[${F}]`}));return z}function pa(a){const n=a.key,c=a.value,m=a.valueSpec;let x=cn(c);return x==="number"&&c!=c&&(x="NaN"),x!=="number"?[new Ct(n,c,`number expected, ${x} found`)]:"minimum"in m&&c<m.minimum?[new Ct(n,c,`${c} is less than the minimum value ${m.minimum}`)]:"maximum"in m&&c>m.maximum?[new Ct(n,c,`${c} is greater than the maximum value ${m.maximum}`)]:[]}function go(a){const n=a.valueSpec,c=os(a.value.type);let m,x,k,C={};const j=c!=="categorical"&&a.value.property===void 0,z=!j,F=cn(a.value.stops)==="array"&&cn(a.value.stops[0])==="array"&&cn(a.value.stops[0][0])==="object",q=Ls({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(ae){if(c==="identity")return[new Ct(ae.key,ae.value,'identity function may not have a "stops" property')];let ue=[];const de=ae.value;return ue=ue.concat(dl({key:ae.key,value:de,valueSpec:ae.valueSpec,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:G})),cn(de)==="array"&&de.length===0&&ue.push(new Ct(ae.key,de,"array must have at least one stop")),ue},default:function(ae){return ae.validateSpec({key:ae.key,value:ae.value,valueSpec:n,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec})}}});return c==="identity"&&j&&q.push(new Ct(a.key,a.value,'missing required property "property"')),c==="identity"||a.value.stops||q.push(new Ct(a.key,a.value,'missing required property "stops"')),c==="exponential"&&a.valueSpec.expression&&!Gs(a.valueSpec)&&q.push(new Ct(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(z&&!Ol(a.valueSpec)?q.push(new Ct(a.key,a.value,"property functions not supported")):j&&!Va(a.valueSpec)&&q.push(new Ct(a.key,a.value,"zoom functions not supported"))),c!=="categorical"&&!F||a.value.property!==void 0||q.push(new Ct(a.key,a.value,'"property" property is required')),q;function G(ae){let ue=[];const de=ae.value,Te=ae.key;if(cn(de)!=="array")return[new Ct(Te,de,`array expected, ${cn(de)} found`)];if(de.length!==2)return[new Ct(Te,de,`array length 2 expected, length ${de.length} found`)];if(F){if(cn(de[0])!=="object")return[new Ct(Te,de,`object expected, ${cn(de[0])} found`)];if(de[0].zoom===void 0)return[new Ct(Te,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new Ct(Te,de,"object stop key must have value")];if(k&&k>os(de[0].zoom))return[new Ct(Te,de[0].zoom,"stop zoom values must appear in ascending order")];os(de[0].zoom)!==k&&(k=os(de[0].zoom),x=void 0,C={}),ue=ue.concat(Ls({key:`${Te}[0]`,value:de[0],valueSpec:{zoom:{}},validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:pa,value:J}}))}else ue=ue.concat(J({key:`${Te}[0]`,value:de[0],validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec},de));return mo(wr(de[1]))?ue.concat([new Ct(`${Te}[1]`,de[1],"expressions are not allowed in function stops.")]):ue.concat(ae.validateSpec({key:`${Te}[1]`,value:de[1],valueSpec:n,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec}))}function J(ae,ue){const de=cn(ae.value),Te=os(ae.value),Me=ae.value!==null?ae.value:ue;if(m){if(de!==m)return[new Ct(ae.key,Me,`${de} stop domain type must match previous stop domain type ${m}`)]}else m=de;if(de!=="number"&&de!=="string"&&de!=="boolean")return[new Ct(ae.key,Me,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&c!=="categorical"){let tt=`number expected, ${de} found`;return Ol(n)&&c===void 0&&(tt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ct(ae.key,Me,tt)]}return c!=="categorical"||de!=="number"||isFinite(Te)&&Math.floor(Te)===Te?c!=="categorical"&&de==="number"&&x!==void 0&&Te<x?[new Ct(ae.key,Me,"stop domain values must appear in ascending order")]:(x=Te,c==="categorical"&&Te in C?[new Ct(ae.key,Me,"stop domain values must be unique")]:(C[Te]=!0,[])):[new Ct(ae.key,Me,`integer expected, found ${Te}`)]}}function Ha(a){const n=(a.expressionContext==="property"?Nl:cl)(wr(a.value),a.valueSpec);if(n.result==="error")return n.value.map((m=>new Ct(`${a.key}${m.key}`,a.value,m.message)));const c=n.value.expression||n.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!c.outputDefined())return[new Ct(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!al(c))return[new Ct(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!al(c))return[new Ct(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Gr(c,["zoom","feature-state"]))return[new Ct(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!jo(c))return[new Ct(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Sr(a){const n=a.key,c=a.value,m=a.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(os(c))===-1&&x.push(new Ct(n,c,`expected one of [${m.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(m.values).indexOf(os(c))===-1&&x.push(new Ct(n,c,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(c)} found`)),x}function Eu(a){return Ro(wr(a.value))?Ha(In({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):er(a)}function er(a){const n=a.value,c=a.key;if(cn(n)!=="array")return[new Ct(c,n,`array expected, ${cn(n)} found`)];const m=a.styleSpec;let x,k=[];if(n.length<1)return[new Ct(c,n,"filter array must have at least 1 element")];switch(k=k.concat(Sr({key:`${c}[0]`,value:n[0],valueSpec:m.filter_operator,style:a.style,styleSpec:a.styleSpec})),os(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&os(n[1])==="$type"&&k.push(new Ct(c,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&k.push(new Ct(c,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(x=cn(n[1]),x!=="string"&&k.push(new Ct(`${c}[1]`,n[1],`string expected, ${x} found`)));for(let C=2;C<n.length;C++)x=cn(n[C]),os(n[1])==="$type"?k=k.concat(Sr({key:`${c}[${C}]`,value:n[C],valueSpec:m.geometry_type,style:a.style,styleSpec:a.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&k.push(new Ct(`${c}[${C}]`,n[C],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let C=1;C<n.length;C++)k=k.concat(er({key:`${c}[${C}]`,value:n[C],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":x=cn(n[1]),n.length!==2?k.push(new Ct(c,n,`filter array for "${n[0]}" operator must have 2 elements`)):x!=="string"&&k.push(new Ct(`${c}[1]`,n[1],`string expected, ${x} found`))}return k}function $l(a,n){const c=a.key,m=a.validateSpec,x=a.style,k=a.styleSpec,C=a.value,j=a.objectKey,z=k[`${n}_${a.layerType}`];if(!z)return[];const F=j.match(/^(.*)-transition$/);if(n==="paint"&&F&&z[F[1]]&&z[F[1]].transition)return m({key:c,value:C,valueSpec:k.transition,style:x,styleSpec:k});const q=a.valueSpec||z[j];if(!q)return[new Ct(c,C,`unknown property "${j}"`)];let G;if(cn(C)==="string"&&Ol(q)&&!q.tokens&&(G=/^{([^}]+)}$/.exec(C)))return[new Ct(c,C,`"${j}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const J=[];return a.layerType==="symbol"&&(j==="text-field"&&x&&!x.glyphs&&J.push(new Ct(c,C,'use of "text-field" requires a style "glyphs" property')),j==="text-font"&&ol(wr(C))&&os(C.type)==="identity"&&J.push(new Ct(c,C,'"text-font" does not support identity functions'))),J.concat(m({key:a.key,value:C,valueSpec:q,style:x,styleSpec:k,expressionContext:"property",propertyType:n,propertyKey:j}))}function Xr(a){return $l(a,"paint")}function ac(a){return $l(a,"layout")}function fl(a){let n=[];const c=a.value,m=a.key,x=a.style,k=a.styleSpec;c.type||c.ref||n.push(new Ct(m,c,'either "type" or "ref" is required'));let C=os(c.type);const j=os(c.ref);if(c.id){const z=os(c.id);for(let F=0;F<a.arrayIndex;F++){const q=x.layers[F];os(q.id)===z&&n.push(new Ct(m,c.id,`duplicate layer id "${c.id}", previously used at line ${q.id.__line__}`))}}if("ref"in c){let z;["type","source","source-layer","filter","layout"].forEach((F=>{F in c&&n.push(new Ct(m,c[F],`"${F}" is prohibited for ref layers`))})),x.layers.forEach((F=>{os(F.id)===j&&(z=F)})),z?z.ref?n.push(new Ct(m,c.ref,"ref cannot reference another ref layer")):C=os(z.type):n.push(new Ct(m,c.ref,`ref layer "${j}" not found`))}else if(C!=="background")if(c.source){const z=x.sources&&x.sources[c.source],F=z&&os(z.type);z?F==="vector"&&C==="raster"?n.push(new Ct(m,c.source,`layer "${c.id}" requires a raster source`)):F!=="raster-dem"&&C==="hillshade"?n.push(new Ct(m,c.source,`layer "${c.id}" requires a raster-dem source`)):F==="raster"&&C!=="raster"?n.push(new Ct(m,c.source,`layer "${c.id}" requires a vector source`)):F!=="vector"||c["source-layer"]?F==="raster-dem"&&C!=="hillshade"?n.push(new Ct(m,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):C!=="line"||!c.paint||!c.paint["line-gradient"]||F==="geojson"&&z.lineMetrics||n.push(new Ct(m,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ct(m,c,`layer "${c.id}" must specify a "source-layer"`)):n.push(new Ct(m,c.source,`source "${c.source}" not found`))}else n.push(new Ct(m,c,'missing required property "source"'));return n=n.concat(Ls({key:m,value:c,valueSpec:k.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${m}.type`,value:c.type,valueSpec:k.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:c,objectKey:"type"}),filter:Eu,layout:z=>Ls({layer:c,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":F=>ac(In({layerType:C},F))}}),paint:z=>Ls({layer:c,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":F=>Xr(In({layerType:C},F))}})}})),n}function Kr(a){const n=a.value,c=a.key,m=cn(n);return m!=="string"?[new Ct(c,n,`string expected, ${m} found`)]:[]}const pl={promoteId:function({key:a,value:n}){if(cn(n)==="string")return Kr({key:a,value:n});{const c=[];for(const m in n)c.push(...Kr({key:`${a}.${m}`,value:n[m]}));return c}}};function ml(a){const n=a.value,c=a.key,m=a.styleSpec,x=a.style,k=a.validateSpec;if(!n.type)return[new Ct(c,n,'"type" is required')];const C=os(n.type);let j;switch(C){case"vector":case"raster":return j=Ls({key:c,value:n,valueSpec:m[`source_${C.replace("-","_")}`],style:a.style,styleSpec:m,objectElementValidators:pl,validateSpec:k}),j;case"raster-dem":return j=(function(z){var F;const q=(F=z.sourceName)!==null&&F!==void 0?F:"",G=z.value,J=z.styleSpec,ae=J.source_raster_dem,ue=z.style;let de=[];const Te=cn(G);if(G===void 0)return de;if(Te!=="object")return de.push(new Ct("source_raster_dem",G,`object expected, ${Te} found`)),de;const Me=os(G.encoding)==="custom",tt=["redFactor","greenFactor","blueFactor","baseShift"],Be=z.value.encoding?`"${z.value.encoding}"`:"Default";for(const Ke in G)!Me&&tt.includes(Ke)?de.push(new Ct(Ke,G[Ke],`In "${q}": "${Ke}" is only valid when "encoding" is set to "custom". ${Be} encoding found`)):ae[Ke]?de=de.concat(z.validateSpec({key:Ke,value:G[Ke],valueSpec:ae[Ke],validateSpec:z.validateSpec,style:ue,styleSpec:J})):de.push(new Ct(Ke,G[Ke],`unknown property "${Ke}"`));return de})({sourceName:c,value:n,style:a.style,styleSpec:m,validateSpec:k}),j;case"geojson":if(j=Ls({key:c,value:n,valueSpec:m.source_geojson,style:x,styleSpec:m,validateSpec:k,objectElementValidators:pl}),n.cluster)for(const z in n.clusterProperties){const[F,q]=n.clusterProperties[z],G=typeof F=="string"?[F,["accumulated"],["get",z]]:F;j.push(...Ha({key:`${c}.${z}.map`,value:q,expressionContext:"cluster-map"})),j.push(...Ha({key:`${c}.${z}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return j;case"video":return Ls({key:c,value:n,valueSpec:m.source_video,style:x,validateSpec:k,styleSpec:m});case"image":return Ls({key:c,value:n,valueSpec:m.source_image,style:x,validateSpec:k,styleSpec:m});case"canvas":return[new Ct(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Sr({key:`${c}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function oc(a){const n=a.value,c=a.styleSpec,m=c.light,x=a.style;let k=[];const C=cn(n);if(n===void 0)return k;if(C!=="object")return k=k.concat([new Ct("light",n,`object expected, ${C} found`)]),k;for(const j in n){const z=j.match(/^(.*)-transition$/);k=k.concat(z&&m[z[1]]&&m[z[1]].transition?a.validateSpec({key:j,value:n[j],valueSpec:c.transition,validateSpec:a.validateSpec,style:x,styleSpec:c}):m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],validateSpec:a.validateSpec,style:x,styleSpec:c}):[new Ct(j,n[j],`unknown property "${j}"`)])}return k}function u(a){const n=a.value,c=a.styleSpec,m=c.sky,x=a.style,k=cn(n);if(n===void 0)return[];if(k!=="object")return[new Ct("sky",n,`object expected, ${k} found`)];let C=[];for(const j in n)C=C.concat(m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],style:x,styleSpec:c}):[new Ct(j,n[j],`unknown property "${j}"`)]);return C}function b(a){const n=a.value,c=a.styleSpec,m=c.terrain,x=a.style;let k=[];const C=cn(n);if(n===void 0)return k;if(C!=="object")return k=k.concat([new Ct("terrain",n,`object expected, ${C} found`)]),k;for(const j in n)k=k.concat(m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],validateSpec:a.validateSpec,style:x,styleSpec:c}):[new Ct(j,n[j],`unknown property "${j}"`)]);return k}function M(a){let n=[];const c=a.value,m=a.key;if(Array.isArray(c)){const x=[],k=[];for(const C in c)c[C].id&&x.includes(c[C].id)&&n.push(new Ct(m,c,`all the sprites' ids must be unique, but ${c[C].id} is duplicated`)),x.push(c[C].id),c[C].url&&k.includes(c[C].url)&&n.push(new Ct(m,c,`all the sprites' URLs must be unique, but ${c[C].url} is duplicated`)),k.push(c[C].url),n=n.concat(Ls({key:`${m}[${C}]`,value:c[C],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return n}return Kr({key:m,value:c})}const $={"*":()=>[],array:dl,boolean:function(a){const n=a.value,c=a.key,m=cn(n);return m!=="boolean"?[new Ct(c,n,`boolean expected, ${m} found`)]:[]},number:pa,color:function(a){const n=a.key,c=a.value,m=cn(c);return m!=="string"?[new Ct(n,c,`color expected, ${m} found`)]:ut.parse(String(c))?[]:[new Ct(n,c,`color expected, "${c}" found`)]},constants:br,enum:Sr,filter:Eu,function:go,layer:fl,object:Ls,source:ml,light:oc,sky:u,terrain:b,projection:function(a){const n=a.value,c=a.styleSpec,m=c.projection,x=a.style,k=cn(n);if(n===void 0)return[];if(k!=="object")return[new Ct("projection",n,`object expected, ${k} found`)];let C=[];for(const j in n)C=C.concat(m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],style:x,styleSpec:c}):[new Ct(j,n[j],`unknown property "${j}"`)]);return C},string:Kr,formatted:function(a){return Kr(a).length===0?[]:Ha(a)},resolvedImage:function(a){return Kr(a).length===0?[]:Ha(a)},padding:function(a){const n=a.key,c=a.value;if(cn(c)==="array"){if(c.length<1||c.length>4)return[new Ct(n,c,`padding requires 1 to 4 values; ${c.length} values found`)];const m={type:"number"};let x=[];for(let k=0;k<c.length;k++)x=x.concat(a.validateSpec({key:`${n}[${k}]`,value:c[k],validateSpec:a.validateSpec,valueSpec:m}));return x}return pa({key:n,value:c,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const n=a.key,c=a.value,m=cn(c),x=a.styleSpec;if(m!=="array"||c.length<1||c.length%2!=0)return[new Ct(n,c,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let C=0;C<c.length;C+=2)k=k.concat(Sr({key:`${n}[${C}]`,value:c[C],valueSpec:x.layout_symbol["text-anchor"]})),k=k.concat(dl({key:`${n}[${C+1}]`,value:c[C+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:x}));return k},sprite:M};function Z(a){const n=a.value,c=a.valueSpec,m=a.styleSpec;return a.validateSpec=Z,c.expression&&ol(os(n))?go(a):c.expression&&mo(wr(n))?Ha(a):c.type&&$[c.type]?$[c.type](a):Ls(In({},a,{valueSpec:c.type?m[c.type]:c}))}function ce(a){const n=a.value,c=a.key,m=Kr(a);return m.length||(n.indexOf("{fontstack}")===-1&&m.push(new Ct(c,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&m.push(new Ct(c,n,'"glyphs" url must include a "{range}" token'))),m}function Ae(a,n=it){let c=[];return c=c.concat(Z({key:"",value:a,valueSpec:n.$root,styleSpec:n,style:a,validateSpec:Z,objectElementValidators:{glyphs:ce,"*":()=>[]}})),a.constants&&(c=c.concat(br({key:"constants",value:a.constants}))),dt(c)}function Je(a){return function(n){return a({...n,validateSpec:Z})}}function dt(a){return[].concat(a).sort(((n,c)=>n.line-c.line))}function wt(a){return function(...n){return dt(a.apply(this,n))}}Ae.source=wt(Je(ml)),Ae.sprite=wt(Je(M)),Ae.glyphs=wt(Je(ce)),Ae.light=wt(Je(oc)),Ae.sky=wt(Je(u)),Ae.terrain=wt(Je(b)),Ae.layer=wt(Je(fl)),Ae.filter=wt(Je(Eu)),Ae.paintProperty=wt(Je(Xr)),Ae.layoutProperty=wt(Je(ac));const Yt=Ae,_i=Yt.light,un=Yt.sky,Ws=Yt.paintProperty,Es=Yt.layoutProperty;function Tr(a,n){let c=!1;if(n&&n.length)for(const m of n)a.fire(new hn(new Error(m.message))),c=!0;return c}class bn{constructor(n,c,m){const x=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const C=new Int32Array(this.arrayBuffer);n=C[0],this.d=(c=C[1])+2*(m=C[2]);for(let z=0;z<this.d*this.d;z++){const F=C[3+z],q=C[3+z+1];x.push(F===q?null:C.subarray(F,q))}const j=C[3+x.length+1];this.keys=C.subarray(C[3+x.length],j),this.bboxes=C.subarray(j),this.insert=this._insertReadonly}else{this.d=c+2*m;for(let C=0;C<this.d*this.d;C++)x.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=n,this.padding=m,this.scale=c/n,this.uid=0;const k=m/c*n;this.min=-k,this.max=n+k}insert(n,c,m,x,k){this._forEachCell(c,m,x,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,c,m,x,k,C){this.cells[k].push(C)}query(n,c,m,x,k){const C=this.min,j=this.max;if(n<=C&&c<=C&&j<=m&&j<=x&&!k)return Array.prototype.slice.call(this.keys);{const z=[];return this._forEachCell(n,c,m,x,this._queryCell,z,{},k),z}}_queryCell(n,c,m,x,k,C,j,z){const F=this.cells[k];if(F!==null){const q=this.keys,G=this.bboxes;for(let J=0;J<F.length;J++){const ae=F[J];if(j[ae]===void 0){const ue=4*ae;(z?z(G[ue+0],G[ue+1],G[ue+2],G[ue+3]):n<=G[ue+2]&&c<=G[ue+3]&&m>=G[ue+0]&&x>=G[ue+1])?(j[ae]=!0,C.push(q[ae])):j[ae]=!1}}}}_forEachCell(n,c,m,x,k,C,j,z){const F=this._convertToCellCoord(n),q=this._convertToCellCoord(c),G=this._convertToCellCoord(m),J=this._convertToCellCoord(x);for(let ae=F;ae<=G;ae++)for(let ue=q;ue<=J;ue++){const de=this.d*ue+ae;if((!z||z(this._convertFromCellCoord(ae),this._convertFromCellCoord(ue),this._convertFromCellCoord(ae+1),this._convertFromCellCoord(ue+1)))&&k.call(this,n,c,m,x,de,C,j,z))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,c=3+this.cells.length+1+1;let m=0;for(let C=0;C<this.cells.length;C++)m+=this.cells[C].length;const x=new Int32Array(c+m+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;let k=c;for(let C=0;C<n.length;C++){const j=n[C];x[3+C]=k,x.set(j,k),k+=j.length}return x[3+n.length]=k,x.set(this.keys,k),k+=this.keys.length,x[3+n.length+1]=k,x.set(this.bboxes,k),k+=this.bboxes.length,x.buffer}static serialize(n,c){const m=n.toArrayBuffer();return c&&c.push(m),{buffer:m}}static deserialize(n){return new bn(n.buffer)}}const Yi={};function Lt(a,n,c={}){if(Yi[a])throw new Error(`${a} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:a,writeable:!1}),Yi[a]={klass:n,omit:c.omit||[],shallow:c.shallow||[]}}Lt("Object",Object),Lt("TransferableGridIndex",bn),Lt("Color",ut),Lt("Error",Error),Lt("AJAXError",It),Lt("ResolvedImage",Is),Lt("StylePropertyFunction",ul),Lt("StyleExpression",Lo,{omit:["_evaluator"]}),Lt("ZoomDependentExpression",Ca),Lt("ZoomConstantExpression",Wr),Lt("CompoundExpression",ar,{omit:["_evaluate"]});for(const a in Fa)Fa[a]._classRegistryKey||Lt(`Expression_${a}`,Fa[a]);function Ma(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function zr(a){return a.$name||a.constructor._classRegistryKey}function lc(a){return!(function(n){if(n===null||typeof n!="object")return!1;const c=zr(n);return!(!c||c==="Object")})(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Ma(a)||ct(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function Jr(a,n){if(lc(a))return(Ma(a)||ct(a))&&n&&n.push(a),ArrayBuffer.isView(a)&&n&&n.push(a.buffer),a instanceof ImageData&&n&&n.push(a.data.buffer),a;if(Array.isArray(a)){const k=[];for(const C of a)k.push(Jr(C,n));return k}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const c=zr(a);if(!c)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Yi[c])throw new Error(`${c} is not registered.`);const{klass:m}=Yi[c],x=m.serialize?m.serialize(a,n):{};if(m.serialize){if(n&&x===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const k in a){if(!a.hasOwnProperty(k)||Yi[c].omit.indexOf(k)>=0)continue;const C=a[k];x[k]=Yi[c].shallow.indexOf(k)>=0?C:Jr(C,n)}a instanceof Error&&(x.message=a.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(x.$name=c),x}function Do(a){if(lc(a))return a;if(Array.isArray(a))return a.map(Do);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const n=zr(a)||"Object";if(!Yi[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:c}=Yi[n];if(!c)throw new Error(`can't deserialize unregistered class ${n}`);if(c.deserialize)return c.deserialize(a);const m=Object.create(c.prototype);for(const x of Object.keys(a)){if(x==="$name")continue;const k=a[x];m[x]=Yi[n].shallow.indexOf(x)>=0?k:Do(k)}return m}class _s{constructor(){this.first=!0}update(n,c){const m=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=c),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=m,!0))}}const Oi={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function yo(a){for(const n of a)if(Oo(n.charCodeAt(0)))return!0;return!1}function ku(a){for(const n of a)if(!Qr(n.charCodeAt(0)))return!1;return!0}function gl(a){const n=a.map((c=>{try{return new RegExp(`\\p{sc=${c}}`,"u").source}catch{return null}})).filter((c=>c));return new RegExp(n.join("|"),"u")}const cc=gl(["Arab","Dupl","Mong","Ougr","Syrc"]);function Qr(a){return!cc.test(String.fromCodePoint(a))}const Za=gl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Oo(a){return!(a!==746&&a!==747&&(a<4352||!(Oi["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Oi["CJK Compatibility"](a)||Oi["CJK Strokes"](a)||!(!Oi["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Oi["Enclosed CJK Letters and Months"](a)||Oi["Ideographic Description Characters"](a)||Oi.Kanbun(a)||Oi.Katakana(a)&&a!==12540||!(!Oi["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Oi["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Oi["Vertical Forms"](a)||Oi["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Za.test(String.fromCodePoint(a)))))}function No(a){return!(Oo(a)||(function(n){return!!(Oi["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Oi["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Oi["Letterlike Symbols"](n)||Oi["Number Forms"](n)||Oi["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Oi["Control Pictures"](n)&&n!==9251||Oi["Optical Character Recognition"](n)||Oi["Enclosed Alphanumerics"](n)||Oi["Geometric Shapes"](n)||Oi["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Oi["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Oi["CJK Symbols and Punctuation"](n)||Oi.Katakana(n)||Oi["Private Use Area"](n)||Oi["CJK Compatibility Forms"](n)||Oi["Small Form Variants"](n)||Oi["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)})(a))}const ed=gl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Cu(a){return ed.test(String.fromCodePoint(a))}function qc(a,n){return!(!n&&Cu(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Oi.Khmer(a))}function oh(a){for(const n of a)if(Cu(n.charCodeAt(0)))return!0;return!1}const tr=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class nn{constructor(n,c){this.zoom=n,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new _s,this.transition={})}isSupportedScript(n){return(function(c,m){for(const x of c)if(!qc(x.charCodeAt(0),m))return!1;return!0})(n,tr.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,c=n-Math.floor(n),m=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*c}}}class yl{constructor(n,c){this.property=n,this.value=c,this.expression=(function(m,x){if(ol(m))return new ul(m,x);if(mo(m)){const k=Nl(m,x);if(k.result==="error")throw new Error(k.value.map((C=>`${C.key}: ${C.message}`)).join(", "));return k.value}{let k=m;return x.type==="color"&&typeof m=="string"?k=ut.parse(m):x.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(m)&&(k=On.parse(m)):k=Li.parse(m),{kind:"constant",evaluate:()=>k}}})(c===void 0?n.specification.default:c,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,c,m){return this.property.possiblyEvaluate(this,n,c,m)}}class Au{constructor(n){this.property=n,this.value=new yl(n,void 0)}transitioned(n,c){return new rf(this.property,this.value,c,Re({},n.transition,this.transition),n.now)}untransitioned(){return new rf(this.property,this.value,null,{},0)}}class lh{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return at(this._values[n].value.value)}setValue(n,c){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Au(this._values[n].property)),this._values[n].value=new yl(this._values[n].property,c===null?void 0:at(c))}getTransition(n){return at(this._values[n].transition)}setTransition(n,c){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Au(this._values[n].property)),this._values[n].transition=at(c)||void 0}serialize(){const n={};for(const c of Object.keys(this._values)){const m=this.getValue(c);m!==void 0&&(n[c]=m);const x=this.getTransition(c);x!==void 0&&(n[`${c}-transition`]=x)}return n}transitioned(n,c){const m=new Mu(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].transitioned(n,c._values[x]);return m}untransitioned(){const n=new Mu(this._properties);for(const c of Object.keys(this._values))n._values[c]=this._values[c].untransitioned();return n}}class rf{constructor(n,c,m,x,k){this.property=n,this.value=c,this.begin=k+x.delay||0,this.end=this.begin+x.duration||0,n.specification.transition&&(x.delay||x.duration)&&(this.prior=m)}possiblyEvaluate(n,c,m){const x=n.now||0,k=this.value.possiblyEvaluate(n,c,m),C=this.prior;if(C){if(x>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(x<this.begin)return C.possiblyEvaluate(n,c,m);{const j=(x-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(n,c,m),k,(function(z){if(z<=0)return 0;if(z>=1)return 1;const F=z*z,q=F*z;return 4*(z<.5?q:3*(z-F)+q-.75)})(j))}}return k}}class Mu{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,c,m){const x=new _l(this._properties);for(const k of Object.keys(this._values))x._values[k]=this._values[k].possiblyEvaluate(n,c,m);return x}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class ws{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return at(this._values[n].value)}setValue(n,c){this._values[n]=new yl(this._values[n].property,c===null?void 0:at(c))}serialize(){const n={};for(const c of Object.keys(this._values)){const m=this.getValue(c);m!==void 0&&(n[c]=m)}return n}possiblyEvaluate(n,c,m){const x=new _l(this._properties);for(const k of Object.keys(this._values))x._values[k]=this._values[k].possiblyEvaluate(n,c,m);return x}}class Ga{constructor(n,c,m){this.property=n,this.value=c,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,c,m,x){return this.property.evaluate(this.value,this.parameters,n,c,m,x)}}class _l{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class oi{constructor(n){this.specification=n}possiblyEvaluate(n,c){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(c)}interpolate(n,c,m){const x=Hs[this.specification.type];return x?x(n,c,m):n}}class vi{constructor(n,c){this.specification=n,this.overrides=c}possiblyEvaluate(n,c,m,x){return new Ga(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(c,null,{},m,x)}:n.expression,c)}interpolate(n,c,m){if(n.value.kind!=="constant"||c.value.kind!=="constant")return n;if(n.value.value===void 0||c.value.value===void 0)return new Ga(this,{kind:"constant",value:void 0},n.parameters);const x=Hs[this.specification.type];if(x){const k=x(n.value.value,c.value.value,m);return new Ga(this,{kind:"constant",value:k},n.parameters)}return n}evaluate(n,c,m,x,k,C){return n.kind==="constant"?n.value:n.evaluate(c,m,x,k,C)}}class vl extends vi{possiblyEvaluate(n,c,m,x){if(n.value===void 0)return new Ga(this,{kind:"constant",value:void 0},c);if(n.expression.kind==="constant"){const k=n.expression.evaluate(c,null,{},m,x),C=n.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,j=this._calculate(C,C,C,c);return new Ga(this,{kind:"constant",value:j},c)}if(n.expression.kind==="camera"){const k=this._calculate(n.expression.evaluate({zoom:c.zoom-1}),n.expression.evaluate({zoom:c.zoom}),n.expression.evaluate({zoom:c.zoom+1}),c);return new Ga(this,{kind:"constant",value:k},c)}return new Ga(this,n.expression,c)}evaluate(n,c,m,x,k,C){if(n.kind==="source"){const j=n.evaluate(c,m,x,k,C);return this._calculate(j,j,j,c)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(c.zoom)-1},m,x),n.evaluate({zoom:Math.floor(c.zoom)},m,x),n.evaluate({zoom:Math.floor(c.zoom)+1},m,x),c):n.value}_calculate(n,c,m,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:n,to:c}:{from:m,to:c}}interpolate(n){return n}}class xl{constructor(n){this.specification=n}possiblyEvaluate(n,c,m,x){if(n.value!==void 0){if(n.expression.kind==="constant"){const k=n.expression.evaluate(c,null,{},m,x);return this._calculate(k,k,k,c)}return this._calculate(n.expression.evaluate(new nn(Math.floor(c.zoom-1),c)),n.expression.evaluate(new nn(Math.floor(c.zoom),c)),n.expression.evaluate(new nn(Math.floor(c.zoom+1),c)),c)}}_calculate(n,c,m,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:n,to:c}:{from:m,to:c}}interpolate(n){return n}}class td{constructor(n){this.specification=n}possiblyEvaluate(n,c,m,x){return!!n.expression.evaluate(c,null,{},m,x)}interpolate(){return!1}}class E{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in n){const m=n[c];m.specification.overridable&&this.overridableProperties.push(c);const x=this.defaultPropertyValues[c]=new yl(m,void 0),k=this.defaultTransitionablePropertyValues[c]=new Au(m);this.defaultTransitioningPropertyValues[c]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=x.possiblyEvaluate({})}}}Lt("DataDrivenProperty",vi),Lt("DataConstantProperty",oi),Lt("CrossFadedDataDrivenProperty",vl),Lt("CrossFadedProperty",xl),Lt("ColorRampProperty",td);const i="-transition";class h extends zn{constructor(n,c){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),c.layout&&(this._unevaluatedLayout=new ws(c.layout)),c.paint)){this._transitionablePaint=new lh(c.paint);for(const m in n.paint)this.setPaintProperty(m,n.paint[m],{validate:!1});for(const m in n.layout)this.setLayoutProperty(m,n.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _l(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,c,m={}){c!=null&&this._validate(Es,`layers.${this.id}.layout.${n}`,n,c,m)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,c):this.visibility=c)}getPaintProperty(n){return n.endsWith(i)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,c,m={}){if(c!=null&&this._validate(Ws,`layers.${this.id}.paint.${n}`,n,c,m))return!1;if(n.endsWith(i))return this._transitionablePaint.setTransition(n.slice(0,-11),c||void 0),!1;{const x=this._transitionablePaint._values[n],k=x.property.specification["property-type"]==="cross-faded-data-driven",C=x.value.isDataDriven(),j=x.value;this._transitionablePaint.setValue(n,c),this._handleSpecialPaintPropertyUpdate(n);const z=this._transitionablePaint._values[n].value;return z.isDataDriven()||C||k||this._handleOverridablePaintPropertyUpdate(n,j,z)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,c,m){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,c){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,c)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Xe(n,((c,m)=>!(c===void 0||m==="layout"&&!Object.keys(c).length||m==="paint"&&!Object.keys(c).length)))}_validate(n,c,m,x,k={}){return(!k||k.validate!==!1)&&Tr(this,n.call(Yt,{key:c,layerType:this.type,objectKey:m,value:x,styleSpec:it,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const c=this.paint.get(n);if(c instanceof Ga&&Ol(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}}const g={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class v{constructor(n,c){this._structArray=n,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class T{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,c){return n._trim(),c&&(n.isTransferred=!0,c.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const c=Object.create(this.prototype);return c.arrayBuffer=n.arrayBuffer,c.length=n.length,c.capacity=n.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function R(a,n=1){let c=0,m=0;return{members:a.map((x=>{const k=g[x.type].BYTES_PER_ELEMENT,C=c=O(c,Math.max(n,k)),j=x.components||1;return m=Math.max(m,k),c+=k*j,{name:x.name,type:x.type,components:j,offset:C}})),size:O(c,Math.max(m,n)),alignment:n}}function O(a,n){return Math.ceil(a/n)*n}class U extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.int16[x+0]=c,this.int16[x+1]=m,n}}U.prototype.bytesPerElement=4,Lt("StructArrayLayout2i4",U);class H extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.int16[k+0]=c,this.int16[k+1]=m,this.int16[k+2]=x,n}}H.prototype.bytesPerElement=6,Lt("StructArrayLayout3i6",H);class Y extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,n,c,m,x)}emplace(n,c,m,x,k){const C=4*n;return this.int16[C+0]=c,this.int16[C+1]=m,this.int16[C+2]=x,this.int16[C+3]=k,n}}Y.prototype.bytesPerElement=8,Lt("StructArrayLayout4i8",Y);class X extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const z=6*n;return this.int16[z+0]=c,this.int16[z+1]=m,this.int16[z+2]=x,this.int16[z+3]=k,this.int16[z+4]=C,this.int16[z+5]=j,n}}X.prototype.bytesPerElement=12,Lt("StructArrayLayout2i4i12",X);class le extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const z=4*n,F=8*n;return this.int16[z+0]=c,this.int16[z+1]=m,this.uint8[F+4]=x,this.uint8[F+5]=k,this.uint8[F+6]=C,this.uint8[F+7]=j,n}}le.prototype.bytesPerElement=8,Lt("StructArrayLayout2i4ub8",le);class fe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.float32[x+0]=c,this.float32[x+1]=m,n}}fe.prototype.bytesPerElement=8,Lt("StructArrayLayout2f8",fe);class _e extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,z,F,q){const G=this.length;return this.resize(G+1),this.emplace(G,n,c,m,x,k,C,j,z,F,q)}emplace(n,c,m,x,k,C,j,z,F,q,G){const J=10*n;return this.uint16[J+0]=c,this.uint16[J+1]=m,this.uint16[J+2]=x,this.uint16[J+3]=k,this.uint16[J+4]=C,this.uint16[J+5]=j,this.uint16[J+6]=z,this.uint16[J+7]=F,this.uint16[J+8]=q,this.uint16[J+9]=G,n}}_e.prototype.bytesPerElement=20,Lt("StructArrayLayout10ui20",_e);class Ee extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,z,F,q,G,J){const ae=this.length;return this.resize(ae+1),this.emplace(ae,n,c,m,x,k,C,j,z,F,q,G,J)}emplace(n,c,m,x,k,C,j,z,F,q,G,J,ae){const ue=12*n;return this.int16[ue+0]=c,this.int16[ue+1]=m,this.int16[ue+2]=x,this.int16[ue+3]=k,this.uint16[ue+4]=C,this.uint16[ue+5]=j,this.uint16[ue+6]=z,this.uint16[ue+7]=F,this.int16[ue+8]=q,this.int16[ue+9]=G,this.int16[ue+10]=J,this.int16[ue+11]=ae,n}}Ee.prototype.bytesPerElement=24,Lt("StructArrayLayout4i4ui4i24",Ee);class Pe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.float32[k+0]=c,this.float32[k+1]=m,this.float32[k+2]=x,n}}Pe.prototype.bytesPerElement=12,Lt("StructArrayLayout3f12",Pe);class Ie extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.uint32[1*n+0]=c,n}}Ie.prototype.bytesPerElement=4,Lt("StructArrayLayout1ul4",Ie);class ze extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,z,F){const q=this.length;return this.resize(q+1),this.emplace(q,n,c,m,x,k,C,j,z,F)}emplace(n,c,m,x,k,C,j,z,F,q){const G=10*n,J=5*n;return this.int16[G+0]=c,this.int16[G+1]=m,this.int16[G+2]=x,this.int16[G+3]=k,this.int16[G+4]=C,this.int16[G+5]=j,this.uint32[J+3]=z,this.uint16[G+8]=F,this.uint16[G+9]=q,n}}ze.prototype.bytesPerElement=20,Lt("StructArrayLayout6i1ul2ui20",ze);class Se extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const z=6*n;return this.int16[z+0]=c,this.int16[z+1]=m,this.int16[z+2]=x,this.int16[z+3]=k,this.int16[z+4]=C,this.int16[z+5]=j,n}}Se.prototype.bytesPerElement=12,Lt("StructArrayLayout2i2i2i12",Se);class Fe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k){const C=this.length;return this.resize(C+1),this.emplace(C,n,c,m,x,k)}emplace(n,c,m,x,k,C){const j=4*n,z=8*n;return this.float32[j+0]=c,this.float32[j+1]=m,this.float32[j+2]=x,this.int16[z+6]=k,this.int16[z+7]=C,n}}Fe.prototype.bytesPerElement=16,Lt("StructArrayLayout2f1f2i16",Fe);class Ye extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const z=16*n,F=4*n,q=8*n;return this.uint8[z+0]=c,this.uint8[z+1]=m,this.float32[F+1]=x,this.float32[F+2]=k,this.int16[q+6]=C,this.int16[q+7]=j,n}}Ye.prototype.bytesPerElement=16,Lt("StructArrayLayout2ub2f2i16",Ye);class rt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.uint16[k+0]=c,this.uint16[k+1]=m,this.uint16[k+2]=x,n}}rt.prototype.bytesPerElement=6,Lt("StructArrayLayout3ui6",rt);class bt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,z,F,q,G,J,ae,ue,de,Te,Me){const tt=this.length;return this.resize(tt+1),this.emplace(tt,n,c,m,x,k,C,j,z,F,q,G,J,ae,ue,de,Te,Me)}emplace(n,c,m,x,k,C,j,z,F,q,G,J,ae,ue,de,Te,Me,tt){const Be=24*n,Ke=12*n,yt=48*n;return this.int16[Be+0]=c,this.int16[Be+1]=m,this.uint16[Be+2]=x,this.uint16[Be+3]=k,this.uint32[Ke+2]=C,this.uint32[Ke+3]=j,this.uint32[Ke+4]=z,this.uint16[Be+10]=F,this.uint16[Be+11]=q,this.uint16[Be+12]=G,this.float32[Ke+7]=J,this.float32[Ke+8]=ae,this.uint8[yt+36]=ue,this.uint8[yt+37]=de,this.uint8[yt+38]=Te,this.uint32[Ke+10]=Me,this.int16[Be+22]=tt,n}}bt.prototype.bytesPerElement=48,Lt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",bt);class $t extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,z,F,q,G,J,ae,ue,de,Te,Me,tt,Be,Ke,yt,zt,Kt,bi,Vt,Wt,di,ai){const ii=this.length;return this.resize(ii+1),this.emplace(ii,n,c,m,x,k,C,j,z,F,q,G,J,ae,ue,de,Te,Me,tt,Be,Ke,yt,zt,Kt,bi,Vt,Wt,di,ai)}emplace(n,c,m,x,k,C,j,z,F,q,G,J,ae,ue,de,Te,Me,tt,Be,Ke,yt,zt,Kt,bi,Vt,Wt,di,ai,ii){const xt=32*n,si=16*n;return this.int16[xt+0]=c,this.int16[xt+1]=m,this.int16[xt+2]=x,this.int16[xt+3]=k,this.int16[xt+4]=C,this.int16[xt+5]=j,this.int16[xt+6]=z,this.int16[xt+7]=F,this.uint16[xt+8]=q,this.uint16[xt+9]=G,this.uint16[xt+10]=J,this.uint16[xt+11]=ae,this.uint16[xt+12]=ue,this.uint16[xt+13]=de,this.uint16[xt+14]=Te,this.uint16[xt+15]=Me,this.uint16[xt+16]=tt,this.uint16[xt+17]=Be,this.uint16[xt+18]=Ke,this.uint16[xt+19]=yt,this.uint16[xt+20]=zt,this.uint16[xt+21]=Kt,this.uint16[xt+22]=bi,this.uint32[si+12]=Vt,this.float32[si+13]=Wt,this.float32[si+14]=di,this.uint16[xt+30]=ai,this.uint16[xt+31]=ii,n}}$t.prototype.bytesPerElement=64,Lt("StructArrayLayout8i15ui1ul2f2ui64",$t);class Ht extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.float32[1*n+0]=c,n}}Ht.prototype.bytesPerElement=4,Lt("StructArrayLayout1f4",Ht);class Qt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.uint16[6*n+0]=c,this.float32[k+1]=m,this.float32[k+2]=x,n}}Qt.prototype.bytesPerElement=12,Lt("StructArrayLayout1ui2f12",Qt);class Zt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=4*n;return this.uint32[2*n+0]=c,this.uint16[k+2]=m,this.uint16[k+3]=x,n}}Zt.prototype.bytesPerElement=8,Lt("StructArrayLayout1ul2ui8",Zt);class Ut extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.uint16[x+0]=c,this.uint16[x+1]=m,n}}Ut.prototype.bytesPerElement=4,Lt("StructArrayLayout2ui4",Ut);class ni extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.uint16[1*n+0]=c,n}}ni.prototype.bytesPerElement=2,Lt("StructArrayLayout1ui2",ni);class ki extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,n,c,m,x)}emplace(n,c,m,x,k){const C=4*n;return this.float32[C+0]=c,this.float32[C+1]=m,this.float32[C+2]=x,this.float32[C+3]=k,n}}ki.prototype.bytesPerElement=16,Lt("StructArrayLayout4f16",ki);class Gt extends v{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new N(this.anchorPointX,this.anchorPointY)}}Gt.prototype.size=20;class Xt extends ze{get(n){return new Gt(this,n)}}Lt("CollisionBoxArray",Xt);class Ei extends v{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ei.prototype.size=48;class Gn extends bt{get(n){return new Ei(this,n)}}Lt("PlacedSymbolArray",Gn);class Zi extends v{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Zi.prototype.size=64;class dn extends $t{get(n){return new Zi(this,n)}}Lt("SymbolInstanceArray",dn);class Fn extends Ht{getoffsetX(n){return this.float32[1*n+0]}}Lt("GlyphOffsetArray",Fn);class ir extends H{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}Lt("SymbolLineVertexArray",ir);class Wa extends v{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Wa.prototype.size=12;class ts extends Qt{get(n){return new Wa(this,n)}}Lt("TextAnchorOffsetArray",ts);class Dr extends v{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Dr.prototype.size=8;class ls extends Zt{get(n){return new Dr(this,n)}}Lt("FeatureIndexArray",ls);class cs extends U{}class Rs extends U{}class Ya extends U{}class uc extends X{}class _o extends le{}class or extends fe{}class Nn extends _e{}class hc extends Ee{}class vo extends Pe{}class Pi extends Ie{}class yn extends Se{}class us extends Ye{}class ma extends rt{}class zs extends Ut{}const Ds=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:Or}=Ds;class sn{constructor(n=[]){this.segments=n}prepareSegment(n,c,m,x){let k=this.segments[this.segments.length-1];return n>sn.MAX_VERTEX_ARRAY_LENGTH&&Et(`Max vertices per segment is ${sn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!k||k.vertexLength+n>sn.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==x)&&(k={vertexOffset:c.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},x!==void 0&&(k.sortKey=x),this.segments.push(k)),k}get(){return this.segments}destroy(){for(const n of this.segments)for(const c in n.vaos)n.vaos[c].destroy()}static simpleSegment(n,c,m,x){return new sn([{vertexOffset:n,primitiveOffset:c,vertexLength:m,primitiveLength:x,vaos:{},sortKey:0}])}}function Xa(a,n){return 256*(a=ye(Math.floor(a),0,255))+ye(Math.floor(n),0,255)}sn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Lt("SegmentVector",sn);const Hc=R([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var hs={exports:{}},ch={exports:{}};ch.exports=function(a,n){var c,m,x,k,C,j,z,F;for(m=a.length-(c=3&a.length),x=n,C=3432918353,j=461845907,F=0;F<m;)z=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,x=27492+(65535&(k=5*(65535&(x=(x^=z=(65535&(z=(z=(65535&z)*C+(((z>>>16)*C&65535)<<16)&4294967295)<<15|z>>>17))*j+(((z>>>16)*j&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(z=0,c){case 3:z^=(255&a.charCodeAt(F+2))<<16;case 2:z^=(255&a.charCodeAt(F+1))<<8;case 1:x^=z=(65535&(z=(z=(65535&(z^=255&a.charCodeAt(F)))*C+(((z>>>16)*C&65535)<<16)&4294967295)<<15|z>>>17))*j+(((z>>>16)*j&65535)<<16)&4294967295}return x^=a.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0};var id=ch.exports,nd={exports:{}};nd.exports=function(a,n){for(var c,m=a.length,x=n^m,k=0;m>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(k)|(255&a.charCodeAt(++k))<<8|(255&a.charCodeAt(++k))<<16|(255&a.charCodeAt(++k))<<24))+((1540483477*(c>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),m-=4,++k;switch(m){case 3:x^=(255&a.charCodeAt(k+2))<<16;case 2:x^=(255&a.charCodeAt(k+1))<<8;case 1:x=1540483477*(65535&(x^=255&a.charCodeAt(k)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0};var bl=id,af=nd.exports;hs.exports=bl,hs.exports.murmur3=bl,hs.exports.murmur2=af;var Zc=A(hs.exports);class dc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,c,m,x){this.ids.push(Gc(n)),this.positions.push(c,m,x)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Gc(n);let m=0,x=this.ids.length-1;for(;m<x;){const C=m+x>>1;this.ids[C]>=c?x=C:m=C+1}const k=[];for(;this.ids[m]===c;)k.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return k}static serialize(n,c){const m=new Float64Array(n.ids),x=new Uint32Array(n.positions);return lr(m,x,0,m.length-1),c&&c.push(m.buffer,x.buffer),{ids:m,positions:x}}static deserialize(n){const c=new dc;return c.ids=n.ids,c.positions=n.positions,c.indexed=!0,c}}function Gc(a){const n=+a;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Zc(String(a))}function lr(a,n,c,m){for(;c<m;){const x=a[c+m>>1];let k=c-1,C=m+1;for(;;){do k++;while(a[k]<x);do C--;while(a[C]>x);if(k>=C)break;fs(a,k,C),fs(n,3*k,3*C),fs(n,3*k+1,3*C+1),fs(n,3*k+2,3*C+2)}C-c<m-C?(lr(a,n,c,C),c=C+1):(lr(a,n,C+1,m),m=C)}}function fs(a,n,c){const m=a[n];a[n]=a[c],a[c]=m}Lt("FeaturePositionMap",dc);class Ul{constructor(n,c){this.gl=n.gl,this.location=c}}class Wc extends Ul{constructor(n,c){super(n,c),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class sd extends Ul{constructor(n,c){super(n,c),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class of extends Ul{constructor(n,c){super(n,c),this.current=ut.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const fc=new Float32Array(16);function uh(a){return[Xa(255*a.r,255*a.g),Xa(255*a.b,255*a.a)]}class Pu{constructor(n,c,m){this.value=n,this.uniformNames=c.map((x=>`u_${x}`)),this.type=m}setUniform(n,c,m){n.set(m.constantOr(this.value))}getBinding(n,c,m){return this.type==="color"?new of(n,c):new Wc(n,c)}}class Yc{constructor(n,c){this.uniformNames=c.map((m=>`u_${m}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=n.tlbr}setUniform(n,c,m,x){const k=x==="u_pattern_to"?this.patternTo:x==="u_pattern_from"?this.patternFrom:x==="u_pixel_ratio_to"?this.pixelRatioTo:x==="u_pixel_ratio_from"?this.pixelRatioFrom:null;k&&n.set(k)}getBinding(n,c,m){return m.substr(0,9)==="u_pattern"?new sd(n,c):new Wc(n,c)}}class Fl{constructor(n,c,m,x){this.expression=n,this.type=m,this.maxValue=0,this.paintVertexAttributes=c.map((k=>({name:`a_${k}`,type:"Float32",components:m==="color"?2:1,offset:0}))),this.paintVertexArray=new x}populatePaintArray(n,c,m,x,k){const C=this.paintVertexArray.length,j=this.expression.evaluate(new nn(0),c,{},x,[],k);this.paintVertexArray.resize(n),this._setPaintValue(C,n,j)}updatePaintArray(n,c,m,x){const k=this.expression.evaluate({zoom:0},m,x);this._setPaintValue(n,c,k)}_setPaintValue(n,c,m){if(this.type==="color"){const x=uh(m);for(let k=n;k<c;k++)this.paintVertexArray.emplace(k,x[0],x[1])}else{for(let x=n;x<c;x++)this.paintVertexArray.emplace(x,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bo{constructor(n,c,m,x,k,C){this.expression=n,this.uniformNames=c.map((j=>`u_${j}_t`)),this.type=m,this.useIntegerZoom=x,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=c.map((j=>({name:`a_${j}`,type:"Float32",components:m==="color"?4:2,offset:0}))),this.paintVertexArray=new C}populatePaintArray(n,c,m,x,k){const C=this.expression.evaluate(new nn(this.zoom),c,{},x,[],k),j=this.expression.evaluate(new nn(this.zoom+1),c,{},x,[],k),z=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(z,n,C,j)}updatePaintArray(n,c,m,x){const k=this.expression.evaluate({zoom:this.zoom},m,x),C=this.expression.evaluate({zoom:this.zoom+1},m,x);this._setPaintValue(n,c,k,C)}_setPaintValue(n,c,m,x){if(this.type==="color"){const k=uh(m),C=uh(x);for(let j=n;j<c;j++)this.paintVertexArray.emplace(j,k[0],k[1],C[0],C[1])}else{for(let k=n;k<c;k++)this.paintVertexArray.emplace(k,m,x);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(x))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,c){const m=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,x=ye(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);n.set(x)}getBinding(n,c,m){return new Wc(n,c)}}class pc{constructor(n,c,m,x,k,C){this.expression=n,this.type=c,this.useIntegerZoom=m,this.zoom=x,this.layerId=C,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(n,c,m){const x=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(x,n,c.patterns&&c.patterns[this.layerId],m)}updatePaintArray(n,c,m,x,k){this._setPaintValues(n,c,m.patterns&&m.patterns[this.layerId],k)}_setPaintValues(n,c,m,x){if(!x||!m)return;const{min:k,mid:C,max:j}=m,z=x[k],F=x[C],q=x[j];if(z&&F&&q)for(let G=n;G<c;G++)this.zoomInPaintVertexArray.emplace(G,F.tl[0],F.tl[1],F.br[0],F.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],F.pixelRatio,z.pixelRatio),this.zoomOutPaintVertexArray.emplace(G,F.tl[0],F.tl[1],F.br[0],F.br[1],q.tl[0],q.tl[1],q.br[0],q.br[1],F.pixelRatio,q.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Hc.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Hc.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class yp{constructor(n,c,m){this.binders={},this._buffers=[];const x=[];for(const k in n.paint._values){if(!m(k))continue;const C=n.paint.get(k);if(!(C instanceof Ga&&Ol(C.property.specification)))continue;const j=ig(k,n.type),z=C.value,F=C.property.specification.type,q=C.property.useIntegerZoom,G=C.property.specification["property-type"],J=G==="cross-faded"||G==="cross-faded-data-driven";if(z.kind==="constant")this.binders[k]=J?new Yc(z.value,j):new Pu(z.value,j,F),x.push(`/u_${k}`);else if(z.kind==="source"||J){const ae=lf(k,F,"source");this.binders[k]=J?new pc(z,F,q,c,ae,n.id):new Fl(z,j,F,ae),x.push(`/a_${k}`)}else{const ae=lf(k,F,"composite");this.binders[k]=new Bo(z,j,F,q,c,ae),x.push(`/z_${k}`)}}this.cacheKey=x.sort().join("")}getMaxValue(n){const c=this.binders[n];return c instanceof Fl||c instanceof Bo?c.maxValue:0}populatePaintArrays(n,c,m,x,k){for(const C in this.binders){const j=this.binders[C];(j instanceof Fl||j instanceof Bo||j instanceof pc)&&j.populatePaintArray(n,c,m,x,k)}}setConstantPatternPositions(n,c){for(const m in this.binders){const x=this.binders[m];x instanceof Yc&&x.setConstantPatternPositions(n,c)}}updatePaintArrays(n,c,m,x,k){let C=!1;for(const j in n){const z=c.getPositions(j);for(const F of z){const q=m.feature(F.index);for(const G in this.binders){const J=this.binders[G];if((J instanceof Fl||J instanceof Bo||J instanceof pc)&&J.expression.isStateDependent===!0){const ae=x.paint.get(G);J.expression=ae.value,J.updatePaintArray(F.start,F.end,q,n[j],k),C=!0}}}}return C}defines(){const n=[];for(const c in this.binders){const m=this.binders[c];(m instanceof Pu||m instanceof Yc)&&n.push(...m.uniformNames.map((x=>`#define HAS_UNIFORM_${x}`)))}return n}getBinderAttributes(){const n=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof Fl||m instanceof Bo)for(let x=0;x<m.paintVertexAttributes.length;x++)n.push(m.paintVertexAttributes[x].name);else if(m instanceof pc)for(let x=0;x<Hc.members.length;x++)n.push(Hc.members[x].name)}return n}getBinderUniforms(){const n=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof Pu||m instanceof Yc||m instanceof Bo)for(const x of m.uniformNames)n.push(x)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,c){const m=[];for(const x in this.binders){const k=this.binders[x];if(k instanceof Pu||k instanceof Yc||k instanceof Bo){for(const C of k.uniformNames)if(c[C]){const j=k.getBinding(n,c[C],C);m.push({name:C,property:x,binding:j})}}}return m}setUniforms(n,c,m,x){for(const{name:k,property:C,binding:j}of c)this.binders[C].setUniform(j,x,m.get(C),k)}updatePaintBuffers(n){this._buffers=[];for(const c in this.binders){const m=this.binders[c];if(n&&m instanceof pc){const x=n.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;x&&this._buffers.push(x)}else(m instanceof Fl||m instanceof Bo)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(n){for(const c in this.binders){const m=this.binders[c];(m instanceof Fl||m instanceof Bo||m instanceof pc)&&m.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const c=this.binders[n];(c instanceof Fl||c instanceof Bo||c instanceof pc)&&c.destroy()}}}class Xc{constructor(n,c,m=(()=>!0)){this.programConfigurations={};for(const x of n)this.programConfigurations[x.id]=new yp(x,c,m);this.needsUpload=!1,this._featureMap=new dc,this._bufferOffset=0}populatePaintArrays(n,c,m,x,k,C){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(n,c,x,k,C);c.id!==void 0&&this._featureMap.add(c.id,m,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,c,m,x){for(const k of m)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(n,this._featureMap,c,k,x)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function ig(a,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${n}-`,"").replace(/-/g,"_")]}function lf(a,n,c){const m={color:{source:fe,composite:ki},number:{source:Ht,composite:fe}},x=(function(k){return{"line-pattern":{source:Nn,composite:Nn},"fill-pattern":{source:Nn,composite:Nn},"fill-extrusion-pattern":{source:Nn,composite:Nn}}[k]})(a);return x&&x[c]||m[n][c]}Lt("ConstantBinder",Pu),Lt("CrossFadedConstantBinder",Yc),Lt("SourceExpressionBinder",Fl),Lt("CrossFadedCompositeBinder",pc),Lt("CompositeExpressionBinder",Bo),Lt("ProgramConfiguration",yp,{omit:["_buffers"]}),Lt("ProgramConfigurationSet",Xc);const $s=8192,_p=Math.pow(2,14)-1,vp=-_p-1;function Kc(a){const n=$s/a.extent,c=a.loadGeometry();for(let m=0;m<c.length;m++){const x=c[m];for(let k=0;k<x.length;k++){const C=x[k],j=Math.round(C.x*n),z=Math.round(C.y*n);C.x=ye(j,vp,_p),C.y=ye(z,vp,_p),(j<C.x||j>C.x+1||z<C.y||z>C.y+1)&&Et("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Jc(a,n){return{type:a.type,id:a.id,properties:a.properties,geometry:n?Kc(a):[]}}function hh(a,n,c,m,x){a.emplaceBack(2*n+(m+1)/2,2*c+(x+1)/2)}class cf{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Rs,this.indexArray=new ma,this.segments=new sn,this.programConfigurations=new Xc(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){const x=this.layers[0],k=[];let C=null,j=!1;x.type==="circle"&&(C=x.layout.get("circle-sort-key"),j=!C.isConstant());for(const{feature:z,id:F,index:q,sourceLayerIndex:G}of n){const J=this.layers[0]._featureFilter.needGeometry,ae=Jc(z,J);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),ae,m))continue;const ue=j?C.evaluate(ae,{},m):void 0,de={id:F,properties:z.properties,type:z.type,sourceLayerIndex:G,index:q,geometry:J?ae.geometry:Kc(z),patterns:{},sortKey:ue};k.push(de)}j&&k.sort(((z,F)=>z.sortKey-F.sortKey));for(const z of k){const{geometry:F,index:q,sourceLayerIndex:G}=z,J=n[q].feature;this.addFeature(z,F,q,m),c.featureIndex.insert(J,F,q,G,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Or),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,c,m,x){for(const k of c)for(const C of k){const j=C.x,z=C.y;if(j<0||j>=$s||z<0||z>=$s)continue;const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),q=F.vertexLength;hh(this.layoutVertexArray,j,z,-1,-1),hh(this.layoutVertexArray,j,z,1,-1),hh(this.layoutVertexArray,j,z,1,1),hh(this.layoutVertexArray,j,z,-1,1),this.indexArray.emplaceBack(q,q+1,q+2),this.indexArray.emplaceBack(q,q+3,q+2),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,{},x)}}function xp(a,n){for(let c=0;c<a.length;c++)if(mc(n,a[c]))return!0;for(let c=0;c<n.length;c++)if(mc(a,n[c]))return!0;return!!wp(a,n)}function ng(a,n,c){return!!mc(a,n)||!!Qc(n,a,c)}function bp(a,n){if(a.length===1)return rd(n,a[0]);for(let c=0;c<n.length;c++){const m=n[c];for(let x=0;x<m.length;x++)if(mc(a,m[x]))return!0}for(let c=0;c<a.length;c++)if(rd(n,a[c]))return!0;for(let c=0;c<n.length;c++)if(wp(a,n[c]))return!0;return!1}function sg(a,n,c){if(a.length>1){if(wp(a,n))return!0;for(let m=0;m<n.length;m++)if(Qc(n[m],a,c))return!0}for(let m=0;m<a.length;m++)if(Qc(a[m],n,c))return!0;return!1}function wp(a,n){if(a.length===0||n.length===0)return!1;for(let c=0;c<a.length-1;c++){const m=a[c],x=a[c+1];for(let k=0;k<n.length-1;k++)if(rg(m,x,n[k],n[k+1]))return!0}return!1}function rg(a,n,c,m){return gt(a,c,m)!==gt(n,c,m)&&gt(a,n,c)!==gt(a,n,m)}function Qc(a,n,c){const m=c*c;if(n.length===1)return a.distSqr(n[0])<m;for(let x=1;x<n.length;x++)if(Sp(a,n[x-1],n[x])<m)return!0;return!1}function Sp(a,n,c){const m=n.distSqr(c);if(m===0)return a.distSqr(n);const x=((a.x-n.x)*(c.x-n.x)+(a.y-n.y)*(c.y-n.y))/m;return a.distSqr(x<0?n:x>1?c:c.sub(n)._mult(x)._add(n))}function rd(a,n){let c,m,x,k=!1;for(let C=0;C<a.length;C++){c=a[C];for(let j=0,z=c.length-1;j<c.length;z=j++)m=c[j],x=c[z],m.y>n.y!=x.y>n.y&&n.x<(x.x-m.x)*(n.y-m.y)/(x.y-m.y)+m.x&&(k=!k)}return k}function mc(a,n){let c=!1;for(let m=0,x=a.length-1;m<a.length;x=m++){const k=a[m],C=a[x];k.y>n.y!=C.y>n.y&&n.x<(C.x-k.x)*(n.y-k.y)/(C.y-k.y)+k.x&&(c=!c)}return c}function ag(a,n,c){const m=c[0],x=c[2];if(a.x<m.x&&n.x<m.x||a.x>x.x&&n.x>x.x||a.y<m.y&&n.y<m.y||a.y>x.y&&n.y>x.y)return!1;const k=gt(a,n,c[0]);return k!==gt(a,n,c[1])||k!==gt(a,n,c[2])||k!==gt(a,n,c[3])}function Iu(a,n,c){const m=n.paint.get(a).value;return m.kind==="constant"?m.value:c.programConfigurations.get(n.id).getMaxValue(a)}function uf(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function ad(a,n,c,m,x){if(!n[0]&&!n[1])return a;const k=N.convert(n)._mult(x);c==="viewport"&&k._rotate(-m);const C=[];for(let j=0;j<a.length;j++)C.push(a[j].sub(k));return C}let Tp,Ep;Lt("CircleBucket",cf,{omit:["layers"]});var og={get paint(){return Ep=Ep||new E({"circle-radius":new vi(it.paint_circle["circle-radius"]),"circle-color":new vi(it.paint_circle["circle-color"]),"circle-blur":new vi(it.paint_circle["circle-blur"]),"circle-opacity":new vi(it.paint_circle["circle-opacity"]),"circle-translate":new oi(it.paint_circle["circle-translate"]),"circle-translate-anchor":new oi(it.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new oi(it.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new oi(it.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new vi(it.paint_circle["circle-stroke-width"]),"circle-stroke-color":new vi(it.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new vi(it.paint_circle["circle-stroke-opacity"])})},get layout(){return Tp=Tp||new E({"circle-sort-key":new vi(it.layout_circle["circle-sort-key"])})}},ea=1e-6,eu=typeof Float32Array<"u"?Float32Array:Array;function hf(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function kp(a,n,c){var m=n[0],x=n[1],k=n[2],C=n[3],j=n[4],z=n[5],F=n[6],q=n[7],G=n[8],J=n[9],ae=n[10],ue=n[11],de=n[12],Te=n[13],Me=n[14],tt=n[15],Be=c[0],Ke=c[1],yt=c[2],zt=c[3];return a[0]=Be*m+Ke*j+yt*G+zt*de,a[1]=Be*x+Ke*z+yt*J+zt*Te,a[2]=Be*k+Ke*F+yt*ae+zt*Me,a[3]=Be*C+Ke*q+yt*ue+zt*tt,a[4]=(Be=c[4])*m+(Ke=c[5])*j+(yt=c[6])*G+(zt=c[7])*de,a[5]=Be*x+Ke*z+yt*J+zt*Te,a[6]=Be*k+Ke*F+yt*ae+zt*Me,a[7]=Be*C+Ke*q+yt*ue+zt*tt,a[8]=(Be=c[8])*m+(Ke=c[9])*j+(yt=c[10])*G+(zt=c[11])*de,a[9]=Be*x+Ke*z+yt*J+zt*Te,a[10]=Be*k+Ke*F+yt*ae+zt*Me,a[11]=Be*C+Ke*q+yt*ue+zt*tt,a[12]=(Be=c[12])*m+(Ke=c[13])*j+(yt=c[14])*G+(zt=c[15])*de,a[13]=Be*x+Ke*z+yt*J+zt*Te,a[14]=Be*k+Ke*F+yt*ae+zt*Me,a[15]=Be*C+Ke*q+yt*ue+zt*tt,a}Math.hypot||(Math.hypot=function(){for(var a=0,n=arguments.length;n--;)a+=arguments[n]*arguments[n];return Math.sqrt(a)});var ju,lg=kp;function od(a,n,c){var m=n[0],x=n[1],k=n[2],C=n[3];return a[0]=c[0]*m+c[4]*x+c[8]*k+c[12]*C,a[1]=c[1]*m+c[5]*x+c[9]*k+c[13]*C,a[2]=c[2]*m+c[6]*x+c[10]*k+c[14]*C,a[3]=c[3]*m+c[7]*x+c[11]*k+c[15]*C,a}ju=new eu(4),eu!=Float32Array&&(ju[0]=0,ju[1]=0,ju[2]=0,ju[3]=0);class __ extends h{constructor(n){super(n,og)}createBucket(n){return new cf(n)}queryRadius(n){const c=n;return Iu("circle-radius",this,c)+Iu("circle-stroke-width",this,c)+uf(this.paint.get("circle-translate"))}queryIntersectsFeature(n,c,m,x,k,C,j,z){const F=ad(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),C.angle,j),q=this.paint.get("circle-radius").evaluate(c,m)+this.paint.get("circle-stroke-width").evaluate(c,m),G=this.paint.get("circle-pitch-alignment")==="map",J=G?F:(function(ue,de){return ue.map((Te=>df(Te,de)))})(F,z),ae=G?q*j:q;for(const ue of x)for(const de of ue){const Te=G?de:df(de,z);let Me=ae;const tt=od([],[de.x,de.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Me*=tt[3]/C.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Me*=C.cameraToCenterDistance/tt[3]),ng(J,Te,Me))return!0}return!1}}function df(a,n){const c=od([],[a.x,a.y,0,1],n);return new N(c[0]/c[3],c[1]/c[3])}class Cp extends cf{}let Ap;Lt("HeatmapBucket",Cp,{omit:["layers"]});var Mp={get paint(){return Ap=Ap||new E({"heatmap-radius":new vi(it.paint_heatmap["heatmap-radius"]),"heatmap-weight":new vi(it.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new oi(it.paint_heatmap["heatmap-intensity"]),"heatmap-color":new td(it.paint_heatmap["heatmap-color"]),"heatmap-opacity":new oi(it.paint_heatmap["heatmap-opacity"])})}};function ff(a,{width:n,height:c},m,x){if(x){if(x instanceof Uint8ClampedArray)x=new Uint8Array(x.buffer);else if(x.length!==n*c*m)throw new RangeError(`mismatched image size. expected: ${x.length} but got: ${n*c*m}`)}else x=new Uint8Array(n*c*m);return a.width=n,a.height=c,a.data=x,a}function Pp(a,{width:n,height:c},m){if(n===a.width&&c===a.height)return;const x=ff({},{width:n,height:c},m);Ip(a,x,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,n),height:Math.min(a.height,c)},m),a.width=n,a.height=c,a.data=x.data}function Ip(a,n,c,m,x,k){if(x.width===0||x.height===0)return n;if(x.width>a.width||x.height>a.height||c.x>a.width-x.width||c.y>a.height-x.height)throw new RangeError("out of range source coordinates for image copy");if(x.width>n.width||x.height>n.height||m.x>n.width-x.width||m.y>n.height-x.height)throw new RangeError("out of range destination coordinates for image copy");const C=a.data,j=n.data;if(C===j)throw new Error("srcData equals dstData, so image is already copied");for(let z=0;z<x.height;z++){const F=((c.y+z)*a.width+c.x)*k,q=((m.y+z)*n.width+m.x)*k;for(let G=0;G<x.width*k;G++)j[q+G]=C[F+G]}return n}class ld{constructor(n,c){ff(this,n,1,c)}resize(n){Pp(this,n,1)}clone(){return new ld({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,c,m,x,k){Ip(n,c,m,x,k,1)}}class Ka{constructor(n,c){ff(this,n,4,c)}resize(n){Pp(this,n,4)}replace(n,c){c?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ka({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,c,m,x,k){Ip(n,c,m,x,k,4)}}function dh(a){const n={},c=a.resolution||256,m=a.clips?a.clips.length:1,x=a.image||new Ka({width:c,height:m});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const k=(C,j,z)=>{n[a.evaluationKey]=z;const F=a.expression.evaluate(n);x.data[C+j+0]=Math.floor(255*F.r/F.a),x.data[C+j+1]=Math.floor(255*F.g/F.a),x.data[C+j+2]=Math.floor(255*F.b/F.a),x.data[C+j+3]=Math.floor(255*F.a)};if(a.clips)for(let C=0,j=0;C<m;++C,j+=4*c)for(let z=0,F=0;z<c;z++,F+=4){const q=z/(c-1),{start:G,end:J}=a.clips[C];k(j,F,G*(1-q)+J*q)}else for(let C=0,j=0;C<c;C++,j+=4)k(0,j,C/(c-1));return x}Lt("AlphaImage",ld),Lt("RGBAImage",Ka);const cd="big-fb";class pf extends h{createBucket(n){return new Cp(n)}constructor(n){super(n,Mp),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=dh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(cd)&&this.heatmapFbos.delete(cd)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let jp;var cg={get paint(){return jp=jp||new E({"hillshade-illumination-direction":new oi(it.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new oi(it.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new oi(it.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new oi(it.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new oi(it.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new oi(it.paint_hillshade["hillshade-accent-color"])})}};class ud extends h{constructor(n){super(n,cg)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const ug=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:Lp}=ug;function Rp(a,n,c=2){const m=n&&n.length,x=m?n[0]*c:a.length;let k=mf(a,0,x,c,!0);const C=[];if(!k||k.next===k.prev)return C;let j,z,F;if(m&&(k=(function(q,G,J,ae){const ue=[];for(let de=0,Te=G.length;de<Te;de++){const Me=mf(q,G[de]*ae,de<Te-1?G[de+1]*ae:q.length,ae,!1);Me===Me.next&&(Me.steiner=!0),ue.push(gg(Me))}ue.sort(pg);for(let de=0;de<ue.length;de++)J=gf(ue[de],J);return J})(a,n,k,c)),a.length>80*c){j=1/0,z=1/0;let q=-1/0,G=-1/0;for(let J=c;J<x;J+=c){const ae=a[J],ue=a[J+1];ae<j&&(j=ae),ue<z&&(z=ue),ae>q&&(q=ae),ue>G&&(G=ue)}F=Math.max(q-j,G-z),F=F!==0?32767/F:0}return fh(k,C,c,j,z,F,0),C}function mf(a,n,c,m,x){let k;if(x===(function(C,j,z,F){let q=0;for(let G=j,J=z-F;G<z;G+=F)q+=(C[J]-C[G])*(C[G+1]+C[J+1]),J=G;return q})(a,n,c,m)>0)for(let C=n;C<c;C+=m)k=mh(C/m|0,a[C],a[C+1],k);else for(let C=c-m;C>=n;C-=m)k=mh(C/m|0,a[C],a[C+1],k);return k&&Us(k,k.next)&&(gh(k),k=k.next),k}function gc(a,n){if(!a)return a;n||(n=a);let c,m=a;do if(c=!1,m.steiner||!Us(m,m.next)&&ks(m.prev,m,m.next)!==0)m=m.next;else{if(gh(m),m=n=m.prev,m===m.next)break;c=!0}while(c||m!==n);return n}function fh(a,n,c,m,x,k,C){if(!a)return;!C&&k&&(function(z,F,q,G){let J=z;do J.z===0&&(J.z=hd(J.x,J.y,F,q,G)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==z);J.prevZ.nextZ=null,J.prevZ=null,(function(ae){let ue,de=1;do{let Te,Me=ae;ae=null;let tt=null;for(ue=0;Me;){ue++;let Be=Me,Ke=0;for(let zt=0;zt<de&&(Ke++,Be=Be.nextZ,Be);zt++);let yt=de;for(;Ke>0||yt>0&&Be;)Ke!==0&&(yt===0||!Be||Me.z<=Be.z)?(Te=Me,Me=Me.nextZ,Ke--):(Te=Be,Be=Be.nextZ,yt--),tt?tt.nextZ=Te:ae=Te,Te.prevZ=tt,tt=Te;Me=Be}tt.nextZ=null,de*=2}while(ue>1)})(J)})(a,m,x,k);let j=a;for(;a.prev!==a.next;){const z=a.prev,F=a.next;if(k?Lu(a,m,x,k):hg(a))n.push(z.i,a.i,F.i),gh(a),a=F.next,j=F.next;else if((a=F)===j){C?C===1?fh(a=dg(gc(a),n),n,c,m,x,k,2):C===2&&fg(a,n,c,m,x,k):fh(gc(a),n,c,m,x,k,1);break}}}function hg(a){const n=a.prev,c=a,m=a.next;if(ks(n,c,m)>=0)return!1;const x=n.x,k=c.x,C=m.x,j=n.y,z=c.y,F=m.y,q=x<k?x<C?x:C:k<C?k:C,G=j<z?j<F?j:F:z<F?z:F,J=x>k?x>C?x:C:k>C?k:C,ae=j>z?j>F?j:F:z>F?z:F;let ue=m.next;for(;ue!==n;){if(ue.x>=q&&ue.x<=J&&ue.y>=G&&ue.y<=ae&&Ru(x,j,k,z,C,F,ue.x,ue.y)&&ks(ue.prev,ue,ue.next)>=0)return!1;ue=ue.next}return!0}function Lu(a,n,c,m){const x=a.prev,k=a,C=a.next;if(ks(x,k,C)>=0)return!1;const j=x.x,z=k.x,F=C.x,q=x.y,G=k.y,J=C.y,ae=j<z?j<F?j:F:z<F?z:F,ue=q<G?q<J?q:J:G<J?G:J,de=j>z?j>F?j:F:z>F?z:F,Te=q>G?q>J?q:J:G>J?G:J,Me=hd(ae,ue,n,c,m),tt=hd(de,Te,n,c,m);let Be=a.prevZ,Ke=a.nextZ;for(;Be&&Be.z>=Me&&Ke&&Ke.z<=tt;){if(Be.x>=ae&&Be.x<=de&&Be.y>=ue&&Be.y<=Te&&Be!==x&&Be!==C&&Ru(j,q,z,G,F,J,Be.x,Be.y)&&ks(Be.prev,Be,Be.next)>=0||(Be=Be.prevZ,Ke.x>=ae&&Ke.x<=de&&Ke.y>=ue&&Ke.y<=Te&&Ke!==x&&Ke!==C&&Ru(j,q,z,G,F,J,Ke.x,Ke.y)&&ks(Ke.prev,Ke,Ke.next)>=0))return!1;Ke=Ke.nextZ}for(;Be&&Be.z>=Me;){if(Be.x>=ae&&Be.x<=de&&Be.y>=ue&&Be.y<=Te&&Be!==x&&Be!==C&&Ru(j,q,z,G,F,J,Be.x,Be.y)&&ks(Be.prev,Be,Be.next)>=0)return!1;Be=Be.prevZ}for(;Ke&&Ke.z<=tt;){if(Ke.x>=ae&&Ke.x<=de&&Ke.y>=ue&&Ke.y<=Te&&Ke!==x&&Ke!==C&&Ru(j,q,z,G,F,J,Ke.x,Ke.y)&&ks(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.nextZ}return!0}function dg(a,n){let c=a;do{const m=c.prev,x=c.next.next;!Us(m,x)&&Nr(m,c,c.next,x)&&ph(m,x)&&ph(x,m)&&(n.push(m.i,c.i,x.i),gh(c),gh(c.next),c=a=x),c=c.next}while(c!==a);return gc(c)}function fg(a,n,c,m,x,k){let C=a;do{let j=C.next.next;for(;j!==C.prev;){if(C.i!==j.i&&v_(C,j)){let z=zp(C,j);return C=gc(C,C.next),z=gc(z,z.next),fh(C,n,c,m,x,k,0),void fh(z,n,c,m,x,k,0)}j=j.next}C=C.next}while(C!==a)}function pg(a,n){return a.x-n.x}function gf(a,n){const c=(function(x,k){let C=k;const j=x.x,z=x.y;let F,q=-1/0;do{if(z<=C.y&&z>=C.next.y&&C.next.y!==C.y){const de=C.x+(z-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(de<=j&&de>q&&(q=de,F=C.x<C.next.x?C:C.next,de===j))return F}C=C.next}while(C!==k);if(!F)return null;const G=F,J=F.x,ae=F.y;let ue=1/0;C=F;do{if(j>=C.x&&C.x>=J&&j!==C.x&&Ru(z<ae?j:q,z,J,ae,z<ae?q:j,z,C.x,C.y)){const de=Math.abs(z-C.y)/(j-C.x);ph(C,x)&&(de<ue||de===ue&&(C.x>F.x||C.x===F.x&&mg(F,C)))&&(F=C,ue=de)}C=C.next}while(C!==G);return F})(a,n);if(!c)return n;const m=zp(c,a);return gc(m,m.next),gc(c,c.next)}function mg(a,n){return ks(a.prev,a,n.prev)<0&&ks(n.next,a,a.next)<0}function hd(a,n,c,m,x){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*x|0)|a<<8))|a<<4))|a<<2))|a<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-m)*x|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function gg(a){let n=a,c=a;do(n.x<c.x||n.x===c.x&&n.y<c.y)&&(c=n),n=n.next;while(n!==a);return c}function Ru(a,n,c,m,x,k,C,j){return(x-C)*(n-j)>=(a-C)*(k-j)&&(a-C)*(m-j)>=(c-C)*(n-j)&&(c-C)*(k-j)>=(x-C)*(m-j)}function v_(a,n){return a.next.i!==n.i&&a.prev.i!==n.i&&!(function(c,m){let x=c;do{if(x.i!==c.i&&x.next.i!==c.i&&x.i!==m.i&&x.next.i!==m.i&&Nr(x,x.next,c,m))return!0;x=x.next}while(x!==c);return!1})(a,n)&&(ph(a,n)&&ph(n,a)&&(function(c,m){let x=c,k=!1;const C=(c.x+m.x)/2,j=(c.y+m.y)/2;do x.y>j!=x.next.y>j&&x.next.y!==x.y&&C<(x.next.x-x.x)*(j-x.y)/(x.next.y-x.y)+x.x&&(k=!k),x=x.next;while(x!==c);return k})(a,n)&&(ks(a.prev,a,n.prev)||ks(a,n.prev,n))||Us(a,n)&&ks(a.prev,a,a.next)>0&&ks(n.prev,n,n.next)>0)}function ks(a,n,c){return(n.y-a.y)*(c.x-n.x)-(n.x-a.x)*(c.y-n.y)}function Us(a,n){return a.x===n.x&&a.y===n.y}function Nr(a,n,c,m){const x=fd(ks(a,n,c)),k=fd(ks(a,n,m)),C=fd(ks(c,m,a)),j=fd(ks(c,m,n));return x!==k&&C!==j||!(x!==0||!dd(a,c,n))||!(k!==0||!dd(a,m,n))||!(C!==0||!dd(c,a,m))||!(j!==0||!dd(c,n,m))}function dd(a,n,c){return n.x<=Math.max(a.x,c.x)&&n.x>=Math.min(a.x,c.x)&&n.y<=Math.max(a.y,c.y)&&n.y>=Math.min(a.y,c.y)}function fd(a){return a>0?1:a<0?-1:0}function ph(a,n){return ks(a.prev,a,a.next)<0?ks(a,n,a.next)>=0&&ks(a,a.prev,n)>=0:ks(a,n,a.prev)<0||ks(a,a.next,n)<0}function zp(a,n){const c=yh(a.i,a.x,a.y),m=yh(n.i,n.x,n.y),x=a.next,k=n.prev;return a.next=n,n.prev=a,c.next=x,x.prev=c,m.next=c,c.prev=m,k.next=m,m.prev=k,m}function mh(a,n,c,m){const x=yh(a,n,c);return m?(x.next=m.next,x.prev=m,m.next.prev=x,m.next=x):(x.prev=x,x.next=x),x}function gh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function yh(a,n,c){return{i:a,x:n,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function yf(a,n,c){const m=c.patternDependencies;let x=!1;for(const k of n){const C=k.paint.get(`${a}-pattern`);C.isConstant()||(x=!0);const j=C.constantOr(null);j&&(x=!0,m[j.to]=!0,m[j.from]=!0)}return x}function Dp(a,n,c,m,x){const k=x.patternDependencies;for(const C of n){const j=C.paint.get(`${a}-pattern`).value;if(j.kind!=="constant"){let z=j.evaluate({zoom:m-1},c,{},x.availableImages),F=j.evaluate({zoom:m},c,{},x.availableImages),q=j.evaluate({zoom:m+1},c,{},x.availableImages);z=z&&z.name?z.name:z,F=F&&F.name?F.name:F,q=q&&q.name?q.name:q,k[z]=!0,k[F]=!0,k[q]=!0,c.patterns[C.id]={min:z,mid:F,max:q}}}return c}class _h{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ya,this.indexArray=new ma,this.indexArray2=new zs,this.programConfigurations=new Xc(n.layers,n.zoom),this.segments=new sn,this.segments2=new sn,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.hasPattern=yf("fill",this.layers,c);const x=this.layers[0].layout.get("fill-sort-key"),k=!x.isConstant(),C=[];for(const{feature:j,id:z,index:F,sourceLayerIndex:q}of n){const G=this.layers[0]._featureFilter.needGeometry,J=Jc(j,G);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),J,m))continue;const ae=k?x.evaluate(J,{},m,c.availableImages):void 0,ue={id:z,properties:j.properties,type:j.type,sourceLayerIndex:q,index:F,geometry:G?J.geometry:Kc(j),patterns:{},sortKey:ae};C.push(ue)}k&&C.sort(((j,z)=>j.sortKey-z.sortKey));for(const j of C){const{geometry:z,index:F,sourceLayerIndex:q}=j;if(this.hasPattern){const G=Dp("fill",this.layers,j,this.zoom,c);this.patternFeatures.push(G)}else this.addFeature(j,z,F,m,{});c.featureIndex.insert(n[F].feature,z,F,q,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}addFeatures(n,c,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Lp),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,c,m,x,k){for(const C of tc(c,500)){let j=0;for(const ae of C)j+=ae.length;const z=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),F=z.vertexLength,q=[],G=[];for(const ae of C){if(ae.length===0)continue;ae!==C[0]&&G.push(q.length/2);const ue=this.segments2.prepareSegment(ae.length,this.layoutVertexArray,this.indexArray2),de=ue.vertexLength;this.layoutVertexArray.emplaceBack(ae[0].x,ae[0].y),this.indexArray2.emplaceBack(de+ae.length-1,de),q.push(ae[0].x),q.push(ae[0].y);for(let Te=1;Te<ae.length;Te++)this.layoutVertexArray.emplaceBack(ae[Te].x,ae[Te].y),this.indexArray2.emplaceBack(de+Te-1,de+Te),q.push(ae[Te].x),q.push(ae[Te].y);ue.vertexLength+=ae.length,ue.primitiveLength+=ae.length}const J=Rp(q,G);for(let ae=0;ae<J.length;ae+=3)this.indexArray.emplaceBack(F+J[ae],F+J[ae+1],F+J[ae+2]);z.vertexLength+=j,z.primitiveLength+=J.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}}let _f,Op;Lt("FillBucket",_h,{omit:["layers","patternFeatures"]});var yg={get paint(){return Op=Op||new E({"fill-antialias":new oi(it.paint_fill["fill-antialias"]),"fill-opacity":new vi(it.paint_fill["fill-opacity"]),"fill-color":new vi(it.paint_fill["fill-color"]),"fill-outline-color":new vi(it.paint_fill["fill-outline-color"]),"fill-translate":new oi(it.paint_fill["fill-translate"]),"fill-translate-anchor":new oi(it.paint_fill["fill-translate-anchor"]),"fill-pattern":new vl(it.paint_fill["fill-pattern"])})},get layout(){return _f=_f||new E({"fill-sort-key":new vi(it.layout_fill["fill-sort-key"])})}};class _g extends h{constructor(n){super(n,yg)}recalculate(n,c){super.recalculate(n,c);const m=this.paint._values["fill-outline-color"];m.value.kind==="constant"&&m.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new _h(n)}queryRadius(){return uf(this.paint.get("fill-translate"))}queryIntersectsFeature(n,c,m,x,k,C,j){return bp(ad(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),C.angle,j),x)}isTileClipped(){return!0}}const Np=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Bp=R([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$p}=Np;var yc={},Up=I,pd=tu;function tu(a,n,c,m,x){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=m,this._values=x,a.readFields(vg,this,n)}function vg(a,n,c){a==1?n.id=c.readVarint():a==2?(function(m,x){for(var k=m.readVarint()+m.pos;m.pos<k;){var C=x._keys[m.readVarint()],j=x._values[m.readVarint()];x.properties[C]=j}})(c,n):a==3?n.type=c.readVarint():a==4&&(n._geometry=c.pos)}function Fp(a){for(var n,c,m=0,x=0,k=a.length,C=k-1;x<k;C=x++)m+=((c=a[C]).x-(n=a[x]).x)*(n.y+c.y);return m}tu.types=["Unknown","Point","LineString","Polygon"],tu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var n,c=a.readVarint()+a.pos,m=1,x=0,k=0,C=0,j=[];a.pos<c;){if(x<=0){var z=a.readVarint();m=7&z,x=z>>3}if(x--,m===1||m===2)k+=a.readSVarint(),C+=a.readSVarint(),m===1&&(n&&j.push(n),n=[]),n.push(new Up(k,C));else{if(m!==7)throw new Error("unknown command "+m);n&&n.push(n[0].clone())}}return n&&j.push(n),j},tu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var n=a.readVarint()+a.pos,c=1,m=0,x=0,k=0,C=1/0,j=-1/0,z=1/0,F=-1/0;a.pos<n;){if(m<=0){var q=a.readVarint();c=7&q,m=q>>3}if(m--,c===1||c===2)(x+=a.readSVarint())<C&&(C=x),x>j&&(j=x),(k+=a.readSVarint())<z&&(z=k),k>F&&(F=k);else if(c!==7)throw new Error("unknown command "+c)}return[C,z,j,F]},tu.prototype.toGeoJSON=function(a,n,c){var m,x,k=this.extent*Math.pow(2,c),C=this.extent*a,j=this.extent*n,z=this.loadGeometry(),F=tu.types[this.type];function q(ae){for(var ue=0;ue<ae.length;ue++){var de=ae[ue];ae[ue]=[360*(de.x+C)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(de.y+j)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(m=0;m<z.length;m++)G[m]=z[m][0];q(z=G);break;case 2:for(m=0;m<z.length;m++)q(z[m]);break;case 3:for(z=(function(ae){var ue=ae.length;if(ue<=1)return[ae];for(var de,Te,Me=[],tt=0;tt<ue;tt++){var Be=Fp(ae[tt]);Be!==0&&(Te===void 0&&(Te=Be<0),Te===Be<0?(de&&Me.push(de),de=[ae[tt]]):de.push(ae[tt]))}return de&&Me.push(de),Me})(z),m=0;m<z.length;m++)for(x=0;x<z[m].length;x++)q(z[m][x])}z.length===1?z=z[0]:F="Multi"+F;var J={type:"Feature",geometry:{type:F,coordinates:z},properties:this.properties};return"id"in this&&(J.id=this.id),J};var xg=pd,Vl=vf;function vf(a,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(x_,this,n),this.length=this._features.length}function x_(a,n,c){a===15?n.version=c.readVarint():a===1?n.name=c.readString():a===5?n.extent=c.readVarint():a===2?n._features.push(c.pos):a===3?n._keys.push(c.readString()):a===4&&n._values.push((function(m){for(var x=null,k=m.readVarint()+m.pos;m.pos<k;){var C=m.readVarint()>>3;x=C===1?m.readString():C===2?m.readFloat():C===3?m.readDouble():C===4?m.readVarint64():C===5?m.readVarint():C===6?m.readSVarint():C===7?m.readBoolean():null}return x})(c))}vf.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var n=this._pbf.readVarint()+this._pbf.pos;return new xg(this._pbf,n,this.extent,this._keys,this._values)};var bg=Vl;function _c(a,n,c){if(a===3){var m=new bg(c,c.readVarint()+c.pos);m.length&&(n[m.name]=m)}}yc.VectorTile=function(a,n){this.layers=a.readFields(_c,{},n)},yc.VectorTileFeature=pd,yc.VectorTileLayer=Vl;const Vp=yc.VectorTileFeature.types,xf=Math.pow(2,13);function iu(a,n,c,m,x,k,C,j){a.emplaceBack(n,c,2*Math.floor(m*xf)+C,x*xf*2,k*xf*2,Math.round(j))}class zu{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new uc,this.centroidVertexArray=new cs,this.indexArray=new ma,this.programConfigurations=new Xc(n.layers,n.zoom),this.segments=new sn,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.features=[],this.hasPattern=yf("fill-extrusion",this.layers,c);for(const{feature:x,id:k,index:C,sourceLayerIndex:j}of n){const z=this.layers[0]._featureFilter.needGeometry,F=Jc(x,z);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),F,m))continue;const q={id:k,sourceLayerIndex:j,index:C,geometry:z?F.geometry:Kc(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Dp("fill-extrusion",this.layers,q,this.zoom,c)):this.addFeature(q,q.geometry,C,m,{}),c.featureIndex.insert(x,q.geometry,C,j,this.index,!0)}}addFeatures(n,c,m){for(const x of this.features){const{geometry:k}=x;this.addFeature(x,k,x.index,c,m)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,$p),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,Bp.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,c,m,x,k){for(const C of tc(c,500)){const j={x:0,y:0,vertexCount:0};let z=0;for(const ue of C)z+=ue.length;let F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ue of C){if(ue.length===0||b_(ue))continue;let de=0;for(let Te=0;Te<ue.length;Te++){const Me=ue[Te];if(Te>=1){const tt=ue[Te-1];if(!Cs(Me,tt)){F.vertexLength+4>sn.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Be=Me.sub(tt)._perp()._unit(),Ke=tt.dist(Me);de+Ke>32768&&(de=0),iu(this.layoutVertexArray,Me.x,Me.y,Be.x,Be.y,0,0,de),iu(this.layoutVertexArray,Me.x,Me.y,Be.x,Be.y,0,1,de),j.x+=2*Me.x,j.y+=2*Me.y,j.vertexCount+=2,de+=Ke,iu(this.layoutVertexArray,tt.x,tt.y,Be.x,Be.y,0,0,de),iu(this.layoutVertexArray,tt.x,tt.y,Be.x,Be.y,0,1,de),j.x+=2*tt.x,j.y+=2*tt.y,j.vertexCount+=2;const yt=F.vertexLength;this.indexArray.emplaceBack(yt,yt+2,yt+1),this.indexArray.emplaceBack(yt+1,yt+2,yt+3),F.vertexLength+=4,F.primitiveLength+=2}}}}if(F.vertexLength+z>sn.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),Vp[n.type]!=="Polygon")continue;const q=[],G=[],J=F.vertexLength;for(const ue of C)if(ue.length!==0){ue!==C[0]&&G.push(q.length/2);for(let de=0;de<ue.length;de++){const Te=ue[de];iu(this.layoutVertexArray,Te.x,Te.y,0,0,1,1,0),j.x+=Te.x,j.y+=Te.y,j.vertexCount+=1,q.push(Te.x),q.push(Te.y)}}const ae=Rp(q,G);for(let ue=0;ue<ae.length;ue+=3)this.indexArray.emplaceBack(J+ae[ue],J+ae[ue+2],J+ae[ue+1]);F.primitiveLength+=ae.length/3,F.vertexLength+=z;for(let ue=0;ue<j.vertexCount;ue++){const de=Math.floor(j.x/j.vertexCount),Te=Math.floor(j.y/j.vertexCount);this.centroidVertexArray.emplaceBack(de,Te)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}}function Cs(a,n){return a.x===n.x&&(a.x<0||a.x>$s)||a.y===n.y&&(a.y<0||a.y>$s)}function b_(a){return a.every((n=>n.x<0))||a.every((n=>n.x>$s))||a.every((n=>n.y<0))||a.every((n=>n.y>$s))}let wg;Lt("FillExtrusionBucket",zu,{omit:["layers","features"]});var Sg={get paint(){return wg=wg||new E({"fill-extrusion-opacity":new oi(it["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new vi(it["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new oi(it["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new oi(it["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vl(it["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new vi(it["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new vi(it["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new oi(it["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class md extends h{constructor(n){super(n,Sg)}createBucket(n){return new zu(n)}queryRadius(){return uf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,c,m,x,k,C,j,z){const F=ad(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),C.angle,j),q=this.paint.get("fill-extrusion-height").evaluate(c,m),G=this.paint.get("fill-extrusion-base").evaluate(c,m),J=(function(ue,de,Te,Me){const tt=[];for(const Be of ue){const Ke=[Be.x,Be.y,0,1];od(Ke,Ke,de),tt.push(new N(Ke[0]/Ke[3],Ke[1]/Ke[3]))}return tt})(F,z),ae=(function(ue,de,Te,Me){const tt=[],Be=[],Ke=Me[8]*de,yt=Me[9]*de,zt=Me[10]*de,Kt=Me[11]*de,bi=Me[8]*Te,Vt=Me[9]*Te,Wt=Me[10]*Te,di=Me[11]*Te;for(const ai of ue){const ii=[],xt=[];for(const si of ai){const hi=si.x,Ci=si.y,Cn=Me[0]*hi+Me[4]*Ci+Me[12],Jn=Me[1]*hi+Me[5]*Ci+Me[13],dr=Me[2]*hi+Me[6]*Ci+Me[14],ia=Me[3]*hi+Me[7]*Ci+Me[15],Cr=dr+zt,fr=ia+Kt,_a=Cn+bi,va=Jn+Vt,xa=dr+Wt,Os=ia+di,pr=new N((Cn+Ke)/fr,(Jn+yt)/fr);pr.z=Cr/fr,ii.push(pr);const na=new N(_a/Os,va/Os);na.z=xa/Os,xt.push(na)}tt.push(ii),Be.push(xt)}return[tt,Be]})(x,G,q,z);return(function(ue,de,Te){let Me=1/0;bp(Te,de)&&(Me=qp(Te,de[0]));for(let tt=0;tt<de.length;tt++){const Be=de[tt],Ke=ue[tt];for(let yt=0;yt<Be.length-1;yt++){const zt=Be[yt],Kt=[zt,Be[yt+1],Ke[yt+1],Ke[yt],zt];xp(Te,Kt)&&(Me=Math.min(Me,qp(Te,Kt)))}}return Me!==1/0&&Me})(ae[0],ae[1],J)}}function $o(a,n){return a.x*n.x+a.y*n.y}function qp(a,n){if(a.length===1){let c=0;const m=n[c++];let x;for(;!x||m.equals(x);)if(x=n[c++],!x)return 1/0;for(;c<n.length;c++){const k=n[c],C=a[0],j=x.sub(m),z=k.sub(m),F=C.sub(m),q=$o(j,j),G=$o(j,z),J=$o(z,z),ae=$o(F,j),ue=$o(F,z),de=q*J-G*G,Te=(J*ae-G*ue)/de,Me=(q*ue-G*ae)/de,tt=m.z*(1-Te-Me)+x.z*Te+k.z*Me;if(isFinite(tt))return tt}return 1/0}{let c=1/0;for(const m of n)c=Math.min(c,m.z);return c}}const Tg=R([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:gd}=Tg,ql=R([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Eg}=ql,Hp=yc.VectorTileFeature.types,kg=Math.cos(Math.PI/180*37.5),bf=Math.pow(2,14)/.5;class yd{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((c=>{this.gradients[c.id]={}})),this.layoutVertexArray=new _o,this.layoutVertexArray2=new or,this.indexArray=new ma,this.programConfigurations=new Xc(n.layers,n.zoom),this.segments=new sn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.hasPattern=yf("line",this.layers,c);const x=this.layers[0].layout.get("line-sort-key"),k=!x.isConstant(),C=[];for(const{feature:j,id:z,index:F,sourceLayerIndex:q}of n){const G=this.layers[0]._featureFilter.needGeometry,J=Jc(j,G);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),J,m))continue;const ae=k?x.evaluate(J,{},m):void 0,ue={id:z,properties:j.properties,type:j.type,sourceLayerIndex:q,index:F,geometry:G?J.geometry:Kc(j),patterns:{},sortKey:ae};C.push(ue)}k&&C.sort(((j,z)=>j.sortKey-z.sortKey));for(const j of C){const{geometry:z,index:F,sourceLayerIndex:q}=j;if(this.hasPattern){const G=Dp("line",this.layers,j,this.zoom,c);this.patternFeatures.push(G)}else this.addFeature(j,z,F,m,{});c.featureIndex.insert(n[F].feature,z,F,q,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}addFeatures(n,c,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,Eg)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,gd),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,c,m,x,k){const C=this.layers[0].layout,j=C.get("line-join").evaluate(n,{}),z=C.get("line-cap"),F=C.get("line-miter-limit"),q=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const G of c)this.addLine(G,n,j,z,F,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}addLine(n,c,m,x,k,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Me=0;Me<n.length-1;Me++)this.totalDistance+=n[Me].dist(n[Me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=Hp[c.type]==="Polygon";let z=n.length;for(;z>=2&&n[z-1].equals(n[z-2]);)z--;let F=0;for(;F<z-1&&n[F].equals(n[F+1]);)F++;if(z<(j?3:2))return;m==="bevel"&&(k=1.05);const q=this.overscaling<=16?15*$s/(512*this.overscaling):0,G=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let J,ae,ue,de,Te;this.e1=this.e2=-1,j&&(J=n[z-2],Te=n[F].sub(J)._unit()._perp());for(let Me=F;Me<z;Me++){if(ue=Me===z-1?j?n[F+1]:void 0:n[Me+1],ue&&n[Me].equals(ue))continue;Te&&(de=Te),J&&(ae=J),J=n[Me],Te=ue?ue.sub(J)._unit()._perp():de,de=de||Te;let tt=de.add(Te);tt.x===0&&tt.y===0||tt._unit();const Be=de.x*Te.x+de.y*Te.y,Ke=tt.x*Te.x+tt.y*Te.y,yt=Ke!==0?1/Ke:1/0,zt=2*Math.sqrt(2-2*Ke),Kt=Ke<kg&&ae&&ue,bi=de.x*Te.y-de.y*Te.x>0;if(Kt&&Me>F){const di=J.dist(ae);if(di>2*q){const ai=J.sub(J.sub(ae)._mult(q/di)._round());this.updateDistance(ae,ai),this.addCurrentVertex(ai,de,0,0,G),ae=ai}}const Vt=ae&&ue;let Wt=Vt?m:j?"butt":x;if(Vt&&Wt==="round"&&(yt<C?Wt="miter":yt<=2&&(Wt="fakeround")),Wt==="miter"&&yt>k&&(Wt="bevel"),Wt==="bevel"&&(yt>2&&(Wt="flipbevel"),yt<k&&(Wt="miter")),ae&&this.updateDistance(ae,J),Wt==="miter")tt._mult(yt),this.addCurrentVertex(J,tt,0,0,G);else if(Wt==="flipbevel"){if(yt>100)tt=Te.mult(-1);else{const di=yt*de.add(Te).mag()/de.sub(Te).mag();tt._perp()._mult(di*(bi?-1:1))}this.addCurrentVertex(J,tt,0,0,G),this.addCurrentVertex(J,tt.mult(-1),0,0,G)}else if(Wt==="bevel"||Wt==="fakeround"){const di=-Math.sqrt(yt*yt-1),ai=bi?di:0,ii=bi?0:di;if(ae&&this.addCurrentVertex(J,de,ai,ii,G),Wt==="fakeround"){const xt=Math.round(180*zt/Math.PI/20);for(let si=1;si<xt;si++){let hi=si/xt;if(hi!==.5){const Cn=hi-.5;hi+=hi*Cn*(hi-1)*((1.0904+Be*(Be*(3.55645-1.43519*Be)-3.2452))*Cn*Cn+(.848013+Be*(.215638*Be-1.06021)))}const Ci=Te.sub(de)._mult(hi)._add(de)._unit()._mult(bi?-1:1);this.addHalfVertex(J,Ci.x,Ci.y,!1,bi,0,G)}}ue&&this.addCurrentVertex(J,Te,-ai,-ii,G)}else if(Wt==="butt")this.addCurrentVertex(J,tt,0,0,G);else if(Wt==="square"){const di=ae?1:-1;this.addCurrentVertex(J,tt,di,di,G)}else Wt==="round"&&(ae&&(this.addCurrentVertex(J,de,0,0,G),this.addCurrentVertex(J,de,1,1,G,!0)),ue&&(this.addCurrentVertex(J,Te,-1,-1,G,!0),this.addCurrentVertex(J,Te,0,0,G)));if(Kt&&Me<z-1){const di=J.dist(ue);if(di>2*q){const ai=J.add(ue.sub(J)._mult(q/di)._round());this.updateDistance(J,ai),this.addCurrentVertex(ai,Te,0,0,G),J=ai}}}}addCurrentVertex(n,c,m,x,k,C=!1){const j=c.y*x-c.x,z=-c.y-c.x*x;this.addHalfVertex(n,c.x+c.y*m,c.y-c.x*m,C,!1,m,k),this.addHalfVertex(n,j,z,C,!0,-x,k),this.distance>bf/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,c,m,x,k,C))}addHalfVertex({x:n,y:c},m,x,k,C,j,z){const F=.5*(this.lineClips?this.scaledDistance*(bf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(k?1:0),(c<<1)+(C?1:0),Math.round(63*m)+128,Math.round(63*x)+128,1+(j===0?0:j<0?-1:1)|(63&F)<<2,F>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const q=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,q),z.primitiveLength++),C?this.e2=q:this.e1=q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,c){this.distance+=n.dist(c),this.updateScaledDistance()}}let _d,Zp;Lt("LineBucket",yd,{omit:["layers","patternFeatures"]});var Hl={get paint(){return Zp=Zp||new E({"line-opacity":new vi(it.paint_line["line-opacity"]),"line-color":new vi(it.paint_line["line-color"]),"line-translate":new oi(it.paint_line["line-translate"]),"line-translate-anchor":new oi(it.paint_line["line-translate-anchor"]),"line-width":new vi(it.paint_line["line-width"]),"line-gap-width":new vi(it.paint_line["line-gap-width"]),"line-offset":new vi(it.paint_line["line-offset"]),"line-blur":new vi(it.paint_line["line-blur"]),"line-dasharray":new xl(it.paint_line["line-dasharray"]),"line-pattern":new vl(it.paint_line["line-pattern"]),"line-gradient":new td(it.paint_line["line-gradient"])})},get layout(){return _d=_d||new E({"line-cap":new oi(it.layout_line["line-cap"]),"line-join":new vi(it.layout_line["line-join"]),"line-miter-limit":new oi(it.layout_line["line-miter-limit"]),"line-round-limit":new oi(it.layout_line["line-round-limit"]),"line-sort-key":new vi(it.layout_line["line-sort-key"])})}};class cr extends vi{possiblyEvaluate(n,c){return c=new nn(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(n,c)}evaluate(n,c,m,x){return c=Re({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(n,c,m,x)}}let vh;class Cg extends h{constructor(n){super(n,Hl),this.gradientVersion=0,vh||(vh=new cr(Hl.paint.properties["line-width"].specification),vh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const c=this.gradientExpression();this.stepInterpolant=!!(function(m){return m._styleExpression!==void 0})(c)&&c._styleExpression.expression instanceof lo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,c){super.recalculate(n,c),this.paint._values["line-floorwidth"]=vh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new yd(n)}queryRadius(n){const c=n,m=Er(Iu("line-width",this,c),Iu("line-gap-width",this,c)),x=Iu("line-offset",this,c);return m/2+Math.abs(x)+uf(this.paint.get("line-translate"))}queryIntersectsFeature(n,c,m,x,k,C,j){const z=ad(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),C.angle,j),F=j/2*Er(this.paint.get("line-width").evaluate(c,m),this.paint.get("line-gap-width").evaluate(c,m)),q=this.paint.get("line-offset").evaluate(c,m);return q&&(x=(function(G,J){const ae=[];for(let ue=0;ue<G.length;ue++){const de=G[ue],Te=[];for(let Me=0;Me<de.length;Me++){const tt=de[Me-1],Be=de[Me],Ke=de[Me+1],yt=Me===0?new N(0,0):Be.sub(tt)._unit()._perp(),zt=Me===de.length-1?new N(0,0):Ke.sub(Be)._unit()._perp(),Kt=yt._add(zt)._unit(),bi=Kt.x*zt.x+Kt.y*zt.y;bi!==0&&Kt._mult(1/bi),Te.push(Kt._mult(J)._add(Be))}ae.push(Te)}return ae})(x,q*j)),(function(G,J,ae){for(let ue=0;ue<J.length;ue++){const de=J[ue];if(G.length>=3){for(let Te=0;Te<de.length;Te++)if(mc(G,de[Te]))return!0}if(sg(G,de,ae))return!0}return!1})(z,x,F)}isTileClipped(){return!0}}function Er(a,n){return n>0?n+2*a:a}const w_=R([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ag=R([{name:"a_projected_pos",components:3,type:"Float32"}],4);R([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Mg=R([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);R([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const As=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ja=R([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function vc(a,n,c){return a.sections.forEach((m=>{m.text=(function(x,k,C){const j=k.layout.get("text-transform").evaluate(C,{});return j==="uppercase"?x=x.toLocaleUpperCase():j==="lowercase"&&(x=x.toLocaleLowerCase()),tr.applyArabicShaping&&(x=tr.applyArabicShaping(x)),x})(m.text,n,c)})),a}R([{name:"triangle",components:3,type:"Uint16"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),R([{type:"Float32",name:"offsetX"}]),R([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),R([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const xh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ys=24,Gp=rn,Pg=function(a,n,c,m,x){var k,C,j=8*x-m-1,z=(1<<j)-1,F=z>>1,q=-7,G=x-1,J=-1,ae=a[n+G];for(G+=J,k=ae&(1<<-q)-1,ae>>=-q,q+=j;q>0;k=256*k+a[n+G],G+=J,q-=8);for(C=k&(1<<-q)-1,k>>=-q,q+=m;q>0;C=256*C+a[n+G],G+=J,q-=8);if(k===0)k=1-F;else{if(k===z)return C?NaN:1/0*(ae?-1:1);C+=Math.pow(2,m),k-=F}return(ae?-1:1)*C*Math.pow(2,k-m)},vd=function(a,n,c,m,x,k){var C,j,z,F=8*k-x-1,q=(1<<F)-1,G=q>>1,J=x===23?Math.pow(2,-24)-Math.pow(2,-77):0,ae=0,ue=1,de=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(j=isNaN(n)?1:0,C=q):(C=Math.floor(Math.log(n)/Math.LN2),n*(z=Math.pow(2,-C))<1&&(C--,z*=2),(n+=C+G>=1?J/z:J*Math.pow(2,1-G))*z>=2&&(C++,z/=2),C+G>=q?(j=0,C=q):C+G>=1?(j=(n*z-1)*Math.pow(2,x),C+=G):(j=n*Math.pow(2,G-1)*Math.pow(2,x),C=0));x>=8;a[c+ae]=255&j,ae+=ue,j/=256,x-=8);for(C=C<<x|j,F+=x;F>0;a[c+ae]=255&C,ae+=ue,C/=256,F-=8);a[c+ae-ue]|=128*de};function rn(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}rn.Varint=0,rn.Fixed64=1,rn.Bytes=2,rn.Fixed32=5;var xo=4294967296,Wp=1/xo,Pa=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Zl(a){return a.type===rn.Bytes?a.readVarint()+a.pos:a.pos+1}function Qa(a,n,c){return c?4294967296*n+(a>>>0):4294967296*(n>>>0)+(a>>>0)}function nu(a,n,c){var m=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));c.realloc(m);for(var x=c.pos-1;x>=a;x--)c.buf[x+m]=c.buf[x]}function xc(a,n){for(var c=0;c<a.length;c++)n.writeVarint(a[c])}function Yp(a,n){for(var c=0;c<a.length;c++)n.writeSVarint(a[c])}function Xp(a,n){for(var c=0;c<a.length;c++)n.writeFloat(a[c])}function wl(a,n){for(var c=0;c<a.length;c++)n.writeDouble(a[c])}function Ig(a,n){for(var c=0;c<a.length;c++)n.writeBoolean(a[c])}function bh(a,n){for(var c=0;c<a.length;c++)n.writeFixed32(a[c])}function xd(a,n){for(var c=0;c<a.length;c++)n.writeSFixed32(a[c])}function bd(a,n){for(var c=0;c<a.length;c++)n.writeFixed64(a[c])}function wh(a,n){for(var c=0;c<a.length;c++)n.writeSFixed64(a[c])}function wd(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+16777216*a[n+3]}function Du(a,n,c){a[c]=n,a[c+1]=n>>>8,a[c+2]=n>>>16,a[c+3]=n>>>24}function Sh(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+(a[n+3]<<24)}rn.prototype={destroy:function(){this.buf=null},readFields:function(a,n,c){for(c=c||this.length;this.pos<c;){var m=this.readVarint(),x=m>>3,k=this.pos;this.type=7&m,a(x,n,this),this.pos===k&&this.skip(m)}return n},readMessage:function(a,n){return this.readFields(a,n,this.readVarint()+this.pos)},readFixed32:function(){var a=wd(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Sh(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=wd(this.buf,this.pos)+wd(this.buf,this.pos+4)*xo;return this.pos+=8,a},readSFixed64:function(){var a=wd(this.buf,this.pos)+Sh(this.buf,this.pos+4)*xo;return this.pos+=8,a},readFloat:function(){var a=Pg(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Pg(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var n,c,m=this.buf;return n=127&(c=m[this.pos++]),c<128?n:(n|=(127&(c=m[this.pos++]))<<7,c<128?n:(n|=(127&(c=m[this.pos++]))<<14,c<128?n:(n|=(127&(c=m[this.pos++]))<<21,c<128?n:(function(x,k,C){var j,z,F=C.buf;if(j=(112&(z=F[C.pos++]))>>4,z<128||(j|=(127&(z=F[C.pos++]))<<3,z<128)||(j|=(127&(z=F[C.pos++]))<<10,z<128)||(j|=(127&(z=F[C.pos++]))<<17,z<128)||(j|=(127&(z=F[C.pos++]))<<24,z<128)||(j|=(1&(z=F[C.pos++]))<<31,z<128))return Qa(x,j,k);throw new Error("Expected varint not more than 10 bytes")})(n|=(15&(c=m[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,n=this.pos;return this.pos=a,a-n>=12&&Pa?(function(c,m,x){return Pa.decode(c.subarray(m,x))})(this.buf,n,a):(function(c,m,x){for(var k="",C=m;C<x;){var j,z,F,q=c[C],G=null,J=q>239?4:q>223?3:q>191?2:1;if(C+J>x)break;J===1?q<128&&(G=q):J===2?(192&(j=c[C+1]))==128&&(G=(31&q)<<6|63&j)<=127&&(G=null):J===3?(z=c[C+2],(192&(j=c[C+1]))==128&&(192&z)==128&&((G=(15&q)<<12|(63&j)<<6|63&z)<=2047||G>=55296&&G<=57343)&&(G=null)):J===4&&(z=c[C+2],F=c[C+3],(192&(j=c[C+1]))==128&&(192&z)==128&&(192&F)==128&&((G=(15&q)<<18|(63&j)<<12|(63&z)<<6|63&F)<=65535||G>=1114112)&&(G=null)),G===null?(G=65533,J=1):G>65535&&(G-=65536,k+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),k+=String.fromCharCode(G),C+=J}return k})(this.buf,n,a)},readBytes:function(){var a=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,a);return this.pos=a,n},readPackedVarint:function(a,n){if(this.type!==rn.Bytes)return a.push(this.readVarint(n));var c=Zl(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(n));return a},readPackedSVarint:function(a){if(this.type!==rn.Bytes)return a.push(this.readSVarint());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==rn.Bytes)return a.push(this.readBoolean());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==rn.Bytes)return a.push(this.readFloat());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==rn.Bytes)return a.push(this.readDouble());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==rn.Bytes)return a.push(this.readFixed32());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==rn.Bytes)return a.push(this.readSFixed32());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==rn.Bytes)return a.push(this.readFixed64());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==rn.Bytes)return a.push(this.readSFixed64());var n=Zl(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed64());return a},skip:function(a){var n=7&a;if(n===rn.Varint)for(;this.buf[this.pos++]>127;);else if(n===rn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===rn.Fixed32)this.pos+=4;else{if(n!==rn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(a,n){this.writeVarint(a<<3|n)},realloc:function(a){for(var n=this.length||16;n<this.pos+a;)n*=2;if(n!==this.length){var c=new Uint8Array(n);c.set(this.buf),this.buf=c,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Du(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Du(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Du(this.buf,-1&a,this.pos),Du(this.buf,Math.floor(a*Wp),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Du(this.buf,-1&a,this.pos),Du(this.buf,Math.floor(a*Wp),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?(function(n,c){var m,x;if(n>=0?(m=n%4294967296|0,x=n/4294967296|0):(x=~(-n/4294967296),4294967295^(m=~(-n%4294967296))?m=m+1|0:(m=0,x=x+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),(function(k,C,j){j.buf[j.pos++]=127&k|128,k>>>=7,j.buf[j.pos++]=127&k|128,k>>>=7,j.buf[j.pos++]=127&k|128,k>>>=7,j.buf[j.pos++]=127&k|128,j.buf[j.pos]=127&(k>>>=7)})(m,0,c),(function(k,C){var j=(7&k)<<4;C.buf[C.pos++]|=j|((k>>>=3)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k)))))})(x,c)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var n=this.pos;this.pos=(function(m,x,k){for(var C,j,z=0;z<x.length;z++){if((C=x.charCodeAt(z))>55295&&C<57344){if(!j){C>56319||z+1===x.length?(m[k++]=239,m[k++]=191,m[k++]=189):j=C;continue}if(C<56320){m[k++]=239,m[k++]=191,m[k++]=189,j=C;continue}C=j-55296<<10|C-56320|65536,j=null}else j&&(m[k++]=239,m[k++]=191,m[k++]=189,j=null);C<128?m[k++]=C:(C<2048?m[k++]=C>>6|192:(C<65536?m[k++]=C>>12|224:(m[k++]=C>>18|240,m[k++]=C>>12&63|128),m[k++]=C>>6&63|128),m[k++]=63&C|128)}return k})(this.buf,a,this.pos);var c=this.pos-n;c>=128&&nu(n,c,this),this.pos=n-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),vd(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),vd(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var n=a.length;this.writeVarint(n),this.realloc(n);for(var c=0;c<n;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,n){this.pos++;var c=this.pos;a(n,this);var m=this.pos-c;m>=128&&nu(c,m,this),this.pos=c-1,this.writeVarint(m),this.pos+=m},writeMessage:function(a,n,c){this.writeTag(a,rn.Bytes),this.writeRawMessage(n,c)},writePackedVarint:function(a,n){n.length&&this.writeMessage(a,xc,n)},writePackedSVarint:function(a,n){n.length&&this.writeMessage(a,Yp,n)},writePackedBoolean:function(a,n){n.length&&this.writeMessage(a,Ig,n)},writePackedFloat:function(a,n){n.length&&this.writeMessage(a,Xp,n)},writePackedDouble:function(a,n){n.length&&this.writeMessage(a,wl,n)},writePackedFixed32:function(a,n){n.length&&this.writeMessage(a,bh,n)},writePackedSFixed32:function(a,n){n.length&&this.writeMessage(a,xd,n)},writePackedFixed64:function(a,n){n.length&&this.writeMessage(a,bd,n)},writePackedSFixed64:function(a,n){n.length&&this.writeMessage(a,wh,n)},writeBytesField:function(a,n){this.writeTag(a,rn.Bytes),this.writeBytes(n)},writeFixed32Field:function(a,n){this.writeTag(a,rn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(a,n){this.writeTag(a,rn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(a,n){this.writeTag(a,rn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(a,n){this.writeTag(a,rn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(a,n){this.writeTag(a,rn.Varint),this.writeVarint(n)},writeSVarintField:function(a,n){this.writeTag(a,rn.Varint),this.writeSVarint(n)},writeStringField:function(a,n){this.writeTag(a,rn.Bytes),this.writeString(n)},writeFloatField:function(a,n){this.writeTag(a,rn.Fixed32),this.writeFloat(n)},writeDoubleField:function(a,n){this.writeTag(a,rn.Fixed64),this.writeDouble(n)},writeBooleanField:function(a,n){this.writeVarintField(a,!!n)}};var wf=A(Gp);const Th=3;function jg(a,n,c){a===1&&c.readMessage(S_,n)}function S_(a,n,c){if(a===3){const{id:m,bitmap:x,width:k,height:C,left:j,top:z,advance:F}=c.readMessage(T_,{});n.push({id:m,bitmap:new ld({width:k+2*Th,height:C+2*Th},x),metrics:{width:k,height:C,left:j,top:z,advance:F}})}}function T_(a,n,c){a===1?n.id=c.readVarint():a===2?n.bitmap=c.readBytes():a===3?n.width=c.readVarint():a===4?n.height=c.readVarint():a===5?n.left=c.readSVarint():a===6?n.top=c.readSVarint():a===7&&(n.advance=c.readVarint())}const Wn=Th;function ps(a){let n=0,c=0;for(const C of a)n+=C.w*C.h,c=Math.max(c,C.w);a.sort(((C,j)=>j.h-C.h));const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),c),h:1/0}];let x=0,k=0;for(const C of a)for(let j=m.length-1;j>=0;j--){const z=m[j];if(!(C.w>z.w||C.h>z.h)){if(C.x=z.x,C.y=z.y,k=Math.max(k,C.y+C.h),x=Math.max(x,C.x+C.w),C.w===z.w&&C.h===z.h){const F=m.pop();j<m.length&&(m[j]=F)}else C.h===z.h?(z.x+=C.w,z.w-=C.w):C.w===z.w?(z.y+=C.h,z.h-=C.h):(m.push({x:z.x+C.w,y:z.y,w:z.w-C.w,h:C.h}),z.y+=C.h,z.h-=C.h);break}}return{w:x,h:k,fill:n/(x*k)||0}}const zi=1;class kn{constructor(n,{pixelRatio:c,version:m,stretchX:x,stretchY:k,content:C,textFitWidth:j,textFitHeight:z}){this.paddedRect=n,this.pixelRatio=c,this.stretchX=x,this.stretchY=k,this.content=C,this.version=m,this.textFitWidth=j,this.textFitHeight=z}get tl(){return[this.paddedRect.x+zi,this.paddedRect.y+zi]}get br(){return[this.paddedRect.x+this.paddedRect.w-zi,this.paddedRect.y+this.paddedRect.h-zi]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*zi)/this.pixelRatio,(this.paddedRect.h-2*zi)/this.pixelRatio]}}class is{constructor(n,c){const m={},x={};this.haveRenderCallbacks=[];const k=[];this.addImages(n,m,k),this.addImages(c,x,k);const{w:C,h:j}=ps(k),z=new Ka({width:C||1,height:j||1});for(const F in n){const q=n[F],G=m[F].paddedRect;Ka.copy(q.data,z,{x:0,y:0},{x:G.x+zi,y:G.y+zi},q.data)}for(const F in c){const q=c[F],G=x[F].paddedRect,J=G.x+zi,ae=G.y+zi,ue=q.data.width,de=q.data.height;Ka.copy(q.data,z,{x:0,y:0},{x:J,y:ae},q.data),Ka.copy(q.data,z,{x:0,y:de-1},{x:J,y:ae-1},{width:ue,height:1}),Ka.copy(q.data,z,{x:0,y:0},{x:J,y:ae+de},{width:ue,height:1}),Ka.copy(q.data,z,{x:ue-1,y:0},{x:J-1,y:ae},{width:1,height:de}),Ka.copy(q.data,z,{x:0,y:0},{x:J+ue,y:ae},{width:1,height:de})}this.image=z,this.iconPositions=m,this.patternPositions=x}addImages(n,c,m){for(const x in n){const k=n[x],C={x:0,y:0,w:k.data.width+2*zi,h:k.data.height+2*zi};m.push(C),c[x]=new kn(C,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(n,c){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in n.updatedImages)this.patchUpdatedImage(this.iconPositions[m],n.getImage(m),c),this.patchUpdatedImage(this.patternPositions[m],n.getImage(m),c)}patchUpdatedImage(n,c,m){if(!n||!c||n.version===c.version)return;n.version=c.version;const[x,k]=n.tl;m.update(c.data,void 0,{x,y:k})}}var ur;Lt("ImagePosition",kn),Lt("ImageAtlas",is),y.ah=void 0,(ur=y.ah||(y.ah={}))[ur.none=0]="none",ur[ur.horizontal=1]="horizontal",ur[ur.vertical=2]="vertical",ur[ur.horizontalOnly=3]="horizontalOnly";const Uo=-17;class Gl{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,c){const m=new Gl;return m.scale=n||1,m.fontStack=c,m}static forImage(n){const c=new Gl;return c.imageName=n,c}}class su{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,c){const m=new su;for(let x=0;x<n.sections.length;x++){const k=n.sections[x];k.image?m.addImageSection(k):m.addTextSection(k,c)}return m}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=(function(n){let c="";for(let m=0;m<n.length;m++){const x=n.charCodeAt(m+1)||null,k=n.charCodeAt(m-1)||null;c+=x&&No(x)&&!xh[n[m+1]]||k&&No(k)&&!xh[n[m-1]]||!xh[n[m]]?n[m]:xh[n[m]]}return c})(this.text)}trim(){let n=0;for(let m=0;m<this.text.length&&Ms[this.text.charCodeAt(m)];m++)n++;let c=this.text.length;for(let m=this.text.length-1;m>=0&&m>=n&&Ms[this.text.charCodeAt(m)];m--)c--;this.text=this.text.substring(n,c),this.sectionIndex=this.sectionIndex.slice(n,c)}substring(n,c){const m=new su;return m.text=this.text.substring(n,c),m.sectionIndex=this.sectionIndex.slice(n,c),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((n,c)=>Math.max(n,this.sections[c].scale)),0)}addTextSection(n,c){this.text+=n.text,this.sections.push(Gl.forText(n.scale,n.fontStack||c));const m=this.sections.length-1;for(let x=0;x<n.text.length;++x)this.sectionIndex.push(m)}addImageSection(n){const c=n.image?n.image.name:"";if(c.length===0)return void Et("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(Gl.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Et("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Fo(a,n,c,m,x,k,C,j,z,F,q,G,J,ae,ue){const de=su.fromFeature(a,x);let Te;G===y.ah.vertical&&de.verticalizePunctuation();const{processBidirectionalText:Me,processStyledBidirectionalText:tt}=tr;if(Me&&de.sections.length===1){Te=[];const yt=Me(de.toString(),Sd(de,F,k,n,m,ae));for(const zt of yt){const Kt=new su;Kt.text=zt,Kt.sections=de.sections;for(let bi=0;bi<zt.length;bi++)Kt.sectionIndex.push(0);Te.push(Kt)}}else if(tt){Te=[];const yt=tt(de.text,de.sectionIndex,Sd(de,F,k,n,m,ae));for(const zt of yt){const Kt=new su;Kt.text=zt[0],Kt.sectionIndex=zt[1],Kt.sections=de.sections,Te.push(Kt)}}else Te=(function(yt,zt){const Kt=[],bi=yt.text;let Vt=0;for(const Wt of zt)Kt.push(yt.substring(Vt,Wt)),Vt=Wt;return Vt<bi.length&&Kt.push(yt.substring(Vt,bi.length)),Kt})(de,Sd(de,F,k,n,m,ae));const Be=[],Ke={positionedLines:Be,text:de.toString(),top:q[1],bottom:q[1],left:q[0],right:q[0],writingMode:G,iconsInText:!1,verticalizable:!1};return(function(yt,zt,Kt,bi,Vt,Wt,di,ai,ii,xt,si,hi){let Ci=0,Cn=Uo,Jn=0,dr=0;const ia=ai==="right"?1:ai==="left"?0:.5;let Cr=0;for(const Os of Vt){Os.trim();const pr=Os.getMaxScale(),na=(pr-1)*Ys,Ar={positionedGlyphs:[],lineOffset:0};yt.positionedLines[Cr]=Ar;const nr=Ar.positionedGlyphs;let Xs=0;if(!Os.length()){Cn+=Wt,++Cr;continue}for(let ja=0;ja<Os.length();ja++){const _n=Os.getSection(ja),Vn=Os.getSectionIndex(ja),ds=Os.getCharCode(ja);let sa=0,vs=null,hu=null,So=null,Tl=Ys;const To=!(ii===y.ah.horizontal||!si&&!Oo(ds)||si&&(Ms[ds]||(fr=ds,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(fr)))));if(_n.imageName){const Eo=bi[_n.imageName];if(!Eo)continue;So=_n.imageName,yt.iconsInText=yt.iconsInText||!0,hu=Eo.paddedRect;const mr=Eo.displaySize;_n.scale=_n.scale*Ys/hi,vs={width:mr[0],height:mr[1],left:zi,top:-Wn,advance:To?mr[1]:mr[0]},sa=na+(Ys-mr[1]*_n.scale),Tl=vs.advance;const wc=To?mr[0]*_n.scale-Ys*pr:mr[1]*_n.scale-Ys*pr;wc>0&&wc>Xs&&(Xs=wc)}else{const Eo=Kt[_n.fontStack],mr=Eo&&Eo[ds];if(mr&&mr.rect)hu=mr.rect,vs=mr.metrics;else{const wc=zt[_n.fontStack],Vu=wc&&wc[ds];if(!Vu)continue;vs=Vu.metrics}sa=(pr-_n.scale)*Ys}To?(yt.verticalizable=!0,nr.push({glyph:ds,imageName:So,x:Ci,y:Cn+sa,vertical:To,scale:_n.scale,fontStack:_n.fontStack,sectionIndex:Vn,metrics:vs,rect:hu}),Ci+=Tl*_n.scale+xt):(nr.push({glyph:ds,imageName:So,x:Ci,y:Cn+sa,vertical:To,scale:_n.scale,fontStack:_n.fontStack,sectionIndex:Vn,metrics:vs,rect:hu}),Ci+=vs.advance*_n.scale+xt)}nr.length!==0&&(Jn=Math.max(Ci-xt,Jn),Lg(nr,0,nr.length-1,ia,Xs)),Ci=0;const to=Wt*pr+Xs;Ar.lineOffset=Math.max(Xs,na),Cn+=to,dr=Math.max(to,dr),++Cr}var fr;const _a=Cn-Uo,{horizontalAlign:va,verticalAlign:xa}=Ch(di);(function(Os,pr,na,Ar,nr,Xs,to,ja,_n){const Vn=(pr-na)*nr;let ds=0;ds=Xs!==to?-ja*Ar-Uo:(-Ar*_n+.5)*to;for(const sa of Os)for(const vs of sa.positionedGlyphs)vs.x+=Vn,vs.y+=ds})(yt.positionedLines,ia,va,xa,Jn,dr,Wt,_a,Vt.length),yt.top+=-xa*_a,yt.bottom=yt.top+_a,yt.left+=-va*Jn,yt.right=yt.left+Jn})(Ke,n,c,m,Te,C,j,z,G,F,J,ue),!(function(yt){for(const zt of yt)if(zt.positionedGlyphs.length!==0)return!1;return!0})(Be)&&Ke}const Ms={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ru={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Ou={40:!0};function Sf(a,n,c,m,x,k){if(n.imageName){const C=m[n.imageName];return C?C.displaySize[0]*n.scale*Ys/k+x:0}{const C=c[n.fontStack],j=C&&C[a];return j?j.metrics.advance*n.scale+x:0}}function eo(a,n,c,m){const x=Math.pow(a-n,2);return m?a<n?x/2:2*x:x+Math.abs(c)*c}function Eh(a,n,c){let m=0;return a===10&&(m-=1e4),c&&(m+=150),a!==40&&a!==65288||(m+=50),n!==41&&n!==65289||(m+=50),m}function kh(a,n,c,m,x,k){let C=null,j=eo(n,c,x,k);for(const z of m){const F=eo(n-z.x,c,x,k)+z.badness;F<=j&&(C=z,j=F)}return{index:a,x:n,priorBreak:C,badness:j}}function Ia(a){return a?Ia(a.priorBreak).concat(a.index):[]}function Sd(a,n,c,m,x,k){if(!a)return[];const C=[],j=(function(G,J,ae,ue,de,Te){let Me=0;for(let tt=0;tt<G.length();tt++){const Be=G.getSection(tt);Me+=Sf(G.getCharCode(tt),Be,ue,de,J,Te)}return Me/Math.max(1,Math.ceil(Me/ae))})(a,n,c,m,x,k),z=a.text.indexOf("")>=0;let F=0;for(let G=0;G<a.length();G++){const J=a.getSection(G),ae=a.getCharCode(G);if(Ms[ae]||(F+=Sf(ae,J,m,x,n,k)),G<a.length()-1){const ue=!((q=ae)<11904)&&(!!Oi["CJK Compatibility Forms"](q)||!!Oi["CJK Compatibility"](q)||!!Oi["CJK Strokes"](q)||!!Oi["CJK Symbols and Punctuation"](q)||!!Oi["Enclosed CJK Letters and Months"](q)||!!Oi["Halfwidth and Fullwidth Forms"](q)||!!Oi["Ideographic Description Characters"](q)||!!Oi["Vertical Forms"](q)||Za.test(String.fromCodePoint(q)));(ru[ae]||ue||J.imageName||G!==a.length()-2&&Ou[a.getCharCode(G+1)])&&C.push(kh(G+1,F,j,C,Eh(ae,a.getCharCode(G+1),ue&&z),!1))}}var q;return Ia(kh(a.length(),F,j,C,0,!0))}function Ch(a){let n=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:n,verticalAlign:c}}function Lg(a,n,c,m,x){if(!m&&!x)return;const k=a[c],C=(a[c].x+k.metrics.advance*k.scale)*m;for(let j=n;j<=c;j++)a[j].x-=C,a[j].y+=x}function Tf(a,n,c){const{horizontalAlign:m,verticalAlign:x}=Ch(c),k=n[0]-a.displaySize[0]*m,C=n[1]-a.displaySize[1]*x;return{image:a,top:C,bottom:C+a.displaySize[1],left:k,right:k+a.displaySize[0]}}function Td(a){var n,c;let m=a.left,x=a.top,k=a.right-m,C=a.bottom-x;const j=(n=a.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",z=(c=a.image.textFitHeight)!==null&&c!==void 0?c:"stretchOrShrink",F=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(z==="proportional"){if(j==="stretchOnly"&&k/C<F||j==="proportional"){const q=Math.ceil(C*F);m*=q/k,k=q}}else if(j==="proportional"&&z==="stretchOnly"&&F!==0&&k/C>F){const q=Math.ceil(k/F);x*=q/C,C=q}return{x1:m,y1:x,x2:m+k,y2:x+C}}function bc(a,n,c,m,x,k){const C=a.image;let j;if(C.content){const Te=C.content,Me=C.pixelRatio||1;j=[Te[0]/Me,Te[1]/Me,C.displaySize[0]-Te[2]/Me,C.displaySize[1]-Te[3]/Me]}const z=n.left*k,F=n.right*k;let q,G,J,ae;c==="width"||c==="both"?(ae=x[0]+z-m[3],G=x[0]+F+m[1]):(ae=x[0]+(z+F-C.displaySize[0])/2,G=ae+C.displaySize[0]);const ue=n.top*k,de=n.bottom*k;return c==="height"||c==="both"?(q=x[1]+ue-m[0],J=x[1]+de+m[2]):(q=x[1]+(ue+de-C.displaySize[1])/2,J=q+C.displaySize[1]),{image:C,top:q,right:G,bottom:J,left:ae,collisionPadding:j}}const Fs=255,ta=128,bo=Fs*ta;function Wl(a,n){const{expression:c}=n;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new nn(a+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:x}=c;let k=0;for(;k<m.length&&m[k]<=a;)k++;k=Math.max(0,k-1);let C=k;for(;C<m.length&&m[C]<a+1;)C++;C=Math.min(m.length-1,C);const j=m[k],z=m[C];return c.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:z,interpolationType:x}:{kind:"camera",minZoom:j,maxZoom:z,minSize:c.evaluate(new nn(j)),maxSize:c.evaluate(new nn(z)),interpolationType:x}}}function Ed(a,n,c){let m="never";const x=a.get(n);return x?m=x:a.get(c)&&(m="always"),m}const Kp=yc.VectorTileFeature.types,Rg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function au(a,n,c,m,x,k,C,j,z,F,q,G,J){const ae=j?Math.min(bo,Math.round(j[0])):0,ue=j?Math.min(bo,Math.round(j[1])):0;a.emplaceBack(n,c,Math.round(32*m),Math.round(32*x),k,C,(ae<<1)+(z?1:0),ue,16*F,16*q,256*G,256*J)}function kd(a,n,c){a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c)}function wo(a){for(const n of a.sections)if(oh(n.text))return!0;return!1}class Ef{constructor(n){this.layoutVertexArray=new hc,this.indexArray=new ma,this.programConfigurations=n,this.segments=new sn,this.dynamicLayoutVertexArray=new vo,this.opacityVertexArray=new Pi,this.hasVisibleVertices=!1,this.placedSymbolArray=new Gn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,c,m,x){this.isEmpty()||(m&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,w_.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Ag.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,Rg,!0),this.opacityVertexBuffer.itemSize=1),(m||x)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Lt("SymbolBuffers",Ef);class ga{constructor(n,c,m){this.layoutVertexArray=new n,this.layoutAttributes=c,this.indexArray=new m,this.segments=new sn,this.collisionVertexArray=new us}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Mg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Lt("CollisionBuffers",ga);class Nu{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((C=>C.id)),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=hf([]),this.placementViewportMatrix=hf([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Wl(this.zoom,c["text-size"]),this.iconSizeData=Wl(this.zoom,c["icon-size"]);const m=this.layers[0].layout,x=m.get("symbol-sort-key"),k=m.get("symbol-z-order");this.canOverlap=Ed(m,"text-overlap","text-allow-overlap")!=="never"||Ed(m,"icon-overlap","icon-allow-overlap")!=="never"||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!x.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map((C=>y.ah[C]))),this.stateDependentLayerIds=this.layers.filter((C=>C.isStateDependent())).map((C=>C.id)),this.sourceID=n.sourceID}createArrays(){this.text=new Ef(new Xc(this.layers,this.zoom,(n=>/^text/.test(n)))),this.icon=new Ef(new Xc(this.layers,this.zoom,(n=>/^icon/.test(n)))),this.glyphOffsetArray=new Fn,this.lineVertexArray=new ir,this.symbolInstances=new dn,this.textAnchorOffsets=new ts}calculateGlyphDependencies(n,c,m,x,k){for(let C=0;C<n.length;C++)if(c[n.charCodeAt(C)]=!0,(m||x)&&k){const j=xh[n.charAt(C)];j&&(c[j.charCodeAt(0)]=!0)}}populate(n,c,m){const x=this.layers[0],k=x.layout,C=k.get("text-font"),j=k.get("text-field"),z=k.get("icon-image"),F=(j.value.kind!=="constant"||j.value.value instanceof en&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),q=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,G=k.get("symbol-sort-key");if(this.features=[],!F&&!q)return;const J=c.iconDependencies,ae=c.glyphDependencies,ue=c.availableImages,de=new nn(this.zoom);for(const{feature:Te,id:Me,index:tt,sourceLayerIndex:Be}of n){const Ke=x._featureFilter.needGeometry,yt=Jc(Te,Ke);if(!x._featureFilter.filter(de,yt,m))continue;let zt,Kt;if(Ke||(yt.geometry=Kc(Te)),F){const Vt=x.getValueAndResolveTokens("text-field",yt,m,ue),Wt=en.factory(Vt),di=this.hasRTLText=this.hasRTLText||wo(Wt);(!di||tr.getRTLTextPluginStatus()==="unavailable"||di&&tr.isParsed())&&(zt=vc(Wt,x,yt))}if(q){const Vt=x.getValueAndResolveTokens("icon-image",yt,m,ue);Kt=Vt instanceof Is?Vt:Is.fromString(Vt)}if(!zt&&!Kt)continue;const bi=this.sortFeaturesByKey?G.evaluate(yt,{},m):void 0;if(this.features.push({id:Me,text:zt,icon:Kt,index:tt,sourceLayerIndex:Be,geometry:yt.geometry,properties:Te.properties,type:Kp[Te.type],sortKey:bi}),Kt&&(J[Kt.name]=!0),zt){const Vt=C.evaluate(yt,{},m).join(","),Wt=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ah.vertical)>=0;for(const di of zt.sections)if(di.image)J[di.image.name]=!0;else{const ai=yo(zt.toString()),ii=di.fontStack||Vt,xt=ae[ii]=ae[ii]||{};this.calculateGlyphDependencies(di.text,xt,Wt,this.allowVerticalPlacement,ai)}}}k.get("symbol-placement")==="line"&&(this.features=(function(Te){const Me={},tt={},Be=[];let Ke=0;function yt(Vt){Be.push(Te[Vt]),Ke++}function zt(Vt,Wt,di){const ai=tt[Vt];return delete tt[Vt],tt[Wt]=ai,Be[ai].geometry[0].pop(),Be[ai].geometry[0]=Be[ai].geometry[0].concat(di[0]),ai}function Kt(Vt,Wt,di){const ai=Me[Wt];return delete Me[Wt],Me[Vt]=ai,Be[ai].geometry[0].shift(),Be[ai].geometry[0]=di[0].concat(Be[ai].geometry[0]),ai}function bi(Vt,Wt,di){const ai=di?Wt[0][Wt[0].length-1]:Wt[0][0];return`${Vt}:${ai.x}:${ai.y}`}for(let Vt=0;Vt<Te.length;Vt++){const Wt=Te[Vt],di=Wt.geometry,ai=Wt.text?Wt.text.toString():null;if(!ai){yt(Vt);continue}const ii=bi(ai,di),xt=bi(ai,di,!0);if(ii in tt&&xt in Me&&tt[ii]!==Me[xt]){const si=Kt(ii,xt,di),hi=zt(ii,xt,Be[si].geometry);delete Me[ii],delete tt[xt],tt[bi(ai,Be[hi].geometry,!0)]=hi,Be[si].geometry=null}else ii in tt?zt(ii,xt,di):xt in Me?Kt(ii,xt,di):(yt(Vt),Me[ii]=Ke-1,tt[xt]=Ke-1)}return Be.filter((Vt=>Vt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Te,Me)=>Te.sortKey-Me.sortKey))}update(n,c,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,c,this.layers,m),this.icon.programConfigurations.updatePaintArrays(n,c,this.layers,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,c){const m=this.lineVertexArray.length;if(n.segment!==void 0){let x=n.dist(c[n.segment+1]),k=n.dist(c[n.segment]);const C={};for(let j=n.segment+1;j<c.length;j++)C[j]={x:c[j].x,y:c[j].y,tileUnitDistanceFromAnchor:x},j<c.length-1&&(x+=c[j+1].dist(c[j]));for(let j=n.segment||0;j>=0;j--)C[j]={x:c[j].x,y:c[j].y,tileUnitDistanceFromAnchor:k},j>0&&(k+=c[j-1].dist(c[j]));for(let j=0;j<c.length;j++){const z=C[j];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(n,c,m,x,k,C,j,z,F,q,G,J){const ae=n.indexArray,ue=n.layoutVertexArray,de=n.segments.prepareSegment(4*c.length,ue,ae,this.canOverlap?C.sortKey:void 0),Te=this.glyphOffsetArray.length,Me=de.vertexLength,tt=this.allowVerticalPlacement&&j===y.ah.vertical?Math.PI/2:0,Be=C.text&&C.text.sections;for(let Ke=0;Ke<c.length;Ke++){const{tl:yt,tr:zt,bl:Kt,br:bi,tex:Vt,pixelOffsetTL:Wt,pixelOffsetBR:di,minFontScaleX:ai,minFontScaleY:ii,glyphOffset:xt,isSDF:si,sectionIndex:hi}=c[Ke],Ci=de.vertexLength,Cn=xt[1];au(ue,z.x,z.y,yt.x,Cn+yt.y,Vt.x,Vt.y,m,si,Wt.x,Wt.y,ai,ii),au(ue,z.x,z.y,zt.x,Cn+zt.y,Vt.x+Vt.w,Vt.y,m,si,di.x,Wt.y,ai,ii),au(ue,z.x,z.y,Kt.x,Cn+Kt.y,Vt.x,Vt.y+Vt.h,m,si,Wt.x,di.y,ai,ii),au(ue,z.x,z.y,bi.x,Cn+bi.y,Vt.x+Vt.w,Vt.y+Vt.h,m,si,di.x,di.y,ai,ii),kd(n.dynamicLayoutVertexArray,z,tt),ae.emplaceBack(Ci,Ci+1,Ci+2),ae.emplaceBack(Ci+1,Ci+2,Ci+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(xt[0]),Ke!==c.length-1&&hi===c[Ke+1].sectionIndex||n.programConfigurations.populatePaintArrays(ue.length,C,C.index,{},J,Be&&Be[hi])}n.placedSymbolArray.emplaceBack(z.x,z.y,Te,this.glyphOffsetArray.length-Te,Me,F,q,z.segment,m?m[0]:0,m?m[1]:0,x[0],x[1],j,0,!1,0,G)}_addCollisionDebugVertex(n,c,m,x,k,C){return c.emplaceBack(0,0),n.emplaceBack(m.x,m.y,x,k,Math.round(C.x),Math.round(C.y))}addCollisionDebugVertices(n,c,m,x,k,C,j){const z=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),F=z.vertexLength,q=k.layoutVertexArray,G=k.collisionVertexArray,J=j.anchorX,ae=j.anchorY;this._addCollisionDebugVertex(q,G,C,J,ae,new N(n,c)),this._addCollisionDebugVertex(q,G,C,J,ae,new N(m,c)),this._addCollisionDebugVertex(q,G,C,J,ae,new N(m,x)),this._addCollisionDebugVertex(q,G,C,J,ae,new N(n,x)),z.vertexLength+=4;const ue=k.indexArray;ue.emplaceBack(F,F+1),ue.emplaceBack(F+1,F+2),ue.emplaceBack(F+2,F+3),ue.emplaceBack(F+3,F),z.primitiveLength+=4}addDebugCollisionBoxes(n,c,m,x){for(let k=n;k<c;k++){const C=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,x?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,m)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ga(yn,As.members,zs),this.iconCollisionBox=new ga(yn,As.members,zs);for(let n=0;n<this.symbolInstances.length;n++){const c=this.symbolInstances.get(n);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(n,c,m,x,k,C,j,z,F){const q={};for(let G=c;G<m;G++){const J=n.get(G);q.textBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.textFeatureIndex=J.featureIndex;break}for(let G=x;G<k;G++){const J=n.get(G);q.verticalTextBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.verticalTextFeatureIndex=J.featureIndex;break}for(let G=C;G<j;G++){const J=n.get(G);q.iconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.iconFeatureIndex=J.featureIndex;break}for(let G=z;G<F;G++){const J=n.get(G);q.verticalIconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.verticalIconFeatureIndex=J.featureIndex;break}return q}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const m=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,c){const m=n.placedSymbolArray.get(c),x=m.vertexStartIndex+4*m.numGlyphs;for(let k=m.vertexStartIndex;k<x;k+=4)n.indexArray.emplaceBack(k,k+1,k+2),n.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(n),m=Math.cos(n),x=[],k=[],C=[];for(let j=0;j<this.symbolInstances.length;++j){C.push(j);const z=this.symbolInstances.get(j);x.push(0|Math.round(c*z.anchorX+m*z.anchorY)),k.push(z.featureIndex)}return C.sort(((j,z)=>x[j]-x[z]||k[z]-k[j])),C}addToSortKeyRanges(n,c){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===c?m.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const m=this.symbolInstances.get(c);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach(((x,k,C)=>{x>=0&&C.indexOf(x)===k&&this.addIndicesForPlacedSymbol(this.text,x)})),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Jp,zg;Lt("SymbolBucket",Nu,{omit:["layers","collisionBoxArray","features","compareText"]}),Nu.MAX_GLYPHS=65535,Nu.addDynamicAttributes=kd;var Yl={get paint(){return zg=zg||new E({"icon-opacity":new vi(it.paint_symbol["icon-opacity"]),"icon-color":new vi(it.paint_symbol["icon-color"]),"icon-halo-color":new vi(it.paint_symbol["icon-halo-color"]),"icon-halo-width":new vi(it.paint_symbol["icon-halo-width"]),"icon-halo-blur":new vi(it.paint_symbol["icon-halo-blur"]),"icon-translate":new oi(it.paint_symbol["icon-translate"]),"icon-translate-anchor":new oi(it.paint_symbol["icon-translate-anchor"]),"text-opacity":new vi(it.paint_symbol["text-opacity"]),"text-color":new vi(it.paint_symbol["text-color"],{runtimeType:Bi,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new vi(it.paint_symbol["text-halo-color"]),"text-halo-width":new vi(it.paint_symbol["text-halo-width"]),"text-halo-blur":new vi(it.paint_symbol["text-halo-blur"]),"text-translate":new oi(it.paint_symbol["text-translate"]),"text-translate-anchor":new oi(it.paint_symbol["text-translate-anchor"])})},get layout(){return Jp=Jp||new E({"symbol-placement":new oi(it.layout_symbol["symbol-placement"]),"symbol-spacing":new oi(it.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new oi(it.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new vi(it.layout_symbol["symbol-sort-key"]),"symbol-z-order":new oi(it.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new oi(it.layout_symbol["icon-allow-overlap"]),"icon-overlap":new oi(it.layout_symbol["icon-overlap"]),"icon-ignore-placement":new oi(it.layout_symbol["icon-ignore-placement"]),"icon-optional":new oi(it.layout_symbol["icon-optional"]),"icon-rotation-alignment":new oi(it.layout_symbol["icon-rotation-alignment"]),"icon-size":new vi(it.layout_symbol["icon-size"]),"icon-text-fit":new oi(it.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new oi(it.layout_symbol["icon-text-fit-padding"]),"icon-image":new vi(it.layout_symbol["icon-image"]),"icon-rotate":new vi(it.layout_symbol["icon-rotate"]),"icon-padding":new vi(it.layout_symbol["icon-padding"]),"icon-keep-upright":new oi(it.layout_symbol["icon-keep-upright"]),"icon-offset":new vi(it.layout_symbol["icon-offset"]),"icon-anchor":new vi(it.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new oi(it.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new oi(it.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new oi(it.layout_symbol["text-rotation-alignment"]),"text-field":new vi(it.layout_symbol["text-field"]),"text-font":new vi(it.layout_symbol["text-font"]),"text-size":new vi(it.layout_symbol["text-size"]),"text-max-width":new vi(it.layout_symbol["text-max-width"]),"text-line-height":new oi(it.layout_symbol["text-line-height"]),"text-letter-spacing":new vi(it.layout_symbol["text-letter-spacing"]),"text-justify":new vi(it.layout_symbol["text-justify"]),"text-radial-offset":new vi(it.layout_symbol["text-radial-offset"]),"text-variable-anchor":new oi(it.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new vi(it.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new vi(it.layout_symbol["text-anchor"]),"text-max-angle":new oi(it.layout_symbol["text-max-angle"]),"text-writing-mode":new oi(it.layout_symbol["text-writing-mode"]),"text-rotate":new vi(it.layout_symbol["text-rotate"]),"text-padding":new oi(it.layout_symbol["text-padding"]),"text-keep-upright":new oi(it.layout_symbol["text-keep-upright"]),"text-transform":new vi(it.layout_symbol["text-transform"]),"text-offset":new vi(it.layout_symbol["text-offset"]),"text-allow-overlap":new oi(it.layout_symbol["text-allow-overlap"]),"text-overlap":new oi(it.layout_symbol["text-overlap"]),"text-ignore-placement":new oi(it.layout_symbol["text-ignore-placement"]),"text-optional":new oi(it.layout_symbol["text-optional"])})}};class Cd{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Zn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(n.formattedSection))return c.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Lt("FormatSectionOverride",Cd,{omit:["defaultValue"]});class Ah extends h{constructor(n){super(n,Yl)}recalculate(n,c){if(super.recalculate(n,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const m=this.layout.get("text-writing-mode");if(m){const x=[];for(const k of m)x.indexOf(k)<0&&x.push(k);this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,c,m,x){const k=this.layout.get(n).evaluate(c,{},m,x),C=this._unevaluatedLayout._values[n];return C.isDataDriven()||mo(C.value)||!k?k:(function(j,z){return z.replace(/{([^{}]+)}/g,((F,q)=>j&&q in j?String(j[q]):""))})(c.properties,k)}createBucket(n){return new Nu(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Yl.paint.overridableProperties){if(!Ah.hasPaintOverride(this.layout,n))continue;const c=this.paint.get(n),m=new Cd(c),x=new Lo(m,c.property.specification);let k=null;k=c.value.kind==="constant"||c.value.kind==="source"?new Wr("source",x):new Ca("composite",x,c.value.zoomStops),this.paint._values[n]=new Ga(c.property,k,c.parameters)}}_handleOverridablePaintPropertyUpdate(n,c,m){return!(!this.layout||c.isDataDriven()||m.isDataDriven())&&Ah.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,c){const m=n.get("text-field"),x=Yl.paint.properties[c];let k=!1;const C=j=>{for(const z of j)if(x.overrides&&x.overrides.hasOverride(z))return void(k=!0)};if(m.value.kind==="constant"&&m.value.value instanceof en)C(m.value.value.sections);else if(m.value.kind==="source"){const j=F=>{k||(F instanceof bs&&yi(F.value)===Dn?C(F.value.sections):F instanceof Mo?C(F.sections):F.eachChild(j))},z=m.value;z._styleExpression&&j(z._styleExpression.expression)}return k}}let Bu;var Dg={get paint(){return Bu=Bu||new E({"background-color":new oi(it.paint_background["background-color"]),"background-pattern":new xl(it.paint_background["background-pattern"]),"background-opacity":new oi(it.paint_background["background-opacity"])})}};class Og extends h{constructor(n){super(n,Dg)}}let Qp;var Ng={get paint(){return Qp=Qp||new E({"raster-opacity":new oi(it.paint_raster["raster-opacity"]),"raster-hue-rotate":new oi(it.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new oi(it.paint_raster["raster-brightness-min"]),"raster-brightness-max":new oi(it.paint_raster["raster-brightness-max"]),"raster-saturation":new oi(it.paint_raster["raster-saturation"]),"raster-contrast":new oi(it.paint_raster["raster-contrast"]),"raster-resampling":new oi(it.paint_raster["raster-resampling"]),"raster-fade-duration":new oi(it.paint_raster["raster-fade-duration"])})}};class kf extends h{constructor(n){super(n,Ng)}}class em extends h{constructor(n){super(n,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class E_{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const tm=63710088e-1;class ou{constructor(n,c){if(isNaN(n)||isNaN(c))throw new Error(`Invalid LngLat object: (${n}, ${c})`);if(this.lng=+n,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ou(ke(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const c=Math.PI/180,m=this.lat*c,x=n.lat*c,k=Math.sin(m)*Math.sin(x)+Math.cos(m)*Math.cos(x)*Math.cos((n.lng-this.lng)*c);return tm*Math.acos(Math.min(k,1))}static convert(n){if(n instanceof ou)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new ou(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new ou(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const im=2*Math.PI*tm;function nm(a){return im*Math.cos(a*Math.PI/180)}function $u(a){return(180+a)/360}function Ad(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function sm(a,n){return a/nm(n)}function Cf(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class Mh{constructor(n,c,m=0){this.x=+n,this.y=+c,this.z=+m}static fromLngLat(n,c=0){const m=ou.convert(n);return new Mh($u(m.lng),Ad(m.lat),sm(c,m.lat))}toLngLat(){return new ou(360*this.x-180,Cf(this.y))}toAltitude(){return this.z*nm(Cf(this.y))}meterInMercatorCoordinateUnits(){return 1/im*(n=Cf(this.y),1/Math.cos(n*Math.PI/180));var n}}function rm(a,n,c){var m=2*Math.PI*6378137/256/Math.pow(2,c);return[a*m-2*Math.PI*6378137/2,n*m-2*Math.PI*6378137/2]}class Af{constructor(n,c,m){if(!(function(x,k,C){return!(x<0||x>25||C<0||C>=Math.pow(2,x)||k<0||k>=Math.pow(2,x))})(n,c,m))throw new Error(`x=${c}, y=${m}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=c,this.y=m,this.key=Ph(0,n,n,c,m)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,c,m){const x=(C=this.y,j=this.z,z=rm(256*(k=this.x),256*(C=Math.pow(2,j)-C-1),j),F=rm(256*(k+1),256*(C+1),j),z[0]+","+z[1]+","+F[0]+","+F[1]);var k,C,j,z,F;const q=(function(G,J,ae){let ue,de="";for(let Te=G;Te>0;Te--)ue=1<<Te-1,de+=(J&ue?1:0)+(ae&ue?2:0);return de})(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(m==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,q).replace(/{bbox-epsg-3857}/g,x)}isChildOf(n){const c=this.z-n.z;return c>0&&n.x===this.x>>c&&n.y===this.y>>c}getTilePoint(n){const c=Math.pow(2,this.z);return new N((n.x*c-this.x)*$s,(n.y*c-this.y)*$s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class am{constructor(n,c){this.wrap=n,this.canonical=c,this.key=Ph(n,c.z,c.z,c.x,c.y)}}class ya{constructor(n,c,m,x,k){if(n<m)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${m}`);this.overscaledZ=n,this.wrap=c,this.canonical=new Af(m,+x,+k),this.key=Ph(c,n,m,x,k)}clone(){return new ya(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-n;return n>this.canonical.z?new ya(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ya(n,this.wrap,n,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(n,c){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const m=this.canonical.z-n;return n>this.canonical.z?Ph(this.wrap*+c,n,this.canonical.z,this.canonical.x,this.canonical.y):Ph(this.wrap*+c,n,n,this.canonical.x>>m,this.canonical.y>>m)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const c=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>c&&n.canonical.y===this.canonical.y>>c}children(n){if(this.overscaledZ>=n)return[new ya(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,m=2*this.canonical.x,x=2*this.canonical.y;return[new ya(c,this.wrap,c,m,x),new ya(c,this.wrap,c,m+1,x),new ya(c,this.wrap,c,m,x+1),new ya(c,this.wrap,c,m+1,x+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new ya(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new ya(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new am(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Mh(n.x-this.wrap,n.y))}}function Ph(a,n,c,m,x){(a*=2)<0&&(a=-1*a-1);const k=1<<c;return(k*k*a+k*x+m).toString(36)+c.toString(36)+n.toString(36)}Lt("CanonicalTileID",Af),Lt("OverscaledTileID",ya,{omit:["posMatrix"]});class om{constructor(n,c,m,x=1,k=1,C=1,j=0){if(this.uid=n,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(m&&!["mapbox","terrarium","custom"].includes(m))return void Et(`"${m}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=c.height;const z=this.dim=c.height-2;switch(this.data=new Uint32Array(c.data.buffer),m){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=x,this.greenFactor=k,this.blueFactor=C,this.baseShift=j;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let F=0;F<z;F++)this.data[this._idx(-1,F)]=this.data[this._idx(0,F)],this.data[this._idx(z,F)]=this.data[this._idx(z-1,F)],this.data[this._idx(F,-1)]=this.data[this._idx(F,0)],this.data[this._idx(F,z)]=this.data[this._idx(F,z-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(z,-1)]=this.data[this._idx(z-1,0)],this.data[this._idx(-1,z)]=this.data[this._idx(0,z-1)],this.data[this._idx(z,z)]=this.data[this._idx(z-1,z-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let F=0;F<z;F++)for(let q=0;q<z;q++){const G=this.get(F,q);G>this.max&&(this.max=G),G<this.min&&(this.min=G)}}get(n,c){const m=new Uint8Array(this.data.buffer),x=4*this._idx(n,c);return this.unpack(m[x],m[x+1],m[x+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,c){if(n<-1||n>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(n+1)}unpack(n,c,m){return n*this.redFactor+c*this.greenFactor+m*this.blueFactor-this.baseShift}getPixels(){return new Ka({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,c,m){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let x=c*this.dim,k=c*this.dim+this.dim,C=m*this.dim,j=m*this.dim+this.dim;switch(c){case-1:x=k-1;break;case 1:k=x+1}switch(m){case-1:C=j-1;break;case 1:j=C+1}const z=-c*this.dim,F=-m*this.dim;for(let q=C;q<j;q++)for(let G=x;G<k;G++)this.data[this._idx(G,q)]=n.data[this._idx(G+z,q+F)]}}Lt("DEMData",om);class ns{constructor(n){this._stringToNumber={},this._numberToString=[];for(let c=0;c<n.length;c++){const m=n[c];this._stringToNumber[m]=c,this._numberToString[c]=m}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class Mf{constructor(n,c,m,x,k){this.type="Feature",this._vectorTileFeature=n,n._z=c,n._x=m,n._y=x,this.properties=n.properties,this.id=k}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const c in this)c!=="_geometry"&&c!=="_vectorTileFeature"&&(n[c]=this[c]);return n}}class Bg{constructor(n,c){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new bn($s,16,0),this.grid3D=new bn($s,16,0),this.featureIndexArray=new ls,this.promoteId=c}insert(n,c,m,x,k,C){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,x,k);const z=C?this.grid3D:this.grid;for(let F=0;F<c.length;F++){const q=c[F],G=[1/0,1/0,-1/0,-1/0];for(let J=0;J<q.length;J++){const ae=q[J];G[0]=Math.min(G[0],ae.x),G[1]=Math.min(G[1],ae.y),G[2]=Math.max(G[2],ae.x),G[3]=Math.max(G[3],ae.y)}G[0]<$s&&G[1]<$s&&G[2]>=0&&G[3]>=0&&z.insert(j,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new yc.VectorTile(new wf(this.rawTileData)).layers,this.sourceLayerCoder=new ns(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,c,m,x){this.loadVTLayers();const k=n.params||{},C=$s/n.tileSize/n.scale,j=hl(k.filter),z=n.queryGeometry,F=n.queryPadding*C,q=$g(z),G=this.grid.query(q.minX-F,q.minY-F,q.maxX+F,q.maxY+F),J=$g(n.cameraQueryGeometry),ae=this.grid3D.query(J.minX-F,J.minY-F,J.maxX+F,J.maxY+F,((Te,Me,tt,Be)=>(function(Ke,yt,zt,Kt,bi){for(const Wt of Ke)if(yt<=Wt.x&&zt<=Wt.y&&Kt>=Wt.x&&bi>=Wt.y)return!0;const Vt=[new N(yt,zt),new N(yt,bi),new N(Kt,bi),new N(Kt,zt)];if(Ke.length>2){for(const Wt of Vt)if(mc(Ke,Wt))return!0}for(let Wt=0;Wt<Ke.length-1;Wt++)if(ag(Ke[Wt],Ke[Wt+1],Vt))return!0;return!1})(n.cameraQueryGeometry,Te-F,Me-F,tt+F,Be+F)));for(const Te of ae)G.push(Te);G.sort(k_);const ue={};let de;for(let Te=0;Te<G.length;Te++){const Me=G[Te];if(Me===de)continue;de=Me;const tt=this.featureIndexArray.get(Me);let Be=null;this.loadMatchingFeature(ue,tt.bucketIndex,tt.sourceLayerIndex,tt.featureIndex,j,k.layers,k.availableImages,c,m,x,((Ke,yt,zt)=>(Be||(Be=Kc(Ke)),yt.queryIntersectsFeature(z,Ke,zt,Be,this.z,n.transform,C,n.pixelPosMatrix))))}return ue}loadMatchingFeature(n,c,m,x,k,C,j,z,F,q,G){const J=this.bucketLayerIDs[c];if(C&&!(function(Te,Me){for(let tt=0;tt<Te.length;tt++)if(Me.indexOf(Te[tt])>=0)return!0;return!1})(C,J))return;const ae=this.sourceLayerCoder.decode(m),ue=this.vtLayers[ae].feature(x);if(k.needGeometry){const Te=Jc(ue,!0);if(!k.filter(new nn(this.tileID.overscaledZ),Te,this.tileID.canonical))return}else if(!k.filter(new nn(this.tileID.overscaledZ),ue))return;const de=this.getId(ue,ae);for(let Te=0;Te<J.length;Te++){const Me=J[Te];if(C&&C.indexOf(Me)<0)continue;const tt=z[Me];if(!tt)continue;let Be={};de&&q&&(Be=q.getState(tt.sourceLayer||"_geojsonTileLayer",de));const Ke=Re({},F[Me]);Ke.paint=lm(Ke.paint,tt.paint,ue,Be,j),Ke.layout=lm(Ke.layout,tt.layout,ue,Be,j);const yt=!G||G(ue,tt,Be);if(!yt)continue;const zt=new Mf(ue,this.z,this.x,this.y,de);zt.layer=Ke;let Kt=n[Me];Kt===void 0&&(Kt=n[Me]=[]),Kt.push({featureIndex:x,feature:zt,intersectionZ:yt})}}lookupSymbolFeatures(n,c,m,x,k,C,j,z){const F={};this.loadVTLayers();const q=hl(k);for(const G of n)this.loadMatchingFeature(F,m,x,G,q,C,j,z,c);return F}hasLayer(n){for(const c of this.bucketLayerIDs)for(const m of c)if(n===m)return!0;return!1}getId(n,c){let m=n.id;return this.promoteId&&(m=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[c]],typeof m=="boolean"&&(m=Number(m))),m}}function lm(a,n,c,m,x){return He(a,((k,C)=>{const j=n instanceof _l?n.get(C):null;return j&&j.evaluate?j.evaluate(c,m,x):j}))}function $g(a){let n=1/0,c=1/0,m=-1/0,x=-1/0;for(const k of a)n=Math.min(n,k.x),c=Math.min(c,k.y),m=Math.max(m,k.x),x=Math.max(x,k.y);return{minX:n,minY:c,maxX:m,maxY:x}}function k_(a,n){return n-a}function Ug(a,n,c,m,x){const k=[];for(let C=0;C<a.length;C++){const j=a[C];let z;for(let F=0;F<j.length-1;F++){let q=j[F],G=j[F+1];q.x<n&&G.x<n||(q.x<n?q=new N(n,q.y+(n-q.x)/(G.x-q.x)*(G.y-q.y))._round():G.x<n&&(G=new N(n,q.y+(n-q.x)/(G.x-q.x)*(G.y-q.y))._round()),q.y<c&&G.y<c||(q.y<c?q=new N(q.x+(c-q.y)/(G.y-q.y)*(G.x-q.x),c)._round():G.y<c&&(G=new N(q.x+(c-q.y)/(G.y-q.y)*(G.x-q.x),c)._round()),q.x>=m&&G.x>=m||(q.x>=m?q=new N(m,q.y+(m-q.x)/(G.x-q.x)*(G.y-q.y))._round():G.x>=m&&(G=new N(m,q.y+(m-q.x)/(G.x-q.x)*(G.y-q.y))._round()),q.y>=x&&G.y>=x||(q.y>=x?q=new N(q.x+(x-q.y)/(G.y-q.y)*(G.x-q.x),x)._round():G.y>=x&&(G=new N(q.x+(x-q.y)/(G.y-q.y)*(G.x-q.x),x)._round()),z&&q.equals(z[z.length-1])||(z=[q],k.push(z)),z.push(G)))))}}return k}Lt("FeatureIndex",Bg,{omit:["rawTileData","sourceLayerCoder"]});class Sl extends N{constructor(n,c,m,x){super(n,c),this.angle=m,x!==void 0&&(this.segment=x)}clone(){return new Sl(this.x,this.y,this.angle,this.segment)}}function Uu(a,n,c,m,x){if(n.segment===void 0||c===0)return!0;let k=n,C=n.segment+1,j=0;for(;j>-c/2;){if(C--,C<0)return!1;j-=a[C].dist(k),k=a[C]}j+=a[C].dist(a[C+1]),C++;const z=[];let F=0;for(;j<c/2;){const q=a[C],G=a[C+1];if(!G)return!1;let J=a[C-1].angleTo(q)-q.angleTo(G);for(J=Math.abs((J+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:j,angleDelta:J}),F+=J;j-z[0].distance>m;)F-=z.shift().angleDelta;if(F>x)return!1;C++,j+=q.dist(G)}return!0}function Pf(a){let n=0;for(let c=0;c<a.length-1;c++)n+=a[c].dist(a[c+1]);return n}function Md(a,n,c){return a?.6*n*c:0}function If(a,n){return Math.max(a?a.right-a.left:0,n?n.right-n.left:0)}function lu(a,n,c,m,x,k){const C=Md(c,x,k),j=If(c,m)*k;let z=0;const F=Pf(a)/2;for(let q=0;q<a.length-1;q++){const G=a[q],J=a[q+1],ae=G.dist(J);if(z+ae>F){const ue=(F-z)/ae,de=Hs.number(G.x,J.x,ue),Te=Hs.number(G.y,J.y,ue),Me=new Sl(de,Te,J.angleTo(G),q);return Me._round(),!C||Uu(a,Me,j,C,n)?Me:void 0}z+=ae}}function Xl(a,n,c,m,x,k,C,j,z){const F=Md(m,k,C),q=If(m,x),G=q*C,J=a[0].x===0||a[0].x===z||a[0].y===0||a[0].y===z;return n-G<n/4&&(n=G+n/4),Ih(a,J?n/2*j%n:(q/2+2*k)*C*j%n,n,F,c,G,J,!1,z)}function Ih(a,n,c,m,x,k,C,j,z){const F=k/2,q=Pf(a);let G=0,J=n-c,ae=[];for(let ue=0;ue<a.length-1;ue++){const de=a[ue],Te=a[ue+1],Me=de.dist(Te),tt=Te.angleTo(de);for(;J+c<G+Me;){J+=c;const Be=(J-G)/Me,Ke=Hs.number(de.x,Te.x,Be),yt=Hs.number(de.y,Te.y,Be);if(Ke>=0&&Ke<z&&yt>=0&&yt<z&&J-F>=0&&J+F<=q){const zt=new Sl(Ke,yt,tt,ue);zt._round(),m&&!Uu(a,zt,k,m,x)||ae.push(zt)}}G+=Me}return j||ae.length||C||(ae=Ih(a,G/2,c,m,x,k,C,!0,z)),ae}Lt("Anchor",Sl);const jh=zi;function cm(a,n,c,m){const x=[],k=a.image,C=k.pixelRatio,j=k.paddedRect.w-2*jh,z=k.paddedRect.h-2*jh;let F={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const q=k.stretchX||[[0,j]],G=k.stretchY||[[0,z]],J=(xt,si)=>xt+si[1]-si[0],ae=q.reduce(J,0),ue=G.reduce(J,0),de=j-ae,Te=z-ue;let Me=0,tt=ae,Be=0,Ke=ue,yt=0,zt=de,Kt=0,bi=Te;if(k.content&&m){const xt=k.content,si=xt[2]-xt[0],hi=xt[3]-xt[1];(k.textFitWidth||k.textFitHeight)&&(F=Td(a)),Me=Pd(q,0,xt[0]),Be=Pd(G,0,xt[1]),tt=Pd(q,xt[0],xt[2]),Ke=Pd(G,xt[1],xt[3]),yt=xt[0]-Me,Kt=xt[1]-Be,zt=si-tt,bi=hi-Ke}const Vt=F.x1,Wt=F.y1,di=F.x2-Vt,ai=F.y2-Wt,ii=(xt,si,hi,Ci)=>{const Cn=Id(xt.stretch-Me,tt,di,Vt),Jn=jf(xt.fixed-yt,zt,xt.stretch,ae),dr=Id(si.stretch-Be,Ke,ai,Wt),ia=jf(si.fixed-Kt,bi,si.stretch,ue),Cr=Id(hi.stretch-Me,tt,di,Vt),fr=jf(hi.fixed-yt,zt,hi.stretch,ae),_a=Id(Ci.stretch-Be,Ke,ai,Wt),va=jf(Ci.fixed-Kt,bi,Ci.stretch,ue),xa=new N(Cn,dr),Os=new N(Cr,dr),pr=new N(Cr,_a),na=new N(Cn,_a),Ar=new N(Jn/C,ia/C),nr=new N(fr/C,va/C),Xs=n*Math.PI/180;if(Xs){const _n=Math.sin(Xs),Vn=Math.cos(Xs),ds=[Vn,-_n,_n,Vn];xa._matMult(ds),Os._matMult(ds),na._matMult(ds),pr._matMult(ds)}const to=xt.stretch+xt.fixed,ja=si.stretch+si.fixed;return{tl:xa,tr:Os,bl:na,br:pr,tex:{x:k.paddedRect.x+jh+to,y:k.paddedRect.y+jh+ja,w:hi.stretch+hi.fixed-to,h:Ci.stretch+Ci.fixed-ja},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ar,pixelOffsetBR:nr,minFontScaleX:zt/C/di,minFontScaleY:bi/C/ai,isSDF:c}};if(m&&(k.stretchX||k.stretchY)){const xt=um(q,de,ae),si=um(G,Te,ue);for(let hi=0;hi<xt.length-1;hi++){const Ci=xt[hi],Cn=xt[hi+1];for(let Jn=0;Jn<si.length-1;Jn++)x.push(ii(Ci,si[Jn],Cn,si[Jn+1]))}}else x.push(ii({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:z+1}));return x}function Pd(a,n,c){let m=0;for(const x of a)m+=Math.max(n,Math.min(c,x[1]))-Math.max(n,Math.min(c,x[0]));return m}function um(a,n,c){const m=[{fixed:-jh,stretch:0}];for(const[x,k]of a){const C=m[m.length-1];m.push({fixed:x-C.stretch,stretch:C.stretch}),m.push({fixed:x-C.stretch,stretch:C.stretch+(k-x)})}return m.push({fixed:n+jh,stretch:c}),m}function Id(a,n,c,m){return a/n*c+m}function jf(a,n,c,m){return a-n*c/m}class Lh{constructor(n,c,m,x,k,C,j,z,F,q){var G;if(this.boxStartIndex=n.length,F){let J=C.top,ae=C.bottom;const ue=C.collisionPadding;ue&&(J-=ue[1],ae+=ue[3]);let de=ae-J;de>0&&(de=Math.max(10,de),this.circleDiameter=de)}else{const J=!((G=C.image)===null||G===void 0)&&G.content&&(C.image.textFitWidth||C.image.textFitHeight)?Td(C):{x1:C.left,y1:C.top,x2:C.right,y2:C.bottom};J.y1=J.y1*j-z[0],J.y2=J.y2*j+z[2],J.x1=J.x1*j-z[3],J.x2=J.x2*j+z[1];const ae=C.collisionPadding;if(ae&&(J.x1-=ae[0]*j,J.y1-=ae[1]*j,J.x2+=ae[2]*j,J.y2+=ae[3]*j),q){const ue=new N(J.x1,J.y1),de=new N(J.x2,J.y1),Te=new N(J.x1,J.y2),Me=new N(J.x2,J.y2),tt=q*Math.PI/180;ue._rotate(tt),de._rotate(tt),Te._rotate(tt),Me._rotate(tt),J.x1=Math.min(ue.x,de.x,Te.x,Me.x),J.x2=Math.max(ue.x,de.x,Te.x,Me.x),J.y1=Math.min(ue.y,de.y,Te.y,Me.y),J.y2=Math.max(ue.y,de.y,Te.y,Me.y)}n.emplaceBack(c.x,c.y,J.x1,J.y1,J.x2,J.y2,m,x,k)}this.boxEndIndex=n.length}}class Fg{constructor(n=[],c=((m,x)=>m<x?-1:m>x?1:0)){if(this.data=n,this.length=this.data.length,this.compare=c,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:c,compare:m}=this,x=c[n];for(;n>0;){const k=n-1>>1,C=c[k];if(m(x,C)>=0)break;c[n]=C,n=k}c[n]=x}_down(n){const{data:c,compare:m}=this,x=this.length>>1,k=c[n];for(;n<x;){let C=1+(n<<1);const j=C+1;if(j<this.length&&m(c[j],c[C])<0&&(C=j),m(c[C],k)>=0)break;c[n]=c[C],n=C}c[n]=k}}function Vg(a,n=1,c=!1){let m=1/0,x=1/0,k=-1/0,C=-1/0;const j=a[0];for(let ae=0;ae<j.length;ae++){const ue=j[ae];(!ae||ue.x<m)&&(m=ue.x),(!ae||ue.y<x)&&(x=ue.y),(!ae||ue.x>k)&&(k=ue.x),(!ae||ue.y>C)&&(C=ue.y)}const z=Math.min(k-m,C-x);let F=z/2;const q=new Fg([],C_);if(z===0)return new N(m,x);for(let ae=m;ae<k;ae+=z)for(let ue=x;ue<C;ue+=z)q.push(new cu(ae+F,ue+F,F,a));let G=(function(ae){let ue=0,de=0,Te=0;const Me=ae[0];for(let tt=0,Be=Me.length,Ke=Be-1;tt<Be;Ke=tt++){const yt=Me[tt],zt=Me[Ke],Kt=yt.x*zt.y-zt.x*yt.y;de+=(yt.x+zt.x)*Kt,Te+=(yt.y+zt.y)*Kt,ue+=3*Kt}return new cu(de/ue,Te/ue,0,ae)})(a),J=q.length;for(;q.length;){const ae=q.pop();(ae.d>G.d||!G.d)&&(G=ae,c&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,J)),ae.max-G.d<=n||(F=ae.h/2,q.push(new cu(ae.p.x-F,ae.p.y-F,F,a)),q.push(new cu(ae.p.x+F,ae.p.y-F,F,a)),q.push(new cu(ae.p.x-F,ae.p.y+F,F,a)),q.push(new cu(ae.p.x+F,ae.p.y+F,F,a)),J+=4)}return c&&(console.log(`num probes: ${J}`),console.log(`best distance: ${G.d}`)),G.p}function C_(a,n){return n.max-a.max}function cu(a,n,c,m){this.p=new N(a,n),this.h=c,this.d=(function(x,k){let C=!1,j=1/0;for(let z=0;z<k.length;z++){const F=k[z];for(let q=0,G=F.length,J=G-1;q<G;J=q++){const ae=F[q],ue=F[J];ae.y>x.y!=ue.y>x.y&&x.x<(ue.x-ae.x)*(x.y-ae.y)/(ue.y-ae.y)+ae.x&&(C=!C),j=Math.min(j,Sp(x,ae,ue))}}return(C?1:-1)*Math.sqrt(j)})(this.p,m),this.max=this.d+this.h*Math.SQRT2}var hr;y.aq=void 0,(hr=y.aq||(y.aq={}))[hr.center=1]="center",hr[hr.left=2]="left",hr[hr.right=3]="right",hr[hr.top=4]="top",hr[hr.bottom=5]="bottom",hr[hr["top-left"]=6]="top-left",hr[hr["top-right"]=7]="top-right",hr[hr["bottom-left"]=8]="bottom-left",hr[hr["bottom-right"]=9]="bottom-right";const uu=7,hm=Number.POSITIVE_INFINITY;function Rh(a,n){return n[1]!==hm?(function(c,m,x){let k=0,C=0;switch(m=Math.abs(m),x=Math.abs(x),c){case"top-right":case"top-left":case"top":C=x-uu;break;case"bottom-right":case"bottom-left":case"bottom":C=-x+uu}switch(c){case"top-right":case"bottom-right":case"right":k=-m;break;case"top-left":case"bottom-left":case"left":k=m}return[k,C]})(a,n[0],n[1]):(function(c,m){let x=0,k=0;m<0&&(m=0);const C=m/Math.SQRT2;switch(c){case"top-right":case"top-left":k=C-uu;break;case"bottom-right":case"bottom-left":k=-C+uu;break;case"bottom":k=-m+uu;break;case"top":k=m-uu}switch(c){case"top-right":case"bottom-right":x=-C;break;case"top-left":case"bottom-left":x=C;break;case"left":x=m;break;case"right":x=-m}return[x,k]})(a,n[0])}function qg(a,n,c){var m;const x=a.layout,k=(m=x.get("text-variable-anchor-offset"))===null||m===void 0?void 0:m.evaluate(n,{},c);if(k){const j=k.values,z=[];for(let F=0;F<j.length;F+=2){const q=z[F]=j[F],G=j[F+1].map((J=>J*Ys));q.startsWith("top")?G[1]-=uu:q.startsWith("bottom")&&(G[1]+=uu),z[F+1]=G}return new On(z)}const C=x.get("text-variable-anchor");if(C){let j;j=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[x.get("text-radial-offset").evaluate(n,{},c)*Ys,hm]:x.get("text-offset").evaluate(n,{},c).map((F=>F*Ys));const z=[];for(const F of C)z.push(F,Rh(F,j));return new On(z)}return null}function Lf(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mn(a,n,c,m,x,k,C,j,z,F,q){let G=k.textMaxSize.evaluate(n,{});G===void 0&&(G=C);const J=a.layers[0].layout,ae=J.get("icon-offset").evaluate(n,{},q),ue=jd(c.horizontal),de=C/24,Te=a.tilePixelRatio*de,Me=a.tilePixelRatio*G/24,tt=a.tilePixelRatio*j,Be=a.tilePixelRatio*J.get("symbol-spacing"),Ke=J.get("text-padding")*a.tilePixelRatio,yt=(function(xt,si,hi,Ci=1){const Cn=xt.get("icon-padding").evaluate(si,{},hi),Jn=Cn&&Cn.values;return[Jn[0]*Ci,Jn[1]*Ci,Jn[2]*Ci,Jn[3]*Ci]})(J,n,q,a.tilePixelRatio),zt=J.get("text-max-angle")/180*Math.PI,Kt=J.get("text-rotation-alignment")!=="viewport"&&J.get("symbol-placement")!=="point",bi=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",Vt=J.get("symbol-placement"),Wt=Be/2,di=J.get("icon-text-fit");let ai;m&&di!=="none"&&(a.allowVerticalPlacement&&c.vertical&&(ai=bc(m,c.vertical,di,J.get("icon-text-fit-padding"),ae,de)),ue&&(m=bc(m,ue,di,J.get("icon-text-fit-padding"),ae,de)));const ii=(xt,si)=>{si.x<0||si.x>=$s||si.y<0||si.y>=$s||(function(hi,Ci,Cn,Jn,dr,ia,Cr,fr,_a,va,xa,Os,pr,na,Ar,nr,Xs,to,ja,_n,Vn,ds,sa,vs,hu){const So=hi.addToLineVertexArray(Ci,Cn);let Tl,To,Eo,mr,wc=0,Vu=0,Zg=0,Nd=0,Dh=-1,Oh=-1;const Sc={};let Nh=Zc("");if(hi.allowVerticalPlacement&&Jn.vertical){const Br=fr.layout.get("text-rotate").evaluate(Vn,{},vs)+90;Eo=new Lh(_a,Ci,va,xa,Os,Jn.vertical,pr,na,Ar,Br),Cr&&(mr=new Lh(_a,Ci,va,xa,Os,Cr,Xs,to,Ar,Br))}if(dr){const Br=fr.layout.get("icon-rotate").evaluate(Vn,{}),La=fr.layout.get("icon-text-fit")!=="none",io=cm(dr,Br,sa,La),$r=Cr?cm(Cr,Br,sa,La):void 0;To=new Lh(_a,Ci,va,xa,Os,dr,Xs,to,!1,Br),wc=4*io.length;const no=hi.iconSizeData;let so=null;no.kind==="source"?(so=[ta*fr.layout.get("icon-size").evaluate(Vn,{})],so[0]>bo&&Et(`${hi.layerIds[0]}: Value for "icon-size" is >= ${Fs}. Reduce your "icon-size".`)):no.kind==="composite"&&(so=[ta*ds.compositeIconSizes[0].evaluate(Vn,{},vs),ta*ds.compositeIconSizes[1].evaluate(Vn,{},vs)],(so[0]>bo||so[1]>bo)&&Et(`${hi.layerIds[0]}: Value for "icon-size" is >= ${Fs}. Reduce your "icon-size".`)),hi.addSymbols(hi.icon,io,so,_n,ja,Vn,y.ah.none,Ci,So.lineStartIndex,So.lineLength,-1,vs),Dh=hi.icon.placedSymbolArray.length-1,$r&&(Vu=4*$r.length,hi.addSymbols(hi.icon,$r,so,_n,ja,Vn,y.ah.vertical,Ci,So.lineStartIndex,So.lineLength,-1,vs),Oh=hi.icon.placedSymbolArray.length-1)}const Gg=Object.keys(Jn.horizontal);for(const Br of Gg){const La=Jn.horizontal[Br];if(!Tl){Nh=Zc(La.text);const $r=fr.layout.get("text-rotate").evaluate(Vn,{},vs);Tl=new Lh(_a,Ci,va,xa,Os,La,pr,na,Ar,$r)}const io=La.positionedLines.length===1;if(Zg+=Rf(hi,Ci,La,ia,fr,Ar,Vn,nr,So,Jn.vertical?y.ah.horizontal:y.ah.horizontalOnly,io?Gg:[Br],Sc,Dh,ds,vs),io)break}Jn.vertical&&(Nd+=Rf(hi,Ci,Jn.vertical,ia,fr,Ar,Vn,nr,So,y.ah.vertical,["vertical"],Sc,Oh,ds,vs));const Wg=Tl?Tl.boxStartIndex:hi.collisionBoxArray.length,Yg=Tl?Tl.boxEndIndex:hi.collisionBoxArray.length,Xg=Eo?Eo.boxStartIndex:hi.collisionBoxArray.length,Kg=Eo?Eo.boxEndIndex:hi.collisionBoxArray.length,mm=To?To.boxStartIndex:hi.collisionBoxArray.length,Jg=To?To.boxEndIndex:hi.collisionBoxArray.length,Qg=mr?mr.boxStartIndex:hi.collisionBoxArray.length,Df=mr?mr.boxEndIndex:hi.collisionBoxArray.length;let El=-1;const Of=(Br,La)=>Br&&Br.circleDiameter?Math.max(Br.circleDiameter,La):La;El=Of(Tl,El),El=Of(Eo,El),El=Of(To,El),El=Of(mr,El);const Nf=El>-1?1:0;Nf&&(El*=hu/Ys),hi.glyphOffsetArray.length>=Nu.MAX_GLYPHS&&Et("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Vn.sortKey!==void 0&&hi.addToSortKeyRanges(hi.symbolInstances.length,Vn.sortKey);const gm=qg(fr,Vn,vs),[Bf,ym]=(function(Br,La){const io=Br.length,$r=La?.values;if($r?.length>0)for(let no=0;no<$r.length;no+=2){const so=$r[no+1];Br.emplaceBack(y.aq[$r[no]],so[0],so[1])}return[io,Br.length]})(hi.textAnchorOffsets,gm);hi.symbolInstances.emplaceBack(Ci.x,Ci.y,Sc.right>=0?Sc.right:-1,Sc.center>=0?Sc.center:-1,Sc.left>=0?Sc.left:-1,Sc.vertical||-1,Dh,Oh,Nh,Wg,Yg,Xg,Kg,mm,Jg,Qg,Df,va,Zg,Nd,wc,Vu,Nf,0,pr,El,Bf,ym)})(a,si,xt,c,m,x,ai,a.layers[0],a.collisionBoxArray,n.index,n.sourceLayerIndex,a.index,Te,[Ke,Ke,Ke,Ke],Kt,z,tt,yt,bi,ae,n,k,F,q,C)};if(Vt==="line")for(const xt of Ug(n.geometry,0,0,$s,$s)){const si=Xl(xt,Be,zt,c.vertical||ue,m,24,Me,a.overscaling,$s);for(const hi of si)ue&&dm(a,ue.text,Wt,hi)||ii(xt,hi)}else if(Vt==="line-center"){for(const xt of n.geometry)if(xt.length>1){const si=lu(xt,zt,c.vertical||ue,m,24,Me);si&&ii(xt,si)}}else if(n.type==="Polygon")for(const xt of tc(n.geometry,0)){const si=Vg(xt,16);ii(xt[0],new Sl(si.x,si.y,0))}else if(n.type==="LineString")for(const xt of n.geometry)ii(xt,new Sl(xt[0].x,xt[0].y,0));else if(n.type==="Point")for(const xt of n.geometry)for(const si of xt)ii([si],new Sl(si.x,si.y,0))}function Rf(a,n,c,m,x,k,C,j,z,F,q,G,J,ae,ue){const de=(function(tt,Be,Ke,yt,zt,Kt,bi,Vt){const Wt=yt.layout.get("text-rotate").evaluate(Kt,{})*Math.PI/180,di=[];for(const ai of Be.positionedLines)for(const ii of ai.positionedGlyphs){if(!ii.rect)continue;const xt=ii.rect||{};let si=Wn+1,hi=!0,Ci=1,Cn=0;const Jn=(zt||Vt)&&ii.vertical,dr=ii.metrics.advance*ii.scale/2;if(Vt&&Be.verticalizable&&(Cn=ai.lineOffset/2-(ii.imageName?-(Ys-ii.metrics.width*ii.scale)/2:(ii.scale-1)*Ys)),ii.imageName){const _n=bi[ii.imageName];hi=_n.sdf,Ci=_n.pixelRatio,si=zi/Ci}const ia=zt?[ii.x+dr,ii.y]:[0,0];let Cr=zt?[0,0]:[ii.x+dr+Ke[0],ii.y+Ke[1]-Cn],fr=[0,0];Jn&&(fr=Cr,Cr=[0,0]);const _a=ii.metrics.isDoubleResolution?2:1,va=(ii.metrics.left-si)*ii.scale-dr+Cr[0],xa=(-ii.metrics.top-si)*ii.scale+Cr[1],Os=va+xt.w/_a*ii.scale/Ci,pr=xa+xt.h/_a*ii.scale/Ci,na=new N(va,xa),Ar=new N(Os,xa),nr=new N(va,pr),Xs=new N(Os,pr);if(Jn){const _n=new N(-dr,dr-Uo),Vn=-Math.PI/2,ds=Ys/2-dr,sa=new N(5-Uo-ds,-(ii.imageName?ds:0)),vs=new N(...fr);na._rotateAround(Vn,_n)._add(sa)._add(vs),Ar._rotateAround(Vn,_n)._add(sa)._add(vs),nr._rotateAround(Vn,_n)._add(sa)._add(vs),Xs._rotateAround(Vn,_n)._add(sa)._add(vs)}if(Wt){const _n=Math.sin(Wt),Vn=Math.cos(Wt),ds=[Vn,-_n,_n,Vn];na._matMult(ds),Ar._matMult(ds),nr._matMult(ds),Xs._matMult(ds)}const to=new N(0,0),ja=new N(0,0);di.push({tl:na,tr:Ar,bl:nr,br:Xs,tex:xt,writingMode:Be.writingMode,glyphOffset:ia,sectionIndex:ii.sectionIndex,isSDF:hi,pixelOffsetTL:to,pixelOffsetBR:ja,minFontScaleX:0,minFontScaleY:0})}return di})(0,c,j,x,k,C,m,a.allowVerticalPlacement),Te=a.textSizeData;let Me=null;Te.kind==="source"?(Me=[ta*x.layout.get("text-size").evaluate(C,{})],Me[0]>bo&&Et(`${a.layerIds[0]}: Value for "text-size" is >= ${Fs}. Reduce your "text-size".`)):Te.kind==="composite"&&(Me=[ta*ae.compositeTextSizes[0].evaluate(C,{},ue),ta*ae.compositeTextSizes[1].evaluate(C,{},ue)],(Me[0]>bo||Me[1]>bo)&&Et(`${a.layerIds[0]}: Value for "text-size" is >= ${Fs}. Reduce your "text-size".`)),a.addSymbols(a.text,de,Me,j,k,C,F,n,z.lineStartIndex,z.lineLength,J,ue);for(const tt of q)G[tt]=a.text.placedSymbolArray.length-1;return 4*de.length}function jd(a){for(const n in a)return a[n];return null}function dm(a,n,c,m){const x=a.compareText;if(n in x){const k=x[n];for(let C=k.length-1;C>=0;C--)if(m.dist(k[C])<c)return!0}else x[n]=[];return x[n].push(m),!1}const fm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ld{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,m]=new Uint8Array(n,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const x=m>>4;if(x!==1)throw new Error(`Got v${x} data when expected v1.`);const k=fm[15&m];if(!k)throw new Error("Unrecognized array type.");const[C]=new Uint16Array(n,2,1),[j]=new Uint32Array(n,4,1);return new Ld(j,C,k,n)}constructor(n,c=64,m=Float64Array,x){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=m,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const k=fm.indexOf(this.ArrayType),C=2*n*this.ArrayType.BYTES_PER_ELEMENT,j=n*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-j%8)%8;if(k<0)throw new Error(`Unexpected typed array class: ${m}.`);x&&x instanceof ArrayBuffer?(this.data=x,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+j+z,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+C+j+z),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+j+z,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+k]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=n)}add(n,c){const m=this._pos>>1;return this.ids[m]=m,this.coords[this._pos++]=n,this.coords[this._pos++]=c,m}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Fu(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,c,m,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:k,coords:C,nodeSize:j}=this,z=[0,k.length-1,0],F=[];for(;z.length;){const q=z.pop()||0,G=z.pop()||0,J=z.pop()||0;if(G-J<=j){for(let Te=J;Te<=G;Te++){const Me=C[2*Te],tt=C[2*Te+1];Me>=n&&Me<=m&&tt>=c&&tt<=x&&F.push(k[Te])}continue}const ae=J+G>>1,ue=C[2*ae],de=C[2*ae+1];ue>=n&&ue<=m&&de>=c&&de<=x&&F.push(k[ae]),(q===0?n<=ue:c<=de)&&(z.push(J),z.push(ae-1),z.push(1-q)),(q===0?m>=ue:x>=de)&&(z.push(ae+1),z.push(G),z.push(1-q))}return F}within(n,c,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:k,nodeSize:C}=this,j=[0,x.length-1,0],z=[],F=m*m;for(;j.length;){const q=j.pop()||0,G=j.pop()||0,J=j.pop()||0;if(G-J<=C){for(let Te=J;Te<=G;Te++)Hg(k[2*Te],k[2*Te+1],n,c)<=F&&z.push(x[Te]);continue}const ae=J+G>>1,ue=k[2*ae],de=k[2*ae+1];Hg(ue,de,n,c)<=F&&z.push(x[ae]),(q===0?n-m<=ue:c-m<=de)&&(j.push(J),j.push(ae-1),j.push(1-q)),(q===0?n+m>=ue:c+m>=de)&&(j.push(ae+1),j.push(G),j.push(1-q))}return z}}function Fu(a,n,c,m,x,k){if(x-m<=c)return;const C=m+x>>1;Rd(a,n,C,m,x,k),Fu(a,n,c,m,C-1,1-k),Fu(a,n,c,C+1,x,1-k)}function Rd(a,n,c,m,x,k){for(;x>m;){if(x-m>600){const F=x-m+1,q=c-m+1,G=Math.log(F),J=.5*Math.exp(2*G/3),ae=.5*Math.sqrt(G*J*(F-J)/F)*(q-F/2<0?-1:1);Rd(a,n,c,Math.max(m,Math.floor(c-q*J/F+ae)),Math.min(x,Math.floor(c+(F-q)*J/F+ae)),k)}const C=n[2*c+k];let j=m,z=x;for(zd(a,n,m,c),n[2*x+k]>C&&zd(a,n,m,x);j<z;){for(zd(a,n,j,z),j++,z--;n[2*j+k]<C;)j++;for(;n[2*z+k]>C;)z--}n[2*m+k]===C?zd(a,n,m,z):(z++,zd(a,n,z,x)),z<=c&&(m=z+1),c<=z&&(x=z-1)}}function zd(a,n,c,m){zf(a,c,m),zf(n,2*c,2*m),zf(n,2*c+1,2*m+1)}function zf(a,n,c){const m=a[n];a[n]=a[c],a[c]=m}function Hg(a,n,c,m){const x=a-c,k=n-m;return x*x+k*k}var pm;y.bg=void 0,(pm=y.bg||(y.bg={})).create="create",pm.load="load",pm.fullLoad="fullLoad";let Dd=null,zh=[];const ss=1e3/60,Od="loadTime",kr="fullLoadTime",A_={mark(a){performance.mark(a)},frame(a){const n=a;Dd!=null&&zh.push(n-Dd),Dd=n},clearMetrics(){Dd=null,zh=[],performance.clearMeasures(Od),performance.clearMeasures(kr);for(const a in y.bg)performance.clearMarks(y.bg[a])},getPerformanceMetrics(){performance.measure(Od,y.bg.create,y.bg.load),performance.measure(kr,y.bg.create,y.bg.fullLoad);const a=performance.getEntriesByName(Od)[0].duration,n=performance.getEntriesByName(kr)[0].duration,c=zh.length,m=1/(zh.reduce(((k,C)=>k+C),0)/c/1e3),x=zh.filter((k=>k>ss)).reduce(((k,C)=>k+(C-ss)/ss),0);return{loadTime:a,fullLoadTime:n,fps:m,percentDroppedFrames:x/(c+x)*100,totalFrames:c}}};y.$=class extends Y{},y.A=eu,y.B=un,y.C=function(a){if($e==null){const n=a.navigator?a.navigator.userAgent:null;$e=!!a.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return $e},y.D=oi,y.E=zn,y.F=class{constructor(a,n){this.target=a,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new E_((()=>this.process())),this.subscription=(function(c,m,x,k){return c.addEventListener(m,x,!1),{unsubscribe:()=>{c.removeEventListener(m,x,!1)}}})(this.target,"message",(c=>this.receive(c))),this.globalScope=pt(self)?a:window}registerMessageHandler(a,n){this.messageHandlers[a]=n}sendAsync(a,n){return new Promise(((c,m)=>{const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[x]={resolve:c,reject:m},n&&n.signal.addEventListener("abort",(()=>{delete this.resolveRejects[x];const j={id:x,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(j)}),{once:!0});const k=[],C=Object.assign(Object.assign({},a),{id:x,sourceMapId:this.mapId,origin:location.origin,data:Jr(a.data,k)});this.target.postMessage(C,{transfer:k})}))}receive(a){const n=a.data,c=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[c];const m=this.abortControllers[c];return delete this.abortControllers[c],void(m&&m.abort())}if(pt(self)||n.mustQueue)return this.tasks[c]=n,this.taskQueue.push(c),void this.invoker.trigger();this.processTask(c,n)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),n=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(a,n)}processTask(a,n){return d(this,void 0,void 0,(function*(){if(n.type==="<response>"){const x=this.resolveRejects[a];return delete this.resolveRejects[a],x?void(n.error?x.reject(Do(n.error)):x.resolve(Do(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const c=Do(n.data),m=new AbortController;this.abortControllers[a]=m;try{const x=yield this.messageHandlers[n.type](n.sourceMapId,c,m);this.completeTask(a,null,x)}catch(x){this.completeTask(a,x)}}))}completeTask(a,n,c){const m=[];delete this.abortControllers[a];const x={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?Jr(n):null,data:Jr(c,m)};this.target.postMessage(x,{transfer:m})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.G=kt,y.H=function(){var a=new eu(16);return eu!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},y.I=kn,y.J=function(a,n,c){var m,x,k,C,j,z,F,q,G,J,ae,ue,de=c[0],Te=c[1],Me=c[2];return n===a?(a[12]=n[0]*de+n[4]*Te+n[8]*Me+n[12],a[13]=n[1]*de+n[5]*Te+n[9]*Me+n[13],a[14]=n[2]*de+n[6]*Te+n[10]*Me+n[14],a[15]=n[3]*de+n[7]*Te+n[11]*Me+n[15]):(x=n[1],k=n[2],C=n[3],j=n[4],z=n[5],F=n[6],q=n[7],G=n[8],J=n[9],ae=n[10],ue=n[11],a[0]=m=n[0],a[1]=x,a[2]=k,a[3]=C,a[4]=j,a[5]=z,a[6]=F,a[7]=q,a[8]=G,a[9]=J,a[10]=ae,a[11]=ue,a[12]=m*de+j*Te+G*Me+n[12],a[13]=x*de+z*Te+J*Me+n[13],a[14]=k*de+F*Te+ae*Me+n[14],a[15]=C*de+q*Te+ue*Me+n[15]),a},y.K=function(a,n,c){var m=c[0],x=c[1],k=c[2];return a[0]=n[0]*m,a[1]=n[1]*m,a[2]=n[2]*m,a[3]=n[3]*m,a[4]=n[4]*x,a[5]=n[5]*x,a[6]=n[6]*x,a[7]=n[7]*x,a[8]=n[8]*k,a[9]=n[9]*k,a[10]=n[10]*k,a[11]=n[11]*k,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},y.L=kp,y.M=function(a,n){const c={};for(let m=0;m<n.length;m++){const x=n[m];x in a&&(c[x]=a[x])}return c},y.N=ou,y.O=$u,y.P=N,y.Q=Ad,y.R=Ka,y.S=ya,y.T=lh,y.U=re,y.V=ge,y.W=Tt,y.X=$s,y.Y=R,y.Z=Mh,y._=d,y.a=ot,y.a$=function(a,n){var c=a[0],m=a[1],x=a[2],k=a[3],C=a[4],j=a[5],z=a[6],F=a[7],q=a[8],G=a[9],J=a[10],ae=a[11],ue=a[12],de=a[13],Te=a[14],Me=a[15],tt=n[0],Be=n[1],Ke=n[2],yt=n[3],zt=n[4],Kt=n[5],bi=n[6],Vt=n[7],Wt=n[8],di=n[9],ai=n[10],ii=n[11],xt=n[12],si=n[13],hi=n[14],Ci=n[15];return Math.abs(c-tt)<=ea*Math.max(1,Math.abs(c),Math.abs(tt))&&Math.abs(m-Be)<=ea*Math.max(1,Math.abs(m),Math.abs(Be))&&Math.abs(x-Ke)<=ea*Math.max(1,Math.abs(x),Math.abs(Ke))&&Math.abs(k-yt)<=ea*Math.max(1,Math.abs(k),Math.abs(yt))&&Math.abs(C-zt)<=ea*Math.max(1,Math.abs(C),Math.abs(zt))&&Math.abs(j-Kt)<=ea*Math.max(1,Math.abs(j),Math.abs(Kt))&&Math.abs(z-bi)<=ea*Math.max(1,Math.abs(z),Math.abs(bi))&&Math.abs(F-Vt)<=ea*Math.max(1,Math.abs(F),Math.abs(Vt))&&Math.abs(q-Wt)<=ea*Math.max(1,Math.abs(q),Math.abs(Wt))&&Math.abs(G-di)<=ea*Math.max(1,Math.abs(G),Math.abs(di))&&Math.abs(J-ai)<=ea*Math.max(1,Math.abs(J),Math.abs(ai))&&Math.abs(ae-ii)<=ea*Math.max(1,Math.abs(ae),Math.abs(ii))&&Math.abs(ue-xt)<=ea*Math.max(1,Math.abs(ue),Math.abs(xt))&&Math.abs(de-si)<=ea*Math.max(1,Math.abs(de),Math.abs(si))&&Math.abs(Te-hi)<=ea*Math.max(1,Math.abs(Te),Math.abs(hi))&&Math.abs(Me-Ci)<=ea*Math.max(1,Math.abs(Me),Math.abs(Ci))},y.a0=sn,y.a1=Af,y.a2=Ct,y.a3=a=>{const n=window.document.createElement("video");return n.muted=!0,new Promise((c=>{n.onloadstart=()=>{c(n)};for(const m of a){const x=window.document.createElement("source");Gi(m)||(n.crossOrigin="Anonymous"),x.src=m,n.appendChild(x)}}))},y.a4=function(){return Ge++},y.a5=Xt,y.a6=Nu,y.a7=hl,y.a8=Jc,y.a9=Mf,y.aA=function(a){if(a.type==="custom")return new em(a);switch(a.type){case"background":return new Og(a);case"circle":return new __(a);case"fill":return new _g(a);case"fill-extrusion":return new md(a);case"heatmap":return new pf(a);case"hillshade":return new ud(a);case"line":return new Cg(a);case"raster":return new kf(a);case"symbol":return new Ah(a)}},y.aB=at,y.aC=function(a,n){if(!a)return[{command:"setStyle",args:[n]}];let c=[];try{if(!wi(a.version,n.version))return[{command:"setStyle",args:[n]}];wi(a.center,n.center)||c.push({command:"setCenter",args:[n.center]}),wi(a.zoom,n.zoom)||c.push({command:"setZoom",args:[n.zoom]}),wi(a.bearing,n.bearing)||c.push({command:"setBearing",args:[n.bearing]}),wi(a.pitch,n.pitch)||c.push({command:"setPitch",args:[n.pitch]}),wi(a.sprite,n.sprite)||c.push({command:"setSprite",args:[n.sprite]}),wi(a.glyphs,n.glyphs)||c.push({command:"setGlyphs",args:[n.glyphs]}),wi(a.transition,n.transition)||c.push({command:"setTransition",args:[n.transition]}),wi(a.light,n.light)||c.push({command:"setLight",args:[n.light]}),wi(a.terrain,n.terrain)||c.push({command:"setTerrain",args:[n.terrain]}),wi(a.sky,n.sky)||c.push({command:"setSky",args:[n.sky]}),wi(a.projection,n.projection)||c.push({command:"setProjection",args:[n.projection]});const m={},x=[];(function(C,j,z,F){let q;for(q in j=j||{},C=C||{})Object.prototype.hasOwnProperty.call(C,q)&&(Object.prototype.hasOwnProperty.call(j,q)||Hn(q,z,F));for(q in j)Object.prototype.hasOwnProperty.call(j,q)&&(Object.prototype.hasOwnProperty.call(C,q)?wi(C[q],j[q])||(C[q].type==="geojson"&&j[q].type==="geojson"&&Xi(C,j,q)?fi(z,{command:"setGeoJSONSourceData",args:[q,j[q].data]}):es(q,j,z,F)):xn(q,j,z))})(a.sources,n.sources,x,m);const k=[];a.layers&&a.layers.forEach((C=>{"source"in C&&m[C.source]?c.push({command:"removeLayer",args:[C.id]}):k.push(C)})),c=c.concat(x),(function(C,j,z){j=j||[];const F=(C=C||[]).map(Wi),q=j.map(Wi),G=C.reduce(gs,{}),J=j.reduce(gs,{}),ae=F.slice(),ue=Object.create(null);let de,Te,Me,tt,Be;for(let Ke=0,yt=0;Ke<F.length;Ke++)de=F[Ke],Object.prototype.hasOwnProperty.call(J,de)?yt++:(fi(z,{command:"removeLayer",args:[de]}),ae.splice(ae.indexOf(de,yt),1));for(let Ke=0,yt=0;Ke<q.length;Ke++)de=q[q.length-1-Ke],ae[ae.length-1-Ke]!==de&&(Object.prototype.hasOwnProperty.call(G,de)?(fi(z,{command:"removeLayer",args:[de]}),ae.splice(ae.lastIndexOf(de,ae.length-yt),1)):yt++,tt=ae[ae.length-Ke],fi(z,{command:"addLayer",args:[J[de],tt]}),ae.splice(ae.length-Ke,0,de),ue[de]=!0);for(let Ke=0;Ke<q.length;Ke++)if(de=q[Ke],Te=G[de],Me=J[de],!ue[de]&&!wi(Te,Me))if(wi(Te.source,Me.source)&&wi(Te["source-layer"],Me["source-layer"])&&wi(Te.type,Me.type)){for(Be in Ki(Te.layout,Me.layout,z,de,null,"setLayoutProperty"),Ki(Te.paint,Me.paint,z,de,null,"setPaintProperty"),wi(Te.filter,Me.filter)||fi(z,{command:"setFilter",args:[de,Me.filter]}),wi(Te.minzoom,Me.minzoom)&&wi(Te.maxzoom,Me.maxzoom)||fi(z,{command:"setLayerZoomRange",args:[de,Me.minzoom,Me.maxzoom]}),Te)Object.prototype.hasOwnProperty.call(Te,Be)&&Be!=="layout"&&Be!=="paint"&&Be!=="filter"&&Be!=="metadata"&&Be!=="minzoom"&&Be!=="maxzoom"&&(Be.indexOf("paint.")===0?Ki(Te[Be],Me[Be],z,de,Be.slice(6),"setPaintProperty"):wi(Te[Be],Me[Be])||fi(z,{command:"setLayerProperty",args:[de,Be,Me[Be]]}));for(Be in Me)Object.prototype.hasOwnProperty.call(Me,Be)&&!Object.prototype.hasOwnProperty.call(Te,Be)&&Be!=="layout"&&Be!=="paint"&&Be!=="filter"&&Be!=="metadata"&&Be!=="minzoom"&&Be!=="maxzoom"&&(Be.indexOf("paint.")===0?Ki(Te[Be],Me[Be],z,de,Be.slice(6),"setPaintProperty"):wi(Te[Be],Me[Be])||fi(z,{command:"setLayerProperty",args:[de,Be,Me[Be]]}))}else fi(z,{command:"removeLayer",args:[de]}),tt=ae[ae.lastIndexOf(de)+1],fi(z,{command:"addLayer",args:[Me,tt]})})(k,n.layers,c)}catch(m){console.warn("Unable to compute style diff:",m),c=[{command:"setStyle",args:[n]}]}return c},y.aD=function(a){const n=[],c=a.id;return c===void 0&&n.push({message:`layers.${c}: missing required property "id"`}),a.render===void 0&&n.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&n.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),n},y.aE=function a(n,c){if(Array.isArray(n)){if(!Array.isArray(c)||n.length!==c.length)return!1;for(let m=0;m<n.length;m++)if(!a(n[m],c[m]))return!1;return!0}if(typeof n=="object"&&n!==null&&c!==null){if(typeof c!="object"||Object.keys(n).length!==Object.keys(c).length)return!1;for(const m in n)if(!a(n[m],c[m]))return!1;return!0}return n===c},y.aF=He,y.aG=Xe,y.aH=class extends Ul{constructor(a,n){super(a,n),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},y.aI=Wc,y.aJ=class extends Ul{constructor(a,n){super(a,n),this.current=fc}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let n=1;n<16;n++)if(a[n]!==this.current[n]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},y.aK=sd,y.aL=of,y.aM=ut,y.aN=class extends Ul{constructor(a,n){super(a,n),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},y.aO=class extends Ul{constructor(a,n){super(a,n),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},y.aP=function(a,n,c,m,x,k,C){var j=1/(n-c),z=1/(m-x),F=1/(k-C);return a[0]=-2*j,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*z,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*F,a[11]=0,a[12]=(n+c)*j,a[13]=(x+m)*z,a[14]=(C+k)*F,a[15]=1,a},y.aQ=lg,y.aR=class extends Fe{},y.aS=Ja,y.aT=class extends rt{},y.aU=cd,y.aV=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},y.aW=dh,y.aX=cs,y.aY=ma,y.aZ=class extends ni{},y.a_=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]&&a[4]===n[4]&&a[5]===n[5]&&a[6]===n[6]&&a[7]===n[7]&&a[8]===n[8]&&a[9]===n[9]&&a[10]===n[10]&&a[11]===n[11]&&a[12]===n[12]&&a[13]===n[13]&&a[14]===n[14]&&a[15]===n[15]},y.aa=function(a){const n={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((c,m,x,k)=>{const C=x||k;return n[m]=!C||C.toLowerCase(),""})),n["max-age"]){const c=parseInt(n["max-age"],10);isNaN(c)?delete n["max-age"]:n["max-age"]=c}return n},y.ab=function(a,n){const c=[];for(const m in a)m in n||c.push(m);return c},y.ac=ye,y.ad=function(a,n,c){var m=Math.sin(c),x=Math.cos(c),k=n[0],C=n[1],j=n[2],z=n[3],F=n[4],q=n[5],G=n[6],J=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=k*x+F*m,a[1]=C*x+q*m,a[2]=j*x+G*m,a[3]=z*x+J*m,a[4]=F*x-k*m,a[5]=q*x-C*m,a[6]=G*x-j*m,a[7]=J*x-z*m,a},y.ae=function(a){var n=new eu(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n},y.af=od,y.ag=function(a,n){let c=0,m=0;if(a.kind==="constant")m=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:x,minZoom:k,maxZoom:C}=a,j=x?ye(Bs.interpolationFactor(x,n,k,C),0,1):0;a.kind==="camera"?m=Hs.number(a.minSize,a.maxSize,j):c=j}return{uSizeT:c,uSize:m}},y.ai=function(a,{uSize:n,uSizeT:c},{lowerSize:m,upperSize:x}){return a.kind==="source"?m/ta:a.kind==="composite"?Hs.number(m/ta,x/ta,c):n},y.aj=kd,y.ak=function(a,n,c,m){const x=n.y-a.y,k=n.x-a.x,C=m.y-c.y,j=m.x-c.x,z=C*k-j*x;if(z===0)return null;const F=(j*(a.y-c.y)-C*(a.x-c.x))/z;return new N(a.x+F*k,a.y+F*x)},y.al=Ug,y.am=xp,y.an=hf,y.ao=function(a){let n=1/0,c=1/0,m=-1/0,x=-1/0;for(const k of a)n=Math.min(n,k.x),c=Math.min(c,k.y),m=Math.max(m,k.x),x=Math.max(x,k.y);return[n,c,m,x]},y.ap=Ys,y.ar=Ed,y.as=function(a,n){var c=n[0],m=n[1],x=n[2],k=n[3],C=n[4],j=n[5],z=n[6],F=n[7],q=n[8],G=n[9],J=n[10],ae=n[11],ue=n[12],de=n[13],Te=n[14],Me=n[15],tt=c*j-m*C,Be=c*z-x*C,Ke=c*F-k*C,yt=m*z-x*j,zt=m*F-k*j,Kt=x*F-k*z,bi=q*de-G*ue,Vt=q*Te-J*ue,Wt=q*Me-ae*ue,di=G*Te-J*de,ai=G*Me-ae*de,ii=J*Me-ae*Te,xt=tt*ii-Be*ai+Ke*di+yt*Wt-zt*Vt+Kt*bi;return xt?(a[0]=(j*ii-z*ai+F*di)*(xt=1/xt),a[1]=(x*ai-m*ii-k*di)*xt,a[2]=(de*Kt-Te*zt+Me*yt)*xt,a[3]=(J*zt-G*Kt-ae*yt)*xt,a[4]=(z*Wt-C*ii-F*Vt)*xt,a[5]=(c*ii-x*Wt+k*Vt)*xt,a[6]=(Te*Ke-ue*Kt-Me*Be)*xt,a[7]=(q*Kt-J*Ke+ae*Be)*xt,a[8]=(C*ai-j*Wt+F*bi)*xt,a[9]=(m*Wt-c*ai-k*bi)*xt,a[10]=(ue*zt-de*Ke+Me*tt)*xt,a[11]=(G*Ke-q*zt-ae*tt)*xt,a[12]=(j*Vt-C*di-z*bi)*xt,a[13]=(c*di-m*Vt+x*bi)*xt,a[14]=(de*Be-ue*yt-Te*tt)*xt,a[15]=(q*yt-G*Be+J*tt)*xt,a):null},y.at=Lf,y.au=Ch,y.av=Ld,y.aw=function(){const a={},n=it.$version;for(const c in it.$root){const m=it.$root[c];if(m.required){let x=null;x=c==="version"?n:m.type==="array"?[]:{},x!=null&&(a[c]=x)}}return a},y.ax=_s,y.ay=ei,y.az=function(a){a=a.slice();const n=Object.create(null);for(let c=0;c<a.length;c++)n[a[c].id]=a[c];for(let c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=qn(a[c],n[a[c].ref]));return a},y.b=ct,y.b0=function(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},y.b1=function(a,n,c){return a[0]=n[0]*c[0],a[1]=n[1]*c[1],a[2]=n[2]*c[2],a[3]=n[3]*c[3],a},y.b2=function(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]},y.b3=ke,y.b4=am,y.b5=sm,y.b6=function(a,n,c,m,x){var k,C=1/Math.tan(n/2);return a[0]=C/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=C,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,x!=null&&x!==1/0?(a[10]=(x+m)*(k=1/(m-x)),a[14]=2*x*m*k):(a[10]=-1,a[14]=-2*m),a},y.b7=function(a,n,c){var m=Math.sin(c),x=Math.cos(c),k=n[4],C=n[5],j=n[6],z=n[7],F=n[8],q=n[9],G=n[10],J=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=k*x+F*m,a[5]=C*x+q*m,a[6]=j*x+G*m,a[7]=z*x+J*m,a[8]=F*x-k*m,a[9]=q*x-C*m,a[10]=G*x-j*m,a[11]=J*x-z*m,a},y.b8=oe,y.b9=me,y.bA=Gp,y.bB=function(a){return a.message===Ce},y.bC=cl,y.bD=tr,y.ba=function(a){return a*Math.PI/180},y.bb=function(a,n){const{x:c,y:m}=Mh.fromLngLat(n);return!(a<0||a>25||m<0||m>=1||c<0||c>=1)},y.bc=function(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},y.bd=class extends H{},y.be=tm,y.bf=A_,y.bh=It,y.bi=function(a,n){ot.REGISTERED_PROTOCOLS[a]=n},y.bj=function(a){delete ot.REGISTERED_PROTOCOLS[a]},y.bk=function(a,n){const c={};for(let x=0;x<a.length;x++){const k=n&&n[a[x].id]||Yr(a[x]);n&&(n[a[x].id]=k);let C=c[k];C||(C=c[k]=[]),C.push(a[x])}const m=[];for(const x in c)m.push(c[x]);return m},y.bl=Lt,y.bm=ns,y.bn=Bg,y.bo=is,y.bp=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=$s/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const n=a.bucket.layers[0],c=n.layout,m=n._unevaluatedLayout._values,x={layoutIconSize:m["icon-size"].possiblyEvaluate(new nn(a.bucket.zoom+1),a.canonical),layoutTextSize:m["text-size"].possiblyEvaluate(new nn(a.bucket.zoom+1),a.canonical),textMaxSize:m["text-size"].possiblyEvaluate(new nn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=a.bucket.textSizeData;x.compositeTextSizes=[m["text-size"].possiblyEvaluate(new nn(F),a.canonical),m["text-size"].possiblyEvaluate(new nn(q),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=a.bucket.iconSizeData;x.compositeIconSizes=[m["icon-size"].possiblyEvaluate(new nn(F),a.canonical),m["icon-size"].possiblyEvaluate(new nn(q),a.canonical)]}const k=c.get("text-line-height")*Ys,C=c.get("text-rotation-alignment")!=="viewport"&&c.get("symbol-placement")!=="point",j=c.get("text-keep-upright"),z=c.get("text-size");for(const F of a.bucket.features){const q=c.get("text-font").evaluate(F,{},a.canonical).join(","),G=z.evaluate(F,{},a.canonical),J=x.layoutTextSize.evaluate(F,{},a.canonical),ae=x.layoutIconSize.evaluate(F,{},a.canonical),ue={horizontal:{},vertical:void 0},de=F.text;let Te,Me=[0,0];if(de){const Ke=de.toString(),yt=c.get("text-letter-spacing").evaluate(F,{},a.canonical)*Ys,zt=ku(Ke)?yt:0,Kt=c.get("text-anchor").evaluate(F,{},a.canonical),bi=qg(n,F,a.canonical);if(!bi){const ai=c.get("text-radial-offset").evaluate(F,{},a.canonical);Me=ai?Rh(Kt,[ai*Ys,hm]):c.get("text-offset").evaluate(F,{},a.canonical).map((ii=>ii*Ys))}let Vt=C?"center":c.get("text-justify").evaluate(F,{},a.canonical);const Wt=c.get("symbol-placement")==="point"?c.get("text-max-width").evaluate(F,{},a.canonical)*Ys:1/0,di=()=>{a.bucket.allowVerticalPlacement&&yo(Ke)&&(ue.vertical=Fo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Wt,k,Kt,"left",zt,Me,y.ah.vertical,!0,J,G))};if(!C&&bi){const ai=new Set;if(Vt==="auto")for(let xt=0;xt<bi.values.length;xt+=2)ai.add(Lf(bi.values[xt]));else ai.add(Vt);let ii=!1;for(const xt of ai)if(!ue.horizontal[xt])if(ii)ue.horizontal[xt]=ue.horizontal[0];else{const si=Fo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Wt,k,"center",xt,zt,Me,y.ah.horizontal,!1,J,G);si&&(ue.horizontal[xt]=si,ii=si.positionedLines.length===1)}di()}else{Vt==="auto"&&(Vt=Lf(Kt));const ai=Fo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Wt,k,Kt,Vt,zt,Me,y.ah.horizontal,!1,J,G);ai&&(ue.horizontal[Vt]=ai),di(),yo(Ke)&&C&&j&&(ue.vertical=Fo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Wt,k,Kt,Vt,zt,Me,y.ah.vertical,!1,J,G))}}let tt=!1;if(F.icon&&F.icon.name){const Ke=a.imageMap[F.icon.name];Ke&&(Te=Tf(a.imagePositions[F.icon.name],c.get("icon-offset").evaluate(F,{},a.canonical),c.get("icon-anchor").evaluate(F,{},a.canonical)),tt=!!Ke.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=tt:a.bucket.sdfIcons!==tt&&Et("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ke.pixelRatio!==a.bucket.pixelRatio||c.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const Be=jd(ue.horizontal)||ue.vertical;a.bucket.iconsInText=!!Be&&Be.iconsInText,(Be||Te)&&Mn(a.bucket,F,ue,Te,a.imageMap,x,J,ae,Me,tt,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},y.bq=yd,y.br=_h,y.bs=zu,y.bt=yc,y.bu=wf,y.bv=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},y.bw=function(a,n,c,m,x){return d(this,void 0,void 0,(function*(){if(ge())try{return yield Tt(a,n,c,m,x)}catch{}return(function(k,C,j,z,F){const q=k.width,G=k.height;lt&&xe||(lt=new OffscreenCanvas(q,G),xe=lt.getContext("2d",{willReadFrequently:!0})),lt.width=q,lt.height=G,xe.drawImage(k,0,0,q,G);const J=xe.getImageData(C,j,z,F);return xe.clearRect(0,0,q,G),J.data})(a,n,c,m,x)}))},y.bx=om,y.by=A,y.bz=I,y.c=st,y.d=a=>d(void 0,void 0,void 0,(function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(n)}catch(c){throw new Error(`Could not load image because of ${c.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),y.e=Re,y.f=a=>new Promise(((n,c)=>{const m=new Image;m.onload=()=>{n(m),URL.revokeObjectURL(m.src),m.onload=null,window.requestAnimationFrame((()=>{m.src=We}))},m.onerror=()=>c(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const x=new Blob([new Uint8Array(a)],{type:"image/png"});m.src=a.byteLength?URL.createObjectURL(x):We})),y.g=_t,y.h=(a,n)=>li(Re(a,{type:"json"}),n),y.i=pt,y.j=hn,y.k=Pn,y.l=(a,n)=>li(Re(a,{type:"arrayBuffer"}),n),y.m=li,y.n=function(a){return new wf(a).readFields(jg,[])},y.o=ld,y.p=ps,y.q=E,y.r=_i,y.s=Gi,y.t=Tr,y.u=Yt,y.v=it,y.w=Et,y.x=function([a,n,c]){return n+=90,n*=Math.PI/180,c*=Math.PI/180,{x:a*Math.cos(n)*Math.sin(c),y:a*Math.sin(n)*Math.sin(c),z:a*Math.cos(c)}},y.y=Hs,y.z=nn})),f("worker",["./shared"],(function(y){class d{constructor(ie){this.keyCache={},ie&&this.replace(ie)}replace(ie){this._layerConfigs={},this._layers={},this.update(ie,[])}update(ie,te){for(const we of ie){this._layerConfigs[we.id]=we;const je=this._layers[we.id]=y.aA(we);je._featureFilter=y.a7(je.filter),this.keyCache[we.id]&&delete this.keyCache[we.id]}for(const we of te)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const he=y.bk(Object.values(this._layerConfigs),this.keyCache);for(const we of he){const je=we.map((Oe=>this._layers[Oe.id])),Ne=je[0];if(Ne.visibility==="none")continue;const Ze=Ne.source||"";let ee=this.familiesBySource[Ze];ee||(ee=this.familiesBySource[Ze]={});const Le=Ne.sourceLayer||"_geojsonTileLayer";let Ue=ee[Le];Ue||(Ue=ee[Le]=[]),Ue.push(je)}}}class A{constructor(ie){const te={},he=[];for(const Ze in ie){const ee=ie[Ze],Le=te[Ze]={};for(const Ue in ee){const Oe=ee[+Ue];if(!Oe||Oe.bitmap.width===0||Oe.bitmap.height===0)continue;const Ve={x:0,y:0,w:Oe.bitmap.width+2,h:Oe.bitmap.height+2};he.push(Ve),Le[Ue]={rect:Ve,metrics:Oe.metrics}}}const{w:we,h:je}=y.p(he),Ne=new y.o({width:we||1,height:je||1});for(const Ze in ie){const ee=ie[Ze];for(const Le in ee){const Ue=ee[+Le];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Oe=te[Ze][Le].rect;y.o.copy(Ue.bitmap,Ne,{x:0,y:0},{x:Oe.x+1,y:Oe.y+1},Ue.bitmap)}}this.image=Ne,this.positions=te}}y.bl("GlyphAtlas",A);class I{constructor(ie){this.tileID=new y.S(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.uid=ie.uid,this.zoom=ie.zoom,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ie.showCollisionBoxes,this.collectResourceTiming=!!ie.collectResourceTiming,this.returnDependencies=!!ie.returnDependencies,this.promoteId=ie.promoteId,this.inFlightDependencies=[]}parse(ie,te,he,we){return y._(this,void 0,void 0,(function*(){this.status="parsing",this.data=ie,this.collisionBoxArray=new y.a5;const je=new y.bm(Object.keys(ie.layers).sort()),Ne=new y.bn(this.tileID,this.promoteId);Ne.bucketLayerIDs=[];const Ze={},ee={featureIndex:Ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},Le=te.familiesBySource[this.source];for(const gi in Le){const qi=ie.layers[gi];if(!qi)continue;qi.version===1&&y.w(`Vector tile source "${this.source}" layer "${gi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const on=je.encode(gi),Qe=[];for(let Ot=0;Ot<qi.length;Ot++){const ui=qi.feature(Ot),ln=Ne.getId(ui,gi);Qe.push({feature:ui,id:ln,index:Ot,sourceLayerIndex:on})}for(const Ot of Le[gi]){const ui=Ot[0];ui.source!==this.source&&y.w(`layer.source = ${ui.source} does not equal this.source = ${this.source}`),ui.minzoom&&this.zoom<Math.floor(ui.minzoom)||ui.maxzoom&&this.zoom>=ui.maxzoom||ui.visibility!=="none"&&(B(Ot,this.zoom,he),(Ze[ui.id]=ui.createBucket({index:Ne.bucketLayerIDs.length,layers:Ot,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:on,sourceID:this.source})).populate(Qe,ee,this.tileID.canonical),Ne.bucketLayerIDs.push(Ot.map((ln=>ln.id))))}}const Ue=y.aF(ee.glyphDependencies,(gi=>Object.keys(gi).map(Number)));this.inFlightDependencies.forEach((gi=>gi?.abort())),this.inFlightDependencies=[];let Oe=Promise.resolve({});if(Object.keys(Ue).length){const gi=new AbortController;this.inFlightDependencies.push(gi),Oe=we.sendAsync({type:"GG",data:{stacks:Ue,source:this.source,tileID:this.tileID,type:"glyphs"}},gi)}const Ve=Object.keys(ee.iconDependencies);let Bt=Promise.resolve({});if(Ve.length){const gi=new AbortController;this.inFlightDependencies.push(gi),Bt=we.sendAsync({type:"GI",data:{icons:Ve,source:this.source,tileID:this.tileID,type:"icons"}},gi)}const qt=Object.keys(ee.patternDependencies);let Dt=Promise.resolve({});if(qt.length){const gi=new AbortController;this.inFlightDependencies.push(gi),Dt=we.sendAsync({type:"GI",data:{icons:qt,source:this.source,tileID:this.tileID,type:"patterns"}},gi)}const[At,ti,pi]=yield Promise.all([Oe,Bt,Dt]),ji=new A(At),Qi=new y.bo(ti,pi);for(const gi in Ze){const qi=Ze[gi];qi instanceof y.a6?(B(qi.layers,this.zoom,he),y.bp({bucket:qi,glyphMap:At,glyphPositions:ji.positions,imageMap:ti,imagePositions:Qi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):qi.hasPattern&&(qi instanceof y.bq||qi instanceof y.br||qi instanceof y.bs)&&(B(qi.layers,this.zoom,he),qi.addFeatures(ee,this.tileID.canonical,Qi.patternPositions))}return this.status="done",{buckets:Object.values(Ze).filter((gi=>!gi.isEmpty())),featureIndex:Ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ji.image,imageAtlas:Qi,glyphMap:this.returnDependencies?At:null,iconMap:this.returnDependencies?ti:null,glyphPositions:this.returnDependencies?ji.positions:null}}))}}function B(be,ie,te){const he=new y.z(ie);for(const we of be)we.recalculate(he,te)}class N{constructor(ie,te,he){this.actor=ie,this.layerIndex=te,this.availableImages=he,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ie,te){return y._(this,void 0,void 0,(function*(){const he=yield y.l(ie.request,te);try{return{vectorTile:new y.bt.VectorTile(new y.bu(he.data)),rawData:he.data,cacheControl:he.cacheControl,expires:he.expires}}catch(we){const je=new Uint8Array(he.data);let Ne=`Unable to parse the tile at ${ie.request.url}, `;throw Ne+=je[0]===31&&je[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${we.message}`,new Error(Ne)}}))}loadTile(ie){return y._(this,void 0,void 0,(function*(){const te=ie.uid,he=!!(ie&&ie.request&&ie.request.collectResourceTiming)&&new y.bv(ie.request),we=new I(ie);this.loading[te]=we;const je=new AbortController;we.abort=je;try{const Ne=yield this.loadVectorTile(ie,je);if(delete this.loading[te],!Ne)return null;const Ze=Ne.rawData,ee={};Ne.expires&&(ee.expires=Ne.expires),Ne.cacheControl&&(ee.cacheControl=Ne.cacheControl);const Le={};if(he){const Oe=he.finish();Oe&&(Le.resourceTiming=JSON.parse(JSON.stringify(Oe)))}we.vectorTile=Ne.vectorTile;const Ue=we.parse(Ne.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[te]=we,this.fetching[te]={rawTileData:Ze,cacheControl:ee,resourceTiming:Le};try{const Oe=yield Ue;return y.e({rawTileData:Ze.slice(0)},Oe,ee,Le)}finally{delete this.fetching[te]}}catch(Ne){throw delete this.loading[te],we.status="done",this.loaded[te]=we,Ne}}))}reloadTile(ie){return y._(this,void 0,void 0,(function*(){const te=ie.uid;if(!this.loaded||!this.loaded[te])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const he=this.loaded[te];if(he.showCollisionBoxes=ie.showCollisionBoxes,he.status==="parsing"){const we=yield he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor);let je;if(this.fetching[te]){const{rawTileData:Ne,cacheControl:Ze,resourceTiming:ee}=this.fetching[te];delete this.fetching[te],je=y.e({rawTileData:Ne.slice(0)},we,Ze,ee)}else je=we;return je}if(he.status==="done"&&he.vectorTile)return he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(ie){return y._(this,void 0,void 0,(function*(){const te=this.loading,he=ie.uid;te&&te[he]&&te[he].abort&&(te[he].abort.abort(),delete te[he])}))}removeTile(ie){return y._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[ie.uid]&&delete this.loaded[ie.uid]}))}}class V{constructor(){this.loaded={}}loadTile(ie){return y._(this,void 0,void 0,(function*(){const{uid:te,encoding:he,rawImageData:we,redFactor:je,greenFactor:Ne,blueFactor:Ze,baseShift:ee}=ie,Le=we.width+2,Ue=we.height+2,Oe=y.b(we)?new y.R({width:Le,height:Ue},yield y.bw(we,-1,-1,Le,Ue)):we,Ve=new y.bx(te,Oe,he,je,Ne,Ze,ee);return this.loaded=this.loaded||{},this.loaded[te]=Ve,Ve}))}removeTile(ie){const te=this.loaded,he=ie.uid;te&&te[he]&&delete te[he]}}function K(be,ie){if(be.length!==0){se(be[0],ie);for(var te=1;te<be.length;te++)se(be[te],!ie)}}function se(be,ie){for(var te=0,he=0,we=0,je=be.length,Ne=je-1;we<je;Ne=we++){var Ze=(be[we][0]-be[Ne][0])*(be[Ne][1]+be[we][1]),ee=te+Ze;he+=Math.abs(te)>=Math.abs(Ze)?te-ee+Ze:Ze-ee+te,te=ee}te+he>=0!=!!ie&&be.reverse()}var ne=y.by((function be(ie,te){var he,we=ie&&ie.type;if(we==="FeatureCollection")for(he=0;he<ie.features.length;he++)be(ie.features[he],te);else if(we==="GeometryCollection")for(he=0;he<ie.geometries.length;he++)be(ie.geometries[he],te);else if(we==="Feature")be(ie.geometry,te);else if(we==="Polygon")K(ie.coordinates,te);else if(we==="MultiPolygon")for(he=0;he<ie.coordinates.length;he++)K(ie.coordinates[he],te);return ie}));const ve=y.bt.VectorTileFeature.prototype.toGeoJSON;var re={exports:{}},ge=y.bz,oe=y.bt.VectorTileFeature,me=ye;function ye(be,ie){this.options=ie||{},this.features=be,this.length=be.length}function ke(be,ie){this.id=typeof be.id=="number"?be.id:void 0,this.type=be.type,this.rawGeometry=be.type===1?[be.geometry]:be.geometry,this.properties=be.tags,this.extent=ie||4096}ye.prototype.feature=function(be){return new ke(this.features[be],this.options.extent)},ke.prototype.loadGeometry=function(){var be=this.rawGeometry;this.geometry=[];for(var ie=0;ie<be.length;ie++){for(var te=be[ie],he=[],we=0;we<te.length;we++)he.push(new ge(te[we][0],te[we][1]));this.geometry.push(he)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var be=this.geometry,ie=1/0,te=-1/0,he=1/0,we=-1/0,je=0;je<be.length;je++)for(var Ne=be[je],Ze=0;Ze<Ne.length;Ze++){var ee=Ne[Ze];ie=Math.min(ie,ee.x),te=Math.max(te,ee.x),he=Math.min(he,ee.y),we=Math.max(we,ee.y)}return[ie,he,te,we]},ke.prototype.toGeoJSON=oe.prototype.toGeoJSON;var Re=y.bA,Ge=me;function He(be){var ie=new Re;return(function(te,he){for(var we in te.layers)he.writeMessage(3,Xe,te.layers[we])})(be,ie),ie.finish()}function Xe(be,ie){var te;ie.writeVarintField(15,be.version||1),ie.writeStringField(1,be.name||""),ie.writeVarintField(5,be.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(te=0;te<be.length;te++)he.feature=be.feature(te),ie.writeMessage(2,at,he);var we=he.keys;for(te=0;te<we.length;te++)ie.writeStringField(3,we[te]);var je=he.values;for(te=0;te<je.length;te++)ie.writeMessage(4,$e,je[te])}function at(be,ie){var te=be.feature;te.id!==void 0&&ie.writeVarintField(1,te.id),ie.writeMessage(2,et,be),ie.writeVarintField(3,te.type),ie.writeMessage(4,pt,te)}function et(be,ie){var te=be.feature,he=be.keys,we=be.values,je=be.keycache,Ne=be.valuecache;for(var Ze in te.properties){var ee=te.properties[Ze],Le=je[Ze];if(ee!==null){Le===void 0&&(he.push(Ze),je[Ze]=Le=he.length-1),ie.writeVarint(Le);var Ue=typeof ee;Ue!=="string"&&Ue!=="boolean"&&Ue!=="number"&&(ee=JSON.stringify(ee));var Oe=Ue+":"+ee,Ve=Ne[Oe];Ve===void 0&&(we.push(ee),Ne[Oe]=Ve=we.length-1),ie.writeVarint(Ve)}}}function Et(be,ie){return(ie<<3)+(7&be)}function gt(be){return be<<1^be>>31}function pt(be,ie){for(var te=be.loadGeometry(),he=be.type,we=0,je=0,Ne=te.length,Ze=0;Ze<Ne;Ze++){var ee=te[Ze],Le=1;he===1&&(Le=ee.length),ie.writeVarint(Et(1,Le));for(var Ue=he===3?ee.length-1:ee.length,Oe=0;Oe<Ue;Oe++){Oe===1&&he!==1&&ie.writeVarint(Et(2,Ue-1));var Ve=ee[Oe].x-we,Bt=ee[Oe].y-je;ie.writeVarint(gt(Ve)),ie.writeVarint(gt(Bt)),we+=Ve,je+=Bt}he===3&&ie.writeVarint(Et(7,1))}}function $e(be,ie){var te=typeof be;te==="string"?ie.writeStringField(1,be):te==="boolean"?ie.writeBooleanField(7,be):te==="number"&&(be%1!=0?ie.writeDoubleField(3,be):be<0?ie.writeSVarintField(6,be):ie.writeVarintField(5,be))}re.exports=He,re.exports.fromVectorTileJs=He,re.exports.fromGeojsonVt=function(be,ie){ie=ie||{};var te={};for(var he in be)te[he]=new Ge(be[he].features,ie),te[he].name=he,te[he].version=ie.version,te[he].extent=ie.extent;return He({layers:te})},re.exports.GeoJSONWrapper=Ge;var ct=y.by(re.exports);const We={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:be=>be},Tt=Math.fround||(lt=new Float32Array(1),be=>(lt[0]=+be,lt[0]));var lt;const xe=3,Ce=5,st=6;class ot{constructor(ie){this.options=Object.assign(Object.create(We),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){const{log:te,minZoom:he,maxZoom:we}=this.options;te&&console.time("total time");const je=`prepare ${ie.length} points`;te&&console.time(je),this.points=ie;const Ne=[];for(let ee=0;ee<ie.length;ee++){const Le=ie[ee];if(!Le.geometry)continue;const[Ue,Oe]=Le.geometry.coordinates,Ve=Tt(It(Ue)),Bt=Tt(ei(Oe));Ne.push(Ve,Bt,1/0,ee,-1,1),this.options.reduce&&Ne.push(0)}let Ze=this.trees[we+1]=this._createTree(Ne);te&&console.timeEnd(je);for(let ee=we;ee>=he;ee--){const Le=+Date.now();Ze=this.trees[ee]=this._createTree(this._cluster(Ze,ee)),te&&console.log("z%d: %d clusters in %dms",ee,Ze.numItems,+Date.now()-Le)}return te&&console.timeEnd("total time"),this}getClusters(ie,te){let he=((ie[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,ie[1]));let je=ie[2]===180?180:((ie[2]+180)%360+360)%360-180;const Ne=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)he=-180,je=180;else if(he>je){const Oe=this.getClusters([he,we,180,Ne],te),Ve=this.getClusters([-180,we,je,Ne],te);return Oe.concat(Ve)}const Ze=this.trees[this._limitZoom(te)],ee=Ze.range(It(he),ei(Ne),It(je),ei(we)),Le=Ze.data,Ue=[];for(const Oe of ee){const Ve=this.stride*Oe;Ue.push(Le[Ve+Ce]>1?_t(Le,Ve,this.clusterProps):this.points[Le[Ve+xe]])}return Ue}getChildren(ie){const te=this._getOriginId(ie),he=this._getOriginZoom(ie),we="No cluster with the specified id.",je=this.trees[he];if(!je)throw new Error(we);const Ne=je.data;if(te*this.stride>=Ne.length)throw new Error(we);const Ze=this.options.radius/(this.options.extent*Math.pow(2,he-1)),ee=je.within(Ne[te*this.stride],Ne[te*this.stride+1],Ze),Le=[];for(const Ue of ee){const Oe=Ue*this.stride;Ne[Oe+4]===ie&&Le.push(Ne[Oe+Ce]>1?_t(Ne,Oe,this.clusterProps):this.points[Ne[Oe+xe]])}if(Le.length===0)throw new Error(we);return Le}getLeaves(ie,te,he){const we=[];return this._appendLeaves(we,ie,te=te||10,he=he||0,0),we}getTile(ie,te,he){const we=this.trees[this._limitZoom(ie)],je=Math.pow(2,ie),{extent:Ne,radius:Ze}=this.options,ee=Ze/Ne,Le=(he-ee)/je,Ue=(he+1+ee)/je,Oe={features:[]};return this._addTileFeatures(we.range((te-ee)/je,Le,(te+1+ee)/je,Ue),we.data,te,he,je,Oe),te===0&&this._addTileFeatures(we.range(1-ee/je,Le,1,Ue),we.data,je,he,je,Oe),te===je-1&&this._addTileFeatures(we.range(0,Le,ee/je,Ue),we.data,-1,he,je,Oe),Oe.features.length?Oe:null}getClusterExpansionZoom(ie){let te=this._getOriginZoom(ie)-1;for(;te<=this.options.maxZoom;){const he=this.getChildren(ie);if(te++,he.length!==1)break;ie=he[0].properties.cluster_id}return te}_appendLeaves(ie,te,he,we,je){const Ne=this.getChildren(te);for(const Ze of Ne){const ee=Ze.properties;if(ee&&ee.cluster?je+ee.point_count<=we?je+=ee.point_count:je=this._appendLeaves(ie,ee.cluster_id,he,we,je):je<we?je++:ie.push(Ze),ie.length===he)break}return je}_createTree(ie){const te=new y.av(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let he=0;he<ie.length;he+=this.stride)te.add(ie[he],ie[he+1]);return te.finish(),te.data=ie,te}_addTileFeatures(ie,te,he,we,je,Ne){for(const Ze of ie){const ee=Ze*this.stride,Le=te[ee+Ce]>1;let Ue,Oe,Ve;if(Le)Ue=kt(te,ee,this.clusterProps),Oe=te[ee],Ve=te[ee+1];else{const Dt=this.points[te[ee+xe]];Ue=Dt.properties;const[At,ti]=Dt.geometry.coordinates;Oe=It(At),Ve=ei(ti)}const Bt={type:1,geometry:[[Math.round(this.options.extent*(Oe*je-he)),Math.round(this.options.extent*(Ve*je-we))]],tags:Ue};let qt;qt=Le||this.options.generateId?te[ee+xe]:this.points[te[ee+xe]].id,qt!==void 0&&(Bt.id=qt),Ne.features.push(Bt)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,te){const{radius:he,extent:we,reduce:je,minPoints:Ne}=this.options,Ze=he/(we*Math.pow(2,te)),ee=ie.data,Le=[],Ue=this.stride;for(let Oe=0;Oe<ee.length;Oe+=Ue){if(ee[Oe+2]<=te)continue;ee[Oe+2]=te;const Ve=ee[Oe],Bt=ee[Oe+1],qt=ie.within(ee[Oe],ee[Oe+1],Ze),Dt=ee[Oe+Ce];let At=Dt;for(const ti of qt){const pi=ti*Ue;ee[pi+2]>te&&(At+=ee[pi+Ce])}if(At>Dt&&At>=Ne){let ti,pi=Ve*Dt,ji=Bt*Dt,Qi=-1;const gi=((Oe/Ue|0)<<5)+(te+1)+this.points.length;for(const qi of qt){const on=qi*Ue;if(ee[on+2]<=te)continue;ee[on+2]=te;const Qe=ee[on+Ce];pi+=ee[on]*Qe,ji+=ee[on+1]*Qe,ee[on+4]=gi,je&&(ti||(ti=this._map(ee,Oe,!0),Qi=this.clusterProps.length,this.clusterProps.push(ti)),je(ti,this._map(ee,on)))}ee[Oe+4]=gi,Le.push(pi/At,ji/At,1/0,gi,-1,At),je&&Le.push(Qi)}else{for(let ti=0;ti<Ue;ti++)Le.push(ee[Oe+ti]);if(At>1)for(const ti of qt){const pi=ti*Ue;if(!(ee[pi+2]<=te)){ee[pi+2]=te;for(let ji=0;ji<Ue;ji++)Le.push(ee[pi+ji])}}}}return Le}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,te,he){if(ie[te+Ce]>1){const Ne=this.clusterProps[ie[te+st]];return he?Object.assign({},Ne):Ne}const we=this.points[ie[te+xe]].properties,je=this.options.map(we);return he&&je===we?Object.assign({},je):je}}function _t(be,ie,te){return{type:"Feature",id:be[ie+xe],properties:kt(be,ie,te),geometry:{type:"Point",coordinates:[(he=be[ie],360*(he-.5)),li(be[ie+1])]}};var he}function kt(be,ie,te){const he=be[ie+Ce],we=he>=1e4?`${Math.round(he/1e3)}k`:he>=1e3?Math.round(he/100)/10+"k":he,je=be[ie+st],Ne=je===-1?{}:Object.assign({},te[je]);return Object.assign(Ne,{cluster:!0,cluster_id:be[ie+xe],point_count:he,point_count_abbreviated:we})}function It(be){return be/360+.5}function ei(be){const ie=Math.sin(be*Math.PI/180),te=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return te<0?0:te>1?1:te}function li(be){const ie=(180-360*be)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function Gi(be,ie,te,he){let we=he;const je=ie+(te-ie>>1);let Ne,Ze=te-ie;const ee=be[ie],Le=be[ie+1],Ue=be[te],Oe=be[te+1];for(let Ve=ie+3;Ve<te;Ve+=3){const Bt=Mi(be[Ve],be[Ve+1],ee,Le,Ue,Oe);if(Bt>we)Ne=Ve,we=Bt;else if(Bt===we){const qt=Math.abs(Ve-je);qt<Ze&&(Ne=Ve,Ze=qt)}}we>he&&(Ne-ie>3&&Gi(be,ie,Ne,he),be[Ne+2]=we,te-Ne>3&&Gi(be,Ne,te,he))}function Mi(be,ie,te,he,we,je){let Ne=we-te,Ze=je-he;if(Ne!==0||Ze!==0){const ee=((be-te)*Ne+(ie-he)*Ze)/(Ne*Ne+Ze*Ze);ee>1?(te=we,he=je):ee>0&&(te+=Ne*ee,he+=Ze*ee)}return Ne=be-te,Ze=ie-he,Ne*Ne+Ze*Ze}function Di(be,ie,te,he){const we={id:be??null,type:ie,geometry:te,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ie==="Point"||ie==="MultiPoint"||ie==="LineString")Pn(we,te);else if(ie==="Polygon")Pn(we,te[0]);else if(ie==="MultiLineString")for(const je of te)Pn(we,je);else if(ie==="MultiPolygon")for(const je of te)Pn(we,je[0]);return we}function Pn(be,ie){for(let te=0;te<ie.length;te+=3)be.minX=Math.min(be.minX,ie[te]),be.minY=Math.min(be.minY,ie[te+1]),be.maxX=Math.max(be.maxX,ie[te]),be.maxY=Math.max(be.maxY,ie[te+1])}function hn(be,ie,te,he){if(!ie.geometry)return;const we=ie.geometry.coordinates;if(we&&we.length===0)return;const je=ie.geometry.type,Ne=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2);let Ze=[],ee=ie.id;if(te.promoteId?ee=ie.properties[te.promoteId]:te.generateId&&(ee=he||0),je==="Point")zn(we,Ze);else if(je==="MultiPoint")for(const Le of we)zn(Le,Ze);else if(je==="LineString")it(we,Ze,Ne,!1);else if(je==="MultiLineString"){if(te.lineMetrics){for(const Le of we)Ze=[],it(Le,Ze,Ne,!1),be.push(Di(ee,"LineString",Ze,ie.properties));return}Qn(we,Ze,Ne,!1)}else if(je==="Polygon")Qn(we,Ze,Ne,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const Le of ie.geometry.geometries)hn(be,{id:ee,geometry:Le,properties:ie.properties},te,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Le of we){const Ue=[];Qn(Le,Ue,Ne,!0),Ze.push(Ue)}}be.push(Di(ee,je,Ze,ie.properties))}function zn(be,ie){ie.push(qn(be[0]),wi(be[1]),0)}function it(be,ie,te,he){let we,je,Ne=0;for(let ee=0;ee<be.length;ee++){const Le=qn(be[ee][0]),Ue=wi(be[ee][1]);ie.push(Le,Ue,0),ee>0&&(Ne+=he?(we*Ue-Le*je)/2:Math.sqrt(Math.pow(Le-we,2)+Math.pow(Ue-je,2))),we=Le,je=Ue}const Ze=ie.length-3;ie[2]=1,Gi(ie,0,Ze,te),ie[Ze+2]=1,ie.size=Math.abs(Ne),ie.start=0,ie.end=ie.size}function Qn(be,ie,te,he){for(let we=0;we<be.length;we++){const je=[];it(be[we],je,te,he),ie.push(je)}}function qn(be){return be/360+.5}function wi(be){const ie=Math.sin(be*Math.PI/180),te=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return te<0?0:te>1?1:te}function fi(be,ie,te,he,we,je,Ne,Ze){if(he/=ie,je>=(te/=ie)&&Ne<he)return be;if(Ne<te||je>=he)return null;const ee=[];for(const Le of be){const Ue=Le.geometry;let Oe=Le.type;const Ve=we===0?Le.minX:Le.minY,Bt=we===0?Le.maxX:Le.maxY;if(Ve>=te&&Bt<he){ee.push(Le);continue}if(Bt<te||Ve>=he)continue;let qt=[];if(Oe==="Point"||Oe==="MultiPoint")xn(Ue,qt,te,he,we);else if(Oe==="LineString")Hn(Ue,qt,te,he,we,!1,Ze.lineMetrics);else if(Oe==="MultiLineString")Xi(Ue,qt,te,he,we,!1);else if(Oe==="Polygon")Xi(Ue,qt,te,he,we,!0);else if(Oe==="MultiPolygon")for(const Dt of Ue){const At=[];Xi(Dt,At,te,he,we,!0),At.length&&qt.push(At)}if(qt.length){if(Ze.lineMetrics&&Oe==="LineString"){for(const Dt of qt)ee.push(Di(Le.id,Oe,Dt,Le.tags));continue}Oe!=="LineString"&&Oe!=="MultiLineString"||(qt.length===1?(Oe="LineString",qt=qt[0]):Oe="MultiLineString"),Oe!=="Point"&&Oe!=="MultiPoint"||(Oe=qt.length===3?"Point":"MultiPoint"),ee.push(Di(Le.id,Oe,qt,Le.tags))}}return ee.length?ee:null}function xn(be,ie,te,he,we){for(let je=0;je<be.length;je+=3){const Ne=be[je+we];Ne>=te&&Ne<=he&&Ki(ie,be[je],be[je+1],be[je+2])}}function Hn(be,ie,te,he,we,je,Ne){let Ze=es(be);const ee=we===0?Wi:gs;let Le,Ue,Oe=be.start;for(let At=0;At<be.length-3;At+=3){const ti=be[At],pi=be[At+1],ji=be[At+2],Qi=be[At+3],gi=be[At+4],qi=we===0?ti:pi,on=we===0?Qi:gi;let Qe=!1;Ne&&(Le=Math.sqrt(Math.pow(ti-Qi,2)+Math.pow(pi-gi,2))),qi<te?on>te&&(Ue=ee(Ze,ti,pi,Qi,gi,te),Ne&&(Ze.start=Oe+Le*Ue)):qi>he?on<he&&(Ue=ee(Ze,ti,pi,Qi,gi,he),Ne&&(Ze.start=Oe+Le*Ue)):Ki(Ze,ti,pi,ji),on<te&&qi>=te&&(Ue=ee(Ze,ti,pi,Qi,gi,te),Qe=!0),on>he&&qi<=he&&(Ue=ee(Ze,ti,pi,Qi,gi,he),Qe=!0),!je&&Qe&&(Ne&&(Ze.end=Oe+Le*Ue),ie.push(Ze),Ze=es(be)),Ne&&(Oe+=Le)}let Ve=be.length-3;const Bt=be[Ve],qt=be[Ve+1],Dt=we===0?Bt:qt;Dt>=te&&Dt<=he&&Ki(Ze,Bt,qt,be[Ve+2]),Ve=Ze.length-3,je&&Ve>=3&&(Ze[Ve]!==Ze[0]||Ze[Ve+1]!==Ze[1])&&Ki(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&ie.push(Ze)}function es(be){const ie=[];return ie.size=be.size,ie.start=be.start,ie.end=be.end,ie}function Xi(be,ie,te,he,we,je){for(const Ne of be)Hn(Ne,ie,te,he,we,je,!1)}function Ki(be,ie,te,he){be.push(ie,te,he)}function Wi(be,ie,te,he,we,je){const Ne=(je-ie)/(he-ie);return Ki(be,je,te+(we-te)*Ne,1),Ne}function gs(be,ie,te,he,we,je){const Ne=(je-te)/(we-te);return Ki(be,ie+(he-ie)*Ne,je,1),Ne}function Ct(be,ie){const te=[];for(let he=0;he<be.length;he++){const we=be[he],je=we.type;let Ne;if(je==="Point"||je==="MultiPoint"||je==="LineString")Ne=In(we.geometry,ie);else if(je==="MultiLineString"||je==="Polygon"){Ne=[];for(const Ze of we.geometry)Ne.push(In(Ze,ie))}else if(je==="MultiPolygon"){Ne=[];for(const Ze of we.geometry){const ee=[];for(const Le of Ze)ee.push(In(Le,ie));Ne.push(ee)}}te.push(Di(we.id,je,Ne,we.tags))}return te}function In(be,ie){const te=[];te.size=be.size,be.start!==void 0&&(te.start=be.start,te.end=be.end);for(let he=0;he<be.length;he+=3)te.push(be[he]+ie,be[he+1],be[he+2]);return te}function an(be,ie){if(be.transformed)return be;const te=1<<be.z,he=be.x,we=be.y;for(const je of be.features){const Ne=je.geometry,Ze=je.type;if(je.geometry=[],Ze===1)for(let ee=0;ee<Ne.length;ee+=2)je.geometry.push(Tn(Ne[ee],Ne[ee+1],ie,te,he,we));else for(let ee=0;ee<Ne.length;ee++){const Le=[];for(let Ue=0;Ue<Ne[ee].length;Ue+=2)Le.push(Tn(Ne[ee][Ue],Ne[ee][Ue+1],ie,te,he,we));je.geometry.push(Le)}}return be.transformed=!0,be}function Tn(be,ie,te,he,we,je){return[Math.round(te*(be*he-we)),Math.round(te*(ie*he-je))]}function Zn(be,ie,te,he,we){const je=ie===we.maxZoom?0:we.tolerance/((1<<ie)*we.extent),Ne={features:[],numPoints:0,numSimplified:0,numFeatures:be.length,source:null,x:te,y:he,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ze of be)jt(Ne,Ze,je,we);return Ne}function jt(be,ie,te,he){const we=ie.geometry,je=ie.type,Ne=[];if(be.minX=Math.min(be.minX,ie.minX),be.minY=Math.min(be.minY,ie.minY),be.maxX=Math.max(be.maxX,ie.maxX),be.maxY=Math.max(be.maxY,ie.maxY),je==="Point"||je==="MultiPoint")for(let Ze=0;Ze<we.length;Ze+=3)Ne.push(we[Ze],we[Ze+1]),be.numPoints++,be.numSimplified++;else if(je==="LineString")ri(Ne,we,be,te,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let Ze=0;Ze<we.length;Ze++)ri(Ne,we[Ze],be,te,je==="Polygon",Ze===0);else if(je==="MultiPolygon")for(let Ze=0;Ze<we.length;Ze++){const ee=we[Ze];for(let Le=0;Le<ee.length;Le++)ri(Ne,ee[Le],be,te,!0,Le===0)}if(Ne.length){let Ze=ie.tags||null;if(je==="LineString"&&he.lineMetrics){Ze={};for(const Le in ie.tags)Ze[Le]=ie.tags[Le];Ze.mapbox_clip_start=we.start/we.size,Ze.mapbox_clip_end=we.end/we.size}const ee={geometry:Ne,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:Ze};ie.id!==null&&(ee.id=ie.id),be.features.push(ee)}}function ri(be,ie,te,he,we,je){const Ne=he*he;if(he>0&&ie.size<(we?Ne:he))return void(te.numPoints+=ie.length/3);const Ze=[];for(let ee=0;ee<ie.length;ee+=3)(he===0||ie[ee+2]>Ne)&&(te.numSimplified++,Ze.push(ie[ee],ie[ee+1])),te.numPoints++;we&&(function(ee,Le){let Ue=0;for(let Oe=0,Ve=ee.length,Bt=Ve-2;Oe<Ve;Bt=Oe,Oe+=2)Ue+=(ee[Oe]-ee[Bt])*(ee[Oe+1]+ee[Bt+1]);if(Ue>0===Le)for(let Oe=0,Ve=ee.length;Oe<Ve/2;Oe+=2){const Bt=ee[Oe],qt=ee[Oe+1];ee[Oe]=ee[Ve-2-Oe],ee[Oe+1]=ee[Ve-1-Oe],ee[Ve-2-Oe]=Bt,ee[Ve-1-Oe]=qt}})(Ze,je),be.push(Ze)}const Jt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Bi{constructor(ie,te){const he=(te=this.options=(function(je,Ne){for(const Ze in Ne)je[Ze]=Ne[Ze];return je})(Object.create(Jt),te)).debug;if(he&&console.time("preprocess data"),te.maxZoom<0||te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(te.promoteId&&te.generateId)throw new Error("promoteId and generateId cannot be used together.");let we=(function(je,Ne){const Ze=[];if(je.type==="FeatureCollection")for(let ee=0;ee<je.features.length;ee++)hn(Ze,je.features[ee],Ne,ee);else hn(Ze,je.type==="Feature"?je:{geometry:je},Ne);return Ze})(ie,te);this.tiles={},this.tileCoords=[],he&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",te.indexMaxZoom,te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),we=(function(je,Ne){const Ze=Ne.buffer/Ne.extent;let ee=je;const Le=fi(je,1,-1-Ze,Ze,0,-1,2,Ne),Ue=fi(je,1,1-Ze,2+Ze,0,-1,2,Ne);return(Le||Ue)&&(ee=fi(je,1,-Ze,1+Ze,0,-1,2,Ne)||[],Le&&(ee=Ct(Le,1).concat(ee)),Ue&&(ee=ee.concat(Ct(Ue,-1)))),ee})(we,te),we.length&&this.splitTile(we,0,0,0),he&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ie,te,he,we,je,Ne,Ze){const ee=[ie,te,he,we],Le=this.options,Ue=Le.debug;for(;ee.length;){we=ee.pop(),he=ee.pop(),te=ee.pop(),ie=ee.pop();const Oe=1<<te,Ve=jn(te,he,we);let Bt=this.tiles[Ve];if(!Bt&&(Ue>1&&console.time("creation"),Bt=this.tiles[Ve]=Zn(ie,te,he,we,Le),this.tileCoords.push({z:te,x:he,y:we}),Ue)){Ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",te,he,we,Bt.numFeatures,Bt.numPoints,Bt.numSimplified),console.timeEnd("creation"));const Qe=`z${te}`;this.stats[Qe]=(this.stats[Qe]||0)+1,this.total++}if(Bt.source=ie,je==null){if(te===Le.indexMaxZoom||Bt.numPoints<=Le.indexMaxPoints)continue}else{if(te===Le.maxZoom||te===je)continue;if(je!=null){const Qe=je-te;if(he!==Ne>>Qe||we!==Ze>>Qe)continue}}if(Bt.source=null,ie.length===0)continue;Ue>1&&console.time("clipping");const qt=.5*Le.buffer/Le.extent,Dt=.5-qt,At=.5+qt,ti=1+qt;let pi=null,ji=null,Qi=null,gi=null,qi=fi(ie,Oe,he-qt,he+At,0,Bt.minX,Bt.maxX,Le),on=fi(ie,Oe,he+Dt,he+ti,0,Bt.minX,Bt.maxX,Le);ie=null,qi&&(pi=fi(qi,Oe,we-qt,we+At,1,Bt.minY,Bt.maxY,Le),ji=fi(qi,Oe,we+Dt,we+ti,1,Bt.minY,Bt.maxY,Le),qi=null),on&&(Qi=fi(on,Oe,we-qt,we+At,1,Bt.minY,Bt.maxY,Le),gi=fi(on,Oe,we+Dt,we+ti,1,Bt.minY,Bt.maxY,Le),on=null),Ue>1&&console.timeEnd("clipping"),ee.push(pi||[],te+1,2*he,2*we),ee.push(ji||[],te+1,2*he,2*we+1),ee.push(Qi||[],te+1,2*he+1,2*we),ee.push(gi||[],te+1,2*he+1,2*we+1)}}getTile(ie,te,he){ie=+ie,te=+te,he=+he;const we=this.options,{extent:je,debug:Ne}=we;if(ie<0||ie>24)return null;const Ze=1<<ie,ee=jn(ie,te=te+Ze&Ze-1,he);if(this.tiles[ee])return an(this.tiles[ee],je);Ne>1&&console.log("drilling down to z%d-%d-%d",ie,te,he);let Le,Ue=ie,Oe=te,Ve=he;for(;!Le&&Ue>0;)Ue--,Oe>>=1,Ve>>=1,Le=this.tiles[jn(Ue,Oe,Ve)];return Le&&Le.source?(Ne>1&&(console.log("found parent tile z%d-%d-%d",Ue,Oe,Ve),console.time("drilling down")),this.splitTile(Le.source,Ue,Oe,Ve,ie,te,he),Ne>1&&console.timeEnd("drilling down"),this.tiles[ee]?an(this.tiles[ee],je):null):null}}function jn(be,ie,te){return 32*((1<<be)*te+ie)+be}function ci(be,ie){return ie?be.properties[ie]:be.id}function xs(be,ie){if(be==null)return!0;if(be.type==="Feature")return ci(be,ie)!=null;if(be.type==="FeatureCollection"){const te=new Set;for(const he of be.features){const we=ci(he,ie);if(we==null||te.has(we))return!1;te.add(we)}return!0}return!1}function Dn(be,ie){const te=new Map;if(be!=null)if(be.type==="Feature")te.set(ci(be,ie),be);else for(const he of be.features)te.set(ci(he,ie),he);return te}class $n extends N{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ie,te){return y._(this,void 0,void 0,(function*(){const he=ie.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const we=this._geoJSONIndex.getTile(he.z,he.x,he.y);if(!we)return null;const je=new class{constructor(Ze){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.X,this.length=Ze.length,this._features=Ze}feature(Ze){return new class{constructor(ee){this._feature=ee,this.extent=y.X,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(this._feature.type===1){const ee=[];for(const Le of this._feature.geometry)ee.push([new y.P(Le[0],Le[1])]);return ee}{const ee=[];for(const Le of this._feature.geometry){const Ue=[];for(const Oe of Le)Ue.push(new y.P(Oe[0],Oe[1]));ee.push(Ue)}return ee}}toGeoJSON(ee,Le,Ue){return ve.call(this,ee,Le,Ue)}}(this._features[Ze])}}(we.features);let Ne=ct(je);return Ne.byteOffset===0&&Ne.byteLength===Ne.buffer.byteLength||(Ne=new Uint8Array(Ne)),{vectorTile:je,rawData:Ne.buffer}}))}loadData(ie){return y._(this,void 0,void 0,(function*(){var te;(te=this._pendingRequest)===null||te===void 0||te.abort();const he=!!(ie&&ie.request&&ie.request.collectResourceTiming)&&new y.bv(ie.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ie,this._pendingRequest),this._geoJSONIndex=ie.cluster?new ot((function({superclusterOptions:Ne,clusterProperties:Ze}){if(!Ze||!Ne)return Ne;const ee={},Le={},Ue={accumulated:null,zoom:0},Oe={properties:null},Ve=Object.keys(Ze);for(const Bt of Ve){const[qt,Dt]=Ze[Bt],At=y.bC(Dt),ti=y.bC(typeof qt=="string"?[qt,["accumulated"],["get",Bt]]:qt);ee[Bt]=At.value,Le[Bt]=ti.value}return Ne.map=Bt=>{Oe.properties=Bt;const qt={};for(const Dt of Ve)qt[Dt]=ee[Dt].evaluate(Ue,Oe);return qt},Ne.reduce=(Bt,qt)=>{Oe.properties=qt;for(const Dt of Ve)Ue.accumulated=Bt[Dt],Bt[Dt]=Le[Dt].evaluate(Ue,Oe)},Ne})(ie)).load((yield this._pendingData).features):(we=yield this._pendingData,new Bi(we,ie.geojsonVtOptions)),this.loaded={};const je={};if(he){const Ne=he.finish();Ne&&(je.resourceTiming={},je.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Ne)))}return je}catch(je){if(delete this._pendingRequest,y.bB(je))return{abandoned:!0};throw je}var we}))}getData(){return y._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(ie){const te=this.loaded;return te&&te[ie.uid]?super.reloadTile(ie):this.loadTile(ie)}loadAndProcessGeoJSON(ie,te){return y._(this,void 0,void 0,(function*(){let he=yield this.loadGeoJSON(ie,te);if(delete this._pendingRequest,typeof he!="object")throw new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`);if(ne(he,!0),ie.filter){const we=y.bC(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(we.result==="error")throw new Error(we.value.map((Ne=>`${Ne.key}: ${Ne.message}`)).join(", "));he={type:"FeatureCollection",features:he.features.filter((Ne=>we.value.evaluate({zoom:0},Ne)))}}return he}))}loadGeoJSON(ie,te){return y._(this,void 0,void 0,(function*(){const{promoteId:he}=ie;if(ie.request){const we=yield y.h(ie.request,te);return this._dataUpdateable=xs(we.data,he)?Dn(we.data,he):void 0,we.data}if(typeof ie.data=="string")try{const we=JSON.parse(ie.data);return this._dataUpdateable=xs(we,he)?Dn(we,he):void 0,we}catch{throw new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`)}if(!ie.dataDiff)throw new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ie.source}`);return(function(we,je,Ne){var Ze,ee,Le,Ue;if(je.removeAll&&we.clear(),je.remove)for(const Oe of je.remove)we.delete(Oe);if(je.add)for(const Oe of je.add){const Ve=ci(Oe,Ne);Ve!=null&&we.set(Ve,Oe)}if(je.update)for(const Oe of je.update){let Ve=we.get(Oe.id);if(Ve==null)continue;const Bt=!Oe.removeAllProperties&&(((Ze=Oe.removeProperties)===null||Ze===void 0?void 0:Ze.length)>0||((ee=Oe.addOrUpdateProperties)===null||ee===void 0?void 0:ee.length)>0);if((Oe.newGeometry||Oe.removeAllProperties||Bt)&&(Ve=Object.assign({},Ve),we.set(Oe.id,Ve),Bt&&(Ve.properties=Object.assign({},Ve.properties))),Oe.newGeometry&&(Ve.geometry=Oe.newGeometry),Oe.removeAllProperties)Ve.properties={};else if(((Le=Oe.removeProperties)===null||Le===void 0?void 0:Le.length)>0)for(const qt of Oe.removeProperties)Object.prototype.hasOwnProperty.call(Ve.properties,qt)&&delete Ve.properties[qt];if(((Ue=Oe.addOrUpdateProperties)===null||Ue===void 0?void 0:Ue.length)>0)for(const{key:qt,value:Dt}of Oe.addOrUpdateProperties)Ve.properties[qt]=Dt}})(this._dataUpdateable,ie.dataDiff,he),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(ie){return y._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(ie){return this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId)}getClusterChildren(ie){return this._geoJSONIndex.getChildren(ie.clusterId)}getClusterLeaves(ie){return this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset)}}class Ji{constructor(ie){this.self=ie,this.actor=new y.F(ie),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(te,he)=>{if(this.externalWorkerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.externalWorkerSourceTypes[te]=he},this.self.addProtocol=y.bi,this.self.removeProtocol=y.bj,this.self.registerRTLTextPlugin=te=>{if(y.bD.isParsed())throw new Error("RTL text plugin already registered.");y.bD.setMethods(te)},this.actor.registerMessageHandler("LDT",((te,he)=>this._getDEMWorkerSource(te,he.source).loadTile(he))),this.actor.registerMessageHandler("RDT",((te,he)=>y._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(te,he.source).removeTile(he)})))),this.actor.registerMessageHandler("GCEZ",((te,he)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(te,he.type,he.source).getClusterExpansionZoom(he)})))),this.actor.registerMessageHandler("GCC",((te,he)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(te,he.type,he.source).getClusterChildren(he)})))),this.actor.registerMessageHandler("GCL",((te,he)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(te,he.type,he.source).getClusterLeaves(he)})))),this.actor.registerMessageHandler("LD",((te,he)=>this._getWorkerSource(te,he.type,he.source).loadData(he))),this.actor.registerMessageHandler("GD",((te,he)=>this._getWorkerSource(te,he.type,he.source).getData())),this.actor.registerMessageHandler("LT",((te,he)=>this._getWorkerSource(te,he.type,he.source).loadTile(he))),this.actor.registerMessageHandler("RT",((te,he)=>this._getWorkerSource(te,he.type,he.source).reloadTile(he))),this.actor.registerMessageHandler("AT",((te,he)=>this._getWorkerSource(te,he.type,he.source).abortTile(he))),this.actor.registerMessageHandler("RMT",((te,he)=>this._getWorkerSource(te,he.type,he.source).removeTile(he))),this.actor.registerMessageHandler("RS",((te,he)=>y._(this,void 0,void 0,(function*(){if(!this.workerSources[te]||!this.workerSources[te][he.type]||!this.workerSources[te][he.type][he.source])return;const we=this.workerSources[te][he.type][he.source];delete this.workerSources[te][he.type][he.source],we.removeSource!==void 0&&we.removeSource(he)})))),this.actor.registerMessageHandler("RM",(te=>y._(this,void 0,void 0,(function*(){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te]})))),this.actor.registerMessageHandler("SR",((te,he)=>y._(this,void 0,void 0,(function*(){this.referrer=he})))),this.actor.registerMessageHandler("SRPS",((te,he)=>this._syncRTLPluginState(te,he))),this.actor.registerMessageHandler("IS",((te,he)=>y._(this,void 0,void 0,(function*(){this.self.importScripts(he)})))),this.actor.registerMessageHandler("SI",((te,he)=>this._setImages(te,he))),this.actor.registerMessageHandler("UL",((te,he)=>y._(this,void 0,void 0,(function*(){this._getLayerIndex(te).update(he.layers,he.removedIds)})))),this.actor.registerMessageHandler("SL",((te,he)=>y._(this,void 0,void 0,(function*(){this._getLayerIndex(te).replace(he)}))))}_setImages(ie,te){return y._(this,void 0,void 0,(function*(){this.availableImages[ie]=te;for(const he in this.workerSources[ie]){const we=this.workerSources[ie][he];for(const je in we)we[je].availableImages=te}}))}_syncRTLPluginState(ie,te){return y._(this,void 0,void 0,(function*(){if(y.bD.isParsed())return y.bD.getState();if(te.pluginStatus!=="loading")return y.bD.setState(te),te;const he=te.pluginURL;if(this.self.importScripts(he),y.bD.isParsed()){const we={pluginStatus:"loaded",pluginURL:he};return y.bD.setState(we),we}throw y.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${he}`)}))}_getAvailableImages(ie){let te=this.availableImages[ie];return te||(te=[]),te}_getLayerIndex(ie){let te=this.layerIndexes[ie];return te||(te=this.layerIndexes[ie]=new d),te}_getWorkerSource(ie,te,he){if(this.workerSources[ie]||(this.workerSources[ie]={}),this.workerSources[ie][te]||(this.workerSources[ie][te]={}),!this.workerSources[ie][te][he]){const we={sendAsync:(je,Ne)=>(je.targetMapId=ie,this.actor.sendAsync(je,Ne))};switch(te){case"vector":this.workerSources[ie][te][he]=new N(we,this._getLayerIndex(ie),this._getAvailableImages(ie));break;case"geojson":this.workerSources[ie][te][he]=new $n(we,this._getLayerIndex(ie),this._getAvailableImages(ie));break;default:this.workerSources[ie][te][he]=new this.externalWorkerSourceTypes[te](we,this._getLayerIndex(ie),this._getAvailableImages(ie))}}return this.workerSources[ie][te][he]}_getDEMWorkerSource(ie,te){return this.demWorkerSources[ie]||(this.demWorkerSources[ie]={}),this.demWorkerSources[ie][te]||(this.demWorkerSources[ie][te]=new V),this.demWorkerSources[ie][te]}}return y.i(self)&&(self.worker=new Ji(self)),Ji})),f("index",["exports","./shared"],(function(y,d){var A="4.7.1";let I,B;const N={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:E=>new Promise(((i,h)=>{const g=requestAnimationFrame(i);E.signal.addEventListener("abort",(()=>{cancelAnimationFrame(g),h(d.c())}))})),getImageData(E,i=0){return this.getImageCanvasContext(E).getImageData(-i,-i,E.width+2*i,E.height+2*i)},getImageCanvasContext(E){const i=window.document.createElement("canvas"),h=i.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return i.width=E.width,i.height=E.height,h.drawImage(E,0,0,E.width,E.height),h},resolveURL:E=>(I||(I=document.createElement("a")),I.href=E,I.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class V{static testProp(i){if(!V.docStyle)return i[0];for(let h=0;h<i.length;h++)if(i[h]in V.docStyle)return i[h];return i[0]}static create(i,h,g){const v=window.document.createElement(i);return h!==void 0&&(v.className=h),g&&g.appendChild(v),v}static createNS(i,h){return window.document.createElementNS(i,h)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(i,h){i.style[V.transformProp]=h}static addEventListener(i,h,g,v={}){i.addEventListener(h,g,"passive"in v?v:v.capture)}static removeEventListener(i,h,g,v={}){i.removeEventListener(h,g,"passive"in v?v:v.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",V.suppressClickInternal,!0)}),0)}static getScale(i){const h=i.getBoundingClientRect();return{x:h.width/i.offsetWidth||1,y:h.height/i.offsetHeight||1,boundingClientRect:h}}static getPoint(i,h,g){const v=h.boundingClientRect;return new d.P((g.clientX-v.left)/h.x-i.clientLeft,(g.clientY-v.top)/h.y-i.clientTop)}static mousePos(i,h){const g=V.getScale(i);return V.getPoint(i,g,h)}static touchPos(i,h){const g=[],v=V.getScale(i);for(let T=0;T<h.length;T++)g.push(V.getPoint(i,v,h[T]));return g}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);const K={supported:!1,testSupport:function(E){!ve&&ne&&(re?ge(E):se=E)}};let se,ne,ve=!1,re=!1;function ge(E){const i=E.createTexture();E.bindTexture(E.TEXTURE_2D,i);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,ne),E.isContextLost())return;K.supported=!0}catch{}E.deleteTexture(i),ve=!0}var oe;typeof document<"u"&&(ne=document.createElement("img"),ne.onload=()=>{se&&ge(se),se=null,re=!0},ne.onerror=()=>{ve=!0,se=null},ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(E){let i,h,g,v;E.resetRequestQueue=()=>{i=[],h=0,g=0,v={}},E.addThrottleControl=U=>{const H=g++;return v[H]=U,H},E.removeThrottleControl=U=>{delete v[U],R()},E.getImage=(U,H,Y=!0)=>new Promise(((X,le)=>{K.supported&&(U.headers||(U.headers={}),U.headers.accept="image/webp,*/*"),d.e(U,{type:"image"}),i.push({abortController:H,requestParameters:U,supportImageRefresh:Y,state:"queued",onError:fe=>{le(fe)},onSuccess:fe=>{X(fe)}}),R()}));const T=U=>d._(this,void 0,void 0,(function*(){U.state="running";const{requestParameters:H,supportImageRefresh:Y,onError:X,onSuccess:le,abortController:fe}=U,_e=Y===!1&&!d.i(self)&&!d.g(H.url)&&(!H.headers||Object.keys(H.headers).reduce(((Ie,ze)=>Ie&&ze==="accept"),!0));h++;const Ee=_e?O(H,fe):d.m(H,fe);try{const Ie=yield Ee;delete U.abortController,U.state="completed",Ie.data instanceof HTMLImageElement||d.b(Ie.data)?le(Ie):Ie.data&&le({data:yield(Pe=Ie.data,typeof createImageBitmap=="function"?d.d(Pe):d.f(Pe)),cacheControl:Ie.cacheControl,expires:Ie.expires})}catch(Ie){delete U.abortController,X(Ie)}finally{h--,R()}var Pe})),R=()=>{const U=(()=>{for(const H of Object.keys(v))if(v[H]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let H=h;H<U&&i.length>0;H++){const Y=i.shift();Y.abortController.signal.aborted?H--:T(Y)}},O=(U,H)=>new Promise(((Y,X)=>{const le=new Image,fe=U.url,_e=U.credentials;_e&&_e==="include"?le.crossOrigin="use-credentials":(_e&&_e==="same-origin"||!d.s(fe))&&(le.crossOrigin="anonymous"),H.signal.addEventListener("abort",(()=>{le.src="",X(d.c())})),le.fetchPriority="high",le.onload=()=>{le.onerror=le.onload=null,Y({data:le})},le.onerror=()=>{le.onerror=le.onload=null,H.signal.aborted||X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},le.src=fe}))})(oe||(oe={})),oe.resetRequestQueue();class me{constructor(i){this._transformRequestFn=i}transformRequest(i,h){return this._transformRequestFn&&this._transformRequestFn(i,h)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function ye(E){var i=new d.A(3);return i[0]=E[0],i[1]=E[1],i[2]=E[2],i}var ke,Re=function(E,i,h){return E[0]=i[0]-h[0],E[1]=i[1]-h[1],E[2]=i[2]-h[2],E};ke=new d.A(3),d.A!=Float32Array&&(ke[0]=0,ke[1]=0,ke[2]=0);var Ge=function(E){var i=E[0],h=E[1];return i*i+h*h};function He(E){const i=[];if(typeof E=="string")i.push({id:"default",url:E});else if(E&&E.length>0){const h=[];for(const{id:g,url:v}of E){const T=`${g}${v}`;h.indexOf(T)===-1&&(h.push(T),i.push({id:g,url:v}))}}return i}function Xe(E,i,h){const g=E.split("?");return g[0]+=`${i}${h}`,g.join("?")}(function(){var E=new d.A(2);d.A!=Float32Array&&(E[0]=0,E[1]=0)})();class at{constructor(i,h,g,v){this.context=i,this.format=g,this.texture=i.gl.createTexture(),this.update(h,v)}update(i,h,g){const{width:v,height:T}=i,R=!(this.size&&this.size[0]===v&&this.size[1]===T||g),{context:O}=this,{gl:U}=O;if(this.useMipmap=!!(h&&h.useMipmap),U.bindTexture(U.TEXTURE_2D,this.texture),O.pixelStoreUnpackFlipY.set(!1),O.pixelStoreUnpack.set(1),O.pixelStoreUnpackPremultiplyAlpha.set(this.format===U.RGBA&&(!h||h.premultiply!==!1)),R)this.size=[v,T],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||d.b(i)?U.texImage2D(U.TEXTURE_2D,0,this.format,this.format,U.UNSIGNED_BYTE,i):U.texImage2D(U.TEXTURE_2D,0,this.format,v,T,0,this.format,U.UNSIGNED_BYTE,i.data);else{const{x:H,y:Y}=g||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||d.b(i)?U.texSubImage2D(U.TEXTURE_2D,0,H,Y,U.RGBA,U.UNSIGNED_BYTE,i):U.texSubImage2D(U.TEXTURE_2D,0,H,Y,v,T,U.RGBA,U.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&U.generateMipmap(U.TEXTURE_2D)}bind(i,h,g){const{context:v}=this,{gl:T}=v;T.bindTexture(T.TEXTURE_2D,this.texture),g!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=T.LINEAR),i!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,i),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,g||i),this.filter=i),h!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,h),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function et(E){const{userImage:i}=E;return!!(i&&i.render&&i.render())&&(E.data.replace(new Uint8Array(i.data.buffer)),!0)}class Et extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:h,promiseResolve:g}of this.requestors)g(this._getImagesForIds(h));this.requestors=[]}}getImage(i){const h=this.images[i];if(h&&!h.data&&h.spriteData){const g=h.spriteData;h.data=new d.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),h.spriteData=null}return h}addImage(i,h){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,h)&&(this.images[i]=h)}_validate(i,h){let g=!0;const v=h.data||h.spriteData;return this._validateStretch(h.stretchX,v&&v.width)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,v&&v.height)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "content" value`))),g=!1),g}_validateStretch(i,h){if(!i)return!0;let g=0;for(const v of i){if(v[0]<g||v[1]<v[0]||h<v[1])return!1;g=v[1]}return!0}_validateContent(i,h){if(!i)return!0;if(i.length!==4)return!1;const g=h.spriteData,v=g&&g.width||h.data.width,T=g&&g.height||h.data.height;return!(i[0]<0||v<i[0]||i[1]<0||T<i[1]||i[2]<0||v<i[2]||i[3]<0||T<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,h,g=!0){const v=this.getImage(i);if(g&&(v.data.width!==h.data.width||v.data.height!==h.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${h.data.width}x${h.data.height}).`);h.version=v.version+1,this.images[i]=h,this.updatedImages[i]=!0}removeImage(i){const h=this.images[i];delete this.images[i],delete this.patterns[i],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise(((h,g)=>{let v=!0;if(!this.isLoaded())for(const T of i)this.images[T]||(v=!1);this.isLoaded()||v?h(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:h})}))}_getImagesForIds(i){const h={};for(const g of i){let v=this.getImage(g);v||(this.fire(new d.k("styleimagemissing",{id:g})),v=this.getImage(g)),v?h[g]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:d.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return h}getPixelSize(){const{width:i,height:h}=this.atlasImage;return{width:i,height:h}}getPattern(i){const h=this.patterns[i],g=this.getImage(i);if(!g)return null;if(h&&h.position.version===g.version)return h.position;if(h)h.position.version=g.version;else{const v={w:g.data.width+2,h:g.data.height+2,x:0,y:0},T=new d.I(v,g);this.patterns[i]={bin:v,position:T}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const h=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new at(i,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const T in this.patterns)i.push(this.patterns[T].bin);const{w:h,h:g}=d.p(i),v=this.atlasImage;v.resize({width:h||1,height:g||1});for(const T in this.patterns){const{bin:R}=this.patterns[T],O=R.x+1,U=R.y+1,H=this.getImage(T).data,Y=H.width,X=H.height;d.R.copy(H,v,{x:0,y:0},{x:O,y:U},{width:Y,height:X}),d.R.copy(H,v,{x:0,y:X-1},{x:O,y:U-1},{width:Y,height:1}),d.R.copy(H,v,{x:0,y:0},{x:O,y:U+X},{width:Y,height:1}),d.R.copy(H,v,{x:Y-1,y:0},{x:O-1,y:U},{width:1,height:X}),d.R.copy(H,v,{x:0,y:0},{x:O+Y,y:U},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const h of i){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const g=this.getImage(h);g||d.w(`Image with ID: "${h}" was not found`),et(g)&&this.updateImage(h,g)}}}const gt=1e20;function pt(E,i,h,g,v,T,R,O,U){for(let H=i;H<i+g;H++)$e(E,h*T+H,T,v,R,O,U);for(let H=h;H<h+v;H++)$e(E,H*T+i,1,g,R,O,U)}function $e(E,i,h,g,v,T,R){T[0]=0,R[0]=-gt,R[1]=gt,v[0]=E[i];for(let O=1,U=0,H=0;O<g;O++){v[O]=E[i+O*h];const Y=O*O;do{const X=T[U];H=(v[O]-v[X]+Y-X*X)/(O-X)/2}while(H<=R[U]&&--U>-1);U++,T[U]=O,R[U]=H,R[U+1]=gt}for(let O=0,U=0;O<g;O++){for(;R[U+1]<O;)U++;const H=T[U],Y=O-H;E[i+O*h]=v[H]+Y*Y}}class ct{constructor(i,h){this.requestManager=i,this.localIdeographFontFamily=h,this.entries={}}setURL(i){this.url=i}getGlyphs(i){return d._(this,void 0,void 0,(function*(){const h=[];for(const T in i)for(const R of i[T])h.push(this._getAndCacheGlyphsPromise(T,R));const g=yield Promise.all(h),v={};for(const{stack:T,id:R,glyph:O}of g)v[T]||(v[T]={}),v[T][R]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};return v}))}_getAndCacheGlyphsPromise(i,h){return d._(this,void 0,void 0,(function*(){let g=this.entries[i];g||(g=this.entries[i]={glyphs:{},requests:{},ranges:{}});let v=g.glyphs[h];if(v!==void 0)return{stack:i,id:h,glyph:v};if(v=this._tinySDF(g,i,h),v)return g.glyphs[h]=v,{stack:i,id:h,glyph:v};const T=Math.floor(h/256);if(256*T>65535)throw new Error("glyphs > 65535 not supported");if(g.ranges[T])return{stack:i,id:h,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!g.requests[T]){const O=ct.loadGlyphRange(i,T,this.url,this.requestManager);g.requests[T]=O}const R=yield g.requests[T];for(const O in R)this._doesCharSupportLocalGlyph(+O)||(g.glyphs[+O]=R[+O]);return g.ranges[T]=!0,{stack:i,id:h,glyph:R[h]||null}}))}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(i))}_tinySDF(i,h,g){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(g))return;let T=i.tinySDF;if(!T){let O="400";/bold/i.test(h)?O="900":/medium/i.test(h)?O="500":/light/i.test(h)&&(O="200"),T=i.tinySDF=new ct.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:v,fontWeight:O})}const R=T.draw(String.fromCharCode(g));return{id:g,bitmap:new d.o({width:R.width||60,height:R.height||60},R.data),metrics:{width:R.glyphWidth/2||24,height:R.glyphHeight/2||24,left:R.glyphLeft/2+.5||0,top:R.glyphTop/2-27.5||-8,advance:R.glyphAdvance/2||24,isDoubleResolution:!0}}}}ct.loadGlyphRange=function(E,i,h,g){return d._(this,void 0,void 0,(function*(){const v=256*i,T=v+255,R=g.transformRequest(h.replace("{fontstack}",E).replace("{range}",`${v}-${T}`),"Glyphs"),O=yield d.l(R,new AbortController);if(!O||!O.data)throw new Error(`Could not load glyph range. range: ${i}, ${v}-${T}`);const U={};for(const H of d.n(O.data))U[H.id]=H;return U}))},ct.TinySDF=class{constructor({fontSize:E=24,buffer:i=3,radius:h=8,cutoff:g=.25,fontFamily:v="sans-serif",fontWeight:T="normal",fontStyle:R="normal"}={}){this.buffer=i,this.cutoff=g,this.radius=h;const O=this.size=E+4*i,U=this._createCanvas(O),H=this.ctx=U.getContext("2d",{willReadFrequently:!0});H.font=`${R} ${T} ${E}px ${v}`,H.textBaseline="alphabetic",H.textAlign="left",H.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Uint16Array(O)}_createCanvas(E){const i=document.createElement("canvas");return i.width=i.height=E,i}draw(E){const{width:i,actualBoundingBoxAscent:h,actualBoundingBoxDescent:g,actualBoundingBoxLeft:v,actualBoundingBoxRight:T}=this.ctx.measureText(E),R=Math.ceil(h),O=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(T-v))),U=Math.min(this.size-this.buffer,R+Math.ceil(g)),H=O+2*this.buffer,Y=U+2*this.buffer,X=Math.max(H*Y,0),le=new Uint8ClampedArray(X),fe={data:le,width:H,height:Y,glyphWidth:O,glyphHeight:U,glyphTop:R,glyphLeft:0,glyphAdvance:i};if(O===0||U===0)return fe;const{ctx:_e,buffer:Ee,gridInner:Pe,gridOuter:Ie}=this;_e.clearRect(Ee,Ee,O,U),_e.fillText(E,Ee,Ee+R);const ze=_e.getImageData(Ee,Ee,O,U);Ie.fill(gt,0,X),Pe.fill(0,0,X);for(let Se=0;Se<U;Se++)for(let Fe=0;Fe<O;Fe++){const Ye=ze.data[4*(Se*O+Fe)+3]/255;if(Ye===0)continue;const rt=(Se+Ee)*H+Fe+Ee;if(Ye===1)Ie[rt]=0,Pe[rt]=gt;else{const bt=.5-Ye;Ie[rt]=bt>0?bt*bt:0,Pe[rt]=bt<0?bt*bt:0}}pt(Ie,0,0,H,Y,H,this.f,this.v,this.z),pt(Pe,Ee,Ee,O,U,H,this.f,this.v,this.z);for(let Se=0;Se<X;Se++){const Fe=Math.sqrt(Ie[Se])-Math.sqrt(Pe[Se]);le[Se]=Math.round(255-255*(Fe/this.radius+this.cutoff))}return fe}};class We{constructor(){this.specification=d.v.light.position}possiblyEvaluate(i,h){return d.x(i.expression.evaluate(h))}interpolate(i,h,g){return{x:d.y.number(i.x,h.x,g),y:d.y.number(i.y,h.y,g),z:d.y.number(i.z,h.z,g)}}}let Tt;class lt extends d.E{constructor(i){super(),Tt=Tt||new d.q({anchor:new d.D(d.v.light.anchor),position:new We,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(Tt),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,h={}){if(!this._validate(d.r,i,h))for(const g in i){const v=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,g){return(!g||g.validate!==!1)&&d.t(this,i.call(d.u,{value:h,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const xe=new d.q({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class Ce extends d.E{constructor(i){super(),this._transitionable=new d.T(xe),this.setSky(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.z(0))}setSky(i,h={}){if(!this._validate(d.B,i,h)){i||(i={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in i){const v=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,g={}){return g?.validate!==!1&&d.t(this,i.call(d.u,d.e({value:h,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(i){return i<60?0:i<70?(i-60)/10:1}}class st{constructor(i,h){this.width=i,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,h){const g=i.join(",")+String(h);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(i,h)),this.dashEntry[g]}getDashRanges(i,h,g){const v=[];let T=i.length%2==1?-i[i.length-1]*g:0,R=i[0]*g,O=!0;v.push({left:T,right:R,isDash:O,zeroLength:i[0]===0});let U=i[0];for(let H=1;H<i.length;H++){O=!O;const Y=i[H];T=U*g,U+=Y,R=U*g,v.push({left:T,right:R,isDash:O,zeroLength:Y===0})}return v}addRoundDash(i,h,g){const v=h/2;for(let T=-g;T<=g;T++){const R=this.width*(this.nextRow+g+T);let O=0,U=i[O];for(let H=0;H<this.width;H++){H/U.right>1&&(U=i[++O]);const Y=Math.abs(H-U.left),X=Math.abs(H-U.right),le=Math.min(Y,X);let fe;const _e=T/g*(v+1);if(U.isDash){const Ee=v-Math.abs(_e);fe=Math.sqrt(le*le+Ee*Ee)}else fe=v-Math.sqrt(le*le+_e*_e);this.data[R+H]=Math.max(0,Math.min(255,fe+128))}}}addRegularDash(i){for(let O=i.length-1;O>=0;--O){const U=i[O],H=i[O+1];U.zeroLength?i.splice(O,1):H&&H.isDash===U.isDash&&(H.left=U.left,i.splice(O,1))}const h=i[0],g=i[i.length-1];h.isDash===g.isDash&&(h.left=g.left-this.width,g.right=h.right+this.width);const v=this.width*this.nextRow;let T=0,R=i[T];for(let O=0;O<this.width;O++){O/R.right>1&&(R=i[++T]);const U=Math.abs(O-R.left),H=Math.abs(O-R.right),Y=Math.min(U,H);this.data[v+O]=Math.max(0,Math.min(255,(R.isDash?Y:-Y)+128))}}addDash(i,h){const g=h?7:0,v=2*g+1;if(this.nextRow+v>this.height)return d.w("LineAtlas out of space"),null;let T=0;for(let O=0;O<i.length;O++)T+=i[O];if(T!==0){const O=this.width/T,U=this.getDashRanges(i,this.width,O);h?this.addRoundDash(U,O,g):this.addRegularDash(U)}const R={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:T};return this.nextRow+=v,this.dirty=!0,R}bind(i){const h=i.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}const ot="maplibre_preloaded_worker_pool";class _t{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<_t.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach((h=>{h.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[ot]}numActive(){return Object.keys(this.active).length}}const kt=Math.floor(N.hardwareConcurrency/2);let It,ei;function li(){return It||(It=new _t),It}_t.workerCount=d.C(globalThis)?Math.max(Math.min(kt,3),1):1;class Gi{constructor(i,h){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=h;const g=this.workerPool.acquire(h);for(let v=0;v<g.length;v++){const T=new d.F(g[v],h);T.name=`Worker ${v}`,this.actors.push(T)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,h){const g=[];for(const v of this.actors)g.push(v.sendAsync({type:i,data:h}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach((h=>{h.remove()})),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,h){for(const g of this.actors)g.registerMessageHandler(i,h)}}function Mi(){return ei||(ei=new Gi(li(),d.G),ei.registerMessageHandler("GR",((E,i,h)=>d.m(i,h)))),ei}function Di(E,i){const h=d.H();return d.J(h,h,[1,1,0]),d.K(h,h,[.5*E.width,.5*E.height,1]),d.L(h,h,E.calculatePosMatrix(i.toUnwrapped()))}function Pn(E,i,h,g,v,T){const R=(function(X,le,fe){if(X)for(const _e of X){const Ee=le[_e];if(Ee&&Ee.source===fe&&Ee.type==="fill-extrusion")return!0}else for(const _e in le){const Ee=le[_e];if(Ee.source===fe&&Ee.type==="fill-extrusion")return!0}return!1})(v&&v.layers,i,E.id),O=T.maxPitchScaleFactor(),U=E.tilesIn(g,O,R);U.sort(hn);const H=[];for(const X of U)H.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(i,h,E._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,v,T,O,Di(E.transform,X.tileID))});const Y=(function(X){const le={},fe={};for(const _e of X){const Ee=_e.queryResults,Pe=_e.wrappedTileID,Ie=fe[Pe]=fe[Pe]||{};for(const ze in Ee){const Se=Ee[ze],Fe=Ie[ze]=Ie[ze]||{},Ye=le[ze]=le[ze]||[];for(const rt of Se)Fe[rt.featureIndex]||(Fe[rt.featureIndex]=!0,Ye.push(rt))}}return le})(H);for(const X in Y)Y[X].forEach((le=>{const fe=le.feature,_e=E.getFeatureState(fe.layer["source-layer"],fe.id);fe.source=fe.layer.source,fe.layer["source-layer"]&&(fe.sourceLayer=fe.layer["source-layer"]),fe.state=_e}));return Y}function hn(E,i){const h=E.tileID,g=i.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}function zn(E,i,h){return d._(this,void 0,void 0,(function*(){let g=E;if(E.url?g=(yield d.h(i.transformRequest(E.url,"Source"),h)).data:yield N.frameAsync(h),!g)return null;const v=d.M(d.e(g,E),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(v.vectorLayerIds=g.vector_layers.map((T=>T.id))),v}))}class it{constructor(i,h){i&&(h?this.setSouthWest(i).setNorthEast(h):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof d.N?new d.N(i.lng,i.lat):d.N.convert(i),this}setSouthWest(i){return this._sw=i instanceof d.N?new d.N(i.lng,i.lat):d.N.convert(i),this}extend(i){const h=this._sw,g=this._ne;let v,T;if(i instanceof d.N)v=i,T=i;else{if(!(i instanceof it))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(it.convert(i)):this.extend(d.N.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(d.N.convert(i)):this;if(v=i._sw,T=i._ne,!v||!T)return this}return h||g?(h.lng=Math.min(v.lng,h.lng),h.lat=Math.min(v.lat,h.lat),g.lng=Math.max(T.lng,g.lng),g.lat=Math.max(T.lat,g.lat)):(this._sw=new d.N(v.lng,v.lat),this._ne=new d.N(T.lng,T.lat)),this}getCenter(){return new d.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.N(this.getWest(),this.getNorth())}getSouthEast(){return new d.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:h,lat:g}=d.N.convert(i);let v=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&v}static convert(i){return i instanceof it?i:i&&new it(i)}static fromLngLat(i,h=0){const g=360*h/40075017,v=g/Math.cos(Math.PI/180*i.lat);return new it(new d.N(i.lng-v,i.lat-g),new d.N(i.lng+v,i.lat+g))}adjustAntiMeridian(){const i=new d.N(this._sw.lng,this._sw.lat),h=new d.N(this._ne.lng,this._ne.lat);return new it(i,i.lng>h.lng?new d.N(h.lng+360,h.lat):h)}}class Qn{constructor(i,h,g){this.bounds=it.convert(this.validateBounds(i)),this.minzoom=h||0,this.maxzoom=g||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const h=Math.pow(2,i.z),g=Math.floor(d.O(this.bounds.getWest())*h),v=Math.floor(d.Q(this.bounds.getNorth())*h),T=Math.ceil(d.O(this.bounds.getEast())*h),R=Math.ceil(d.Q(this.bounds.getSouth())*h);return i.x>=g&&i.x<T&&i.y>=v&&i.y<R}}class qn extends d.E{constructor(i,h,g,v){if(super(),this.id=i,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.M(h,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield zn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(d.e(this,i),i.bounds&&(this.tileBounds=new Qn(i.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new d.j(i))}}))}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}setUrl(i){return this.setSourceProperty((()=>{this.url=i,this._options.url=i})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(h,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};g.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise(((T,R)=>{i.reloadPromise={resolve:T,reject:R}}))}else i.actor=this.dispatcher.getActor(),v="LT";i.abortController=new AbortController;try{const T=yield i.actor.sendAsync({type:v,data:g},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,T)}catch(T){if(delete i.abortController,i.aborted)return;if(T&&T.status!==404)throw T;this._afterTileLoadWorkerResponse(i,null)}}))}_afterTileLoadWorkerResponse(i,h){if(h&&h.resourceTiming&&(i.resourceTiming=h.resourceTiming),h&&this.map._refreshExpiredTiles&&i.setExpiryData(h),i.loadVectorData(h,this.map.painter),i.reloadPromise){const g=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(g.resolve).catch(g.reject)}}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class wi extends d.E{constructor(i,h,g,v){super(),this.id=i,this.dispatcher=g,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},h),d.e(this,d.M(h,["url","scheme","tileSize"]))}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield zn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(d.e(this,i),i.bounds&&(this.tileBounds=new Qn(i.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new d.j(i))}}))}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}setUrl(i){return this.setSourceProperty((()=>{this.url=i,this._options.url=i})),this}serialize(){return d.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const g=yield oe.getImage(this.map._requestManager.transformRequest(h,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&i.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const v=this.map.painter.context,T=v.gl,R=g.data;i.texture=this.map.painter.getTileTexture(R.width),i.texture?i.texture.update(R,{useMipmap:!0}):(i.texture=new at(v,R,T.RGBA,{useMipmap:!0}),i.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST)),i.state="loaded"}}catch(g){if(delete i.abortController,i.aborted)i.state="unloaded";else if(g)throw i.state="errored",g}}))}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)}))}hasTransition(){return!1}}class fi extends wi{constructor(i,h,g,v){super(i,h,g,v),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox",this.redFactor=h.redFactor,this.greenFactor=h.greenFactor,this.blueFactor=h.blueFactor,this.baseShift=h.baseShift}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(h,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const v=yield oe.getImage(g,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(v&&v.data){const T=v.data;this.map._refreshExpiredTiles&&v.cacheControl&&v.expires&&i.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const R=d.b(T)&&d.U()?T:yield this.readImageNow(T),O={type:this.type,uid:i.uid,source:this.id,rawImageData:R,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const U=yield i.actor.sendAsync({type:"LDT",data:O});i.dem=U,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(v){if(delete i.abortController,i.aborted)i.state="unloaded";else if(v)throw i.state="errored",v}}))}readImageNow(i){return d._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&d.V()){const h=i.width+2,g=i.height+2;try{return new d.R({width:h,height:g},yield d.W(i,-1,-1,h,g))}catch{}}return N.getImageData(i,1)}))}_getNeighboringTiles(i){const h=i.canonical,g=Math.pow(2,h.z),v=(h.x-1+g)%g,T=h.x===0?i.wrap-1:i.wrap,R=(h.x+1+g)%g,O=h.x+1===g?i.wrap+1:i.wrap,U={};return U[new d.S(i.overscaledZ,T,h.z,v,h.y).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,R,h.y).key]={backfilled:!1},h.y>0&&(U[new d.S(i.overscaledZ,T,h.z,v,h.y-1).key]={backfilled:!1},U[new d.S(i.overscaledZ,i.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,R,h.y-1).key]={backfilled:!1}),h.y+1<g&&(U[new d.S(i.overscaledZ,T,h.z,v,h.y+1).key]={backfilled:!1},U[new d.S(i.overscaledZ,i.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,R,h.y+1).key]={backfilled:!1}),U}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))}))}}class xn extends d.E{constructor(i,h,g,v){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(v),this._data=h.data,this._options=d.e({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const T=d.X/this.tileSize;h.clusterMaxZoom!==void 0&&this.maxzoom<=h.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${h.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*T,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*T,extent:d.X,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:d.X,radius:(h.clusterRadius||50)*T,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return d._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}getData(){return d._(this,void 0,void 0,(function*(){const i=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})}))}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,h,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:h,offset:g}})}_updateWorkerData(i){return d._(this,void 0,void 0,(function*(){const h=d.e({type:this.type},this.workerOptions);i?h.dataDiff=i:typeof this._data=="string"?(h.request=this.map._requestManager.transformRequest(N.resolveURL(this._data),"Source"),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.k("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:h});if(this._pendingLoads--,this._removed||g.abandoned)return void this.fire(new d.k("dataabort",{dataType:"source"}));let v=null;g.resourceTiming&&g.resourceTiming[this.id]&&(v=g.resourceTiming[this.id].slice(0));const T={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&d.e(T,{resourceTiming:v}),this.fire(new d.k("data",Object.assign(Object.assign({},T),{sourceDataType:"metadata"}))),this.fire(new d.k("data",Object.assign(Object.assign({},T),{sourceDataType:"content"})))}catch(g){if(this._pendingLoads--,this._removed)return void this.fire(new d.k("dataabort",{dataType:"source"}));this.fire(new d.j(g))}}))}loaded(){return this._pendingLoads===0}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.actor?"RT":"LT";i.actor=this.actor;const g={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.abortController=new AbortController;const v=yield this.actor.sendAsync({type:h,data:g},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(v,this.map.painter,h==="RT")}))}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Hn=d.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class es extends d.E{constructor(i,h,g,v){super(),this.id=i,this.dispatcher=g,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h}load(i){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const h=yield oe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,h&&h.data&&(this.image=h.data,i&&(this.coordinates=i),this._finishLoading())}catch(h){this._request=null,this._loaded=!0,this.fire(new d.j(h))}}))}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const h=i.map(d.Z.fromLngLat);this.tileID=(function(v){let T=1/0,R=1/0,O=-1/0,U=-1/0;for(const le of v)T=Math.min(T,le.x),R=Math.min(R,le.y),O=Math.max(O,le.x),U=Math.max(U,le.y);const H=Math.max(O-T,U-R),Y=Math.max(0,Math.floor(-Math.log(H)/Math.LN2)),X=Math.pow(2,Y);return new d.a1(Y,Math.floor((T+O)/2*X),Math.floor((R+U)/2*X))})(h),this.minzoom=this.maxzoom=this.tileID.z;const g=h.map((v=>this.tileID.getTilePoint(v)._round()));return this._boundsArray=new d.$,this._boundsArray.emplaceBack(g[0].x,g[0].y,0,0),this._boundsArray.emplaceBack(g[1].x,g[1].y,d.X,0),this._boundsArray.emplaceBack(g[3].x,g[3].y,0,d.X),this._boundsArray.emplaceBack(g[2].x,g[2].y,d.X,d.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,h=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Hn.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new at(i,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));let g=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return d._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Xi extends es{constructor(i,h,g,v){super(i,h,g,v),this.roundZoom=!0,this.type="video",this.options=h}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const h of i.urls)this.urls.push(this.map._requestManager.transformRequest(h,"Source").url);try{const h=yield d.a3(this.urls);if(this._loaded=!0,!h)return;this.video=h,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(h){this.fire(new d.j(h))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const h=this.video.seekable;i<h.start(0)||i>h.end(0)?this.fire(new d.j(new d.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,h=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Hn.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new at(i,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));let g=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ki extends es{constructor(i,h,g,v){super(i,h,g,v),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some((T=>!Array.isArray(T)||T.length!==2||T.some((R=>typeof R!="number"))))||this.fire(new d.j(new d.a2(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.j(new d.a2(`sources.${i}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new d.j(new d.a2(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new d.j(new d.a2(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.j(new d.a2(`sources.${i}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context,g=h.gl;this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Hn.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new at(h,this.canvas,g.RGBA,{premultiply:!0});let v=!1;for(const T in this.tiles){const R=this.tiles[T];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,v=!0)}v&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const Wi={},gs=E=>{switch(E){case"geojson":return xn;case"image":return es;case"raster":return wi;case"raster-dem":return fi;case"vector":return qn;case"video":return Xi;case"canvas":return Ki}return Wi[E]},Ct="RTLPluginLoaded";class In extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Mi()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch((h=>{throw this.status="error",h}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return d._(this,arguments,void 0,(function*(h,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=N.resolveURL(h),!this.url)throw new Error(`requested url ${h} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return d._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.k(Ct))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let an=null;function Tn(){return an||(an=new In),an}class Zn{constructor(i,h){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=d.a4(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const h=i+this.timeAdded;h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,h,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=(function(v,T){const R={};if(!T)return R;for(const O of v){const U=O.layerIds.map((H=>T.getLayer(H))).filter(Boolean);if(U.length!==0){O.layers=U,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map((H=>U.filter((Y=>Y.id===H))[0])));for(const H of U)R[H.id]=O}}return R})(i.buckets,h.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const T=this.buckets[v];if(T instanceof d.a6){if(this.hasSymbolBuckets=!0,!g)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const T=this.buckets[v];if(T instanceof d.a6&&T.hasRTLText){this.hasRTLText=!0,Tn().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(v).queryRadius(T))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new d.a5}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const g in this.buckets){const v=this.buckets[g];v.uploadPending()&&v.upload(i)}const h=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new at(i,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new at(i,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,h,g,v,T,R,O,U,H,Y){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:T,scale:R,tileSize:this.tileSize,pixelPosMatrix:Y,transform:U,params:O,queryPadding:this.queryPadding*H},i,h,g):{}}querySourceFeatures(i,h){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const v=g.loadVTLayers(),T=h&&h.sourceLayer?h.sourceLayer:"",R=v._geojsonTileLayer||v[T];if(!R)return;const O=d.a7(h&&h.filter),{z:U,x:H,y:Y}=this.tileID.canonical,X={z:U,x:H,y:Y};for(let le=0;le<R.length;le++){const fe=R.feature(le);if(O.needGeometry){const Pe=d.a8(fe,!0);if(!O.filter(new d.z(this.tileID.overscaledZ),Pe,this.tileID.canonical))continue}else if(!O.filter(new d.z(this.tileID.overscaledZ),fe))continue;const _e=g.getId(fe,T),Ee=new d.a9(fe,U,H,Y,_e);Ee.tile=X,i.push(Ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const h=this.expirationTime;if(i.cacheControl){const g=d.aa(i.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const g=Date.now();let v=!1;if(this.expirationTime>g)v=!1;else if(h)if(this.expirationTime<h)v=!0;else{const T=this.expirationTime-h;T?this.expirationTime=g+Math.max(T,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!h.style.hasLayer(v))continue;const T=this.buckets[v],R=T.layers[0].sourceLayer||"_geojsonTileLayer",O=g[R],U=i[R];if(!O||!U||Object.keys(U).length===0)continue;T.update(U,O,this.imageAtlas&&this.imageAtlas.patternPositions||{});const H=h&&h.style&&h.style.getLayer(v);H&&(this.queryPadding=Math.max(this.queryPadding,H.queryRadius(T)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=N.now()+i}setDependencies(i,h){const g={};for(const v of h)g[v]=!0;this.dependencies[i]=g}hasDependency(i,h){for(const g of i){const v=this.dependencies[g];if(v){for(const T of h)if(v[T])return!0}}return!1}}class jt{constructor(i,h){this.max=i,this.onRemove=h,this.reset()}reset(){for(const i in this.data)for(const h of this.data[i])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(i,h,g){const v=i.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const T={value:h,timeout:void 0};if(g!==void 0&&(T.timeout=setTimeout((()=>{this.remove(i,T)}),g)),this.data[v].push(T),this.order.push(v),this.order.length>this.max){const R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const h=this.data[i].shift();return h.timeout&&clearTimeout(h.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),h.value}getByKey(i){const h=this.data[i];return h?h[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,h){if(!this.has(i))return this;const g=i.wrapped().key,v=h===void 0?0:this.data[g].indexOf(h),T=this.data[g][v];return this.data[g].splice(v,1),T.timeout&&clearTimeout(T.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(T.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(i){const h=[];for(const g in this.data)for(const v of this.data[g])i(v.value)||h.push(v);for(const g of h)this.remove(g.value.tileID,g)}}class ri{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,h,g){const v=String(h);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][v]=this.stateChanges[i][v]||{},d.e(this.stateChanges[i][v],g),this.deletedStates[i]===null){this.deletedStates[i]={};for(const T in this.state[i])T!==v&&(this.deletedStates[i][T]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][v]===null){this.deletedStates[i][v]={};for(const T in this.state[i][v])g[T]||(this.deletedStates[i][v][T]=null)}else for(const T in g)this.deletedStates[i]&&this.deletedStates[i][v]&&this.deletedStates[i][v][T]===null&&delete this.deletedStates[i][v][T]}removeFeatureState(i,h,g){if(this.deletedStates[i]===null)return;const v=String(h);if(this.deletedStates[i]=this.deletedStates[i]||{},g&&h!==void 0)this.deletedStates[i][v]!==null&&(this.deletedStates[i][v]=this.deletedStates[i][v]||{},this.deletedStates[i][v][g]=null);else if(h!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][v])for(g in this.deletedStates[i][v]={},this.stateChanges[i][v])this.deletedStates[i][v][g]=null;else this.deletedStates[i][v]=null;else this.deletedStates[i]=null}getState(i,h){const g=String(h),v=d.e({},(this.state[i]||{})[g],(this.stateChanges[i]||{})[g]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const T=this.deletedStates[i][h];if(T===null)return{};for(const R in T)delete v[R]}return v}initializeTileState(i,h){i.setFeatureState(this.state,h)}coalesceChanges(i,h){const g={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const T={};for(const R in this.stateChanges[v])this.state[v][R]||(this.state[v][R]={}),d.e(this.state[v][R],this.stateChanges[v][R]),T[R]=this.state[v][R];g[v]=T}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const T={};if(this.deletedStates[v]===null)for(const R in this.state[v])T[R]={},this.state[v][R]={};else for(const R in this.deletedStates[v]){if(this.deletedStates[v][R]===null)this.state[v][R]={};else for(const O of Object.keys(this.deletedStates[v][R]))delete this.state[v][R][O];T[R]=this.state[v][R]}g[v]=g[v]||{},d.e(g[v],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const v in i)i[v].setFeatureState(g,h)}}class Jt extends d.E{constructor(i,h,g){super(),this.id=i,this.dispatcher=g,this.on("data",(v=>this._dataHandler(v))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((v,T,R,O)=>{const U=new(gs(T.type))(v,T,R,O);if(U.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${U.id}`);return U})(i,h,g,this),this._tiles={},this._cache=new jt(0,(v=>this._unloadTile(v))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ri,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const h=this._tiles[i];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,h,g){return d._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,h,g)}catch(v){i.state="errored",v.status!==404?this._source.fire(new d.j(v,{tile:i})):this.update(this.transform,this.terrain)}}))}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new d.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const g=this._tiles[h];g.upload(i),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((i=>i.tileID)).sort(Bi).map((i=>i.key))}getRenderableIds(i){const h=[];for(const g in this._tiles)this._isIdRenderable(g,i)&&h.push(this._tiles[g]);return i?h.sort(((g,v)=>{const T=g.tileID,R=v.tileID,O=new d.P(T.canonical.x,T.canonical.y)._rotate(this.transform.angle),U=new d.P(R.canonical.x,R.canonical.y)._rotate(this.transform.angle);return T.overscaledZ-R.overscaledZ||U.y-O.y||U.x-O.x})).map((g=>g.tileID.key)):h.map((g=>g.tileID)).sort(Bi).map((g=>g.key))}hasRenderableParent(i){const h=this.findLoadedParent(i,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(i,h){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(h||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,h){return d._(this,void 0,void 0,(function*(){const g=this._tiles[i];g&&(g.state!=="loading"&&(g.state=h),yield this._loadTile(g,i,h))}))}_tileLoaded(i,h,g){i.timeAdded=N.now(),g==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(h,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new d.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const h=this.getRenderableIds();for(let v=0;v<h.length;v++){const T=h[v];if(i.neighboringTiles&&i.neighboringTiles[T]){const R=this.getTileByID(T);g(i,R),g(R,i)}}function g(v,T){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let R=T.tileID.canonical.x-v.tileID.canonical.x;const O=T.tileID.canonical.y-v.tileID.canonical.y,U=Math.pow(2,v.tileID.canonical.z),H=T.tileID.key;R===0&&O===0||Math.abs(O)>1||(Math.abs(R)>1&&(Math.abs(R+U)===1?R+=U:Math.abs(R-U)===1&&(R-=U)),T.dem&&v.dem&&(v.dem.backfillBorder(T.dem,R,O),v.neighboringTiles&&v.neighboringTiles[H]&&(v.neighboringTiles[H].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,h,g,v){for(const T in this._tiles){let R=this._tiles[T];if(v[T]||!R.hasData()||R.tileID.overscaledZ<=h||R.tileID.overscaledZ>g)continue;let O=R.tileID;for(;R&&R.tileID.overscaledZ>h+1;){const H=R.tileID.scaledTo(R.tileID.overscaledZ-1);R=this._tiles[H.key],R&&R.hasData()&&(O=H)}let U=O;for(;U.overscaledZ>h;)if(U=U.scaledTo(U.overscaledZ-1),i[U.key]){v[O.key]=O;break}}}findLoadedParent(i,h){if(i.key in this._loadedParentTiles){const g=this._loadedParentTiles[i.key];return g&&g.tileID.overscaledZ>=h?g:null}for(let g=i.overscaledZ-1;g>=h;g--){const v=i.scaledTo(g),T=this._getLoadedTile(v);if(T)return T}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){const h=this._tiles[i.key];return h&&h.hasData()?h:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const h=Math.ceil(i.width/this._source.tileSize)+1,g=Math.ceil(i.height/this._source.tileSize)+1,v=Math.floor(h*g*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(T)}handleWrapJump(i){const h=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,h){const g={};for(const v in this._tiles){const T=this._tiles[v];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+h),g[T.tileID.key]=T}this._tiles=g;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}_updateCoveredAndRetainedTiles(i,h,g,v,T,R){const O={},U={},H=Object.keys(i),Y=N.now();for(const X of H){const le=i[X],fe=this._tiles[X];if(!fe||fe.fadeEndTime!==0&&fe.fadeEndTime<=Y)continue;const _e=this.findLoadedParent(le,h),Ee=this.findLoadedSibling(le),Pe=_e||Ee||null;Pe&&(this._addTile(Pe.tileID),O[Pe.tileID.key]=Pe.tileID),U[X]=le}this._retainLoadedChildren(U,v,g,i);for(const X in O)i[X]||(this._coveredTiles[X]=!0,i[X]=O[X]);if(R){const X={},le={};for(const fe of T)this._tiles[fe.key].hasData()?X[fe.key]=fe:le[fe.key]=fe;for(const fe in le){const _e=le[fe].children(this._source.maxzoom);this._tiles[_e[0].key]&&this._tiles[_e[1].key]&&this._tiles[_e[2].key]&&this._tiles[_e[3].key]&&(X[_e[0].key]=i[_e[0].key]=_e[0],X[_e[1].key]=i[_e[1].key]=_e[1],X[_e[2].key]=i[_e[2].key]=_e[2],X[_e[3].key]=i[_e[3].key]=_e[3],delete le[fe])}for(const fe in le){const _e=le[fe],Ee=this.findLoadedParent(_e,this._source.minzoom),Pe=this.findLoadedSibling(_e),Ie=Ee||Pe||null;if(Ie){X[Ie.tileID.key]=i[Ie.tileID.key]=Ie.tileID;for(const ze in X)X[ze].isChildOf(Ie.tileID)&&delete X[ze]}}for(const fe in this._tiles)X[fe]||(this._coveredTiles[fe]=!0)}}update(i,h){if(!this._sourceLoaded||this._paused)return;let g;this.transform=i,this.terrain=h,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=i.getVisibleUnwrappedCoordinates(this._source.tileID).map((Y=>new d.S(Y.canonical.z,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y))):(g=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:h}),this._source.hasTile&&(g=g.filter((Y=>this._source.hasTile(Y))))):g=[];const v=i.coveringZoomLevel(this._source),T=Math.max(v-Jt.maxOverzooming,this._source.minzoom),R=Math.max(v+Jt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Y={};for(const X of g)if(X.canonical.z>this._source.minzoom){const le=X.scaledTo(X.canonical.z-1);Y[le.key]=le;const fe=X.scaledTo(Math.max(this._source.minzoom,Math.min(X.canonical.z,5)));Y[fe.key]=fe}g=g.concat(Object.values(Y))}const O=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,O&&this.fire(new d.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const U=this._updateRetainedTiles(g,v);jn(this._source.type)&&this._updateCoveredAndRetainedTiles(U,T,R,v,g,h);for(const Y in U)this._tiles[Y].clearFadeHold();const H=d.ab(this._tiles,U);for(const Y of H){const X=this._tiles[Y];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile(Y)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,h){var g;const v={},T={},R=Math.max(h-Jt.maxOverzooming,this._source.minzoom),O=Math.max(h+Jt.maxUnderzooming,this._source.minzoom),U={};for(const H of i){const Y=this._addTile(H);v[H.key]=H,Y.hasData()||h<this._source.maxzoom&&(U[H.key]=H)}this._retainLoadedChildren(U,h,O,v);for(const H of i){let Y=this._tiles[H.key];if(Y.hasData())continue;if(h+1>this._source.maxzoom){const le=H.children(this._source.maxzoom)[0],fe=this.getTile(le);if(fe&&fe.hasData()){v[le.key]=le;continue}}else{const le=H.children(this._source.maxzoom);if(v[le[0].key]&&v[le[1].key]&&v[le[2].key]&&v[le[3].key])continue}let X=Y.wasRequested();for(let le=H.overscaledZ-1;le>=R;--le){const fe=H.scaledTo(le);if(T[fe.key])break;if(T[fe.key]=!0,Y=this.getTile(fe),!Y&&X&&(Y=this._addTile(fe)),Y){const _e=Y.hasData();if((_e||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||X)&&(v[fe.key]=fe),X=Y.wasRequested(),_e)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const h=[];let g,v=this._tiles[i].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){g=this._loadedParentTiles[v.key];break}h.push(v.key);const T=v.scaledTo(v.overscaledZ-1);if(g=this._getLoadedTile(T),g)break;v=T}for(const T of h)this._loadedParentTiles[T]=g}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const i in this._tiles){const h=this._tiles[i].tileID,g=this._getLoadedTile(h);this._loadedSiblingTiles[h.key]=g}}_addTile(i){let h=this._tiles[i.key];if(h)return h;h=this._cache.getAndRemove(i),h&&(this._setTileReloadTimer(i.key,h),h.tileID=i,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,h)));const g=h;return h||(h=new Zn(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(h,i.key,h.state)),h.uses++,this._tiles[i.key]=h,g||this._source.fire(new d.k("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(i,h){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const g=h.getExpiryTimeout();g&&(this._timers[i]=setTimeout((()=>{this._reloadTile(i,"expired"),delete this._timers[i]}),g))}_removeTile(i){const h=this._tiles[i];h&&(h.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}_dataHandler(i){const h=i.sourceDataType;i.dataType==="source"&&h==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&h==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,h,g){const v=[],T=this.transform;if(!T)return v;const R=g?T.getCameraQueryGeometry(i):i,O=i.map((_e=>T.pointCoordinate(_e,this.terrain))),U=R.map((_e=>T.pointCoordinate(_e,this.terrain))),H=this.getIds();let Y=1/0,X=1/0,le=-1/0,fe=-1/0;for(const _e of U)Y=Math.min(Y,_e.x),X=Math.min(X,_e.y),le=Math.max(le,_e.x),fe=Math.max(fe,_e.y);for(let _e=0;_e<H.length;_e++){const Ee=this._tiles[H[_e]];if(Ee.holdingForFade())continue;const Pe=Ee.tileID,Ie=Math.pow(2,T.zoom-Ee.tileID.overscaledZ),ze=h*Ee.queryPadding*d.X/Ee.tileSize/Ie,Se=[Pe.getTilePoint(new d.Z(Y,X)),Pe.getTilePoint(new d.Z(le,fe))];if(Se[0].x-ze<d.X&&Se[0].y-ze<d.X&&Se[1].x+ze>=0&&Se[1].y+ze>=0){const Fe=O.map((rt=>Pe.getTilePoint(rt))),Ye=U.map((rt=>Pe.getTilePoint(rt)));v.push({tile:Ee,tileID:Pe,queryGeometry:Fe,cameraQueryGeometry:Ye,scale:Ie})}}return v}getVisibleCoordinates(i){const h=this.getRenderableIds(i).map((g=>this._tiles[g].tileID));for(const g of h)g.posMatrix=this.transform.calculatePosMatrix(g.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(jn(this._source.type)){const i=N.now();for(const h in this._tiles)if(this._tiles[h].fadeEndTime>=i)return!0}return!1}setFeatureState(i,h,g){this._state.updateState(i=i||"_geojsonTileLayer",h,g)}removeFeatureState(i,h,g){this._state.removeFeatureState(i=i||"_geojsonTileLayer",h,g)}getFeatureState(i,h){return this._state.getState(i=i||"_geojsonTileLayer",h)}setDependencies(i,h,g){const v=this._tiles[i];v&&v.setDependencies(h,g)}reloadTilesForDependencies(i,h){for(const g in this._tiles)this._tiles[g].hasDependency(i,h)&&this._reloadTile(g,"reloading");this._cache.filter((g=>!g.hasDependency(i,h)))}}function Bi(E,i){const h=Math.abs(2*E.wrap)-+(E.wrap<0),g=Math.abs(2*i.wrap)-+(i.wrap<0);return E.overscaledZ-i.overscaledZ||g-h||i.canonical.y-E.canonical.y||i.canonical.x-E.canonical.x}function jn(E){return E==="raster"||E==="image"||E==="video"}Jt.maxOverzooming=10,Jt.maxUnderzooming=3;class ci{constructor(i,h){this.reset(i,h)}reset(i,h){this.points=i||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=d.ac(i,0,1);let h=1,g=this._distances[h];const v=i*this.paddedLength+this.padding;for(;g<v&&h<this._distances.length;)g=this._distances[++h];const T=h-1,R=this._distances[T],O=g-R,U=O>0?(v-R)/O:0;return this.points[T].mult(1-U).add(this.points[h].mult(U))}}function xs(E,i){let h=!0;return E==="always"||E!=="never"&&i!=="never"||(h=!1),h}class Dn{constructor(i,h,g){const v=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(i/g),this.yCellCount=Math.ceil(h/g);for(let R=0;R<this.xCellCount*this.yCellCount;R++)v.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=h,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,h,g,v,T){this._forEachCell(h,g,v,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(v),this.bboxes.push(T)}insertCircle(i,h,g,v){this._forEachCell(h-v,g-v,h+v,g+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(h),this.circles.push(g),this.circles.push(v)}_insertBoxCell(i,h,g,v,T,R){this.boxCells[T].push(R)}_insertCircleCell(i,h,g,v,T,R){this.circleCells[T].push(R)}_query(i,h,g,v,T,R,O){if(g<0||i>this.width||v<0||h>this.height)return[];const U=[];if(i<=0&&h<=0&&this.width<=g&&this.height<=v){if(T)return[{key:null,x1:i,y1:h,x2:g,y2:v}];for(let H=0;H<this.boxKeys.length;H++)U.push({key:this.boxKeys[H],x1:this.bboxes[4*H],y1:this.bboxes[4*H+1],x2:this.bboxes[4*H+2],y2:this.bboxes[4*H+3]});for(let H=0;H<this.circleKeys.length;H++){const Y=this.circles[3*H],X=this.circles[3*H+1],le=this.circles[3*H+2];U.push({key:this.circleKeys[H],x1:Y-le,y1:X-le,x2:Y+le,y2:X+le})}}else this._forEachCell(i,h,g,v,this._queryCell,U,{hitTest:T,overlapMode:R,seenUids:{box:{},circle:{}}},O);return U}query(i,h,g,v){return this._query(i,h,g,v,!1,null)}hitTest(i,h,g,v,T,R){return this._query(i,h,g,v,!0,T,R).length>0}hitTestCircle(i,h,g,v,T){const R=i-g,O=i+g,U=h-g,H=h+g;if(O<0||R>this.width||H<0||U>this.height)return!1;const Y=[];return this._forEachCell(R,U,O,H,this._queryCellCircle,Y,{hitTest:!0,overlapMode:v,circle:{x:i,y:h,radius:g},seenUids:{box:{},circle:{}}},T),Y.length>0}_queryCell(i,h,g,v,T,R,O,U){const{seenUids:H,hitTest:Y,overlapMode:X}=O,le=this.boxCells[T];if(le!==null){const _e=this.bboxes;for(const Ee of le)if(!H.box[Ee]){H.box[Ee]=!0;const Pe=4*Ee,Ie=this.boxKeys[Ee];if(i<=_e[Pe+2]&&h<=_e[Pe+3]&&g>=_e[Pe+0]&&v>=_e[Pe+1]&&(!U||U(Ie))&&(!Y||!xs(X,Ie.overlapMode))&&(R.push({key:Ie,x1:_e[Pe],y1:_e[Pe+1],x2:_e[Pe+2],y2:_e[Pe+3]}),Y))return!0}}const fe=this.circleCells[T];if(fe!==null){const _e=this.circles;for(const Ee of fe)if(!H.circle[Ee]){H.circle[Ee]=!0;const Pe=3*Ee,Ie=this.circleKeys[Ee];if(this._circleAndRectCollide(_e[Pe],_e[Pe+1],_e[Pe+2],i,h,g,v)&&(!U||U(Ie))&&(!Y||!xs(X,Ie.overlapMode))){const ze=_e[Pe],Se=_e[Pe+1],Fe=_e[Pe+2];if(R.push({key:Ie,x1:ze-Fe,y1:Se-Fe,x2:ze+Fe,y2:Se+Fe}),Y)return!0}}}return!1}_queryCellCircle(i,h,g,v,T,R,O,U){const{circle:H,seenUids:Y,overlapMode:X}=O,le=this.boxCells[T];if(le!==null){const _e=this.bboxes;for(const Ee of le)if(!Y.box[Ee]){Y.box[Ee]=!0;const Pe=4*Ee,Ie=this.boxKeys[Ee];if(this._circleAndRectCollide(H.x,H.y,H.radius,_e[Pe+0],_e[Pe+1],_e[Pe+2],_e[Pe+3])&&(!U||U(Ie))&&!xs(X,Ie.overlapMode))return R.push(!0),!0}}const fe=this.circleCells[T];if(fe!==null){const _e=this.circles;for(const Ee of fe)if(!Y.circle[Ee]){Y.circle[Ee]=!0;const Pe=3*Ee,Ie=this.circleKeys[Ee];if(this._circlesCollide(_e[Pe],_e[Pe+1],_e[Pe+2],H.x,H.y,H.radius)&&(!U||U(Ie))&&!xs(X,Ie.overlapMode))return R.push(!0),!0}}}_forEachCell(i,h,g,v,T,R,O,U){const H=this._convertToXCellCoord(i),Y=this._convertToYCellCoord(h),X=this._convertToXCellCoord(g),le=this._convertToYCellCoord(v);for(let fe=H;fe<=X;fe++)for(let _e=Y;_e<=le;_e++)if(T.call(this,i,h,g,v,this.xCellCount*_e+fe,R,O,U))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,h,g,v,T,R){const O=v-i,U=T-h,H=g+R;return H*H>O*O+U*U}_circleAndRectCollide(i,h,g,v,T,R,O){const U=(R-v)/2,H=Math.abs(i-(v+U));if(H>U+g)return!1;const Y=(O-T)/2,X=Math.abs(h-(T+Y));if(X>Y+g)return!1;if(H<=U||X<=Y)return!0;const le=H-U,fe=X-Y;return le*le+fe*fe<=g*g}}function $n(E,i,h,g,v){const T=d.H();return i?(d.K(T,T,[1/v,1/v,1]),h||d.ad(T,T,g.angle)):d.L(T,g.labelPlaneMatrix,E),T}function Ji(E,i,h,g,v){if(i){const T=d.ae(E);return d.K(T,T,[v,v,1]),h||d.ad(T,T,-g.angle),T}return g.glCoordMatrix}function be(E,i,h,g){let v;g?(v=[E,i,g(E,i),1],d.af(v,v,h)):(v=[E,i,0,1],Dt(v,v,h));const T=v[3];return{point:new d.P(v[0]/T,v[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}function ie(E,i){return .5+E/i*.5}function te(E,i){return E.x>=-i[0]&&E.x<=i[0]&&E.y>=-i[1]&&E.y<=i[1]}function he(E,i,h,g,v,T,R,O,U,H,Y,X,le,fe,_e){const Ee=g?E.textSizeData:E.iconSizeData,Pe=d.ag(Ee,h.transform.zoom),Ie=[256/h.width*2+1,256/h.height*2+1],ze=g?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;ze.clear();const Se=E.lineVertexArray,Fe=g?E.text.placedSymbolArray:E.icon.placedSymbolArray,Ye=h.transform.width/h.transform.height;let rt=!1;for(let bt=0;bt<Fe.length;bt++){const $t=Fe.get(bt);if($t.hidden||$t.writingMode===d.ah.vertical&&!rt){qt($t.numGlyphs,ze);continue}rt=!1;const Ht=be($t.anchorX,$t.anchorY,i,_e);if(!te(Ht.point,Ie)){qt($t.numGlyphs,ze);continue}const Qt=ie(h.transform.cameraToCenterDistance,Ht.signedDistanceFromCamera),Zt=d.ai(Ee,Pe,$t),Ut=R?Zt/Qt:Zt*Qt,ni={getElevation:_e,labelPlaneMatrix:v,lineVertexArray:Se,pitchWithMap:R,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:H,tileAnchorPoint:new d.P($t.anchorX,$t.anchorY),unwrappedTileID:Y,width:X,height:le,translation:fe},ki=Ne(ni,$t,Ut,!1,O,i,T,E.glyphOffsetArray,ze,Ye,U);rt=ki.useVertical,(ki.notEnoughRoom||rt||ki.needsFlipping&&Ne(ni,$t,Ut,!0,O,i,T,E.glyphOffsetArray,ze,Ye,U).notEnoughRoom)&&qt($t.numGlyphs,ze)}g?E.text.dynamicLayoutVertexBuffer.updateData(ze):E.icon.dynamicLayoutVertexBuffer.updateData(ze)}function we(E,i,h,g,v,T,R,O){const U=T.glyphStartIndex+T.numGlyphs,H=T.lineStartIndex,Y=T.lineStartIndex+T.lineLength,X=i.getoffsetX(T.glyphStartIndex),le=i.getoffsetX(U-1),fe=Ve(E*X,h,g,v,T.segment,H,Y,O,R);if(!fe)return null;const _e=Ve(E*le,h,g,v,T.segment,H,Y,O,R);return _e?O.projectionCache.anyProjectionOccluded?null:{first:fe,last:_e}:null}function je(E,i,h,g){return E===d.ah.horizontal&&Math.abs(h.y-i.y)>Math.abs(h.x-i.x)*g?{useVertical:!0}:(E===d.ah.vertical?i.y<h.y:i.x>h.x)?{needsFlipping:!0}:null}function Ne(E,i,h,g,v,T,R,O,U,H,Y){const X=h/24,le=i.lineOffsetX*X,fe=i.lineOffsetY*X;let _e;if(i.numGlyphs>1){const Ee=i.glyphStartIndex+i.numGlyphs,Pe=i.lineStartIndex,Ie=i.lineStartIndex+i.lineLength,ze=we(X,O,le,fe,g,i,Y,E);if(!ze)return{notEnoughRoom:!0};const Se=be(ze.first.point.x,ze.first.point.y,R,E.getElevation).point,Fe=be(ze.last.point.x,ze.last.point.y,R,E.getElevation).point;if(v&&!g){const Ye=je(i.writingMode,Se,Fe,H);if(Ye)return Ye}_e=[ze.first];for(let Ye=i.glyphStartIndex+1;Ye<Ee-1;Ye++)_e.push(Ve(X*O.getoffsetX(Ye),le,fe,g,i.segment,Pe,Ie,E,Y));_e.push(ze.last)}else{if(v&&!g){const Pe=be(E.tileAnchorPoint.x,E.tileAnchorPoint.y,T,E.getElevation).point,Ie=i.lineStartIndex+i.segment+1,ze=new d.P(E.lineVertexArray.getx(Ie),E.lineVertexArray.gety(Ie)),Se=be(ze.x,ze.y,T,E.getElevation),Fe=Se.signedDistanceFromCamera>0?Se.point:(function(rt,bt,$t,Ht,Qt,Zt){return Ze(rt,bt,$t,1,Qt,Zt)})(E.tileAnchorPoint,ze,Pe,0,T,E),Ye=je(i.writingMode,Pe,Fe,H);if(Ye)return Ye}const Ee=Ve(X*O.getoffsetX(i.glyphStartIndex),le,fe,g,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,E,Y);if(!Ee||E.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};_e=[Ee]}for(const Ee of _e)d.aj(U,Ee.point,Ee.angle);return{}}function Ze(E,i,h,g,v,T){const R=E.add(E.sub(i)._unit()),O=v!==void 0?be(R.x,R.y,v,T.getElevation).point:Le(R.x,R.y,T).point,U=h.sub(O);return h.add(U._mult(g/U.mag()))}function ee(E,i,h){const g=i.projectionCache;if(g.projections[E])return g.projections[E];const v=new d.P(i.lineVertexArray.getx(E),i.lineVertexArray.gety(E)),T=Le(v.x,v.y,i);if(T.signedDistanceFromCamera>0)return g.projections[E]=T.point,g.anyProjectionOccluded=g.anyProjectionOccluded||T.isOccluded,T.point;const R=E-h.direction;return(function(O,U,H,Y,X){return Ze(O,U,H,Y,void 0,X)})(h.distanceFromAnchor===0?i.tileAnchorPoint:new d.P(i.lineVertexArray.getx(R),i.lineVertexArray.gety(R)),v,h.previousVertex,h.absOffsetX-h.distanceFromAnchor+1,i)}function Le(E,i,h){const g=E+h.translation[0],v=i+h.translation[1];let T;return!h.pitchWithMap&&h.projection.useSpecialProjectionForSymbols?(T=h.projection.projectTileCoordinates(g,v,h.unwrappedTileID,h.getElevation),T.point.x=(.5*T.point.x+.5)*h.width,T.point.y=(.5*-T.point.y+.5)*h.height):(T=be(g,v,h.labelPlaneMatrix,h.getElevation),T.isOccluded=!1),T}function Ue(E,i,h){return E._unit()._perp()._mult(i*h)}function Oe(E,i,h,g,v,T,R,O,U){if(O.projectionCache.offsets[E])return O.projectionCache.offsets[E];const H=h.add(i);if(E+U.direction<g||E+U.direction>=v)return O.projectionCache.offsets[E]=H,H;const Y=ee(E+U.direction,O,U),X=Ue(Y.sub(h),R,U.direction),le=h.add(X),fe=Y.add(X);return O.projectionCache.offsets[E]=d.ak(T,H,le,fe)||H,O.projectionCache.offsets[E]}function Ve(E,i,h,g,v,T,R,O,U){const H=g?E-i:E+i;let Y=H>0?1:-1,X=0;g&&(Y*=-1,X=Math.PI),Y<0&&(X+=Math.PI);let le,fe=Y>0?T+v:T+v+1;O.projectionCache.cachedAnchorPoint?le=O.projectionCache.cachedAnchorPoint:(le=Le(O.tileAnchorPoint.x,O.tileAnchorPoint.y,O).point,O.projectionCache.cachedAnchorPoint=le);let _e,Ee,Pe=le,Ie=le,ze=0,Se=0;const Fe=Math.abs(H),Ye=[];let rt;for(;ze+Se<=Fe;){if(fe+=Y,fe<T||fe>=R)return null;ze+=Se,Ie=Pe,Ee=_e;const Ht={absOffsetX:Fe,direction:Y,distanceFromAnchor:ze,previousVertex:Ie};if(Pe=ee(fe,O,Ht),h===0)Ye.push(Ie),rt=Pe.sub(Ie);else{let Qt;const Zt=Pe.sub(Ie);Qt=Zt.mag()===0?Ue(ee(fe+Y,O,Ht).sub(Pe),h,Y):Ue(Zt,h,Y),Ee||(Ee=Ie.add(Qt)),_e=Oe(fe,Qt,Pe,T,R,Ee,h,O,Ht),Ye.push(Ee),rt=_e.sub(Ee)}Se=rt.mag()}const bt=rt._mult((Fe-ze)/Se)._add(Ee||Ie),$t=X+Math.atan2(Pe.y-Ie.y,Pe.x-Ie.x);return Ye.push(bt),{point:bt,angle:U?$t:0,path:Ye}}const Bt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function qt(E,i){for(let h=0;h<E;h++){const g=i.length;i.resize(g+4),i.float32.set(Bt,3*g)}}function Dt(E,i,h){const g=i[0],v=i[1];return E[0]=h[0]*g+h[4]*v+h[12],E[1]=h[1]*g+h[5]*v+h[13],E[3]=h[3]*g+h[7]*v+h[15],E}const At=100;class ti{constructor(i,h,g=new Dn(i.width+200,i.height+200,25),v=new Dn(i.width+200,i.height+200,25)){this.transform=i,this.mapProjection=h,this.grid=g,this.ignoredGrid=v,this.pitchFactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+At,this.screenBottomBoundary=i.height+At,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,h,g,v,T,R,O,U,H,Y,X){const le=i.anchorPointX+U[0],fe=i.anchorPointY+U[1],_e=this.projectAndGetPerspectiveRatio(v,le,fe,T,Y),Ee=g*_e.perspectiveRatio;let Pe;if(R||O)Pe=this._projectCollisionBox(i,Ee,v,T,R,O,U,_e,Y,X);else{const Ye=_e.point.x+(X?X.x*Ee:0),rt=_e.point.y+(X?X.y*Ee:0);Pe={allPointsOccluded:!1,box:[Ye+i.x1*Ee,rt+i.y1*Ee,Ye+i.x2*Ee,rt+i.y2*Ee]}}const[Ie,ze,Se,Fe]=Pe.box;return this.mapProjection.useSpecialProjectionForSymbols&&(R?Pe.allPointsOccluded:this.mapProjection.isOccluded(le,fe,T))||_e.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Ie,ze,Se,Fe)||h!=="always"&&this.grid.hitTest(Ie,ze,Se,Fe,h,H)?{box:[Ie,ze,Se,Fe],placeable:!1,offscreen:!1}:{box:[Ie,ze,Se,Fe],placeable:!0,offscreen:this.isOffscreen(Ie,ze,Se,Fe)}}placeCollisionCircles(i,h,g,v,T,R,O,U,H,Y,X,le,fe,_e,Ee,Pe){const Ie=[],ze=new d.P(h.anchorX,h.anchorY),Se=this.getPerspectiveRatio(R,ze.x,ze.y,O,Pe),Fe=(X?T/Se:T*Se)/d.ap,Ye={getElevation:Pe,labelPlaneMatrix:U,lineVertexArray:g,pitchWithMap:X,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ze,unwrappedTileID:O,width:this.transform.width,height:this.transform.height,translation:Ee},rt=we(Fe,v,h.lineOffsetX*Fe,h.lineOffsetY*Fe,!1,h,!1,Ye);let bt=!1,$t=!1,Ht=!0;if(rt){const Qt=.5*fe*Se+_e,Zt=new d.P(-100,-100),Ut=new d.P(this.screenRightBoundary,this.screenBottomBoundary),ni=new ci,ki=rt.first,Gt=rt.last;let Xt=[];for(let Zi=ki.path.length-1;Zi>=1;Zi--)Xt.push(ki.path[Zi]);for(let Zi=1;Zi<Gt.path.length;Zi++)Xt.push(Gt.path[Zi]);const Ei=2.5*Qt;if(H){const Zi=this.projectPathToScreenSpace(Xt,Ye,H);Xt=Zi.some((dn=>dn.signedDistanceFromCamera<=0))?[]:Zi.map((dn=>dn.point))}let Gn=[];if(Xt.length>0){const Zi=Xt[0].clone(),dn=Xt[0].clone();for(let Fn=1;Fn<Xt.length;Fn++)Zi.x=Math.min(Zi.x,Xt[Fn].x),Zi.y=Math.min(Zi.y,Xt[Fn].y),dn.x=Math.max(dn.x,Xt[Fn].x),dn.y=Math.max(dn.y,Xt[Fn].y);Gn=Zi.x>=Zt.x&&dn.x<=Ut.x&&Zi.y>=Zt.y&&dn.y<=Ut.y?[Xt]:dn.x<Zt.x||Zi.x>Ut.x||dn.y<Zt.y||Zi.y>Ut.y?[]:d.al([Xt],Zt.x,Zt.y,Ut.x,Ut.y)}for(const Zi of Gn){ni.reset(Zi,.25*Qt);let dn=0;dn=ni.length<=.5*Qt?1:Math.ceil(ni.paddedLength/Ei)+1;for(let Fn=0;Fn<dn;Fn++){const ir=Fn/Math.max(dn-1,1),Wa=ni.lerp(ir),ts=Wa.x+At,Dr=Wa.y+At;Ie.push(ts,Dr,Qt,0);const ls=ts-Qt,cs=Dr-Qt,Rs=ts+Qt,Ya=Dr+Qt;if(Ht=Ht&&this.isOffscreen(ls,cs,Rs,Ya),$t=$t||this.isInsideGrid(ls,cs,Rs,Ya),i!=="always"&&this.grid.hitTestCircle(ts,Dr,Qt,i,le)&&(bt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:bt}}}}return{circles:!Y&&bt||!$t||Se<this.perspectiveRatioCutoff?[]:Ie,offscreen:Ht,collisionDetected:bt}}projectPathToScreenSpace(i,h,g){return i.map((v=>be(v.x,v.y,g,h.getElevation)))}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let g=1/0,v=1/0,T=-1/0,R=-1/0;for(const Y of i){const X=new d.P(Y.x+At,Y.y+At);g=Math.min(g,X.x),v=Math.min(v,X.y),T=Math.max(T,X.x),R=Math.max(R,X.y),h.push(X)}const O=this.grid.query(g,v,T,R).concat(this.ignoredGrid.query(g,v,T,R)),U={},H={};for(const Y of O){const X=Y.key;if(U[X.bucketInstanceId]===void 0&&(U[X.bucketInstanceId]={}),U[X.bucketInstanceId][X.featureIndex])continue;const le=[new d.P(Y.x1,Y.y1),new d.P(Y.x2,Y.y1),new d.P(Y.x2,Y.y2),new d.P(Y.x1,Y.y2)];d.am(h,le)&&(U[X.bucketInstanceId][X.featureIndex]=!0,H[X.bucketInstanceId]===void 0&&(H[X.bucketInstanceId]=[]),H[X.bucketInstanceId].push(X.featureIndex))}return H}insertCollisionBox(i,h,g,v,T,R){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:T,collisionGroupID:R,overlapMode:h},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,h,g,v,T,R){const O=g?this.ignoredGrid:this.grid,U={bucketInstanceId:v,featureIndex:T,collisionGroupID:R,overlapMode:h};for(let H=0;H<i.length;H+=4)O.insertCircle(U,i[H],i[H+1],i[H+2])}projectAndGetPerspectiveRatio(i,h,g,v,T){let R;T?(R=[h,g,T(h,g),1],d.af(R,R,i)):(R=[h,g,0,1],Dt(R,R,i));const O=R[3];return{point:new d.P((R[0]/O+1)/2*this.transform.width+At,(-R[1]/O+1)/2*this.transform.height+At),perspectiveRatio:.5+this.transform.cameraToCenterDistance/O*.5,isOccluded:!1,signedDistanceFromCamera:O}}getPerspectiveRatio(i,h,g,v,T){const R=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(h,g,v,T):be(h,g,i,T);return .5+this.transform.cameraToCenterDistance/R.signedDistanceFromCamera*.5}isOffscreen(i,h,g,v){return g<At||i>=this.screenRightBoundary||v<At||h>this.screenBottomBoundary}isInsideGrid(i,h,g,v){return g>=0&&i<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const i=d.an([]);return d.J(i,i,[-100,-100,0]),i}_projectCollisionBox(i,h,g,v,T,R,O,U,H,Y){let X=new d.P(1,0),le=new d.P(0,1);const fe=new d.P(i.anchorPointX+O[0],i.anchorPointY+O[1]);if(R&&!T){const Ht=this.projectAndGetPerspectiveRatio(g,fe.x+1,fe.y,v,H).point.sub(U.point).unit(),Qt=Math.atan(Ht.y/Ht.x)+(Ht.x<0?Math.PI:0),Zt=Math.sin(Qt),Ut=Math.cos(Qt);X=new d.P(Ut,Zt),le=new d.P(-Zt,Ut)}else if(!R&&T){const Ht=-this.transform.angle,Qt=Math.sin(Ht),Zt=Math.cos(Ht);X=new d.P(Zt,Qt),le=new d.P(-Qt,Zt)}let _e=U.point,Ee=h;if(T){_e=fe;const Ht=this.transform.zoom-Math.floor(this.transform.zoom);Ee=Math.pow(2,-Ht),Ee*=this.mapProjection.getPitchedTextCorrection(this.transform,fe,v),Y||(Ee*=d.ac(.5+U.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}Y&&(_e=_e.add(X.mult(Y.x*Ee)).add(le.mult(Y.y*Ee)));const Pe=i.x1*Ee,Ie=i.x2*Ee,ze=(Pe+Ie)/2,Se=i.y1*Ee,Fe=i.y2*Ee,Ye=(Se+Fe)/2,rt=[{offsetX:Pe,offsetY:Se},{offsetX:ze,offsetY:Se},{offsetX:Ie,offsetY:Se},{offsetX:Ie,offsetY:Ye},{offsetX:Ie,offsetY:Fe},{offsetX:ze,offsetY:Fe},{offsetX:Pe,offsetY:Fe},{offsetX:Pe,offsetY:Ye}];let bt=[];for(const{offsetX:Ht,offsetY:Qt}of rt)bt.push(new d.P(_e.x+X.x*Ht+le.x*Qt,_e.y+X.y*Ht+le.y*Qt));let $t=!1;if(T){const Ht=bt.map((Qt=>this.projectAndGetPerspectiveRatio(g,Qt.x,Qt.y,v,H)));$t=Ht.some((Qt=>!Qt.isOccluded)),bt=Ht.map((Qt=>Qt.point))}else $t=!0;return{box:d.ao(bt),allPointsOccluded:!$t}}}function pi(E,i,h){return i*(d.X/(E.tileSize*Math.pow(2,h-E.tileID.overscaledZ)))}class ji{constructor(i,h,g,v){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?h:-h))):v&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Qi{constructor(i,h,g,v,T){this.text=new ji(i?i.text:null,h,g,T),this.icon=new ji(i?i.icon:null,h,v,T)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gi{constructor(i,h,g){this.text=i,this.icon=h,this.skipFade=g}}class qi{constructor(){this.invProjMatrix=d.H(),this.viewportMatrix=d.H(),this.circles=[]}}class on{constructor(i,h,g,v,T){this.bucketInstanceId=i,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=v,this.tileID=T}}class Qe{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const h=++this.maxGroupID;this.collisionGroups[i]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[i]}}function Ot(E,i,h,g,v){const{horizontalAlign:T,verticalAlign:R}=d.au(E);return new d.P(-(T-.5)*i+g[0]*v,-(R-.5)*h+g[1]*v)}class ui{constructor(i,h,g,v,T,R){this.transform=i.clone(),this.terrain=g,this.collisionIndex=new ti(this.transform,h),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new Qe(T),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=R,R&&(R.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const h=this.terrain;return h?(g,v)=>h.getElevation(i,g,v):null}getBucketParts(i,h,g,v){const T=g.getBucket(h),R=g.latestFeatureIndex;if(!T||!R||h.id!==T.layerIds[0])return;const O=g.collisionBoxArray,U=T.layers[0].layout,H=T.layers[0].paint,Y=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),X=g.tileSize/d.X,le=g.tileID.toUnwrapped(),fe=this.transform.calculatePosMatrix(le),_e=U.get("text-pitch-alignment")==="map",Ee=U.get("text-rotation-alignment")==="map",Pe=pi(g,1,this.transform.zoom),Ie=this.collisionIndex.mapProjection.translatePosition(this.transform,g,H.get("text-translate"),H.get("text-translate-anchor")),ze=this.collisionIndex.mapProjection.translatePosition(this.transform,g,H.get("icon-translate"),H.get("icon-translate-anchor")),Se=$n(fe,_e,Ee,this.transform,Pe);let Fe=null;if(_e){const rt=Ji(fe,_e,Ee,this.transform,Pe);Fe=d.L([],this.transform.labelPlaneMatrix,rt)}this.retainedQueryData[T.bucketInstanceId]=new on(T.bucketInstanceId,R,T.sourceLayerIndex,T.index,g.tileID);const Ye={bucket:T,layout:U,translationText:Ie,translationIcon:ze,posMatrix:fe,unwrappedTileID:le,textLabelPlaneMatrix:Se,labelToScreenMatrix:Fe,scale:Y,textPixelRatio:X,holdingForFade:g.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:d.ag(T.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(v)for(const rt of T.sortKeyRanges){const{sortKey:bt,symbolInstanceStart:$t,symbolInstanceEnd:Ht}=rt;i.push({sortKey:bt,symbolInstanceStart:$t,symbolInstanceEnd:Ht,parameters:Ye})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:Ye})}attemptAnchorPlacement(i,h,g,v,T,R,O,U,H,Y,X,le,fe,_e,Ee,Pe,Ie,ze,Se){const Fe=d.aq[i.textAnchor],Ye=[i.textOffset0,i.textOffset1],rt=Ot(Fe,g,v,Ye,T),bt=this.collisionIndex.placeCollisionBox(h,le,U,H,Y,O,R,Pe,X.predicate,Se,rt);if((!ze||this.collisionIndex.placeCollisionBox(ze,le,U,H,Y,O,R,Ie,X.predicate,Se,rt).placeable)&&bt.placeable){let $t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID].text&&($t=this.prevPlacement.variableOffsets[fe.crossTileID].anchor),fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[fe.crossTileID]={textOffset:Ye,width:g,height:v,anchor:Fe,textBoxScale:T,prevAnchor:$t},this.markUsedJustification(_e,Fe,fe,Ee),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,Ee,fe),this.placedOrientations[fe.crossTileID]=Ee),{shift:rt,placedGlyphBoxes:bt}}}placeLayerBucketPart(i,h,g){const{bucket:v,layout:T,translationText:R,translationIcon:O,posMatrix:U,unwrappedTileID:H,textLabelPlaneMatrix:Y,labelToScreenMatrix:X,textPixelRatio:le,holdingForFade:fe,collisionBoxArray:_e,partiallyEvaluatedTextSize:Ee,collisionGroup:Pe}=i.parameters,Ie=T.get("text-optional"),ze=T.get("icon-optional"),Se=d.ar(T,"text-overlap","text-allow-overlap"),Fe=Se==="always",Ye=d.ar(T,"icon-overlap","icon-allow-overlap"),rt=Ye==="always",bt=T.get("text-rotation-alignment")==="map",$t=T.get("text-pitch-alignment")==="map",Ht=T.get("icon-text-fit")!=="none",Qt=T.get("symbol-z-order")==="viewport-y",Zt=Fe&&(rt||!v.hasIconData()||ze),Ut=rt&&(Fe||!v.hasTextData()||Ie);!v.collisionArrays&&_e&&v.deserializeCollisionBoxes(_e);const ni=this._getTerrainElevationFunc(this.retainedQueryData[v.bucketInstanceId].tileID),ki=(Gt,Xt,Ei)=>{var Gn,Zi;if(h[Gt.crossTileID])return;if(fe)return void(this.placements[Gt.crossTileID]=new gi(!1,!1,!1));let dn=!1,Fn=!1,ir=!0,Wa=null,ts={box:null,placeable:!1,offscreen:null},Dr={placeable:!1},ls=null,cs=null,Rs=null,Ya=0,uc=0,_o=0;Xt.textFeatureIndex?Ya=Xt.textFeatureIndex:Gt.useRuntimeCollisionCircles&&(Ya=Gt.featureIndex),Xt.verticalTextFeatureIndex&&(uc=Xt.verticalTextFeatureIndex);const or=Xt.textBox;if(or){const Pi=zs=>{let Ds=d.ah.horizontal;if(v.allowVerticalPlacement&&!zs&&this.prevPlacement){const Or=this.prevPlacement.placedOrientations[Gt.crossTileID];Or&&(this.placedOrientations[Gt.crossTileID]=Or,Ds=Or,this.markUsedOrientation(v,Ds,Gt))}return Ds},yn=(zs,Ds)=>{if(v.allowVerticalPlacement&&Gt.numVerticalGlyphVertices>0&&Xt.verticalTextBox){for(const Or of v.writingModes)if(Or===d.ah.vertical?(ts=Ds(),Dr=ts):ts=zs(),ts&&ts.placeable)break}else ts=zs()},us=Gt.textAnchorOffsetStartIndex,ma=Gt.textAnchorOffsetEndIndex;if(ma===us){const zs=(Ds,Or)=>{const sn=this.collisionIndex.placeCollisionBox(Ds,Se,le,U,H,$t,bt,R,Pe.predicate,ni);return sn&&sn.placeable&&(this.markUsedOrientation(v,Or,Gt),this.placedOrientations[Gt.crossTileID]=Or),sn};yn((()=>zs(or,d.ah.horizontal)),(()=>{const Ds=Xt.verticalTextBox;return v.allowVerticalPlacement&&Gt.numVerticalGlyphVertices>0&&Ds?zs(Ds,d.ah.vertical):{box:null,offscreen:null}})),Pi(ts&&ts.placeable)}else{let zs=d.aq[(Zi=(Gn=this.prevPlacement)===null||Gn===void 0?void 0:Gn.variableOffsets[Gt.crossTileID])===null||Zi===void 0?void 0:Zi.anchor];const Ds=(sn,Xa,Hc)=>{const hs=sn.x2-sn.x1,ch=sn.y2-sn.y1,id=Gt.textBoxScale,nd=Ht&&Ye==="never"?Xa:null;let bl=null,af=Se==="never"?1:2,Zc="never";zs&&af++;for(let dc=0;dc<af;dc++){for(let Gc=us;Gc<ma;Gc++){const lr=v.textAnchorOffsets.get(Gc);if(zs&&lr.textAnchor!==zs)continue;const fs=this.attemptAnchorPlacement(lr,sn,hs,ch,id,bt,$t,le,U,H,Pe,Zc,Gt,v,Hc,R,O,nd,ni);if(fs&&(bl=fs.placedGlyphBoxes,bl&&bl.placeable))return dn=!0,Wa=fs.shift,bl}zs?zs=null:Zc=Se}return g&&!bl&&(bl={box:this.collisionIndex.placeCollisionBox(or,"always",le,U,H,$t,bt,R,Pe.predicate,ni,new d.P(0,0)).box,offscreen:!1,placeable:!1}),bl};yn((()=>Ds(or,Xt.iconBox,d.ah.horizontal)),(()=>{const sn=Xt.verticalTextBox;return v.allowVerticalPlacement&&(!ts||!ts.placeable)&&Gt.numVerticalGlyphVertices>0&&sn?Ds(sn,Xt.verticalIconBox,d.ah.vertical):{box:null,occluded:!0,offscreen:null}})),ts&&(dn=ts.placeable,ir=ts.offscreen);const Or=Pi(ts&&ts.placeable);if(!dn&&this.prevPlacement){const sn=this.prevPlacement.variableOffsets[Gt.crossTileID];sn&&(this.variableOffsets[Gt.crossTileID]=sn,this.markUsedJustification(v,sn.anchor,Gt,Or))}}}if(ls=ts,dn=ls&&ls.placeable,ir=ls&&ls.offscreen,Gt.useRuntimeCollisionCircles){const Pi=v.text.placedSymbolArray.get(Gt.centerJustifiedTextSymbolIndex),yn=d.ai(v.textSizeData,Ee,Pi),us=T.get("text-padding");cs=this.collisionIndex.placeCollisionCircles(Se,Pi,v.lineVertexArray,v.glyphOffsetArray,yn,U,H,Y,X,g,$t,Pe.predicate,Gt.collisionCircleDiameter,us,R,ni),cs.circles.length&&cs.collisionDetected&&!g&&d.w("Collisions detected, but collision boxes are not shown"),dn=Fe||cs.circles.length>0&&!cs.collisionDetected,ir=ir&&cs.offscreen}if(Xt.iconFeatureIndex&&(_o=Xt.iconFeatureIndex),Xt.iconBox){const Pi=yn=>this.collisionIndex.placeCollisionBox(yn,Ye,le,U,H,$t,bt,O,Pe.predicate,ni,Ht&&Wa?Wa:void 0);Dr&&Dr.placeable&&Xt.verticalIconBox?(Rs=Pi(Xt.verticalIconBox),Fn=Rs.placeable):(Rs=Pi(Xt.iconBox),Fn=Rs.placeable),ir=ir&&Rs.offscreen}const Nn=Ie||Gt.numHorizontalGlyphVertices===0&&Gt.numVerticalGlyphVertices===0,hc=ze||Gt.numIconVertices===0;Nn||hc?hc?Nn||(Fn=Fn&&dn):dn=Fn&&dn:Fn=dn=Fn&&dn;const vo=Fn&&Rs.placeable;if(dn&&ls.placeable&&this.collisionIndex.insertCollisionBox(ls.box,Se,T.get("text-ignore-placement"),v.bucketInstanceId,Dr&&Dr.placeable&&uc?uc:Ya,Pe.ID),vo&&this.collisionIndex.insertCollisionBox(Rs.box,Ye,T.get("icon-ignore-placement"),v.bucketInstanceId,_o,Pe.ID),cs&&dn&&this.collisionIndex.insertCollisionCircles(cs.circles,Se,T.get("text-ignore-placement"),v.bucketInstanceId,Ya,Pe.ID),g&&this.storeCollisionData(v.bucketInstanceId,Ei,Xt,ls,Rs,cs),Gt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Gt.crossTileID]=new gi(dn||Zt,Fn||Ut,ir||v.justReloaded),h[Gt.crossTileID]=!0};if(Qt){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Gt=v.getSortedSymbolIndexes(this.transform.angle);for(let Xt=Gt.length-1;Xt>=0;--Xt){const Ei=Gt[Xt];ki(v.symbolInstances.get(Ei),v.collisionArrays[Ei],Ei)}}else for(let Gt=i.symbolInstanceStart;Gt<i.symbolInstanceEnd;Gt++)ki(v.symbolInstances.get(Gt),v.collisionArrays[Gt],Gt);if(g&&v.bucketInstanceId in this.collisionCircleArrays){const Gt=this.collisionCircleArrays[v.bucketInstanceId];d.as(Gt.invProjMatrix,U),Gt.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}storeCollisionData(i,h,g,v,T,R){if(g.textBox||g.iconBox){let O,U;this.collisionBoxArrays.has(i)?O=this.collisionBoxArrays.get(i):(O=new Map,this.collisionBoxArrays.set(i,O)),O.has(h)?U=O.get(h):(U={text:null,icon:null},O.set(h,U)),g.textBox&&(U.text=v.box),g.iconBox&&(U.icon=T.box)}if(R){let O=this.collisionCircleArrays[i];O===void 0&&(O=this.collisionCircleArrays[i]=new qi);for(let U=0;U<R.circles.length;U+=4)O.circles.push(R.circles[U+0]),O.circles.push(R.circles[U+1]),O.circles.push(R.circles[U+2]),O.circles.push(R.collisionDetected?1:0)}}markUsedJustification(i,h,g,v){let T;T=v===d.ah.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[d.at(h)];const R=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const O of R)O>=0&&(i.text.placedSymbolArray.get(O).crossTileID=T>=0&&O!==T?0:g.crossTileID)}markUsedOrientation(i,h,g){const v=h===d.ah.horizontal||h===d.ah.horizontalOnly?h:0,T=h===d.ah.vertical?h:0,R=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const O of R)i.text.placedSymbolArray.get(O).placedOrientation=v;g.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(i):1,T=h?h.opacities:{},R=h?h.variableOffsets:{},O=h?h.placedOrientations:{};for(const U in this.placements){const H=this.placements[U],Y=T[U];Y?(this.opacities[U]=new Qi(Y,v,H.text,H.icon),g=g||H.text!==Y.text.placed||H.icon!==Y.icon.placed):(this.opacities[U]=new Qi(null,v,H.text,H.icon,H.skipFade),g=g||H.text||H.icon)}for(const U in T){const H=T[U];if(!this.opacities[U]){const Y=new Qi(H,v,!1,!1);Y.isHidden()||(this.opacities[U]=Y,g=g||H.text.placed||H.icon.placed)}}for(const U in R)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=R[U]);for(const U in O)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=O[U]);if(h&&h.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:i)}updateLayerOpacities(i,h){const g={};for(const v of h){const T=v.getBucket(i);T&&v.latestFeatureIndex&&i.id===T.layerIds[0]&&this.updateBucketOpacities(T,v.tileID,g,v.collisionBoxArray)}}updateBucketOpacities(i,h,g,v){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const T=i.layers[0],R=T.layout,O=new Qi(null,0,!1,!1,!0),U=R.get("text-allow-overlap"),H=R.get("icon-allow-overlap"),Y=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),X=R.get("text-rotation-alignment")==="map",le=R.get("text-pitch-alignment")==="map",fe=R.get("icon-text-fit")!=="none",_e=new Qi(null,0,U&&(H||!i.hasIconData()||R.get("icon-optional")),H&&(U||!i.hasTextData()||R.get("text-optional")),!0);!i.collisionArrays&&v&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(v);const Ee=(Ie,ze,Se)=>{for(let Fe=0;Fe<ze/4;Fe++)Ie.opacityVertexArray.emplaceBack(Se);Ie.hasVisibleVertices=Ie.hasVisibleVertices||Se!==Ir},Pe=this.collisionBoxArrays.get(i.bucketInstanceId);for(let Ie=0;Ie<i.symbolInstances.length;Ie++){const ze=i.symbolInstances.get(Ie),{numHorizontalGlyphVertices:Se,numVerticalGlyphVertices:Fe,crossTileID:Ye}=ze;let rt=this.opacities[Ye];g[Ye]?rt=O:rt||(rt=_e,this.opacities[Ye]=rt),g[Ye]=!0;const bt=ze.numIconVertices>0,$t=this.placedOrientations[ze.crossTileID],Ht=$t===d.ah.vertical,Qt=$t===d.ah.horizontal||$t===d.ah.horizontalOnly;if(Se>0||Fe>0){const Ut=Is(rt.text);Ee(i.text,Se,Ht?Ir:Ut),Ee(i.text,Fe,Qt?Ir:Ut);const ni=rt.text.isHidden();[ze.rightJustifiedTextSymbolIndex,ze.centerJustifiedTextSymbolIndex,ze.leftJustifiedTextSymbolIndex].forEach((Xt=>{Xt>=0&&(i.text.placedSymbolArray.get(Xt).hidden=ni||Ht?1:0)})),ze.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(ze.verticalPlacedTextSymbolIndex).hidden=ni||Qt?1:0);const ki=this.variableOffsets[ze.crossTileID];ki&&this.markUsedJustification(i,ki.anchor,ze,$t);const Gt=this.placedOrientations[ze.crossTileID];Gt&&(this.markUsedJustification(i,"left",ze,Gt),this.markUsedOrientation(i,Gt,ze))}if(bt){const Ut=Is(rt.icon),ni=!(fe&&ze.verticalPlacedIconSymbolIndex&&Ht);ze.placedIconSymbolIndex>=0&&(Ee(i.icon,ze.numIconVertices,ni?Ut:Ir),i.icon.placedSymbolArray.get(ze.placedIconSymbolIndex).hidden=rt.icon.isHidden()),ze.verticalPlacedIconSymbolIndex>=0&&(Ee(i.icon,ze.numVerticalIconVertices,ni?Ir:Ut),i.icon.placedSymbolArray.get(ze.verticalPlacedIconSymbolIndex).hidden=rt.icon.isHidden())}const Zt=Pe&&Pe.has(Ie)?Pe.get(Ie):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Ut=i.collisionArrays[Ie];if(Ut){let ni=new d.P(0,0);if(Ut.textBox||Ut.verticalTextBox){let ki=!0;if(Y){const Gt=this.variableOffsets[Ye];Gt?(ni=Ot(Gt.anchor,Gt.width,Gt.height,Gt.textOffset,Gt.textBoxScale),X&&ni._rotate(le?this.transform.angle:-this.transform.angle)):ki=!1}if(Ut.textBox||Ut.verticalTextBox){let Gt;Ut.textBox&&(Gt=Ht),Ut.verticalTextBox&&(Gt=Qt),ln(i.textCollisionBox.collisionVertexArray,rt.text.placed,!ki||Gt,Zt.text,ni.x,ni.y)}}if(Ut.iconBox||Ut.verticalIconBox){const ki=!!(!Qt&&Ut.verticalIconBox);let Gt;Ut.iconBox&&(Gt=ki),Ut.verticalIconBox&&(Gt=!ki),ln(i.iconCollisionBox.collisionVertexArray,rt.icon.placed,Gt,Zt.icon,fe?ni.x:0,fe?ni.y:0)}}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const Ie=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Ie.invProjMatrix,i.placementViewportMatrix=Ie.viewportMatrix,i.collisionCircleArray=Ie.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,h){const g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>i}setStale(){this.stale=!0}}function ln(E,i,h,g,v,T){g&&g.length!==0||(g=[0,0,0,0]);const R=g[0]-At,O=g[1]-At,U=g[2]-At,H=g[3]-At;E.emplaceBack(i?1:0,h?1:0,v||0,T||0,R,O),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,U,O),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,U,H),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,R,H)}const ut=Math.pow(2,25),Ft=Math.pow(2,24),Ti=Math.pow(2,17),en=Math.pow(2,16),Li=Math.pow(2,9),vr=Math.pow(2,8),On=Math.pow(2,1);function Is(E){if(E.opacity===0&&!E.placed)return 0;if(E.opacity===1&&E.placed)return 4294967295;const i=E.placed?1:0,h=Math.floor(127*E.opacity);return h*ut+i*Ft+h*Ti+i*en+h*Li+i*vr+h*On+i}const Ir=0;function rr(){return{isOccluded:(E,i,h)=>!1,getPitchedTextCorrection:(E,i,h)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(E,i,h,g){throw new Error("Not implemented.")},translatePosition:(E,i,h,g)=>(function(v,T,R,O,U=!1){if(!R[0]&&!R[1])return[0,0];const H=U?O==="map"?v.angle:0:O==="viewport"?-v.angle:0;if(H){const Y=Math.sin(H),X=Math.cos(H);R=[R[0]*X-R[1]*Y,R[0]*Y+R[1]*X]}return[U?R[0]:pi(T,R[0],v.zoom),U?R[1]:pi(T,R[1],v.zoom)]})(E,i,h,g),getCircleRadiusCorrection:E=>1}}class yi{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,h,g,v,T){const R=this._bucketParts;for(;this._currentTileIndex<i.length;)if(h.getBucketParts(R,v,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort(((O,U)=>O.sortKey-U.sortKey)));this._currentPartIndex<R.length;)if(h.placeLayerBucketPart(R[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,T())return!0;return!1}}class An{constructor(i,h,g,v,T,R,O,U){this.placement=new ui(i,rr(),h,R,O,U),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(i,h,g){const v=N.now(),T=()=>!this._forceFullPlacement&&N.now()-v>2;for(;this._currentPlacementIndex>=0;){const R=h[i[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=O)&&(!R.maxzoom||R.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new yi(R)),this._inProgressLayer.continuePlacement(g[R.source],this.placement,this._showCollisionBoxes,R,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const bs=512/d.X/2;class pn{constructor(i,h,g){this.tileID=i,this.bucketInstanceId=g,this._symbolsByKey={};const v=new Map;for(let T=0;T<h.length;T++){const R=h.get(T),O=R.key,U=v.get(O);U?U.push(R):v.set(O,[R])}for(const[T,R]of v){const O={positions:R.map((U=>({x:Math.floor(U.anchorX*bs),y:Math.floor(U.anchorY*bs)}))),crossTileIDs:R.map((U=>U.crossTileID))};if(O.positions.length>128){const U=new d.av(O.positions.length,16,Uint16Array);for(const{x:H,y:Y}of O.positions)U.add(H,Y);U.finish(),delete O.positions,O.index=U}this._symbolsByKey[T]=O}}getScaledCoordinates(i,h){const{x:g,y:v,z:T}=this.tileID.canonical,{x:R,y:O,z:U}=h.canonical,H=bs/Math.pow(2,U-T),Y=(O*d.X+i.anchorY)*H,X=v*d.X*bs;return{x:Math.floor((R*d.X+i.anchorX)*H-g*d.X*bs),y:Math.floor(Y-X)}}findMatches(i,h,g){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let T=0;T<i.length;T++){const R=i.get(T);if(R.crossTileID)continue;const O=this._symbolsByKey[R.key];if(!O)continue;const U=this.getScaledCoordinates(R,h);if(O.index){const H=O.index.range(U.x-v,U.y-v,U.x+v,U.y+v).sort();for(const Y of H){const X=O.crossTileIDs[Y];if(!g[X]){g[X]=!0,R.crossTileID=X;break}}}else if(O.positions)for(let H=0;H<O.positions.length;H++){const Y=O.positions[H],X=O.crossTileIDs[H];if(Math.abs(Y.x-U.x)<=v&&Math.abs(Y.y-U.y)<=v&&!g[X]){g[X]=!0,R.crossTileID=X;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:i})=>i))}}class Na{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const h=Math.round((i-this.lng)/360);if(h!==0)for(const g in this.indexes){const v=this.indexes[g],T={};for(const R in v){const O=v[R];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+h),T[O.tileID.key]=O}this.indexes[g]=T}this.lng=i}addBucket(i,h,g){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let T=0;T<h.symbolInstances.length;T++)h.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const v=this.usedCrossTileIDs[i.overscaledZ];for(const T in this.indexes){const R=this.indexes[T];if(Number(T)>i.overscaledZ)for(const O in R){const U=R[O];U.tileID.isChildOf(i)&&U.findMatches(h.symbolInstances,i,v)}else{const O=R[i.scaledTo(Number(T)).key];O&&O.findMatches(h.symbolInstances,i,v)}}for(let T=0;T<h.symbolInstances.length;T++){const R=h.symbolInstances.get(T);R.crossTileID||(R.crossTileID=g.generate(),v[R.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new pn(i,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(i,h){for(const g of h.getCrossTileIDsLists())for(const v of g)delete this.usedCrossTileIDs[i][v]}removeStaleBuckets(i){let h=!1;for(const g in this.indexes){const v=this.indexes[g];for(const T in v)i[v[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,v[T]),delete v[T],h=!0)}return h}}class $i{constructor(){this.layerIndexes={},this.crossTileIDs=new Na,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,h,g){let v=this.layerIndexes[i.id];v===void 0&&(v=this.layerIndexes[i.id]=new qr);let T=!1;const R={};v.handleWrapJump(g);for(const O of h){const U=O.getBucket(i);U&&i.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(O.tileID,U,this.crossTileIDs)&&(T=!0),R[U.bucketInstanceId]=!0)}return v.removeStaleBuckets(R)&&(T=!0),T}pruneUnusedLayers(i){const h={};i.forEach((g=>{h[g]=!0}));for(const g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}const Ln=(E,i)=>d.t(E,i&&i.filter((h=>h.identifier!=="source.canvas"))),Pl=d.aw();class Wo extends d.E{constructor(i,h={}){super(),this._rtlPluginLoaded=()=>{for(const g in this.sourceCaches){const v=this.sourceCaches[g].getSource().type;v!=="vector"&&v!=="geojson"||this.sourceCaches[g].reload()}},this.map=i,this.dispatcher=new Gi(li(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",((g,v)=>this.getGlyphs(g,v))),this.dispatcher.registerMessageHandler("GI",((g,v)=>this.getImages(g,v))),this.imageManager=new Et,this.imageManager.setEventedParent(this),this.glyphManager=new ct(i._requestManager,h.localIdeographFontFamily),this.lineAtlas=new st(256,512),this.crossTileSymbolIndex=new $i,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.ay()),Tn().on(Ct,this._rtlPluginLoaded),this.on("data",(g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const v=this.sourceCaches[g.sourceId];if(!v)return;const T=v.getSource();if(T&&T.vectorLayerIds)for(const R in this._layers){const O=this._layers[R];O.source===T.id&&this._validateLayer(O)}}))}loadURL(i,h={},g){this.fire(new d.k("dataloading",{dataType:"style"})),h.validate=typeof h.validate!="boolean"||h.validate;const v=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController;const T=this._loadStyleRequest;d.h(v,this._loadStyleRequest).then((R=>{this._loadStyleRequest=null,this._load(R.data,h,g)})).catch((R=>{this._loadStyleRequest=null,R&&!T.signal.aborted&&this.fire(new d.j(R))}))}loadJSON(i,h={},g){this.fire(new d.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,h.validate=h.validate!==!1,this._load(i,h,g)})).catch((()=>{}))}loadEmpty(){this.fire(new d.k("dataloading",{dataType:"style"})),this._load(Pl,{validate:!1})}_load(i,h,g){var v;const T=h.transformStyle?h.transformStyle(g,i):i;if(!h.validate||!Ln(this,d.u(T))){this._loaded=!0,this.stylesheet=T;for(const R in T.sources)this.addSource(R,T.sources[R],{validate:!1});T.sprite?this._loadSprite(T.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(T.glyphs),this._createLayers(),this.light=new lt(this.stylesheet.light),this.sky=new Ce(this.stylesheet.sky),this.map.setTerrain((v=this.stylesheet.terrain)!==null&&v!==void 0?v:null),this.fire(new d.k("data",{dataType:"style"})),this.fire(new d.k("style.load"))}}_createLayers(){const i=d.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map((h=>h.id)),this._layers={},this._serializedLayers=null;for(const h of i){const g=d.aA(h);g.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=g}}_loadSprite(i,h=!1,g=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(T,R,O,U){return d._(this,void 0,void 0,(function*(){const H=He(T),Y=O>1?"@2x":"",X={},le={};for(const{id:fe,url:_e}of H){const Ee=R.transformRequest(Xe(_e,Y,".json"),"SpriteJSON");X[fe]=d.h(Ee,U);const Pe=R.transformRequest(Xe(_e,Y,".png"),"SpriteImage");le[fe]=oe.getImage(Pe,U)}return yield Promise.all([...Object.values(X),...Object.values(le)]),(function(fe,_e){return d._(this,void 0,void 0,(function*(){const Ee={};for(const Pe in fe){Ee[Pe]={};const Ie=N.getImageCanvasContext((yield _e[Pe]).data),ze=(yield fe[Pe]).data;for(const Se in ze){const{width:Fe,height:Ye,x:rt,y:bt,sdf:$t,pixelRatio:Ht,stretchX:Qt,stretchY:Zt,content:Ut,textFitWidth:ni,textFitHeight:ki}=ze[Se];Ee[Pe][Se]={data:null,pixelRatio:Ht,sdf:$t,stretchX:Qt,stretchY:Zt,content:Ut,textFitWidth:ni,textFitHeight:ki,spriteData:{width:Fe,height:Ye,x:rt,y:bt,context:Ie}}}}return Ee}))})(X,le)}))})(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((T=>{if(this._spriteRequest=null,T)for(const R in T){this._spritesImagesIds[R]=[];const O=this._spritesImagesIds[R]?this._spritesImagesIds[R].filter((U=>!(U in T))):[];for(const U of O)this.imageManager.removeImage(U),this._changedImages[U]=!0;for(const U in T[R]){const H=R==="default"?U:`${R}:${U}`;this._spritesImagesIds[R].push(H),H in this.imageManager.images?this.imageManager.updateImage(H,T[R][U],!1):this.imageManager.addImage(H,T[R][U]),h&&(this._changedImages[H]=!0)}}})).catch((T=>{this._spriteRequest=null,v=T,this.fire(new d.j(v))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),h&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"})),g&&g(v)}))}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}_validateLayer(i){const h=this.sourceCaches[i.source];if(!h)return;const g=i.sourceLayer;if(!g)return;const v=h.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(g)===-1)&&this.fire(new d.j(new Error(`Source layer "${g}" does not exist on source "${v.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i,h=!1){const g=this._serializedAllLayers();if(!i||i.length===0)return Object.values(h?d.aB(g):g);const v=[];for(const T of i)if(g[T]){const R=h?d.aB(g[T]):g[T];v.push(R)}return v}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const h=Object.keys(this._layers);for(const g of h){const v=this._layers[g];v.type!=="custom"&&(i[g]=v.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const h=this._changed;if(h){const v=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(v.length||T.length)&&this._updateWorkerLayers(v,T);for(const R in this._updatedSources){const O=this._updatedSources[R];if(O==="reload")this._reloadSource(R);else{if(O!=="clear")throw new Error(`Invalid action ${O}`);this._clearSource(R)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(i);this.light.updateTransitions(i),this.sky.updateTransitions(i),this._resetUpdates()}const g={};for(const v in this.sourceCaches){const T=this.sourceCaches[v];g[v]=T.used,T.used=!1}for(const v of this._order){const T=this._layers[v];T.recalculate(i,this._availableImages),!T.isHidden(i.zoom)&&T.source&&(this.sourceCaches[T.source].used=!0)}for(const v in g){const T=this.sourceCaches[v];!!g[v]!=!!T.used&&T.fire(new d.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(i),this.sky.recalculate(i),this.z=i.zoom,h&&this.fire(new d.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,h){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i,!1),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,h={}){var g;this._checkLoaded();const v=this.serialize();if(i=h.transformStyle?h.transformStyle(v,i):i,((g=h.validate)===null||g===void 0||g)&&Ln(this,d.u(i)))return!1;(i=d.aB(i)).layers=d.az(i.layers);const T=d.aC(v,i),R=this._getOperationsToPerform(T);if(R.unimplemented.length>0)throw new Error(`Unimplemented: ${R.unimplemented.join(", ")}.`);if(R.operations.length===0)return!1;for(const O of R.operations)O();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const h=[],g=[];for(const v of i)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":h.push((()=>this.addLayer.apply(this,v.args)));break;case"removeLayer":h.push((()=>this.removeLayer.apply(this,v.args)));break;case"setPaintProperty":h.push((()=>this.setPaintProperty.apply(this,v.args)));break;case"setLayoutProperty":h.push((()=>this.setLayoutProperty.apply(this,v.args)));break;case"setFilter":h.push((()=>this.setFilter.apply(this,v.args)));break;case"addSource":h.push((()=>this.addSource.apply(this,v.args)));break;case"removeSource":h.push((()=>this.removeSource.apply(this,v.args)));break;case"setLayerZoomRange":h.push((()=>this.setLayerZoomRange.apply(this,v.args)));break;case"setLight":h.push((()=>this.setLight.apply(this,v.args)));break;case"setGeoJSONSourceData":h.push((()=>this.setGeoJSONSourceData.apply(this,v.args)));break;case"setGlyphs":h.push((()=>this.setGlyphs.apply(this,v.args)));break;case"setSprite":h.push((()=>this.setSprite.apply(this,v.args)));break;case"setSky":h.push((()=>this.setSky.apply(this,v.args)));break;case"setTerrain":h.push((()=>this.map.setTerrain.apply(this,v.args)));break;case"setTransition":h.push((()=>{}));break;default:g.push(v.command)}return{operations:h,unimplemented:g}}addImage(i,h){if(this.getImage(i))return this.fire(new d.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,h),this._afterImageUpdated(i)}updateImage(i,h){this.imageManager.updateImage(i,h)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new d.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,h,g={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(d.u.source,`sources.${i}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=this.sourceCaches[i]=new Jt(i,h,this.dispatcher);v.style=this,v.setEventedParent(this,(()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:i}))),v.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===i)return this.fire(new d.j(new Error(`Source "${i}" cannot be removed while layer "${g}" is using it.`)));const h=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],h.fire(new d.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,h){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const g=this.sourceCaches[i].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(h),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,h,g={}){this._checkLoaded();const v=i.id;if(this.getLayer(v))return void this.fire(new d.j(new Error(`Layer "${v}" already exists on this map.`)));let T;if(i.type==="custom"){if(Ln(this,d.aD(i)))return;T=d.aA(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(v,i.source),i=d.aB(i),i=d.e(i,{source:v})),this._validate(d.u.layer,`layers.${v}`,i,{arrayIndex:-1},g))return;T=d.aA(i),this._validateLayer(T),T.setEventedParent(this,{layer:{id:v}})}const R=h?this._order.indexOf(h):this._order.length;if(h&&R===-1)this.fire(new d.j(new Error(`Cannot add layer "${v}" before non-existing layer "${h}".`)));else{if(this._order.splice(R,0,v),this._layerOrderChanged=!0,this._layers[v]=T,this._removedLayers[v]&&T.source&&T.type!=="custom"){const O=this._removedLayers[v];delete this._removedLayers[v],O.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}moveLayer(i,h){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new d.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===h)return;const g=this._order.indexOf(i);this._order.splice(g,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new d.j(new Error(`Cannot move layer "${i}" before non-existing layer "${h}".`))):(this._order.splice(v,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const h=this._layers[i];if(!h)return void this.fire(new d.j(new Error(`Cannot remove non-existing layer "${i}".`)));h.setEventedParent(null);const g=this._order.indexOf(i);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=h,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],h.onRemove&&h.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,h,g){this._checkLoaded();const v=this.getLayer(i);v?v.minzoom===h&&v.maxzoom===g||(h!=null&&(v.minzoom=h),g!=null&&(v.maxzoom=g),this._updateLayer(v)):this.fire(new d.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,h,g={}){this._checkLoaded();const v=this.getLayer(i);if(v){if(!d.aE(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(d.u.filter,`layers.${v.id}.filter`,h,null,g)||(v.filter=d.aB(h),this._updateLayer(v)))}else this.fire(new d.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return d.aB(this.getLayer(i).filter)}setLayoutProperty(i,h,g,v={}){this._checkLoaded();const T=this.getLayer(i);T?d.aE(T.getLayoutProperty(h),g)||(T.setLayoutProperty(h,g,v),this._updateLayer(T)):this.fire(new d.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,h){const g=this.getLayer(i);if(g)return g.getLayoutProperty(h);this.fire(new d.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,h,g,v={}){this._checkLoaded();const T=this.getLayer(i);T?d.aE(T.getPaintProperty(h),g)||(T.setPaintProperty(h,g,v)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[i]=!0,this._serializedLayers=null):this.fire(new d.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,h){return this.getLayer(i).getPaintProperty(h)}setFeatureState(i,h){this._checkLoaded();const g=i.source,v=i.sourceLayer,T=this.sourceCaches[g];if(T===void 0)return void this.fire(new d.j(new Error(`The source '${g}' does not exist in the map's style.`)));const R=T.getSource().type;R==="geojson"&&v?this.fire(new d.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):R!=="vector"||v?(i.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),T.setFeatureState(v,i.id,h)):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,h){this._checkLoaded();const g=i.source,v=this.sourceCaches[g];if(v===void 0)return void this.fire(new d.j(new Error(`The source '${g}' does not exist in the map's style.`)));const T=v.getSource().type,R=T==="vector"?i.sourceLayer:void 0;T!=="vector"||R?h&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new d.j(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(R,i.id,h):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const h=i.source,g=i.sourceLayer,v=this.sourceCaches[h];if(v!==void 0)return v.getSource().type!=="vector"||g?(i.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),v.getFeatureState(g,i.id)):void this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.j(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=d.aF(this.sourceCaches,(T=>T.serialize())),h=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,v=this.stylesheet;return d.aG({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,sources:i,layers:h,terrain:g},(T=>T!==void 0))}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const h=R=>this._layers[R].type==="fill-extrusion",g={},v=[];for(let R=this._order.length-1;R>=0;R--){const O=this._order[R];if(h(O)){g[O]=R;for(const U of i){const H=U[O];if(H)for(const Y of H)v.push(Y)}}}v.sort(((R,O)=>O.intersectionZ-R.intersectionZ));const T=[];for(let R=this._order.length-1;R>=0;R--){const O=this._order[R];if(h(O))for(let U=v.length-1;U>=0;U--){const H=v[U].feature;if(g[H.layer.id]<R)break;T.push(H),v.pop()}else for(const U of i){const H=U[O];if(H)for(const Y of H)T.push(Y.feature)}}return T}queryRenderedFeatures(i,h,g){h&&h.filter&&this._validate(d.u.filter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new d.j(new Error("parameters.layers must be an Array."))),[];for(const O of h.layers){const U=this._layers[O];if(!U)return this.fire(new d.j(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];v[U.source]=!0}}const T=[];h.availableImages=this._availableImages;const R=this._serializedAllLayers();for(const O in this.sourceCaches)h.layers&&!v[O]||T.push(Pn(this.sourceCaches[O],this._layers,R,i,h,g));return this.placement&&T.push((function(O,U,H,Y,X,le,fe){const _e={},Ee=le.queryRenderedSymbols(Y),Pe=[];for(const Ie of Object.keys(Ee).map(Number))Pe.push(fe[Ie]);Pe.sort(hn);for(const Ie of Pe){const ze=Ie.featureIndex.lookupSymbolFeatures(Ee[Ie.bucketInstanceId],U,Ie.bucketIndex,Ie.sourceLayerIndex,X.filter,X.layers,X.availableImages,O);for(const Se in ze){const Fe=_e[Se]=_e[Se]||[],Ye=ze[Se];Ye.sort(((rt,bt)=>{const $t=Ie.featureSortOrder;if($t){const Ht=$t.indexOf(rt.featureIndex);return $t.indexOf(bt.featureIndex)-Ht}return bt.featureIndex-rt.featureIndex}));for(const rt of Ye)Fe.push(rt)}}for(const Ie in _e)_e[Ie].forEach((ze=>{const Se=ze.feature,Fe=H[O[Ie].source].getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Fe}));return _e})(this._layers,R,this.sourceCaches,i,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(i,h){h&&h.filter&&this._validate(d.u.filter,"querySourceFeatures.filter",h.filter,null,h);const g=this.sourceCaches[i];return g?(function(v,T){const R=v.getRenderableIds().map((H=>v.getTileByID(H))),O=[],U={};for(let H=0;H<R.length;H++){const Y=R[H],X=Y.tileID.canonical.key;U[X]||(U[X]=!0,Y.querySourceFeatures(O,T))}return O})(g,h):[]}getLight(){return this.light.getLight()}setLight(i,h={}){this._checkLoaded();const g=this.light.getLight();let v=!1;for(const R in i)if(!d.aE(i[R],g[R])){v=!0;break}if(!v)return;const T={now:N.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,h),this.light.updateTransitions(T)}getSky(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.sky}setSky(i,h={}){const g=this.getSky();let v=!1;if(!i&&!g)return;if(i&&!g)v=!0;else if(!i&&g)v=!0;else for(const R in i)if(!d.aE(i[R],g[R])){v=!0;break}if(!v)return;const T={now:N.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=i,this.sky.setSky(i,h),this.sky.updateTransitions(T)}_validate(i,h,g,v,T={}){return(!T||T.validate!==!1)&&Ln(this,i.call(d.u,d.e({key:h,style:this.serialize(),value:g,styleSpec:d.v},v)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Tn().off(Ct,this._rtlPluginLoaded);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this.sourceCaches){const g=this.sourceCaches[h];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const h in this.sourceCaches)this.sourceCaches[h].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,h,g,v,T=!1){let R=!1,O=!1;const U={};for(const H of this._order){const Y=this._layers[H];if(Y.type!=="symbol")continue;if(!U[Y.source]){const le=this.sourceCaches[Y.source];U[Y.source]=le.getRenderableIds(!0).map((fe=>le.getTileByID(fe))).sort(((fe,_e)=>_e.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(_e.tileID)?-1:1)))}const X=this.crossTileSymbolIndex.addLayer(Y,U[Y.source],i.center.lng);R=R||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(N.now(),i.zoom))&&(this.pauseablePlacement=new An(i,this.map.terrain,this._order,T,h,g,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(N.now()),O=!0),R&&this.pauseablePlacement.placement.setStale()),O||R)for(const H of this._order){const Y=this._layers[H];Y.type==="symbol"&&this.placement.updateLayerOpacities(Y,U[Y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(N.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,h){return d._(this,void 0,void 0,(function*(){const g=yield this.imageManager.getImages(h.icons);this._updateTilesForChangedImages();const v=this.sourceCaches[h.source];return v&&v.setDependencies(h.tileID.key,h.type,h.icons),g}))}getGlyphs(i,h){return d._(this,void 0,void 0,(function*(){const g=yield this.glyphManager.getGlyphs(h.stacks),v=this.sourceCaches[h.source];return v&&v.setDependencies(h.tileID.key,h.type,[""]),g}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,h={}){this._checkLoaded(),i&&this._validate(d.u.glyphs,"glyphs",i,null,h)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,h,g={},v){this._checkLoaded();const T=[{id:i,url:h}],R=[...He(this.stylesheet.sprite),...T];this._validate(d.u.sprite,"sprite",R,null,g)||(this.stylesheet.sprite=R,this._loadSprite(T,!0,v))}removeSprite(i){this._checkLoaded();const h=He(this.stylesheet.sprite);if(h.find((g=>g.id===i))){if(this._spritesImagesIds[i])for(const g of this._spritesImagesIds[i])this.imageManager.removeImage(g),this._changedImages[g]=!0;h.splice(h.findIndex((g=>g.id===i)),1),this.stylesheet.sprite=h.length>0?h:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}else this.fire(new d.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return He(this.stylesheet.sprite)}setSprite(i,h={},g){this._checkLoaded(),i&&this._validate(d.u.sprite,"sprite",i,null,h)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,g):(this._unloadSprite(),g&&g(null)))}}var Un=d.Y([{name:"a_pos",type:"Int16",components:2}]);const Ba={prelude:mn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:mn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:mn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:mn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:mn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:mn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:mn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:mn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:mn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:mn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:mn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:mn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:mn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:mn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:mn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:mn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:mn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:mn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:mn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:mn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:mn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:mn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function mn(E,i){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=i.match(/attribute ([\w]+) ([\w]+)/g),v=E.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=T?T.concat(v):v,O={};return{fragmentSource:E=E.replace(h,((U,H,Y,X,le)=>(O[le]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${le}
varying ${Y} ${X} ${le};
#else
uniform ${Y} ${X} u_${le};
#endif
`:`
#ifdef HAS_UNIFORM_u_${le}
    ${Y} ${X} ${le} = u_${le};
#endif
`))),vertexSource:i=i.replace(h,((U,H,Y,X,le)=>{const fe=X==="float"?"vec2":"vec4",_e=le.match(/color/)?"color":fe;return O[le]?H==="define"?`
#ifndef HAS_UNIFORM_u_${le}
uniform lowp float u_${le}_t;
attribute ${Y} ${fe} a_${le};
varying ${Y} ${X} ${le};
#else
uniform ${Y} ${X} u_${le};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${le}
    ${le} = a_${le};
#else
    ${Y} ${X} ${le} = u_${le};
#endif
`:`
#ifndef HAS_UNIFORM_u_${le}
    ${le} = unpack_mix_${_e}(a_${le}, u_${le}_t);
#else
    ${Y} ${X} ${le} = u_${le};
#endif
`:H==="define"?`
#ifndef HAS_UNIFORM_u_${le}
uniform lowp float u_${le}_t;
attribute ${Y} ${fe} a_${le};
#else
uniform ${Y} ${X} u_${le};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${le}
    ${Y} ${X} ${le} = a_${le};
#else
    ${Y} ${X} ${le} = u_${le};
#endif
`:`
#ifndef HAS_UNIFORM_u_${le}
    ${Y} ${X} ${le} = unpack_mix_${_e}(a_${le}, u_${le}_t);
#else
    ${Y} ${X} ${le} = u_${le};
#endif
`})),staticAttributes:g,staticUniforms:R}}class wa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,h,g,v,T,R,O,U,H){this.context=i;let Y=this.boundPaintVertexBuffers.length!==v.length;for(let X=0;!Y&&X<v.length;X++)this.boundPaintVertexBuffers[X]!==v[X]&&(Y=!0);!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==g||Y||this.boundIndexBuffer!==T||this.boundVertexOffset!==R||this.boundDynamicVertexBuffer!==O||this.boundDynamicVertexBuffer2!==U||this.boundDynamicVertexBuffer3!==H?this.freshBind(h,g,v,T,R,O,U,H):(i.bindVertexArray.set(this.vao),O&&O.bind(),T&&T.dynamicDraw&&T.bind(),U&&U.bind(),H&&H.bind())}freshBind(i,h,g,v,T,R,O,U){const H=i.numAttributes,Y=this.context,X=Y.gl;this.vao&&this.destroy(),this.vao=Y.createVertexArray(),Y.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=v,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=R,this.boundDynamicVertexBuffer2=O,this.boundDynamicVertexBuffer3=U,h.enableAttributes(X,i);for(const le of g)le.enableAttributes(X,i);R&&R.enableAttributes(X,i),O&&O.enableAttributes(X,i),U&&U.enableAttributes(X,i),h.bind(),h.setVertexAttribPointers(X,i,T);for(const le of g)le.bind(),le.setVertexAttribPointers(X,i,T);R&&(R.bind(),R.setVertexAttribPointers(X,i,T)),v&&v.bind(),O&&(O.bind(),O.setVertexAttribPointers(X,i,T)),U&&(U.bind(),U.setVertexAttribPointers(X,i,T)),Y.currentNumAttributes=H}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Xn=(E,i,h,g,v)=>({u_matrix:E,u_texture:0,u_ele_delta:i,u_fog_matrix:h,u_fog_color:g?g.properties.get("fog-color"):d.aM.white,u_fog_ground_blend:g?g.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?g.calculateFogBlendOpacity(v):0,u_horizon_color:g?g.properties.get("horizon-color"):d.aM.white,u_horizon_fog_blend:g?g.properties.get("horizon-fog-blend"):1});function Hr(E){const i=[];for(let h=0;h<E.length;h++){if(E[h]===null)continue;const g=E[h].split(" ");i.push(g.pop())}return i}class Co{constructor(i,h,g,v,T,R){const O=i.gl;this.program=O.createProgram();const U=Hr(h.staticAttributes),H=g?g.getBinderAttributes():[],Y=U.concat(H),X=Ba.prelude.staticUniforms?Hr(Ba.prelude.staticUniforms):[],le=h.staticUniforms?Hr(h.staticUniforms):[],fe=g?g.getBinderUniforms():[],_e=X.concat(le).concat(fe),Ee=[];for(const rt of _e)Ee.indexOf(rt)<0&&Ee.push(rt);const Pe=g?g.defines():[];T&&Pe.push("#define OVERDRAW_INSPECTOR;"),R&&Pe.push("#define TERRAIN3D;");const Ie=Pe.concat(Ba.prelude.fragmentSource,h.fragmentSource).join(`
`),ze=Pe.concat(Ba.prelude.vertexSource,h.vertexSource).join(`
`),Se=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(Se,Ie),O.compileShader(Se),!O.getShaderParameter(Se,O.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${O.getShaderInfoLog(Se)}`);O.attachShader(this.program,Se);const Fe=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(Fe,ze),O.compileShader(Fe),!O.getShaderParameter(Fe,O.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${O.getShaderInfoLog(Fe)}`);O.attachShader(this.program,Fe),this.attributes={};const Ye={};this.numAttributes=Y.length;for(let rt=0;rt<this.numAttributes;rt++)Y[rt]&&(O.bindAttribLocation(this.program,rt,Y[rt]),this.attributes[Y[rt]]=rt);if(O.linkProgram(this.program),!O.getProgramParameter(this.program,O.LINK_STATUS))throw new Error(`Program failed to link: ${O.getProgramInfoLog(this.program)}`);O.deleteShader(Fe),O.deleteShader(Se);for(let rt=0;rt<Ee.length;rt++){const bt=Ee[rt];if(bt&&!Ye[bt]){const $t=O.getUniformLocation(this.program,bt);$t&&(Ye[bt]=$t)}}this.fixedUniforms=v(i,Ye),this.terrainUniforms=((rt,bt)=>({u_depth:new d.aH(rt,bt.u_depth),u_terrain:new d.aH(rt,bt.u_terrain),u_terrain_dim:new d.aI(rt,bt.u_terrain_dim),u_terrain_matrix:new d.aJ(rt,bt.u_terrain_matrix),u_terrain_unpack:new d.aK(rt,bt.u_terrain_unpack),u_terrain_exaggeration:new d.aI(rt,bt.u_terrain_exaggeration)}))(i,Ye),this.binderUniforms=g?g.getUniforms(i,Ye):[]}draw(i,h,g,v,T,R,O,U,H,Y,X,le,fe,_e,Ee,Pe,Ie,ze){const Se=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(g),i.setStencilMode(v),i.setColorMode(T),i.setCullFace(R),U){i.activeTexture.set(Se.TEXTURE2),Se.bindTexture(Se.TEXTURE_2D,U.depthTexture),i.activeTexture.set(Se.TEXTURE3),Se.bindTexture(Se.TEXTURE_2D,U.texture);for(const Ye in this.terrainUniforms)this.terrainUniforms[Ye].set(U[Ye])}for(const Ye in this.fixedUniforms)this.fixedUniforms[Ye].set(O[Ye]);Ee&&Ee.setUniforms(i,this.binderUniforms,fe,{zoom:_e});let Fe=0;switch(h){case Se.LINES:Fe=2;break;case Se.TRIANGLES:Fe=3;break;case Se.LINE_STRIP:Fe=1}for(const Ye of le.get()){const rt=Ye.vaos||(Ye.vaos={});(rt[H]||(rt[H]=new wa)).bind(i,this,Y,Ee?Ee.getPaintVertexBuffers():[],X,Ye.vertexOffset,Pe,Ie,ze),Se.drawElements(h,Ye.primitiveLength*Fe,Se.UNSIGNED_SHORT,Ye.primitiveOffset*Fe*2)}}}function Zr(E,i,h){const g=1/pi(h,1,i.transform.tileZoom),v=Math.pow(2,h.tileID.overscaledZ),T=h.tileSize*Math.pow(2,i.transform.tileZoom)/v,R=T*(h.tileID.canonical.x+h.tileID.wrap*v),O=T*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[R>>16,O>>16],u_pixel_coord_lower:[65535&R,65535&O]}}const Yo=(E,i,h,g)=>{const v=i.style.light,T=v.properties.get("position"),R=[T.x,T.y,T.z],O=(function(){var H=new d.A(9);return d.A!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[5]=0,H[6]=0,H[7]=0),H[0]=1,H[4]=1,H[8]=1,H})();v.properties.get("anchor")==="viewport"&&(function(H,Y){var X=Math.sin(Y),le=Math.cos(Y);H[0]=le,H[1]=X,H[2]=0,H[3]=-X,H[4]=le,H[5]=0,H[6]=0,H[7]=0,H[8]=1})(O,-i.transform.angle),(function(H,Y,X){var le=Y[0],fe=Y[1],_e=Y[2];H[0]=le*X[0]+fe*X[3]+_e*X[6],H[1]=le*X[1]+fe*X[4]+_e*X[7],H[2]=le*X[2]+fe*X[5]+_e*X[8]})(R,R,O);const U=v.properties.get("color");return{u_matrix:E,u_lightpos:R,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+h,u_opacity:g}},oo=(E,i,h,g,v,T,R)=>d.e(Yo(E,i,h,g),Zr(T,i,R),{u_height_factor:-Math.pow(2,v.overscaledZ)/R.tileSize/8}),lo=E=>({u_matrix:E}),Il=(E,i,h,g)=>d.e(lo(E),Zr(h,i,g)),Ic=(E,i)=>({u_matrix:E,u_world:i}),jc=(E,i,h,g,v)=>d.e(Il(E,i,h,g),{u_world:v}),jl=(E,i,h,g)=>{const v=E.transform;let T,R;if(g.paint.get("circle-pitch-alignment")==="map"){const O=pi(h,1,v.zoom);T=!0,R=[O,O]}else T=!1,R=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:E.translatePosMatrix(i.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+T,u_device_pixel_ratio:E.pixelRatio,u_extrude_scale:R}},qs=(E,i,h)=>({u_matrix:E,u_inv_matrix:i,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}),Ao=(E,i,h=1)=>({u_matrix:E,u_color:i,u_overlay:0,u_overlay_scale:h}),Hs=E=>({u_matrix:E}),Bs=(E,i,h,g)=>({u_matrix:E,u_extrude_scale:pi(i,1,h),u_intensity:g}),Ii=(E,i,h,g)=>{const v=d.H();d.aP(v,0,E.width,E.height,0,0,1);const T=E.context.gl;return{u_matrix:v,u_world:[T.drawingBufferWidth,T.drawingBufferHeight],u_image:h,u_color_ramp:g,u_opacity:i.paint.get("heatmap-opacity")}};function jr(E,i){const h=Math.pow(2,i.canonical.z),g=i.canonical.y;return[new d.Z(0,g/h).toLngLat().lat,new d.Z(0,(g+1)/h).toLngLat().lat]}const Rn=(E,i,h,g)=>{const v=E.transform;return{u_matrix:oa(E,i,h,g),u_ratio:1/pi(i,1,v.zoom),u_device_pixel_ratio:E.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Lc=(E,i,h,g,v)=>d.e(Rn(E,i,h,v),{u_image:0,u_image_height:g}),aa=(E,i,h,g,v)=>{const T=E.transform,R=Ll(i,T);return{u_matrix:oa(E,i,h,v),u_texsize:i.imageAtlasTexture.size,u_ratio:1/pi(i,1,T.zoom),u_device_pixel_ratio:E.pixelRatio,u_image:0,u_scale:[R,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},Sa=(E,i,h,g,v,T)=>{const R=E.lineAtlas,O=Ll(i,E.transform),U=h.layout.get("line-cap")==="round",H=R.getDash(g.from,U),Y=R.getDash(g.to,U),X=H.width*v.fromScale,le=Y.width*v.toScale;return d.e(Rn(E,i,h,T),{u_patternscale_a:[O/X,-H.height/2],u_patternscale_b:[O/le,-Y.height/2],u_sdfgamma:R.width/(256*Math.min(X,le)*E.pixelRatio)/2,u_image:0,u_tex_y_a:H.y,u_tex_y_b:Y.y,u_mix:v.t})};function Ll(E,i){return 1/pi(E,1,i.tileZoom)}function oa(E,i,h,g){return E.translatePosMatrix(g?g.posMatrix:i.tileID.posMatrix,i,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const $a=(E,i,h,g,v)=>{return{u_matrix:E,u_tl_parent:i,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(R=v.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(T=v.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Xo(v.paint.get("raster-hue-rotate"))};var T,R};function Xo(E){E*=Math.PI/180;const i=Math.sin(E),h=Math.cos(E);return[(2*h+1)/3,(-Math.sqrt(3)*i-h+1)/3,(Math.sqrt(3)*i-h+1)/3]}const Ts=(E,i,h,g,v,T,R,O,U,H,Y,X,le,fe)=>{const _e=R.transform;return{u_is_size_zoom_constant:+(E==="constant"||E==="source"),u_is_size_feature_constant:+(E==="constant"||E==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_pitch:_e.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:_e.width/_e.height,u_fade_change:R.options.fadeDuration?R.symbolFadeChange:1,u_matrix:O,u_label_plane_matrix:U,u_coord_matrix:H,u_is_text:+X,u_pitch_with_map:+g,u_is_along_line:v,u_is_variable_anchor:T,u_texsize:le,u_texture:0,u_translation:Y,u_pitched_scale:fe}},la=(E,i,h,g,v,T,R,O,U,H,Y,X,le,fe,_e)=>{const Ee=R.transform;return d.e(Ts(E,i,h,g,v,T,R,O,U,H,Y,X,le,_e),{u_gamma_scale:g?Math.cos(Ee._pitch)*Ee.cameraToCenterDistance:1,u_device_pixel_ratio:R.pixelRatio,u_is_halo:1})},Ko=(E,i,h,g,v,T,R,O,U,H,Y,X,le,fe)=>d.e(la(E,i,h,g,v,T,R,O,U,H,Y,!0,X,!0,fe),{u_texsize_icon:le,u_texture_icon:1}),Mo=(E,i,h)=>({u_matrix:E,u_opacity:i,u_color:h}),Rc=(E,i,h,g,v,T)=>d.e((function(R,O,U,H){const Y=U.imageManager.getPattern(R.from.toString()),X=U.imageManager.getPattern(R.to.toString()),{width:le,height:fe}=U.imageManager.getPixelSize(),_e=Math.pow(2,H.tileID.overscaledZ),Ee=H.tileSize*Math.pow(2,U.transform.tileZoom)/_e,Pe=Ee*(H.tileID.canonical.x+H.tileID.wrap*_e),Ie=Ee*H.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Y.tl,u_pattern_br_a:Y.br,u_pattern_tl_b:X.tl,u_pattern_br_b:X.br,u_texsize:[le,fe],u_mix:O.t,u_pattern_size_a:Y.displaySize,u_pattern_size_b:X.displaySize,u_scale_a:O.fromScale,u_scale_b:O.toScale,u_tile_units_to_pixels:1/pi(H,1,U.transform.tileZoom),u_pixel_coord_upper:[Pe>>16,Ie>>16],u_pixel_coord_lower:[65535&Pe,65535&Ie]}})(g,T,h,v),{u_matrix:E,u_opacity:i}),Qs={fillExtrusion:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_lightpos:new d.aN(E,i.u_lightpos),u_lightintensity:new d.aI(E,i.u_lightintensity),u_lightcolor:new d.aN(E,i.u_lightcolor),u_vertical_gradient:new d.aI(E,i.u_vertical_gradient),u_opacity:new d.aI(E,i.u_opacity)}),fillExtrusionPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_lightpos:new d.aN(E,i.u_lightpos),u_lightintensity:new d.aI(E,i.u_lightintensity),u_lightcolor:new d.aN(E,i.u_lightcolor),u_vertical_gradient:new d.aI(E,i.u_vertical_gradient),u_height_factor:new d.aI(E,i.u_height_factor),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade),u_opacity:new d.aI(E,i.u_opacity)}),fill:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix)}),fillPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),fillOutline:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world)}),fillOutlinePattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),circle:(E,i)=>({u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_scale_with_map:new d.aH(E,i.u_scale_with_map),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_extrude_scale:new d.aO(E,i.u_extrude_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_matrix:new d.aJ(E,i.u_matrix)}),collisionBox:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_pixel_extrude_scale:new d.aO(E,i.u_pixel_extrude_scale)}),collisionCircle:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_inv_matrix:new d.aJ(E,i.u_inv_matrix),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_viewport_size:new d.aO(E,i.u_viewport_size)}),debug:(E,i)=>({u_color:new d.aL(E,i.u_color),u_matrix:new d.aJ(E,i.u_matrix),u_overlay:new d.aH(E,i.u_overlay),u_overlay_scale:new d.aI(E,i.u_overlay_scale)}),clippingMask:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix)}),heatmap:(E,i)=>({u_extrude_scale:new d.aI(E,i.u_extrude_scale),u_intensity:new d.aI(E,i.u_intensity),u_matrix:new d.aJ(E,i.u_matrix)}),heatmapTexture:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world),u_image:new d.aH(E,i.u_image),u_color_ramp:new d.aH(E,i.u_color_ramp),u_opacity:new d.aI(E,i.u_opacity)}),hillshade:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_latrange:new d.aO(E,i.u_latrange),u_light:new d.aO(E,i.u_light),u_shadow:new d.aL(E,i.u_shadow),u_highlight:new d.aL(E,i.u_highlight),u_accent:new d.aL(E,i.u_accent)}),hillshadePrepare:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_dimension:new d.aO(E,i.u_dimension),u_zoom:new d.aI(E,i.u_zoom),u_unpack:new d.aK(E,i.u_unpack)}),line:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels)}),lineGradient:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_image:new d.aH(E,i.u_image),u_image_height:new d.aI(E,i.u_image_height)}),linePattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texsize:new d.aO(E,i.u_texsize),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_image:new d.aH(E,i.u_image),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),lineSDF:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_patternscale_a:new d.aO(E,i.u_patternscale_a),u_patternscale_b:new d.aO(E,i.u_patternscale_b),u_sdfgamma:new d.aI(E,i.u_sdfgamma),u_image:new d.aH(E,i.u_image),u_tex_y_a:new d.aI(E,i.u_tex_y_a),u_tex_y_b:new d.aI(E,i.u_tex_y_b),u_mix:new d.aI(E,i.u_mix)}),raster:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_tl_parent:new d.aO(E,i.u_tl_parent),u_scale_parent:new d.aI(E,i.u_scale_parent),u_buffer_scale:new d.aI(E,i.u_buffer_scale),u_fade_t:new d.aI(E,i.u_fade_t),u_opacity:new d.aI(E,i.u_opacity),u_image0:new d.aH(E,i.u_image0),u_image1:new d.aH(E,i.u_image1),u_brightness_low:new d.aI(E,i.u_brightness_low),u_brightness_high:new d.aI(E,i.u_brightness_high),u_saturation_factor:new d.aI(E,i.u_saturation_factor),u_contrast_factor:new d.aI(E,i.u_contrast_factor),u_spin_weights:new d.aN(E,i.u_spin_weights)}),symbolIcon:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texture:new d.aH(E,i.u_texture),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),symbolSDF:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texture:new d.aH(E,i.u_texture),u_gamma_scale:new d.aI(E,i.u_gamma_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_is_halo:new d.aH(E,i.u_is_halo),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),symbolTextAndIcon:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texsize_icon:new d.aO(E,i.u_texsize_icon),u_texture:new d.aH(E,i.u_texture),u_texture_icon:new d.aH(E,i.u_texture_icon),u_gamma_scale:new d.aI(E,i.u_gamma_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_is_halo:new d.aH(E,i.u_is_halo),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),background:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_opacity:new d.aI(E,i.u_opacity),u_color:new d.aL(E,i.u_color)}),backgroundPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_opacity:new d.aI(E,i.u_opacity),u_image:new d.aH(E,i.u_image),u_pattern_tl_a:new d.aO(E,i.u_pattern_tl_a),u_pattern_br_a:new d.aO(E,i.u_pattern_br_a),u_pattern_tl_b:new d.aO(E,i.u_pattern_tl_b),u_pattern_br_b:new d.aO(E,i.u_pattern_br_b),u_texsize:new d.aO(E,i.u_texsize),u_mix:new d.aI(E,i.u_mix),u_pattern_size_a:new d.aO(E,i.u_pattern_size_a),u_pattern_size_b:new d.aO(E,i.u_pattern_size_b),u_scale_a:new d.aI(E,i.u_scale_a),u_scale_b:new d.aI(E,i.u_scale_b),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_tile_units_to_pixels:new d.aI(E,i.u_tile_units_to_pixels)}),terrain:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texture:new d.aH(E,i.u_texture),u_ele_delta:new d.aI(E,i.u_ele_delta),u_fog_matrix:new d.aJ(E,i.u_fog_matrix),u_fog_color:new d.aL(E,i.u_fog_color),u_fog_ground_blend:new d.aI(E,i.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.aI(E,i.u_fog_ground_blend_opacity),u_horizon_color:new d.aL(E,i.u_horizon_color),u_horizon_fog_blend:new d.aI(E,i.u_horizon_fog_blend)}),terrainDepth:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ele_delta:new d.aI(E,i.u_ele_delta)}),terrainCoords:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texture:new d.aH(E,i.u_texture),u_terrain_coords_id:new d.aI(E,i.u_terrain_coords_id),u_ele_delta:new d.aI(E,i.u_ele_delta)}),sky:(E,i)=>({u_sky_color:new d.aL(E,i.u_sky_color),u_horizon_color:new d.aL(E,i.u_horizon_color),u_horizon:new d.aI(E,i.u_horizon),u_sky_horizon_blend:new d.aI(E,i.u_sky_horizon_blend)})};class Zs{constructor(i,h,g){this.context=i;const v=i.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const h=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const zc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Po{constructor(i,h,g,v){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=i;const T=i.gl;this.buffer=T.createBuffer(),i.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,h){for(let g=0;g<this.attributes.length;g++){const v=h.attributes[this.attributes[g].name];v!==void 0&&i.enableVertexAttribArray(v)}}setVertexAttribPointers(i,h,g){for(let v=0;v<this.attributes.length;v++){const T=this.attributes[v],R=h.attributes[T.name];R!==void 0&&i.vertexAttribPointer(R,T.components,i[zc[T.type]],!1,this.itemSize,T.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const tn=new WeakMap;function Ua(E){var i;if(tn.has(E))return tn.get(E);{const h=(i=E.getParameter(E.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return tn.set(E,h),h}}class Ui{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ca extends Ui{getDefault(){return d.aM.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class ec extends Ui{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Jo extends Ui{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class yu extends Ui{getDefault(){return[!0,!0,!0,!0]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Qu extends Ui{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class eh extends Ui{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Dc extends Ui{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const h=this.current;(i.func!==h.func||i.ref!==h.ref||i.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class _u extends Ui{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Oc extends Ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=i,this.dirty=!1}}class th extends Ui{getDefault(){return[0,1]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Ta extends Ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=i,this.dirty=!1}}class ih extends Ui{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class co extends Ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.BLEND):h.disable(h.BLEND),this.current=i,this.dirty=!1}}class uo extends Ui{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class nh extends Ui{getDefault(){return d.aM.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class vu extends Ui{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Qo extends Ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=i,this.dirty=!1}}class xu extends Ui{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class tc extends Ui{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class sh extends Ui{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Jh extends Ui{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class bu extends Ui{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Nc extends Ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class rh extends Ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Bc extends Ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class wu extends Ui{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class el extends Ui{getDefault(){return null}set(i){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class xr extends Ui{getDefault(){return null}set(i){var h;if(i===this.current&&!this.dirty)return;const g=this.gl;Ua(g)?g.bindVertexArray(i):(h=g.getExtension("OES_vertex_array_object"))===null||h===void 0||h.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Su extends Ui{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class tl extends Ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Lr extends Ui{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class il extends Ui{constructor(i,h){super(i),this.context=i,this.parent=h}getDefault(){return null}}class Io extends il{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class nl extends il{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Rl extends il{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class $c{constructor(i,h,g,v,T){this.context=i,this.width=h,this.height=g;const R=i.gl,O=this.framebuffer=R.createFramebuffer();if(this.colorAttachment=new Io(i,O),v)this.depthAttachment=T?new Rl(i,O):new nl(i,O);else if(T)throw new Error("Stencil cannot be set without depth");if(R.checkFramebufferStatus(R.FRAMEBUFFER)!==R.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,h=this.colorAttachment.get();if(h&&i.deleteTexture(h),this.depthAttachment){const g=this.depthAttachment.get();g&&i.deleteRenderbuffer(g)}i.deleteFramebuffer(this.framebuffer)}}class ys{constructor(i,h,g){this.blendFunction=i,this.blendColor=h,this.mask=g}}ys.Replace=[1,0],ys.disabled=new ys(ys.Replace,d.aM.transparent,[!1,!1,!1,!1]),ys.unblended=new ys(ys.Replace,d.aM.transparent,[!0,!0,!0,!0]),ys.alphaBlended=new ys([1,771],d.aM.transparent,[!0,!0,!0,!0]);class ah{constructor(i){var h,g;if(this.gl=i,this.clearColor=new ca(this),this.clearDepth=new ec(this),this.clearStencil=new Jo(this),this.colorMask=new yu(this),this.depthMask=new Qu(this),this.stencilMask=new eh(this),this.stencilFunc=new Dc(this),this.stencilOp=new _u(this),this.stencilTest=new Oc(this),this.depthRange=new th(this),this.depthTest=new Ta(this),this.depthFunc=new ih(this),this.blend=new co(this),this.blendFunc=new uo(this),this.blendColor=new nh(this),this.blendEquation=new vu(this),this.cullFace=new Qo(this),this.cullFaceSide=new xu(this),this.frontFace=new tc(this),this.program=new sh(this),this.activeTexture=new Jh(this),this.viewport=new bu(this),this.bindFramebuffer=new Nc(this),this.bindRenderbuffer=new rh(this),this.bindTexture=new Bc(this),this.bindVertexBuffer=new wu(this),this.bindElementBuffer=new el(this),this.bindVertexArray=new xr(this),this.pixelStoreUnpack=new Su(this),this.pixelStoreUnpackPremultiplyAlpha=new tl(this),this.pixelStoreUnpackFlipY=new Lr(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),Ua(i)){this.HALF_FLOAT=i.HALF_FLOAT;const v=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(h=i.RGBA16F)!==null&&h!==void 0?h:v?.RGBA16F_EXT,this.RGB16F=(g=i.RGB16F)!==null&&g!==void 0?g:v?.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const v=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,h){return new Zs(this,i,h)}createVertexBuffer(i,h,g){return new Po(this,i,h,g)}createRenderbuffer(i,h,g){const v=this.gl,T=v.createRenderbuffer();return this.bindRenderbuffer.set(T),v.renderbufferStorage(v.RENDERBUFFER,i,h,g),this.bindRenderbuffer.set(null),T}createFramebuffer(i,h,g,v){return new $c(this,i,h,g,v)}clear({color:i,depth:h,stencil:g}){const v=this.gl;let T=0;i&&(T|=v.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(T|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g!==void 0&&(T|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),v.clear(T)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){d.aE(i.blendFunction,ys.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return Ua(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var h;return Ua(this.gl)?this.gl.deleteVertexArray(i):(h=this.gl.getExtension("OES_vertex_array_object"))===null||h===void 0?void 0:h.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class Hi{constructor(i,h,g){this.func=i,this.mask=h,this.range=g}}Hi.ReadOnly=!1,Hi.ReadWrite=!0,Hi.disabled=new Hi(519,Hi.ReadOnly,[0,1]);const ho=7680;class gn{constructor(i,h,g,v,T,R){this.test=i,this.ref=h,this.mask=g,this.fail=v,this.depthFail=T,this.pass=R}}gn.disabled=new gn({func:519,mask:0},0,0,ho,ho,ho);class En{constructor(i,h,g){this.enable=i,this.mode=h,this.frontFace=g}}let sl;function Rr(E,i,h,g,v){const T=E.context,R=T.gl,O=E.useProgram("collisionBox"),U=[];let H=0,Y=0;for(let Ie=0;Ie<g.length;Ie++){const ze=g[Ie],Se=i.getTile(ze).getBucket(h);if(!Se)continue;const Fe=v?Se.textCollisionBox:Se.iconCollisionBox,Ye=Se.collisionCircleArray;if(Ye.length>0){const rt=d.H();d.aQ(rt,Se.placementInvProjMatrix,E.transform.glCoordMatrix),d.aQ(rt,rt,Se.placementViewportMatrix),U.push({circleArray:Ye,circleOffset:Y,transform:ze.posMatrix,invTransform:rt,coord:ze}),H+=Ye.length/4,Y=H}Fe&&O.draw(T,R.LINES,Hi.disabled,gn.disabled,E.colorModeForRenderPass(),En.disabled,{u_matrix:ze.posMatrix,u_pixel_extrude_scale:[1/(X=E.transform).width,1/X.height]},E.style.map.terrain&&E.style.map.terrain.getTerrainData(ze),h.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,null,E.transform.zoom,null,null,Fe.collisionVertexBuffer)}var X;if(!v||!U.length)return;const le=E.useProgram("collisionCircle"),fe=new d.aR;fe.resize(4*H),fe._trim();let _e=0;for(const Ie of U)for(let ze=0;ze<Ie.circleArray.length/4;ze++){const Se=4*ze,Fe=Ie.circleArray[Se+0],Ye=Ie.circleArray[Se+1],rt=Ie.circleArray[Se+2],bt=Ie.circleArray[Se+3];fe.emplace(_e++,Fe,Ye,rt,bt,0),fe.emplace(_e++,Fe,Ye,rt,bt,1),fe.emplace(_e++,Fe,Ye,rt,bt,2),fe.emplace(_e++,Fe,Ye,rt,bt,3)}(!sl||sl.length<2*H)&&(sl=(function(Ie){const ze=2*Ie,Se=new d.aT;Se.resize(ze),Se._trim();for(let Fe=0;Fe<ze;Fe++){const Ye=6*Fe;Se.uint16[Ye+0]=4*Fe+0,Se.uint16[Ye+1]=4*Fe+1,Se.uint16[Ye+2]=4*Fe+2,Se.uint16[Ye+3]=4*Fe+2,Se.uint16[Ye+4]=4*Fe+3,Se.uint16[Ye+5]=4*Fe+0}return Se})(H));const Ee=T.createIndexBuffer(sl,!0),Pe=T.createVertexBuffer(fe,d.aS.members,!0);for(const Ie of U){const ze=qs(Ie.transform,Ie.invTransform,E.transform);le.draw(T,R.TRIANGLES,Hi.disabled,gn.disabled,E.colorModeForRenderPass(),En.disabled,ze,E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ie.coord),h.id,Pe,Ee,d.a0.simpleSegment(0,2*Ie.circleOffset,Ie.circleArray.length,Ie.circleArray.length/2),null,E.transform.zoom,null,null,null)}Pe.destroy(),Ee.destroy()}En.disabled=new En(!1,1029,2305),En.backCCW=new En(!0,1029,2305);const zl=d.an(new Float32Array(16));function ua(E,i,h,g,v,T){const{horizontalAlign:R,verticalAlign:O}=d.au(E);return new d.P((-(R-.5)*i/v+g[0])*T,(-(O-.5)*h/v+g[1])*T)}function Ea(E,i,h,g,v,T){const R=i.tileAnchorPoint.add(new d.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let O=g.mult(T);h||(O=O.rotate(-v));const U=R.add(O);return be(U.x,U.y,i.labelPlaneMatrix,i.getElevation).point}if(h){const O=Le(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(E),U=Math.atan(O.y/O.x)+(O.x<0?Math.PI:0);return E.add(g.rotate(U))}return E.add(g)}function Fa(E,i,h,g,v,T,R,O,U,H,Y,X,le,fe){const _e=E.text.placedSymbolArray,Ee=E.text.dynamicLayoutVertexArray,Pe=E.icon.dynamicLayoutVertexArray,Ie={};Ee.clear();for(let ze=0;ze<_e.length;ze++){const Se=_e.get(ze),Fe=Se.hidden||!Se.crossTileID||E.allowVerticalPlacement&&!Se.placedOrientation?null:g[Se.crossTileID];if(Fe){const Ye=new d.P(Se.anchorX,Se.anchorY),rt={getElevation:fe,width:v.width,height:v.height,labelPlaneMatrix:T,pitchWithMap:h,projection:Y,tileAnchorPoint:Ye,translation:X,unwrappedTileID:le},bt=h?be(Ye.x,Ye.y,R,fe):Le(Ye.x,Ye.y,rt),$t=ie(v.cameraToCenterDistance,bt.signedDistanceFromCamera);let Ht=d.ai(E.textSizeData,U,Se)*$t/d.ap;h&&(Ht*=E.tilePixelRatio/O);const{width:Qt,height:Zt,anchor:Ut,textOffset:ni,textBoxScale:ki}=Fe,Gt=ua(Ut,Qt,Zt,ni,ki,Ht),Xt=Y.getPitchedTextCorrection(v,Ye.add(new d.P(X[0],X[1])),le),Ei=Ea(bt.point,rt,i,Gt,v.angle,Xt),Gn=E.allowVerticalPlacement&&Se.placedOrientation===d.ah.vertical?Math.PI/2:0;for(let Zi=0;Zi<Se.numGlyphs;Zi++)d.aj(Ee,Ei,Gn);H&&Se.associatedIconIndex>=0&&(Ie[Se.associatedIconIndex]={shiftedAnchor:Ei,angle:Gn})}else qt(Se.numGlyphs,Ee)}if(H){Pe.clear();const ze=E.icon.placedSymbolArray;for(let Se=0;Se<ze.length;Se++){const Fe=ze.get(Se);if(Fe.hidden)qt(Fe.numGlyphs,Pe);else{const Ye=Ie[Se];if(Ye)for(let rt=0;rt<Fe.numGlyphs;rt++)d.aj(Pe,Ye.shiftedAnchor,Ye.angle);else qt(Fe.numGlyphs,Pe)}}E.icon.dynamicLayoutVertexBuffer.updateData(Pe)}E.text.dynamicLayoutVertexBuffer.updateData(Ee)}function ar(E,i,h){return h.iconsInText&&i?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function rl(E,i,h,g,v,T,R,O,U,H,Y,X){const le=E.context,fe=le.gl,_e=E.transform,Ee=rr(),Pe=O==="map",Ie=U==="map",ze=O!=="viewport"&&h.layout.get("symbol-placement")!=="point",Se=Pe&&!Ie&&!ze,Fe=!Ie&&ze,Ye=!h.layout.get("symbol-sort-key").isConstant();let rt=!1;const bt=E.depthModeForSublayer(0,Hi.ReadOnly),$t=h._unevaluatedLayout.hasValue("text-variable-anchor")||h._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ht=[],Qt=Ee.getCircleRadiusCorrection(_e);for(const Zt of g){const Ut=i.getTile(Zt),ni=Ut.getBucket(h);if(!ni)continue;const ki=v?ni.text:ni.icon;if(!ki||!ki.segments.get().length||!ki.hasVisibleVertices)continue;const Gt=ki.programConfigurations.get(h.id),Xt=v||ni.sdfIcons,Ei=v?ni.textSizeData:ni.iconSizeData,Gn=Ie||_e.pitch!==0,Zi=E.useProgram(ar(Xt,v,ni),Gt),dn=d.ag(Ei,_e.zoom),Fn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Zt);let ir,Wa,ts,Dr,ls=[0,0],cs=null;if(v)Wa=Ut.glyphAtlasTexture,ts=fe.LINEAR,ir=Ut.glyphAtlasTexture.size,ni.iconsInText&&(ls=Ut.imageAtlasTexture.size,cs=Ut.imageAtlasTexture,Dr=Gn||E.options.rotating||E.options.zooming||Ei.kind==="composite"||Ei.kind==="camera"?fe.LINEAR:fe.NEAREST);else{const sn=h.layout.get("icon-size").constantOr(0)!==1||ni.iconsNeedLinear;Wa=Ut.imageAtlasTexture,ts=Xt||E.options.rotating||E.options.zooming||sn||Gn?fe.LINEAR:fe.NEAREST,ir=Ut.imageAtlasTexture.size}const Rs=pi(Ut,1,E.transform.zoom),Ya=Fe?Zt.posMatrix:zl,uc=$n(Ya,Ie,Pe,E.transform,Rs),_o=Ji(Ya,Ie,Pe,E.transform,Rs),or=Ji(Zt.posMatrix,Ie,Pe,E.transform,Rs),Nn=Ee.translatePosition(E.transform,Ut,T,R),hc=$t&&ni.hasTextData(),vo=h.layout.get("icon-text-fit")!=="none"&&hc&&ni.hasIconData();if(ze){const sn=E.style.map.terrain?(Hc,hs)=>E.style.map.terrain.getElevation(Zt,Hc,hs):null,Xa=h.layout.get("text-rotation-alignment")==="map";he(ni,Zt.posMatrix,E,v,uc,or,Ie,H,Xa,Ee,Zt.toUnwrapped(),_e.width,_e.height,Nn,sn)}const Pi=Zt.posMatrix,yn=v&&$t||vo,us=ze||yn?zl:uc,ma=_o,zs=Xt&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ds;Ds=Xt?ni.iconsInText?Ko(Ei.kind,dn,Se,Ie,ze,yn,E,Pi,us,ma,Nn,ir,ls,Qt):la(Ei.kind,dn,Se,Ie,ze,yn,E,Pi,us,ma,Nn,v,ir,!0,Qt):Ts(Ei.kind,dn,Se,Ie,ze,yn,E,Pi,us,ma,Nn,v,ir,Qt);const Or={program:Zi,buffers:ki,uniformValues:Ds,atlasTexture:Wa,atlasTextureIcon:cs,atlasInterpolation:ts,atlasInterpolationIcon:Dr,isSDF:Xt,hasHalo:zs};if(Ye&&ni.canOverlap){rt=!0;const sn=ki.segments.get();for(const Xa of sn)Ht.push({segments:new d.a0([Xa]),sortKey:Xa.sortKey,state:Or,terrainData:Fn})}else Ht.push({segments:ki.segments,sortKey:0,state:Or,terrainData:Fn})}rt&&Ht.sort(((Zt,Ut)=>Zt.sortKey-Ut.sortKey));for(const Zt of Ht){const Ut=Zt.state;if(le.activeTexture.set(fe.TEXTURE0),Ut.atlasTexture.bind(Ut.atlasInterpolation,fe.CLAMP_TO_EDGE),Ut.atlasTextureIcon&&(le.activeTexture.set(fe.TEXTURE1),Ut.atlasTextureIcon&&Ut.atlasTextureIcon.bind(Ut.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),Ut.isSDF){const ni=Ut.uniformValues;Ut.hasHalo&&(ni.u_is_halo=1,Uc(Ut.buffers,Zt.segments,h,E,Ut.program,bt,Y,X,ni,Zt.terrainData)),ni.u_is_halo=0}Uc(Ut.buffers,Zt.segments,h,E,Ut.program,bt,Y,X,Ut.uniformValues,Zt.terrainData)}}function Uc(E,i,h,g,v,T,R,O,U,H){const Y=g.context;v.draw(Y,Y.gl.TRIANGLES,T,R,O,En.disabled,U,H,h.id,E.layoutVertexBuffer,E.indexBuffer,i,h.paint,g.transform.zoom,E.programConfigurations.get(h.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function ha(E,i,h,g){const v=E.context,T=v.gl,R=gn.disabled,O=new ys([T.ONE,T.ONE],d.aM.transparent,[!0,!0,!0,!0]),U=i.getBucket(h);if(!U)return;const H=g.key;let Y=h.heatmapFbos.get(H);Y||(Y=Dl(v,i.tileSize,i.tileSize),h.heatmapFbos.set(H,Y)),v.bindFramebuffer.set(Y.framebuffer),v.viewport.set([0,0,i.tileSize,i.tileSize]),v.clear({color:d.aM.transparent});const X=U.programConfigurations.get(h.id),le=E.useProgram("heatmap",X),fe=E.style.map.terrain.getTerrainData(g);le.draw(v,T.TRIANGLES,Hi.disabled,R,O,En.disabled,Bs(g.posMatrix,i,E.transform.zoom,h.paint.get("heatmap-intensity")),fe,h.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,h.paint,E.transform.zoom,X)}function da(E,i,h){const g=E.context,v=g.gl;g.setColorMode(E.colorModeForRenderPass());const T=jo(g,i),R=h.key,O=i.heatmapFbos.get(R);O&&(g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,O.colorAttachment.get()),g.activeTexture.set(v.TEXTURE1),T.bind(v.LINEAR,v.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(g,v.TRIANGLES,Hi.disabled,gn.disabled,E.colorModeForRenderPass(),En.disabled,Ii(E,i,0,1),null,i.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments,i.paint,E.transform.zoom),O.destroy(),i.heatmapFbos.delete(R))}function Dl(E,i,h){var g,v;const T=E.gl,R=T.createTexture();T.bindTexture(T.TEXTURE_2D,R),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR);const O=(g=E.HALF_FLOAT)!==null&&g!==void 0?g:T.UNSIGNED_BYTE,U=(v=E.RGBA16F)!==null&&v!==void 0?v:T.RGBA;T.texImage2D(T.TEXTURE_2D,0,U,i,h,0,T.RGBA,O,null);const H=E.createFramebuffer(i,h,!1,!1);return H.colorAttachment.set(R),H}function jo(E,i){return i.colorRampTexture||(i.colorRampTexture=new at(E,i.colorRamp,E.gl.RGBA)),i.colorRampTexture}function al(E,i,h,g,v){if(!h||!g||!g.imageAtlas)return;const T=g.imageAtlas.patternPositions;let R=T[h.to.toString()],O=T[h.from.toString()];if(!R&&O&&(R=O),!O&&R&&(O=R),!R||!O){const U=v.getPaintProperty(i);R=T[U],O=T[U]}R&&O&&E.setConstantPatternPositions(R,O)}function Gr(E,i,h,g,v,T,R){const O=E.context.gl,U="fill-pattern",H=h.paint.get(U),Y=H&&H.constantOr(1),X=h.getCrossfadeParameters();let le,fe,_e,Ee,Pe;R?(fe=Y&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",le=O.LINES):(fe=Y?"fillPattern":"fill",le=O.TRIANGLES);const Ie=H.constantOr(null);for(const ze of g){const Se=i.getTile(ze);if(Y&&!Se.patternsLoaded())continue;const Fe=Se.getBucket(h);if(!Fe)continue;const Ye=Fe.programConfigurations.get(h.id),rt=E.useProgram(fe,Ye),bt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ze);Y&&(E.context.activeTexture.set(O.TEXTURE0),Se.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ye.updatePaintBuffers(X)),al(Ye,U,Ie,Se,h);const $t=bt?ze:null,Ht=E.translatePosMatrix($t?$t.posMatrix:ze.posMatrix,Se,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(R){Ee=Fe.indexBuffer2,Pe=Fe.segments2;const Qt=[O.drawingBufferWidth,O.drawingBufferHeight];_e=fe==="fillOutlinePattern"&&Y?jc(Ht,E,X,Se,Qt):Ic(Ht,Qt)}else Ee=Fe.indexBuffer,Pe=Fe.segments,_e=Y?Il(Ht,E,X,Se):lo(Ht);rt.draw(E.context,le,v,E.stencilModeForClipping(ze),T,En.disabled,_e,bt,h.id,Fe.layoutVertexBuffer,Ee,Pe,h.paint,E.transform.zoom,Ye)}}function Fc(E,i,h,g,v,T,R){const O=E.context,U=O.gl,H="fill-extrusion-pattern",Y=h.paint.get(H),X=Y.constantOr(1),le=h.getCrossfadeParameters(),fe=h.paint.get("fill-extrusion-opacity"),_e=Y.constantOr(null);for(const Ee of g){const Pe=i.getTile(Ee),Ie=Pe.getBucket(h);if(!Ie)continue;const ze=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ee),Se=Ie.programConfigurations.get(h.id),Fe=E.useProgram(X?"fillExtrusionPattern":"fillExtrusion",Se);X&&(E.context.activeTexture.set(U.TEXTURE0),Pe.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Se.updatePaintBuffers(le)),al(Se,H,_e,Pe,h);const Ye=E.translatePosMatrix(Ee.posMatrix,Pe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),rt=h.paint.get("fill-extrusion-vertical-gradient"),bt=X?oo(Ye,E,rt,fe,Ee,le,Pe):Yo(Ye,E,rt,fe);Fe.draw(O,O.gl.TRIANGLES,v,T,R,En.backCCW,bt,ze,h.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,h.paint,E.transform.zoom,Se,E.style.map.terrain&&Ie.centroidVertexBuffer)}}function ka(E,i,h,g,v,T,R){const O=E.context,U=O.gl,H=h.fbo;if(!H)return;const Y=E.useProgram("hillshade"),X=E.style.map.terrain&&E.style.map.terrain.getTerrainData(i);O.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,H.colorAttachment.get()),Y.draw(O,U.TRIANGLES,v,T,R,En.disabled,((le,fe,_e,Ee)=>{const Pe=_e.paint.get("hillshade-shadow-color"),Ie=_e.paint.get("hillshade-highlight-color"),ze=_e.paint.get("hillshade-accent-color");let Se=_e.paint.get("hillshade-illumination-direction")*(Math.PI/180);_e.paint.get("hillshade-illumination-anchor")==="viewport"&&(Se-=le.transform.angle);const Fe=!le.options.moving;return{u_matrix:Ee?Ee.posMatrix:le.transform.calculatePosMatrix(fe.tileID.toUnwrapped(),Fe),u_image:0,u_latrange:jr(0,fe.tileID),u_light:[_e.paint.get("hillshade-exaggeration"),Se],u_shadow:Pe,u_highlight:Ie,u_accent:ze}})(E,h,g,X?i:null),X,g.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}function Ol(E,i,h,g,v,T){const R=E.context,O=R.gl,U=i.dem;if(U&&U.data){const H=U.dim,Y=U.stride,X=U.getPixels();if(R.activeTexture.set(O.TEXTURE1),R.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||E.getTileTexture(Y),i.demTexture){const fe=i.demTexture;fe.update(X,{premultiply:!1}),fe.bind(O.NEAREST,O.CLAMP_TO_EDGE)}else i.demTexture=new at(R,X,O.RGBA,{premultiply:!1}),i.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);R.activeTexture.set(O.TEXTURE0);let le=i.fbo;if(!le){const fe=new at(R,{width:H,height:H,data:null},O.RGBA);fe.bind(O.LINEAR,O.CLAMP_TO_EDGE),le=i.fbo=R.createFramebuffer(H,H,!0,!1),le.colorAttachment.set(fe.texture)}R.bindFramebuffer.set(le.framebuffer),R.viewport.set([0,0,H,H]),E.useProgram("hillshadePrepare").draw(R,O.TRIANGLES,g,v,T,En.disabled,((fe,_e)=>{const Ee=_e.stride,Pe=d.H();return d.aP(Pe,0,d.X,-d.X,0,0,1),d.J(Pe,Pe,[0,-d.X,0]),{u_matrix:Pe,u_image:1,u_dimension:[Ee,Ee],u_zoom:fe.overscaledZ,u_unpack:_e.getUnpackVector()}})(i.tileID,U),null,h.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function Va(E,i,h,g,v,T){const R=g.paint.get("raster-fade-duration");if(!T&&R>0){const O=N.now(),U=(O-E.timeAdded)/R,H=i?(O-i.timeAdded)/R:-1,Y=h.getSource(),X=v.coveringZoomLevel({tileSize:Y.tileSize,roundZoom:Y.roundZoom}),le=!i||Math.abs(i.tileID.overscaledZ-X)>Math.abs(E.tileID.overscaledZ-X),fe=le&&E.refreshedUponExpiration?1:d.ac(le?U:1-H,0,1);return E.refreshedUponExpiration&&U>=1&&(E.refreshedUponExpiration=!1),i?{opacity:1,mix:1-fe}:{opacity:fe,mix:0}}return{opacity:1,mix:0}}const Gs=new d.aM(1,0,0,1),cn=new d.aM(0,1,0,1),ol=new d.aM(0,0,1,1),ic=new d.aM(1,0,1,1),nc=new d.aM(0,1,1,1);function qa(E,i,h,g){ll(E,0,i+h/2,E.transform.width,h,g)}function fo(E,i,h,g){ll(E,i-h/2,0,h,E.transform.height,g)}function ll(E,i,h,g,v,T){const R=E.context,O=R.gl;O.enable(O.SCISSOR_TEST),O.scissor(i*E.pixelRatio,h*E.pixelRatio,g*E.pixelRatio,v*E.pixelRatio),R.clear({color:T}),O.disable(O.SCISSOR_TEST)}function po(E,i,h){const g=E.context,v=g.gl,T=h.posMatrix,R=E.useProgram("debug"),O=Hi.disabled,U=gn.disabled,H=E.colorModeForRenderPass(),Y="$debug",X=E.style.map.terrain&&E.style.map.terrain.getTerrainData(h);g.activeTexture.set(v.TEXTURE0);const le=i.getTileByID(h.key).latestRawTileData,fe=Math.floor((le&&le.byteLength||0)/1024),_e=i.getTile(h).tileSize,Ee=512/Math.min(_e,512)*(h.overscaledZ/E.transform.zoom)*.5;let Pe=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Pe+=` => ${h.overscaledZ}`),(function(Ie,ze){Ie.initDebugOverlayCanvas();const Se=Ie.debugOverlayCanvas,Fe=Ie.context.gl,Ye=Ie.debugOverlayCanvas.getContext("2d");Ye.clearRect(0,0,Se.width,Se.height),Ye.shadowColor="white",Ye.shadowBlur=2,Ye.lineWidth=1.5,Ye.strokeStyle="white",Ye.textBaseline="top",Ye.font="bold 36px Open Sans, sans-serif",Ye.fillText(ze,5,5),Ye.strokeText(ze,5,5),Ie.debugOverlayTexture.update(Se),Ie.debugOverlayTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)})(E,`${Pe} ${fe}kB`),R.draw(g,v.TRIANGLES,O,U,ys.alphaBlended,En.disabled,Ao(T,d.aM.transparent,Ee),null,Y,E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments),R.draw(g,v.LINE_STRIP,O,U,H,En.disabled,Ao(T,d.aM.red),X,Y,E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments)}function sc(E,i,h){const g=E.context,v=g.gl,T=E.colorModeForRenderPass(),R=new Hi(v.LEQUAL,Hi.ReadWrite,E.depthRangeFor3D),O=E.useProgram("terrain"),U=i.getTerrainMesh();g.bindFramebuffer.set(null),g.viewport.set([0,0,E.width,E.height]);for(const H of h){const Y=E.renderToTexture.getTexture(H),X=i.getTerrainData(H.tileID);g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,Y.texture);const le=E.transform.calculatePosMatrix(H.tileID.toUnwrapped()),fe=i.getMeshFrameDelta(E.transform.zoom),_e=E.transform.calculateFogMatrix(H.tileID.toUnwrapped()),Ee=Xn(le,fe,_e,E.style.sky,E.transform.pitch);O.draw(g,v.TRIANGLES,R,gn.disabled,T,En.backCCW,Ee,X,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}class Lo{constructor(i,h,g){this.vertexBuffer=i,this.indexBuffer=h,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class mo{constructor(i,h){this.context=new ah(i),this.transform=h,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Jt.maxUnderzooming+Jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new $i}resize(i,h,g){if(this.width=Math.floor(i*g),this.height=Math.floor(h*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const i=this.context,h=new d.aX;h.emplaceBack(0,0),h.emplaceBack(d.X,0),h.emplaceBack(0,d.X),h.emplaceBack(d.X,d.X),this.tileExtentBuffer=i.createVertexBuffer(h,Un.members),this.tileExtentSegments=d.a0.simpleSegment(0,0,4,2);const g=new d.aX;g.emplaceBack(0,0),g.emplaceBack(d.X,0),g.emplaceBack(0,d.X),g.emplaceBack(d.X,d.X),this.debugBuffer=i.createVertexBuffer(g,Un.members),this.debugSegments=d.a0.simpleSegment(0,0,4,5);const v=new d.$;v.emplaceBack(0,0,0,0),v.emplaceBack(d.X,0,d.X,0),v.emplaceBack(0,d.X,0,d.X),v.emplaceBack(d.X,d.X,d.X,d.X),this.rasterBoundsBuffer=i.createVertexBuffer(v,Hn.members),this.rasterBoundsSegments=d.a0.simpleSegment(0,0,4,2);const T=new d.aX;T.emplaceBack(0,0),T.emplaceBack(1,0),T.emplaceBack(0,1),T.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(T,Un.members),this.viewportSegments=d.a0.simpleSegment(0,0,4,2);const R=new d.aZ;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(R);const O=new d.aY;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(O);const U=this.context.gl;this.stencilClearMode=new gn({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO)}clearStencil(){const i=this.context,h=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=d.H();d.aP(g,0,this.width,this.height,0,0,1),d.K(g,g,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,h.TRIANGLES,Hi.disabled,this.stencilClearMode,ys.disabled,En.disabled,Hs(g),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,h){if(this.currentStencilSource===i.source||!i.isTileClipped()||!h||!h.length)return;this.currentStencilSource=i.source;const g=this.context,v=g.gl;this.nextStencilID+h.length>256&&this.clearStencil(),g.setColorMode(ys.disabled),g.setDepthMode(Hi.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const R of h){const O=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R);T.draw(g,v.TRIANGLES,Hi.disabled,new gn({func:v.ALWAYS,mask:0},O,255,v.KEEP,v.KEEP,v.REPLACE),ys.disabled,En.disabled,Hs(R.posMatrix),U,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,h=this.context.gl;return new gn({func:h.NOTEQUAL,mask:255},i,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(i){const h=this.context.gl;return new gn({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(i){const h=this.context.gl,g=i.sort(((R,O)=>O.overscaledZ-R.overscaledZ)),v=g[g.length-1].overscaledZ,T=g[0].overscaledZ-v+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const R={};for(let O=0;O<T;O++)R[O+v]=new gn({func:h.GEQUAL,mask:255},O+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=T,[R,g]}return[{[v]:gn.disabled},g]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new ys([i.CONSTANT_COLOR,i.ONE],new d.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ys.unblended:ys.alphaBlended}depthModeForSublayer(i,h,g){if(!this.opaquePassEnabledForLayer())return Hi.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Hi(g||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,h){this.style=i,this.options=h,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(N.now()),this.imageManager.beginFrame();const g=this.style._order,v=this.style.sourceCaches,T={},R={},O={};for(const U in v){const H=v[U];H.used&&H.prepare(this.context),T[U]=H.getVisibleCoordinates(),R[U]=T[U].slice().reverse(),O[U]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<g.length;U++)if(this.style._layers[g[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of g){const H=this.style._layers[U];if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const Y=R[H.source];(H.type==="custom"||Y.length)&&this.renderLayer(this,v[H.source],H,Y)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?d.aM.black:d.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(U,H){const Y=U.context,X=Y.gl,le=((Ie,ze,Se)=>({u_sky_color:Ie.properties.get("sky-color"),u_horizon_color:Ie.properties.get("horizon-color"),u_horizon:(ze.height/2+ze.getHorizon())*Se,u_sky_horizon_blend:Ie.properties.get("sky-horizon-blend")*ze.height/2*Se}))(H,U.style.map.transform,U.pixelRatio),fe=new Hi(X.LEQUAL,Hi.ReadWrite,[0,1]),_e=gn.disabled,Ee=U.colorModeForRenderPass(),Pe=U.useProgram("sky");if(!H.mesh){const Ie=new d.aX;Ie.emplaceBack(-1,-1),Ie.emplaceBack(1,-1),Ie.emplaceBack(1,1),Ie.emplaceBack(-1,1);const ze=new d.aY;ze.emplaceBack(0,1,2),ze.emplaceBack(0,2,3),H.mesh=new Lo(Y.createVertexBuffer(Ie,Un.members),Y.createIndexBuffer(ze),d.a0.simpleSegment(0,0,Ie.length,ze.length))}Pe.draw(Y,X.TRIANGLES,fe,_e,Ee,En.disabled,le,void 0,"sky",H.mesh.vertexBuffer,H.mesh.indexBuffer,H.mesh.segments)})(this,this.style.sky),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[g[this.currentLayer]],H=v[U.source],Y=T[U.source];this._renderTileClippingMasks(U,Y),this.renderLayer(this,H,U,Y)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const U=this.style._layers[g[this.currentLayer]],H=v[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U))continue;const Y=(U.type==="symbol"?O:R)[U.source];this._renderTileClippingMasks(U,T[U.source]),this.renderLayer(this,H,U,Y)}if(this.options.showTileBoundaries){const U=(function(H,Y){let X=null;const le=Object.values(H._layers).flatMap((Pe=>Pe.source&&!Pe.isHidden(Y)?[H.sourceCaches[Pe.source]]:[])),fe=le.filter((Pe=>Pe.getSource().type==="vector")),_e=le.filter((Pe=>Pe.getSource().type!=="vector")),Ee=Pe=>{(!X||X.getSource().maxzoom<Pe.getSource().maxzoom)&&(X=Pe)};return fe.forEach((Pe=>Ee(Pe))),X||_e.forEach((Pe=>Ee(Pe))),X})(this.style,this.transform.zoom);U&&(function(H,Y,X){for(let le=0;le<X.length;le++)po(H,Y,X[le])})(this,U,U.getVisibleCoordinates())}this.options.showPadding&&(function(U){const H=U.transform.padding;qa(U,U.transform.height-(H.top||0),3,Gs),qa(U,H.bottom||0,3,cn),fo(U,H.left||0,3,ol),fo(U,U.transform.width-(H.right||0),3,ic);const Y=U.transform.centerPoint;(function(X,le,fe,_e){ll(X,le-1,fe-10,2,20,_e),ll(X,le-10,fe-1,20,2,_e)})(U,Y.x,U.transform.height-Y.y,nc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const h=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=i?!d.a_(h,g):!d.a$(h,g)),v||(v=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),v&&(d.b0(h,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(T,R){const O=T.context,U=O.gl,H=ys.unblended,Y=new Hi(U.LEQUAL,Hi.ReadWrite,[0,1]),X=R.getTerrainMesh(),le=R.sourceCache.getRenderableTiles(),fe=T.useProgram("terrainDepth");O.bindFramebuffer.set(R.getFramebuffer("depth").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:d.aM.transparent,depth:1});for(const _e of le){const Ee=R.getTerrainData(_e.tileID),Pe={u_matrix:T.transform.calculatePosMatrix(_e.tileID.toUnwrapped()),u_ele_delta:R.getMeshFrameDelta(T.transform.zoom)};fe.draw(O,U.TRIANGLES,Y,gn.disabled,H,En.backCCW,Pe,Ee,"terrain",X.vertexBuffer,X.indexBuffer,X.segments)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain),(function(T,R){const O=T.context,U=O.gl,H=ys.unblended,Y=new Hi(U.LEQUAL,Hi.ReadWrite,[0,1]),X=R.getTerrainMesh(),le=R.getCoordsTexture(),fe=R.sourceCache.getRenderableTiles(),_e=T.useProgram("terrainCoords");O.bindFramebuffer.set(R.getFramebuffer("coords").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:d.aM.transparent,depth:1}),R.coordsIndex=[];for(const Ee of fe){const Pe=R.getTerrainData(Ee.tileID);O.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,le.texture);const Ie={u_matrix:T.transform.calculatePosMatrix(Ee.tileID.toUnwrapped()),u_terrain_coords_id:(255-R.coordsIndex.length)/255,u_texture:0,u_ele_delta:R.getMeshFrameDelta(T.transform.zoom)};_e.draw(O,U.TRIANGLES,Y,gn.disabled,H,En.backCCW,Ie,Pe,"terrain",X.vertexBuffer,X.indexBuffer,X.segments),R.coordsIndex.push(Ee.tileID.key)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain))}renderLayer(i,h,g,v){if(!g.isHidden(this.transform.zoom)&&(g.type==="background"||g.type==="custom"||(v||[]).length))switch(this.id=g.id,g.type){case"symbol":(function(T,R,O,U,H){if(T.renderPass!=="translucent")return;const Y=gn.disabled,X=T.colorModeForRenderPass();(O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(le,fe,_e,Ee,Pe,Ie,ze,Se,Fe){const Ye=fe.transform,rt=rr(),bt=Pe==="map",$t=Ie==="map";for(const Ht of le){const Qt=Ee.getTile(Ht),Zt=Qt.getBucket(_e);if(!Zt||!Zt.text||!Zt.text.segments.get().length)continue;const Ut=d.ag(Zt.textSizeData,Ye.zoom),ni=pi(Qt,1,fe.transform.zoom),ki=$n(Ht.posMatrix,$t,bt,fe.transform,ni),Gt=_e.layout.get("icon-text-fit")!=="none"&&Zt.hasIconData();if(Ut){const Xt=Math.pow(2,Ye.zoom-Qt.tileID.overscaledZ),Ei=fe.style.map.terrain?(Zi,dn)=>fe.style.map.terrain.getElevation(Ht,Zi,dn):null,Gn=rt.translatePosition(Ye,Qt,ze,Se);Fa(Zt,bt,$t,Fe,Ye,ki,Ht.posMatrix,Xt,Ut,Gt,rt,Gn,Ht.toUnwrapped(),Ei)}}})(U,T,O,R,O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),H),O.paint.get("icon-opacity").constantOr(1)!==0&&rl(T,R,O,U,!1,O.paint.get("icon-translate"),O.paint.get("icon-translate-anchor"),O.layout.get("icon-rotation-alignment"),O.layout.get("icon-pitch-alignment"),O.layout.get("icon-keep-upright"),Y,X),O.paint.get("text-opacity").constantOr(1)!==0&&rl(T,R,O,U,!0,O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.layout.get("text-keep-upright"),Y,X),R.map.showCollisionBoxes&&(Rr(T,R,O,U,!0),Rr(T,R,O,U,!1))})(i,h,g,v,this.style.placement.variableOffsets);break;case"circle":(function(T,R,O,U){if(T.renderPass!=="translucent")return;const H=O.paint.get("circle-opacity"),Y=O.paint.get("circle-stroke-width"),X=O.paint.get("circle-stroke-opacity"),le=!O.layout.get("circle-sort-key").isConstant();if(H.constantOr(1)===0&&(Y.constantOr(1)===0||X.constantOr(1)===0))return;const fe=T.context,_e=fe.gl,Ee=T.depthModeForSublayer(0,Hi.ReadOnly),Pe=gn.disabled,Ie=T.colorModeForRenderPass(),ze=[];for(let Se=0;Se<U.length;Se++){const Fe=U[Se],Ye=R.getTile(Fe),rt=Ye.getBucket(O);if(!rt)continue;const bt=rt.programConfigurations.get(O.id),$t=T.useProgram("circle",bt),Ht=rt.layoutVertexBuffer,Qt=rt.indexBuffer,Zt=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Fe),Ut={programConfiguration:bt,program:$t,layoutVertexBuffer:Ht,indexBuffer:Qt,uniformValues:jl(T,Fe,Ye,O),terrainData:Zt};if(le){const ni=rt.segments.get();for(const ki of ni)ze.push({segments:new d.a0([ki]),sortKey:ki.sortKey,state:Ut})}else ze.push({segments:rt.segments,sortKey:0,state:Ut})}le&&ze.sort(((Se,Fe)=>Se.sortKey-Fe.sortKey));for(const Se of ze){const{programConfiguration:Fe,program:Ye,layoutVertexBuffer:rt,indexBuffer:bt,uniformValues:$t,terrainData:Ht}=Se.state;Ye.draw(fe,_e.TRIANGLES,Ee,Pe,Ie,En.disabled,$t,Ht,O.id,rt,bt,Se.segments,O.paint,T.transform.zoom,Fe)}})(i,h,g,v);break;case"heatmap":(function(T,R,O,U){if(O.paint.get("heatmap-opacity")===0)return;const H=T.context;if(T.style.map.terrain){for(const Y of U){const X=R.getTile(Y);R.hasRenderableParent(Y)||(T.renderPass==="offscreen"?ha(T,X,O,Y):T.renderPass==="translucent"&&da(T,O,Y))}H.viewport.set([0,0,T.width,T.height])}else T.renderPass==="offscreen"?(function(Y,X,le,fe){const _e=Y.context,Ee=_e.gl,Pe=gn.disabled,Ie=new ys([Ee.ONE,Ee.ONE],d.aM.transparent,[!0,!0,!0,!0]);(function(ze,Se,Fe){const Ye=ze.gl;ze.activeTexture.set(Ye.TEXTURE1),ze.viewport.set([0,0,Se.width/4,Se.height/4]);let rt=Fe.heatmapFbos.get(d.aU);rt?(Ye.bindTexture(Ye.TEXTURE_2D,rt.colorAttachment.get()),ze.bindFramebuffer.set(rt.framebuffer)):(rt=Dl(ze,Se.width/4,Se.height/4),Fe.heatmapFbos.set(d.aU,rt))})(_e,Y,le),_e.clear({color:d.aM.transparent});for(let ze=0;ze<fe.length;ze++){const Se=fe[ze];if(X.hasRenderableParent(Se))continue;const Fe=X.getTile(Se),Ye=Fe.getBucket(le);if(!Ye)continue;const rt=Ye.programConfigurations.get(le.id),bt=Y.useProgram("heatmap",rt),{zoom:$t}=Y.transform;bt.draw(_e,Ee.TRIANGLES,Hi.disabled,Pe,Ie,En.disabled,Bs(Se.posMatrix,Fe,$t,le.paint.get("heatmap-intensity")),null,le.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,le.paint,Y.transform.zoom,rt)}_e.viewport.set([0,0,Y.width,Y.height])})(T,R,O,U):T.renderPass==="translucent"&&(function(Y,X){const le=Y.context,fe=le.gl;le.setColorMode(Y.colorModeForRenderPass());const _e=X.heatmapFbos.get(d.aU);_e&&(le.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,_e.colorAttachment.get()),le.activeTexture.set(fe.TEXTURE1),jo(le,X).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),Y.useProgram("heatmapTexture").draw(le,fe.TRIANGLES,Hi.disabled,gn.disabled,Y.colorModeForRenderPass(),En.disabled,Ii(Y,X,0,1),null,X.id,Y.viewportBuffer,Y.quadTriangleIndexBuffer,Y.viewportSegments,X.paint,Y.transform.zoom))})(T,O)})(i,h,g,v);break;case"line":(function(T,R,O,U){if(T.renderPass!=="translucent")return;const H=O.paint.get("line-opacity"),Y=O.paint.get("line-width");if(H.constantOr(1)===0||Y.constantOr(1)===0)return;const X=T.depthModeForSublayer(0,Hi.ReadOnly),le=T.colorModeForRenderPass(),fe=O.paint.get("line-dasharray"),_e=O.paint.get("line-pattern"),Ee=_e.constantOr(1),Pe=O.paint.get("line-gradient"),Ie=O.getCrossfadeParameters(),ze=Ee?"linePattern":fe?"lineSDF":Pe?"lineGradient":"line",Se=T.context,Fe=Se.gl;let Ye=!0;for(const rt of U){const bt=R.getTile(rt);if(Ee&&!bt.patternsLoaded())continue;const $t=bt.getBucket(O);if(!$t)continue;const Ht=$t.programConfigurations.get(O.id),Qt=T.context.program.get(),Zt=T.useProgram(ze,Ht),Ut=Ye||Zt.program!==Qt,ni=T.style.map.terrain&&T.style.map.terrain.getTerrainData(rt),ki=_e.constantOr(null);if(ki&&bt.imageAtlas){const Ei=bt.imageAtlas,Gn=Ei.patternPositions[ki.to.toString()],Zi=Ei.patternPositions[ki.from.toString()];Gn&&Zi&&Ht.setConstantPatternPositions(Gn,Zi)}const Gt=ni?rt:null,Xt=Ee?aa(T,bt,O,Ie,Gt):fe?Sa(T,bt,O,fe,Ie,Gt):Pe?Lc(T,bt,O,$t.lineClipsArray.length,Gt):Rn(T,bt,O,Gt);if(Ee)Se.activeTexture.set(Fe.TEXTURE0),bt.imageAtlasTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),Ht.updatePaintBuffers(Ie);else if(fe&&(Ut||T.lineAtlas.dirty))Se.activeTexture.set(Fe.TEXTURE0),T.lineAtlas.bind(Se);else if(Pe){const Ei=$t.gradients[O.id];let Gn=Ei.texture;if(O.gradientVersion!==Ei.version){let Zi=256;if(O.stepInterpolant){const dn=R.getSource().maxzoom,Fn=rt.canonical.z===dn?Math.ceil(1<<T.transform.maxZoom-rt.canonical.z):1;Zi=d.ac(d.aV($t.maxLineLength/d.X*1024*Fn),256,Se.maxTextureSize)}Ei.gradient=d.aW({expression:O.gradientExpression(),evaluationKey:"lineProgress",resolution:Zi,image:Ei.gradient||void 0,clips:$t.lineClipsArray}),Ei.texture?Ei.texture.update(Ei.gradient):Ei.texture=new at(Se,Ei.gradient,Fe.RGBA),Ei.version=O.gradientVersion,Gn=Ei.texture}Se.activeTexture.set(Fe.TEXTURE0),Gn.bind(O.stepInterpolant?Fe.NEAREST:Fe.LINEAR,Fe.CLAMP_TO_EDGE)}Zt.draw(Se,Fe.TRIANGLES,X,T.stencilModeForClipping(rt),le,En.disabled,Xt,ni,O.id,$t.layoutVertexBuffer,$t.indexBuffer,$t.segments,O.paint,T.transform.zoom,Ht,$t.layoutVertexBuffer2),Ye=!1}})(i,h,g,v);break;case"fill":(function(T,R,O,U){const H=O.paint.get("fill-color"),Y=O.paint.get("fill-opacity");if(Y.constantOr(1)===0)return;const X=T.colorModeForRenderPass(),le=O.paint.get("fill-pattern"),fe=T.opaquePassEnabledForLayer()&&!le.constantOr(1)&&H.constantOr(d.aM.transparent).a===1&&Y.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===fe){const _e=T.depthModeForSublayer(1,T.renderPass==="opaque"?Hi.ReadWrite:Hi.ReadOnly);Gr(T,R,O,U,_e,X,!1)}if(T.renderPass==="translucent"&&O.paint.get("fill-antialias")){const _e=T.depthModeForSublayer(O.getPaintProperty("fill-outline-color")?2:0,Hi.ReadOnly);Gr(T,R,O,U,_e,X,!0)}})(i,h,g,v);break;case"fill-extrusion":(function(T,R,O,U){const H=O.paint.get("fill-extrusion-opacity");if(H!==0&&T.renderPass==="translucent"){const Y=new Hi(T.context.gl.LEQUAL,Hi.ReadWrite,T.depthRangeFor3D);if(H!==1||O.paint.get("fill-extrusion-pattern").constantOr(1))Fc(T,R,O,U,Y,gn.disabled,ys.disabled),Fc(T,R,O,U,Y,T.stencilModeFor3D(),T.colorModeForRenderPass());else{const X=T.colorModeForRenderPass();Fc(T,R,O,U,Y,gn.disabled,X)}}})(i,h,g,v);break;case"hillshade":(function(T,R,O,U){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const H=T.context,Y=T.depthModeForSublayer(0,Hi.ReadOnly),X=T.colorModeForRenderPass(),[le,fe]=T.renderPass==="translucent"?T.stencilConfigForOverlap(U):[{},U];for(const _e of fe){const Ee=R.getTile(_e);Ee.needsHillshadePrepare!==void 0&&Ee.needsHillshadePrepare&&T.renderPass==="offscreen"?Ol(T,Ee,O,Y,gn.disabled,X):T.renderPass==="translucent"&&ka(T,_e,Ee,O,Y,le[_e.overscaledZ],X)}H.viewport.set([0,0,T.width,T.height])})(i,h,g,v);break;case"raster":(function(T,R,O,U){if(T.renderPass!=="translucent"||O.paint.get("raster-opacity")===0||!U.length)return;const H=T.context,Y=H.gl,X=R.getSource(),le=T.useProgram("raster"),fe=T.colorModeForRenderPass(),[_e,Ee]=X instanceof es?[{},U]:T.stencilConfigForOverlap(U),Pe=Ee[Ee.length-1].overscaledZ,Ie=!T.options.moving;for(const ze of Ee){const Se=T.depthModeForSublayer(ze.overscaledZ-Pe,O.paint.get("raster-opacity")===1?Hi.ReadWrite:Hi.ReadOnly,Y.LESS),Fe=R.getTile(ze);Fe.registerFadeDuration(O.paint.get("raster-fade-duration"));const Ye=R.findLoadedParent(ze,0),rt=R.findLoadedSibling(ze),bt=Va(Fe,Ye||rt||null,R,O,T.transform,T.style.map.terrain);let $t,Ht;const Qt=O.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;H.activeTexture.set(Y.TEXTURE0),Fe.texture.bind(Qt,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),H.activeTexture.set(Y.TEXTURE1),Ye?(Ye.texture.bind(Qt,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),$t=Math.pow(2,Ye.tileID.overscaledZ-Fe.tileID.overscaledZ),Ht=[Fe.tileID.canonical.x*$t%1,Fe.tileID.canonical.y*$t%1]):Fe.texture.bind(Qt,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),Fe.texture.useMipmap&&H.extTextureFilterAnisotropic&&T.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const Zt=T.style.map.terrain&&T.style.map.terrain.getTerrainData(ze),Ut=Zt?ze:null,ni=Ut?Ut.posMatrix:T.transform.calculatePosMatrix(ze.toUnwrapped(),Ie),ki=$a(ni,Ht||[0,0],$t||1,bt,O);X instanceof es?le.draw(H,Y.TRIANGLES,Se,gn.disabled,fe,En.disabled,ki,Zt,O.id,X.boundsBuffer,T.quadTriangleIndexBuffer,X.boundsSegments):le.draw(H,Y.TRIANGLES,Se,_e[ze.overscaledZ],fe,En.disabled,ki,Zt,O.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}})(i,h,g,v);break;case"background":(function(T,R,O,U){const H=O.paint.get("background-color"),Y=O.paint.get("background-opacity");if(Y===0)return;const X=T.context,le=X.gl,fe=T.transform,_e=fe.tileSize,Ee=O.paint.get("background-pattern");if(T.isPatternMissing(Ee))return;const Pe=!Ee&&H.a===1&&Y===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==Pe)return;const Ie=gn.disabled,ze=T.depthModeForSublayer(0,Pe==="opaque"?Hi.ReadWrite:Hi.ReadOnly),Se=T.colorModeForRenderPass(),Fe=T.useProgram(Ee?"backgroundPattern":"background"),Ye=U||fe.coveringTiles({tileSize:_e,terrain:T.style.map.terrain});Ee&&(X.activeTexture.set(le.TEXTURE0),T.imageManager.bind(T.context));const rt=O.getCrossfadeParameters();for(const bt of Ye){const $t=U?bt.posMatrix:T.transform.calculatePosMatrix(bt.toUnwrapped()),Ht=Ee?Rc($t,Y,T,Ee,{tileID:bt,tileSize:_e},rt):Mo($t,Y,H),Qt=T.style.map.terrain&&T.style.map.terrain.getTerrainData(bt);Fe.draw(X,le.TRIANGLES,ze,Ie,Se,En.disabled,Ht,Qt,O.id,T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}})(i,0,g,v);break;case"custom":(function(T,R,O){const U=T.context,H=O.implementation;if(T.renderPass==="offscreen"){const Y=H.prerender;Y&&(T.setCustomLayerDefaults(),U.setColorMode(T.colorModeForRenderPass()),Y.call(H,U.gl,T.transform.customLayerMatrix()),U.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),U.setColorMode(T.colorModeForRenderPass()),U.setStencilMode(gn.disabled);const Y=H.renderingMode==="3d"?new Hi(T.context.gl.LEQUAL,Hi.ReadWrite,T.depthRangeFor3D):T.depthModeForSublayer(0,Hi.ReadOnly);U.setDepthMode(Y),H.render(U.gl,T.transform.customLayerMatrix(),{farZ:T.transform.farZ,nearZ:T.transform.nearZ,fov:T.transform._fov,modelViewProjectionMatrix:T.transform.modelViewProjectionMatrix,projectionMatrix:T.transform.projectionMatrix}),U.setDirty(),T.setBaseState(),U.bindFramebuffer.set(null)}})(i,0,g)}}translatePosMatrix(i,h,g,v,T){if(!g[0]&&!g[1])return i;const R=T?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(R){const H=Math.sin(R),Y=Math.cos(R);g=[g[0]*Y-g[1]*H,g[0]*H+g[1]*Y]}const O=[T?g[0]:pi(h,g[0],this.transform.zoom),T?g[1]:pi(h,g[1],this.transform.zoom),0],U=new Float32Array(16);return d.J(U,i,O),U}saveTileTexture(i){const h=this._tileTextures[i.size[0]];h?h.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const h=this._tileTextures[i];return h&&h.length>0?h.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const h=this.imageManager.getPattern(i.from.toString()),g=this.imageManager.getPattern(i.to.toString());return!h||!g}useProgram(i,h){this.cache=this.cache||{};const g=i+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[g]||(this.cache[g]=new Co(this.context,Ba[i],h,Qs[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new at(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:h}=this.context.gl;return this.width!==i||this.height!==h}}class cl{constructor(i,h){this.points=i,this.planes=h}static fromInvProjectionMatrix(i,h,g){const v=Math.pow(2,g),T=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((O=>{const U=1/(O=d.af([],O,i))[3]/h*v;return d.b1(O,O,[U,U,1/O[3],U])})),R=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((O=>{const U=(function(le,fe){var _e=fe[0],Ee=fe[1],Pe=fe[2],Ie=_e*_e+Ee*Ee+Pe*Pe;return Ie>0&&(Ie=1/Math.sqrt(Ie)),le[0]=fe[0]*Ie,le[1]=fe[1]*Ie,le[2]=fe[2]*Ie,le})([],(function(le,fe,_e){var Ee=fe[0],Pe=fe[1],Ie=fe[2],ze=_e[0],Se=_e[1],Fe=_e[2];return le[0]=Pe*Fe-Ie*Se,le[1]=Ie*ze-Ee*Fe,le[2]=Ee*Se-Pe*ze,le})([],Re([],T[O[0]],T[O[1]]),Re([],T[O[2]],T[O[1]]))),H=-((Y=U)[0]*(X=T[O[1]])[0]+Y[1]*X[1]+Y[2]*X[2]);var Y,X;return U.concat(H)}));return new cl(T,R)}}class Wr{constructor(i,h){this.min=i,this.max=h,this.center=(function(g,v,T){return g[0]=.5*v[0],g[1]=.5*v[1],g[2]=.5*v[2],g})([],(function(g,v,T){return g[0]=v[0]+T[0],g[1]=v[1]+T[1],g[2]=v[2]+T[2],g})([],this.min,this.max))}quadrant(i){const h=[i%2==0,i<2],g=ye(this.min),v=ye(this.max);for(let T=0;T<h.length;T++)g[T]=h[T]?this.min[T]:this.center[T],v[T]=h[T]?this.center[T]:this.max[T];return v[2]=this.max[2],new Wr(g,v)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let g=!0;for(let v=0;v<i.planes.length;v++){const T=i.planes[v];let R=0;for(let O=0;O<h.length;O++)d.b2(T,h[O])>=0&&R++;if(R===0)return 0;R!==h.length&&(g=!1)}if(g)return 2;for(let v=0;v<3;v++){let T=Number.MAX_VALUE,R=-Number.MAX_VALUE;for(let O=0;O<i.points.length;O++){const U=i.points[O][v]-this.min[v];T=Math.min(T,U),R=Math.max(R,U)}if(R<0||T>this.max[v]-this.min[v])return 0}return 1}}class Ca{constructor(i=0,h=0,g=0,v=0){if(isNaN(i)||i<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=h,this.left=g,this.right=v}interpolate(i,h,g){return h.top!=null&&i.top!=null&&(this.top=d.y.number(i.top,h.top,g)),h.bottom!=null&&i.bottom!=null&&(this.bottom=d.y.number(i.bottom,h.bottom,g)),h.left!=null&&i.left!=null&&(this.left=d.y.number(i.left,h.left,g)),h.right!=null&&i.right!=null&&(this.right=d.y.number(i.right,h.right,g)),this}getCenter(i,h){const g=d.ac((this.left+i-this.right)/2,0,i),v=d.ac((this.top+h-this.bottom)/2,0,h);return new d.P(g,v)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Ca(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Nl=85.051129;class ul{constructor(i,h,g,v,T){this.tileSize=512,this._renderWorldCopies=T===void 0||!!T,this._minZoom=i||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=v??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ca,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const i=new ul(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.lngRange=i.lngRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this.minElevationForCurrentTile=i.minElevationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const h=-d.b3(i,-180,180)*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(function(){var g=new d.A(4);return d.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g})(),(function(g,v,T){var R=v[0],O=v[1],U=v[2],H=v[3],Y=Math.sin(T),X=Math.cos(T);g[0]=R*X+U*Y,g[1]=O*X+H*Y,g[2]=R*-Y+U*X,g[3]=O*-Y+H*X})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const h=d.ac(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const h=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.tileZoom=Math.max(0,Math.floor(h)),this.scale=this.zoomScale(h),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,h,g){this._unmodified=!1,this._edgeInsets.interpolate(i,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const h=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(i){const h=[new d.b4(0,i)];if(this._renderWorldCopies){const g=this.pointCoordinate(new d.P(0,0)),v=this.pointCoordinate(new d.P(this.width,0)),T=this.pointCoordinate(new d.P(this.width,this.height)),R=this.pointCoordinate(new d.P(0,this.height)),O=Math.floor(Math.min(g.x,v.x,T.x,R.x)),U=Math.floor(Math.max(g.x,v.x,T.x,R.x)),H=1;for(let Y=O-H;Y<=U+H;Y++)Y!==0&&h.push(new d.b4(Y,i))}return h}coveringTiles(i){var h,g;let v=this.coveringZoomLevel(i);const T=v;if(i.minzoom!==void 0&&v<i.minzoom)return[];i.maxzoom!==void 0&&v>i.maxzoom&&(v=i.maxzoom);const R=this.pointCoordinate(this.getCameraPoint()),O=d.Z.fromLngLat(this.center),U=Math.pow(2,v),H=[U*R.x,U*R.y,0],Y=[U*O.x,U*O.y,0],X=cl.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,v);let le=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(le=v);const fe=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,_e=Se=>({aabb:new Wr([Se*U,0,0],[(Se+1)*U,U,0]),zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),Ee=[],Pe=[],Ie=v,ze=i.reparseOverscaled?T:v;if(this._renderWorldCopies)for(let Se=1;Se<=3;Se++)Ee.push(_e(-Se)),Ee.push(_e(Se));for(Ee.push(_e(0));Ee.length>0;){const Se=Ee.pop(),Fe=Se.x,Ye=Se.y;let rt=Se.fullyVisible;if(!rt){const Zt=Se.aabb.intersects(X);if(Zt===0)continue;rt=Zt===2}const bt=i.terrain?H:Y,$t=Se.aabb.distanceX(bt),Ht=Se.aabb.distanceY(bt),Qt=Math.max(Math.abs($t),Math.abs(Ht));if(Se.zoom===Ie||Qt>fe+(1<<Ie-Se.zoom)-2&&Se.zoom>=le){const Zt=Ie-Se.zoom,Ut=H[0]-.5-(Fe<<Zt),ni=H[1]-.5-(Ye<<Zt);Pe.push({tileID:new d.S(Se.zoom===Ie?ze:Se.zoom,Se.wrap,Se.zoom,Fe,Ye),distanceSq:Ge([Y[0]-.5-Fe,Y[1]-.5-Ye]),tileDistanceToCamera:Math.sqrt(Ut*Ut+ni*ni)})}else for(let Zt=0;Zt<4;Zt++){const Ut=(Fe<<1)+Zt%2,ni=(Ye<<1)+(Zt>>1),ki=Se.zoom+1;let Gt=Se.aabb.quadrant(Zt);if(i.terrain){const Xt=new d.S(ki,Se.wrap,ki,Ut,ni),Ei=i.terrain.getMinMaxElevation(Xt),Gn=(h=Ei.minElevation)!==null&&h!==void 0?h:this.elevation,Zi=(g=Ei.maxElevation)!==null&&g!==void 0?g:this.elevation;Gt=new Wr([Gt.min[0],Gt.min[1],Gn],[Gt.max[0],Gt.max[1],Zi])}Ee.push({aabb:Gt,zoom:ki,x:Ut,y:ni,wrap:Se.wrap,fullyVisible:rt})}}return Pe.sort(((Se,Fe)=>Se.distanceSq-Fe.distanceSq)).map((Se=>Se.tileID))}resize(i,h){this.width=i,this.height=h,this.pixelsToGLUnits=[2/i,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const h=d.ac(i.lat,-85.051129,Nl);return new d.P(d.O(i.lng)*this.worldSize,d.Q(h)*this.worldSize)}unproject(i){return new d.Z(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const h=this.elevation,g=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,v=this.pointLocation(this.centerPoint,i),T=i.getElevationForLngLatZoom(v,this.tileZoom);if(!(this.elevation-T))return;const R=g+h-T,O=Math.cos(this._pitch)*this.cameraToCenterDistance/R/d.b5(1,v.lat),U=this.scaleZoom(O/this.tileSize);this._elevation=T,this._center=v,this.zoom=U}setLocationAtPoint(i,h){const g=this.pointCoordinate(h),v=this.pointCoordinate(this.centerPoint),T=this.locationCoordinate(i),R=new d.Z(T.x-(g.x-v.x),T.y-(g.y-v.y));this.center=this.coordinateLocation(R),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,h){return h?this.coordinatePoint(this.locationCoordinate(i),h.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,h){return this.coordinateLocation(this.pointCoordinate(i,h))}locationCoordinate(i){return d.Z.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,h){if(h){const le=h.pointCoordinate(i);if(le!=null)return le}const g=[i.x,i.y,0,1],v=[i.x,i.y,1,1];d.af(g,g,this.pixelMatrixInverse),d.af(v,v,this.pixelMatrixInverse);const T=g[3],R=v[3],O=g[1]/T,U=v[1]/R,H=g[2]/T,Y=v[2]/R,X=H===Y?0:(0-H)/(Y-H);return new d.Z(d.y.number(g[0]/T,v[0]/R,X)/this.worldSize,d.y.number(O,U,X)/this.worldSize)}coordinatePoint(i,h=0,g=this.pixelMatrix){const v=[i.x*this.worldSize,i.y*this.worldSize,h,1];return d.af(v,v,g),new d.P(v[0]/v[3],v[1]/v[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new it().extend(this.pointLocation(new d.P(0,i))).extend(this.pointLocation(new d.P(this.width,i))).extend(this.pointLocation(new d.P(this.width,this.height))).extend(this.pointLocation(new d.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new it([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Nl])}calculateTileMatrix(i){const h=i.canonical,g=this.worldSize/this.zoomScale(h.z),v=h.x+Math.pow(2,h.z)*i.wrap,T=d.an(new Float64Array(16));return d.J(T,T,[v*g,h.y*g,0]),d.K(T,T,[g/d.X,g/d.X,1]),T}calculatePosMatrix(i,h=!1){const g=i.key,v=h?this._alignedPosMatrixCache:this._posMatrixCache;if(v[g])return v[g];const T=this.calculateTileMatrix(i);return d.L(T,h?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,T),v[g]=new Float32Array(T),v[g]}calculateFogMatrix(i){const h=i.key,g=this._fogMatrixCache;if(g[h])return g[h];const v=this.calculateTileMatrix(i);return d.L(v,this.fogMatrix,v),g[h]=new Float32Array(v),g[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(i,h){h=d.ac(+h,this.minZoom,this.maxZoom);const g={center:new d.N(i.lng,i.lat),zoom:h};let v=this.lngRange;if(!this._renderWorldCopies&&v===null){const Se=179.9999999999;v=[-Se,Se]}const T=this.tileSize*this.zoomScale(g.zoom);let R=0,O=T,U=0,H=T,Y=0,X=0;const{x:le,y:fe}=this.size;if(this.latRange){const Se=this.latRange;R=d.Q(Se[1])*T,O=d.Q(Se[0])*T,O-R<fe&&(Y=fe/(O-R))}v&&(U=d.b3(d.O(v[0])*T,0,T),H=d.b3(d.O(v[1])*T,0,T),H<U&&(H+=T),H-U<le&&(X=le/(H-U)));const{x:_e,y:Ee}=this.project.call({worldSize:T},i);let Pe,Ie;const ze=Math.max(X||0,Y||0);if(ze){const Se=new d.P(X?(H+U)/2:_e,Y?(O+R)/2:Ee);return g.center=this.unproject.call({worldSize:T},Se).wrap(),g.zoom+=this.scaleZoom(ze),g}if(this.latRange){const Se=fe/2;Ee-Se<R&&(Ie=R+Se),Ee+Se>O&&(Ie=O-Se)}if(v){const Se=(U+H)/2;let Fe=_e;this._renderWorldCopies&&(Fe=d.b3(_e,Se-T/2,Se+T/2));const Ye=le/2;Fe-Ye<U&&(Pe=U+Ye),Fe+Ye>H&&(Pe=H-Ye)}if(Pe!==void 0||Ie!==void 0){const Se=new d.P(Pe??_e,Ie??Ee);g.center=this.unproject.call({worldSize:T},Se).wrap()}return g}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:h,zoom:g}=this.getConstrained(this.center,this.zoom);this.center=h,this.zoom=g,this._unmodified=i,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,h=this.point.x,g=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=d.b5(1,this.center.lat)*this.worldSize;let v=d.an(new Float64Array(16));d.K(v,v,[this.width/2,-this.height/2,1]),d.J(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=d.an(new Float64Array(16)),d.K(v,v,[1,-1,1]),d.J(v,v,[-1,-1,0]),d.K(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v;const T=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),R=Math.min(this.elevation,this.minElevationForCurrentTile),O=T-R*this._pixelPerMeter/Math.cos(this._pitch),U=R<0?O:T,H=Math.PI/2+this._pitch,Y=this._fov*(.5+i.y/this.height),X=Math.sin(Y)*U/Math.sin(d.ac(Math.PI-H-Y,.01,Math.PI-.01)),le=this.getHorizon(),fe=2*Math.atan(le/this.cameraToCenterDistance)*(.5+i.y/(2*le)),_e=Math.sin(fe)*U/Math.sin(d.ac(Math.PI-H-fe,.01,Math.PI-.01)),Ee=Math.min(X,_e);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Ee+U),this.nearZ=this.height/50,v=new Float64Array(16),d.b6(v,this._fov,this.width/this.height,this.nearZ,this.farZ),v[8]=2*-i.x/this.width,v[9]=2*i.y/this.height,this.projectionMatrix=d.ae(v),d.K(v,v,[1,-1,1]),d.J(v,v,[0,0,-this.cameraToCenterDistance]),d.b7(v,v,this._pitch),d.ad(v,v,this.angle),d.J(v,v,[-h,-g,0]),this.mercatorMatrix=d.K([],v,[this.worldSize,this.worldSize,this.worldSize]),d.K(v,v,[1,1,this._pixelPerMeter]),this.pixelMatrix=d.L(new Float64Array(16),this.labelPlaneMatrix,v),d.J(v,v,[0,0,-this.elevation]),this.modelViewProjectionMatrix=v,this.invModelViewProjectionMatrix=d.as([],v),this.fogMatrix=new Float64Array(16),d.b6(this.fogMatrix,this._fov,this.width/this.height,T,this.farZ),this.fogMatrix[8]=2*-i.x/this.width,this.fogMatrix[9]=2*i.y/this.height,d.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),d.b7(this.fogMatrix,this.fogMatrix,this._pitch),d.ad(this.fogMatrix,this.fogMatrix,this.angle),d.J(this.fogMatrix,this.fogMatrix,[-h,-g,0]),d.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=d.L(new Float64Array(16),this.labelPlaneMatrix,v);const Pe=this.width%2/2,Ie=this.height%2/2,ze=Math.cos(this.angle),Se=Math.sin(this.angle),Fe=h-Math.round(h)+ze*Pe+Se*Ie,Ye=g-Math.round(g)+ze*Ie+Se*Pe,rt=new Float64Array(v);if(d.J(rt,rt,[Fe>.5?Fe-1:Fe,Ye>.5?Ye-1:Ye,0]),this.alignedModelViewProjectionMatrix=rt,v=d.as(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new d.P(0,0)),h=[i.x*this.worldSize,i.y*this.worldSize,0,1];return d.af(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(0,i))}getCameraQueryGeometry(i){const h=this.getCameraPoint();if(i.length===1)return[i[0],h];{let g=h.x,v=h.y,T=h.x,R=h.y;for(const O of i)g=Math.min(g,O.x),v=Math.min(v,O.y),T=Math.max(T,O.x),R=Math.max(R,O.y);return[new d.P(g,v),new d.P(T,v),new d.P(T,R),new d.P(g,R),new d.P(g,v)]}}lngLatToCameraDepth(i,h){const g=this.locationCoordinate(i),v=[g.x*this.worldSize,g.y*this.worldSize,h,1];return d.af(v,v,this.modelViewProjectionMatrix),v[2]/v[3]}}function js(E,i){let h,g=!1,v=null,T=null;const R=()=>{v=null,g&&(E.apply(T,h),v=setTimeout(R,i),g=!1)};return(...O)=>(g=!0,T=this,h=O,v||R(),v)}class Ro{constructor(i){this._getCurrentHash=()=>{const h=window.location.hash.replace("#","");if(this._hashName){let g;return h.split("&").map((v=>v.split("="))).forEach((v=>{v[0]===this._hashName&&(g=v)})),(g&&g[1]||"").split("/")}return h.split("/")},this._onHashChange=()=>{const h=this._getCurrentHash();if(h.length>=3&&!h.some((g=>isNaN(g)))){const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(h[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const h=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,h)},this._removeHash=()=>{const h=this._getCurrentHash();if(h.length===0)return;const g=h.join("/");let v=g;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${g}`);let T=window.location.hash.replace(v,"");T.startsWith("#&")?T=T.slice(0,1)+T.slice(2):T==="#"&&(T="");let R=window.location.href.replace(/(#.+)?$/,T);R=R.replace("&&","&"),window.history.replaceState(window.history.state,null,R)},this._updateHash=js(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(i){const h=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,v=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,v),R=Math.round(h.lng*T)/T,O=Math.round(h.lat*T)/T,U=this._map.getBearing(),H=this._map.getPitch();let Y="";if(Y+=i?`/${R}/${O}/${g}`:`${g}/${O}/${R}`,(U||H)&&(Y+="/"+Math.round(10*U)/10),H&&(Y+=`/${Math.round(H)}`),this._hashName){const X=this._hashName;let le=!1;const fe=window.location.hash.slice(1).split("&").map((_e=>{const Ee=_e.split("=")[0];return Ee===X?(le=!0,`${Ee}=${Y}`):_e})).filter((_e=>_e));return le||fe.push(`${X}=${Y}`),`#${fe.join("&")}`}return`#${Y}`}}const rc={linearity:.3,easing:d.b8(0,0,.3,1)},hl=d.e({deceleration:2500,maxSpeed:1400},rc),Qh=d.e({deceleration:20,maxSpeed:1400},rc),Tu=d.e({deceleration:1e3,maxSpeed:360},rc),Vc=d.e({deceleration:1e3,maxSpeed:90},rc);class zo{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:N.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,h=N.now();for(;i.length>0&&h-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)h.zoom+=T.zoomDelta||0,h.bearing+=T.bearingDelta||0,h.pitch+=T.pitchDelta||0,T.panDelta&&h.pan._add(T.panDelta),T.around&&(h.around=T.around),T.pinchAround&&(h.pinchAround=T.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const T=fa(h.pan.mag(),g,d.e({},hl,i||{}));v.offset=h.pan.mult(T.amount/h.pan.mag()),v.center=this._map.transform.center,Bl(v,T)}if(h.zoom){const T=fa(h.zoom,g,Qh);v.zoom=this._map.transform.zoom+T.amount,Bl(v,T)}if(h.bearing){const T=fa(h.bearing,g,Tu);v.bearing=this._map.transform.bearing+d.ac(T.amount,-179,179),Bl(v,T)}if(h.pitch){const T=fa(h.pitch,g,Vc);v.pitch=this._map.transform.pitch+T.amount,Bl(v,T)}if(v.zoom||v.bearing){const T=h.pinchAround===void 0?h.around:h.pinchAround;v.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),d.e(v,{noMoveStart:!0})}}function Bl(E,i){(!E.duration||E.duration<i.duration)&&(E.duration=i.duration,E.easing=i.easing)}function fa(E,i,h){const{maxSpeed:g,linearity:v,deceleration:T}=h,R=d.ac(E*v/(i/1e3),-g,g),O=Math.abs(R)/(T*v);return{easing:h.easing,duration:1e3*O,amount:R*(O/2)}}class Kn extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g,v={}){const T=V.mousePos(h.getCanvas(),g),R=h.unproject(T);super(i,d.e({point:T,lngLat:R,originalEvent:g},v)),this._defaultPrevented=!1,this.target=h}}class Aa extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g){const v=i==="touchend"?g.changedTouches:g.touches,T=V.touchPos(h.getCanvasContainer(),v),R=T.map((U=>h.unproject(U))),O=T.reduce(((U,H,Y,X)=>U.add(H.div(X.length))),new d.P(0,0));super(i,{points:T,point:O,lngLats:R,lngLat:h.unproject(O),originalEvent:g}),this._defaultPrevented=!1}}class Yr extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g){super(i,{originalEvent:g}),this._defaultPrevented=!1}}class br{constructor(i,h){this._map=i,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new Yr(i.type,this._map,i))}mousedown(i,h){return this._mousedownPos=h,this._firePreventable(new Kn(i.type,this._map,i))}mouseup(i){this._map.fire(new Kn(i.type,this._map,i))}click(i,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new Kn(i.type,this._map,i))}dblclick(i){return this._firePreventable(new Kn(i.type,this._map,i))}mouseover(i){this._map.fire(new Kn(i.type,this._map,i))}mouseout(i){this._map.fire(new Kn(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Aa(i.type,this._map,i))}touchmove(i){this._map.fire(new Aa(i.type,this._map,i))}touchend(i){this._map.fire(new Aa(i.type,this._map,i))}touchcancel(i){this._map.fire(new Aa(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class os{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new Kn(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Kn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new Kn(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wr{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(d.P.convert(i),this._map.terrain)}}class Ls{constructor(i,h){this._map=i,this._tr=new wr(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,h){this.isEnabled()&&i.shiftKey&&i.button===0&&(V.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(i,h){if(!this._active)return;const g=h;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=g,this._box||(this._box=V.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const T=Math.min(v.x,g.x),R=Math.max(v.x,g.x),O=Math.min(v.y,g.y),U=Math.max(v.y,g.y);V.setTransform(this._box,`translate(${T}px,${O}px)`),this._box.style.width=R-T+"px",this._box.style.height=U-O+"px"}mouseupWindow(i,h){if(!this._active||i.button!==0)return;const g=this._startPos,v=h;if(this.reset(),V.suppressClick(),g.x!==v.x||g.y!==v.y)return this._map.fire(new d.k("boxzoomend",{originalEvent:i})),{cameraAnimation:T=>T.fitScreenCoordinates(g,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,h){return this._map.fire(new d.k(i,{originalEvent:h}))}}function dl(E,i){if(E.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${E.length}, points ${i.length}`);const h={};for(let g=0;g<E.length;g++)h[E[g].identifier]=i[g];return h}class pa{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),g.length===this.numTouches&&(this.centroid=(function(v){const T=new d.P(0,0);for(const R of v)T._add(R);return T.div(v.length)})(h),this.touches=dl(g,h)))}touchmove(i,h,g){if(this.aborted||!this.centroid)return;const v=dl(g,h);for(const T in this.touches){const R=v[T];(!R||R.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(i,h,g){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class go{constructor(i){this.singleTap=new pa(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,h,g){this.singleTap.touchstart(i,h,g)}touchmove(i,h,g){this.singleTap.touchmove(i,h,g)}touchend(i,h,g){const v=this.singleTap.touchend(i,h,g);if(v){const T=i.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(v)<30;if(T&&R||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Ha{constructor(i){this._tr=new wr(i),this._zoomIn=new go({numTouches:1,numTaps:2}),this._zoomOut=new go({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,h,g){this._zoomIn.touchstart(i,h,g),this._zoomOut.touchstart(i,h,g)}touchmove(i,h,g){this._zoomIn.touchmove(i,h,g),this._zoomOut.touchmove(i,h,g)}touchend(i,h,g){const v=this._zoomIn.touchend(i,h,g),T=this._zoomOut.touchend(i,h,g),R=this._tr;return v?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:R.zoom+1,around:R.unproject(v)},{originalEvent:i})}):T?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:R.zoom-1,around:R.unproject(T)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sr{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const h=this._moveFunction(...i);if(h.bearingDelta||h.pitchDelta||h.around||h.panDelta)return this._active=!0,h}dragStart(i,h){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=h.length?h[0]:h,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,h){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const v=h.length?h[0]:h;return!this._moved&&v.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(g,v))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&V.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Eu={0:1,2:2};class er{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const h=V.mouseButton(i);this._eventButton=h}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!(function(h,g){const v=Eu[g];return h.buttons===void 0||(h.buttons&v)!==v})(i,this._eventButton)}isValidEndEvent(i){return V.mouseButton(i)===this._eventButton}}class $l{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const Xr=E=>{E.mousedown=E.dragStart,E.mousemoveWindow=E.dragMove,E.mouseup=E.dragEnd,E.contextmenu=i=>{i.preventDefault()}},ac=({enable:E,clickTolerance:i,bearingDegreesPerPixelMoved:h=.8})=>{const g=new er({checkCorrectEvent:v=>V.mouseButton(v)===0&&v.ctrlKey||V.mouseButton(v)===2});return new Sr({clickTolerance:i,move:(v,T)=>({bearingDelta:(T.x-v.x)*h}),moveStateManager:g,enable:E,assignEvents:Xr})},fl=({enable:E,clickTolerance:i,pitchDegreesPerPixelMoved:h=-.5})=>{const g=new er({checkCorrectEvent:v=>V.mouseButton(v)===0&&v.ctrlKey||V.mouseButton(v)===2});return new Sr({clickTolerance:i,move:(v,T)=>({pitchDelta:(T.y-v.y)*h}),moveStateManager:g,enable:E,assignEvents:Xr})};class Kr{constructor(i,h){this._clickTolerance=i.clickTolerance||1,this._map=h,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(i){return i<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(i,h,g){return this._calculateTransform(i,h,g)}touchmove(i,h,g){if(this._active){if(!this._shouldBePrevented(g.length))return i.preventDefault(),this._calculateTransform(i,h,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",i)}}touchend(i,h,g){this._calculateTransform(i,h,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,h,g){g.length>0&&(this._active=!0);const v=dl(g,h),T=new d.P(0,0),R=new d.P(0,0);let O=0;for(const H in v){const Y=v[H],X=this._touches[H];X&&(T._add(Y),R._add(Y.sub(X)),O++,v[H]=Y)}if(this._touches=v,this._shouldBePrevented(O)||!R.mag())return;const U=R.div(O);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(O),panDelta:U}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(i,h,g){if(!this._firstTwoTouches)return;i.preventDefault();const[v,T]=this._firstTwoTouches,R=ml(g,h,v),O=ml(g,h,T);if(!R||!O)return;const U=this._aroundCenter?null:R.add(O).div(2);return this._move([R,O],U,i)}touchend(i,h,g){if(!this._firstTwoTouches)return;const[v,T]=this._firstTwoTouches,R=ml(g,h,v),O=ml(g,h,T);R&&O||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ml(E,i,h){for(let g=0;g<E.length;g++)if(E[g].identifier===h)return i[g]}function oc(E,i){return Math.log(E/i)/Math.LN2}class u extends pl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,h){const g=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(oc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oc(this._distance,g),pinchAround:h}}}function b(E,i){return 180*E.angleWith(i)/Math.PI}class M extends pl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,h,g){const v=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:b(this._vector,v),pinchAround:h}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const h=25/(Math.PI*this._minDiameter)*360,g=b(i,this._startVector);return Math.abs(g)<h}}function $(E){return Math.abs(E.y)>Math.abs(E.x)}class Z extends pl{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,h,g){super.touchstart(i,h,g),this._currentTouchCount=g.length}_start(i){this._lastPoints=i,$(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,h,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=i[0].sub(this._lastPoints[0]),T=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,T,g.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5}):void 0}gestureBeginsVertically(i,h,g){if(this._valid!==void 0)return this._valid;const v=i.mag()>=2,T=h.mag()>=2;if(!v&&!T)return;if(!v||!T)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const R=i.y>0==h.y>0;return $(i)&&$(h)&&R}}const ce={panStep:100,bearingStep:15,pitchStep:10};class Ae{constructor(i){this._tr=new wr(i);const h=ce;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let h=0,g=0,v=0,T=0,R=0;switch(i.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:i.shiftKey?g=-1:(i.preventDefault(),T=-1);break;case 39:i.shiftKey?g=1:(i.preventDefault(),T=1);break;case 38:i.shiftKey?v=1:(i.preventDefault(),R=-1);break;case 40:i.shiftKey?v=-1:(i.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(g=0,v=0),{cameraAnimation:O=>{const U=this._tr;O.easeTo({duration:300,easeId:"keyboardHandler",easing:Je,zoom:h?Math.round(U.zoom)+h*(i.shiftKey?2:1):U.zoom,bearing:U.bearing+g*this._bearingStep,pitch:U.pitch+v*this._pitchStep,offset:[-T*this._panStep,-R*this._panStep],center:U.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Je(E){return E*(2-E)}const dt=4.000244140625;class wt{constructor(i,h){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=i,this._tr=new wr(i),this._triggerRenderFrame=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(i){return!!this._map.cooperativeGestures.isEnabled()&&!(i.ctrlKey||this._map.cooperativeGestures.isBypassed(i))}wheel(i){if(!this.isEnabled())return;if(this._shouldBePrevented(i))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",i);let h=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const g=N.now(),v=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%dt==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),i.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=i,this._delta-=h,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=V.mousePos(this._map.getCanvas(),i),g=this._tr;this._around=h.y>g.transform.height/2-g.transform.getHorizon()?d.N.convert(this._aroundCenter?g.center:g.unproject(h)):d.N.convert(g.center),this._aroundPoint=g.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>dt?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&H!==0&&(H=1/H);const Y=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(Y*H))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,g=this._startZoom,v=this._easing;let T,R=!1;const O=N.now()-this._lastWheelEventTime;if(this._type==="wheel"&&g&&v&&O){const U=Math.min(O/200,1),H=v(U);T=d.y.number(g,h,H),U<1?this._frameId||(this._frameId=!0):R=!0}else T=h,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!R,zoomDelta:T-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let h=d.b9;if(this._prevEase){const g=this._prevEase,v=(N.now()-g.start)/g.duration,T=g.easing(v+.01)-g.easing(v),R=.27/Math.sqrt(T*T+1e-4)*.01,O=Math.sqrt(.0729-R*R);h=d.b8(R,O,.25,1)}return this._prevEase={start:N.now(),duration:i,easing:h},h}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Yt{constructor(i,h){this._clickZoom=i,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _i{constructor(i){this._tr=new wr(i),this.reset()}reset(){this._active=!1}dblclick(i,h){return i.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(h)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class un{constructor(){this._tap=new go({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,h,g){if(!this._swipePoint)if(this._tapTime){const v=h[0],T=i.timeStamp-this._tapTime<500,R=this._tapPoint.dist(v)<30;T&&R?g.length>0&&(this._swipePoint=v,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(i,h,g)}touchmove(i,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const v=h[0],T=v.y-this._swipePoint.y;return this._swipePoint=v,i.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(i,h,g)}touchend(i,h,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const v=this._tap.touchend(i,h,g);v&&(this._tapTime=i.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ws{constructor(i,h,g){this._el=i,this._mousePan=h,this._touchPan=g}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Es{constructor(i,h,g){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Tr{constructor(i,h,g,v){this._el=i,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class bn{constructor(i,h){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=h,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=V.create("div","maplibregl-cooperative-gesture-screen",i);let h=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(h=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=h,this._container.appendChild(v);const T=document.createElement("div");T.className="maplibregl-mobile-message",T.textContent=g,this._container.appendChild(T),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(i){return i[this._bypassKey]}notifyGestureBlocked(i,h){this._enabled&&(this._map.fire(new d.k("cooperativegestureprevented",{gestureType:i,originalEvent:h})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Yi=E=>E.zoom||E.drag||E.pitch||E.rotate;class Lt extends d.k{}function Ma(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta}class zr{constructor(i,h){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,T)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const R=v.type==="renderFrame"?void 0:v,O={needsRenderFrame:!1},U={},H={},Y=v.touches,X=Y?this._getMapTouches(Y):void 0,le=X?V.touchPos(this._map.getCanvas(),X):V.mousePos(this._map.getCanvas(),v);for(const{handlerName:Ee,handler:Pe,allowed:Ie}of this._handlers){if(!Pe.isEnabled())continue;let ze;this._blockedByActive(H,Ie,Ee)?Pe.reset():Pe[T||v.type]&&(ze=Pe[T||v.type](v,le,X),this.mergeHandlerResult(O,U,ze,Ee,R),ze&&ze.needsRenderFrame&&this._triggerRenderFrame()),(ze||Pe.isActive())&&(H[Ee]=Pe)}const fe={};for(const Ee in this._previousActiveHandlers)H[Ee]||(fe[Ee]=R);this._previousActiveHandlers=H,(Object.keys(fe).length||Ma(O))&&(this._changes.push([O,U,fe]),this._triggerRenderFrame()),(Object.keys(H).length||Ma(O))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:_e}=O;_e&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],_e(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new zo(i),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,T,R]of this._listeners)V.addEventListener(v,T,v===document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[i,h,g]of this._listeners)V.removeEventListener(i,h,i===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(i){const h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new br(h,i));const v=h.boxZoom=new Ls(h,i);this._add("boxZoom",v),i.interactive&&i.boxZoom&&v.enable();const T=h.cooperativeGestures=new bn(h,i.cooperativeGestures);this._add("cooperativeGestures",T),i.cooperativeGestures&&T.enable();const R=new Ha(h),O=new _i(h);h.doubleClickZoom=new Yt(O,R),this._add("tapZoom",R),this._add("clickZoom",O),i.interactive&&i.doubleClickZoom&&h.doubleClickZoom.enable();const U=new un;this._add("tapDragZoom",U);const H=h.touchPitch=new Z(h);this._add("touchPitch",H),i.interactive&&i.touchPitch&&h.touchPitch.enable(i.touchPitch);const Y=ac(i),X=fl(i);h.dragRotate=new Es(i,Y,X),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]),i.interactive&&i.dragRotate&&h.dragRotate.enable();const le=(({enable:ze,clickTolerance:Se})=>{const Fe=new er({checkCorrectEvent:Ye=>V.mouseButton(Ye)===0&&!Ye.ctrlKey});return new Sr({clickTolerance:Se,move:(Ye,rt)=>({around:rt,panDelta:rt.sub(Ye)}),activateOnStart:!0,moveStateManager:Fe,enable:ze,assignEvents:Xr})})(i),fe=new Kr(i,h);h.dragPan=new Ws(g,le,fe),this._add("mousePan",le),this._add("touchPan",fe,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&h.dragPan.enable(i.dragPan);const _e=new M,Ee=new u;h.touchZoomRotate=new Tr(g,Ee,_e,U),this._add("touchRotate",_e,["touchPan","touchZoom"]),this._add("touchZoom",Ee,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&h.touchZoomRotate.enable(i.touchZoomRotate);const Pe=h.scrollZoom=new wt(h,(()=>this._triggerRenderFrame()));this._add("scrollZoom",Pe,["mousePan"]),i.interactive&&i.scrollZoom&&h.scrollZoom.enable(i.scrollZoom);const Ie=h.keyboard=new Ae(h);this._add("keyboard",Ie),i.interactive&&i.keyboard&&h.keyboard.enable(),this._add("blockableMapEvent",new os(h))}_add(i,h,g){this._handlers.push({handlerName:i,handler:h,allowed:g}),this._handlersById[i]=h}stop(i){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Yi(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,h,g){for(const v in i)if(v!==g&&(!h||h.indexOf(v)<0))return!0;return!1}_getMapTouches(i){const h=[];for(const g of i)this._el.contains(g.target)&&h.push(g);return h}mergeHandlerResult(i,h,g,v,T){if(!g)return;d.e(i,g);const R={handlerName:v,originalEvent:g.originalEvent||T};g.zoomDelta!==void 0&&(h.zoom=R),g.panDelta!==void 0&&(h.drag=R),g.pitchDelta!==void 0&&(h.pitch=R),g.bearingDelta!==void 0&&(h.rotate=R)}_applyChanges(){const i={},h={},g={};for(const[v,T,R]of this._changes)v.panDelta&&(i.panDelta=(i.panDelta||new d.P(0,0))._add(v.panDelta)),v.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(i.around=v.around),v.pinchAround!==void 0&&(i.pinchAround=v.pinchAround),v.noInertia&&(i.noInertia=v.noInertia),d.e(h,T),d.e(g,R);this._updateMapTransform(i,h,g),this._changes=[]}_updateMapTransform(i,h,g){const v=this._map,T=v._getTransformForUpdate(),R=v.terrain;if(!(Ma(i)||R&&this._terrainMovement))return this._fireEvents(h,g,!0);let{panDelta:O,zoomDelta:U,bearingDelta:H,pitchDelta:Y,around:X,pinchAround:le}=i;le!==void 0&&(X=le),v._stop(!0),X=X||v.transform.centerPoint;const fe=T.pointLocation(O?X.sub(O):X);H&&(T.bearing+=H),Y&&(T.pitch+=Y),U&&(T.zoom+=U),R?this._terrainMovement||!h.drag&&!h.zoom?h.drag&&this._terrainMovement?T.center=T.pointLocation(T.centerPoint.sub(O)):T.setLocationAtPoint(fe,X):(this._terrainMovement=!0,this._map._elevationFreeze=!0,T.setLocationAtPoint(fe,X)):T.setLocationAtPoint(fe,X),v._applyUpdatedTransform(T),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(h,g,!0)}_fireEvents(i,h,g){const v=Yi(this._eventsInProgress),T=Yi(i),R={};for(const X in i){const{originalEvent:le}=i[X];this._eventsInProgress[X]||(R[`${X}start`]=le),this._eventsInProgress[X]=i[X]}!v&&T&&this._fireEvent("movestart",T.originalEvent);for(const X in R)this._fireEvent(X,R[X]);T&&this._fireEvent("move",T.originalEvent);for(const X in i){const{originalEvent:le}=i[X];this._fireEvent(X,le)}const O={};let U;for(const X in this._eventsInProgress){const{handlerName:le,originalEvent:fe}=this._eventsInProgress[X];this._handlersById[le].isActive()||(delete this._eventsInProgress[X],U=h[le]||fe,O[`${X}end`]=U)}for(const X in O)this._fireEvent(X,O[X]);const H=Yi(this._eventsInProgress),Y=(v||T)&&!H;if(Y&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const X=this._map._getTransformForUpdate();X.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(X)}if(g&&Y){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),le=fe=>fe!==0&&-this._bearingSnap<fe&&fe<this._bearingSnap;!X||!X.essential&&N.prefersReducedMotion?(this._map.fire(new d.k("moveend",{originalEvent:U})),le(this._map.getBearing())&&this._map.resetNorth()):(le(X.bearing||this._map.getBearing())&&(X.bearing=0),X.freezeElevation=!0,this._map.easeTo(X,{originalEvent:U})),this._updatingCamera=!1}}_fireEvent(i,h){this._map.fire(new d.k(i,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((i=>{delete this._frameId,this.handleEvent(new Lt("renderFrame",{timeStamp:i})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class lc extends d.E{constructor(i,h){super(),this._renderFrameCallback=()=>{const g=Math.min((N.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=h.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new d.N(this.transform.center.lng,this.transform.center.lat)}setCenter(i,h){return this.jumpTo({center:i},h)}panBy(i,h,g){return i=d.P.convert(i).mult(-1),this.panTo(this.transform.center,d.e({offset:i},h),g)}panTo(i,h,g){return this.easeTo(d.e({center:i},h),g)}getZoom(){return this.transform.zoom}setZoom(i,h){return this.jumpTo({zoom:i},h),this}zoomTo(i,h,g){return this.easeTo(d.e({zoom:i},h),g)}zoomIn(i,h){return this.zoomTo(this.getZoom()+1,i,h),this}zoomOut(i,h){return this.zoomTo(this.getZoom()-1,i,h),this}getBearing(){return this.transform.bearing}setBearing(i,h){return this.jumpTo({bearing:i},h),this}getPadding(){return this.transform.padding}setPadding(i,h){return this.jumpTo({padding:i},h),this}rotateTo(i,h,g){return this.easeTo(d.e({bearing:i},h),g)}resetNorth(i,h){return this.rotateTo(0,d.e({duration:1e3},i),h),this}resetNorthPitch(i,h){return this.easeTo(d.e({bearing:0,pitch:0,duration:1e3},i),h),this}snapToNorth(i,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,h):this}getPitch(){return this.transform.pitch}setPitch(i,h){return this.jumpTo({pitch:i},h),this}cameraForBounds(i,h){i=it.convert(i).adjustAntiMeridian();const g=h&&h.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),g,h)}_cameraForBoxAndBearing(i,h,g,v){const T={top:0,bottom:0,right:0,left:0};if(typeof(v=d.e({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const Zt=v.padding;v.padding={top:Zt,bottom:Zt,right:Zt,left:Zt}}v.padding=d.e(T,v.padding);const R=this.transform,O=R.padding,U=new it(i,h),H=R.project(U.getNorthWest()),Y=R.project(U.getNorthEast()),X=R.project(U.getSouthEast()),le=R.project(U.getSouthWest()),fe=d.ba(-g),_e=H.rotate(fe),Ee=Y.rotate(fe),Pe=X.rotate(fe),Ie=le.rotate(fe),ze=new d.P(Math.max(_e.x,Ee.x,Ie.x,Pe.x),Math.max(_e.y,Ee.y,Ie.y,Pe.y)),Se=new d.P(Math.min(_e.x,Ee.x,Ie.x,Pe.x),Math.min(_e.y,Ee.y,Ie.y,Pe.y)),Fe=ze.sub(Se),Ye=(R.width-(O.left+O.right+v.padding.left+v.padding.right))/Fe.x,rt=(R.height-(O.top+O.bottom+v.padding.top+v.padding.bottom))/Fe.y;if(rt<0||Ye<0)return void d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const bt=Math.min(R.scaleZoom(R.scale*Math.min(Ye,rt)),v.maxZoom),$t=d.P.convert(v.offset),Ht=new d.P((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(d.ba(g)),Qt=$t.add(Ht).mult(R.scale/R.zoomScale(bt));return{center:R.unproject(H.add(X).div(2).sub(Qt)),zoom:bt,bearing:g}}fitBounds(i,h,g){return this._fitInternal(this.cameraForBounds(i,h),h,g)}fitScreenCoordinates(i,h,g,v,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.P.convert(i)),this.transform.pointLocation(d.P.convert(h)),g,v),v,T)}_fitInternal(i,h,g){return i?(delete(h=d.e(i,h)).padding,h.linear?this.easeTo(h,g):this.flyTo(h,g)):this}jumpTo(i,h){this.stop();const g=this._getTransformForUpdate();let v=!1,T=!1,R=!1;return"zoom"in i&&g.zoom!==+i.zoom&&(v=!0,g.zoom=+i.zoom),i.center!==void 0&&(g.center=d.N.convert(i.center)),"bearing"in i&&g.bearing!==+i.bearing&&(T=!0,g.bearing=+i.bearing),"pitch"in i&&g.pitch!==+i.pitch&&(R=!0,g.pitch=+i.pitch),i.padding==null||g.isPaddingEqual(i.padding)||(g.padding=i.padding),this._applyUpdatedTransform(g),this.fire(new d.k("movestart",h)).fire(new d.k("move",h)),v&&this.fire(new d.k("zoomstart",h)).fire(new d.k("zoom",h)).fire(new d.k("zoomend",h)),T&&this.fire(new d.k("rotatestart",h)).fire(new d.k("rotate",h)).fire(new d.k("rotateend",h)),R&&this.fire(new d.k("pitchstart",h)).fire(new d.k("pitch",h)).fire(new d.k("pitchend",h)),this.fire(new d.k("moveend",h))}calculateCameraOptionsFromTo(i,h,g,v=0){const T=d.Z.fromLngLat(i,h),R=d.Z.fromLngLat(g,v),O=R.x-T.x,U=R.y-T.y,H=R.z-T.z,Y=Math.hypot(O,U,H);if(Y===0)throw new Error("Can't calculate camera options with same From and To");const X=Math.hypot(O,U),le=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Y/this.transform.tileSize),fe=180*Math.atan2(O,-U)/Math.PI;let _e=180*Math.acos(X/Y)/Math.PI;return _e=H<0?90-_e:90+_e,{center:R.toLngLat(),zoom:le,pitch:_e,bearing:fe}}easeTo(i,h){var g;this._stop(!1,i.easeId),((i=d.e({offset:[0,0],duration:500,easing:d.b9},i)).animate===!1||!i.essential&&N.prefersReducedMotion)&&(i.duration=0);const v=this._getTransformForUpdate(),T=v.zoom,R=v.bearing,O=v.pitch,U=v.padding,H="bearing"in i?this._normalizeBearing(i.bearing,R):R,Y="pitch"in i?+i.pitch:O,X="padding"in i?i.padding:v.padding,le=d.P.convert(i.offset);let fe=v.centerPoint.add(le);const _e=v.pointLocation(fe),{center:Ee,zoom:Pe}=v.getConstrained(d.N.convert(i.center||_e),(g=i.zoom)!==null&&g!==void 0?g:T);this._normalizeCenter(Ee,v);const Ie=v.project(_e),ze=v.project(Ee).sub(Ie),Se=v.zoomScale(Pe-T);let Fe,Ye;i.around&&(Fe=d.N.convert(i.around),Ye=v.locationPoint(Fe));const rt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Pe!==T,this._rotating=this._rotating||R!==H,this._pitching=this._pitching||Y!==O,this._padding=!v.isPaddingEqual(X),this._easeId=i.easeId,this._prepareEase(h,i.noMoveStart,rt),this.terrain&&this._prepareElevation(Ee),this._ease((bt=>{if(this._zooming&&(v.zoom=d.y.number(T,Pe,bt)),this._rotating&&(v.bearing=d.y.number(R,H,bt)),this._pitching&&(v.pitch=d.y.number(O,Y,bt)),this._padding&&(v.interpolatePadding(U,X,bt),fe=v.centerPoint.add(le)),this.terrain&&!i.freezeElevation&&this._updateElevation(bt),Fe)v.setLocationAtPoint(Fe,Ye);else{const $t=v.zoomScale(v.zoom-T),Ht=Pe>T?Math.min(2,Se):Math.max(.5,Se),Qt=Math.pow(Ht,1-bt),Zt=v.unproject(Ie.add(ze.mult(bt*Qt)).mult($t));v.setLocationAtPoint(v.renderWorldCopies?Zt.wrap():Zt,fe)}this._applyUpdatedTransform(v),this._fireMoveEvents(h)}),(bt=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(h,bt)}),i),this}_prepareEase(i,h,g={}){this._moving=!0,h||g.moving||this.fire(new d.k("movestart",i)),this._zooming&&!g.zooming&&this.fire(new d.k("zoomstart",i)),this._rotating&&!g.rotating&&this.fire(new d.k("rotatestart",i)),this._pitching&&!g.pitching&&this.fire(new d.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const h=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&h!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(g-(h-(g*i+this._elevationStart))/(1-i)),this._elevationTarget=h}this.transform.elevation=d.y.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(i){const h=i.getCameraPosition(),g=this.terrain.getElevationForLngLatZoom(h.lngLat,i.zoom);if(h.altitude<g){const v=this.calculateCameraOptionsFromTo(h.lngLat,g,i.center,i.elevation);return{pitch:v.pitch,zoom:v.zoom}}return{}}_applyUpdatedTransform(i){const h=[];if(this.terrain&&h.push((v=>this._elevateCameraIfInsideTerrain(v))),this.transformCameraUpdate&&h.push((v=>this.transformCameraUpdate(v))),!h.length)return;const g=i.clone();for(const v of h){const T=g.clone(),{center:R,zoom:O,pitch:U,bearing:H,elevation:Y}=v(T);R&&(T.center=R),O!==void 0&&(T.zoom=O),U!==void 0&&(T.pitch=U),H!==void 0&&(T.bearing=H),Y!==void 0&&(T.elevation=Y),g.apply(T)}this.transform.apply(g)}_fireMoveEvents(i){this.fire(new d.k("move",i)),this._zooming&&this.fire(new d.k("zoom",i)),this._rotating&&this.fire(new d.k("rotate",i)),this._pitching&&this.fire(new d.k("pitch",i))}_afterEase(i,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId;const g=this._zooming,v=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new d.k("zoomend",i)),v&&this.fire(new d.k("rotateend",i)),T&&this.fire(new d.k("pitchend",i)),this.fire(new d.k("moveend",i))}flyTo(i,h){var g;if(!i.essential&&N.prefersReducedMotion){const Xt=d.M(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Xt,h)}this.stop(),i=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.b9},i);const v=this._getTransformForUpdate(),T=v.zoom,R=v.bearing,O=v.pitch,U=v.padding,H="bearing"in i?this._normalizeBearing(i.bearing,R):R,Y="pitch"in i?+i.pitch:O,X="padding"in i?i.padding:v.padding,le=d.P.convert(i.offset);let fe=v.centerPoint.add(le);const _e=v.pointLocation(fe),{center:Ee,zoom:Pe}=v.getConstrained(d.N.convert(i.center||_e),(g=i.zoom)!==null&&g!==void 0?g:T);this._normalizeCenter(Ee,v);const Ie=v.zoomScale(Pe-T),ze=v.project(_e),Se=v.project(Ee).sub(ze);let Fe=i.curve;const Ye=Math.max(v.width,v.height),rt=Ye/Ie,bt=Se.mag();if("minZoom"in i){const Xt=d.ac(Math.min(i.minZoom,T,Pe),v.minZoom,v.maxZoom),Ei=Ye/v.zoomScale(Xt-T);Fe=Math.sqrt(Ei/bt*2)}const $t=Fe*Fe;function Ht(Xt){const Ei=(rt*rt-Ye*Ye+(Xt?-1:1)*$t*$t*bt*bt)/(2*(Xt?rt:Ye)*$t*bt);return Math.log(Math.sqrt(Ei*Ei+1)-Ei)}function Qt(Xt){return(Math.exp(Xt)-Math.exp(-Xt))/2}function Zt(Xt){return(Math.exp(Xt)+Math.exp(-Xt))/2}const Ut=Ht(!1);let ni=function(Xt){return Zt(Ut)/Zt(Ut+Fe*Xt)},ki=function(Xt){return Ye*((Zt(Ut)*(Qt(Ei=Ut+Fe*Xt)/Zt(Ei))-Qt(Ut))/$t)/bt;var Ei},Gt=(Ht(!0)-Ut)/Fe;if(Math.abs(bt)<1e-6||!isFinite(Gt)){if(Math.abs(Ye-rt)<1e-6)return this.easeTo(i,h);const Xt=rt<Ye?-1:1;Gt=Math.abs(Math.log(rt/Ye))/Fe,ki=()=>0,ni=Ei=>Math.exp(Xt*Fe*Ei)}return i.duration="duration"in i?+i.duration:1e3*Gt/("screenSpeed"in i?+i.screenSpeed/Fe:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=R!==H,this._pitching=Y!==O,this._padding=!v.isPaddingEqual(X),this._prepareEase(h,!1),this.terrain&&this._prepareElevation(Ee),this._ease((Xt=>{const Ei=Xt*Gt,Gn=1/ni(Ei);v.zoom=Xt===1?Pe:T+v.scaleZoom(Gn),this._rotating&&(v.bearing=d.y.number(R,H,Xt)),this._pitching&&(v.pitch=d.y.number(O,Y,Xt)),this._padding&&(v.interpolatePadding(U,X,Xt),fe=v.centerPoint.add(le)),this.terrain&&!i.freezeElevation&&this._updateElevation(Xt);const Zi=Xt===1?Ee:v.unproject(ze.add(Se.mult(ki(Ei))).mult(Gn));v.setLocationAtPoint(v.renderWorldCopies?Zi.wrap():Zi,fe),this._applyUpdatedTransform(v),this._fireMoveEvents(h)}),(()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(h)}),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,h){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,h)}return i||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(i,h,g){g.animate===!1||g.duration===0?(i(1),h()):(this._easeStart=N.now(),this._easeOptions=g,this._onEaseFrame=i,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,h){i=d.b3(i,-180,180);const g=Math.abs(i-h);return Math.abs(i-360-h)<g&&(i-=360),Math.abs(i+360-h)<g&&(i+=360),i}_normalizeCenter(i,h){if(!h.renderWorldCopies||h.lngRange)return;const g=i.lng-h.center.lng;i.lng+=g>180?-360:g<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(d.N.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}const Jr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Do{constructor(i=Jr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=h=>{!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"&&h.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,h){const g=this._map._getUIString(`AttributionControl.${h}`);i.title=g,i.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map((v=>typeof v!="string"?"":v))):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style.sourceCaches;for(const v in h){const T=h[v];if(T.used||T.usedForTerrain){const R=T.getSource();R.attribution&&i.indexOf(R.attribution)<0&&i.push(R.attribution)}}i=i.filter((v=>String(v).trim())),i.sort(((v,T)=>v.length-T.length)),i=i.filter(((v,T)=>{for(let R=T+1;R<i.length;R++)if(i[R].indexOf(v)>=0)return!1;return!0}));const g=i.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,i.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class _s{constructor(i={}){this._updateCompact=()=>{const h=this._container.children;if(h.length){const g=h[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl");const h=V.create("a","maplibregl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Oi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const h=++this._id;return this._queue.push({callback:i,id:h,cancelled:!1}),h}remove(i){const h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(const v of g)if(v.id===i)return void(v.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const h=this._currentlyRunning=this._queue;this._queue=[];for(const g of h)if(!g.cancelled&&(g.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var yo=d.Y([{name:"a_pos3d",type:"Int16",components:3}]);class ku extends d.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,h){this.sourceCache.update(i,h),this._renderableTilesKeys=[];const g={};for(const v of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:h}))g[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.posMatrix=new Float64Array(16),d.aP(v.posMatrix,0,d.X,0,d.X,0,1),this._tiles[v.key]=new Zn(v,this.tileSize));for(const v in this._tiles)g[v]||delete this._tiles[v]}freeRtt(i){for(const h in this._tiles){const g=this._tiles[h];(!i||g.tileID.equals(i)||g.tileID.isChildOf(i)||i.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((i=>this.getTileByID(i)))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const h={};for(const g of this._renderableTilesKeys){const v=this._tiles[g].tileID;if(v.canonical.equals(i.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16),d.aP(T.posMatrix,0,d.X,0,d.X,0,1),h[g]=T}else if(v.canonical.isChildOf(i.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16);const R=v.canonical.z-i.canonical.z,O=v.canonical.x-(v.canonical.x>>R<<R),U=v.canonical.y-(v.canonical.y>>R<<R),H=d.X>>R;d.aP(T.posMatrix,0,H,0,H,0,1),d.J(T.posMatrix,T.posMatrix,[-O*H,-U*H,0]),h[g]=T}else if(i.canonical.isChildOf(v.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16);const R=i.canonical.z-v.canonical.z,O=i.canonical.x-(i.canonical.x>>R<<R),U=i.canonical.y-(i.canonical.y>>R<<R),H=d.X>>R;d.aP(T.posMatrix,0,d.X,0,d.X,0,1),d.J(T.posMatrix,T.posMatrix,[O*H,U*H,0]),d.K(T.posMatrix,T.posMatrix,[1/2**R,1/2**R,0]),h[g]=T}}return h}getSourceTile(i,h){const g=this.sourceCache._source;let v=i.overscaledZ-this.deltaZoom;if(v>g.maxzoom&&(v=g.maxzoom),v<g.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(v).key);let T=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!T||!T.dem)&&h)for(;v>=g.minzoom&&(!T||!T.dem);)T=this.sourceCache.getTileByID(i.scaledTo(v--).key);return T}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter((h=>h.timeAdded>=i))}}class gl{constructor(i,h,g){this.painter=i,this.sourceCache=new ku(h),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,h,g,v=d.X){var T;if(!(h>=0&&h<v&&g>=0&&g<v))return 0;const R=this.getTerrainData(i),O=(T=R.tile)===null||T===void 0?void 0:T.dem;if(!O)return 0;const U=(function(_e,Ee,Pe){var Ie=Ee[0],ze=Ee[1];return _e[0]=Pe[0]*Ie+Pe[4]*ze+Pe[12],_e[1]=Pe[1]*Ie+Pe[5]*ze+Pe[13],_e})([],[h/v*d.X,g/v*d.X],R.u_terrain_matrix),H=[U[0]*O.dim,U[1]*O.dim],Y=Math.floor(H[0]),X=Math.floor(H[1]),le=H[0]-Y,fe=H[1]-X;return O.get(Y,X)*(1-le)*(1-fe)+O.get(Y+1,X)*le*(1-fe)+O.get(Y,X+1)*(1-le)*fe+O.get(Y+1,X+1)*le*fe}getElevationForLngLatZoom(i,h){if(!d.bb(h,i.wrap()))return 0;const{tileID:g,mercatorX:v,mercatorY:T}=this._getOverscaledTileIDFromLngLatZoom(i,h);return this.getElevation(g,v%d.X,T%d.X,d.X)}getElevation(i,h,g,v=d.X){return this.getDEMElevation(i,h,g,v)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const v=this.painter.context,T=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new at(v,T,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new at(v,new d.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.an([])}const h=this.sourceCache.getSourceTile(i,!0);if(h&&h.dem&&(!h.demTexture||h.needsTerrainPrepare)){const v=this.painter.context;h.demTexture=this.painter.getTileTexture(h.dem.stride),h.demTexture?h.demTexture.update(h.dem.getPixels(),{premultiply:!1}):h.demTexture=new at(v,h.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),h.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),h.needsTerrainPrepare=!1}const g=h&&h+h.tileID.key+i.key;if(g&&!this._demMatrixCache[g]){const v=this.sourceCache.sourceCache._source.maxzoom;let T=i.canonical.z-h.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=v?T=i.canonical.z-v:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const R=i.canonical.x-(i.canonical.x>>T<<T),O=i.canonical.y-(i.canonical.y>>T<<T),U=d.bc(new Float64Array(16),[1/(d.X<<T),1/(d.X<<T),0]);d.J(U,U,[R*d.X,O*d.X,0]),this._demMatrixCache[i.key]={matrix:U,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:h&&h.dem&&h.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:h&&h.dem&&h.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(h&&h.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:h}}getFramebuffer(i){const h=this.painter,g=h.width/devicePixelRatio,v=h.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new at(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new at(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=h.context.createFramebuffer(g,v,!0,!1),this._fbo.depthAttachment.set(h.context.createRenderbuffer(h.context.gl.DEPTH_COMPONENT16,g,v))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const h=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let T=0,R=0;T<this._coordsTextureSize;T++)for(let O=0;O<this._coordsTextureSize;O++,R+=4)h[R+0]=255&O,h[R+1]=255&T,h[R+2]=O>>8<<4|T>>8,h[R+3]=0;const g=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(h.buffer)),v=new at(i,g,i.gl.RGBA,{premultiply:!1});return v.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const h=new Uint8Array(4),g=this.painter.context,v=g.gl,T=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),R=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),O=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(T,O-R-1,1,1,v.RGBA,v.UNSIGNED_BYTE,h),g.bindFramebuffer.set(null);const U=h[0]+(h[2]>>4<<8),H=h[1]+((15&h[2])<<8),Y=this.coordsIndex[255-h[3]],X=Y&&this.sourceCache.getTileByID(Y);if(!X)return null;const le=this._coordsTextureSize,fe=(1<<X.tileID.canonical.z)*le;return new d.Z((X.tileID.canonical.x*le+U)/fe+X.tileID.wrap,(X.tileID.canonical.y*le+H)/fe,this.getElevation(X.tileID,U,H,le))}depthAtPoint(i){const h=new Uint8Array(4),g=this.painter.context,v=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,h),g.bindFramebuffer.set(null),(h[0]/16777216+h[1]/65536+h[2]/256+h[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.painter.context,h=new d.bd,g=new d.aY,v=this.meshSize,T=d.X/v,R=v*v;for(let X=0;X<=v;X++)for(let le=0;le<=v;le++)h.emplaceBack(le*T,X*T,0);for(let X=0;X<R;X+=v+1)for(let le=0;le<v;le++)g.emplaceBack(le+X,v+le+X+1,v+le+X+2),g.emplaceBack(le+X,v+le+X+2,le+X+1);const O=h.length,U=O+2*(v+1);for(const X of[0,1])for(let le=0;le<=v;le++)for(const fe of[0,1])h.emplaceBack(le*T,X*d.X,fe);for(let X=0;X<2*v;X+=2)g.emplaceBack(U+X,U+X+1,U+X+3),g.emplaceBack(U+X,U+X+3,U+X+2),g.emplaceBack(O+X,O+X+3,O+X+1),g.emplaceBack(O+X,O+X+2,O+X+3);const H=h.length,Y=H+2*(v+1);for(const X of[0,1])for(let le=0;le<=v;le++)for(const fe of[0,1])h.emplaceBack(X*d.X,le*T,fe);for(let X=0;X<2*v;X+=2)g.emplaceBack(H+X,H+X+1,H+X+3),g.emplaceBack(H+X,H+X+3,H+X+2),g.emplaceBack(Y+X,Y+X+3,Y+X+1),g.emplaceBack(Y+X,Y+X+2,Y+X+3);return this._mesh=new Lo(i.createVertexBuffer(h,yo.members),i.createIndexBuffer(g),d.a0.simpleSegment(0,0,h.length,g.length)),this._mesh}getMeshFrameDelta(i){return 2*Math.PI*d.be/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,h){var g;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(i,h);return(g=this.getMinMaxElevation(v).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(i){const h=this.getTerrainData(i).tile,g={minElevation:null,maxElevation:null};return h&&h.dem&&(g.minElevation=h.dem.min*this.exaggeration,g.maxElevation=h.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(i,h){const g=d.Z.fromLngLat(i.wrap()),v=(1<<h)*d.X,T=g.x*v,R=g.y*v,O=Math.floor(T/d.X),U=Math.floor(R/d.X);return{tileID:new d.S(h,0,h,O,U),mercatorX:T,mercatorY:R}}}class cc{constructor(i,h,g){this._context=i,this._size=h,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const h=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new at(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),h.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),h.colorAttachment.set(g.texture),{id:i,fbo:h,texture:g,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((h=>i.id!==h)),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const h of this._recentlyUsed)if(!this._objects[h].inUse)return this._objects[h];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((i=>!i.inUse))===!1}}const Qr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Za{constructor(i,h){this.painter=i,this.terrain=h,this.pool=new cc(i.context,30,h.sourceCache.tileSize*h.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,h){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter((g=>!i._layers[g].isHidden(h))),this._coordsDescendingInv={};for(const g in i.sourceCaches){this._coordsDescendingInv[g]={};const v=i.sourceCaches[g].getVisibleCoordinates();for(const T of v){const R=this.terrain.sourceCache.getTerrainCoords(T);for(const O in R)this._coordsDescendingInv[g][O]||(this._coordsDescendingInv[g][O]=[]),this._coordsDescendingInv[g][O].push(R[O])}}this._coordsDescendingInvStr={};for(const g of i._order){const v=i._layers[g],T=v.source;if(Qr[v.type]&&!this._coordsDescendingInvStr[T]){this._coordsDescendingInvStr[T]={};for(const R in this._coordsDescendingInv[T])this._coordsDescendingInvStr[T][R]=this._coordsDescendingInv[T][R].map((O=>O.key)).sort().join()}}for(const g of this._renderableTiles)for(const v in this._coordsDescendingInvStr){const T=this._coordsDescendingInvStr[v][g.tileID.key];T&&T!==g.rttCoords[v]&&(g.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;const h=i.type,g=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(Qr[h]&&(this._prevType&&Qr[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(i.id),!v))return!0;if(Qr[this._prevType]||Qr[h]&&v){this._prevType=h;const T=this._stacks.length-1,R=this._stacks[T]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(sc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[T]){const H=this.pool.getObjectForId(O.rtt[T].id);if(H.stamp===O.rtt[T].stamp){this.pool.useObject(H);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),O.rtt[T]={id:U.id,stamp:U.stamp},g.context.bindFramebuffer.set(U.fbo.framebuffer),g.context.clear({color:d.aM.transparent,stencil:0}),g.currentStencilSource=void 0;for(let H=0;H<R.length;H++){const Y=g.style._layers[R[H]],X=Y.source?this._coordsDescendingInv[Y.source][O.tileID.key]:[O.tileID];g.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),g._renderTileClippingMasks(Y,X),g.renderLayer(g,g.style.sourceCaches[Y.source],Y,X),Y.source&&(O.rttCoords[Y.source]=this._coordsDescendingInvStr[Y.source][O.tileID.key])}}return sc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Qr[h]}return!1}}const Oo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},No=A,ed={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Jr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Cu=E=>{E.touchstart=E.dragStart,E.touchmoveWindow=E.dragMove,E.touchend=E.dragEnd},qc={showCompass:!0,showZoom:!0,visualizePitch:!1};class oh{constructor(i,h,g=!1){this.mousedown=R=>{this.startMouse(d.e({},R,{ctrlKey:!0,preventDefault:()=>R.preventDefault()}),V.mousePos(this.element,R)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=R=>{this.moveMouse(R,V.mousePos(this.element,R))},this.mouseup=R=>{this.mouseRotate.dragEnd(R),this.mousePitch&&this.mousePitch.dragEnd(R),this.offTemp()},this.touchstart=R=>{R.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,R.targetTouches)[0],this.startTouch(R,this._startPos),V.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.addEventListener(window,"touchend",this.touchend))},this.touchmove=R=>{R.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,R.targetTouches)[0],this.moveTouch(R,this._lastPos))},this.touchend=R=>{R.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const v=i.dragRotate._mouseRotate.getClickTolerance(),T=i.dragRotate._mousePitch.getClickTolerance();this.element=h,this.mouseRotate=ac({clickTolerance:v,enable:!0}),this.touchRotate=(({enable:R,clickTolerance:O,bearingDegreesPerPixelMoved:U=.8})=>{const H=new $l;return new Sr({clickTolerance:O,move:(Y,X)=>({bearingDelta:(X.x-Y.x)*U}),moveStateManager:H,enable:R,assignEvents:Cu})})({clickTolerance:v,enable:!0}),this.map=i,g&&(this.mousePitch=fl({clickTolerance:T,enable:!0}),this.touchPitch=(({enable:R,clickTolerance:O,pitchDegreesPerPixelMoved:U=-.5})=>{const H=new $l;return new Sr({clickTolerance:O,move:(Y,X)=>({pitchDelta:(X.y-Y.y)*U}),moveStateManager:H,enable:R,assignEvents:Cu})})({clickTolerance:T,enable:!0})),V.addEventListener(h,"mousedown",this.mousedown),V.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(h,"touchcancel",this.reset)}startMouse(i,h){this.mouseRotate.dragStart(i,h),this.mousePitch&&this.mousePitch.dragStart(i,h),V.disableDrag()}startTouch(i,h){this.touchRotate.dragStart(i,h),this.touchPitch&&this.touchPitch.dragStart(i,h),V.disableDrag()}moveMouse(i,h){const g=this.map,{bearingDelta:v}=this.mouseRotate.dragMove(i,h)||{};if(v&&g.setBearing(g.getBearing()+v),this.mousePitch){const{pitchDelta:T}=this.mousePitch.dragMove(i,h)||{};T&&g.setPitch(g.getPitch()+T)}}moveTouch(i,h){const g=this.map,{bearingDelta:v}=this.touchRotate.dragMove(i,h)||{};if(v&&g.setBearing(g.getBearing()+v),this.touchPitch){const{pitchDelta:T}=this.touchPitch.dragMove(i,h)||{};T&&g.setPitch(g.getPitch()+T)}}off(){const i=this.element;V.removeEventListener(i,"mousedown",this.mousedown),V.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend),V.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend)}}let tr;function nn(E,i,h){const g=new d.N(E.lng,E.lat);if(E=new d.N(E.lng,E.lat),i){const v=new d.N(E.lng-360,E.lat),T=new d.N(E.lng+360,E.lat),R=h.locationPoint(E).distSqr(i);h.locationPoint(v).distSqr(i)<R?E=v:h.locationPoint(T).distSqr(i)<R&&(E=T)}for(;Math.abs(E.lng-h.center.lng)>180;){const v=h.locationPoint(E);if(v.x>=0&&v.y>=0&&v.x<=h.width&&v.y<=h.height)break;E.lng>h.center.lng?E.lng-=360:E.lng+=360}return E.lng!==g.lng&&h.locationPoint(E).y>h.height/2-h.getHorizon()?E:g}const yl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Au(E,i,h){const g=E.classList;for(const v in yl)g.remove(`maplibregl-${h}-anchor-${v}`);g.add(`maplibregl-${h}-anchor-${i}`)}class lh extends d.E{constructor(i){if(super(),this._onKeyPress=h=>{const g=h.code,v=h.charCode||h.keyCode;g!=="Space"&&g!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=h=>{const g=h.originalEvent.target,v=this._element;this._popup&&(g===v||v.contains(g))&&this.togglePopup()},this._update=h=>{var g;if(!this._map)return;const v=this._map.loaded()&&!this._map.isMoving();(h?.type==="terrain"||h?.type==="render"&&!v)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?nn(this._lngLat,this._flatPos,this._map.transform):(g=this._lngLat)===null||g===void 0?void 0:g.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let T="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?T=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(T=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let R="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?R="rotateX(0deg)":this._pitchAlignment==="map"&&(R=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||h&&h.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${yl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${R} ${T}`),N.frameAsync(new AbortController).then((()=>{this._updateOpacity(h&&h.type==="moveend")})).catch((()=>{}))},this._onMove=h=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.k("dragstart"))),this.fire(new d.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.k("dragend")),this._state="inactive"},this._addDragHandler=h=>{this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._subpixelPositioning=i&&i.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(i?.opacity,i?.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=d.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div");const h=V.createNS("http://www.w3.org/2000/svg","svg"),g=41,v=27;h.setAttributeNS(null,"display","block"),h.setAttributeNS(null,"height",`${g}px`),h.setAttributeNS(null,"width",`${v}px`),h.setAttributeNS(null,"viewBox",`0 0 ${v} ${g}`);const T=V.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const R=V.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill-rule","nonzero");const O=V.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"transform","translate(3.0, 29.0)"),O.setAttributeNS(null,"fill","#000000");const U=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ie of U){const ze=V.createNS("http://www.w3.org/2000/svg","ellipse");ze.setAttributeNS(null,"opacity","0.04"),ze.setAttributeNS(null,"cx","10.5"),ze.setAttributeNS(null,"cy","5.80029008"),ze.setAttributeNS(null,"rx",Ie.rx),ze.setAttributeNS(null,"ry",Ie.ry),O.appendChild(ze)}const H=V.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);const Y=V.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(Y);const X=V.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const le=V.createNS("http://www.w3.org/2000/svg","path");le.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild(le);const fe=V.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),fe.setAttributeNS(null,"fill","#FFFFFF");const _e=V.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ee=V.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#000000"),Ee.setAttributeNS(null,"opacity","0.25"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962");const Pe=V.createNS("http://www.w3.org/2000/svg","circle");Pe.setAttributeNS(null,"fill","#FFFFFF"),Pe.setAttributeNS(null,"cx","5.5"),Pe.setAttributeNS(null,"cy","5.5"),Pe.setAttributeNS(null,"r","5.4999962"),_e.appendChild(Ee),_e.appendChild(Pe),R.appendChild(O),R.appendChild(H),R.appendChild(X),R.appendChild(fe),R.appendChild(_e),h.appendChild(R),h.setAttributeNS(null,"height",g*this._scale+"px"),h.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(h),this._offset=d.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(h=>{h.preventDefault()})),this._element.addEventListener("mousedown",(h=>{h.preventDefault()})),Au(this._element,this._anchor,"marker"),i&&i.className)for(const h of i.className.split(" "))this._element.classList.add(h);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=d.N.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const v=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(i){return this._subpixelPositioning=i,this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var h,g;if(!(!((h=this._map)===null||h===void 0)&&h.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const v=this._map,T=v.terrain.depthAtPoint(this._pos),R=v.terrain.getElevationForLngLatZoom(this._lngLat,v.transform.tileZoom);if(v.transform.lngLatToCameraDepth(this._lngLat,R)-T<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/v.transform._pixelPerMeter,U=Math.sin(v.getPitch()*Math.PI/180)*O,H=v.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),Y=v.transform.lngLatToCameraDepth(this._lngLat,R+U)-H>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&Y&&this._popup.remove(),this._element.style.opacity=Y?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=d.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,h){return i===void 0&&h===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),h!==void 0&&(this._opacityWhenCovered=h),this._map&&this._updateOpacity(!0),this}}const rf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Mu=0,ws=!1;const Ga={maxWidth:100,unit:"metric"};function _l(E,i,h){const g=h&&h.maxWidth||100,v=E._container.clientHeight/2,T=E.unproject([0,v]),R=E.unproject([g,v]),O=T.distanceTo(R);if(h&&h.unit==="imperial"){const U=3.2808*O;U>5280?oi(i,g,U/5280,E._getUIString("ScaleControl.Miles")):oi(i,g,U,E._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?oi(i,g,O/1852,E._getUIString("ScaleControl.NauticalMiles")):O>=1e3?oi(i,g,O/1e3,E._getUIString("ScaleControl.Kilometers")):oi(i,g,O,E._getUIString("ScaleControl.Meters"))}function oi(E,i,h,g){const v=(function(T){const R=Math.pow(10,`${Math.floor(T)}`.length-1);let O=T/R;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:(function(U){const H=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*H)/H})(O),R*O})(h);E.style.width=i*(v/h)+"px",E.innerHTML=`${v}&nbsp;${g}`}const vi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xl(E){if(E){if(typeof E=="number"){const i=Math.round(Math.abs(E)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,E),"top-left":new d.P(i,i),"top-right":new d.P(-i,i),bottom:new d.P(0,-E),"bottom-left":new d.P(i,-i),"bottom-right":new d.P(-i,-i),left:new d.P(E,0),right:new d.P(-E,0)}}if(E instanceof d.P||Array.isArray(E)){const i=d.P.convert(E);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:d.P.convert(E.center||[0,0]),top:d.P.convert(E.top||[0,0]),"top-left":d.P.convert(E["top-left"]||[0,0]),"top-right":d.P.convert(E["top-right"]||[0,0]),bottom:d.P.convert(E.bottom||[0,0]),"bottom-left":d.P.convert(E["bottom-left"]||[0,0]),"bottom-right":d.P.convert(E["bottom-right"]||[0,0]),left:d.P.convert(E.left||[0,0]),right:d.P.convert(E.right||[0,0])}}return xl(new d.P(0,0))}const td=A;y.AJAXError=d.bh,y.Evented=d.E,y.LngLat=d.N,y.MercatorCoordinate=d.Z,y.Point=d.P,y.addProtocol=d.bi,y.config=d.a,y.removeProtocol=d.bj,y.AttributionControl=Do,y.BoxZoomHandler=Ls,y.CanvasSource=Ki,y.CooperativeGesturesHandler=bn,y.DoubleClickZoomHandler=Yt,y.DragPanHandler=Ws,y.DragRotateHandler=Es,y.EdgeInsets=Ca,y.FullscreenControl=class extends d.E{constructor(E={}){super(),this._onFullscreenChange=()=>{var i;let h=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=h?.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)h=h.shadowRoot.fullscreenElement;h===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,E&&E.container&&(E.container instanceof HTMLElement?this._container=E.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const E=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon",E).setAttribute("aria-hidden","true"),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=xn,y.GeolocateControl=class extends d.E{constructor(E){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new d.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{const h=new d.N(i.coords.longitude,i.coords.latitude),g=i.coords.accuracy,v=this._map.getBearing(),T=d.e({bearing:v},this.options.fitBoundsOptions),R=it.fromLngLat(h,g);this._map.fitBounds(R,T,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const h=new d.N(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&ws)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=i=>{if(this._map){if(i===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new lh({element:this._dotElement}),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.k("trackuserlocationend")),this.fire(new d.k("userlocationlostfocus")))}))}},this.options=d.e({},rf,E)}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return d._(this,arguments,void 0,(function*(i=!1){if(tr!==void 0&&!i)return tr;if(window.navigator.permissions===void 0)return tr=!!window.navigator.geolocation,tr;try{tr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{tr=!!window.navigator.geolocation}return tr}))})().then((i=>this._finishSetupUI(i))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Mu=0,ws=!1}_isOutOfMapMaxBounds(E){const i=this._map.getMaxBounds(),h=E.coords;return i&&(h.longitude<i.getWest()||h.longitude>i.getEast()||h.latitude<i.getSouth()||h.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const E=this._map.getBounds(),i=E.getSouthEast(),h=E.getNorthEast(),g=i.distanceTo(h),v=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Mu--,ws=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.k("trackuserlocationstart")),this.fire(new d.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let E;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Mu++,Mu>1?(E={maximumAge:6e5,timeout:0},ws=!0):(E=this.options.positionOptions,ws=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,E)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.Hash=Ro,y.ImageSource=es,y.KeyboardHandler=Ae,y.LngLatBounds=it,y.LogoControl=_s,y.Map=class extends lc{constructor(E){d.bf.mark(d.bg.create);const i=Object.assign(Object.assign({},ed),E);if(i.minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ul(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Oi,this._controls=[],this._mapId=d.a4(),this._contextLost=h=>{h.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.k("webglcontextlost",{originalEvent:h}))},this._contextRestored=h=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.k("webglcontextrestored",{originalEvent:h}))},this._onMapScroll=h=>{if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=i.preserveDrawingBuffer===!0,this._antialias=i.antialias===!0,this._trackResize=i.trackResize===!0,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles===!0,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=i.crossSourceCollisions===!0,this._collectResourceTiming=i.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Oo),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=i.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=oe.addThrottleControl((()=>this.isMoving())),this._requestManager=new me(i.transformRequest),typeof i.container=="string"){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let h=!1;const g=js((v=>{this._trackResize&&!this._removed&&(this.resize(v),this.redraw())}),50);this._resizeObserver=new ResizeObserver((v=>{h?g(v):h=!0})),this._resizeObserver.observe(this._container)}this.handlers=new zr(this,i),this._hash=i.hash&&new Ro(typeof i.hash=="string"&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,d.e({},i.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new Do(typeof i.attributionControl=="boolean"?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new _s,i.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(h=>{this._update(h.dataType==="style"),this.fire(new d.k(`${h.dataType}data`,h))})),this.on("dataloading",(h=>{this.fire(new d.k(`${h.dataType}dataloading`,h))})),this.on("dataabort",(h=>{this.fire(new d.k("sourcedataabort",h))}))}_getMapId(){return this._mapId}addControl(E,i){if(i===void 0&&(i=E.getDefaultPosition?E.getDefaultPosition():"top-right"),!E||!E.onAdd)return this.fire(new d.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=E.onAdd(this);this._controls.push(E);const g=this._controlPositions[i];return i.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(E){if(!E||!E.onRemove)return this.fire(new d.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(E);return i>-1&&this._controls.splice(i,1),E.onRemove(this),this}hasControl(E){return this._controls.indexOf(E)>-1}calculateCameraOptionsFromTo(E,i,h,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(h,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(E,i,h,g)}resize(E){var i;const h=this._containerDimensions(),g=h[0],v=h[1],T=this._getClampedPixelRatio(g,v);if(this._resizeCanvas(g,v,T),this.painter.resize(g,v,T),this.painter.overLimit()){const O=this.painter.context.gl;this._maxCanvasSize=[O.drawingBufferWidth,O.drawingBufferHeight];const U=this._getClampedPixelRatio(g,v);this._resizeCanvas(g,v,U),this.painter.resize(g,v,U)}this.transform.resize(g,v),(i=this._requestedCameraState)===null||i===void 0||i.resize(g,v);const R=!this._moving;return R&&(this.stop(),this.fire(new d.k("movestart",E)).fire(new d.k("move",E))),this.fire(new d.k("resize",E)),R&&this.fire(new d.k("moveend",E)),this}_getClampedPixelRatio(E,i){const{0:h,1:g}=this._maxCanvasSize,v=this.getPixelRatio(),T=E*v,R=i*v;return Math.min(T>h?h/T:1,R>g?g/R:1)*v}getPixelRatio(){var E;return(E=this._overridePixelRatio)!==null&&E!==void 0?E:devicePixelRatio}setPixelRatio(E){this._overridePixelRatio=E,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(E){return this.transform.setMaxBounds(it.convert(E)),this._update()}setMinZoom(E){if((E=E??-2)>=-2&&E<=this.transform.maxZoom)return this.transform.minZoom=E,this._update(),this.getZoom()<E&&this.setZoom(E),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(E){if((E=E??22)>=this.transform.minZoom)return this.transform.maxZoom=E,this._update(),this.getZoom()>E&&this.setZoom(E),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(E){if((E=E??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(E>=0&&E<=this.transform.maxPitch)return this.transform.minPitch=E,this._update(),this.getPitch()<E&&this.setPitch(E),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(E){if((E=E??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(E>=this.transform.minPitch)return this.transform.maxPitch=E,this._update(),this.getPitch()>E&&this.setPitch(E),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(E){return this.transform.renderWorldCopies=E,this._update()}project(E){return this.transform.locationPoint(d.N.convert(E),this.style&&this.terrain)}unproject(E){return this.transform.pointLocation(d.P.convert(E),this.terrain)}isMoving(){var E;return this._moving||((E=this.handlers)===null||E===void 0?void 0:E.isMoving())}isZooming(){var E;return this._zooming||((E=this.handlers)===null||E===void 0?void 0:E.isZooming())}isRotating(){var E;return this._rotating||((E=this.handlers)===null||E===void 0?void 0:E.isRotating())}_createDelegatedListener(E,i,h){if(E==="mouseenter"||E==="mouseover"){let g=!1;return{layers:i,listener:h,delegates:{mousemove:T=>{const R=i.filter((U=>this.getLayer(U))),O=R.length!==0?this.queryRenderedFeatures(T.point,{layers:R}):[];O.length?g||(g=!0,h.call(this,new Kn(E,this,T.originalEvent,{features:O}))):g=!1},mouseout:()=>{g=!1}}}}if(E==="mouseleave"||E==="mouseout"){let g=!1;return{layers:i,listener:h,delegates:{mousemove:R=>{const O=i.filter((U=>this.getLayer(U)));(O.length!==0?this.queryRenderedFeatures(R.point,{layers:O}):[]).length?g=!0:g&&(g=!1,h.call(this,new Kn(E,this,R.originalEvent)))},mouseout:R=>{g&&(g=!1,h.call(this,new Kn(E,this,R.originalEvent)))}}}}{const g=v=>{const T=i.filter((O=>this.getLayer(O))),R=T.length!==0?this.queryRenderedFeatures(v.point,{layers:T}):[];R.length&&(v.features=R,h.call(this,v),delete v.features)};return{layers:i,listener:h,delegates:{[E]:g}}}}_saveDelegatedListener(E,i){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[E]=this._delegatedListeners[E]||[],this._delegatedListeners[E].push(i)}_removeDelegatedListener(E,i,h){if(!this._delegatedListeners||!this._delegatedListeners[E])return;const g=this._delegatedListeners[E];for(let v=0;v<g.length;v++){const T=g[v];if(T.listener===h&&T.layers.length===i.length&&T.layers.every((R=>i.includes(R)))){for(const R in T.delegates)this.off(R,T.delegates[R]);return void g.splice(v,1)}}}on(E,i,h){if(h===void 0)return super.on(E,i);const g=this._createDelegatedListener(E,typeof i=="string"?[i]:i,h);this._saveDelegatedListener(E,g);for(const v in g.delegates)this.on(v,g.delegates[v]);return this}once(E,i,h){if(h===void 0)return super.once(E,i);const g=typeof i=="string"?[i]:i,v=this._createDelegatedListener(E,g,h);for(const T in v.delegates){const R=v.delegates[T];v.delegates[T]=(...O)=>{this._removeDelegatedListener(E,g,h),R(...O)}}this._saveDelegatedListener(E,v);for(const T in v.delegates)this.once(T,v.delegates[T]);return this}off(E,i,h){return h===void 0?super.off(E,i):(this._removeDelegatedListener(E,typeof i=="string"?[i]:i,h),this)}queryRenderedFeatures(E,i){if(!this.style)return[];let h;const g=E instanceof d.P||Array.isArray(E),v=g?E:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(g?{}:E)||{},v instanceof d.P||typeof v[0]=="number")h=[d.P.convert(v)];else{const T=d.P.convert(v[0]),R=d.P.convert(v[1]);h=[T,new d.P(R.x,T.y),R,new d.P(T.x,R.y),T]}return this.style.queryRenderedFeatures(h,i,this.transform)}querySourceFeatures(E,i){return this.style.querySourceFeatures(E,i)}setStyle(E,i){return(i=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&E?(this._diffStyle(E,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(E,i))}setTransformRequest(E){return this._requestManager.setTransformRequest(E),this}_getUIString(E){const i=this._locale[E];if(i==null)throw new Error(`Missing UI string '${E}'`);return i}_updateStyle(E,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(E,i)));const h=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!E)),E?(this.style=new Wo(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof E=="string"?this.style.loadURL(E,i,h):this.style.loadJSON(E,i,h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Wo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(E,i){if(typeof E=="string"){const h=this._requestManager.transformRequest(E,"Style");d.h(h,new AbortController).then((g=>{this._updateDiff(g.data,i)})).catch((g=>{g&&this.fire(new d.j(g))}))}else typeof E=="object"&&this._updateDiff(E,i)}_updateDiff(E,i){try{this.style.setState(E,i)&&this._update(!0)}catch(h){d.w(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(E,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(E,i){return this._lazyInitEmptyStyle(),this.style.addSource(E,i),this._update(!0)}isSourceLoaded(E){const i=this.style&&this.style.sourceCaches[E];if(i!==void 0)return i.loaded();this.fire(new d.j(new Error(`There is no source with ID '${E}'`)))}setTerrain(E){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),E){const i=this.style.sourceCaches[E.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${E.source}`);this.terrain===null&&i.reload();for(const h in this.style._layers){const g=this.style._layers[h];g.type==="hillshade"&&g.source===E.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new gl(this.painter,i,E),this.painter.renderToTexture=new Za(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=h=>{h.dataType==="style"?this.terrain.sourceCache.freeRtt():h.dataType==="source"&&h.tile&&(h.sourceId!==E.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(h.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new d.k("terrain",{terrain:E})),this}getTerrain(){var E,i;return(i=(E=this.terrain)===null||E===void 0?void 0:E.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const E=this.style&&this.style.sourceCaches;for(const i in E){const h=E[i]._tiles;for(const g in h){const v=h[g];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(E){return this.style.removeSource(E),this._update(!0)}getSource(E){return this.style.getSource(E)}addImage(E,i,h={}){const{pixelRatio:g=1,sdf:v=!1,stretchX:T,stretchY:R,content:O,textFitWidth:U,textFitHeight:H}=h;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||d.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Y,height:X,data:le}=i,fe=i;return this.style.addImage(E,{data:new d.R({width:Y,height:X},new Uint8Array(le)),pixelRatio:g,stretchX:T,stretchY:R,content:O,textFitWidth:U,textFitHeight:H,sdf:v,version:0,userImage:fe}),fe.onAdd&&fe.onAdd(this,E),this}}{const{width:Y,height:X,data:le}=N.getImageData(i);this.style.addImage(E,{data:new d.R({width:Y,height:X},le),pixelRatio:g,stretchX:T,stretchY:R,content:O,textFitWidth:U,textFitHeight:H,sdf:v,version:0})}}updateImage(E,i){const h=this.style.getImage(E);if(!h)return this.fire(new d.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=i instanceof HTMLImageElement||d.b(i)?N.getImageData(i):i,{width:v,height:T,data:R}=g;if(v===void 0||T===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==h.data.width||T!==h.data.height)return this.fire(new d.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const O=!(i instanceof HTMLImageElement||d.b(i));return h.data.replace(R,O),this.style.updateImage(E,h),this}getImage(E){return this.style.getImage(E)}hasImage(E){return E?!!this.style.getImage(E):(this.fire(new d.j(new Error("Missing required image id"))),!1)}removeImage(E){this.style.removeImage(E)}loadImage(E){return oe.getImage(this._requestManager.transformRequest(E,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(E,i){return this._lazyInitEmptyStyle(),this.style.addLayer(E,i),this._update(!0)}moveLayer(E,i){return this.style.moveLayer(E,i),this._update(!0)}removeLayer(E){return this.style.removeLayer(E),this._update(!0)}getLayer(E){return this.style.getLayer(E)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(E,i,h){return this.style.setLayerZoomRange(E,i,h),this._update(!0)}setFilter(E,i,h={}){return this.style.setFilter(E,i,h),this._update(!0)}getFilter(E){return this.style.getFilter(E)}setPaintProperty(E,i,h,g={}){return this.style.setPaintProperty(E,i,h,g),this._update(!0)}getPaintProperty(E,i){return this.style.getPaintProperty(E,i)}setLayoutProperty(E,i,h,g={}){return this.style.setLayoutProperty(E,i,h,g),this._update(!0)}getLayoutProperty(E,i){return this.style.getLayoutProperty(E,i)}setGlyphs(E,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(E,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(E,i,h={}){return this._lazyInitEmptyStyle(),this.style.addSprite(E,i,h,(g=>{g||this._update(!0)})),this}removeSprite(E){return this._lazyInitEmptyStyle(),this.style.removeSprite(E),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(E,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(E,i,(h=>{h||this._update(!0)})),this}setLight(E,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(E,i),this._update(!0)}getLight(){return this.style.getLight()}setSky(E){return this._lazyInitEmptyStyle(),this.style.setSky(E),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(E,i){return this.style.setFeatureState(E,i),this._update()}removeFeatureState(E,i){return this.style.removeFeatureState(E,i),this._update()}getFeatureState(E){return this.style.getFeatureState(E)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let E=0,i=0;return this._container&&(E=this._container.clientWidth||400,i=this._container.clientHeight||300),[E,i]}_setupContainer(){const E=this._container;E.classList.add("maplibregl-map");const i=this._canvasContainer=V.create("div","maplibregl-canvas-container",E);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const h=this._containerDimensions(),g=this._getClampedPixelRatio(h[0],h[1]);this._resizeCanvas(h[0],h[1],g);const v=this._controlContainer=V.create("div","maplibregl-control-container",E),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((R=>{T[R]=V.create("div",`maplibregl-ctrl-${R} `,v)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(E,i,h){this._canvas.width=Math.floor(h*E),this._canvas.height=Math.floor(h*i),this._canvas.style.width=`${E}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const E={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let i=null;this._canvas.addEventListener("webglcontextcreationerror",(g=>{i={requestedAttributes:E},g&&(i.statusMessage=g.statusMessage,i.type=g.type)}),{once:!0});const h=this._canvas.getContext("webgl2",E)||this._canvas.getContext("webgl",E);if(!h){const g="Failed to initialize WebGL";throw i?(i.message=g,new Error(JSON.stringify(i))):new Error(g)}this.painter=new mo(h,this.transform),K.testSupport(h)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(E){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||E,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(E){return this._update(),this._renderTaskQueue.add(E)}_cancelRenderFrame(E){this._renderTaskQueue.remove(E)}_render(E){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(E),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,T=N.now();this.style.zoomHistory.update(v,T);const R=new d.z(v,{now:T,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),O=R.crossFadingFactor();O===1&&O===this._crossFadingFactor||(h=!0,this._crossFadingFactor=O),this.style.update(R)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new d.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.bf.mark(d.bg.load),this.fire(new d.k("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.k("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,d.bf.mark(d.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var E;this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),oe.removeThrottleControl(this._imageQueueHandle),(E=this._resizeObserver)===null||E===void 0||E.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i?.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),d.bf.clearMetrics(),this._removed=!0,this.fire(new d.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then((E=>{d.bf.frame(E),this._frameRequest=null,this._render(E)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(E){this._showTileBoundaries!==E&&(this._showTileBoundaries=E,this._update())}get showPadding(){return!!this._showPadding}set showPadding(E){this._showPadding!==E&&(this._showPadding=E,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(E){this._showCollisionBoxes!==E&&(this._showCollisionBoxes=E,E?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(E){this._showOverdrawInspector!==E&&(this._showOverdrawInspector=E,this._update())}get repaint(){return!!this._repaint}set repaint(E){this._repaint!==E&&(this._repaint=E,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(E){this._vertices=E,this._update()}get version(){return No}getCameraTargetElevation(){return this.transform.elevation}},y.MapMouseEvent=Kn,y.MapTouchEvent=Aa,y.MapWheelEvent=Yr,y.Marker=lh,y.NavigationControl=class{constructor(E){this._updateZoomButtons=()=>{const i=this._map.getZoom(),h=i===this._map.getMaxZoom(),g=i===this._map.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,h)=>{const g=this._map._getUIString(`NavigationControl.${h}`);i.title=g,i.setAttribute("aria-label",g)},this.options=d.e({},qc,E),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(i=>this._map.zoomIn({},{originalEvent:i}))),V.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(i=>this._map.zoomOut({},{originalEvent:i}))),V.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})})),this._compassIcon=V.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new oh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(E,i){const h=V.create("button",E,this._container);return h.type="button",h.addEventListener("click",i),h}},y.Popup=class extends d.E{constructor(E){super(),this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.k("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{var h;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create("div","maplibregl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const O of this.options.className.split(" "))this._container.classList.add(O);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?nn(this._lngLat,this._flatPos,this._map.transform):(h=this._lngLat)===null||h===void 0?void 0:h.wrap(),this._trackPointer&&!i)return;const g=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationPoint(this._lngLat));let v=this.options.anchor;const T=xl(this.options.offset);if(!v){const O=this._container.offsetWidth,U=this._container.offsetHeight;let H;H=g.y+T.bottom.y<U?["top"]:g.y>this._map.transform.height-U?["bottom"]:[],g.x<O/2?H.push("left"):g.x>this._map.transform.width-O/2&&H.push("right"),v=H.length===0?"bottom":H.join("-")}let R=g.add(T[v]);this.options.subpixelPositioning||(R=R.round()),V.setTransform(this._container,`${yl[v]} translate(${R.x}px,${R.y}px)`),Au(this._container,v,"popup")},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(vi),E)}addTo(E){return this._map&&this.remove(),this._map=E,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(E){return this._lngLat=d.N.convert(E),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(E){return this.setDOMContent(document.createTextNode(E))}setHTML(E){const i=document.createDocumentFragment(),h=document.createElement("body");let g;for(h.innerHTML=E;g=h.firstChild,g;)i.appendChild(g);return this.setDOMContent(i)}getMaxWidth(){var E;return(E=this._container)===null||E===void 0?void 0:E.style.maxWidth}setMaxWidth(E){return this.options.maxWidth=E,this._update(),this}setDOMContent(E){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(E),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(E){return this._container&&this._container.classList.add(E),this}removeClassName(E){return this._container&&this._container.classList.remove(E),this}setOffset(E){return this.options.offset=E,this._update(),this}toggleClassName(E){if(this._container)return this._container.classList.toggle(E)}setSubpixelPositioning(E){this.options.subpixelPositioning=E}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const E=this._container.querySelector(vl);E&&E.focus()}},y.RasterDEMTileSource=fi,y.RasterTileSource=wi,y.ScaleControl=class{constructor(E){this._onMove=()=>{_l(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,_l(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ga),E)}getDefaultPosition(){return"bottom-left"}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=wt,y.Style=Wo,y.TerrainControl=class{constructor(E){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=E}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=Z,y.TwoFingersTouchRotateHandler=M,y.TwoFingersTouchZoomHandler=u,y.TwoFingersTouchZoomRotateHandler=Tr,y.VectorTileSource=qn,y.VideoSource=Xi,y.addSourceType=(E,i)=>d._(void 0,void 0,void 0,(function*(){if(gs(E))throw new Error(`A source type called "${E}" already exists.`);((h,g)=>{Wi[h]=g})(E,i)})),y.clearPrewarmedResources=function(){const E=It;E&&(E.isPreloaded()&&E.numActive()===1?(E.release(ot),It=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return Tn().getRTLTextPluginStatus()},y.getVersion=function(){return td},y.getWorkerCount=function(){return _t.workerCount},y.getWorkerUrl=function(){return d.a.WORKER_URL},y.importScriptInWorkers=function(E){return Mi().broadcast("IS",E)},y.prewarm=function(){li().acquire(ot)},y.setMaxParallelImageRequests=function(E){d.a.MAX_PARALLEL_IMAGE_REQUESTS=E},y.setRTLTextPlugin=function(E,i){return Tn().setRTLTextPlugin(E,i)},y.setWorkerCount=function(E){_t.workerCount=E},y.setWorkerUrl=function(E){d.a.WORKER_URL=E}}));var _=s;return _}))})(My)),My.exports}var iz=f2();const uw=Kh(iz);var Py={exports:{}},nz=Py.exports,hw;function sz(){return hw||(hw=1,(function(t,e){(function(s,l){t.exports=l(a2(),f2())})(typeof globalThis<"u"?globalThis:nz||self,function(s,l){s.MaplibreGL=s.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(f){s.setOptions(this,f),this._throttledUpdate=s.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(f){this._container||this._initContainer();var _=this.getPaneName();f.getPane(_).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),f.options.zoomAnimation&&s.DomEvent.on(f._proxy,s.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(f){this._map._proxy&&this._map.options.zoomAnimation&&s.DomEvent.off(this._map._proxy,s.DomUtil.TRANSITION_END,this._transitionEnd,this);var _=this.getPaneName();f.getPane(_).removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getAttribution:function(){if(this.options.attributionControl)return this.options.attributionControl.customAttribution;var f=this._glMap;if(f&&this.options.attributionControl!==!1){var _=f.getStyle();if(_&&_.sources)return Object.keys(_.sources).map(function(y){var d=f.getSource(y);return d&&typeof d.attribution=="string"?d.attribution.trim():null}).filter(Boolean).join(", ")}return""},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){var f=this.getSize().multiplyBy(.5),_=this._map.latLngToContainerPoint(this._map.getCenter());return s.latLngBounds(this._map.containerPointToLatLng(_.subtract(f)),this._map.containerPointToLatLng(_.add(f)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_roundPoint:function(f){return{x:Math.round(f.x),y:Math.round(f.y)}},_initContainer:function(){var f=this._container=s.DomUtil.create("div","leaflet-gl-layer");this._resizeContainer();var _=this._map.getSize().multiplyBy(this.options.padding),y=this._map.containerPointToLayerPoint([0,0]).subtract(_);s.DomUtil.setPosition(f,this._roundPoint(y))},_resizeContainer:function(){var f=this.getSize();this._container.style.width=f.x+"px",this._container.style.height=f.y+"px"},_initGL:function(){var f=this._map.getCenter(),_=s.extend({},this.options,{container:this._container,center:[f.lng,f.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new l.Map(_);var y=this._map,d=this.getAttribution(),A=this.getAttribution.bind(this);this._glMap.on("load",function(){y&&y.attributionControl&&(y.attributionControl.removeAttribution(d),y.attributionControl.addAttribution(A()))});var I=Object.getPrototypeOf(this._glMap.transform),B=Object.getOwnPropertyDescriptor(I,"latRange");(!B||B.set||B.writable)&&(this._glMap.transform.latRange=null);var N=Object.getOwnPropertyDescriptor(I,"maxValidLatitude");(!N||N.set||N.writable)&&(this._glMap.transform.maxValidLatitude=1/0),this._glMap.transform._helper&&this._glMap.transform._helper._latRange&&(this._glMap.transform._helper._latRange=[-1/0,1/0]),this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;var V=this._glMap._actualCanvas;s.DomUtil.addClass(V,"leaflet-image-layer"),s.DomUtil.addClass(V,"leaflet-zoom-animated"),this.options.interactive&&s.DomUtil.addClass(V,"leaflet-interactive"),this.options.className&&s.DomUtil.addClass(V,this.options.className)},_update:function(f){if(this._map&&(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming)){var _=this._container,y=this._glMap,d=this._map.getSize().multiplyBy(this.options.padding),A=this._map.containerPointToLayerPoint([0,0]).subtract(d);s.DomUtil.setPosition(_,this._roundPoint(A)),this._transformGL(y)}},_transformGL:function(f){var _=this._map.getCenter(),y=f._getTransformForUpdate();y.setCenter?(y.setCenter(l.LngLat.convert([_.lng,_.lat])),y.setZoom(this._map.getZoom()-1),f.transform.apply(y)):(y=f.transform,y.center=l.LngLat.convert([_.lng,_.lat]),y.zoom=this._map.getZoom()-1),f._fireMoveEvents()},_pinchZoom:function(f){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(f){var _=this._map.getZoomScale(f.zoom),y=this._map.getSize().multiplyBy(this.options.padding*_),d=this.getSize()._divideBy(2),A=this._map.project(f.center,f.zoom)._subtract(d)._add(this._map._getMapPanePos().add(y))._round(),I=this._map.project(this._map.getBounds().getNorthWest(),f.zoom)._subtract(A);s.DomUtil.setTransform(this._glMap._actualCanvas,I.subtract(this._offset),_)},_zoomStart:function(f){this._zooming=!0},_zoomEnd:function(){var f=this._map.getZoomScale(this._map.getZoom());s.DomUtil.setTransform(this._glMap._actualCanvas,null,f),this._zooming=!1,this._update()},_transitionEnd:function(f){s.Util.requestAnimFrame(function(){var _=this._map.getZoom(),y=this._map.getCenter(),d=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());this._resizeContainer(),s.DomUtil.setTransform(this._glMap._actualCanvas,d,1),this._glMap.once("moveend",s.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:y,zoom:_-1})},this)},_resize:function(f){this._transitionEnd(f)}}),s.maplibreGL=function(f){return new s.MaplibreGL(f)}})})(Py)),Py.exports}sz();const rz={},az=rz?.VITE_MAP_STYLE_URL||"https://tiles.openfreemap.org/styles/liberty/style.json",oz="Leaflet | OpenFreeMap  OpenMapTiles Data from OpenStreetMap",lz="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",cz="&copy; OpenStreetMap contributors",p2=({styleUrl:t,attribution:e})=>{const s=gp();return Q.useEffect(()=>{const l=Xh.maplibreGL;window.maplibregl=uw;let f=null,_=null,y=null;const d=()=>{_&&(s.removeLayer(_),_=null),!f&&(f=Xh.tileLayer(lz,{attribution:cz}),f.addTo(s))};if(!l){console.warn("MapLibre GL Leaflet plugin is not available."),d();return}let A=null;try{_=l({style:t||az,attribution:e||oz,maplibreGL:uw}),_.addTo(s),y=_.getMapboxMap?.()||_.getMaplibreMap?.(),y&&(s._maplibreMap=y),A=()=>y?.resize?.(),y?.on&&(y.on("error",d),y.on("load",A))}catch(I){console.warn("MapLibre GL failed, falling back to raster.",I),d()}return()=>{y?.off&&(y.off("error",d),A&&y.off("load",A)),_&&s.removeLayer(_),f&&s.removeLayer(f)}},[s,t,e]),null},vy=t=>{if(typeof t=="string"){const e=Number(t);return Number.isNaN(e)?null:e}return t},dw=(t,e,s,l=!1)=>{const f=s?encodeURI(s).replace(/'/g,"%27"):"",_=s?`<div class="map-pin-avatar" style="background-image:url('${f}')"></div>`:'<div class="map-pin-avatar map-pin-avatar--empty"></div>',y=`
    <div class="map-pin map-pin--${t} ${l?"map-pin--active":""}" style="pointer-events:auto;">
      ${_}
      <span class="map-pin-label">${e}</span>
    </div>
  `;return Xh.divIcon({className:"leaflet-div-icon leaflet-interactive map-pin-wrapper",html:y,iconSize:l?[56,64]:[52,60],iconAnchor:[26,60],popupAnchor:[0,-54]})},uz=t=>t.event_artists?.find(e=>e.artist?.avatar_url)?.artist?.avatar_url||null,hz=({events:t,venues:e,showVenues:s,onSelectEvent:l,onSelectVenue:f,activeSelection:_})=>S.jsxs(S.Fragment,{children:[t.map(y=>{const d=vy(y.latitude??y.venue_place?.latitude??null),A=vy(y.longitude??y.venue_place?.longitude??null);if(d===null||A===null)return null;const I=uz(y),B=y.is_free!==!1,N=B?"GRATIS":"PAGO",V=_?.type==="event"&&_.id===y.id,K=dw(B?"free":"paid",N,I,V);return S.jsx(t_,{position:[d,A],icon:K,pane:"markerPane",interactive:!0,bubblingMouseEvents:!1,zIndexOffset:V?200:0,eventHandlers:{click:()=>l(y.id)}},y.id)}),s&&e.map(y=>{const d=vy(y.latitude??null),A=vy(y.longitude??null);if(d===null||A===null)return null;const I=y.photos?.[0]||null,B=_?.type==="venue"&&_.id===y.id,N=dw("venue","SALA",I,B);return S.jsx(t_,{position:[d,A],icon:N,pane:"markerPane",interactive:!0,bubblingMouseEvents:!1,zIndexOffset:B?200:0,eventHandlers:{click:()=>f(y.id)}},y.id)})]}),dz=({filterToday:t,filterTomorrow:e,filterFree:s,showEvents:l,onToggleToday:f,onToggleTomorrow:_,onToggleFree:y,onToggleEvents:d,onOpenFilters:A})=>{const I="inline-flex items-center justify-center whitespace-nowrap rounded-xl bg-white/15 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] transition-colors hover:bg-white/20",B="text-white/85",N="bg-white/20 text-app-accent";return S.jsxs("div",{className:"flex flex-wrap gap-2 overflow-x-auto pb-1",children:[S.jsx("button",{type:"button",className:`${I} ${l?N:B}`,onClick:d,children:"Events"}),S.jsx("button",{type:"button",className:`${I} ${t?N:B}`,onClick:f,children:"Today"}),S.jsx("button",{type:"button",className:`${I} ${e?N:B}`,onClick:_,children:"Tomorrow"}),S.jsx("button",{type:"button",className:`${I} ${s?N:B}`,onClick:y,children:"Free"}),S.jsx("button",{type:"button",className:`${I} ${B}`,onClick:A,children:"Filters"})]})},fz=({isOpen:t,onDismiss:e,filterGenres:s,onGenresChange:l,priceMin:f,priceMax:_,onPriceMinChange:y,onPriceMaxChange:d,filterDayPart:A,onDayPartChange:I,filterBandOnly:B,onToggleBand:N,selectedArtists:V,onAddArtist:K,onRemoveArtist:se,autoFocusArtist:ne=!1,filterGoing:ve,filterAttended:re,onToggleGoing:ge,onToggleAttended:oe,onClear:me,disableAttendance:ye,filterDate:ke,onDateChange:Re,showVenues:Ge,onToggleVenues:He})=>{const[Xe,at]=Nt.useState(""),[et,Et]=Nt.useState([]),[gt,pt]=Nt.useState(!1),$e=Nt.useRef(null);Nt.useEffect(()=>{t&&ne&&$e.current&&$e.current.focus()},[t,ne]);const ct=async()=>{const We=Xe.trim();if(!We){Et([]);return}try{pt(!0);const{data:Tt}=await Pt.from("artists").select("id, name, avatar_url, artist_type").ilike("name",`%${We}%`).order("name",{ascending:!0}).limit(6);Et((Tt||[]).map(lt=>({id:lt.id,name:lt.name,avatar_url:lt.avatar_url??null})))}finally{pt(!1)}};return Nt.useEffect(()=>{if(!Xe.trim()){Et([]);return}const We=window.setTimeout(()=>ct(),350);return()=>window.clearTimeout(We)},[Xe]),S.jsx(c_,{isOpen:t,onDidDismiss:e,children:S.jsx(Ql,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Filters"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:e,children:"Close"})]}),S.jsxs("div",{className:"mt-6 space-y-6",children:[S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Show"}),S.jsxs("label",{className:"flex items-center justify-between gap-3 text-sm text-white/80",children:[S.jsx("span",{className:"flex items-center gap-2",children:"Venues"}),S.jsxs("span",{className:"relative inline-flex h-6 w-11 items-center",children:[S.jsx("input",{type:"checkbox",className:"peer sr-only",checked:Ge,onChange:We=>He(We.target.checked)}),S.jsx("span",{className:"h-full w-full rounded-full bg-white/10 transition peer-checked:bg-[#ff6b4a]/80"}),S.jsx("span",{className:"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]})]})]}),S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"When"}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsx("button",{type:"button",className:`bg-white/10 px-3 py-2 text-sm font-semibold ${A==="day"?"text-app-accent":"text-white/75"}`,onClick:()=>I(A==="day"?"":"day"),children:"Day"}),S.jsx("button",{type:"button",className:`bg-white/10 px-3 py-2 text-sm font-semibold ${A==="night"?"text-app-accent":"text-white/75"}`,onClick:()=>I(A==="night"?"":"night"),children:"Night"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsxs("label",{className:"flex items-center gap-2 text-sm text-white/80",children:[S.jsx("input",{type:"checkbox",checked:ve,onChange:We=>ge(We.target.checked),disabled:ye,className:"accent-[#ff6b4a]"}),S.jsx("span",{children:"Going"})]}),S.jsxs("label",{className:"flex items-center gap-2 text-sm text-white/80",children:[S.jsx("input",{type:"checkbox",checked:re,onChange:We=>oe(We.target.checked),disabled:ye,className:"accent-[#ff6b4a]"}),S.jsx("span",{children:"Attended"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Specific date"}),S.jsx("input",{type:"date",value:ke,onChange:We=>Re(We.target.value),className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none"})]})]}),S.jsxs("div",{className:"space-y-4 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Lineup"}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Genres (comma)"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:s,onChange:We=>l(We.target.value),placeholder:"Jazz, Rock"})]}),S.jsxs("label",{className:"flex items-center justify-between gap-3 text-sm text-white/80",children:[S.jsx("span",{className:"flex items-center gap-2",children:"Band only"}),S.jsxs("span",{className:"relative inline-flex h-6 w-11 items-center",children:[S.jsx("input",{type:"checkbox",className:"peer sr-only",checked:B,onChange:We=>N(We.target.checked)}),S.jsx("span",{className:"h-full w-full rounded-full bg-white/10 transition peer-checked:bg-[#ff6b4a]/80"}),S.jsx("span",{className:"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("input",{className:"flex-1 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/40 focus:outline-none",value:Xe,onChange:We=>at(We.target.value),ref:$e,placeholder:"Search artist",onKeyDown:We=>{We.key==="Enter"&&(We.preventDefault(),ct())}}),S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] text-white",onClick:ct,disabled:gt,children:gt?"Searching":"Search"})]}),et.length>0&&S.jsxs("div",{className:"bg-white/5 p-3 text-sm text-white",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Results"}),S.jsx("div",{className:"mt-2 space-y-2",children:et.map(We=>S.jsxs("button",{type:"button",className:"flex w-full items-center gap-3 bg-white/5 px-3 py-2 text-left hover:bg-white/10",onClick:()=>{K(We),at(""),Et([])},children:[S.jsx("div",{className:"h-8 w-8 overflow-hidden rounded-full bg-white/10",children:We.avatar_url?S.jsx("img",{src:We.avatar_url,alt:We.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-full w-full items-center justify-center text-[10px] text-white/60",children:"A"})}),S.jsx("span",{children:We.name})]},We.id))})]}),V.length>0&&S.jsxs("div",{className:"bg-white/5 p-3 text-sm text-white",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Active"}),S.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:V.map(We=>S.jsxs("span",{className:"inline-flex items-center gap-2 bg-white/10 px-3 py-1 text-xs",children:[We.name,S.jsx("button",{type:"button",className:"text-white/70 hover:text-white",onClick:()=>se(We.id),children:""})]},We.id))})]})]})]}),S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Price"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Min"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:f,onChange:We=>y(We.target.value),placeholder:"0"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Max"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:_,onChange:We=>d(We.target.value),placeholder:"50"})]})]})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:me,children:"Clear filters"})]})]})})})},pz=({activeItem:t,events:e,venues:s,onTouchStart:l,onTouchEnd:f,onFollowEvent:_,onSetAttendance:y,followedEventIds:d,attendanceStatusByEventId:A,followPendingEventIds:I,attendancePendingEventIds:B})=>{const N=dS(),[V,K]=Q.useState(!1),[se,ne]=Q.useState(!1),ve=Q.useRef(null),re=Q.useRef(null);Q.useEffect(()=>()=>{ve.current&&window.clearTimeout(ve.current),re.current&&window.clearTimeout(re.current)},[]);const ge=He=>{if(He==="follow"){K(!1),ve.current&&window.clearTimeout(ve.current),window.requestAnimationFrame(()=>{K(!0),ve.current=window.setTimeout(()=>K(!1),420)});return}ne(!1),re.current&&window.clearTimeout(re.current),window.requestAnimationFrame(()=>{ne(!0),re.current=window.setTimeout(()=>ne(!1),420)})},oe="relative inline-flex w-full items-center justify-center gap-2 overflow-hidden rounded-full border px-3 py-2 text-[11px] font-bold uppercase tracking-[0.16em] text-white/90 backdrop-blur-md transition-all duration-200 hover:border-white/40 hover:text-white disabled:cursor-not-allowed disabled:opacity-60 motion-reduce:transition-none",me="border-white/25 bg-[linear-gradient(145deg,rgba(3,6,12,0.78),rgba(9,15,26,0.86))]",ye="border-[#ff6b4a]/80 bg-[linear-gradient(140deg,rgba(255,107,74,0.3),rgba(255,107,74,0.16)_65%,rgba(13,18,30,0.88))] text-white shadow-[0_0_0_1px_rgba(255,107,74,0.24),0_10px_22px_rgba(0,0,0,0.28)]",ke="border-[#25d47b]/80 bg-[linear-gradient(140deg,rgba(37,212,123,0.28),rgba(37,212,123,0.14)_65%,rgba(13,18,30,0.88))] text-white shadow-[0_0_0_1px_rgba(37,212,123,0.24),0_10px_22px_rgba(0,0,0,0.28)]",Re="border-[#f3bf4a]/80 bg-[linear-gradient(140deg,rgba(243,191,74,0.26),rgba(243,191,74,0.13)_65%,rgba(13,18,30,0.88))] text-white shadow-[0_0_0_1px_rgba(243,191,74,0.25),0_10px_22px_rgba(0,0,0,0.28)]";if(!t)return null;const Ge=()=>{if(t.type==="event"){const Xe=e.find(Ce=>Ce.id===t.id);if(!Xe)return null;const at=(Xe.event_artists||[]).map(Ce=>Ce.artist?.name).filter(Boolean).join(", "),et=new Date(Xe.starts_at),Et=Xe.ends_at?new Date(Xe.ends_at):new Date(et.getTime()+360*60*1e3),gt=Date.now()>Et.getTime(),pt=gt?"Went":"Going",$e=gt?"attended":"going",ct=d?.has(Xe.id)??!1,Tt=(A?.[Xe.id]||null)===$e,lt=I?.has(Xe.id)??!1,xe=B?.has(Xe.id)??!1;return S.jsxs("div",{className:"flex gap-4",children:[S.jsx("div",{className:"relative flex-shrink-0",children:Xe.cover_image_url?S.jsx("img",{src:Xe.cover_image_url,alt:Xe.name,className:"h-80 w-48 rounded-xl object-cover"}):S.jsx("div",{className:"h-80 w-48 rounded-xl bg-white/10"})}),S.jsxs("div",{className:"flex min-w-0 flex-1 flex-col",children:[S.jsxs("div",{className:"flex min-w-0 flex-1 flex-col justify-center cursor-pointer transition-opacity hover:opacity-80",onClick:()=>N.push(`/event/${Xe.id}`,"forward"),children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Event"}),S.jsx("h3",{className:"mt-2 font-display text-2xl font-bold text-white leading-tight",children:Xe.name}),Xe.venue_place?.name&&S.jsx("p",{className:"mt-1 text-sm font-medium text-white/80",children:Xe.venue_place.name}),S.jsx("p",{className:"mt-1 text-sm text-white/70",children:Xe.venue_place?.city||Xe.city}),at&&S.jsx("p",{className:"mt-2 text-sm text-white/55",children:at}),S.jsx("p",{className:"mt-3 text-sm text-white/55",children:new Date(Xe.starts_at).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),S.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[S.jsxs("button",{type:"button",className:`${oe} ${ct?ye:me} ${V?"scale-[1.02]":""}`,"aria-label":"Follow event",disabled:lt,onClick:Ce=>{Ce.stopPropagation(),ge("follow"),_?.(Xe.id)},children:[S.jsx("span",{className:`pointer-events-none absolute inset-0 rounded-full border border-current ${V?"animate-ping opacity-40 motion-reduce:animate-none":"opacity-0"}`}),S.jsx("span",{className:`inline-flex items-center justify-center ${V?"animate-pulse motion-reduce:animate-none":""}`,children:S.jsx(kS,{className:"h-[19px] w-[19px]"})}),S.jsx("span",{children:"Follow"})]}),S.jsxs("button",{type:"button",className:`${oe} ${Tt?gt?Re:ke:me} ${se?"scale-[1.02]":""}`,"aria-label":pt,disabled:xe,onClick:Ce=>{Ce.stopPropagation(),ge("attendance"),y?.(Xe.id,$e)},children:[S.jsx("span",{className:`pointer-events-none absolute inset-0 rounded-full border border-current ${se?"animate-ping opacity-40 motion-reduce:animate-none":"opacity-0"}`}),S.jsx("span",{className:`inline-flex items-center justify-center ${se?"animate-pulse motion-reduce:animate-none":""}`,children:S.jsx(CS,{className:"h-[19px] w-[19px]"})}),S.jsx("span",{children:pt})]})]})]})]})}const He=s.find(Xe=>Xe.id===t.id);return He?S.jsxs("div",{className:"cursor-pointer transition-opacity hover:opacity-80",onClick:()=>N.push(`/venue/${He.id}`,"forward"),children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venue"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:He.name}),S.jsx("p",{className:"text-sm text-white/70",children:He.city}),S.jsx("p",{className:"mt-2 text-xs font-medium text-white/40",children:"Tap to view venue details"})]}):null};return S.jsxs("div",{className:"fixed inset-x-0 bottom-0 z-[1100] max-h-[60vh] rounded-t-3xl bg-black/92 p-4",onTouchStart:l,onTouchEnd:f,children:[S.jsx("div",{className:"mb-3 flex items-center justify-center",children:S.jsx("div",{className:"h-1 w-12 rounded-full bg-white/20"})}),Ge()]})},mz=({events:t,venues:e,userId:s})=>{const[l,f]=Q.useState(""),[_,y]=Q.useState(!0),[d,A]=Q.useState(!1),[I,B]=Q.useState(!0),[N,V]=Q.useState(!0),[K,se]=Q.useState(!1),[ne,ve]=Q.useState(!1),[re,ge]=Q.useState(""),[oe,me]=Q.useState(!1),[ye,ke]=Q.useState(!1),[Re,Ge]=Q.useState(""),[He,Xe]=Q.useState(""),[at,et]=Q.useState(""),[Et,gt]=Q.useState(""),[pt,$e]=Q.useState(!1),[ct,We]=Q.useState([]),[Tt,lt]=Q.useState(!1),[xe,Ce]=Q.useState(!1),[st,ot]=Q.useState({});Q.useEffect(()=>{if(!s||!Tt&&!xe){ot({});return}(async()=>{const{data:Di}=await Pt.from("event_attendance").select("event_id, status").eq("user_id",s),Pn={};(Di||[]).forEach(hn=>{hn?.event_id&&hn?.status&&(Pn[hn.event_id]=hn.status)}),ot(Pn)})()},[s,Tt,xe]);const _t=Q.useMemo(()=>{if(!_)return[];const Mi=l.trim().toLowerCase(),Di=new Date,Pn=new Date(Di);Pn.setHours(0,0,0,0);const hn=new Date(Di);hn.setHours(23,59,59,999);const zn=new Date(Pn);zn.setDate(zn.getDate()+1);const it=new Date(zn);it.setHours(23,59,59,999);const Qn=Re.split(",").map(fi=>fi.trim().toLowerCase()).filter(Boolean),qn=He.trim()?Number(He):null,wi=at.trim()?Number(at):null;return t.filter(fi=>{if(Mi&&!(fi.name.toLowerCase().includes(Mi)||fi.city.toLowerCase().includes(Mi)||fi.venue_place?.name?.toLowerCase().includes(Mi)||fi.venue_place?.city?.toLowerCase().includes(Mi)||fi.address?.toLowerCase().includes(Mi)))return!1;const xn=new Date(fi.starts_at),Hn=fi.ends_at?new Date(fi.ends_at):null,Xi=(Hn??xn)<Di;if(!I&&!N||I!==N&&(N&&!Xi||I&&Xi)||K&&(xn<Pn||xn>hn)||ne&&(xn<zn||xn>it))return!1;if(re){const Ki=new Date(`${re}T00:00:00`),Wi=new Date(Ki);if(Wi.setHours(23,59,59,999),xn<Ki||xn>Wi)return!1}if(oe&&(xn>Di||Hn&&Hn<Di)||ye&&fi.is_free===!1)return!1;if(Et){const Ki=xn.getHours(),Wi=Ki>=6&&Ki<18;if(Et==="day"&&!Wi||Et==="night"&&Wi)return!1}if(pt&&!(Array.isArray(fi.event_artists)&&fi.event_artists.some(Wi=>Wi?.artist?.artist_type==="band"))||ct.length>0&&!(Array.isArray(fi.event_artists)&&fi.event_artists.some(Wi=>Wi?.artist?.id&&ct.includes(Wi.artist.id))))return!1;if(Qn.length>0){const Ki=(fi.genres||[]).map(Wi=>Wi.toLowerCase());if(!Qn.some(Wi=>Ki.includes(Wi)))return!1}if(qn!==null||wi!==null){const Wi=(fi.price_tiers||[]).map(an=>Number(an.price)).filter(an=>Number.isFinite(an)),gs=fi.is_free!==!1,Ct=gs?0:Wi.length>0?Math.min(...Wi):null,In=gs?0:Wi.length>0?Math.max(...Wi):null;if(Ct===null||In===null||qn!==null&&In<qn||wi!==null&&Ct>wi)return!1}if(Tt||xe){const Ki=st[fi.id];return!!(Tt&&Ki==="going"||xe&&Ki==="attended")}return!0})},[t,l,I,N,K,ne,re,oe,ye,Re,He,at,Et,pt,ct,Tt,xe,st,_]),kt=Q.useMemo(()=>{const Mi=l.trim().toLowerCase();return Mi?e.filter(Di=>Di.name.toLowerCase().includes(Mi)||Di.city.toLowerCase().includes(Mi)||Di.address?.toLowerCase().includes(Mi)):e},[e,l]);return{search:l,setSearch:f,showEvents:_,setShowEvents:y,showVenues:d,setShowVenues:A,showUpcoming:I,setShowUpcoming:B,showPast:N,setShowPast:V,filterToday:K,filterTomorrow:ne,filterDate:re,filterNow:oe,filterFree:ye,filterGenres:Re,priceMin:He,priceMax:at,filterDayPart:Et,setFilterDayPart:gt,filterBandOnly:pt,setFilterBandOnly:$e,selectedArtistIds:ct,setSelectedArtistIds:We,filterGoing:Tt,filterAttended:xe,toggleToday:()=>{se(Mi=>{const Di=!Mi;return Di&&(ve(!1),ge("")),Di})},toggleTomorrow:()=>{ve(Mi=>{const Di=!Mi;return Di&&(se(!1),ge("")),Di})},setFilterDate:Mi=>{ge(Mi),Mi&&(se(!1),ve(!1))},setFilterNow:me,setFilterFree:ke,setFilterGenres:Ge,setPriceMin:Xe,setPriceMax:et,setFilterGoing:lt,setFilterAttended:Ce,clearExtraFilters:()=>{Ge(""),Xe(""),et(""),gt(""),$e(!1),We([]),lt(!1),Ce(!1)},filteredEvents:_t,filteredVenues:kt}},gz=[37.3891,-5.9845],yz=15,m2="live_space.map.view",_z=()=>{if(typeof window>"u")return null;try{const t=window.localStorage.getItem(m2);if(!t)return null;const e=JSON.parse(t);if(!e?.center||typeof e.zoom!="number")return null;const[s,l]=e.center;return!Number.isFinite(s)||!Number.isFinite(l)?null:{center:e.center,zoom:e.zoom}}catch{return null}},vz=(t,e)=>{if(!(typeof window>"u"))try{window.localStorage.setItem(m2,JSON.stringify({center:`${t[0]},${t[1]}`,zoom:e}))}catch{}},xz=()=>{const t=Fr();sf();const{user:e}=Vr(),[s,l]=Q.useState([]),[f,_]=Q.useState([]),[y,d]=Q.useState(new Set),[A,I]=Q.useState({}),[B,N]=Q.useState(new Set),[V,K]=Q.useState(new Set),[se,ne]=Q.useState([]),[ve,re]=Q.useState(!1),[ge,oe]=Q.useState(null),[me,ye]=Q.useState([]),ke=ge!==null?me[ge]:null,[Re,Ge]=Q.useState(gz),[He,Xe]=Q.useState(yz),[at,et]=Q.useState(!1),[Et,gt]=Q.useState(!1),[pt,$e]=Q.useState(null),ct=Q.useRef(null);Q.useEffect(()=>{const ee=()=>{ct.current&&!pt&&(console.log("[Map] mapRef.current is now available, setting mapInstance"),$e(ct.current))};ee();const Le=setInterval(ee,100);return setTimeout(()=>clearInterval(Le),5e3),()=>clearInterval(Le)},[pt]);const[We,Tt]=Q.useState(!1),[lt,xe]=Q.useState(null),{search:Ce,setSearch:st,showEvents:ot,setShowEvents:_t,showVenues:kt,setShowVenues:It,showUpcoming:ei,setShowUpcoming:li,showPast:Gi,setShowPast:Mi,filterToday:Di,filterTomorrow:Pn,filterDate:hn,setFilterDate:zn,filterNow:it,setFilterNow:Qn,filterFree:qn,setFilterFree:wi,filterGenres:fi,setFilterGenres:xn,priceMin:Hn,setPriceMin:es,priceMax:Xi,setPriceMax:Ki,filterDayPart:Wi,setFilterDayPart:gs,filterBandOnly:Ct,setFilterBandOnly:In,filterGoing:an,setFilterGoing:Tn,filterAttended:Zn,setFilterAttended:jt,clearExtraFilters:ri,setSelectedArtistIds:Jt,filteredEvents:Bi,filteredVenues:jn}=mz({events:s,venues:f,userId:e?.id});Q.useEffect(()=>{Xh.Icon.Default.mergeOptions({iconRetinaUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",import.meta.url).toString(),iconUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",import.meta.url).toString(),shadowUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",import.meta.url).toString()})},[]);const ci=Q.useCallback(async()=>{const{data:ee}=await Pt.from("events").select(`
        *,
        venue_place:venue_places(*),
        event_artists(artist:artists(*))
      `);l(ee||[])},[]),xs=Q.useCallback(async()=>{const{data:ee}=await Pt.from("venue_places").select("id, name, city, address, latitude, longitude, photos, venue_type, capacity");_(ee||[])},[]),Dn=Q.useCallback(async()=>{if(!e?.id){d(new Set),I({});return}const[ee,Le]=await Promise.all([Pt.from("event_saves").select("event_id").eq("user_id",e.id),Pt.from("event_attendance").select("event_id,status").eq("user_id",e.id)]),Ue=new Set;(ee.data||[]).forEach(Ve=>{Ve?.event_id&&Ue.add(Ve.event_id)}),d(Ue);const Oe={};(Le.data||[]).forEach(Ve=>{Ve?.event_id&&(Ve?.status==="going"||Ve?.status==="attended")&&(Oe[Ve.event_id]=Ve.status)}),I(Oe)},[e?.id]);Q.useEffect(()=>{ci(),xs()},[]),Q.useEffect(()=>{Dn()},[Dn]),Q.useEffect(()=>{s.length===0&&ci()},[s.length,ci]),Q.useEffect(()=>{f.length===0&&xs()},[f.length,xs]),Q.useEffect(()=>{const ee=_z();ee&&!at&&(Ge(ee.center),Xe(ee.zoom),et(!0))},[at]),Q.useEffect(()=>{!navigator.geolocation||Et||!at||(gt(!0),navigator.geolocation.getCurrentPosition(ee=>{Ge([ee.coords.latitude,ee.coords.longitude])},()=>{},{enableHighAccuracy:!0,timeout:5e3}))},[at,Et]),Q.useEffect(()=>{if(!pt)return;pt.invalidateSize();const ee=()=>{const Le=pt.getCenter(),Ue=pt.getZoom(),Oe=[Le.lat,Le.lng];Ge(Oe),Xe(Ue),vz(Oe,Ue)};return pt.on("moveend",ee),pt.on("zoomend",ee),()=>{pt.off("moveend",ee),pt.off("zoomend",ee)}},[pt]),Q.useEffect(()=>{if(!pt)return;const ee=pt.getCenter(),Le=pt.getZoom(),[Ue,Oe]=Re,Ve=Math.abs(ee.lat-Ue),Bt=Math.abs(ee.lng-Oe);Le===He&&Ve<1e-7&&Bt<1e-7||pt.setView(Re,He,{animate:!0})},[Re,He,pt]),AM(()=>{pt&&window.setTimeout(()=>{pt.invalidateSize()},150)}),Q.useEffect(()=>{if(ke&&pt){const ee=$n(ke);if(ee){const Oe=pt.getSize().y*-.15,Ve=pt.getZoom(),Bt=pt.latLngToContainerPoint(ee),qt=Xh.point(Bt.x,Bt.y-Oe),Dt=pt.containerPointToLatLng(qt);pt.setView(Dt,Ve,{animate:!0})}}},[ke,pt]);const $n=ee=>{if(ee.type==="event"){const Le=Bi.find(Ve=>Ve.id===ee.id);if(!Le)return null;const Ue=Number(Le.latitude??Le.venue_place?.latitude??null),Oe=Number(Le.longitude??Le.venue_place?.longitude??null);return Number.isNaN(Ue)||Number.isNaN(Oe)?null:[Ue,Oe]}else{const Le=jn.find(Ve=>Ve.id===ee.id);if(!Le)return null;const Ue=Number(Le.latitude??null),Oe=Number(Le.longitude??null);return Number.isNaN(Ue)||Number.isNaN(Oe)?null:[Ue,Oe]}},Ji=ee=>{if(!$n(ee))return;const Ue=[];ot&&Bi.forEach(qt=>{$n({type:"event",id:qt.id})&&Ue.push({type:"event",id:qt.id})}),kt&&jn.forEach(qt=>{$n({type:"venue",id:qt.id})&&Ue.push({type:"venue",id:qt.id})});const Oe=Ue.findIndex(qt=>qt.type===ee.type&&qt.id===ee.id),Ve=Oe===-1?[...Ue,ee]:Ue,Bt=Oe===-1?Ve.length-1:Oe;ye(Ve),oe(Bt)},be=ee=>{if(ge===null||me.length===0)return;let Le=ge+ee;Le<0&&(Le=me.length-1),Le>=me.length&&(Le=0),oe(Le)},[ie,te]=Q.useState(null),[he,we]=Q.useState(null),je=()=>{ne([]),Jt([]),It(!0)},Ne=Q.useCallback(async ee=>{if(!e?.id){t.push("/welcome");return}if(B.has(ee))return;const Le=y.has(ee);N(Ue=>{const Oe=new Set(Ue);return Oe.add(ee),Oe}),d(Ue=>{const Oe=new Set(Ue);return Le?Oe.delete(ee):Oe.add(ee),Oe});try{if(Le){const{error:Ue}=await Pt.from("event_saves").delete().eq("event_id",ee).eq("user_id",e.id);if(Ue)throw Ue}else{const{error:Ue}=await Pt.from("event_saves").insert({event_id:ee,user_id:e.id});if(Ue)throw Ue}}catch{d(Oe=>{const Ve=new Set(Oe);return Le?Ve.add(ee):Ve.delete(ee),Ve})}finally{N(Ue=>{const Oe=new Set(Ue);return Oe.delete(ee),Oe})}},[B,y,t,e?.id]),Ze=Q.useCallback(async(ee,Le)=>{if(!e?.id){t.push("/welcome");return}if(V.has(ee))return;const Ue=A[ee]||null,Oe=Ue===Le;K(Ve=>{const Bt=new Set(Ve);return Bt.add(ee),Bt}),I(Ve=>{const Bt={...Ve};return Oe?delete Bt[ee]:Bt[ee]=Le,Bt});try{if(Oe){const{error:Ve}=await Pt.from("event_attendance").delete().eq("event_id",ee).eq("user_id",e.id);if(Ve)throw Ve}else{const{error:Ve}=await Pt.from("event_attendance").upsert({event_id:ee,user_id:e.id,status:Le},{onConflict:"event_id,user_id"});if(Ve)throw Ve}}catch{I(Bt=>{const qt={...Bt};return Ue?qt[ee]=Ue:delete qt[ee],qt})}finally{K(Ve=>{const Bt=new Set(Ve);return Bt.delete(ee),Bt})}},[V,A,t,e?.id]);return S.jsxs(ao,{children:[S.jsxs("div",{className:"relative flex min-h-full flex-col p-0",children:[S.jsx("div",{className:"pointer-events-auto absolute left-4 right-4 top-4 z-[1000]",children:S.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl bg-black/85 p-3",children:[S.jsx("input",{type:"search",placeholder:"Search shows",value:Ce,onChange:ee=>st(ee.target.value),className:"w-full rounded-xl bg-white/15 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"}),S.jsx(dz,{showUpcoming:ei,showPast:Gi,filterToday:Di,filterTomorrow:Pn,filterDate:hn,filterNow:it,filterFree:qn,showEvents:ot,showVenues:kt,onToggleUpcoming:()=>li(ee=>!ee),onTogglePast:()=>Mi(ee=>!ee),onToggleToday:()=>{},onToggleTomorrow:()=>{},onDateChange:ee=>{zn(ee),ee&&Qn(!1)},onToggleNow:()=>Qn(ee=>!ee),onToggleFree:()=>wi(ee=>!ee),onToggleEvents:()=>_t(ee=>!ee),onToggleVenues:()=>It(ee=>!ee),onOpenArtistSearch:()=>{re(!0),Tt(!0)},onOpenFilters:()=>Tt(!0)}),se.length>0&&S.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-xl bg-white/10 px-3 py-2 text-xs text-white",children:[S.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.22em] text-white/60",children:"Artist"}),se.map(ee=>S.jsxs("div",{className:"flex items-center gap-1 rounded-lg bg-white/15 px-2 py-1 text-xs font-medium text-white",children:[ee.avatar_url&&S.jsx("img",{src:ee.avatar_url,alt:ee.name,className:"h-4 w-4 rounded-full object-cover"}),S.jsx("span",{children:ee.name}),S.jsx("button",{type:"button",onClick:()=>{ne(Le=>Le.filter(Ue=>Ue.id!==ee.id)),Jt(Le=>{const Ue=Le.filter(Oe=>Oe!==ee.id);return Ue.length===0&&It(!0),Ue})},className:"ml-auto text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 transition hover:text-white",children:"Clear"})]},ee.id)),S.jsx("button",{type:"button",onClick:je,className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white",children:"Clear artist filter"})]})]})}),S.jsx("div",{className:"relative",children:S.jsxs(Yx,{center:Re,zoom:He,style:{height:"calc(100vh - 60px)",width:"100%"},className:"rounded-none [&_.leaflet-container]:rounded-none [&_.leaflet-pane]:z-0 [&_.leaflet-marker-pane]:z-[500] [&_.leaflet-overlay-pane]:z-[400] [&_.leaflet-popup-pane]:z-[600]",zoomControl:!1,ref:ct,whenReady:()=>{console.log("[Map] MapContainer whenReady triggered")},preferCanvas:!1,children:[S.jsx(p2,{}),S.jsx(Xx,{}),S.jsx(hz,{events:ot?Bi:[],venues:jn,showVenues:kt,onSelectEvent:ee=>Ji({type:"event",id:ee}),onSelectVenue:ee=>Ji({type:"venue",id:ee}),activeSelection:ge!==null?me[ge]:null})]})})]}),S.jsx(pz,{activeItem:ke,events:Bi,venues:jn,onFollowEvent:ee=>{Ne(ee)},onSetAttendance:(ee,Le)=>{Ze(ee,Le)},followedEventIds:y,attendanceStatusByEventId:A,followPendingEventIds:B,attendancePendingEventIds:V,onTouchStart:ee=>{te(ee.touches[0].clientX),we(ee.touches[0].clientY)},onTouchEnd:ee=>{if(ie===null||he===null)return;const Le=ee.changedTouches[0].clientX-ie,Ue=ee.changedTouches[0].clientY-he;Ue>100&&Math.abs(Le)<50?oe(null):Math.abs(Le)>50&&Math.abs(Ue)<50&&be(Le<0?1:-1),te(null),we(null)}}),S.jsx(fz,{isOpen:We,onDismiss:()=>{Tt(!1),re(!1)},filterGenres:fi,onGenresChange:xn,priceMin:Hn.toString(),onPriceMinChange:ee=>es(Number(ee)||0),priceMax:Xi.toString(),onPriceMaxChange:ee=>Ki(Number(ee)||100),filterDayPart:Wi||"",onDayPartChange:gs,filterBandOnly:Ct,onToggleBand:In,filterGoing:an,onToggleGoing:Tn,filterAttended:Zn,onToggleAttended:jt,disableAttendance:!1,selectedArtists:se,onAddArtist:ee=>{ne(Le=>[...Le,ee]),Jt(Le=>[...Le,ee.id]),It(!1)},onRemoveArtist:ee=>{ne(Le=>Le.filter(Ue=>Ue.id!==ee)),Jt(Le=>{const Ue=Le.filter(Oe=>Oe!==ee);return Ue.length===0&&It(!0),Ue})},filterDate:hn,onDateChange:zn,showVenues:kt,onToggleVenues:It,onClear:()=>{ri(),zn(""),Qn(!1),wi(!1),xn(""),es(0),Ki(100),gs(""),In(!1),Tn(!1),jt(!1)}})]})},bz=({value:t,placeholder:e,onChange:s,onClear:l})=>S.jsx("div",{className:"sticky top-0 z-20 -mx-4 bg-app-bg px-4 pb-3 pt-2",children:S.jsx("div",{className:"bg-white/5",children:S.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[S.jsx("input",{type:"search",value:t,placeholder:e||"Search artists or venues",onChange:f=>s(f.target.value),className:"w-full bg-transparent text-sm text-white placeholder:text-white/40 focus:outline-none"}),t.trim().length>0&&S.jsx("button",{type:"button",onClick:l,className:"shrink-0 px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",children:"Clear"})]})})}),wz=({value:t,onChange:e})=>S.jsxs("div",{className:"flex items-center gap-6",children:[S.jsx("button",{type:"button",onClick:()=>e("artists"),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t==="artists"?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:"Artists"}),S.jsx("button",{type:"button",onClick:()=>e("venues"),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t==="venues"?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:"Venues"})]}),xy=({title:t,description:e,actionLabel:s,onAction:l})=>S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:t}),e&&S.jsx("p",{className:"mt-1 text-xs text-white/55",children:e}),s&&l&&S.jsx("button",{type:"button",className:"mt-4 bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:l,children:s})]}),Sz=({rows:t=6})=>S.jsx("div",{className:"space-y-3",children:Array.from({length:t}).map((e,s)=>S.jsx("div",{className:"h-[74px] animate-pulse bg-white/5"},s))}),fw=({sections:t,renderItem:e})=>{const[s,l]=Q.useState(!1),f=Q.useMemo(()=>s?t:t.slice(0,2),[s,t]),_=Math.max(0,t.length-f.length);return S.jsxs("div",{className:"space-y-8",children:[f.map(y=>S.jsxs("section",{className:"space-y-3",children:[S.jsx("div",{className:"flex items-baseline justify-between gap-4",children:S.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:y.title})}),S.jsx("div",{className:"space-y-2",children:y.items.map(e)})]},y.key)),_>0&&S.jsxs("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",onClick:()=>l(!0),children:["Show ",_," more"]}),s&&t.length>2&&S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",onClick:()=>l(!1),children:"Show less"})]})},pw=({artist:t,isFollowing:e,followLoading:s,canFollow:l,onToggleFollow:f,onOpenProfile:_})=>S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:_,children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:t.avatar_url?S.jsx("img",{src:t.avatar_url,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:t.name}),S.jsx("p",{className:"mt-0.5 text-xs text-white/55 line-clamp-1",children:t.city||(t.genres?.length?t.genres.slice(0,2).join("  "):"Artist")})]})]}),S.jsx("button",{type:"button",disabled:!l||s,onClick:y=>{y.stopPropagation(),f()},className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${e?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:s?"Loading":e?"Following":"Follow"})]}),mw=({venue:t,isFollowing:e,followLoading:s,canFollow:l,onToggleFollow:f,onOpenProfile:_})=>{const y=t.photos?.[0]||null;return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:_,children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:y?S.jsx("img",{src:y,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:t.name}),S.jsx("p",{className:"mt-0.5 text-xs text-white/55 line-clamp-1",children:t.city})]})]}),S.jsx("button",{type:"button",disabled:!l||s,onClick:d=>{d.stopPropagation(),f()},className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${e?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:s?"Loading":e?"Following":"Follow"})]})},Tz=(t,e)=>{const[s,l]=Q.useState(t);return Q.useEffect(()=>{const f=window.setTimeout(()=>l(t),e);return()=>window.clearTimeout(f)},[e,t]),s},Ez=async(t,e=20)=>{const s=t.trim();return s?_r(`discover:artists:search:${s}:${e}`,async()=>{const{data:l,error:f}=await Pt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres").or(`name.ilike.%${s}%,city.ilike.%${s}%`).limit(e);if(f)throw f;return(l||[]).map(_=>({id:_.artist_id,subject_id:_.subject_id,name:_.name,avatar_url:_.avatar_url,city:_.city,genres:_.genres||[]}))},{ttlMs:1e4}):[]},kz=async(t,e=20)=>{const s=t.trim();return s?_r(`discover:venues:search:${s}:${e}`,async()=>{const{data:l,error:f}=await Pt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity").or(`name.ilike.%${s}%,city.ilike.%${s}%`).limit(e);if(f)throw f;return(l||[]).map(_=>({id:_.venue_place_id,subject_id:_.subject_id,name:_.name,city:_.city,address:_.address,photos:_.photos||[],venue_type:_.venue_type??null,capacity:_.capacity??null}))},{ttlMs:1e4}):[]},g2=async(t,e)=>_r(`events:list:${t}:${e}`,async()=>{const{data:s,error:l}=await Pt.from("events").select(`
          id,
          name,
          city,
          address,
          latitude,
          longitude,
          starts_at,
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url,
              city,
              genres
            )
          )
        `).gte("starts_at",t).lte("starts_at",e).order("starts_at",{ascending:!0});if(l)throw l;return s||[]},{ttlMs:1e4}),y2=10,Cz=50,Az=()=>{const t=new Date,e=new Date(t);e.setHours(0,0,0,0);const s=new Date(e);s.setDate(s.getDate()+14),s.setHours(23,59,59,999);const l=new Date(e);return l.setDate(l.getDate()+7),l.setHours(23,59,59,999),{startOfToday:e,endOfTwoWeeks:s,endOfWeek:l}},_2=t=>({id:t.artist_id,subject_id:t.subject_id,name:t.name,avatar_url:t.avatar_url,city:t.city,genres:t.genres||[]}),gw=async t=>{if(t.length===0)return[];const e=Array.from(new Set(t)).sort(),s=e.join(","),l=await _r(`artists:by_ids:${s}`,async()=>{const{data:_,error:y}=await Pt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres").in("artist_id",e);if(y)throw y;return _||[]},{ttlMs:6e4}),f=new Map;for(const _ of l)f.set(_.artist_id,_);return t.map(_=>f.get(_)).filter(Boolean).map(_2)},yw=t=>{const e=new Map;for(const s of t)for(const l of s.event_artists||[]){const f=l.artist?.id;f&&e.set(f,(e.get(f)||0)+1)}return Array.from(e.entries()).sort((s,l)=>l[1]-s[1]).slice(0,y2).map(([s])=>s)},Mz=async t=>{const{startOfToday:e,endOfTwoWeeks:s,endOfWeek:l}=Az(),f=await g2(e.toISOString(),s.toISOString()),_=[];if(t?.location){const N=[];for(const se of f){const ne=qh(se.latitude??se.venue_place?.latitude??null),ve=qh(se.longitude??se.venue_place?.longitude??null);ne===null||ve===null||Vx(t.location.lat,t.location.lng,ne,ve)>Cz||N.push(se)}const V=yw(N),K=await gw(V);K.length>0&&_.push({key:"trending_near_you",title:"Trending near you",items:K})}const y=f.filter(N=>{const V=new Date(N.starts_at);return V>=e&&V<=l}),d=yw(y),A=await gw(d);A.length>0&&_.push({key:"popular_this_week",title:"Popular this week",items:A});const I=await _r("discover:artists:recent",async()=>{const{data:N,error:V}=await Pt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres,updated_at").order("updated_at",{ascending:!1}).limit(y2);if(V)throw V;return(N||[]).map(_2)},{ttlMs:6e4});I.length>0&&_.push({key:"recently_active",title:"Recently active",items:I});const B=new Set;return _.map(N=>({...N,items:N.items.filter(V=>B.has(V.id)?!1:(B.add(V.id),!0))}))},v2=10,Pz=50,Iz=()=>{const t=new Date,e=new Date(t);e.setHours(0,0,0,0);const s=new Date(e);s.setDate(s.getDate()+14),s.setHours(23,59,59,999);const l=new Date(e);return l.setDate(l.getDate()+7),l.setHours(23,59,59,999),{startOfToday:e,endOfTwoWeeks:s,endOfWeek:l}},x2=t=>({id:t.venue_place_id,subject_id:t.subject_id,name:t.name,city:t.city,address:t.address,photos:t.photos||[],venue_type:t.venue_type??null,capacity:t.capacity??null}),_w=async t=>{if(t.length===0)return[];const e=Array.from(new Set(t)).sort(),s=e.join(","),l=await _r(`venues:by_place_ids:${s}`,async()=>{const{data:_,error:y}=await Pt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity").in("venue_place_id",e);if(y)throw y;return _||[]},{ttlMs:6e4}),f=new Map;for(const _ of l)f.set(_.venue_place_id,_);return t.map(_=>f.get(_)).filter(Boolean).map(x2)},vw=t=>{const e=new Map;for(const s of t){const l=s.venue_place?.id;l&&e.set(l,(e.get(l)||0)+1)}return Array.from(e.entries()).sort((s,l)=>l[1]-s[1]).slice(0,v2).map(([s])=>s)},jz=async t=>{const{startOfToday:e,endOfTwoWeeks:s,endOfWeek:l}=Iz(),f=await g2(e.toISOString(),s.toISOString()),_=[];if(t?.location){const N=[];for(const se of f){const ne=qh(se.latitude??se.venue_place?.latitude??null),ve=qh(se.longitude??se.venue_place?.longitude??null);ne===null||ve===null||Vx(t.location.lat,t.location.lng,ne,ve)>Pz||N.push(se)}const V=vw(N),K=await _w(V);K.length>0&&_.push({key:"venues_near_you",title:"Venues near you",items:K})}const y=f.filter(N=>{const V=new Date(N.starts_at);return V>=e&&V<=l}),d=vw(y),A=await _w(d);A.length>0&&_.push({key:"popular_venues_this_week",title:"Popular venues this week",items:A});const I=await _r("discover:venues:recent",async()=>{const{data:N,error:V}=await Pt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity,created_at").order("created_at",{ascending:!1}).limit(v2);if(V)throw V;return(N||[]).map(x2)},{ttlMs:6e4});I.length>0&&_.push({key:"recently_added",title:"Recently added venues",items:I});const B=new Set;return _.map(N=>({...N,items:N.items.filter(V=>B.has(V.id)?!1:(B.add(V.id),!0))}))},by={searchArtists:Ez,searchVenues:kz,getSuggestedArtists:Mz,getSuggestedVenues:jz},Lz=({tab:t,query:e,location:s})=>{const{loading:l}=Vr(),f=u2(),[_,y]=Q.useState(!1),[d,A]=Q.useState([]),[I,B]=Q.useState([]),[N,V]=Q.useState([]),[K,se]=Q.useState([]),ne=e.trim().length>0;return Q.useEffect(()=>{if(l)return;let ve=!1;return(async()=>{y(!0);try{if(t==="artists")if(ne){const ge=await by.searchArtists(e);if(ve)return;A(ge)}else{const ge=await by.getSuggestedArtists({location:s});if(ve)return;V(ge)}else if(ne){const ge=await by.searchVenues(e);if(ve)return;B(ge)}else{const ge=await by.getSuggestedVenues({location:s});if(ve)return;se(ge)}}catch{if(ve)return;t==="artists"?(A([]),V([])):(B([]),se([]))}finally{ve||y(!1)}})(),()=>{ve=!0}},[l,ne,s,e,f,t]),{loading:_,artists:d,venues:I,suggestedArtistSections:N,suggestedVenueSections:K,isSearching:ne}},Rz=()=>{const t=Fr(),e=sf().state,s=t2(),[l]=aP(),[f,_]=Q.useState("artists"),[y,d]=Q.useState(""),A=Tz(y,350),{canFollow:I,isFollowing:B,isToggling:N,toggleFollowSubject:V}=i2(),{loading:K,artists:se,venues:ne,suggestedArtistSections:ve,suggestedVenueSections:re,isSearching:ge}=Lz({tab:f,query:A,location:s});Q.useEffect(()=>{e?.initialTab&&_(e.initialTab)},[]);const oe=async ye=>{const ke=await V(ye);!ke.ok&&ke.reason==="network"&&l({message:"Couldn't follow. Try again.",duration:2e3,position:"top"})},me=Q.useMemo(()=>f==="artists"?"Follow the ones youve seen live.":"Follow the rooms you return to.",[f]);return S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("header",{className:"space-y-2",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Discover"}),S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:f==="artists"?"Artists":"Venues"}),S.jsx("p",{className:"text-sm text-white/55",children:me})]}),S.jsx(bz,{value:y,placeholder:"Search artists or venues",onChange:d,onClear:()=>d("")}),S.jsx(wz,{value:f,onChange:_}),K&&S.jsx(Sz,{rows:6}),!K&&f==="artists"&&S.jsx(S.Fragment,{children:ge?se.length===0?S.jsx(xy,{title:`No results for "${A.trim()}"`,description:"Try a different spelling or search by city.",actionLabel:"Clear search",onAction:()=>d("")}):S.jsx("div",{className:"space-y-3",children:se.map(ye=>S.jsx(pw,{artist:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>oe(ye.subject_id),onOpenProfile:()=>t.push(`/artist/${ye.id}`)},ye.id))}):ve.length===0?S.jsx(xy,{title:"No artist suggestions yet",description:"Search by name to find an artist."}):S.jsx(fw,{sections:ve,renderItem:ye=>S.jsx(pw,{artist:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>oe(ye.subject_id),onOpenProfile:()=>t.push(`/artist/${ye.id}`)},ye.id)})}),!K&&f==="venues"&&S.jsx(S.Fragment,{children:ge?ne.length===0?S.jsx(xy,{title:`No results for "${A.trim()}"`,description:"Try a different spelling or search by city.",actionLabel:"Clear search",onAction:()=>d("")}):S.jsx("div",{className:"space-y-3",children:ne.map(ye=>S.jsx(mw,{venue:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>oe(ye.subject_id),onOpenProfile:()=>t.push(`/venue/${ye.id}`)},ye.id))}):re.length===0?S.jsx(xy,{title:"No venue suggestions yet",description:"Search by name to find a venue."}):S.jsx(fw,{sections:re,renderItem:ye=>S.jsx(mw,{venue:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>oe(ye.subject_id),onOpenProfile:()=>t.push(`/venue/${ye.id}`)},ye.id)})})]})},zz=()=>S.jsx(ao,{children:S.jsx(Rz,{})}),b2=(t,e,s)=>{const l=s?encodeURI(s).replace(/'/g,"%27"):"",f=s?`<div class="map-pin-avatar" style="background-image:url('${l}')"></div>`:'<div class="map-pin-avatar map-pin-avatar--empty"></div>',_=`
    <div class="map-pin map-pin--${t}">
      ${f}
      <span class="map-pin-label">${e}</span>
    </div>
  `;return Xh.divIcon({className:"map-pin-wrapper",html:_,iconSize:[52,60],iconAnchor:[26,60],popupAnchor:[0,-54]})},Dz=({center:t})=>{const e=gp();return Q.useEffect(()=>{t&&e.setView(t)},[t,e]),null},Oz=({onChange:t})=>{const e=gp();return Q.useEffect(()=>{t(e.getBounds())},[e,t]),c2({moveend:()=>t(e.getBounds()),zoomend:()=>t(e.getBounds())}),null},Nz=({enabled:t,onSelect:e})=>(c2({click:s=>{t&&e(s.latlng.lat,s.latlng.lng)}}),null),xw=[41.3874,2.1686],mv="createEvent:lastMapCenter",bw=t=>{const e=t.getTimezoneOffset();return new Date(t.getTime()-e*6e4).toISOString().slice(0,16)},du=t=>{if(t==null)return null;if(typeof t=="number")return Number.isNaN(t)?null:t;const e=Number(t);return Number.isNaN(e)?null:e},Bz=t=>t.replace(/[^a-zA-Z0-9._-]/g,"-"),Em=async(t,e,s)=>{let l=null;const f=new Promise((_,y)=>{l=window.setTimeout(()=>{y(new Error(`${s} timed out. Please try again.`))},e)});try{return await Promise.race([t,f])}finally{l!==null&&window.clearTimeout(l)}},$z=({userId:t,profileRole:e,profileCity:s,defaultArtistId:l=null,defaultArtistName:f=null,initialCenter:_=null})=>{const[y,d]=Q.useState([]),[A,I]=Q.useState([]),[B,N]=Q.useState(!1),[V,K]=Q.useState(!1),[se,ne]=Q.useState(!1),[ve,re]=Q.useState(""),[ge,oe]=Q.useState(""),[me,ye]=Q.useState(null),[ke,Re]=Q.useState("existing"),[Ge,He]=Q.useState(""),[Xe,at]=Q.useState(s||""),[et,Et]=Q.useState(""),[gt,pt]=Q.useState(""),[$e,ct]=Q.useState(""),[We,Tt]=Q.useState(""),[lt,xe]=Q.useState(bw(new Date)),[Ce,st]=Q.useState(""),[ot,_t]=Q.useState(""),[kt,It]=Q.useState(""),[ei,li]=Q.useState(""),[Gi,Mi]=Q.useState(null),[Di,Pn]=Q.useState(null),[hn,zn]=Q.useState(""),[it,Qn]=Q.useState(!0),[qn,wi]=Q.useState([]),[fi,xn]=Q.useState(""),[Hn,es]=Q.useState(""),[Xi,Ki]=Q.useState(l?[l]:[]),[Wi,gs]=Q.useState("existing"),[Ct,In]=Q.useState(""),[an,Tn]=Q.useState(""),[Zn,jt]=Q.useState(""),[ri,Jt]=Q.useState(null),Bi=()=>{if(typeof window>"u")return null;try{const Dt=window.localStorage.getItem(mv);if(!Dt)return null;const At=JSON.parse(Dt);if(Array.isArray(At)&&At.length===2&&Number.isFinite(Number(At[0]))&&Number.isFinite(Number(At[1])))return[Number(At[0]),Number(At[1])]}catch{return null}return null},jn=Q.useMemo(()=>Bi(),[_]),ci=jn||_||null,[xs,Dn]=Q.useState(ci||xw),[$n,Ji]=Q.useState(null);Q.useEffect(()=>{re(""),oe(""),ye(null),Re("existing"),He(""),at(s||""),Et(""),pt(""),ct(""),Tt(""),xe(bw(new Date)),st(""),_t(""),It(""),li(""),Mi(null),Pn(null),zn(""),Qn(!0),wi([]),xn(""),es(""),Ki(l?[l]:[]),jt(""),Jt(null),Dn(ci||xw)},[s,l,ci]),Q.useEffect(()=>{(async()=>{N(!0);const{data:At,error:ti}=await Pt.from("venue_places").select("id, name, city, address, latitude, longitude, website_url, photos").order("name",{ascending:!0});ti?(re("Unable to load venues."),d([])):d(At||[]),N(!1)})()},[]),Q.useEffect(()=>{const Dt=Zn.trim();if(Jt(null),!Dt){I(l?[{id:l,display_name:f||"Your artist profile",username:null,role:"artist"}]:[]),K(!1);return}let At=!1;const ti=window.setTimeout(async()=>{K(!0);const pi=Pt.from("artists").select("id, name, avatar_url").order("name",{ascending:!0}),{data:ji,error:Qi}=await pi.ilike("name",`%${Dt}%`);if(!At){if(Qi)re("Unable to load artists."),I([]),Jt(0);else{const gi=(ji||[]).map(Qe=>({id:Qe.id,display_name:Qe.name,username:null,role:"artist",avatar_url:Qe.avatar_url??null}));Jt(gi.length);const qi=l?gi.some(Qe=>Qe.id===l):!1,on=l&&!qi?[{id:l,display_name:f||"Your artist profile",username:null,role:"artist"},...gi]:gi;I(on)}K(!1)}},700);return()=>{At=!0,window.clearTimeout(ti)}},[Zn,l,f]),Q.useEffect(()=>{l&&Xi.length===0&&Ki([l])},[l,Xi.length]);const be=Q.useCallback(Dt=>{Dn(Dt),typeof window<"u"&&window.localStorage.setItem(mv,JSON.stringify(Dt))},[]),ie=Q.useCallback(Dt=>{typeof window<"u"&&window.localStorage.setItem(mv,JSON.stringify(Dt))},[]);Q.useEffect(()=>{_&&!jn&&be(_)},[_,jn,be]),Q.useEffect(()=>{ci||navigator.geolocation&&navigator.geolocation.getCurrentPosition(Dt=>{be([Dt.coords.latitude,Dt.coords.longitude])},()=>{},{enableHighAccuracy:!0,timeout:5e3})},[ci,be]),Q.useEffect(()=>{if(!Gi){Pn(null);return}const Dt=URL.createObjectURL(Gi);return Pn(Dt),()=>URL.revokeObjectURL(Dt)},[Gi]);const te=Q.useMemo(()=>{const Dt=ge.trim().toLowerCase();return Dt?y.filter(At=>At.name.toLowerCase().includes(Dt)||At.city.toLowerCase().includes(Dt)||At.address?.toLowerCase().includes(Dt)):y},[y,ge]),he=Q.useMemo(()=>$n?te.filter(Dt=>{const At=du(Dt.latitude),ti=du(Dt.longitude);return At===null||ti===null?!1:$n.contains(Xh.latLng(At,ti))}):te,[te,$n]),we=Q.useMemo(()=>he.map(Dt=>{const At=du(Dt.latitude),ti=du(Dt.longitude);return At===null||ti===null?null:{venue:Dt,position:[At,ti],icon:b2("venue","SALA",Dt.photos?.[0]||null)}}).filter(Boolean),[he]),je=Q.useCallback(Dt=>{Ji(Dt);const At=Dt.getCenter();At&&Number.isFinite(At.lat)&&Number.isFinite(At.lng)&&ie([At.lat,At.lng])},[ie]),Ne=Q.useCallback(Dt=>{ye(Dt),Re("existing");const At=du(Dt.latitude),ti=du(Dt.longitude);At!==null&&ti!==null&&be([At,ti])},[be]),Ze=Q.useCallback((Dt,At)=>{Re("new"),ye(null),pt(Dt.toFixed(6)),ct(At.toFixed(6)),be([Dt,At])},[be]),ee=ke==="existing"?me?.city||"":Xe.trim(),Le=ke==="existing"?me?.address||"":et.trim(),Ue=du(ke==="existing"?me?.latitude:gt),Oe=du(ke==="existing"?me?.longitude:$e);return{artists:A,artistsLoading:V,venuesLoading:B,error:ve,saving:se,venueSearch:ge,venueMode:ke,selectedVenue:me,newVenueName:Ge,newVenueCity:Xe,newVenueAddress:et,newVenueLat:gt,newVenueLng:$e,eventName:We,eventStart:lt,eventEnd:Ce,eventDescription:ot,eventUrl:kt,eventCoverUrl:ei,posterFile:Gi,posterPreview:Di,eventGenres:hn,isFree:it,priceTiers:qn,tierLabel:fi,tierPrice:Hn,selectedArtistIds:Xi,artistMode:Wi,newArtistName:Ct,newArtistUsername:an,artistSearch:Zn,artistSearchCount:ri,mapCenter:xs,mapBounds:$n,visibleVenues:he,venueMarkers:we,venueLat:Ue,venueLng:Oe,setVenueSearch:oe,setVenueMode:Re,setSelectedVenue:ye,setNewVenueName:He,setNewVenueCity:at,setNewVenueAddress:Et,setNewVenueLat:pt,setNewVenueLng:ct,setEventName:Tt,setEventStart:xe,setEventEnd:st,setEventDescription:_t,setEventUrl:It,setEventCoverUrl:li,setPosterFile:Mi,setEventGenres:zn,setIsFree:Qn,setTierLabel:xn,setTierPrice:es,setSelectedArtistIds:Ki,setArtistMode:gs,setNewArtistName:In,setNewArtistUsername:Tn,setArtistSearch:jt,setError:re,handleBoundsChange:je,addPriceTier:()=>{re("");const Dt=fi.trim(),At=Number(Hn);if(!Dt){re("Price tier name is required.");return}if(!Number.isFinite(At)||At<0){re("Enter a valid price.");return}wi(ti=>[...ti,{label:Dt,price:At}]),xn(""),es("")},removePriceTier:Dt=>{wi(At=>At.filter((ti,pi)=>pi!==Dt))},selectVenue:Ne,handleMapSelect:Ze,handleCreate:async()=>{if(!t)return re("Sign in to create events."),null;if(!We.trim())return re("Event name is required."),null;if(!lt)return re("Start time is required."),null;if(!it&&qn.length===0)return re("Add at least one price tier."),null;if(ke==="existing"&&!me)return re("Select a venue place."),null;if(ke==="new"){if(!Ge.trim())return re("Venue name is required."),null;if(!Xe.trim())return re("Venue city is required."),null;if(Ue===null||Oe===null)return re("Select a location on the map."),null}const Dt=l&&e==="artist"?[l]:[],At=Xi.length>0?Xi:Dt;if(At.length===0)return re("Select at least one artist."),null;const ti=new Date(lt);if(Number.isNaN(ti.getTime()))return re("Invalid start time."),null;let pi=null;if(Ce){const ji=new Date(Ce);if(Number.isNaN(ji.getTime()))return re("Invalid end time."),null;if(ji<ti)return re("End time must be after the start time."),null;pi=ji.toISOString()}ne(!0),re("");try{let ji=ei.trim()||null,Qi=me?.id||null;if(Gi){const Qe=Bz(Gi.name||"poster"),Ot=`event-posters/${t}/${Date.now()}-${Qe}`,{error:ui}=await Em(Pt.storage.from("media").upload(Ot,Gi,{cacheControl:"3600",upsert:!1,contentType:Gi.type||"image/*"}),45e3,"Poster upload");if(ui)throw ui;const{data:ln}=Pt.storage.from("media").getPublicUrl(Ot);ji=ln.publicUrl}if(ke==="new"){const{data:Qe,error:Ot}=await Em(Pt.from("venue_places").insert({name:Ge.trim(),city:Xe.trim(),address:et.trim()||null,latitude:Ue,longitude:Oe,created_by:t}).select("id, name, city, address, latitude, longitude").single(),2e4,"Venue create");if(Ot)throw Ot;Qi=Qe.id}if(!Qi)throw new Error("Venue is required.");const gi=hn.split(",").map(Qe=>Qe.trim()).filter(Boolean),{data:qi,error:on}=await Em(Pt.from("events").insert({organizer_id:t,venue_place_id:Qi,name:We.trim(),description:ot.trim()||null,event_url:kt.trim()||null,city:ee||s||"",address:Le||null,latitude:Ue,longitude:Oe,genres:gi,cover_image_url:ji,is_free:it,price_tiers:it?[]:qn,starts_at:ti.toISOString(),ends_at:pi,is_public:!0}).select("id").single(),2e4,"Event create");if(on||!qi)throw on||new Error("Event creation failed.");for(const Qe of At){const{error:Ot}=await Em(Pt.from("event_artists").insert({event_id:qi.id,artist_entity_id:Qe}),2e4,"Lineup create");if(Ot)throw await Em(Pt.from("events").delete().eq("id",qi.id),2e4,"Rollback"),Ot}return qi.id}catch(ji){const Qi=ji instanceof Error?ji.message:"Unknown error occurred";return re(Qi),null}finally{ne(!1)}}}},Uz=({venueMode:t,onToggleVenueMode:e,venueSearch:s,onVenueSearchChange:l,mapCenter:f,venueMarkers:_,newVenueIcon:y,visibleVenues:d,venuesLoading:A,selectedVenue:I,onSelectVenue:B,onClearVenue:N,onBoundsChange:V,onMapSelect:K,venueLat:se,venueLng:ne,newVenueName:ve,newVenueCity:re,newVenueAddress:ge,newVenueLat:oe,newVenueLng:me,onNewVenueNameChange:ye,onNewVenueCityChange:ke,onNewVenueAddressChange:Re,onNewVenueLatChange:Ge,onNewVenueLngChange:He})=>S.jsxs("section",{className:"h-full space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsx("div",{children:S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue"})}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center text-sm font-semibold text-white/70 transition hover:text-white",onClick:e,children:t==="existing"?"New venue":"Use existing"})]}),S.jsx("input",{type:"search",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Search venues",value:s,onChange:Xe=>l(Xe.target.value)}),S.jsx("div",{className:"h-[220px] overflow-hidden rounded-2xl bg-black/30",children:S.jsxs(Yx,{center:f,zoom:12,className:"h-full w-full",zoomControl:!1,style:{height:"100%",width:"100%"},children:[S.jsx(p2,{}),S.jsx(Xx,{}),t==="existing"&&_.map(Xe=>S.jsx(t_,{position:Xe.position,icon:Xe.icon,eventHandlers:{click:()=>B(Xe.venue)}},Xe.venue.id)),t==="new"&&se!==null&&ne!==null&&S.jsx(t_,{position:[se,ne],icon:y}),S.jsx(Dz,{center:f}),S.jsx(Oz,{onChange:V}),S.jsx(Nz,{enabled:t==="new",onSelect:K})]})}),t==="existing"&&S.jsx(S.Fragment,{children:A?S.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/70",children:[S.jsx(Js,{name:"crescent"}),"Loading venues..."]}):d.length===0?S.jsx("p",{className:"h-[250px] text-sm text-white/60",children:'No venues found. Switch to "New venue" to add one.'}):S.jsx("div",{className:"max-h-[250px] overflow-auto pr-1",children:S.jsx("div",{className:"space-y-3",children:d.map(Xe=>S.jsxs("div",{className:`flex cursor-pointer items-center gap-4 rounded-2xl p-4 text-left transition ${I?.id===Xe.id?"bg-white/10":"bg-white/5 hover:bg-white/10"}`,onClick:()=>B(Xe),children:[S.jsx("div",{className:"flex h-16 w-16 flex-shrink-0 items-center justify-center overflow-hidden rounded-xl bg-white/10",children:Xe.photos&&Xe.photos.length>0?S.jsx("img",{src:Xe.photos[0],alt:Xe.name,className:"h-full w-full object-cover"}):S.jsx("svg",{className:"h-8 w-8 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsx("h3",{className:"mb-1 text-sm font-semibold text-white",children:Xe.name}),S.jsxs("p",{className:"mb-1 text-xs text-white/60",children:[Xe.city,Xe.address?`  ${Xe.address}`:""]}),Xe.venue_type&&S.jsxs("p",{className:"text-xs text-white/50",children:[Xe.venue_type,Xe.capacity?`  Capacity: ${Xe.capacity}`:""]})]}),I?.id===Xe.id&&S.jsx("div",{className:"h-2.5 w-2.5 flex-shrink-0 rounded-full bg-app-accent"})]},Xe.id))})})}),t==="new"&&S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:ve,onChange:Xe=>ye(Xe.target.value),placeholder:"Venue name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:re,onChange:Xe=>ke(Xe.target.value),placeholder:"City"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Address"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:ge,onChange:Xe=>Re(Xe.target.value),placeholder:"Street address"})]})]})]}),Fz=({name:t})=>t==="spotify"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M7.5 10.5c3.2-1 6.8-.6 9.3.9M8.5 13.5c2.3-.6 5-.4 6.9.6M9.5 16.1c1.6-.3 3.3-.1 4.6.5"})]}):t==="apple_music"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[S.jsx("path",{d:"M16.5 3.5c-.9.6-1.9 1-2.7.9-.1-1 .5-2 1.3-2.6.9-.6 2.2-1 3.2-1-.2 1-1 2-1.8 2.7z"}),S.jsx("path",{d:"M19 13.5c-.2 2-1.7 5.5-3.4 5.5-.8 0-1.2-.5-2-.5-.8 0-1.4.5-2 .5-1.7 0-3.6-3.3-3.6-6.1 0-2.7 1.8-4.1 3.4-4.1.8 0 1.6.5 2.1.5s1.3-.6 2.3-.6c.6 0 2.1.2 2.8 1.6-.1.1-1.7 1-1.6 3.2 0 2.6 2 3.4 2 3.4z"})]}):t==="instagram"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"4"}),S.jsx("circle",{cx:"12",cy:"12",r:"3.2"}),S.jsx("circle",{cx:"17",cy:"7",r:"1",fill:"currentColor"})]}):t==="youtube"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[S.jsx("path",{d:"M21 8.5s0-2-2-2.1C17.2 6.2 12 6.2 12 6.2s-5.2 0-7 .2C3 6.4 3 8.5 3 8.5S3 10.6 3 12v1.5s0 2 2 2.2c1.8.2 7 .2 7 .2s5.2 0 7-.2c2-.2 2-2.2 2-2.2V12s0-1.5 0-3.5z"}),S.jsx("path",{d:"M10 15l4-3-4-3v6z",fill:"#0b0b0d"})]}):S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("path",{d:"M10 14l-4 4m0 0h4m-4 0v-4"}),S.jsx("path",{d:"M14 10l4-4m0 0h-4m4 0v4"}),S.jsx("path",{d:"M8 16h8a4 4 0 0 0 4-4V8"}),S.jsx("path",{d:"M16 8H8a4 4 0 0 0-4 4v4"})]}),Vz=({artist:t,isManager:e,playedCount:s,externalLinks:l,heroStyle:f,onEdit:_})=>{const y=t?.is_verified;return S.jsxs("section",{className:"relative min-h-[420px] overflow-hidden bg-black",style:f,children:[e&&S.jsx("button",{type:"button",onClick:_,className:"absolute right-4 top-4 z-10 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",children:S.jsxs("span",{className:"inline-flex items-center gap-2",children:[S.jsx(lI,{size:14}),"Edit"]})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-6",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:t.avatar_url?S.jsx("img",{src:t.avatar_url,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0 flex-1",children:[S.jsx("h1",{className:"font-display text-2xl font-bold text-white line-clamp-1",children:t.name}),S.jsxs("p",{className:"mt-1 text-sm text-white/55 line-clamp-1",children:[t.city?t.city:t.artist_type==="band"?"Band":"Solo",y?"  Verified":"",s>0?`  ${s} shows`:""]})]})]}),t.bio&&S.jsx("p",{className:"mt-4 text-sm text-white/80",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.bio}),l.length>0&&S.jsx("div",{className:"mt-4 flex flex-wrap gap-x-4 gap-y-2",children:l.map(d=>{const A=d.key,I={spotify:"Spotify",apple_music:"Apple Music",instagram:"Instagram",youtube:"YouTube",website:"Website"};return S.jsxs("a",{href:d.value,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(Fz,{name:A}),I[A]]},A)})})]})]})},qz=({activeTab:t,onSelect:e})=>S.jsx("div",{className:"flex flex-wrap items-center gap-6",children:["shows","moments","media","about"].map(s=>S.jsx("button",{type:"button",onClick:()=>e(s),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t===s?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:s==="shows"?"Shows":s==="media"?"Media":s==="moments"?"Moments":"About"},s))}),Hz=({events:t,isManager:e,onViewEvent:s,onCreateShow:l,onOpenMap:f})=>S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Upcoming"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Upcoming shows"})]}),S.jsxs("button",{type:"button",onClick:f,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(h_,{size:16}),"Artist map"]})]}),t.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"font-semibold text-white",children:"No upcoming shows"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"When new dates are announced they will show up here first."}),e?S.jsx("button",{type:"button",onClick:l,className:"mt-3 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create your first show"}):null]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:t.map(_=>{const d=new Date(_.starts_at).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),A=_.venue_place?.name||_.address||"Venue TBA",I=_.venue_place?.city||_.city||"City";return S.jsx(Jl,{event:_,className:"w-[220px] shrink-0",kicker:d,title:A,subtitle:I,onSelect:B=>s(B.id)},_.id)})})]}),Zz=({hasEvents:t,artistName:e,isManager:s,onOpenMap:l,onCreateShow:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Map"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Artist map"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Filtered to ",e," by default."]})]}),S.jsxs("button",{type:"button",onClick:l,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(h_,{size:16}),"Open map"]})]}),S.jsx("div",{className:"overflow-hidden bg-white/5 p-5",children:t?S.jsxs("div",{className:"space-y-2",children:[S.jsx("p",{className:"text-sm font-semibold text-white",children:"Map preview"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Open the live map to explore where ",e," is playing. The map starts filtered to this artist."]}),S.jsx("div",{className:"mt-3 h-40 bg-black/60"})]}):S.jsxs("div",{className:"flex flex-col items-start gap-2 text-white",children:[S.jsx("p",{className:"text-lg font-semibold",children:"No shows to display for this artist"}),S.jsx("p",{className:"text-sm text-white/55",children:"New events will appear on the map as soon as they are published."}),s?S.jsx("button",{type:"button",onClick:f,className:"mt-2 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create show"}):null]})})]}),Gz=({gallery:t,onSelect:e,onViewGallery:s})=>t.length===0?null:S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Media"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Gallery"}),S.jsx("p",{className:"text-sm text-white/55",children:"Live photos, posters, backstage."})]}),S.jsx("button",{type:"button",onClick:s,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:"View gallery"})]}),S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:t.map(l=>S.jsx("button",{type:"button",onClick:()=>e(l.id),className:"group relative aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:S.jsx("img",{src:l.media_url,alt:l.caption||"Gallery item",className:"h-full w-full object-cover"})},l.id))})]}),Wz=({events:t,playedCount:e,isManager:s,onViewEvent:l,onCreateShow:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Archive"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Past shows"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Last ",t.length||3," performances."]})]}),e>0&&S.jsxs("span",{className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white/80",children:["Played ",e]})]}),t.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"font-semibold text-white",children:"No past shows yet"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"We will start showing the archive as soon as the first show finishes."}),s?S.jsx("button",{type:"button",onClick:f,className:"mt-3 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create show"}):null]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:t.map(_=>{const y=new Date(_.starts_at).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),d=_.venue_place?.name||_.address||"Venue TBA",A=_.venue_place?.city||_.city||"City";return S.jsx(Jl,{event:_,className:"w-[220px] shrink-0",kicker:y,title:d,subtitle:A,onSelect:I=>l(I.id)},_.id)})})]}),Yz=({moments:t,isManager:e,onSelect:s})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"Moments"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Relive it"}),S.jsx("p",{className:"text-sm text-white/70",children:"Clips and snapshots from the crowd."})]}),e&&t.length===0&&S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.18em] text-white/60",children:"Empty  add the first one"})]}),t.length===0?e?S.jsxs("div",{className:"rounded-2xl bg-white/5 p-5 text-white/80",children:[S.jsx("p",{className:"font-semibold text-white",children:"No moments yet  share your first live moment"}),S.jsx("p",{className:"mt-1 text-sm text-white/70",children:"Upload a clip or photo from a recent performance."})]}):null:S.jsx("div",{className:"grid grid-cols-3 gap-2",children:t.slice(0,12).map(l=>S.jsx("button",{type:"button",onClick:()=>s(l.id),className:"relative aspect-square overflow-hidden bg-black/30",children:l.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:l.media_url})}):S.jsx("img",{src:l.media_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"})},l.id))})]}),Xz=({artist:t,isManager:e,playedCount:s,onCreateShow:l,onOpenMap:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"About"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Details"})]}),S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-5",children:[S.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.city||""})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Type"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.artist_type==="band"?"Band":"Solo artist"})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Genres"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.genres&&t.genres.length>0?t.genres.join(", "):""})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Shows"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:s>0?`Played ${s}`:"Coming soon"})]})]}),e&&S.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[S.jsx("button",{type:"button",onClick:l,className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.14em] text-white transition hover:bg-white/15",children:"Create show"}),S.jsxs("button",{type:"button",onClick:f,className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.14em] text-white transition hover:bg-white/15",children:[S.jsx(h_,{size:14}),"View on map"]})]})]})]}),w2=({artistId:t,embedded:e})=>{const{id:s}=Qm(),l=t||s,f=Fr(),{managedEntities:_,activeWorkspace:y}=mp(),{user:d}=Vr(),[A,I]=Q.useState(null),[B,N]=Q.useState([]),[V,K]=Q.useState([]),[se,ne]=Q.useState([]),[ve,re]=Q.useState([]),[ge,oe]=Q.useState(!0),[me,ye]=Q.useState(""),[ke,Re]=Q.useState("shows");Q.useEffect(()=>{(async()=>{oe(!0),ye("");try{const{data:We,error:Tt}=await Pt.from("v_subject_artists").select("*").eq("artist_id",l).maybeSingle();if(Tt||!We)throw Tt||new Error("Artist not found");const lt={id:We.artist_id||We.id||l,name:We.name,artist_type:We.artist_type,city:We.city,bio:We.bio,avatar_url:We.avatar_url,genres:We.genres||[],external_links:We.external_links||{},created_at:We.created_at,updated_at:We.updated_at,subject_id:We.subject_id},{data:xe}=await Pt.from("event_artists").select("event_id").eq("artist_entity_id",lt.id),Ce=(xe||[]).map(It=>It.event_id).filter(Boolean);let st=[];if(Ce.length>0){const{data:It}=await Pt.from("events").select(`
                *,
                venue_place:venue_places!events_venue_place_id_fkey (
                  id,
                  name,
                  city,
                  address,
                  latitude,
                  longitude
                ),
                event_artists (
                  artist:artists!event_artists_artist_entity_fk (
                    id,
                    name,
                    avatar_url
                  )
                )
              `).in("id",Ce).order("starts_at",{ascending:!0});st=It||[]}const ot=new Date,_t=st.filter(It=>new Date(It.starts_at)>=ot),kt=st.filter(It=>new Date(It.starts_at)<ot);if(I(lt),N(_t),K(kt.reverse()),Ce.length>0){const{data:It}=await Pt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",Ce).order("created_at",{ascending:!1}).limit(24),ei=It||[];ne(ei),re(ei.filter(li=>li.media_type==="image").slice(0,6))}else ne([]),re([])}catch(We){console.error("Failed to load artist profile",We),ye("Artist not found."),I(null),N([]),K([]),ne([]),re([])}finally{oe(!1)}})()},[l]);const Ge=Q.useMemo(()=>A?y?.type==="artist"&&y.artist?.id===A.id||_.some(ct=>ct.type==="artist"&&ct.artist?.id===A.id):!1,[y,A,_]),He=Q.useMemo(()=>{const ct=A?.external_links||{},We={spotify:ct.spotify,apple_music:ct.apple_music||ct.appleMusic,instagram:ct.instagram,youtube:ct.youtube,website:ct.website};return Object.entries(We).map(([Tt,lt])=>({key:Tt,value:lt})).filter(Tt=>!!Tt.value)},[A]),Xe=B.slice(0,5),at=V.slice(0,5),et=A?.avatar_url?{backgroundColor:"#0b0b0d",backgroundImage:`linear-gradient(180deg, rgba(0,0,0,0.12) 0%, rgba(0,0,0,0.68) 70%, #0b0b0d 100%), url(${A.avatar_url})`,backgroundSize:"cover",backgroundPosition:"center"}:{backgroundColor:"#0b0b0d"},Et=()=>{A&&f.push("/tabs/map",{artistFilter:{id:A.id,name:A.name,avatar_url:A.avatar_url}})},gt=V.length+B.length,pt=()=>{switch(ke){case"shows":return S.jsxs("div",{className:"space-y-6",children:[S.jsx(Hz,{events:Xe,isManager:Ge,onViewEvent:ct=>f.push(`/event/${ct}`),onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`}),onOpenMap:Et}),S.jsx(Wz,{events:at,playedCount:gt,isManager:Ge,onViewEvent:ct=>f.push(`/event/${ct}`),onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`})})]});case"media":return S.jsxs("div",{className:"space-y-6",children:[S.jsx(Zz,{hasEvents:B.length>0||V.length>0,artistName:A?.name||"",isManager:Ge,onOpenMap:Et,onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`})}),S.jsx(Gz,{gallery:ve,onSelect:ct=>f.push(`/post/${ct}`),onViewGallery:()=>Re("moments")})]});case"moments":return S.jsx(Yz,{moments:se,isManager:Ge,onSelect:ct=>f.push(`/post/${ct}`)});default:return S.jsx(Xz,{artist:A,isManager:Ge,playedCount:gt,onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`}),onOpenMap:Et})}},$e=S.jsxs(S.Fragment,{children:[ge&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})}),!ge&&me&&S.jsx("p",{className:"text-sm text-rose-400",children:me}),!ge&&A&&S.jsxs("div",{className:"space-y-8",children:[S.jsx(Vz,{artist:A,isManager:Ge,playedCount:gt,externalLinks:He,heroStyle:et,onEdit:()=>f.push("/tabs/profile")}),S.jsx("div",{className:"sticky top-[72px] z-10 -mx-4 bg-app-bg px-4 py-3",children:S.jsx(qz,{activeTab:ke,onSelect:ct=>Re(ct)})}),S.jsx("div",{children:pt()})]})]});return e?S.jsx("div",{className:"p-4",children:$e}):S.jsx(ao,{children:S.jsx("div",{className:"p-4",children:$e})})},Kz=({profileRole:t,profileName:e,artists:s,selectedArtistIds:l,artistsLoading:f,artistSearch:_,artistSearchCount:y,onArtistSearchChange:d,onSelectArtists:A})=>{const[I,B]=Q.useState("existing"),[N,V]=Q.useState(""),[K,se]=Q.useState(""),[ne,ve]=Q.useState(null),re=me=>{l.includes(me)?A(l.filter(ye=>ye!==me)):A([...l,me])},ge=s.filter(me=>l.includes(me.id));Nt.useEffect(()=>{if(t==="artist"&&l.length===0){const me=s.find(ye=>ye.display_name===e||ye.username===e);me&&A([me.id])}},[t,e,s,l.length,A]);const oe=()=>{B(me=>me==="existing"?"new":"existing")};return S.jsxs("section",{className:"h-full space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artists"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:t==="artist"?"Add yourself and other artists to your event.":"Add multiple artists to your event."})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center text-sm font-semibold text-white/70 transition hover:text-white",onClick:oe,children:I==="existing"?"New artist":"Use existing"})]}),I==="existing"?S.jsxs(S.Fragment,{children:[S.jsxs("label",{className:"flex items-center gap-2 rounded-2xl bg-white/10 px-3 py-2 text-sm text-white",children:[S.jsx("svg",{className:"h-4 w-4 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"})}),S.jsx("input",{className:"w-full bg-transparent text-sm text-white placeholder:text-white/40 focus:outline-none",placeholder:"Search artists",value:_,onChange:me=>d(me.target.value)})]}),f&&S.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/70",children:[S.jsx(Js,{name:"crescent"}),"Searching artists..."]}),!f&&_.trim()!==""&&y===0&&S.jsxs("p",{className:"text-sm text-white/60",children:['No artists found for "',_.trim(),'". The band does not exist yet.']}),!f&&s.length===0&&_.trim()===""&&S.jsx("p",{className:"h-[250px] text-sm text-white/60",children:'No artists found. Switch to "New artist" to add one.'}),s.length>0&&S.jsxs(S.Fragment,{children:[ge.length>0&&S.jsxs("div",{className:"space-y-2 flex-shrink-0",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:["Selected Artists (",ge.length,")"]}),S.jsx("div",{className:"space-y-2",children:ge.map(me=>S.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl bg-white/10 p-3",children:[S.jsxs("div",{children:[S.jsxs("p",{className:"text-sm font-semibold text-white",children:[me.display_name||me.username||"Artist",t==="artist"&&(me.display_name===e||me.username===e)&&S.jsx("span",{className:"ml-2 text-xs text-white/60",children:"(You)"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Artist"})]}),me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-10 w-10 rounded-full object-cover"}):null,S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg bg-white/10 px-2 py-1 text-xs font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>re(me.id),children:"Remove"})]},me.id))})]}),S.jsx("div",{className:"overflow-auto max-h-[250px] pr-1",children:S.jsx("div",{className:"space-y-3",children:s.filter(me=>!l.includes(me.id)).map(me=>S.jsxs("div",{className:"flex cursor-pointer items-center gap-4 rounded-2xl bg-white/5 p-4 text-left transition hover:bg-white/10",onClick:()=>re(me.id),children:[S.jsx("div",{className:"flex h-16 w-16 flex-shrink-0 items-center justify-center overflow-hidden rounded-xl bg-white/10",children:me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-white/10",children:S.jsx("span",{className:"text-sm font-semibold text-white/80",children:(me.display_name||me.username||"A")[0]?.toUpperCase()})})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsxs("h3",{className:"mb-1 text-sm font-semibold text-white",children:[me.display_name||me.username||"Artist",t==="artist"&&(me.display_name===e||me.username===e)&&S.jsx("span",{className:"ml-2 text-xs text-white/60",children:"(You)"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Artist"}),S.jsx("button",{type:"button",className:"mt-1 inline-flex text-xs font-semibold text-white/70 hover:text-white",onClick:ye=>{ye.stopPropagation(),ve(me)},children:"View profile"})]}),S.jsx("div",{className:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-white/10",children:S.jsx("svg",{className:"h-4 w-4 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]},me.id))})}),ge.length===0&&S.jsx("div",{className:"flex flex-shrink-0 items-center justify-between gap-3 rounded-2xl bg-white/5 p-3",children:S.jsx("p",{className:"text-sm text-white",children:s.length===0?"No matching artists. Try a different search or add a new artist.":"Select artists to continue"})})]})]}):S.jsxs("div",{className:"space-y-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Artist name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:N,onChange:me=>V(me.target.value),placeholder:"Artist name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:K,onChange:me=>se(me.target.value),placeholder:"Username"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Note: You can assign a user to this artist later."})]}),S.jsx(c_,{isOpen:!!ne,onDidDismiss:()=>ve(null),children:S.jsxs(Ql,{fullscreen:!0,children:[S.jsxs("div",{className:"flex items-center justify-between gap-4 bg-app-bg px-5 py-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Artist profile"}),S.jsx("button",{type:"button",className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-3 py-1.5 text-xs font-semibold text-white transition hover:bg-white/15",onClick:()=>ve(null),children:"Close"})]}),ne&&S.jsx(w2,{artistId:ne.id,embedded:!0})]})})]})},Jz=({eventName:t,eventStart:e,eventUrl:s,isFree:l,tierLabel:f,tierPrice:_,priceTiers:y,onEventNameChange:d,onEventStartChange:A,onEventUrlChange:I,onToggleFree:B,onTierLabelChange:N,onTierPriceChange:V,onAddTier:K,onRemoveTier:se})=>S.jsxs("section",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Tickets"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Essentials only. Everything else can wait."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Event name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:t,onChange:ne=>d(ne.target.value),placeholder:"Night Session"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Starts at"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",type:"datetime-local",value:e,onChange:ne=>A(ne.target.value)})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Event link"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:s,onChange:ne=>I(ne.target.value),placeholder:"https://..."})]}),S.jsxs("label",{className:"flex items-center gap-3 text-sm text-white",children:[S.jsxs("span",{className:"relative inline-flex items-center",children:[S.jsx("input",{type:"checkbox",className:"peer h-5 w-10 appearance-none rounded-full bg-white/10 transition checked:border-app-accent checked:bg-app-accent",checked:l,onChange:ne=>B(ne.target.checked)}),S.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]}),S.jsx("span",{className:"text-white/80",children:l?"Free event":"Paid event"})]}),!l&&S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Tier name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:f,onChange:ne=>N(ne.target.value),placeholder:"Presale"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Price"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:_,onChange:ne=>V(ne.target.value),placeholder:"12"})]})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:K,children:"Add tier"}),y.length>0&&S.jsx("div",{className:"space-y-2",children:y.map((ne,ve)=>S.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl bg-white/5 px-3 py-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold text-white",children:ne.label}),S.jsxs("p",{className:"text-[10px] text-white/60",children:["$",ne.price.toFixed(2)]})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>se(ve),children:"Remove"})]},`${ne.label}-${ve}`))})]})]}),Qz=({eventEnd:t,eventGenres:e,eventCoverUrl:s,eventDescription:l,posterPreview:f,posterFile:_,onEventEndChange:y,onEventGenresChange:d,onEventCoverUrlChange:A,onEventDescriptionChange:I,onPosterFileChange:B,onPosterRemove:N})=>{const V=Q.useRef(null),[K,se]=Q.useState(0),ne=!!(f||_),ve=Q.useMemo(()=>_?_.name:s.trim()?"Using poster URL":"Upload a poster or paste a URL (optional).",[s,_]);return S.jsxs("section",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"More info"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Optional details (poster, genres, description)."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Ends at"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",type:"datetime-local",value:t,onChange:re=>y(re.target.value)})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Genres"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:e,onChange:re=>d(re.target.value),placeholder:"Jazz, Experimental"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-start justify-between gap-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Poster"}),S.jsx("p",{className:"mt-1 text-xs text-white/60",children:ve})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:()=>V.current?.click(),children:"Upload"}),ne&&S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>{se(re=>re+1),N()},children:"Remove"})]})]}),S.jsx("input",{ref:V,type:"file",accept:"image/*",className:"hidden",onChange:re=>B(re.target.files?.[0]||null)},K),f&&S.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-black/30",children:S.jsx("img",{src:f,alt:"Event poster preview",className:"h-52 w-full object-cover"})}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Poster URL (optional)"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:s,onChange:re=>A(re.target.value),placeholder:"https://..."})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Description"}),S.jsx("textarea",{className:"min-h-[110px] w-full resize-none rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:l,onChange:re=>I(re.target.value),placeholder:"Optional details..."})]})]})},Gf=["Sala","Artista","Entrada","Ms info"],eD=({onDismiss:t,onCreated:e,userId:s,profileRole:l,profileCity:f,profileName:_,defaultArtistId:y,initialMapCenter:d})=>{const[A,I]=Q.useState(0),B=!!(l&&["artist","venue","label"].includes(l)),N=$z({userId:s,profileRole:l,profileCity:f,defaultArtistId:y,defaultArtistName:_||void 0,initialCenter:d||void 0}),V=Q.useMemo(()=>b2("venue","SALA"),[]),K=()=>I(ge=>Math.max(ge-1,0)),se=()=>I(ge=>Math.min(ge+1,Gf.length-1)),ne=async()=>{if(A<Gf.length-1){se();return}const ge=await N.handleCreate();ge&&(e?.(ge),t())},ve=()=>N.setVenueMode(ge=>ge==="existing"?"new":"existing"),re=(()=>{switch(A){case 0:return S.jsx(Uz,{venueMode:N.venueMode,onToggleVenueMode:ve,venueSearch:N.venueSearch,onVenueSearchChange:N.setVenueSearch,mapCenter:N.mapCenter,venueMarkers:N.venueMarkers,newVenueIcon:V,visibleVenues:N.visibleVenues,venuesLoading:N.venuesLoading,selectedVenue:N.selectedVenue,onSelectVenue:N.selectVenue,onClearVenue:()=>N.setSelectedVenue(null),onBoundsChange:N.handleBoundsChange,onMapSelect:N.handleMapSelect,venueLat:N.venueLat,venueLng:N.venueLng,newVenueName:N.newVenueName,newVenueCity:N.newVenueCity,newVenueAddress:N.newVenueAddress,newVenueLat:N.newVenueLat,newVenueLng:N.newVenueLng,onNewVenueNameChange:N.setNewVenueName,onNewVenueCityChange:N.setNewVenueCity,onNewVenueAddressChange:N.setNewVenueAddress,onNewVenueLatChange:N.setNewVenueLat,onNewVenueLngChange:N.setNewVenueLng});case 1:return S.jsx(Kz,{profileRole:l,profileName:_,artists:N.artists,selectedArtistIds:N.selectedArtistIds,artistsLoading:N.artistsLoading,artistSearch:N.artistSearch,artistSearchCount:N.artistSearchCount,onArtistSearchChange:N.setArtistSearch,onSelectArtists:N.setSelectedArtistIds});case 2:return S.jsx(Jz,{eventName:N.eventName,eventStart:N.eventStart,eventUrl:N.eventUrl,isFree:N.isFree,tierLabel:N.tierLabel,tierPrice:N.tierPrice,priceTiers:N.priceTiers,onEventNameChange:N.setEventName,onEventStartChange:N.setEventStart,onEventUrlChange:N.setEventUrl,onToggleFree:ge=>{N.setIsFree(ge),N.setError("")},onTierLabelChange:N.setTierLabel,onTierPriceChange:N.setTierPrice,onAddTier:N.addPriceTier,onRemoveTier:N.removePriceTier});default:return S.jsx(Qz,{eventEnd:N.eventEnd,eventGenres:N.eventGenres,eventCoverUrl:N.eventCoverUrl,eventDescription:N.eventDescription,posterPreview:N.posterPreview,posterFile:N.posterFile,onEventEndChange:N.setEventEnd,onEventGenresChange:N.setEventGenres,onEventCoverUrlChange:N.setEventCoverUrl,onEventDescriptionChange:N.setEventDescription,onPosterFileChange:N.setPosterFile,onPosterRemove:()=>N.setPosterFile(null)})}})();return S.jsxs("div",{className:"flex h-full max-h-[100vh] flex-col overflow-hidden rounded-3xl bg-app-bg",children:[S.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-4 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",children:"Create"}),S.jsx("h2",{className:"mt-1 font-display text-lg font-bold text-white",children:"Event"})]}),S.jsx("div",{className:"flex flex-1 justify-end",children:S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:t,children:"Close"})})]}),S.jsx("div",{className:"flex-shrink-0 px-4",children:S.jsx("div",{className:"flex items-center gap-3 overflow-x-auto pb-2",children:Gf.map((ge,oe)=>{const me=oe===A,ye=oe<A;return S.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[S.jsx("span",{className:`text-[10px] font-semibold uppercase tracking-[0.22em] ${me?"text-app-accent":ye?"text-white/70":"text-white/45"}`,children:ge}),oe<Gf.length-1&&S.jsx("span",{className:"text-white/20",children:""})]},ge)})})}),N.error&&S.jsx("div",{className:"flex-shrink-0 px-4 pt-3",children:S.jsx("p",{className:"text-sm text-rose-400",children:N.error})}),S.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-4 py-4",children:re}),S.jsx("div",{className:"flex-shrink-0 p-4 pt-0",children:S.jsxs("div",{className:"tw flex flex-col gap-2 sm:flex-row",children:[A>0&&S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 rounded-2xl bg-white/10 px-6 py-3 text-sm font-semibold text-white transition hover:bg-white/15 sm:w-auto",onClick:K,children:"Back"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 rounded-2xl bg-white/10 px-6 py-3 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:ne,disabled:N.saving||A===Gf.length-1&&!B,children:A===Gf.length-1?N.saving?"Creating...":"Create event":"Next"})]})})]})},tD=()=>{const t=Fr(),e=sf(),{user:s,profile:l,loading:f}=Vr(),{canCreateEvent:_,activeWorkspace:y,loading:d,ready:A}=mp(),I=Q.useRef(null),B=Q.useRef(null),N=Q.useRef(null),V=e.state?.from||"/tabs/events";Q.useEffect(()=>{A&&(I.current=_)},[A,_]),Q.useEffect(()=>{s||(I.current=null,B.current=null,N.current=null)},[s]),Q.useEffect(()=>{y&&(B.current=y)},[y]),Q.useEffect(()=>{l&&(N.current=l)},[l]);const K=A?_:I.current??!1,se=y??B.current,ne=l??N.current,ve=se?.type==="artist"&&(se.artist?.id||se.artist?.artist_id)||null,re=se?.type==="venue"?Number(se.venue?.latitude??se.venue?.lat??null):null,ge=se?.type==="venue"?Number(se.venue?.longitude??se.venue?.lng??null):null,oe=se?.type==="venue"&&Number.isFinite(re)&&Number.isFinite(ge)?[re,ge]:null;return f&&!s?S.jsx(Zh,{children:S.jsx(Ql,{fullscreen:!0,children:S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})})})}):s?(!A||d)&&!K?S.jsx(Zh,{children:S.jsx(Ql,{fullscreen:!0,children:S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})})})}):A&&!K?S.jsx(Ec,{to:"/tabs/events"}):S.jsx(Zh,{children:S.jsx(Ql,{fullscreen:!0,children:S.jsx(eD,{onDismiss:()=>t.push(V),onCreated:me=>{me?t.push(`/event/${me}`):t.push(V)},userId:s?.id,profileRole:se?.type||ne?.role||null,profileCity:se?.venue?.city||ne?.primary_city||null,profileName:se?.artist?.name||se?.venue?.name||ne?.display_name||ne?.username||null,defaultArtistId:ve,initialMapCenter:oe})})}):S.jsx(Ec,{to:"/welcome"})},iD=()=>{const t=Fr(),{updatePassword:e}=Vr(),[s,l]=Q.useState(""),[f,_]=Q.useState(""),[y,d]=Q.useState(!1),[A,I]=Q.useState(""),[B,N]=Q.useState("");Q.useEffect(()=>{(async()=>{const ne=new URLSearchParams(window.location.search).get("code");ne&&await Pt.auth.exchangeCodeForSession(ne);const{data:ve}=await Pt.auth.getSession();d(!!ve.session)})()},[]);const V=async()=>{if(N(""),I(""),!s||s.length<6){N("Password must be at least 6 characters.");return}if(s!==f){N("Passwords do not match.");return}const{error:K}=await e(s);if(K){N(K.message);return}I("Password updated. You can sign in now.")};return S.jsx(ao,{children:S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[!y&&S.jsx("p",{className:"text-sm text-white/70",children:"Open the reset link from your email to continue."}),y&&S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"New password"}),S.jsx("input",{type:"password",value:s,onChange:K=>l(K.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Confirm password"}),S.jsx("input",{type:"password",value:f,onChange:K=>_(K.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:V,children:"Update password"})]}),B&&S.jsx("p",{className:"text-sm text-rose-400",children:B}),A&&S.jsx("p",{className:"text-sm text-emerald-400",children:A}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>t.replace("/welcome"),children:"Back to sign in"})]})})},nD={async getEventPosts(t){const{data:e,error:s}=await Pt.from("v_posts_with_setlist").select("*").eq("event_id",t).order("event_offset_ms",{ascending:!0,nullsFirst:!1}).order("captured_at",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0});if(s)throw s;return e||[]},async getEventSetlist(t){const{data:e,error:s}=await Pt.from("event_setlist").select("*").eq("event_id",t).order("ordinal",{ascending:!0});if(s)throw s;return e||[]},async getSetlistEntryForOffset(t,e){const{data:s,error:l}=await Pt.rpc("get_setlist_entry_for_offset",{p_event_id:t,p_offset_ms:e});if(l)throw l;return s?.[0]||null}},ww=2082844800,wy=t=>t.toString().padStart(2,"0"),sD=t=>`${t.getFullYear()}-${wy(t.getMonth()+1)}-${wy(t.getDate())}T${wy(t.getHours())}:${wy(t.getMinutes())}`,rD=t=>{if(!t)return null;const e=new Date(t);return Number.isNaN(e.getTime())?null:e},aD=(t,e)=>e+4>t.byteLength?"":String.fromCharCode(t.getUint8(e),t.getUint8(e+1),t.getUint8(e+2),t.getUint8(e+3)),S2=(t,e)=>{const s=t.getUint32(e),l=t.getUint32(e+4);return s*2**32+l},Sw=(t,e,s)=>{if(e+8>s)return null;let l=t.getUint32(e);const f=aD(t,e+4);let _=8;if(l===1){if(e+16>s)return null;l=S2(t,e+8),_=16}else l===0&&(l=s-e);return l<_?null:{size:l,type:f,headerSize:_}},oD=(t,e,s)=>e+4>s?null:t.getUint8(e)===1?e+12>s?null:S2(t,e+4):e+8>s?null:t.getUint32(e+4),lD=t=>{const e=new DataView(t),s=e.byteLength;let l=0;for(;l+8<=s;){const f=Sw(e,l,s);if(!f)break;const _=Math.min(l+f.size,s);if(f.type==="moov"){let y=l+f.headerSize;for(;y+8<=_;){const d=Sw(e,y,_);if(!d)break;if(d.type==="mvhd"){const A=oD(e,y+d.headerSize,_);if(A!==null)return A}if(d.size<=0)break;y+=d.size}}if(f.size<=0)break;l+=f.size}return null},cD=async t=>{const s=[t.slice(0,2097152)];t.size>2097152&&s.push(t.slice(Math.max(t.size-2097152,0),t.size));for(const l of s)try{const f=await l.arrayBuffer(),_=lD(f);if(_&&_>ww){const y=new Date((_-ww)*1e3);if(!Number.isNaN(y.getTime()))return y}}catch{}return null},uD=async t=>{const e=t.type.startsWith("image/"),s=t.type.startsWith("video/");if(e)try{const l=await Ac(()=>import("./full.esm-DoFl4RTa.js"),[]),_=await(l.default??l).parse(t,["DateTimeOriginal","CreateDate","ModifyDate"]),y=_?.DateTimeOriginal||_?.CreateDate||_?.ModifyDate,d=y instanceof Date?y:typeof y=="string"?new Date(y):null;if(d&&!Number.isNaN(d.getTime()))return{capturedAt:d,source:"exif"}}catch{}if(s){const l=await cD(t);if(l)return{capturedAt:l,source:"video.metadata"}}return Number.isFinite(t.lastModified)&&t.lastModified>0?{capturedAt:new Date(t.lastModified),source:"file.lastModified"}:{capturedAt:null,source:null}},hD=async t=>{const e=new Date;return await Promise.all(t.map(async l=>{const{capturedAt:f,source:_}=await uD(l),y=l.type.startsWith("video")?"video":"image",d=f??e,A=f?_:"manual";return{id:typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`,file:l,previewUrl:URL.createObjectURL(l),mediaType:y,captureAt:f??d,captureSource:A??null,manualValue:sD(d)}}))},dD=({coverImageUrl:t,actions:e})=>S.jsx("section",{className:"relative h-[70vh] sm:h-[76vh]",children:S.jsxs("div",{className:"fixed inset-x-0 top-[calc(56px+env(safe-area-inset-top,0px))] z-0 h-[70vh] overflow-hidden sm:h-[76vh]",children:[S.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_14%_6%,rgba(255,107,74,0.24),transparent_52%)]"}),S.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_85%_12%,rgba(122,167,255,0.18),transparent_54%)]"}),t?S.jsx("img",{src:t,alt:"Event cover",className:"absolute inset-0 h-full w-full object-cover"}):null,S.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/95 via-black/62 to-black/24"}),e?S.jsx("div",{className:"absolute right-3 top-3 z-10 flex items-center gap-2 sm:right-4 sm:top-4 sm:gap-3",children:e}):null]})}),fD=(t,e,s)=>Math.min(s,Math.max(e,t)),gv=t=>{const e=Math.max(0,Math.round(t)),s=Math.floor(e/3600),l=Math.floor(e%3600/60),f=e%60;return s>0?`+${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`+${l.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},pD=({buckets:t,selectedIndex:e,onSelectIndex:s,eventStart:l,gapThresholdSeconds:f=120})=>{const _=Q.useRef(null),y=Q.useRef({offsets:[],maxOffset:1}),[d,A]=Q.useState(!1),I=Q.useMemo(()=>l||(t[0]?new Date(t[0].bucket_time):null),[l,t]),B=Q.useMemo(()=>I?t.map(oe=>{const me=Math.round((new Date(oe.bucket_time).getTime()-I.getTime())/1e3);return me<0?0:me}):[],[t,I]),N=Q.useMemo(()=>B.length===0?1:Math.max(...B,1),[B]),V=Q.useMemo(()=>{if(B.length<2||N<=0)return[];const oe=[];for(let me=0;me<B.length-1;me+=1){const ye=B[me],ke=B[me+1];if(ke<=ye)continue;const Re=ke-ye>f;oe.push({key:`${ye}-${ke}`,left:ye/N*100,width:(ke-ye)/N*100,isGap:Re})}return oe},[B,N,f]);Q.useEffect(()=>{y.current={offsets:B,maxOffset:N}},[B,N]);const K=Q.useCallback(oe=>{const me=_.current;if(!me||t.length===0)return;const ye=me.getBoundingClientRect();if(ye.width===0)return;const ke=fD((oe-ye.left)/ye.width,0,1),{offsets:Re,maxOffset:Ge}=y.current,He=ke*Ge;let Xe=0,at=Number.POSITIVE_INFINITY;Re.forEach((et,Et)=>{const gt=Math.abs(et-He);gt<at&&(at=gt,Xe=Et)}),s(Xe)},[t.length,s]),se=oe=>{_.current&&(_.current.setPointerCapture(oe.pointerId),A(!0),K(oe.clientX))},ne=oe=>{d&&K(oe.clientX)},ve=oe=>{_.current&&(_.current.hasPointerCapture(oe.pointerId)&&_.current.releasePointerCapture(oe.pointerId),A(!1))};if(t.length===0)return null;const re=B[e]??0,ge=N?re/N:0;return S.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/[0.03] p-3",children:[S.jsxs("div",{className:"relative h-8 cursor-pointer touch-none",ref:_,onPointerDown:se,onPointerMove:ne,onPointerUp:ve,onPointerCancel:ve,onPointerLeave:ve,children:[S.jsx("div",{className:"absolute inset-x-0 top-1/2 h-0.5 -translate-y-1/2 rounded-full bg-white/10"}),V.map(oe=>S.jsx("div",{className:`absolute top-1/2 h-0.5 -translate-y-1/2 rounded-full ${oe.isGap?"bg-[repeating-linear-gradient(90deg,rgba(255,255,255,0.08),rgba(255,255,255,0.08)_6px,transparent_6px,transparent_12px)]":"bg-white/30"}`,style:{left:`${oe.left}%`,width:`${oe.width}%`}},oe.key)),t.map((oe,me)=>{const ye=N?(B[me]??0)/N:0,ke=oe.moment_count>=5?3:oe.moment_count>=3?2:1,Re=ke===3?"h-3 w-3":ke===2?"h-2.5 w-2.5":"h-2 w-2";return S.jsx("button",{type:"button",className:`absolute top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full ${Re} ${me===e?"bg-app-accent":"bg-white/40"}`,style:{left:`${ye*100}%`},onClick:()=>s(me),children:S.jsx("span",{className:"sr-only",children:gv(B[me]??0)})},oe.bucket_time)}),S.jsx("div",{className:"pointer-events-none absolute top-1/2 h-4 w-4 -translate-x-1/2 -translate-y-1/2 rounded-full border-2 border-app-accent bg-app-accent/20 shadow-[0_0_0_4px_rgba(255,107,74,0.1)]",style:{left:`${ge*100}%`}})]}),S.jsxs("div",{className:"flex justify-between text-[11px] text-white/55",children:[S.jsx("span",{children:gv(0)}),S.jsx("span",{children:gv(N)})]})]})},mD=({moments:t,selectedIndex:e,onSelect:s})=>t.length<=1?null:S.jsx("div",{className:"flex gap-2.5 overflow-x-auto rounded-2xl border border-white/10 bg-white/[0.03] p-2",children:t.map((l,f)=>S.jsxs("button",{type:"button",className:`relative h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border transition-all hover:opacity-95 ${f===e?"border-app-accent shadow-[0_4px_10px_rgba(255,107,74,0.2)]":"border-white/10 bg-white/5"}`,onClick:()=>s(f),children:[l.media_type==="video"?l.thumbnail_url?S.jsx("img",{src:l.thumbnail_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"}):S.jsx("video",{muted:!0,preload:"metadata",className:"h-full w-full object-cover",children:S.jsx("source",{src:l.media_url})}):S.jsx("img",{src:l.media_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"}),S.jsxs("span",{className:"sr-only",children:["Moment ",f+1]})]},l.id))}),T2=t=>{const e=Math.max(0,Math.round(t)),s=Math.floor(e/3600),l=Math.floor(e%3600/60),f=e%60;return s>0?`+${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`+${l.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},gD=(t,e)=>{if(!t)return"";const s=new Date(t);if(e){const l=(s.getTime()-e.getTime())/1e3;return T2(l)}return s.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})},yD=(t,e)=>{if(!t)return"";const s=t.captured_at||t.created_at,l=new Date(s);if(e){const f=(l.getTime()-e.getTime())/1e3;return T2(f)}return l.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})},_D=({buckets:t,selectedBucketIndex:e,selectedMomentIndex:s,moments:l,loading:f,totalMoments:_,eventStart:y,mediaFilter:d,onSelectBucket:A,onSelectMoment:I,onAddMoments:B,onFilterChange:N,autoAdvance:V,onRequestNext:K})=>{const se=t[e]??null,ne=l[s]??null,ve=Q.useRef(null);Q.useEffect(()=>{if(!ne||ne.media_type!=="video")return;const oe=ve.current;if(!oe)return;const me=oe.play();me&&typeof me.catch=="function"&&me.catch(()=>{})},[ne?.id]);const re=Q.useMemo(()=>gD(se?.bucket_time??null,y),[se?.bucket_time,y]),ge=Q.useMemo(()=>yD(ne,y),[ne,y]);return S.jsxs("section",{className:"flex flex-col gap-4",children:[S.jsx("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur-sm",children:S.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-[0.24em] text-white/60",children:"Timeline"}),S.jsx("p",{className:"mt-1.5 font-display text-2xl font-bold text-white",children:re||"+00:00"}),_>0&&S.jsxs("p",{className:"mt-1 text-xs text-white/55",children:[_," moments"]})]}),S.jsx("div",{className:"inline-flex items-center rounded-full border border-white/15 bg-black/25 p-1",children:["all","video","image"].map(oe=>S.jsx("button",{type:"button",className:`rounded-full px-3 py-1.5 text-[10px] font-semibold uppercase tracking-[0.2em] transition-all ${d===oe?"bg-app-accent text-white shadow-[0_4px_10px_rgba(255,107,74,0.22)]":"text-white/60 hover:text-white"}`,onClick:()=>N(oe),children:oe==="all"?"All":oe==="video"?"Video":"Photos"},oe))})]})}),S.jsx("div",{className:"-mx-4 px-4",children:S.jsx("div",{className:`relative aspect-video overflow-hidden rounded-2xl border border-white/10 bg-black/70 ${f?"opacity-90":""}`,children:f?S.jsx("div",{className:"flex h-full items-center justify-center bg-white/[0.03]",children:S.jsx(Js,{name:"crescent"})}):ne?S.jsxs("div",{className:"relative h-full w-full animate-[timeline-fade_0.35s_ease]",onClick:()=>{const oe=ve.current;oe&&(oe.paused?oe.play().catch(()=>{}):oe.pause())},children:[ne.media_type==="video"?S.jsx("video",{ref:ve,playsInline:!0,muted:!0,autoPlay:!0,className:"h-full w-full object-cover",onEnded:()=>{V&&K&&K()},poster:ne.thumbnail_url||void 0,children:S.jsx("source",{src:ne.media_url})}):S.jsx("img",{src:ne.media_url,alt:ne.caption||"Moment",className:"h-full w-full object-cover"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/90 via-black/55 to-transparent p-4",children:[ne.resolved_song_title&&S.jsx("div",{className:"mb-2 inline-flex items-center gap-1.5 rounded-full border border-white/20 bg-black/45 px-2.5 py-1",children:S.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.22em] text-white/80",children:ne.resolved_song_title})}),S.jsx("p",{className:"text-xs text-white/65",children:ge}),S.jsx("h4",{className:"mt-1.5 font-display text-lg font-bold text-white",children:ne.actor_name||ne.profiles?.display_name||ne.profiles?.username||"Anonymous"})]})]},ne.id):S.jsxs("div",{className:"flex min-h-full flex-col items-center justify-center gap-2 px-6 text-center",children:[S.jsx("p",{className:"text-lg font-semibold text-white",children:"No moments yet."}),S.jsx("span",{className:"text-xs text-white/55",children:"Relive the show by adding the first clip."}),B&&S.jsx("button",{type:"button",className:"mt-2 inline-flex items-center rounded-full border border-app-accent/40 bg-app-accent/20 px-3 py-1.5 text-[10px] font-semibold uppercase tracking-[0.2em] text-app-accent",onClick:B,children:"Add the first moment"})]})})}),S.jsx(pD,{buckets:t,selectedIndex:e,onSelectIndex:A,eventStart:y,gapThresholdSeconds:120}),S.jsx(mD,{moments:l,selectedIndex:s,onSelect:I})]})},vD=({isOpen:t,onClose:e,link:s})=>{const[l,f]=Q.useState("");Q.useEffect(()=>{t||f("")},[t]);const _=async()=>{if(s)try{await navigator.clipboard.writeText(s),f("Link copied.")}catch{f("Copy failed. Long-press to copy.")}},y=async()=>{if(s){if(navigator.share)try{await navigator.share({url:s,title:"Live Space event"});return}catch{}_()}};return S.jsx(c_,{isOpen:t,onDidDismiss:e,initialBreakpoint:.5,breakpoints:[0,.5,.9],className:"share-sheet",children:S.jsx(Ql,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Share"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:e,children:"Close"})]}),S.jsx("div",{className:"mt-6 flex items-center justify-center bg-white/5 p-5",children:s&&S.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${encodeURIComponent(s)}`,alt:"Event QR",className:"h-40 w-40 bg-white"})}),S.jsxs("div",{className:"mt-6 space-y-2",children:[S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:_,children:[S.jsx(uI,{className:"h-4 w-4"}),"Copy link"]}),S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:y,children:[S.jsx(AS,{className:"h-4 w-4"}),"Share"]})]}),l&&S.jsx("p",{className:"mt-4 text-sm text-white/55",children:l})]})})})},xD=()=>{const t=Fr(),e=sf(),{id:s}=Qm(),{user:l,profile:f,isManagementMode:_,activeEntity:y}=Vr(),[d,A]=Q.useState(null),[I,B]=Q.useState(!0),[N,V]=Q.useState(""),[K,se]=Q.useState([]),[ne,ve]=Q.useState(!1),[re,ge]=Q.useState(""),[oe,me]=Q.useState([]),[ye,ke]=Q.useState([]),[Re,Ge]=Q.useState(!1),[He,Xe]=Q.useState(0),[at,et]=Q.useState(0),[Et,gt]=Q.useState(!1),[pt,$e]=Q.useState([]),[ct,We]=Q.useState(!1),[Tt,lt]=Q.useState({current:0,total:0}),[xe,Ce]=Q.useState(""),[st,ot]=Q.useState(""),[_t,kt]=Q.useState(!1),[It,ei]=Q.useState(!1),[li,Gi]=Q.useState("video"),[Mi,Di]=Q.useState({all:0,video:0,image:0}),[Pn,hn]=Q.useState(!1),[zn,it]=Q.useState(null),[Qn,qn]=Q.useState(!1),[wi,fi]=Q.useState(!1),[xn,Hn]=Q.useState(!1),[es,Xi]=Q.useState(""),[Ki,Wi]=Q.useState(!1),gs=Q.useRef(null),Ct=Q.useRef([]),In=Q.useRef(null),an=Q.useRef(null),Tn=Q.useRef({}),Zn=Q.useRef({});Q.useEffect(()=>{e.state?.openAddMoments&&(Wi(!0),t.replace({pathname:e.pathname,search:e.search,hash:e.hash,state:{}}))},[t,e.hash,e.pathname,e.search,e.state?.openAddMoments]),Q.useEffect(()=>{Ct.current=pt},[pt]),Q.useEffect(()=>()=>{Ct.current.forEach(ut=>URL.revokeObjectURL(ut.previewUrl)),In.current&&window.clearTimeout(In.current),an.current&&window.clearTimeout(an.current)},[]);const jt=async()=>{B(!0),V("");try{const{data:ut,error:Ft}=await Pt.from("events").select(`
          *,
          organizer:profiles!events_organizer_id_fkey (
            id,
            username,
            display_name,
            avatar_url,
            role
          ),
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude,
            website_url,
            photos
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `).eq("id",s).single();if(Ft||!ut){V("Event not found."),A(null);return}A(ut);const Ti=await nD.getEventSetlist(s);ke(Ti)}catch{V("Could not load this event. Check your Supabase connection."),A(null)}finally{B(!1)}},ri=async ut=>{ve(!0),ge(""),Tn.current={},Zn.current={};try{let Ft=null;if(ut==="all")Ft=await Pt.rpc("event_moment_buckets",{p_event_id:s});else{const Li=await Pt.rpc("event_moment_buckets_filtered",{p_event_id:s,p_media_type:ut});Li.error?Ft=await Pt.rpc("event_moment_buckets",{p_event_id:s}):Ft=Li}if(Ft?.error)throw Ft.error;const Ti=Ft?.data||[],en=Ti.length>0?Ti.length-1:0;se(Ti),Xe(en),et(0)}catch(Ft){se([]),ge(Ft?.message||"Could not load the timeline.")}finally{ve(!1)}},Jt=async()=>{try{const ut=Pt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",s),Ft=Pt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",s).eq("media_type","video"),Ti=Pt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",s).eq("media_type","image"),[{count:en},{count:Li},{count:vr}]=await Promise.all([ut,Ft,Ti]),On={all:en??0,video:Li??0,image:vr??0};Di(On),li==="video"&&On.video===0&&On.image>0&&Gi("image"),li==="image"&&On.image===0&&On.video>0&&Gi("video"),li!=="all"&&On.video===0&&On.image===0&&Gi("all")}catch{Di({all:0,video:0,image:0})}},Bi=async(ut,Ft,Ti)=>{if(!ut)return;const en=`${Ti}:${ut}`;if(Tn.current[en]){Ft&&(me(Tn.current[en]),et(0));return}if(!Zn.current[en]){Zn.current[en]=!0,Ft&&Ge(!0);try{const Li=new Date(ut),vr=new Date(Li.getTime()+1e3),On=Li.toISOString(),Is=vr.toISOString();let Ir=Pt.from("v_event_posts_with_setlist").select(`
          *,
          profiles:profiles!posts_user_id_fkey (
            id,
            username,
            display_name,
            avatar_url
          )
        `).eq("event_id",s).or(`and(captured_at.gte.${On},captured_at.lt.${Is}),and(captured_at.is.null,created_at.gte.${On},created_at.lt.${Is})`).order("event_offset_ms",{ascending:!0,nullsFirst:!1}).order("captured_at",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0});Ti!=="all"&&(Ir=Ir.eq("media_type",Ti));const{data:rr,error:yi}=await Ir;if(yi)throw yi;const An=rr||[];Tn.current[en]=An,Ft&&(me(An),et(0))}catch{Ft&&me([])}finally{Zn.current[en]=!1,Ft&&Ge(!1)}}},jn=(ut,Ft)=>{if(ut<0||ut>=K.length)return;const Ti=K[ut];Bi(Ti.bucket_time,!1,Ft)};Q.useEffect(()=>{Tn.current={},Zn.current={},se([]),me([]),Xe(0),et(0),$e([]),gt(!1),jt(),Jt()},[s]),Q.useEffect(()=>{ri(li)},[s,li]),Q.useEffect(()=>{He>=K.length&&K.length>0&&Xe(0)},[K,He]);const ci=K[He]??null,xs=Q.useMemo(()=>{const ut=K.reduce((Ft,Ti)=>Ft+Ti.moment_count,0);return li==="video"?Mi.video||ut:li==="image"?Mi.image||ut:Mi.all||ut},[K,Mi,li]);Q.useEffect(()=>{if(!ci){me([]);return}Bi(ci.bucket_time,!0,li),jn(He-1,li),jn(He+1,li)},[ci?.bucket_time,li]),Q.useEffect(()=>{(async()=>{if(!l||!s){ei(!1),it(null);return}try{const[{data:Ft},{data:Ti}]=await Promise.all([Pt.from("event_saves").select("event_id").eq("event_id",s).eq("user_id",l.id).limit(1),Pt.from("event_attendance").select("status").eq("event_id",s).eq("user_id",l.id).limit(1)]);ei(!!(Ft&&Ft.length>0)),it(Ti?.[0]?.status??null)}catch{ei(!1),it(null)}})()},[l,s]);const Dn=Q.useMemo(()=>{if(!d)return[];const ut=[],Ft=new Set,Ti=Li=>{!Li||Ft.has(Li.id)||(ut.push({id:Li.id,name:Li.display_name||Li.username||"Unknown",role:Li.role}),Ft.add(Li.id))},en=Li=>{!Li||Ft.has(Li.id)||(ut.push({id:Li.id,name:Li.name||"Unknown Artist",role:"artist_entity"}),Ft.add(Li.id))};return Ti(d.organizer),Ti(d.venue),d.event_artists?.forEach(Li=>en(Li.artist)),ut},[d]),$n=Q.useMemo(()=>{if(!d)return"Event";const ut=d.event_artists?.find(Ti=>Ti.artist)?.artist;return ut?ut.name:(d.organizer&&d.organizer.role!=="venue"?d.organizer.display_name||d.organizer.username:null)||d.name},[d]),Ji=Q.useMemo(()=>{if(!d)return null;const ut=d.venue_place?.name||d.venue?.display_name||d.venue?.username||d.address||"Venue TBA",Ft=new Date(d.starts_at).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return S.jsxs("span",{className:"flex flex-wrap items-center gap-2",children:[d.venue_place?S.jsx("button",{type:"button",className:"font-semibold text-white transition-colors hover:text-app-accent",onClick:()=>t.push(`/tabs/venue/${d.venue_place?.id}`),children:ut}):S.jsx("span",{className:"font-semibold text-white",children:ut}),S.jsx("span",{className:"text-white/50",children:""}),S.jsx("span",{className:"text-white/80",children:Ft})]})},[d,t]),be=Q.useMemo(()=>d?new Date(d.starts_at):null,[d]),ie=Q.useMemo(()=>d?.ends_at?new Date(d.ends_at):null,[d]),te=(ut,Ft)=>{Ft==="artist_entity"?t.push(`/tabs/artist/${ut}`):t.push(`/profile/${ut}`)},he=ut=>ut==="artist"||ut==="artist_entity"?"Artist":ut==="venue"?"Venue":ut==="label"?"Label":"User",we=()=>{gs.current?.click()},je=()=>{if(Ce(""),ot(""),!l){t.push("/welcome");return}if(!d){Ce("Event not found.");return}we()},Ne=async ut=>{const Ft=Array.from(ut.target.files||[]);if(!Ft.length)return;const Ti=await hD(Ft);$e(en=>[...en,...Ti]),gt(!0),ut.target.value=""},Ze=(ut,Ft)=>{const Ti=rD(Ft);$e(en=>en.map(Li=>Li.id===ut?{...Li,manualValue:Ft,captureAt:Ti,captureSource:Ft?"manual":null}:Li))},ee=ut=>{$e(Ft=>Ft.map(Ti=>Ti.id===ut?{...Ti,manualValue:"",captureAt:null,captureSource:null}:Ti))},Le=ut=>{$e(Ft=>{const Ti=Ft.find(en=>en.id===ut);return Ti&&URL.revokeObjectURL(Ti.previewUrl),Ft.filter(en=>en.id!==ut)})},Ue=async()=>{if(Ce(""),ot(""),!l){Ce("Sign in to upload moments.");return}if(!d){Ce("Event not found.");return}if(pt.length===0){Ce("Select at least one photo or video.");return}We(!0),lt({current:0,total:pt.length});try{for(let ut=0;ut<pt.length;ut+=1){const Ft=pt[ut];lt({current:ut+1,total:pt.length});const Ti=Ft.mediaType==="video",en=Ft.file.name.split(".").pop()||(Ti?"mp4":"jpg"),vr=`${Ti?"videos":"images"}/${l.id}/${d.id}/${Date.now()}-${Ft.id}.${en}`,{error:On}=await Pt.storage.from("media").upload(vr,Ft.file,{cacheControl:"3600",upsert:!1});if(On)throw On;const{data:Is}=Pt.storage.from("media").getPublicUrl(vr),Ir=_&&y?y.subject_id:f?.subject_id,{error:rr}=await Pt.from("posts").insert({user_id:l.id,actor_subject_id:Ir,event_id:d.id,media_url:Is.publicUrl,media_type:Ft.mediaType,captured_at:Ft.captureAt?Ft.captureAt.toISOString():null,capture_source:Ft.captureSource});if(rr)throw rr}await Ve("attended",{force:!0}),ot("Moments uploaded!"),ZS(`posts:count:user:${l.id}:event:${d.id}`),$e(ut=>(ut.forEach(Ft=>URL.revokeObjectURL(Ft.previewUrl)),[])),gt(!1),Jt(),ri(li)}catch(ut){Ce(ut?.message||"Upload failed. Try again.")}finally{We(!1)}},Oe=async()=>{if(!(!l||!d)){Xi(""),hn(!0);try{if(It){const{error:ut}=await Pt.from("event_saves").delete().eq("event_id",d.id).eq("user_id",l.id);if(ut)throw ut;ei(!1)}else{const{error:ut}=await Pt.from("event_saves").insert({event_id:d.id,user_id:l.id});if(ut)throw ut;ei(!0)}}catch(ut){Xi(ut?.message||"Could not update follow state.")}finally{hn(!1)}}},Ve=async(ut,Ft)=>{if(!l||!d)return!1;Xi(""),qn(!0);try{if(!Ft?.force&&zn===ut){const{error:en}=await Pt.from("event_attendance").delete().eq("event_id",d.id).eq("user_id",l.id);if(en)throw en;return it(null),!0}const{error:Ti}=await Pt.from("event_attendance").upsert({event_id:d.id,user_id:l.id,status:ut},{onConflict:"event_id,user_id"});if(Ti)throw Ti;return it(ut),!0}catch(Ti){return Xi(Ti?.message||"Could not update attendance."),!1}finally{qn(!1)}},Bt=d?`${window.location.origin}/event/${d.id}${d.qr_token?`?token=${d.qr_token}`:""}`:"",qt=new Date,Dt=be?ie?qt>ie:qt.getTime()>be.getTime()+360*60*1e3:!1,At=Dt?"attended":"going",ti=Dt?"Went":"Going",pi=zn===At,ji="relative inline-flex items-center gap-2 overflow-hidden rounded-full border px-3 py-2 text-[11px] font-bold uppercase tracking-[0.16em] text-white/90 backdrop-blur-md transition-all duration-200 hover:border-white/40 hover:text-white disabled:cursor-not-allowed disabled:opacity-60 motion-reduce:transition-none",Qi="border-white/25 bg-[linear-gradient(145deg,rgba(3,6,12,0.72),rgba(12,18,30,0.82))]",gi="border-[#ff6b4a]/80 bg-[linear-gradient(140deg,rgba(255,107,74,0.3),rgba(255,107,74,0.16)_65%,rgba(13,18,30,0.88))] text-white shadow-[0_0_0_1px_rgba(255,107,74,0.2),0_4px_12px_rgba(0,0,0,0.18)]",qi="border-[#25d47b]/80 bg-[linear-gradient(140deg,rgba(37,212,123,0.28),rgba(37,212,123,0.14)_65%,rgba(13,18,30,0.88))] text-white shadow-[0_0_0_1px_rgba(37,212,123,0.2),0_4px_12px_rgba(0,0,0,0.18)]",on="border-[#f3bf4a]/80 bg-[linear-gradient(140deg,rgba(243,191,74,0.26),rgba(243,191,74,0.13)_65%,rgba(13,18,30,0.88))] text-white shadow-[0_0_0_1px_rgba(243,191,74,0.2),0_4px_12px_rgba(0,0,0,0.18)]",Qe=ut=>{if(ut==="follow"){fi(!1),In.current&&window.clearTimeout(In.current),window.requestAnimationFrame(()=>{fi(!0),In.current=window.setTimeout(()=>fi(!1),420)});return}Hn(!1),an.current&&window.clearTimeout(an.current),window.requestAnimationFrame(()=>{Hn(!0),an.current=window.setTimeout(()=>Hn(!1),420)})},Ot=()=>{if(Qe("follow"),!l){t.push("/welcome");return}Oe()},ui=()=>{if(Qe("attendance"),!l){t.push("/welcome");return}Ve(At)},ln=()=>{if(oe.length>at+1){et(ut=>ut+1);return}He+1<K.length&&(Xe(ut=>ut+1),et(0))};return S.jsxs(ao,{contentWrapperClassName:!1,children:[I&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})}),!I&&N&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:N})}),!I&&d&&S.jsxs(S.Fragment,{children:[S.jsx(dD,{coverImageUrl:d.cover_image_url??void 0,actions:S.jsxs(S.Fragment,{children:[S.jsxs("button",{type:"button",className:`${ji} ${It?gi:Qi} ${wi?"scale-[1.02]":""}`,onClick:Ot,disabled:Pn,"aria-pressed":It,children:[S.jsx("span",{className:`pointer-events-none absolute inset-0 rounded-full border border-current ${wi?"animate-ping opacity-40 motion-reduce:animate-none":"opacity-0"}`}),S.jsx("span",{className:`inline-flex items-center justify-center ${wi?"animate-pulse motion-reduce:animate-none":""}`,children:It?S.jsx(oI,{className:"h-[19px] w-[19px]"}):S.jsx(kS,{className:"h-[19px] w-[19px]"})}),S.jsx("span",{children:"Follow"})]}),S.jsxs("button",{type:"button",className:`${ji} ${pi?Dt?on:qi:Qi} ${xn?"scale-[1.02]":""}`,onClick:ui,disabled:Qn,"aria-pressed":pi,children:[S.jsx("span",{className:`pointer-events-none absolute inset-0 rounded-full border border-current ${xn?"animate-ping opacity-40 motion-reduce:animate-none":"opacity-0"}`}),S.jsx("span",{className:`inline-flex items-center justify-center ${xn?"animate-pulse motion-reduce:animate-none":""}`,children:S.jsx(CS,{className:"h-[19px] w-[19px]"})}),S.jsx("span",{children:ti})]})]})}),S.jsx("div",{className:"relative z-10 -mt-16 rounded-t-[28px] border-t border-white/10 bg-app-bg/95 backdrop-blur-xl sm:-mt-20",children:S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(110px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-[0.2em] text-white/65",children:"Event"}),S.jsx("h1",{className:"font-display text-3xl font-bold leading-tight text-white sm:text-4xl",children:$n}),Ji?S.jsx("div",{className:"text-sm text-white/80",children:Ji}):null,Dn.length>0&&S.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:Dn.map(ut=>S.jsxs("button",{type:"button",className:"inline-flex items-center rounded-full border border-white/20 bg-black/25 px-3 py-1.5 text-[10px] font-semibold uppercase tracking-[0.18em] text-white/80 transition-colors hover:border-white/40 hover:text-white",onClick:()=>te(ut.id,ut.role),children:[ut.name,"  ",he(ut.role)]},ut.id))})]}),Ki&&S.jsxs("div",{className:"rounded-2xl border border-app-accent/30 bg-[linear-gradient(135deg,rgba(255,107,74,0.18),rgba(255,107,74,0.06)_60%,rgba(255,255,255,0.02))] p-4 shadow-[0_8px_18px_rgba(0,0,0,0.18)]",children:[S.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-[0.24em] text-app-accent",children:"Relive"}),S.jsx("p",{className:"mt-2 font-display text-lg font-bold text-white",children:"Add your moments"}),S.jsx("p",{className:"mt-1 text-xs text-white/70",children:"Share what you lived before the memory fades."}),S.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-app-accent px-4 py-2 text-sm font-semibold text-white",onClick:je,children:"Add your moments"}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-full border border-white/15 bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>Wi(!1),children:"Not now"})]})]}),es&&S.jsx("p",{className:"text-sm text-rose-400",children:es}),re&&S.jsx("p",{className:"text-sm text-rose-400",children:re}),ye.length>0&&S.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/[0.04] p-4",children:[S.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-[0.24em] text-white/60",children:"Official setlist"}),S.jsx("div",{className:"mt-3 flex flex-col gap-2",children:ye.map(ut=>S.jsx("div",{className:"flex items-center justify-between rounded-lg border border-white/5 bg-white/[0.03] px-3 py-2 text-xs",children:S.jsxs("span",{className:"text-white/80",children:[S.jsxs("span",{className:"mr-2 text-white/45",children:[ut.ordinal,"."]}),ut.song_title||"Unknown Song"]})},ut.ordinal))})]}),S.jsx(_D,{buckets:K,selectedBucketIndex:He,selectedMomentIndex:at,moments:oe,loading:Re||ne&&oe.length===0,totalMoments:xs,eventStart:be,mediaFilter:li,onSelectBucket:ut=>{Xe(ut),et(0)},onSelectMoment:ut=>et(ut),onAddMoments:je,onFilterChange:Gi,autoAdvance:li==="video",onRequestNext:ln})]})}),!Et&&S.jsxs("button",{type:"button",onClick:je,className:"fixed bottom-[calc(18px+env(safe-area-inset-bottom,0px))] right-4 z-[1400] inline-flex items-center gap-2 rounded-full border border-app-accent/45 bg-[linear-gradient(135deg,rgba(255,107,74,0.95),rgba(255,138,110,0.92))] px-4 py-3 text-sm font-semibold text-white shadow-[0_8px_20px_rgba(255,107,74,0.3)] transition-transform duration-200 hover:scale-[1.03] active:scale-[0.98] motion-reduce:transition-none",children:[S.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-black/20",children:S.jsx(aI,{className:"h-4 w-4"})}),S.jsx("span",{children:"Add moment"})]})]}),S.jsx(c_,{isOpen:Et,onDidDismiss:()=>gt(!1),children:S.jsx(Ql,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Add moments"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>gt(!1),disabled:ct,children:"Close"})]}),pt.length===0&&S.jsx("p",{className:"text-sm text-white/55",children:"Select photos or videos to add moments."}),pt.map(ut=>S.jsxs("div",{className:"mt-4 space-y-3 bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx("div",{className:"h-20 w-20 overflow-hidden bg-black",children:ut.mediaType==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:ut.previewUrl})}):S.jsx("img",{src:ut.previewUrl,alt:ut.file.name,className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"flex-1 space-y-1",children:[S.jsx("p",{className:"text-sm font-semibold text-white",children:ut.file.name}),S.jsx("p",{className:"text-xs text-white/55",children:ut.captureAt?ut.captureAt.toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Upload time"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>Le(ut.id),children:"Remove"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Captured time"}),S.jsx("input",{type:"datetime-local",className:"w-full bg-white/10 px-4 py-3 text-sm text-white/85 focus:outline-none",value:ut.manualValue,onChange:Ft=>Ze(ut.id,Ft.target.value)})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>ee(ut.id),children:"Use upload time"})]},ut.id)),xe&&S.jsx("p",{className:"text-sm text-rose-400",children:xe}),st&&S.jsx("p",{className:"text-sm text-emerald-400",children:st}),ct&&S.jsxs("p",{className:"text-xs text-white/55",children:["Uploading ",Tt.current,"/",Tt.total]}),S.jsx("button",{type:"button",className:"mt-4 inline-flex w-full items-center justify-center bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:Ue,disabled:ct||pt.length===0,children:ct?"Uploading...":"Upload moments"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:we,disabled:ct,children:"Add more"})]})})}),S.jsx(vD,{isOpen:_t,onClose:()=>kt(!1),link:Bt}),S.jsx("input",{ref:gs,type:"file",accept:"image/*,video/*",multiple:!0,onChange:Ne,className:"hidden"})]})},bD=()=>{const t=Fr(),{id:e}=Qm(),{user:s,profile:l}=Vr(),[f,_]=Q.useState(null),[y,d]=Q.useState([]),[A,I]=Q.useState([]),[B,N]=Q.useState([]),[V,K]=Q.useState(!0),[se,ne]=Q.useState(""),[ve,re]=Q.useState(!1),[ge,oe]=Q.useState(!1),[me,ye]=Q.useState(0);Q.useEffect(()=>{(async()=>{K(!0),ne("");try{const{data:He,error:Xe}=await Pt.from("profiles").select("*").eq("id",e).single();if(Xe||!He)throw Xe;if(_(He),He.subject_id){const[gt,pt]=await Promise.all([fu.getFollowersCount(He.subject_id),s&&l?.subject_id?fu.isFollowing(l.subject_id,He.subject_id):Promise.resolve(!1)]);ye(gt),re(pt)}const at=`
          *,
          organizer:profiles!events_organizer_id_fkey (
            id,
            username,
            display_name,
            role
          ),
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `;let et=[],Et=[];if(He.role==="artist"){const{data:gt}=await Pt.from("event_artists").select("event_id").eq("artist_entity_id",e);if(et=(gt||[]).map(pt=>pt.event_id),et.length>0){const{data:pt}=await Pt.from("events").select(at).in("id",et).order("starts_at",{ascending:!1});Et=pt||[]}}else if(He.role==="venue"){const{data:gt}=await Pt.from("venue_places").select("*").eq("created_by",e).order("name",{ascending:!0}),pt=gt||[];d(pt);const $e=pt.map(ct=>ct.id).filter(Boolean);if($e.length>0){const{data:ct}=await Pt.from("events").select(at).in("venue_place_id",$e).order("starts_at",{ascending:!1});Et=ct||[],et=Et.map(We=>We.id)}else Et=[],et=[]}else if(He.role==="label"){const{data:gt}=await Pt.from("events").select(at).eq("organizer_id",e).order("starts_at",{ascending:!1});Et=gt||[],et=Et.map(pt=>pt.id)}if(I(Et),et.length>0){const{data:gt}=await Pt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",et).order("created_at",{ascending:!1}).limit(18);N(gt||[])}else N([])}catch{ne("Profile not found.")}finally{K(!1)}})()},[e,s,l?.subject_id]);const ke=async()=>{if(!s||!l?.subject_id||!f?.subject_id){s||t.push("/welcome");return}oe(!0);try{ve?(await fu.unfollow(l.subject_id,f.subject_id),re(!1),ye(Ge=>Math.max(0,Ge-1))):(await fu.follow(l.subject_id,f.subject_id),re(!0),ye(Ge=>Ge+1))}catch(Ge){console.error("Failed to toggle follow",Ge)}finally{oe(!1)}},Re=Q.useMemo(()=>{const Ge=f?.external_links||{};return Object.entries(Ge).map(([He,Xe])=>({key:He,value:Xe})).filter(He=>!!He.value)},[f]);return S.jsxs(ao,{children:[V&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})}),!V&&se&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:se})}),!V&&f&&S.jsxs(S.Fragment,{children:[S.jsxs("section",{className:"relative h-[340px] w-full overflow-hidden bg-black",children:[f.avatar_url?S.jsx("img",{src:f.avatar_url,alt:f.display_name||"Profile",className:"absolute inset-0 h-full w-full object-cover"}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:f.role.toUpperCase()}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:f.display_name||f.username||"Unknown"}),f.primary_city&&S.jsx("p",{className:"mt-2 text-sm text-white/70",children:f.primary_city}),S.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:[me," followers"]}),s&&f.id!==s.id&&S.jsx("button",{type:"button",disabled:ge,onClick:ke,className:`px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${ve?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:ge?S.jsx(Js,{name:"crescent"}):ve?"Following":"Follow"})]})]})]}),S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[f.bio&&S.jsx("p",{className:"text-sm text-white/70",children:f.bio}),Re.length>0&&S.jsxs("section",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Links"}),S.jsx("div",{className:"space-y-2 text-sm",children:Re.map(Ge=>S.jsx("a",{href:Ge.value,target:"_blank",rel:"noreferrer",className:"block text-white/70 hover:text-white",children:Ge.value.replace(/^https?:\/\//,"")},Ge.key))})]}),f.role==="venue"&&y.length>0&&S.jsxs("section",{className:"space-y-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venues"}),S.jsx("div",{className:"space-y-6",children:y.map(Ge=>S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"font-display text-lg font-bold text-white",children:Ge.name}),S.jsx("p",{className:"text-sm text-white/70",children:Ge.address||Ge.city}),(Ge.venue_type||Ge.capacity)&&S.jsxs("p",{className:"text-xs text-white/55",children:[Ge.venue_type||"Venue",Ge.capacity?`  ${Ge.capacity} cap`:""]})]}),Ge.website_url&&S.jsx("a",{href:Ge.website_url,target:"_blank",rel:"noreferrer",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:Ge.website_url.replace(/^https?:\/\//,"")}),(Ge.photos||[]).length>0&&S.jsx("div",{className:"-mx-4 flex gap-2 overflow-x-auto pb-1",children:Ge.photos.slice(0,8).map((He,Xe)=>S.jsx("div",{className:"h-28 w-44 flex-shrink-0 overflow-hidden bg-white/5",children:S.jsx("img",{src:He,alt:"Venue",className:"h-full w-full object-cover"})},`${He}-${Xe}`))})]},Ge.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Events"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Shows connected to this profile."})]}),A.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No events yet."}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:A.map(Ge=>S.jsx(Jl,{event:Ge,className:"w-full",onSelect:He=>t.push(`/event/${He.id}`)},Ge.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Latest media from connected events."})]}),B.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No moments yet."}):S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:B.map(Ge=>S.jsx("button",{type:"button",onClick:()=>t.push(`/post/${Ge.id}`),className:"aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:Ge.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:Ge.media_url})}):S.jsx("img",{src:Ge.media_url,alt:Ge.caption||"Moment",className:"h-full w-full object-cover"})},Ge.id))})]}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>t.goBack(),children:"Back"})]})]})]})},wD=()=>{const{id:t}=Qm(),e=Fr(),[s,l]=Q.useState(null),[f,_]=Q.useState(!0),[y,d]=Q.useState(""),A=s?.events??null;return Q.useEffect(()=>{(async()=>{_(!0),d("");try{const{data:B,error:N}=await Pt.from("posts").select(`
            id,
            media_url,
            media_type,
            thumbnail_url,
            caption,
            created_at,
            profiles:profiles!posts_user_id_fkey (
              id,
              username,
              display_name,
              avatar_url
            ),
            events:events!posts_event_id_fkey (
              id,
              name,
              city,
              starts_at,
              cover_image_url,
              address,
              venue_place:venue_places!events_venue_place_id_fkey (
                id,
                name,
                city,
                address
              )
            )
          `).eq("id",t).single();if(N||!B)throw N;l(B)}catch{d("Post not found."),l(null)}finally{_(!1)}})()},[t]),S.jsxs(ao,{children:[f&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})}),!f&&y&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:y})}),!f&&s&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[s.media_type==="video"?S.jsx("video",{controls:!0,playsInline:!0,className:"absolute inset-0 h-full w-full object-cover",poster:s.thumbnail_url||s.events?.cover_image_url||void 0,children:S.jsx("source",{src:s.media_url})}):S.jsx("img",{src:s.media_url,alt:s.caption||"Moment",className:"absolute inset-0 h-full w-full object-cover"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moment"}),S.jsx("h2",{className:"mt-2 font-display text-2xl font-bold text-white",children:s.caption||"Relive the moment"}),S.jsxs("p",{className:"mt-2 text-sm text-white/70",children:[(s.profiles?.username?`@${s.profiles.username}`:s.profiles?.display_name)||"Anonymous","  ",new Date(s.created_at).toLocaleString()]})]})]}),S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("div",{className:"flex gap-2",children:[S.jsxs("button",{type:"button",className:"inline-flex flex-1 items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",children:[S.jsx(ES,{className:"h-4 w-4"}),"Like"]}),S.jsxs("button",{type:"button",className:"inline-flex flex-1 items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",children:[S.jsx(AS,{className:"h-4 w-4"}),"Share"]})]}),A&&S.jsxs("button",{type:"button",onClick:()=>e.push(`/event/${A.id}`),className:"bg-white/5 p-4 text-left",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Event"}),S.jsx("p",{className:"mt-2 font-display text-lg font-bold text-white",children:A.name}),S.jsxs("p",{className:"mt-1 text-sm text-white/70",children:[A.venue_place?.name||A.address||"Venue","  ",new Date(A.starts_at).toLocaleString()]}),S.jsx("p",{className:"mt-2 text-xs text-white/55",children:"View event details"})]})]})]})]})},SD=()=>{const{id:t}=Qm(),e=Fr(),{user:s,profile:l}=Vr(),[f,_]=Q.useState(null),[y,d]=Q.useState([]),[A,I]=Q.useState([]),[B,N]=Q.useState(!0),[V,K]=Q.useState(""),[se,ne]=Q.useState(!1),[ve,re]=Q.useState(!1),[ge,oe]=Q.useState(0);Q.useEffect(()=>{(async()=>{N(!0),K("");try{const{data:Re,error:Ge}=await Pt.from("venue_places").select("*").eq("id",t).single();if(Ge||!Re)throw Ge;let He=null;try{const{data:Et,error:gt}=await Pt.rpc("get_or_create_venue_subject",{p_venue_place_id:Re.id});!gt&&typeof Et=="string"&&(He=Et)}catch{}const{data:Xe,error:at}=await Pt.from("events").select(`
            *,
            organizer:profiles!events_organizer_id_fkey (
              id,
              username,
              display_name,
              role
            ),
            venue_place:venue_places!events_venue_place_id_fkey (
              id,
              name,
              city,
              address,
              latitude,
              longitude
            ),
            event_artists (
              artist:artists!event_artists_artist_entity_fk (
                id,
                name,
                avatar_url
              )
            )
          `).eq("venue_place_id",t).order("starts_at",{ascending:!1});if(at)throw at;if(_({...Re,subject_id:He}),d(Xe||[]),He){const[Et,gt]=await Promise.all([fu.getFollowersCount(He),s&&l?.subject_id?fu.isFollowing(l.subject_id,He):Promise.resolve(!1)]);oe(Et),ne(gt)}const et=(Xe||[]).map(Et=>Et.id);if(et.length>0){const{data:Et}=await Pt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",et).order("created_at",{ascending:!1}).limit(18);I(Et||[])}else I([])}catch{K("Venue not found."),_(null),d([]),I([])}finally{N(!1)}})()},[t,s,l?.subject_id]);const me=async()=>{if(!s||!l?.subject_id||!f?.subject_id){s||e.push("/welcome");return}re(!0);try{se?(await fu.unfollow(l.subject_id,f.subject_id),ne(!1),oe(ke=>Math.max(0,ke-1))):(await fu.follow(l.subject_id,f.subject_id),ne(!0),oe(ke=>ke+1))}catch(ke){console.error("Failed to toggle follow",ke)}finally{re(!1)}},ye=Q.useMemo(()=>f?f.address&&f.city?`${f.address}  ${f.city}`:f.address||f.city||"":"",[f]);return S.jsxs(ao,{children:[B&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Js,{name:"crescent"})}),!B&&V&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:V})}),!B&&f&&S.jsxs(S.Fragment,{children:[S.jsxs("section",{className:"relative h-[340px] w-full overflow-hidden bg-black",children:[(f.photos||[])[0]?S.jsx("img",{src:(f.photos||[])[0],alt:f.name,className:"absolute inset-0 h-full w-full object-cover"}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venue"}),S.jsx("h1",{className:"mt-2 font-display text-3xl font-bold text-white",children:f.name}),ye&&S.jsx("p",{className:"mt-2 text-sm text-white/70",children:ye}),S.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:[ge," followers"]}),s&&S.jsx("button",{type:"button",disabled:ve,onClick:me,className:`px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${se?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:ve?S.jsx(Js,{name:"crescent"}):se?"Following":"Follow"})]})]})]}),S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[(f.photos||[]).length>1&&S.jsx("section",{className:"-mx-4 flex gap-2 overflow-x-auto pb-1",children:(f.photos||[]).slice(1,8).map((ke,Re)=>S.jsx("div",{className:"h-36 w-52 flex-shrink-0 overflow-hidden bg-white/5",children:S.jsx("img",{src:ke,alt:`Venue ${f.name}`,className:"h-full w-full object-cover"})},`${ke}-${Re}`))}),(f.venue_type||f.capacity)&&S.jsxs("p",{className:"text-xs text-white/55",children:[f.venue_type||"Venue",f.capacity?`  ${f.capacity} cap`:""]}),f.website_url&&S.jsx("a",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",href:f.website_url,target:"_blank",rel:"noreferrer",children:f.website_url.replace(/^https?:\/\//,"")}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Events"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"All shows hosted here."})]}),y.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No events here yet."}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:y.map(ke=>S.jsx(Jl,{event:ke,className:"w-full",onSelect:Re=>e.push(`/event/${Re.id}`)},ke.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Latest media from this room."})]}),A.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No memories here yet."}):S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:A.map(ke=>S.jsx("button",{type:"button",onClick:()=>e.push(`/post/${ke.id}`),className:"aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:ke.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:ke.media_url})}):S.jsx("img",{src:ke.media_url,alt:ke.caption||"Moment",className:"h-full w-full object-cover"})},ke.id))})]}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>e.goBack(),children:"Back"})]})]})]})},TD=[{key:"grant",label:"Grant Access",href:"/admin/grants"},{key:"artist",label:"Create Artist",href:"/admin/create-artist"},{key:"venue",label:"Create Venue",href:"/admin/create-venue"},{key:"list",label:"View Access Grants",href:"/admin/access-grants"}],y_=({active:t})=>S.jsx("div",{className:"grid gap-3 rounded-2xl border border-white/10 bg-white/5 p-3 sm:grid-cols-2",children:TD.map(e=>{const s=e.key===t;return S.jsx("a",{href:e.href,className:`flex min-h-[72px] items-center justify-center rounded-xl border px-4 py-3 text-base font-semibold uppercase tracking-[0.12em] transition ${s?"border-app-ink bg-app-ink text-white shadow-lg shadow-app-ink/30":"border-white/10 bg-white/5 text-app-light/80 hover:border-app-ink/40 hover:text-white"}`,children:e.label},e.key)})}),ED=()=>{const{profile:t}=Vr(),[e,s]=Q.useState(!1),[l,f]=Q.useState(null),[_,y]=Q.useState(""),[d,A]=Q.useState([]),[I,B]=Q.useState(null),[N,V]=Q.useState(""),[K,se]=Q.useState("artist"),[ne,ve]=Q.useState([]),[re,ge]=Q.useState(null);Q.useEffect(()=>{_.length>2?Cm.searchProfiles(_).then(A):A([])},[_]),Q.useEffect(()=>{N.length>2?K==="artist"?Cm.searchArtists(N).then(ve):Cm.searchVenues(N).then(ve):ve([])},[N,K]);const oe=async()=>{if(!(!I||!re)){s(!0),f(null);try{await Cm.adminGrantEntityAccess(I.id,K,re.id,"admin"),f({type:"success",text:"Access granted successfully"}),B(null),ge(null),y(""),V("")}catch(me){f({type:"error",text:me.message||"Failed to grant access"})}finally{s(!1)}}};return t?.role!=="admin"?S.jsx(Zh,{children:S.jsx(Ql,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsx(ao,{headerProps:{title:"Admin Grants",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-10 py-6",children:[S.jsx(y_,{active:"grant"}),S.jsxs("section",{className:"space-y-3 rounded-2xl border border-white/10 bg-white/5 p-4",children:[S.jsx("div",{className:"flex items-center justify-between",children:S.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider text-app-light/70",children:"Grant Access"})}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Grant a user access to manage an artist or venue."}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wider text-app-light/50",children:"Find User"}),S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:"Search by username or display name...",value:_,onChange:me=>y(me.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),d.length>0&&!I&&S.jsx("div",{className:"absolute top-full z-10 mt-1 w-full overflow-hidden rounded-xl border border-white/10 bg-[#1A1D25] shadow-xl",children:d.map(me=>S.jsxs("button",{onClick:()=>{B(me),y(me.username||me.display_name)},className:"flex w-full items-center gap-3 p-3 text-left hover:bg-white/5",children:[me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-app-ink/20 text-xs font-bold text-app-ink",children:me.username?.[0]?.toUpperCase()||"?"}),S.jsxs("div",{children:[S.jsx("div",{className:"font-medium text-app-light",children:me.username}),S.jsx("div",{className:"text-xs text-app-light/50",children:me.display_name})]})]},me.id))})]}),I&&S.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-app-ink/10 p-3",children:[S.jsxs("span",{className:"text-sm text-app-ink",children:["Selected: ",S.jsx("strong",{children:I.username})]}),S.jsx("button",{onClick:()=>B(null),className:"text-xs text-app-ink hover:underline",children:"Clear"})]})]}),S.jsxs("div",{className:"space-y-3 pt-2",children:[S.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wider text-app-light/50",children:"Select Entity"}),S.jsxs("div",{className:"flex gap-2 rounded-xl bg-white/5 p-1",children:[S.jsx("button",{onClick:()=>{se("artist"),ge(null),V("")},className:`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${K==="artist"?"bg-app-ink text-white":"text-app-light/60 hover:text-app-light"}`,children:"Artist"}),S.jsx("button",{onClick:()=>{se("venue"),ge(null),V("")},className:`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${K==="venue"?"bg-app-ink text-white":"text-app-light/60 hover:text-app-light"}`,children:"Venue"})]}),S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:`Search for ${K}...`,value:N,onChange:me=>V(me.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),ne.length>0&&!re&&S.jsx("div",{className:"absolute top-full z-10 mt-1 w-full overflow-hidden rounded-xl border border-white/10 bg-[#1A1D25] shadow-xl",children:ne.map(me=>S.jsxs("button",{onClick:()=>{ge(me),V(me.name)},className:"flex w-full items-center gap-3 p-3 text-left hover:bg-white/5",children:[me.image_url?S.jsx("img",{src:me.image_url,alt:"",className:"h-8 w-8 rounded-lg object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-white/10 text-xs font-bold text-app-light/40",children:me.name[0]}),S.jsxs("div",{children:[S.jsx("div",{className:"font-medium text-app-light",children:me.name}),me.city&&S.jsx("div",{className:"text-xs text-app-light/50",children:me.city})]})]},me.id))})]}),re&&S.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-app-ink/10 p-3",children:[S.jsxs("span",{className:"text-sm text-app-ink",children:["Selected: ",S.jsx("strong",{children:re.name})]}),S.jsx("button",{onClick:()=>ge(null),className:"text-xs text-app-ink hover:underline",children:"Clear"})]})]}),S.jsxs("div",{className:"pt-4",children:[l&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${l.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:l.text}),S.jsx("button",{disabled:!I||!re||e,onClick:oe,className:"flex w-full items-center justify-center rounded-2xl bg-app-ink py-4 font-bold text-white shadow-lg shadow-app-ink/20 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:e?S.jsx(Js,{name:"crescent",color:"light"}):"Grant Access"})]})]})]})})},kD={async createArtist(t){const{data:e,error:s}=await Pt.from("artists").insert(t).select().single();if(s)throw s;const{data:l,error:f}=await Pt.rpc("get_or_create_artist_subject",{p_artist_id:e.id});if(f)throw f;return{...e,subject_id:l}},async getArtistBySubject(t){const{data:e,error:s}=await Pt.from("v_subject_artists").select("*").eq("subject_id",t).maybeSingle();if(s)throw s;return e},async updateArtist(t,e){const{data:s,error:l}=await Pt.from("artists").update(e).eq("id",t).select().single();if(l)throw l;return s}},CD=()=>{const{profile:t}=Vr(),[e,s]=Q.useState(""),[l,f]=Q.useState(""),[_,y]=Q.useState("solo"),[d,A]=Q.useState(""),[I,B]=Q.useState(""),[N,V]=Q.useState(!1),[K,se]=Q.useState(null),ne=async()=>{if(!e.trim()){se({type:"error",text:"Artist name is required"});return}V(!0),se(null);try{const ve=d.split(",").map(re=>re.trim()).filter(Boolean);await kD.createArtist({name:e.trim(),artist_type:_,city:l.trim()||null,bio:null,avatar_url:I.trim()||null,genres:ve,external_links:{}}),se({type:"success",text:"Artist created successfully"}),s(""),f(""),A(""),B(""),y("solo")}catch(ve){se({type:"error",text:ve.message||"Failed to create artist"})}finally{V(!1)}};return t?.role!=="admin"?S.jsx(Zh,{children:S.jsx(Ql,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsx(ao,{headerProps:{title:"Create Artist",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-6 py-6",children:[S.jsx(y_,{active:"artist"}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Create an artist entity so you can publish and assign access."}),S.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[S.jsx("input",{type:"text",placeholder:"Artist name *",value:e,onChange:ve=>s(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"City",value:l,onChange:ve=>f(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsxs("select",{value:_,onChange:ve=>y(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50",children:[S.jsx("option",{value:"solo",children:"Solo"}),S.jsx("option",{value:"band",children:"Band"})]}),S.jsx("input",{type:"text",placeholder:"Avatar URL",value:I,onChange:ve=>B(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Genres (comma separated)",value:d,onChange:ve=>A(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"})]}),S.jsxs("div",{className:"pt-2",children:[K&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${K.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:K.text}),S.jsx("button",{disabled:N,onClick:ne,className:"flex w-full items-center justify-center rounded-2xl bg-white/10 py-4 font-bold text-app-light shadow-lg shadow-white/10 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:N?S.jsx(Js,{name:"crescent",color:"light"}):"Create Artist"})]})]})})},AD={async createVenue(t){const{data:e,error:s}=await Pt.from("venue_places").insert(t).select().single();if(s)throw s;const{data:l,error:f}=await Pt.rpc("get_or_create_venue_subject",{p_venue_place_id:e.id});if(f)throw f;return{...e,subject_id:l}},async getVenueBySubject(t){const{data:e,error:s}=await Pt.from("v_subject_venues").select("*").eq("subject_id",t).maybeSingle();if(s)throw s;return e},async updateVenue(t,e){const{data:s,error:l}=await Pt.from("venue_places").update(e).eq("id",t).select().single();if(l)throw l;return s}},MD=()=>{const{profile:t}=Vr(),[e,s]=Q.useState(""),[l,f]=Q.useState(""),[_,y]=Q.useState(""),[d,A]=Q.useState(""),[I,B]=Q.useState(""),[N,V]=Q.useState(""),[K,se]=Q.useState(!1),[ne,ve]=Q.useState(null),re=async()=>{if(!e.trim()||!l.trim()){ve({type:"error",text:"Venue name and city are required"});return}se(!0),ve(null);try{const ge=N?Number(N):null;await AD.createVenue({name:e.trim(),city:l.trim(),address:d.trim()||null,capacity:Number.isNaN(ge)?null:ge,venue_type:_.trim()||null,latitude:null,longitude:null,website_url:I.trim()||null,photos:[],created_by:t?.id??null}),ve({type:"success",text:"Venue created successfully"}),s(""),f(""),A(""),B(""),V(""),y("")}catch(ge){ve({type:"error",text:ge.message||"Failed to create venue"})}finally{se(!1)}};return t?.role!=="admin"?S.jsx(Zh,{children:S.jsx(Ql,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsx(ao,{headerProps:{title:"Create Venue",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-6 py-6",children:[S.jsx(y_,{active:"venue"}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Create a venue entity to manage events and content."}),S.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[S.jsx("input",{type:"text",placeholder:"Venue name *",value:e,onChange:ge=>s(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"City *",value:l,onChange:ge=>f(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Type (club, theatre...)",value:_,onChange:ge=>y(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Website",value:I,onChange:ge=>B(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Address",value:d,onChange:ge=>A(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"}),S.jsx("input",{type:"number",placeholder:"Capacity",value:N,onChange:ge=>V(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"})]}),S.jsxs("div",{className:"pt-2",children:[ne&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${ne.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:ne.text}),S.jsx("button",{disabled:K,onClick:re,className:"flex w-full items-center justify-center rounded-2xl bg-white/10 py-4 font-bold text-app-light shadow-lg shadow-white/10 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:K?S.jsx(Js,{name:"crescent",color:"light"}):"Create Venue"})]})]})})},PD=()=>{const{profile:t}=Vr(),[e,s]=Q.useState(!0),[l,f]=Q.useState(null),[_,y]=Q.useState([]);if(Q.useEffect(()=>{const I=async()=>{s(!0),f(null);try{const{data:B,error:N}=await Pt.from("entity_members").select(`
            admin_subject_id,
            entity_subject_id,
            role,
            created_at,
            admin:admin_subject_id (
              profile:profile_id (
                id,
                username,
                display_name,
                avatar_url
              )
            ),
            entity:entity_subject_id (
              type,
              profile:profile_id (
                username,
                display_name
              ),
              venue_place:venue_place_id (
                name,
                city
              ),
              artist:artist_id (
                name,
                city
              )
            )
          `).order("created_at",{ascending:!1});if(N)throw N;y(B)}catch(B){f(B.message||"Failed to load access grants")}finally{s(!1)}};t?.role==="admin"&&I()},[t]),t?.role!=="admin")return S.jsx(Zh,{children:S.jsx(Ql,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})});const d=I=>I.entity?I.entity.type==="artist"&&I.entity.artist?I.entity.artist.name:I.entity.type==="venue"&&I.entity.venue_place?I.entity.venue_place.name:I.entity.profile&&(I.entity.profile.display_name||I.entity.profile.username)||I.entity_subject_id:I.entity_subject_id,A=I=>I.entity?I.entity.type==="artist"&&I.entity.artist?.city?I.entity.artist.city:I.entity.type==="venue"&&I.entity.venue_place?.city?I.entity.venue_place.city:"":"";return S.jsx(ao,{headerProps:{title:"Access Grants",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-3xl space-y-8 py-6",children:[S.jsx(y_,{active:"list"}),S.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wider text-app-light/70",children:"Granted Accesses"}),e&&S.jsx(Js,{name:"crescent",color:"light"})]}),l&&S.jsx("div",{className:"mt-3 rounded-xl bg-red-500/10 p-3 text-sm text-red-300",children:l}),!e&&!l&&_.length===0&&S.jsx("div",{className:"mt-3 rounded-xl border border-white/10 bg-white/5 p-4 text-sm text-app-light/70",children:"No access grants found."}),S.jsx("div",{className:"mt-4 space-y-3",children:_.map(I=>S.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-white/10 bg-black/20 p-3",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"h-10 w-10 overflow-hidden rounded-full bg-white/10",children:I.admin?.profile?.avatar_url?S.jsx("img",{src:I.admin.profile.avatar_url,alt:"",className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-full w-full items-center justify-center text-xs font-bold text-app-light/70",children:I.admin?.profile?.username?.[0]?.toUpperCase()||"?"})}),S.jsxs("div",{children:[S.jsx("div",{className:"text-sm font-semibold text-app-light",children:I.admin?.profile?.display_name||I.admin?.profile?.username||"Unknown admin"}),S.jsx("div",{className:"text-xs uppercase tracking-widest text-app-light/50",children:I.role})]})]}),S.jsxs("div",{className:"text-right",children:[S.jsx("div",{className:"text-sm font-semibold text-app-light",children:d(I)}),S.jsxs("div",{className:"text-xs text-app-light/60",children:[I.entity?.type?I.entity.type.toUpperCase():"Entity"," ",A(I)&&` ${A(I)}`]})]})]},`${I.admin_subject_id}-${I.entity_subject_id}`))})]})]})})},ID=()=>{const{user:t,loading:e}=Vr(),{activeWorkspace:s,loading:l}=mp(),f=s?.type==="artist"&&(s.artist?.id||s.artist?.artist_id)||null,_=s?.type==="venue"&&(s.venue?.id||s.venue?.venue_place_id)||null,y=s?.type==="artist"&&f?`/tabs/artist/${f}`:s?.type==="venue"&&_?`/tabs/venue/${_}`:"/tabs/profile",d={"--background":"rgba(11, 11, 13, 0.92)","--border":"none","--color":"rgba(255, 255, 255, 0.62)","--color-selected":"#ffffff","--padding-top":"6px","--padding-bottom":"6px","--padding-start":"10px","--padding-end":"10px","--border-radius":"0px","--background-focused":"rgba(255, 107, 74, 0.16)"},A=e&&!t;return S.jsxs(lS,{children:[S.jsxs(rI,{children:[S.jsx(sR,{}),S.jsxs(ip,{children:[S.jsx(Ks,{exact:!0,path:"/welcome",render:()=>!e&&!t?S.jsx(lR,{}):S.jsx(Ec,{to:"/tabs/events"})}),S.jsx(Ks,{exact:!0,path:"/event/:id",component:xD}),S.jsx(Ks,{exact:!0,path:"/profile/:id",component:bD}),S.jsx(Ks,{exact:!0,path:"/post/:id",component:wD}),S.jsx(Ks,{exact:!0,path:"/discover",render:()=>S.jsx(Ec,{to:"/tabs/discover"})}),S.jsx(Ks,{exact:!0,path:"/artist/:id",render:({match:I})=>S.jsx(Ec,{to:`/tabs/artist/${I.params.id}`})}),S.jsx(Ks,{exact:!0,path:"/venue/:id",render:({match:I})=>S.jsx(Ec,{to:`/tabs/venue/${I.params.id}`})}),S.jsx(Ks,{exact:!0,path:"/admin/grants",component:ED}),S.jsx(Ks,{exact:!0,path:"/admin/create-artist",component:CD}),S.jsx(Ks,{exact:!0,path:"/admin/create-venue",component:MD}),S.jsx(Ks,{exact:!0,path:"/admin/access-grants",component:PD}),S.jsx(Ks,{exact:!0,path:"/reset",component:iD}),S.jsx(Ks,{exact:!0,path:"/create-event",component:tD}),S.jsx(Ks,{path:"/tabs",render:()=>!e&&!t?S.jsx(Ec,{to:"/welcome"}):S.jsxs(QM,{children:[S.jsxs(ip,{children:[S.jsx(Ks,{exact:!0,path:"/tabs/feed",component:cR}),S.jsx(Ks,{exact:!0,path:"/tabs/map",component:xz}),S.jsx(Ks,{exact:!0,path:"/tabs/discover",component:zz}),S.jsx(Ks,{exact:!0,path:"/tabs/events",component:QR}),S.jsx(Ks,{exact:!0,path:"/tabs/profile",render:()=>(console.log("[profile-route] workspace loading:",l,"workspace:",s),s?.type==="artist"&&f?S.jsx(Ec,{to:`/tabs/artist/${f}`}):s?.type==="venue"&&_?S.jsx(Ec,{to:`/tabs/venue/${_}`}):S.jsx(ez,{}))}),S.jsx(Ks,{exact:!0,path:"/tabs/artist/:id",component:w2}),S.jsx(Ks,{exact:!0,path:"/tabs/venue/:id",component:SD}),S.jsx(Ks,{exact:!0,path:"/tabs",render:()=>S.jsx(Ec,{to:"/tabs/events"})})]}),S.jsxs(iP,{slot:"bottom",className:"h-16 px-2 py-2",style:d,children:[S.jsxs(Zd,{tab:"events",href:"/tabs/events",children:[S.jsx(TS,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Main"})]}),S.jsxs(Zd,{tab:"discover",href:"/tabs/discover",children:[S.jsx(mI,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Discover"})]}),S.jsxs(Zd,{tab:"map",href:"/tabs/map",children:[S.jsx(h_,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Map"})]}),S.jsxs(Zd,{tab:"profile",href:y,children:[S.jsx(Ay,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Profile"})]})]})]})}),S.jsx(Ks,{exact:!0,path:"/",render:()=>S.jsx(Ec,{to:e||t?"/tabs/events":"/welcome"})})]})]}),A&&S.jsx("div",{className:"pointer-events-none fixed inset-0 z-[5000] flex items-center justify-center bg-black/35 backdrop-blur",children:S.jsx(Js,{name:"crescent"})})]})},jD=({children:t})=>S.jsx(QL,{children:S.jsx(tR,{children:S.jsx(nR,{children:t})})});oP();B2.createRoot(document.getElementById("root")).render(S.jsx(jD,{children:S.jsx(ID,{})}));export{I1 as K,Oy as a,Jd as b,hx as c,Mm as d,XT as e,jv as f,KT as g,Rv as h,Nk as i,Vs as j,pu as k,BD as l,UD as m,vn as n,RD as o,LD as p,Sy as r,$D as s,Rm as w};
