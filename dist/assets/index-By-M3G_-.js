(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const _ of f)if(_.type==="childList")for(const y of _.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&l(y)}).observe(document,{childList:!0,subtree:!0});function r(f){const _={};return f.integrity&&(_.integrity=f.integrity),f.referrerPolicy&&(_.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?_.credentials="include":f.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function l(f){if(f.ep)return;f.ep=!0;const _=r(f);fetch(f.href,_)}})();function Xh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P_={exports:{}},xm={};var sb;function b2(){if(sb)return xm;sb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(l,f,_){var y=null;if(_!==void 0&&(y=""+_),f.key!==void 0&&(y=""+f.key),"key"in f){_={};for(var d in f)d!=="key"&&(_[d]=f[d])}else _=f;return f=_.ref,{$$typeof:t,type:l,key:y,ref:f!==void 0?f:null,props:_}}return xm.Fragment=e,xm.jsx=r,xm.jsxs=r,xm}var rb;function w2(){return rb||(rb=1,P_.exports=b2()),P_.exports}var S=w2(),j_={exports:{}},bm={},I_={exports:{}},L_={};var ab;function S2(){return ab||(ab=1,(function(t){function e(Be,ct){var ut=Be.length;Be.push(ct);e:for(;0<ut;){var Et=ut-1>>>1,ot=Be[Et];if(0<f(ot,ct))Be[Et]=ct,Be[ut]=ot,ut=Et;else break e}}function r(Be){return Be.length===0?null:Be[0]}function l(Be){if(Be.length===0)return null;var ct=Be[0],ut=Be.pop();if(ut!==ct){Be[0]=ut;e:for(var Et=0,ot=Be.length,xe=ot>>>1;Et<xe;){var Le=2*(Et+1)-1,tt=Be[Le],rt=Le+1,gt=Be[rt];if(0>f(tt,ut))rt<ot&&0>f(gt,tt)?(Be[Et]=gt,Be[rt]=ut,Et=rt):(Be[Et]=tt,Be[Le]=ut,Et=Le);else if(rt<ot&&0>f(gt,ut))Be[Et]=gt,Be[rt]=ut,Et=rt;else break e}}return ct}function f(Be,ct){var ut=Be.sortIndex-ct.sortIndex;return ut!==0?ut:Be.id-ct.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var _=performance;t.unstable_now=function(){return _.now()}}else{var y=Date,d=y.now();t.unstable_now=function(){return y.now()-d}}var A=[],j=[],B=1,N=null,V=3,Q=!1,ne=!1,J=!1,ye=!1,re=typeof setTimeout=="function"?setTimeout:null,ge=typeof clearTimeout=="function"?clearTimeout:null,le=typeof setImmediate<"u"?setImmediate:null;function me(Be){for(var ct=r(j);ct!==null;){if(ct.callback===null)l(j);else if(ct.startTime<=Be)l(j),ct.sortIndex=ct.expirationTime,e(A,ct);else break;ct=r(j)}}function be(Be){if(J=!1,me(Be),!ne)if(r(A)!==null)ne=!0,ke||(ke=!0,Ye());else{var ct=r(j);ct!==null&&Tt(be,ct.startTime-Be)}}var ke=!1,Me=-1,Ue=5,Fe=-1;function He(){return ye?!0:!(t.unstable_now()-Fe<Ue)}function lt(){if(ye=!1,ke){var Be=t.unstable_now();Fe=Be;var ct=!0;try{e:{ne=!1,J&&(J=!1,ge(Me),Me=-1),Q=!0;var ut=V;try{t:{for(me(Be),N=r(A);N!==null&&!(N.expirationTime>Be&&He());){var Et=N.callback;if(typeof Et=="function"){N.callback=null,V=N.priorityLevel;var ot=Et(N.expirationTime<=Be);if(Be=t.unstable_now(),typeof ot=="function"){N.callback=ot,me(Be),ct=!0;break t}N===r(A)&&l(A),me(Be)}else l(A);N=r(A)}if(N!==null)ct=!0;else{var xe=r(j);xe!==null&&Tt(be,xe.startTime-Be),ct=!1}}break e}finally{N=null,V=ut,Q=!1}ct=void 0}}finally{ct?Ye():ke=!1}}}var Ye;if(typeof le=="function")Ye=function(){le(lt)};else if(typeof MessageChannel<"u"){var Mt=new MessageChannel,et=Mt.port2;Mt.port1.onmessage=lt,Ye=function(){et.postMessage(null)}}else Ye=function(){re(lt,0)};function Tt(Be,ct){Me=re(function(){Be(t.unstable_now())},ct)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Be){Be.callback=null},t.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ue=0<Be?Math.floor(1e3/Be):5},t.unstable_getCurrentPriorityLevel=function(){return V},t.unstable_next=function(Be){switch(V){case 1:case 2:case 3:var ct=3;break;default:ct=V}var ut=V;V=ct;try{return Be()}finally{V=ut}},t.unstable_requestPaint=function(){ye=!0},t.unstable_runWithPriority=function(Be,ct){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var ut=V;V=Be;try{return ct()}finally{V=ut}},t.unstable_scheduleCallback=function(Be,ct,ut){var Et=t.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?Et+ut:Et):ut=Et,Be){case 1:var ot=-1;break;case 2:ot=250;break;case 5:ot=1073741823;break;case 4:ot=1e4;break;default:ot=5e3}return ot=ut+ot,Be={id:B++,callback:ct,priorityLevel:Be,startTime:ut,expirationTime:ot,sortIndex:-1},ut>Et?(Be.sortIndex=ut,e(j,Be),r(A)===null&&Be===r(j)&&(J?(ge(Me),Me=-1):J=!0,Tt(be,ut-Et))):(Be.sortIndex=ot,e(A,Be),ne||Q||(ne=!0,ke||(ke=!0,Ye()))),Be},t.unstable_shouldYield=He,t.unstable_wrapCallback=function(Be){var ct=V;return function(){var ut=V;V=ct;try{return Be.apply(this,arguments)}finally{V=ut}}}})(L_)),L_}var ob;function T2(){return ob||(ob=1,I_.exports=S2()),I_.exports}var z_={exports:{}},on={};var lb;function E2(){if(lb)return on;lb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),y=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),j=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),V=Symbol.iterator;function Q(xe){return xe===null||typeof xe!="object"?null:(xe=V&&xe[V]||xe["@@iterator"],typeof xe=="function"?xe:null)}var ne={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},J=Object.assign,ye={};function re(xe,Le,tt){this.props=xe,this.context=Le,this.refs=ye,this.updater=tt||ne}re.prototype.isReactComponent={},re.prototype.setState=function(xe,Le){if(typeof xe!="object"&&typeof xe!="function"&&xe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,xe,Le,"setState")},re.prototype.forceUpdate=function(xe){this.updater.enqueueForceUpdate(this,xe,"forceUpdate")};function ge(){}ge.prototype=re.prototype;function le(xe,Le,tt){this.props=xe,this.context=Le,this.refs=ye,this.updater=tt||ne}var me=le.prototype=new ge;me.constructor=le,J(me,re.prototype),me.isPureReactComponent=!0;var be=Array.isArray;function ke(){}var Me={H:null,A:null,T:null,S:null},Ue=Object.prototype.hasOwnProperty;function Fe(xe,Le,tt){var rt=tt.ref;return{$$typeof:t,type:xe,key:Le,ref:rt!==void 0?rt:null,props:tt}}function He(xe,Le){return Fe(xe.type,Le,xe.props)}function lt(xe){return typeof xe=="object"&&xe!==null&&xe.$$typeof===t}function Ye(xe){var Le={"=":"=0",":":"=2"};return"$"+xe.replace(/[=:]/g,function(tt){return Le[tt]})}var Mt=/\/+/g;function et(xe,Le){return typeof xe=="object"&&xe!==null&&xe.key!=null?Ye(""+xe.key):Le.toString(36)}function Tt(xe){switch(xe.status){case"fulfilled":return xe.value;case"rejected":throw xe.reason;default:switch(typeof xe.status=="string"?xe.then(ke,ke):(xe.status="pending",xe.then(function(Le){xe.status==="pending"&&(xe.status="fulfilled",xe.value=Le)},function(Le){xe.status==="pending"&&(xe.status="rejected",xe.reason=Le)})),xe.status){case"fulfilled":return xe.value;case"rejected":throw xe.reason}}throw xe}function Be(xe,Le,tt,rt,gt){var Pt=typeof xe;(Pt==="undefined"||Pt==="boolean")&&(xe=null);var Ot=!1;if(xe===null)Ot=!0;else switch(Pt){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(xe.$$typeof){case t:case e:Ot=!0;break;case B:return Ot=xe._init,Be(Ot(xe._payload),Le,tt,rt,gt)}}if(Ot)return gt=gt(xe),Ot=rt===""?"."+et(xe,0):rt,be(gt)?(tt="",Ot!=null&&(tt=Ot.replace(Mt,"$&/")+"/"),Be(gt,Le,tt,"",function(Vi){return Vi})):gt!=null&&(lt(gt)&&(gt=He(gt,tt+(gt.key==null||xe&&xe.key===gt.key?"":(""+gt.key).replace(Mt,"$&/")+"/")+Ot)),Le.push(gt)),1;Ot=0;var ei=rt===""?".":rt+":";if(be(xe))for(var gi=0;gi<xe.length;gi++)rt=xe[gi],Pt=ei+et(rt,gi),Ot+=Be(rt,Le,tt,Pt,gt);else if(gi=Q(xe),typeof gi=="function")for(xe=gi.call(xe),gi=0;!(rt=xe.next()).done;)rt=rt.value,Pt=ei+et(rt,gi++),Ot+=Be(rt,Le,tt,Pt,gt);else if(Pt==="object"){if(typeof xe.then=="function")return Be(Tt(xe),Le,tt,rt,gt);throw Le=String(xe),Error("Objects are not valid as a React child (found: "+(Le==="[object Object]"?"object with keys {"+Object.keys(xe).join(", ")+"}":Le)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function ct(xe,Le,tt){if(xe==null)return xe;var rt=[],gt=0;return Be(xe,rt,"","",function(Pt){return Le.call(tt,Pt,gt++)}),rt}function ut(xe){if(xe._status===-1){var Le=xe._result;Le=Le(),Le.then(function(tt){(xe._status===0||xe._status===-1)&&(xe._status=1,xe._result=tt)},function(tt){(xe._status===0||xe._status===-1)&&(xe._status=2,xe._result=tt)}),xe._status===-1&&(xe._status=0,xe._result=Le)}if(xe._status===1)return xe._result.default;throw xe._result}var Et=typeof reportError=="function"?reportError:function(xe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof xe=="object"&&xe!==null&&typeof xe.message=="string"?String(xe.message):String(xe),error:xe});if(!window.dispatchEvent(Le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",xe);return}console.error(xe)},ot={map:ct,forEach:function(xe,Le,tt){ct(xe,function(){Le.apply(this,arguments)},tt)},count:function(xe){var Le=0;return ct(xe,function(){Le++}),Le},toArray:function(xe){return ct(xe,function(Le){return Le})||[]},only:function(xe){if(!lt(xe))throw Error("React.Children.only expected to receive a single React element child.");return xe}};return on.Activity=N,on.Children=ot,on.Component=re,on.Fragment=r,on.Profiler=f,on.PureComponent=le,on.StrictMode=l,on.Suspense=A,on.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Me,on.__COMPILER_RUNTIME={__proto__:null,c:function(xe){return Me.H.useMemoCache(xe)}},on.cache=function(xe){return function(){return xe.apply(null,arguments)}},on.cacheSignal=function(){return null},on.cloneElement=function(xe,Le,tt){if(xe==null)throw Error("The argument must be a React element, but you passed "+xe+".");var rt=J({},xe.props),gt=xe.key;if(Le!=null)for(Pt in Le.key!==void 0&&(gt=""+Le.key),Le)!Ue.call(Le,Pt)||Pt==="key"||Pt==="__self"||Pt==="__source"||Pt==="ref"&&Le.ref===void 0||(rt[Pt]=Le[Pt]);var Pt=arguments.length-2;if(Pt===1)rt.children=tt;else if(1<Pt){for(var Ot=Array(Pt),ei=0;ei<Pt;ei++)Ot[ei]=arguments[ei+2];rt.children=Ot}return Fe(xe.type,gt,rt)},on.createContext=function(xe){return xe={$$typeof:y,_currentValue:xe,_currentValue2:xe,_threadCount:0,Provider:null,Consumer:null},xe.Provider=xe,xe.Consumer={$$typeof:_,_context:xe},xe},on.createElement=function(xe,Le,tt){var rt,gt={},Pt=null;if(Le!=null)for(rt in Le.key!==void 0&&(Pt=""+Le.key),Le)Ue.call(Le,rt)&&rt!=="key"&&rt!=="__self"&&rt!=="__source"&&(gt[rt]=Le[rt]);var Ot=arguments.length-2;if(Ot===1)gt.children=tt;else if(1<Ot){for(var ei=Array(Ot),gi=0;gi<Ot;gi++)ei[gi]=arguments[gi+2];gt.children=ei}if(xe&&xe.defaultProps)for(rt in Ot=xe.defaultProps,Ot)gt[rt]===void 0&&(gt[rt]=Ot[rt]);return Fe(xe,Pt,gt)},on.createRef=function(){return{current:null}},on.forwardRef=function(xe){return{$$typeof:d,render:xe}},on.isValidElement=lt,on.lazy=function(xe){return{$$typeof:B,_payload:{_status:-1,_result:xe},_init:ut}},on.memo=function(xe,Le){return{$$typeof:j,type:xe,compare:Le===void 0?null:Le}},on.startTransition=function(xe){var Le=Me.T,tt={};Me.T=tt;try{var rt=xe(),gt=Me.S;gt!==null&&gt(tt,rt),typeof rt=="object"&&rt!==null&&typeof rt.then=="function"&&rt.then(ke,Et)}catch(Pt){Et(Pt)}finally{Le!==null&&tt.types!==null&&(Le.types=tt.types),Me.T=Le}},on.unstable_useCacheRefresh=function(){return Me.H.useCacheRefresh()},on.use=function(xe){return Me.H.use(xe)},on.useActionState=function(xe,Le,tt){return Me.H.useActionState(xe,Le,tt)},on.useCallback=function(xe,Le){return Me.H.useCallback(xe,Le)},on.useContext=function(xe){return Me.H.useContext(xe)},on.useDebugValue=function(){},on.useDeferredValue=function(xe,Le){return Me.H.useDeferredValue(xe,Le)},on.useEffect=function(xe,Le){return Me.H.useEffect(xe,Le)},on.useEffectEvent=function(xe){return Me.H.useEffectEvent(xe)},on.useId=function(){return Me.H.useId()},on.useImperativeHandle=function(xe,Le,tt){return Me.H.useImperativeHandle(xe,Le,tt)},on.useInsertionEffect=function(xe,Le){return Me.H.useInsertionEffect(xe,Le)},on.useLayoutEffect=function(xe,Le){return Me.H.useLayoutEffect(xe,Le)},on.useMemo=function(xe,Le){return Me.H.useMemo(xe,Le)},on.useOptimistic=function(xe,Le){return Me.H.useOptimistic(xe,Le)},on.useReducer=function(xe,Le,tt){return Me.H.useReducer(xe,Le,tt)},on.useRef=function(xe){return Me.H.useRef(xe)},on.useState=function(xe){return Me.H.useState(xe)},on.useSyncExternalStore=function(xe,Le,tt){return Me.H.useSyncExternalStore(xe,Le,tt)},on.useTransition=function(){return Me.H.useTransition()},on.version="19.2.0",on}var cb;function nx(){return cb||(cb=1,z_.exports=E2()),z_.exports}var R_={exports:{}},so={};var ub;function k2(){if(ub)return so;ub=1;var t=nx();function e(A){var j="https://react.dev/errors/"+A;if(1<arguments.length){j+="?args[]="+encodeURIComponent(arguments[1]);for(var B=2;B<arguments.length;B++)j+="&args[]="+encodeURIComponent(arguments[B])}return"Minified React error #"+A+"; visit "+j+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var l={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},f=Symbol.for("react.portal");function _(A,j,B){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:N==null?null:""+N,children:A,containerInfo:j,implementation:B}}var y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(A,j){if(A==="font")return"";if(typeof j=="string")return j==="use-credentials"?j:""}return so.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,so.createPortal=function(A,j){var B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j||j.nodeType!==1&&j.nodeType!==9&&j.nodeType!==11)throw Error(e(299));return _(A,j,null,B)},so.flushSync=function(A){var j=y.T,B=l.p;try{if(y.T=null,l.p=2,A)return A()}finally{y.T=j,l.p=B,l.d.f()}},so.preconnect=function(A,j){typeof A=="string"&&(j?(j=j.crossOrigin,j=typeof j=="string"?j==="use-credentials"?j:"":void 0):j=null,l.d.C(A,j))},so.prefetchDNS=function(A){typeof A=="string"&&l.d.D(A)},so.preinit=function(A,j){if(typeof A=="string"&&j&&typeof j.as=="string"){var B=j.as,N=d(B,j.crossOrigin),V=typeof j.integrity=="string"?j.integrity:void 0,Q=typeof j.fetchPriority=="string"?j.fetchPriority:void 0;B==="style"?l.d.S(A,typeof j.precedence=="string"?j.precedence:void 0,{crossOrigin:N,integrity:V,fetchPriority:Q}):B==="script"&&l.d.X(A,{crossOrigin:N,integrity:V,fetchPriority:Q,nonce:typeof j.nonce=="string"?j.nonce:void 0})}},so.preinitModule=function(A,j){if(typeof A=="string")if(typeof j=="object"&&j!==null){if(j.as==null||j.as==="script"){var B=d(j.as,j.crossOrigin);l.d.M(A,{crossOrigin:B,integrity:typeof j.integrity=="string"?j.integrity:void 0,nonce:typeof j.nonce=="string"?j.nonce:void 0})}}else j==null&&l.d.M(A)},so.preload=function(A,j){if(typeof A=="string"&&typeof j=="object"&&j!==null&&typeof j.as=="string"){var B=j.as,N=d(B,j.crossOrigin);l.d.L(A,B,{crossOrigin:N,integrity:typeof j.integrity=="string"?j.integrity:void 0,nonce:typeof j.nonce=="string"?j.nonce:void 0,type:typeof j.type=="string"?j.type:void 0,fetchPriority:typeof j.fetchPriority=="string"?j.fetchPriority:void 0,referrerPolicy:typeof j.referrerPolicy=="string"?j.referrerPolicy:void 0,imageSrcSet:typeof j.imageSrcSet=="string"?j.imageSrcSet:void 0,imageSizes:typeof j.imageSizes=="string"?j.imageSizes:void 0,media:typeof j.media=="string"?j.media:void 0})}},so.preloadModule=function(A,j){if(typeof A=="string")if(j){var B=d(j.as,j.crossOrigin);l.d.m(A,{as:typeof j.as=="string"&&j.as!=="script"?j.as:void 0,crossOrigin:B,integrity:typeof j.integrity=="string"?j.integrity:void 0})}else l.d.m(A)},so.requestFormReset=function(A){l.d.r(A)},so.unstable_batchedUpdates=function(A,j){return A(j)},so.useFormState=function(A,j,B){return y.H.useFormState(A,j,B)},so.useFormStatus=function(){return y.H.useHostTransitionStatus()},so.version="19.2.0",so}var hb;function kw(){if(hb)return R_.exports;hb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),R_.exports=k2(),R_.exports}var db;function C2(){if(db)return bm;db=1;var t=T2(),e=nx(),r=kw();function l(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)o+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function _(s){var o=s,p=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(p=o.return),s=o.return;while(s)}return o.tag===3?p:null}function y(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function d(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function A(s){if(_(s)!==s)throw Error(l(188))}function j(s){var o=s.alternate;if(!o){if(o=_(s),o===null)throw Error(l(188));return o!==s?null:s}for(var p=s,w=o;;){var P=p.return;if(P===null)break;var D=P.alternate;if(D===null){if(w=P.return,w!==null){p=w;continue}break}if(P.child===D.child){for(D=P.child;D;){if(D===p)return A(P),s;if(D===w)return A(P),o;D=D.sibling}throw Error(l(188))}if(p.return!==w.return)p=P,w=D;else{for(var Y=!1,pe=P.child;pe;){if(pe===p){Y=!0,p=P,w=D;break}if(pe===w){Y=!0,w=P,p=D;break}pe=pe.sibling}if(!Y){for(pe=D.child;pe;){if(pe===p){Y=!0,p=D,w=P;break}if(pe===w){Y=!0,w=D,p=P;break}pe=pe.sibling}if(!Y)throw Error(l(189))}}if(p.alternate!==w)throw Error(l(190))}if(p.tag!==3)throw Error(l(188));return p.stateNode.current===p?s:o}function B(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=B(s),o!==null)return o;s=s.sibling}return null}var N=Object.assign,V=Symbol.for("react.element"),Q=Symbol.for("react.transitional.element"),ne=Symbol.for("react.portal"),J=Symbol.for("react.fragment"),ye=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),ge=Symbol.for("react.consumer"),le=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),Me=Symbol.for("react.memo"),Ue=Symbol.for("react.lazy"),Fe=Symbol.for("react.activity"),He=Symbol.for("react.memo_cache_sentinel"),lt=Symbol.iterator;function Ye(s){return s===null||typeof s!="object"?null:(s=lt&&s[lt]||s["@@iterator"],typeof s=="function"?s:null)}var Mt=Symbol.for("react.client.reference");function et(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Mt?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case J:return"Fragment";case re:return"Profiler";case ye:return"StrictMode";case be:return"Suspense";case ke:return"SuspenseList";case Fe:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case ne:return"Portal";case le:return s.displayName||"Context";case ge:return(s._context.displayName||"Context")+".Consumer";case me:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Me:return o=s.displayName||null,o!==null?o:et(s.type)||"Memo";case Ue:o=s._payload,s=s._init;try{return et(s(o))}catch{}}return null}var Tt=Array.isArray,Be=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ct=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ut={pending:!1,data:null,method:null,action:null},Et=[],ot=-1;function xe(s){return{current:s}}function Le(s){0>ot||(s.current=Et[ot],Et[ot]=null,ot--)}function tt(s,o){ot++,Et[ot]=s.current,s.current=o}var rt=xe(null),gt=xe(null),Pt=xe(null),Ot=xe(null);function ei(s,o){switch(tt(Pt,o),tt(gt,s),tt(rt,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?k(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=k(o),s=C(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Le(rt),tt(rt,s)}function gi(){Le(rt),Le(gt),Le(Pt)}function Vi(s){s.memoizedState!==null&&tt(Ot,s);var o=rt.current,p=C(o,s.type);o!==p&&(tt(gt,s),tt(rt,p))}function pi(s){gt.current===s&&(Le(rt),Le(gt)),Ot.current===s&&(Le(Ot),Bh._currentValue=ut)}var zi,gn;function ln(s){if(zi===void 0)try{throw Error()}catch(p){var o=p.stack.trim().match(/\n( *(at )?)/);zi=o&&o[1]||"",gn=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zi+s+gn}var $n=!1;function it(s,o){if(!s||$n)return"";$n=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(o){var Lt=function(){throw Error()};if(Object.defineProperty(Lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Lt,[])}catch(yt){var pt=yt}Reflect.construct(s,[],Lt)}else{try{Lt.call()}catch(yt){pt=yt}s.call(Lt.prototype)}}else{try{throw Error()}catch(yt){pt=yt}(Lt=s())&&typeof Lt.catch=="function"&&Lt.catch(function(){})}}catch(yt){if(yt&&pt&&typeof yt.stack=="string")return[yt.stack,pt.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var P=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");P&&P.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=w.DetermineComponentFrameRoot(),Y=D[0],pe=D[1];if(Y&&pe){var De=Y.split(`
`),ft=pe.split(`
`);for(P=w=0;w<De.length&&!De[w].includes("DetermineComponentFrameRoot");)w++;for(;P<ft.length&&!ft[P].includes("DetermineComponentFrameRoot");)P++;if(w===De.length||P===ft.length)for(w=De.length-1,P=ft.length-1;1<=w&&0<=P&&De[w]!==ft[P];)P--;for(;1<=w&&0<=P;w--,P--)if(De[w]!==ft[P]){if(w!==1||P!==1)do if(w--,P--,0>P||De[w]!==ft[P]){var St=`
`+De[w].replace(" at new "," at ");return s.displayName&&St.includes("<anonymous>")&&(St=St.replace("<anonymous>",s.displayName)),St}while(1<=w&&0<=P);break}}}finally{$n=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?ln(p):""}function Cn(s,o){switch(s.tag){case 26:case 27:case 5:return ln(s.type);case 16:return ln("Lazy");case 13:return s.child!==o&&o!==null?ln("Suspense Fallback"):ln("Suspense");case 19:return ln("SuspenseList");case 0:case 15:return it(s.type,!1);case 11:return it(s.type.render,!1);case 1:return it(s.type,!0);case 31:return ln("Activity");default:return""}}function Mn(s){try{var o="",p=null;do o+=Cn(s,p),p=s,s=s.return;while(s);return o}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var Si=Object.prototype.hasOwnProperty,mi=t.unstable_scheduleCallback,En=t.unstable_cancelCallback,Rn=t.unstable_shouldYield,is=t.unstable_requestPaint,sn=t.unstable_now,Xi=t.unstable_getCurrentPriorityLevel,Gi=t.unstable_ImmediatePriority,ns=t.unstable_UserBlockingPriority,kt=t.unstable_NormalPriority,Hn=t.unstable_LowPriority,yn=t.unstable_IdlePriority,bn=t.log,Un=t.unstable_setDisableYieldValue,jt=null,ii=null;function Xt(s){if(typeof bn=="function"&&Un(s),ii&&typeof ii.setStrictMode=="function")try{ii.setStrictMode(jt,s)}catch{}}var Wi=Math.clz32?Math.clz32:xs,Dn=Math.log,hi=Math.LN2;function xs(s){return s>>>=0,s===0?32:31-(Dn(s)/hi|0)|0}var Pn=256,Zn=262144,rn=4194304;function we(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function te(s,o,p){var w=s.pendingLanes;if(w===0)return 0;var P=0,D=s.suspendedLanes,Y=s.pingedLanes;s=s.warmLanes;var pe=w&134217727;return pe!==0?(w=pe&~D,w!==0?P=we(w):(Y&=pe,Y!==0?P=we(Y):p||(p=pe&~s,p!==0&&(P=we(p))))):(pe=w&~D,pe!==0?P=we(pe):Y!==0?P=we(Y):p||(p=w&~s,p!==0&&(P=we(p)))),P===0?0:o!==0&&o!==P&&(o&D)===0&&(D=P&-P,p=o&-o,D>=p||D===32&&(p&4194048)!==0)?o:P}function G(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function oe(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ve(){var s=rn;return rn<<=1,(rn&62914560)===0&&(rn=4194304),s}function je(s){for(var o=[],p=0;31>p;p++)o.push(s);return o}function ze(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ve(s,o,p,w,P,D){var Y=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var pe=s.entanglements,De=s.expirationTimes,ft=s.hiddenUpdates;for(p=Y&~p;0<p;){var St=31-Wi(p),Lt=1<<St;pe[St]=0,De[St]=-1;var pt=ft[St];if(pt!==null)for(ft[St]=null,St=0;St<pt.length;St++){var yt=pt[St];yt!==null&&(yt.lane&=-536870913)}p&=~Lt}w!==0&&he(s,w,0),D!==0&&P===0&&s.tag!==0&&(s.suspendedLanes|=D&~(Y&~o))}function he(s,o,p){s.pendingLanes|=o,s.suspendedLanes&=~o;var w=31-Wi(o);s.entangledLanes|=o,s.entanglements[w]=s.entanglements[w]|1073741824|p&261930}function Ge(s,o){var p=s.entangledLanes|=o;for(s=s.entanglements;p;){var w=31-Wi(p),P=1<<w;P&o|s[w]&o&&(s[w]|=o),p&=~P}}function at(s,o){var p=o&-o;return p=(p&42)!==0?1:Ke(p),(p&(s.suspendedLanes|o))!==0?0:p}function Ke(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function st(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Qt(){var s=ct.p;return s!==0?s:(s=window.event,s===void 0?32:Nr(s.type))}function si(s,o){var p=ct.p;try{return ct.p=s,o()}finally{ct.p=p}}var Bt=Math.random().toString(36).slice(2),Ct="__reactFiber$"+Bt,ni="__reactProps$"+Bt,yi="__reactContainer$"+Bt,Ri="__reactEvents$"+Bt,_t="__reactListeners$"+Bt,xt="__reactHandles$"+Bt,Gt="__reactResources$"+Bt,fi="__reactMarker$"+Bt;function Ne(s){delete s[Ct],delete s[ni],delete s[Ri],delete s[_t],delete s[xt]}function zt(s){var o=s[Ct];if(o)return o;for(var p=s.parentNode;p;){if(o=p[yi]||p[Ct]){if(p=o.alternate,o.child!==null||p!==null&&p.child!==null)for(s=li(s);s!==null;){if(p=s[Ct])return p;s=li(s)}return o}s=p,p=s.parentNode}return null}function Kt(s){if(s=s[Ct]||s[yi]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function Zi(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(l(33))}function vi(s){var o=s[Gt];return o||(o=s[Gt]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function mn(s){s[fi]=!0}var _r=new Set,Xs={};function Rs(s,o){Co(s,o),Co(s+"Capture",o)}function Co(s,o){for(Xs[s]=o,s=0;s<o.length;s++)_r.add(o[s])}var sr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vr={},Ao={};function xa(s){return Si.call(Ao,s)?!0:Si.call(vr,s)?!1:sr.test(s)?Ao[s]=!0:(vr[s]=!0,!1)}function ki(s,o,p){if(xa(o))if(p===null)s.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var w=o.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+p)}}function In(s,o,p){if(p===null)s.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+p)}}function gs(s,o,p,w){if(w===null)s.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(o,p,""+w)}}function cn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Oa(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Fr(s,o,p){var w=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var P=w.get,D=w.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return P.call(this)},set:function(Y){p=""+Y,D.call(this,Y)}}),Object.defineProperty(s,o,{enumerable:w.enumerable}),{getValue:function(){return p},setValue:function(Y){p=""+Y},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Bi(s){if(!s._valueTracker){var o=Oa(s)?"checked":"value";s._valueTracker=Fr(s,o,""+s[o])}}function An(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var p=o.getValue(),w="";return s&&(w=Oa(s)?s.checked?"true":"false":s.value),s=w,s!==p?(o.setValue(s),!0):!1}function Il(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Xo=/[\n"\\]/g;function On(s){return s.replace(Xo,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Na(s,o,p,w,P,D,Y,pe){s.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?s.type=Y:s.removeAttribute("type"),o!=null?Y==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+cn(o)):s.value!==""+cn(o)&&(s.value=""+cn(o)):Y!=="submit"&&Y!=="reset"||s.removeAttribute("value"),o!=null?ba(s,Y,cn(o)):p!=null?ba(s,Y,cn(p)):w!=null&&s.removeAttribute("value"),P==null&&D!=null&&(s.defaultChecked=!!D),P!=null&&(s.checked=P&&typeof P!="function"&&typeof P!="symbol"),pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?s.name=""+cn(pe):s.removeAttribute("name")}function un(s,o,p,w,P,D,Y,pe){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(s.type=D),o!=null||p!=null){if(!(D!=="submit"&&D!=="reset"||o!=null)){Bi(s);return}p=p!=null?""+cn(p):"",o=o!=null?""+cn(o):p,pe||o===s.value||(s.value=o),s.defaultValue=o}w=w??P,w=typeof w!="function"&&typeof w!="symbol"&&!!w,s.checked=pe?s.checked:!!w,s.defaultChecked=!!w,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(s.name=Y),Bi(s)}function ba(s,o,p){o==="number"&&Il(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function Gn(s,o,p,w){if(s=s.options,o){o={};for(var P=0;P<p.length;P++)o["$"+p[P]]=!0;for(p=0;p<s.length;p++)P=o.hasOwnProperty("$"+s[p].value),s[p].selected!==P&&(s[p].selected=P),P&&w&&(s[p].defaultSelected=!0)}else{for(p=""+cn(p),o=null,P=0;P<s.length;P++){if(s[P].value===p){s[P].selected=!0,w&&(s[P].defaultSelected=!0);return}o!==null||s[P].disabled||(o=s[P])}o!==null&&(o.selected=!0)}}function Vr(s,o,p){if(o!=null&&(o=""+cn(o),o!==s.value&&(s.value=o),p==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=p!=null?""+cn(p):""}function Mo(s,o,p,w){if(o==null){if(w!=null){if(p!=null)throw Error(l(92));if(Tt(w)){if(1<w.length)throw Error(l(93));w=w[0]}p=w}p==null&&(p=""),o=p}p=cn(o),s.defaultValue=p,w=s.textContent,w===p&&w!==""&&w!==null&&(s.value=w),Bi(s)}function qr(s,o){if(o){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=o;return}}s.textContent=o}var Ko=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function oo(s,o,p){var w=o.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?w?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":w?s.setProperty(o,p):typeof p!="number"||p===0||Ko.has(o)?o==="float"?s.cssFloat=p:s[o]=(""+p).trim():s[o]=p+"px"}function lo(s,o,p){if(o!=null&&typeof o!="object")throw Error(l(62));if(s=s.style,p!=null){for(var w in p)!p.hasOwnProperty(w)||o!=null&&o.hasOwnProperty(w)||(w.indexOf("--")===0?s.setProperty(w,""):w==="float"?s.cssFloat="":s[w]="");for(var P in o)w=o[P],o.hasOwnProperty(P)&&p[P]!==w&&oo(s,P,w)}else for(var D in o)o.hasOwnProperty(D)&&oo(s,D,o[D])}function Ll(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ic=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zl(s){return Lc.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Us(){}var Po=null;function Fs(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ds=null,Ii=null;function jr(s){var o=Kt(s);if(o&&(s=o.stateNode)){var p=s[ni]||null;e:switch(s=o.stateNode,o.type){case"input":if(Na(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),o=p.name,p.type==="radio"&&o!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+On(""+o)+'"][type="radio"]'),o=0;o<p.length;o++){var w=p[o];if(w!==s&&w.form===s.form){var P=w[ni]||null;if(!P)throw Error(l(90));Na(w,P.value,P.defaultValue,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name)}}for(o=0;o<p.length;o++)w=p[o],w.form===s.form&&An(w)}break e;case"textarea":Vr(s,p.value,p.defaultValue);break e;case"select":o=p.value,o!=null&&Gn(s,!!p.multiple,o,!1)}}}var jn=!1;function zc(s,o,p){if(jn)return s(o,p);jn=!0;try{var w=s(o);return w}finally{if(jn=!1,(Ds!==null||Ii!==null)&&(kd(),Ds&&(o=Ds,s=Ii,Ii=Ds=null,jr(o),s)))for(o=0;o<s.length;o++)jr(s[o])}}function sa(s,o){var p=s.stateNode;if(p===null)return null;var w=p[ni]||null;if(w===null)return null;p=w[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(s=s.type,w=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!w;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(l(231,o,typeof p));return p}var wa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rl=!1;if(wa)try{var ra={};Object.defineProperty(ra,"passive",{get:function(){Rl=!0}}),window.addEventListener("test",ra,ra),window.removeEventListener("test",ra,ra)}catch{Rl=!1}var Ba=null,Jo=null,bs=null;function aa(){if(bs)return bs;var s,o=Jo,p=o.length,w,P="value"in Ba?Ba.value:Ba.textContent,D=P.length;for(s=0;s<p&&o[s]===P[s];s++);var Y=p-s;for(w=1;w<=Y&&o[p-w]===P[D-w];w++);return bs=P.slice(s,1<w?1-w:void 0)}function Qo(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function jo(){return!0}function Rc(){return!1}function Ks(s){function o(p,w,P,D,Y){this._reactName=p,this._targetInst=P,this.type=w,this.nativeEvent=D,this.target=Y,this.currentTarget=null;for(var pe in s)s.hasOwnProperty(pe)&&(p=s[pe],this[pe]=p?p(D):D[pe]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?jo:Rc,this.isPropagationStopped=Rc,this}return N(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=jo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=jo)},persist:function(){},isPersistent:jo}),o}var Vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dc=Ks(Vs),Io=N({},Vs,{view:0,detail:0}),Ki=Ks(Io),$a,$i,oa,tc=N({},Io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bu,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==oa&&(oa&&s.type==="mousemove"?($a=s.screenX-oa.screenX,$i=s.screenY-oa.screenY):$i=$a=0,oa=s),$a)},movementY:function(s){return"movementY"in s?s.movementY:$i}}),el=Ks(tc),_u=N({},tc,{dataTransfer:0}),eh=Ks(_u),th=N({},Io,{relatedTarget:0}),Oc=Ks(th),vu=N({},Vs,{animationName:0,elapsedTime:0,pseudoElement:0}),Nc=Ks(vu),ih=N({},Vs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Sa=Ks(ih),nh=N({},Vs,{data:0}),co=Ks(nh),uo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tl(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=xu[s])?!!o[s]:!1}function bu(){return tl}var ic=N({},Io,{key:function(s){if(s.key){var o=uo[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Qo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?sh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bu,charCode:function(s){return s.type==="keypress"?Qo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Qo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),rh=Ks(ic),Kh=N({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wu=Ks(Kh),Bc=N({},Io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bu}),ah=Ks(Bc),$c=N({},Vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Su=Ks($c),il=N({},tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),xr=Ks(il),Tu=N({},Vs,{newState:0,oldState:0}),nl=Ks(Tu),Ir=[9,13,27,32],sl=wa&&"CompositionEvent"in window,Lo=null;wa&&"documentMode"in document&&(Lo=document.documentMode);var rl=wa&&"TextEvent"in window&&!Lo,Dl=wa&&(!sl||Lo&&8<Lo&&11>=Lo),Uc=" ",fs=!1;function oh(s,o){switch(s){case"keyup":return Ir.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qi(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ho=!1;function hn(s,o){switch(s){case"compositionend":return qi(o);case"keypress":return o.which!==32?null:(fs=!0,Uc);case"textInput":return s=o.data,s===Uc&&fs?null:s;default:return null}}function wn(s,o){if(ho)return s==="compositionend"||!sl&&oh(s,o)?(s=aa(),bs=Jo=Ba=null,ho=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Dl&&o.locale!=="ko"?null:o.data;default:return null}}var al={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lr(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!al[s.type]:o==="textarea"}function Ol(s,o,p,w){Ds?Ii?Ii.push(w):Ii=[w]:Ds=w,o=Ld(o,"onChange"),0<o.length&&(p=new Dc("onChange","change",null,p,w),s.push({event:p,listeners:o}))}var la=null,Ta=null;function Ua(s){Lf(s,0)}function rr(s){var o=Zi(s);if(An(o))return s}function ol(s,o){if(s==="change")return o}var Fc=!1;if(wa){var ca;if(wa){var ua="oninput"in document;if(!ua){var Nl=document.createElement("div");Nl.setAttribute("oninput","return;"),ua=typeof Nl.oninput=="function"}ca=ua}else ca=!1;Fc=ca&&(!document.documentMode||9<document.documentMode)}function zo(){la&&(la.detachEvent("onpropertychange",ll),Ta=la=null)}function ll(s){if(s.propertyName==="value"&&rr(Ta)){var o=[];Ol(o,Ta,s,Fs(s)),zc(Ua,o)}}function Hr(s,o,p){s==="focusin"?(zo(),la=o,Ta=p,la.attachEvent("onpropertychange",ll)):s==="focusout"&&zo()}function Vc(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return rr(Ta)}function Ea(s,o){if(s==="click")return rr(o)}function Bl(s,o){if(s==="input"||s==="change")return rr(o)}function Fa(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var qs=typeof Object.is=="function"?Object.is:Fa;function tn(s,o){if(qs(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var p=Object.keys(s),w=Object.keys(o);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var P=p[w];if(!Si.call(o,P)||!qs(s[P],o[P]))return!1}return!0}function cl(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function nc(s,o){var p=cl(s);s=0;for(var w;p;){if(p.nodeType===3){if(w=s+p.textContent.length,s<=o&&w>=o)return{node:p,offset:o-s};s=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=cl(p)}}function sc(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?sc(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Va(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Il(s.document);o instanceof s.HTMLIFrameElement;){try{var p=typeof o.contentWindow.location.href=="string"}catch{p=!1}if(p)s=o.contentWindow;else break;o=Il(s.document)}return o}function fo(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var ul=wa&&"documentMode"in document&&11>=document.documentMode,po=null,rc=null,Ro=null,mo=!1;function hl(s,o,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;mo||po==null||po!==Il(w)||(w=po,"selectionStart"in w&&fo(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Ro&&tn(Ro,w)||(Ro=w,w=Ld(rc,"onSelect"),0<w.length&&(o=new Dc("onSelect","select",null,o,p),s.push({event:o,listeners:w}),o.target=po)))}function Zr(s,o){var p={};return p[s.toLowerCase()]=o.toLowerCase(),p["Webkit"+s]="webkit"+o,p["Moz"+s]="moz"+o,p}var ka={animationend:Zr("Animation","AnimationEnd"),animationiteration:Zr("Animation","AnimationIteration"),animationstart:Zr("Animation","AnimationStart"),transitionrun:Zr("Transition","TransitionRun"),transitionstart:Zr("Transition","TransitionStart"),transitioncancel:Zr("Transition","TransitionCancel"),transitionend:Zr("Transition","TransitionEnd")},$l={},dl={};wa&&(dl=document.createElement("div").style,"AnimationEvent"in window||(delete ka.animationend.animation,delete ka.animationiteration.animation,delete ka.animationstart.animation),"TransitionEvent"in window||delete ka.transitionend.transition);function As(s){if($l[s])return $l[s];if(!ka[s])return s;var o=ka[s],p;for(p in o)if(o.hasOwnProperty(p)&&p in dl)return $l[s]=o[p];return s}var Do=As("animationend"),ac=As("animationiteration"),fl=As("animationstart"),Jh=As("transitionrun"),Eu=As("transitionstart"),qc=As("transitioncancel"),Oo=As("transitionend"),Ul=new Map,ha="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ha.push("scrollEnd");function Wn(s,o){Ul.set(s,o),Rs(o,[s])}var Ca=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Gr=[],br=0,ss=0;function wr(){for(var s=br,o=ss=br=0;o<s;){var p=Gr[o];Gr[o++]=null;var w=Gr[o];Gr[o++]=null;var P=Gr[o];Gr[o++]=null;var D=Gr[o];if(Gr[o++]=null,w!==null&&P!==null){var Y=w.pending;Y===null?P.next=P:(P.next=Y.next,Y.next=P),w.pending=P}D!==0&&go(p,P,D)}}function Ms(s,o,p,w){Gr[br++]=s,Gr[br++]=o,Gr[br++]=p,Gr[br++]=w,ss|=w,s.lanes|=w,s=s.alternate,s!==null&&(s.lanes|=w)}function pl(s,o,p,w){return Ms(s,o,p,w),qa(s)}function da(s,o){return Ms(s,null,null,o),qa(s)}function go(s,o,p){s.lanes|=p;var w=s.alternate;w!==null&&(w.lanes|=p);for(var P=!1,D=s.return;D!==null;)D.childLanes|=p,w=D.alternate,w!==null&&(w.childLanes|=p),D.tag===22&&(s=D.stateNode,s===null||s._visibility&1||(P=!0)),s=D,D=D.return;return s.tag===3?(D=s.stateNode,P&&o!==null&&(P=31-Wi(p),s=D.hiddenUpdates,w=s[P],w===null?s[P]=[o]:w.push(o),o.lane=p|536870912),D):null}function qa(s){if(50<ou)throw ou=0,Ed=null,Error(l(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Sr={};function ku(s,o,p,w){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Js(s,o,p,w){return new ku(s,o,p,w)}function Fl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Wr(s,o){var p=s.alternate;return p===null?(p=Js(s.tag,o,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=o,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,o=s.dependencies,p.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function oc(s,o){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,o=p.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function ml(s,o,p,w,P,D){var Y=0;if(w=s,typeof s=="function")Fl(s)&&(Y=1);else if(typeof s=="string")Y=Eo(s,p,rt.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case Fe:return s=Js(31,p,o,P),s.elementType=Fe,s.lanes=D,s;case J:return Yr(p.children,P,D,o);case ye:Y=8,P|=24;break;case re:return s=Js(12,p,o,P|2),s.elementType=re,s.lanes=D,s;case be:return s=Js(13,p,o,P),s.elementType=be,s.lanes=D,s;case ke:return s=Js(19,p,o,P),s.elementType=ke,s.lanes=D,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case le:Y=10;break e;case ge:Y=9;break e;case me:Y=11;break e;case Me:Y=14;break e;case Ue:Y=16,w=null;break e}Y=29,p=Error(l(130,s===null?"null":typeof s,"")),w=null}return o=Js(Y,p,o,P),o.elementType=s,o.type=w,o.lanes=D,o}function Yr(s,o,p,w){return s=Js(7,s,w,o),s.lanes=p,s}function gl(s,o,p){return s=Js(6,s,null,o),s.lanes=p,s}function yl(s){var o=Js(18,null,null,0);return o.stateNode=s,o}function lc(s,o,p){return o=Js(4,s.children!==null?s.children:[],s.key,o),o.lanes=p,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var u=new WeakMap;function b(s,o){if(typeof s=="object"&&s!==null){var p=u.get(s);return p!==void 0?p:(o={value:s,source:o,stack:Mn(o)},u.set(s,o),o)}return{value:s,source:o,stack:Mn(o)}}var M=[],$=0,Z=null,ce=0,Ce=[],Xe=0,dt=null,wt=1,Wt="";function xi(s,o){M[$++]=ce,M[$++]=Z,Z=s,ce=o}function nn(s,o,p){Ce[Xe++]=wt,Ce[Xe++]=Wt,Ce[Xe++]=dt,dt=s;var w=wt;s=Wt;var P=32-Wi(w)-1;w&=~(1<<P),p+=1;var D=32-Wi(o)+P;if(30<D){var Y=P-P%5;D=(w&(1<<Y)-1).toString(32),w>>=Y,P-=Y,wt=1<<32-Wi(o)+P|p<<P|w,Wt=D+s}else wt=1<<D|p<<P|w,Wt=s}function Hs(s){s.return!==null&&(xi(s,1),nn(s,1,0))}function ws(s){for(;s===Z;)Z=M[--$],M[$]=null,ce=M[--$],M[$]=null;for(;s===dt;)dt=Ce[--Xe],Ce[Xe]=null,Wt=Ce[--Xe],Ce[Xe]=null,wt=Ce[--Xe],Ce[Xe]=null}function Tr(s,o){Ce[Xe++]=wt,Ce[Xe++]=Wt,Ce[Xe++]=dt,wt=o.id,Wt=o.overflow,dt=s}var _n=null,Yi=null,It=!1,Aa=null,zr=!1,cc=Error(l(519));function Xr(s){var o=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw _l(b(o,s)),cc}function No(s){var o=s.stateNode,p=s.type,w=s.memoizedProps;switch(o[Ct]=s,o[ni]=w,p){case"dialog":kn("cancel",o),kn("close",o);break;case"iframe":case"object":case"embed":kn("load",o);break;case"video":case"audio":for(p=0;p<Rh.length;p++)kn(Rh[p],o);break;case"source":kn("error",o);break;case"img":case"image":case"link":kn("error",o),kn("load",o);break;case"details":kn("toggle",o);break;case"input":kn("invalid",o),un(o,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":kn("invalid",o);break;case"textarea":kn("invalid",o),Mo(o,w.value,w.defaultValue,w.children)}p=w.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||o.textContent===""+p||w.suppressHydrationWarning===!0||Dh(o.textContent,p)?(w.popover!=null&&(kn("beforetoggle",o),kn("toggle",o)),w.onScroll!=null&&kn("scroll",o),w.onScrollEnd!=null&&kn("scrollend",o),w.onClick!=null&&(o.onclick=Us),o=!0):o=!1,o||Xr(s,!0)}function ps(s){for(_n=s.return;_n;)switch(_n.tag){case 5:case 31:case 13:zr=!1;return;case 27:case 3:zr=!0;return;default:_n=_n.return}}function Oi(s){if(s!==_n)return!1;if(!It)return ps(s),It=!0,!1;var o=s.tag,p;if((p=o!==3&&o!==27)&&((p=o===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||I(s.type,s.memoizedProps)),p=!p),p&&Yi&&Xr(s),ps(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(l(317));Yi=di(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(l(317));Yi=di(s)}else o===27?(o=Yi,de(s.type)?(s=Zt,Zt=null,Yi=s):Yi=o):Yi=_n?Ft(s.stateNode.nextSibling):null;return!0}function yo(){Yi=_n=null,It=!1}function Cu(){var s=Aa;return s!==null&&(Pa===null?Pa=s:Pa.push.apply(Pa,s),Aa=null),s}function _l(s){Aa===null?Aa=[s]:Aa.push(s)}var uc=xe(null),Kr=null,Ha=null;function Bo(s,o,p){tt(uc,o._currentValue),o._currentValue=p}function $o(s){s._currentValue=uc.current,Le(uc)}function Qh(s,o,p){for(;s!==null;){var w=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,w!==null&&(w.childLanes|=o)):w!==null&&(w.childLanes&o)!==o&&(w.childLanes|=o),s===p)break;s=s.return}}function Au(s,o,p,w){var P=s.child;for(P!==null&&(P.return=s);P!==null;){var D=P.dependencies;if(D!==null){var Y=P.child;D=D.firstContext;e:for(;D!==null;){var pe=D;D=P;for(var De=0;De<o.length;De++)if(pe.context===o[De]){D.lanes|=p,pe=D.alternate,pe!==null&&(pe.lanes|=p),Qh(D.return,p,s),w||(Y=null);break e}D=pe.next}}else if(P.tag===18){if(Y=P.return,Y===null)throw Error(l(341));Y.lanes|=p,D=Y.alternate,D!==null&&(D.lanes|=p),Qh(Y,p,s),Y=null}else Y=P.child;if(Y!==null)Y.return=P;else for(Y=P;Y!==null;){if(Y===s){Y=null;break}if(P=Y.sibling,P!==null){P.return=Y.return,Y=P;break}Y=Y.return}P=Y}}function Hc(s,o,p,w){s=null;for(var P=o,D=!1;P!==null;){if(!D){if((P.flags&524288)!==0)D=!0;else if((P.flags&262144)!==0)break}if(P.tag===10){var Y=P.alternate;if(Y===null)throw Error(l(387));if(Y=Y.memoizedProps,Y!==null){var pe=P.type;qs(P.pendingProps.value,Y.value)||(s!==null?s.push(pe):s=[pe])}}else if(P===Ot.current){if(Y=P.alternate,Y===null)throw Error(l(387));Y.memoizedState.memoizedState!==P.memoizedState.memoizedState&&(s!==null?s.push(Bh):s=[Bh])}P=P.return}s!==null&&Au(o,s,p,w),o.flags|=262144}function lh(s){for(s=s.firstContext;s!==null;){if(!qs(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Qs(s){Kr=s,Ha=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ji(s){return Mu(Kr,s)}function vl(s,o){return Kr===null&&Qs(s),Mu(s,o)}function Mu(s,o){var p=o._currentValue;if(o={context:o,memoizedValue:p,next:null},Ha===null){if(s===null)throw Error(l(308));Ha=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Ha=Ha.next=o;return p}var ch=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(p,w){s.push(w)}};this.abort=function(){o.aborted=!0,s.forEach(function(p){return p()})}},rf=t.unstable_scheduleCallback,Pu=t.unstable_NormalPriority,ys={$$typeof:le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Za(){return{controller:new ch,data:new Map,refCount:0}}function xl(s){s.refCount--,s.refCount===0&&rf(Pu,function(){s.controller.abort()})}var ci=null,bi=0,bl=0,wl=null;function ed(s,o){if(ci===null){var p=ci=[];bi=0,bl=zh(),wl={status:"pending",value:void 0,then:function(w){p.push(w)}}}return bi++,o.then(E,E),o}function E(){if(--bi===0&&ci!==null){wl!==null&&(wl.status="fulfilled");var s=ci;ci=null,bl=0,wl=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function i(s,o){var p=[],w={status:"pending",value:null,reason:null,then:function(P){p.push(P)}};return s.then(function(){w.status="fulfilled",w.value=o;for(var P=0;P<p.length;P++)(0,p[P])(o)},function(P){for(w.status="rejected",w.reason=P,P=0;P<p.length;P++)(0,p[P])(void 0)}),w}var h=Be.S;Be.S=function(s,o){zg=sn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&ed(s,o),h!==null&&h(s,o)};var g=xe(null);function v(){var s=g.current;return s!==null?s:hs.pooledCache}function T(s,o){o===null?tt(g,g.current):tt(g,o.pool)}function z(){var s=v();return s===null?null:{parent:ys._currentValue,pool:s}}var O=Error(l(460)),U=Error(l(474)),H=Error(l(542)),X={then:function(){}};function K(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ae(s,o,p){switch(p=s[p],p===void 0?s.push(o):p!==o&&(o.then(Us,Us),o=p),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Pe(s),s;default:if(typeof o.status=="string")o.then(Us,Us);else{if(s=hs,s!==null&&100<s.shellSuspendCounter)throw Error(l(482));s=o,s.status="pending",s.then(function(w){if(o.status==="pending"){var P=o;P.status="fulfilled",P.value=w}},function(w){if(o.status==="pending"){var P=o;P.status="rejected",P.reason=w}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Pe(s),s}throw _e=o,O}}function fe(s){try{var o=s._init;return o(s._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(_e=p,O):p}}var _e=null;function Ee(){if(_e===null)throw Error(l(459));var s=_e;return _e=null,s}function Pe(s){if(s===O||s===H)throw Error(l(483))}var Ie=null,Re=0;function Se(s){var o=Re;return Re+=1,Ie===null&&(Ie=[]),ae(Ie,s,o)}function $e(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Ze(s,o){throw o.$$typeof===V?Error(l(525)):(s=Object.prototype.toString.call(o),Error(l(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function nt(s){function o(Qe,qe){if(s){var ht=Qe.deletions;ht===null?(Qe.deletions=[qe],Qe.flags|=16):ht.push(qe)}}function p(Qe,qe){if(!s)return null;for(;qe!==null;)o(Qe,qe),qe=qe.sibling;return null}function w(Qe){for(var qe=new Map;Qe!==null;)Qe.key!==null?qe.set(Qe.key,Qe):qe.set(Qe.index,Qe),Qe=Qe.sibling;return qe}function P(Qe,qe){return Qe=Wr(Qe,qe),Qe.index=0,Qe.sibling=null,Qe}function D(Qe,qe,ht){return Qe.index=ht,s?(ht=Qe.alternate,ht!==null?(ht=ht.index,ht<qe?(Qe.flags|=67108866,qe):ht):(Qe.flags|=67108866,qe)):(Qe.flags|=1048576,qe)}function Y(Qe){return s&&Qe.alternate===null&&(Qe.flags|=67108866),Qe}function pe(Qe,qe,ht,At){return qe===null||qe.tag!==6?(qe=gl(ht,Qe.mode,At),qe.return=Qe,qe):(qe=P(qe,ht),qe.return=Qe,qe)}function De(Qe,qe,ht,At){var Li=ht.type;return Li===J?St(Qe,qe,ht.props.children,At,ht.key):qe!==null&&(qe.elementType===Li||typeof Li=="object"&&Li!==null&&Li.$$typeof===Ue&&fe(Li)===qe.type)?(qe=P(qe,ht.props),$e(qe,ht),qe.return=Qe,qe):(qe=ml(ht.type,ht.key,ht.props,null,Qe.mode,At),$e(qe,ht),qe.return=Qe,qe)}function ft(Qe,qe,ht,At){return qe===null||qe.tag!==4||qe.stateNode.containerInfo!==ht.containerInfo||qe.stateNode.implementation!==ht.implementation?(qe=lc(ht,Qe.mode,At),qe.return=Qe,qe):(qe=P(qe,ht.children||[]),qe.return=Qe,qe)}function St(Qe,qe,ht,At,Li){return qe===null||qe.tag!==7?(qe=Yr(ht,Qe.mode,At,Li),qe.return=Qe,qe):(qe=P(qe,ht),qe.return=Qe,qe)}function Lt(Qe,qe,ht){if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return qe=gl(""+qe,Qe.mode,ht),qe.return=Qe,qe;if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case Q:return ht=ml(qe.type,qe.key,qe.props,null,Qe.mode,ht),$e(ht,qe),ht.return=Qe,ht;case ne:return qe=lc(qe,Qe.mode,ht),qe.return=Qe,qe;case Ue:return qe=fe(qe),Lt(Qe,qe,ht)}if(Tt(qe)||Ye(qe))return qe=Yr(qe,Qe.mode,ht,null),qe.return=Qe,qe;if(typeof qe.then=="function")return Lt(Qe,Se(qe),ht);if(qe.$$typeof===le)return Lt(Qe,vl(Qe,qe),ht);Ze(Qe,qe)}return null}function pt(Qe,qe,ht,At){var Li=qe!==null?qe.key:null;if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return Li!==null?null:pe(Qe,qe,""+ht,At);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case Q:return ht.key===Li?De(Qe,qe,ht,At):null;case ne:return ht.key===Li?ft(Qe,qe,ht,At):null;case Ue:return ht=fe(ht),pt(Qe,qe,ht,At)}if(Tt(ht)||Ye(ht))return Li!==null?null:St(Qe,qe,ht,At,null);if(typeof ht.then=="function")return pt(Qe,qe,Se(ht),At);if(ht.$$typeof===le)return pt(Qe,qe,vl(Qe,ht),At);Ze(Qe,ht)}return null}function yt(Qe,qe,ht,At,Li){if(typeof At=="string"&&At!==""||typeof At=="number"||typeof At=="bigint")return Qe=Qe.get(ht)||null,pe(qe,Qe,""+At,Li);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case Q:return Qe=Qe.get(At.key===null?ht:At.key)||null,De(qe,Qe,At,Li);case ne:return Qe=Qe.get(At.key===null?ht:At.key)||null,ft(qe,Qe,At,Li);case Ue:return At=fe(At),yt(Qe,qe,ht,At,Li)}if(Tt(At)||Ye(At))return Qe=Qe.get(ht)||null,St(qe,Qe,At,Li,null);if(typeof At.then=="function")return yt(Qe,qe,ht,Se(At),Li);if(At.$$typeof===le)return yt(Qe,qe,ht,vl(qe,At),Li);Ze(qe,At)}return null}function _i(Qe,qe,ht,At){for(var Li=null,es=null,Ei=qe,vn=qe=0,zn=null;Ei!==null&&vn<ht.length;vn++){Ei.index>vn?(zn=Ei,Ei=null):zn=Ei.sibling;var ts=pt(Qe,Ei,ht[vn],At);if(ts===null){Ei===null&&(Ei=zn);break}s&&Ei&&ts.alternate===null&&o(Qe,Ei),qe=D(ts,qe,vn),es===null?Li=ts:es.sibling=ts,es=ts,Ei=zn}if(vn===ht.length)return p(Qe,Ei),It&&xi(Qe,vn),Li;if(Ei===null){for(;vn<ht.length;vn++)Ei=Lt(Qe,ht[vn],At),Ei!==null&&(qe=D(Ei,qe,vn),es===null?Li=Ei:es.sibling=Ei,es=Ei);return It&&xi(Qe,vn),Li}for(Ei=w(Ei);vn<ht.length;vn++)zn=yt(Ei,Qe,vn,ht[vn],At),zn!==null&&(s&&zn.alternate!==null&&Ei.delete(zn.key===null?vn:zn.key),qe=D(zn,qe,vn),es===null?Li=zn:es.sibling=zn,es=zn);return s&&Ei.forEach(function(Uh){return o(Qe,Uh)}),It&&xi(Qe,vn),Li}function Ni(Qe,qe,ht,At){if(ht==null)throw Error(l(151));for(var Li=null,es=null,Ei=qe,vn=qe=0,zn=null,ts=ht.next();Ei!==null&&!ts.done;vn++,ts=ht.next()){Ei.index>vn?(zn=Ei,Ei=null):zn=Ei.sibling;var Uh=pt(Qe,Ei,ts.value,At);if(Uh===null){Ei===null&&(Ei=zn);break}s&&Ei&&Uh.alternate===null&&o(Qe,Ei),qe=D(Uh,qe,vn),es===null?Li=Uh:es.sibling=Uh,es=Uh,Ei=zn}if(ts.done)return p(Qe,Ei),It&&xi(Qe,vn),Li;if(Ei===null){for(;!ts.done;vn++,ts=ht.next())ts=Lt(Qe,ts.value,At),ts!==null&&(qe=D(ts,qe,vn),es===null?Li=ts:es.sibling=ts,es=ts);return It&&xi(Qe,vn),Li}for(Ei=w(Ei);!ts.done;vn++,ts=ht.next())ts=yt(Ei,Qe,vn,ts.value,At),ts!==null&&(s&&ts.alternate!==null&&Ei.delete(ts.key===null?vn:ts.key),qe=D(ts,qe,vn),es===null?Li=ts:es.sibling=ts,es=ts);return s&&Ei.forEach(function(x2){return o(Qe,x2)}),It&&xi(Qe,vn),Li}function _s(Qe,qe,ht,At){if(typeof ht=="object"&&ht!==null&&ht.type===J&&ht.key===null&&(ht=ht.props.children),typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case Q:e:{for(var Li=ht.key;qe!==null;){if(qe.key===Li){if(Li=ht.type,Li===J){if(qe.tag===7){p(Qe,qe.sibling),At=P(qe,ht.props.children),At.return=Qe,Qe=At;break e}}else if(qe.elementType===Li||typeof Li=="object"&&Li!==null&&Li.$$typeof===Ue&&fe(Li)===qe.type){p(Qe,qe.sibling),At=P(qe,ht.props),$e(At,ht),At.return=Qe,Qe=At;break e}p(Qe,qe);break}else o(Qe,qe);qe=qe.sibling}ht.type===J?(At=Yr(ht.props.children,Qe.mode,At,ht.key),At.return=Qe,Qe=At):(At=ml(ht.type,ht.key,ht.props,null,Qe.mode,At),$e(At,ht),At.return=Qe,Qe=At)}return Y(Qe);case ne:e:{for(Li=ht.key;qe!==null;){if(qe.key===Li)if(qe.tag===4&&qe.stateNode.containerInfo===ht.containerInfo&&qe.stateNode.implementation===ht.implementation){p(Qe,qe.sibling),At=P(qe,ht.children||[]),At.return=Qe,Qe=At;break e}else{p(Qe,qe);break}else o(Qe,qe);qe=qe.sibling}At=lc(ht,Qe.mode,At),At.return=Qe,Qe=At}return Y(Qe);case Ue:return ht=fe(ht),_s(Qe,qe,ht,At)}if(Tt(ht))return _i(Qe,qe,ht,At);if(Ye(ht)){if(Li=Ye(ht),typeof Li!="function")throw Error(l(150));return ht=Li.call(ht),Ni(Qe,qe,ht,At)}if(typeof ht.then=="function")return _s(Qe,qe,Se(ht),At);if(ht.$$typeof===le)return _s(Qe,qe,vl(Qe,ht),At);Ze(Qe,ht)}return typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint"?(ht=""+ht,qe!==null&&qe.tag===6?(p(Qe,qe.sibling),At=P(qe,ht),At.return=Qe,Qe=At):(p(Qe,qe),At=gl(ht,Qe.mode,At),At.return=Qe,Qe=At),Y(Qe)):p(Qe,qe)}return function(Qe,qe,ht,At){try{Re=0;var Li=_s(Qe,qe,ht,At);return Ie=null,Li}catch(Ei){if(Ei===O||Ei===H)throw Ei;var es=Js(29,Ei,null,Qe.mode);return es.lanes=At,es.return=Qe,es}}}var bt=nt(!0),$t=nt(!1),Vt=!1;function ti(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qt(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ut(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ai(s,o,p){var w=s.updateQueue;if(w===null)return null;if(w=w.shared,(Vn&2)!==0){var P=w.pending;return P===null?o.next=o:(o.next=P.next,P.next=o),w.pending=o,o=qa(s),go(s,null,p),o}return Ms(s,w,o,p),qa(s)}function Ai(s,o,p){if(o=o.updateQueue,o!==null&&(o=o.shared,(p&4194048)!==0)){var w=o.lanes;w&=s.pendingLanes,p|=w,o.lanes=p,Ge(s,p)}}function Ht(s,o){var p=s.updateQueue,w=s.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var P=null,D=null;if(p=p.firstBaseUpdate,p!==null){do{var Y={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};D===null?P=D=Y:D=D.next=Y,p=p.next}while(p!==null);D===null?P=D=o:D=D.next=o}else P=D=o;p={baseState:w.baseState,firstBaseUpdate:P,lastBaseUpdate:D,shared:w.shared,callbacks:w.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=o:s.next=o,p.lastBaseUpdate=o}var Yt=!1;function Ci(){if(Yt){var s=wl;if(s!==null)throw s}}function Fn(s,o,p,w){Yt=!1;var P=s.updateQueue;Vt=!1;var D=P.firstBaseUpdate,Y=P.lastBaseUpdate,pe=P.shared.pending;if(pe!==null){P.shared.pending=null;var De=pe,ft=De.next;De.next=null,Y===null?D=ft:Y.next=ft,Y=De;var St=s.alternate;St!==null&&(St=St.updateQueue,pe=St.lastBaseUpdate,pe!==Y&&(pe===null?St.firstBaseUpdate=ft:pe.next=ft,St.lastBaseUpdate=De))}if(D!==null){var Lt=P.baseState;Y=0,St=ft=De=null,pe=D;do{var pt=pe.lane&-536870913,yt=pt!==pe.lane;if(yt?(Sn&pt)===pt:(w&pt)===pt){pt!==0&&pt===bl&&(Yt=!0),St!==null&&(St=St.next={lane:0,tag:pe.tag,payload:pe.payload,callback:null,next:null});e:{var _i=s,Ni=pe;pt=o;var _s=p;switch(Ni.tag){case 1:if(_i=Ni.payload,typeof _i=="function"){Lt=_i.call(_s,Lt,pt);break e}Lt=_i;break e;case 3:_i.flags=_i.flags&-65537|128;case 0:if(_i=Ni.payload,pt=typeof _i=="function"?_i.call(_s,Lt,pt):_i,pt==null)break e;Lt=N({},Lt,pt);break e;case 2:Vt=!0}}pt=pe.callback,pt!==null&&(s.flags|=64,yt&&(s.flags|=8192),yt=P.callbacks,yt===null?P.callbacks=[pt]:yt.push(pt))}else yt={lane:pt,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},St===null?(ft=St=yt,De=Lt):St=St.next=yt,Y|=pt;if(pe=pe.next,pe===null){if(pe=P.shared.pending,pe===null)break;yt=pe,pe=yt.next,yt.next=null,P.lastBaseUpdate=yt,P.shared.pending=null}}while(!0);St===null&&(De=Lt),P.baseState=De,P.firstBaseUpdate=ft,P.lastBaseUpdate=St,D===null&&(P.shared.lanes=0),au|=Y,s.lanes=Y,s.memoizedState=Lt}}function Hi(s,o){if(typeof s!="function")throw Error(l(191,s));s.call(o)}function an(s,o){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Hi(p[s],o)}var Nn=xe(null),er=xe(0);function Ga(s,o){s=qo,tt(er,s),tt(Nn,o),qo=s|o.baseLanes}function Xn(){tt(er,qo),tt(Nn,Nn.current)}function Rr(){qo=er.current,Le(Nn),Le(er)}var rs=xe(null),as=null;function Ps(s){var o=s.alternate;tt(Ln,Ln.current&1),tt(rs,s),as===null&&(o===null||Nn.current!==null||o.memoizedState!==null)&&(as=s)}function Wa(s){tt(Ln,Ln.current),tt(rs,s),as===null&&(as=s)}function hc(s){s.tag===22?(tt(Ln,Ln.current),tt(rs,s),as===null&&(as=s)):_o()}function _o(){tt(Ln,Ln.current),tt(rs,rs.current)}function ar(s){Le(rs),as===s&&(as=null),Le(Ln)}var Ln=xe(0);function dc(s){for(var o=s;o!==null;){if(o.tag===13){var p=o.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Dt(p)||Jt(p)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var vo=0,ji=null,dn=null,os=null,fa=!1,js=!1,Is=!1,Dr=0,Qi=0,Ya=null,Zc=0;function ls(){throw Error(l(321))}function uh(s,o){if(o===null)return!1;for(var p=0;p<o.length&&p<s.length;p++)if(!qs(s[p],o[p]))return!1;return!0}function td(s,o,p,w,P,D){return vo=D,ji=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Be.H=s===null||s.memoizedState===null?hg:Lp,Is=!1,D=p(w,P),Is=!1,js&&(D=Sl(o,p,w,P)),id(s),D}function id(s){Be.H=cd;var o=dn!==null&&dn.next!==null;if(vo=0,os=dn=ji=null,fa=!1,Qi=0,Ya=null,o)throw Error(l(300));s===null||Ns||(s=s.dependencies,s!==null&&lh(s)&&(Ns=!0))}function Sl(s,o,p,w){ji=s;var P=0;do{if(js&&(Ya=null),Qi=0,js=!1,25<=P)throw Error(l(301));if(P+=1,os=dn=null,s.updateQueue!=null){var D=s.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Be.H=zp,D=o(p,w)}while(js);return D}function af(){var s=Be.H,o=s.useState()[0];return o=typeof o.then=="function"?Yc(o):o,s=s.useState()[0],(dn!==null?dn.memoizedState:null)!==s&&(ji.flags|=1024),o}function Gc(){var s=Dr!==0;return Dr=0,s}function fc(s,o,p){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~p}function Wc(s){if(fa){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}fa=!1}vo=0,os=dn=ji=null,js=!1,Qi=Dr=0,Ya=null}function or(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return os===null?ji.memoizedState=os=s:os=os.next=s,os}function us(){if(dn===null){var s=ji.alternate;s=s!==null?s.memoizedState:null}else s=dn.next;var o=os===null?ji.memoizedState:os.next;if(o!==null)os=o,dn=s;else{if(s===null)throw ji.alternate===null?Error(l(467)):Error(l(310));dn=s,s={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},os===null?ji.memoizedState=os=s:os=os.next=s}return os}function Vl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yc(s){var o=Qi;return Qi+=1,Ya===null&&(Ya=[]),s=ae(Ya,s,o),o=ji,(os===null?o.memoizedState:os.next)===null&&(o=o.alternate,Be.H=o===null||o.memoizedState===null?hg:Lp),s}function nd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Yc(s);if(s.$$typeof===le)return Ji(s)}throw Error(l(438,String(s)))}function of(s){var o=null,p=ji.updateQueue;if(p!==null&&(o=p.memoCache),o==null){var w=ji.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(o={data:w.data.map(function(P){return P.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),p===null&&(p=Vl(),ji.updateQueue=p),p.memoCache=o,p=o.data[o.index],p===void 0)for(p=o.data[o.index]=Array(s),w=0;w<s;w++)p[w]=He;return o.index++,p}function pc(s,o){return typeof o=="function"?o(s):o}function hh(s){var o=us();return ju(o,dn,s)}function ju(s,o,p){var w=s.queue;if(w===null)throw Error(l(311));w.lastRenderedReducer=p;var P=s.baseQueue,D=w.pending;if(D!==null){if(P!==null){var Y=P.next;P.next=D.next,D.next=Y}o.baseQueue=P=D,w.pending=null}if(D=s.baseState,P===null)s.memoizedState=D;else{o=P.next;var pe=Y=null,De=null,ft=o,St=!1;do{var Lt=ft.lane&-536870913;if(Lt!==ft.lane?(Sn&Lt)===Lt:(vo&Lt)===Lt){var pt=ft.revertLane;if(pt===0)De!==null&&(De=De.next={lane:0,revertLane:0,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),Lt===bl&&(St=!0);else if((vo&pt)===pt){ft=ft.next,pt===bl&&(St=!0);continue}else Lt={lane:0,revertLane:ft.revertLane,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},De===null?(pe=De=Lt,Y=D):De=De.next=Lt,ji.lanes|=pt,au|=pt;Lt=ft.action,Is&&p(D,Lt),D=ft.hasEagerState?ft.eagerState:p(D,Lt)}else pt={lane:Lt,revertLane:ft.revertLane,gesture:ft.gesture,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},De===null?(pe=De=pt,Y=D):De=De.next=pt,ji.lanes|=Lt,au|=Lt;ft=ft.next}while(ft!==null&&ft!==o);if(De===null?Y=D:De.next=pe,!qs(D,s.memoizedState)&&(Ns=!0,St&&(p=wl,p!==null)))throw p;s.memoizedState=D,s.baseState=Y,s.baseQueue=De,w.lastRenderedState=D}return P===null&&(w.lanes=0),[s.memoizedState,w.dispatch]}function Xc(s){var o=us(),p=o.queue;if(p===null)throw Error(l(311));p.lastRenderedReducer=s;var w=p.dispatch,P=p.pending,D=o.memoizedState;if(P!==null){p.pending=null;var Y=P=P.next;do D=s(D,Y.action),Y=Y.next;while(Y!==P);qs(D,o.memoizedState)||(Ns=!0),o.memoizedState=D,o.baseQueue===null&&(o.baseState=D),p.lastRenderedState=D}return[D,w]}function ql(s,o,p){var w=ji,P=us(),D=It;if(D){if(p===void 0)throw Error(l(407));p=p()}else p=o();var Y=!qs((dn||P).memoizedState,p);if(Y&&(P.memoizedState=p,Ns=!0),P=P.queue,Iu(yp.bind(null,w,P,s),[s]),P.getSnapshot!==o||Y||os!==null&&os.memoizedState.tag&1){if(w.flags|=2048,eu(9,{destroy:void 0},mc.bind(null,w,P,p,o),null),hs===null)throw Error(l(349));D||(vo&127)!==0||Uo(w,o,p)}return p}function Uo(s,o,p){s.flags|=16384,s={getSnapshot:o,value:p},o=ji.updateQueue,o===null?(o=Vl(),ji.updateQueue=o,o.stores=[s]):(p=o.stores,p===null?o.stores=[s]:p.push(s))}function mc(s,o,p,w){o.value=p,o.getSnapshot=w,Kc(o)&&ng(s)}function yp(s,o,p){return p(function(){Kc(o)&&ng(s)})}function Kc(s){var o=s.getSnapshot;s=s.value;try{var p=o();return!qs(s,p)}catch{return!0}}function ng(s){var o=da(s,2);o!==null&&pa(o,s,2)}function lf(s){var o=or();if(typeof s=="function"){var p=s;if(s=p(),Is){Xt(!0);try{p()}finally{Xt(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pc,lastRenderedState:s},o}function Os(s,o,p,w){return s.baseState=p,ju(s,dn,typeof w=="function"?w:pc)}function _p(s,o,p,w,P){if(pf(s))throw Error(l(485));if(s=o.action,s!==null){var D={payload:P,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){D.listeners.push(Y)}};Be.T!==null?p(!0):D.isTransition=!1,w(D),p=o.pending,p===null?(D.next=o.pending=D,vp(o,D)):(D.next=p.next,o.pending=p.next=D)}}function vp(s,o){var p=o.action,w=o.payload,P=s.state;if(o.isTransition){var D=Be.T,Y={};Be.T=Y;try{var pe=p(P,w),De=Be.S;De!==null&&De(Y,pe),Jc(s,o,pe)}catch(ft){dh(s,o,ft)}finally{D!==null&&Y.types!==null&&(D.types=Y.types),Be.T=D}}else try{D=p(P,w),Jc(s,o,D)}catch(ft){dh(s,o,ft)}}function Jc(s,o,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(w){Qc(s,o,w)},function(w){return dh(s,o,w)}):Qc(s,o,p)}function Qc(s,o,p){o.status="fulfilled",o.value=p,cf(o),s.state=p,o=s.pending,o!==null&&(p=o.next,p===o?s.pending=null:(p=p.next,o.next=p,vp(s,p)))}function dh(s,o,p){var w=s.pending;if(s.pending=null,w!==null){w=w.next;do o.status="rejected",o.reason=p,cf(o),o=o.next;while(o!==w)}s.action=null}function cf(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function xp(s,o){return o}function sg(s,o){if(It){var p=hs.formState;if(p!==null){e:{var w=ji;if(It){if(Yi){t:{for(var P=Yi,D=zr;P.nodeType!==8;){if(!D){P=null;break t}if(P=Ft(P.nextSibling),P===null){P=null;break t}}D=P.data,P=D==="F!"||D==="F"?P:null}if(P){Yi=Ft(P.nextSibling),w=P.data==="F!";break e}}Xr(w)}w=!1}w&&(o=p[0])}}return p=or(),p.memoizedState=p.baseState=o,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xp,lastRenderedState:o},p.queue=w,p=Xa.bind(null,ji,w),w.dispatch=p,w=lf(!1),D=ld.bind(null,ji,!1,w.queue),w=or(),P={state:o,dispatch:null,action:s,pending:null},w.queue=P,p=_p.bind(null,ji,P,D,p),P.dispatch=p,w.memoizedState=s,[o,p,!1]}function bp(s){var o=us();return rg(o,dn,s)}function rg(s,o,p){if(o=ju(s,o,xp)[0],s=hh(pc)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var w=Yc(o)}catch(Y){throw Y===O?H:Y}else w=o;o=us();var P=o.queue,D=P.dispatch;return p!==o.memoizedState&&(ji.flags|=2048,eu(9,{destroy:void 0},wp.bind(null,P,p),null)),[w,D,s]}function wp(s,o){s.action=o}function ag(s){var o=us(),p=dn;if(p!==null)return rg(o,p,s);us(),o=o.memoizedState,p=us();var w=p.queue.dispatch;return p.memoizedState=s,[o,w,!1]}function eu(s,o,p,w){return s={tag:s,create:p,deps:w,inst:o,next:null},o=ji.updateQueue,o===null&&(o=Vl(),ji.updateQueue=o),p=o.lastEffect,p===null?o.lastEffect=s.next=s:(w=p.next,p.next=s,s.next=w,o.lastEffect=s),s}function Sp(){return us().memoizedState}function sd(s,o,p,w){var P=or();ji.flags|=s,P.memoizedState=eu(1|o,{destroy:void 0},p,w===void 0?null:w)}function gc(s,o,p,w){var P=us();w=w===void 0?null:w;var D=P.memoizedState.inst;dn!==null&&w!==null&&uh(w,dn.memoizedState.deps)?P.memoizedState=eu(o,D,p,w):(ji.flags|=s,P.memoizedState=eu(1|o,D,p,w))}function og(s,o){sd(8390656,8,s,o)}function Iu(s,o){gc(2048,8,s,o)}function uf(s){ji.flags|=4;var o=ji.updateQueue;if(o===null)o=Vl(),ji.updateQueue=o,o.events=[s];else{var p=o.events;p===null?o.events=[s]:p.push(s)}}function rd(s){var o=us().memoizedState;return uf({ref:o,nextImpl:s}),function(){if((Vn&2)!==0)throw Error(l(440));return o.impl.apply(void 0,arguments)}}function Tp(s,o){return gc(4,2,s,o)}function Ep(s,o){return gc(4,4,s,o)}function lg(s,o){if(typeof o=="function"){s=s();var p=o(s);return function(){typeof p=="function"?p():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Jr(s,o,p){p=p!=null?p.concat([s]):null,gc(4,4,lg.bind(null,o,s),p)}function tu(){}function hf(s,o){var p=us();o=o===void 0?null:o;var w=p.memoizedState;return o!==null&&uh(o,w[1])?w[0]:(p.memoizedState=[s,o],s)}function kp(s,o){var p=us();o=o===void 0?null:o;var w=p.memoizedState;if(o!==null&&uh(o,w[1]))return w[0];if(w=s(),Is){Xt(!0);try{s()}finally{Xt(!1)}}return p.memoizedState=[w,o],w}function Lu(s,o,p){return p===void 0||(vo&1073741824)!==0&&(Sn&261930)===0?s.memoizedState=o:(s.memoizedState=p,s=Ef(),ji.lanes|=s,au|=s,p)}function cg(s,o,p,w){return qs(p,o)?p:Nn.current!==null?(s=Lu(s,p,w),qs(s,o)||(Ns=!0),s):(vo&42)===0||(vo&1073741824)!==0&&(Sn&261930)===0?(Ns=!0,s.memoizedState=p):(s=Ef(),ji.lanes|=s,au|=s,o)}function ad(s,o,p,w,P){var D=ct.p;ct.p=D!==0&&8>D?D:8;var Y=Be.T,pe={};Be.T=pe,ld(s,!1,o,p);try{var De=P(),ft=Be.S;if(ft!==null&&ft(pe,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var St=i(De,w);fh(s,o,St,wo(s))}else fh(s,o,w,wo(s))}catch(Lt){fh(s,o,{then:function(){},status:"rejected",reason:Lt},wo())}finally{ct.p=D,Y!==null&&pe.types!==null&&(Y.types=pe.types),Be.T=Y}}function __(){}function df(s,o,p,w){if(s.tag!==5)throw Error(l(476));var P=Cp(s).queue;ad(s,P,o,ut,p===null?__:function(){return Ap(s),p(w)})}function Cp(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:ut,baseState:ut,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pc,lastRenderedState:ut},next:null};var p={};return o.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pc,lastRenderedState:p},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Ap(s){var o=Cp(s);o.next===null&&(o=s.alternate.memoizedState),fh(s,o.next.queue,{},wo())}function Mp(){return Ji(Bh)}function ff(){return us().memoizedState}function Pp(){return us().memoizedState}function jp(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var p=wo();s=Ut(p);var w=ai(o,s,p);w!==null&&(pa(w,o,p),Ai(w,o,p)),o={cache:Za()},s.payload=o;return}o=o.return}}function od(s,o,p){var w=wo();p={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},pf(s)?Ip(o,p):(p=pl(s,o,p,w),p!==null&&(pa(p,s,w),ug(p,o,w)))}function Xa(s,o,p){var w=wo();fh(s,o,p,w)}function fh(s,o,p,w){var P={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(pf(s))Ip(o,P);else{var D=s.alternate;if(s.lanes===0&&(D===null||D.lanes===0)&&(D=o.lastRenderedReducer,D!==null))try{var Y=o.lastRenderedState,pe=D(Y,p);if(P.hasEagerState=!0,P.eagerState=pe,qs(pe,Y))return Ms(s,o,P,0),hs===null&&wr(),!1}catch{}if(p=pl(s,o,P,w),p!==null)return pa(p,s,w),ug(p,o,w),!0}return!1}function ld(s,o,p,w){if(w={lane:2,revertLane:zh(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},pf(s)){if(o)throw Error(l(479))}else o=pl(s,p,w,2),o!==null&&pa(o,s,2)}function pf(s){var o=s.alternate;return s===ji||o!==null&&o===ji}function Ip(s,o){js=fa=!0;var p=s.pending;p===null?o.next=o:(o.next=p.next,p.next=o),s.pending=o}function ug(s,o,p){if((p&4194048)!==0){var w=o.lanes;w&=s.pendingLanes,p|=w,o.lanes=p,Ge(s,p)}}var cd={readContext:Ji,use:nd,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useLayoutEffect:ls,useInsertionEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useSyncExternalStore:ls,useId:ls,useHostTransitionStatus:ls,useFormState:ls,useActionState:ls,useOptimistic:ls,useMemoCache:ls,useCacheRefresh:ls};cd.useEffectEvent=ls;var hg={readContext:Ji,use:nd,useCallback:function(s,o){return or().memoizedState=[s,o===void 0?null:o],s},useContext:Ji,useEffect:og,useImperativeHandle:function(s,o,p){p=p!=null?p.concat([s]):null,sd(4194308,4,lg.bind(null,o,s),p)},useLayoutEffect:function(s,o){return sd(4194308,4,s,o)},useInsertionEffect:function(s,o){sd(4,2,s,o)},useMemo:function(s,o){var p=or();o=o===void 0?null:o;var w=s();if(Is){Xt(!0);try{s()}finally{Xt(!1)}}return p.memoizedState=[w,o],w},useReducer:function(s,o,p){var w=or();if(p!==void 0){var P=p(o);if(Is){Xt(!0);try{p(o)}finally{Xt(!1)}}}else P=o;return w.memoizedState=w.baseState=P,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:P},w.queue=s,s=s.dispatch=od.bind(null,ji,s),[w.memoizedState,s]},useRef:function(s){var o=or();return s={current:s},o.memoizedState=s},useState:function(s){s=lf(s);var o=s.queue,p=Xa.bind(null,ji,o);return o.dispatch=p,[s.memoizedState,p]},useDebugValue:tu,useDeferredValue:function(s,o){var p=or();return Lu(p,s,o)},useTransition:function(){var s=lf(!1);return s=ad.bind(null,ji,s.queue,!0,!1),or().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,p){var w=ji,P=or();if(It){if(p===void 0)throw Error(l(407));p=p()}else{if(p=o(),hs===null)throw Error(l(349));(Sn&127)!==0||Uo(w,o,p)}P.memoizedState=p;var D={value:p,getSnapshot:o};return P.queue=D,og(yp.bind(null,w,D,s),[s]),w.flags|=2048,eu(9,{destroy:void 0},mc.bind(null,w,D,p,o),null),p},useId:function(){var s=or(),o=hs.identifierPrefix;if(It){var p=Wt,w=wt;p=(w&~(1<<32-Wi(w)-1)).toString(32)+p,o="_"+o+"R_"+p,p=Dr++,0<p&&(o+="H"+p.toString(32)),o+="_"}else p=Zc++,o="_"+o+"r_"+p.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:Mp,useFormState:sg,useActionState:sg,useOptimistic:function(s){var o=or();o.memoizedState=o.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=p,o=ld.bind(null,ji,!0,p),p.dispatch=o,[s,o]},useMemoCache:of,useCacheRefresh:function(){return or().memoizedState=jp.bind(null,ji)},useEffectEvent:function(s){var o=or(),p={impl:s};return o.memoizedState=p,function(){if((Vn&2)!==0)throw Error(l(440));return p.impl.apply(void 0,arguments)}}},Lp={readContext:Ji,use:nd,useCallback:hf,useContext:Ji,useEffect:Iu,useImperativeHandle:Jr,useInsertionEffect:Tp,useLayoutEffect:Ep,useMemo:kp,useReducer:hh,useRef:Sp,useState:function(){return hh(pc)},useDebugValue:tu,useDeferredValue:function(s,o){var p=us();return cg(p,dn.memoizedState,s,o)},useTransition:function(){var s=hh(pc)[0],o=us().memoizedState;return[typeof s=="boolean"?s:Yc(s),o]},useSyncExternalStore:ql,useId:ff,useHostTransitionStatus:Mp,useFormState:bp,useActionState:bp,useOptimistic:function(s,o){var p=us();return Os(p,dn,s,o)},useMemoCache:of,useCacheRefresh:Pp};Lp.useEffectEvent=rd;var zp={readContext:Ji,use:nd,useCallback:hf,useContext:Ji,useEffect:Iu,useImperativeHandle:Jr,useInsertionEffect:Tp,useLayoutEffect:Ep,useMemo:kp,useReducer:Xc,useRef:Sp,useState:function(){return Xc(pc)},useDebugValue:tu,useDeferredValue:function(s,o){var p=us();return dn===null?Lu(p,s,o):cg(p,dn.memoizedState,s,o)},useTransition:function(){var s=Xc(pc)[0],o=us().memoizedState;return[typeof s=="boolean"?s:Yc(s),o]},useSyncExternalStore:ql,useId:ff,useHostTransitionStatus:Mp,useFormState:ag,useActionState:ag,useOptimistic:function(s,o){var p=us();return dn!==null?Os(p,dn,s,o):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:of,useCacheRefresh:Pp};zp.useEffectEvent=rd;function mf(s,o,p,w){o=s.memoizedState,p=p(w,o),p=p==null?o:N({},o,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var yc={enqueueSetState:function(s,o,p){s=s._reactInternals;var w=wo(),P=Ut(w);P.payload=o,p!=null&&(P.callback=p),o=ai(s,P,w),o!==null&&(pa(o,s,w),Ai(o,s,w))},enqueueReplaceState:function(s,o,p){s=s._reactInternals;var w=wo(),P=Ut(w);P.tag=1,P.payload=o,p!=null&&(P.callback=p),o=ai(s,P,w),o!==null&&(pa(o,s,w),Ai(o,s,w))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var p=wo(),w=Ut(p);w.tag=2,o!=null&&(w.callback=o),o=ai(s,w,p),o!==null&&(pa(o,s,p),Ai(o,s,p))}};function ph(s,o,p,w,P,D,Y){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(w,D,Y):o.prototype&&o.prototype.isPureReactComponent?!tn(p,w)||!tn(P,D):!0}function dg(s,o,p,w){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(p,w),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(p,w),o.state!==s&&yc.enqueueReplaceState(o,o.state,null)}function zu(s,o){var p=o;if("ref"in o){p={};for(var w in o)w!=="ref"&&(p[w]=o[w])}if(s=s.defaultProps){p===o&&(p=N({},p));for(var P in s)p[P]===void 0&&(p[P]=s[P])}return p}function fg(s){Ca(s)}function pg(s){console.error(s)}function mg(s){Ca(s)}function gf(s,o){try{var p=s.onUncaughtError;p(o.value,{componentStack:o.stack})}catch(w){setTimeout(function(){throw w})}}function gg(s,o,p){try{var w=s.onCaughtError;w(p.value,{componentStack:p.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(P){setTimeout(function(){throw P})}}function ud(s,o,p){return p=Ut(p),p.tag=3,p.payload={element:null},p.callback=function(){gf(s,o)},p}function yg(s){return s=Ut(s),s.tag=3,s}function Ru(s,o,p,w){var P=p.type.getDerivedStateFromError;if(typeof P=="function"){var D=w.value;s.payload=function(){return P(D)},s.callback=function(){gg(o,p,w)}}var Y=p.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(s.callback=function(){gg(o,p,w),typeof P!="function"&&(wc===null?wc=new Set([this]):wc.add(this));var pe=w.stack;this.componentDidCatch(w.value,{componentStack:pe!==null?pe:""})})}function v_(s,o,p,w,P){if(p.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(o=p.alternate,o!==null&&Hc(o,p,P,!0),p=rs.current,p!==null){switch(p.tag){case 31:case 13:return as===null?kf():p.alternate===null&&ks===0&&(ks=3),p.flags&=-257,p.flags|=65536,p.lanes=P,w===X?p.flags|=16384:(o=p.updateQueue,o===null?p.updateQueue=new Set([w]):o.add(w),Mf(s,w,P)),!1;case 22:return p.flags|=65536,w===X?p.flags|=16384:(o=p.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([w])},p.updateQueue=o):(p=o.retryQueue,p===null?o.retryQueue=new Set([w]):p.add(w)),Mf(s,w,P)),!1}throw Error(l(435,p.tag))}return Mf(s,w,P),kf(),!1}if(It)return o=rs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=P,w!==cc&&(s=Error(l(422),{cause:w}),_l(b(s,p)))):(w!==cc&&(o=Error(l(423),{cause:w}),_l(b(o,p))),s=s.current.alternate,s.flags|=65536,P&=-P,s.lanes|=P,w=b(w,p),P=ud(s.stateNode,w,P),Ht(s,P),ks!==4&&(ks=2)),!1;var D=Error(l(520),{cause:w});if(D=b(D,p),Ch===null?Ch=[D]:Ch.push(D),ks!==4&&(ks=2),o===null)return!0;w=b(w,p),p=o;do{switch(p.tag){case 3:return p.flags|=65536,s=P&-P,p.lanes|=s,s=ud(p.stateNode,w,s),Ht(p,s),!1;case 1:if(o=p.type,D=p.stateNode,(p.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(wc===null||!wc.has(D))))return p.flags|=65536,P&=-P,p.lanes|=P,P=yg(P),Ru(P,s,p,w),Ht(p,P),!1}p=p.return}while(p!==null);return!1}var Ss=Error(l(461)),Ns=!1;function Or(s,o,p,w){o.child=s===null?$t(o,null,p,w):bt(o,s.child,p,w)}function hd(s,o,p,w,P){p=p.render;var D=o.ref;if("ref"in w){var Y={};for(var pe in w)pe!=="ref"&&(Y[pe]=w[pe])}else Y=w;return Qs(o),w=td(s,o,p,Y,D,P),pe=Gc(),s!==null&&!Ns?(fc(s,o,P),Hl(s,o,P)):(It&&pe&&Hs(o),o.flags|=1,Or(s,o,w,P),o.child)}function dd(s,o,p,w,P){if(s===null){var D=p.type;return typeof D=="function"&&!Fl(D)&&D.defaultProps===void 0&&p.compare===null?(o.tag=15,o.type=D,mh(s,o,D,w,P)):(s=ml(p.type,null,w,o,o.mode,P),s.ref=o.ref,s.return=o,o.child=s)}if(D=s.child,!vf(s,P)){var Y=D.memoizedProps;if(p=p.compare,p=p!==null?p:tn,p(Y,w)&&s.ref===o.ref)return Hl(s,o,P)}return o.flags|=1,s=Wr(D,w),s.ref=o.ref,s.return=o,o.child=s}function mh(s,o,p,w,P){if(s!==null){var D=s.memoizedProps;if(tn(D,w)&&s.ref===o.ref)if(Ns=!1,o.pendingProps=w=D,vf(s,P))(s.flags&131072)!==0&&(Ns=!0);else return o.lanes=s.lanes,Hl(s,o,P)}return _f(s,o,p,w,P)}function Rp(s,o,p,w){var P=w.children,D=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((o.flags&128)!==0){if(D=D!==null?D.baseLanes|p:p,s!==null){for(w=o.child=s.child,P=0;w!==null;)P=P|w.lanes|w.childLanes,w=w.sibling;w=P&~D}else w=0,o.child=null;return yh(s,o,D,p,w)}if((p&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&T(o,D!==null?D.cachePool:null),D!==null?Ga(o,D):Xn(),hc(o);else return w=o.lanes=536870912,yh(s,o,D!==null?D.baseLanes|p:p,p,w)}else D!==null?(T(o,D.cachePool),Ga(o,D),_o(),o.memoizedState=null):(s!==null&&T(o,null),Xn(),_o());return Or(s,o,P,p),o.child}function gh(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function yh(s,o,p,w,P){var D=v();return D=D===null?null:{parent:ys._currentValue,pool:D},o.memoizedState={baseLanes:p,cachePool:D},s!==null&&T(o,null),Xn(),hc(o),s!==null&&Hc(s,o,w,!0),o.childLanes=P,null}function _h(s,o){return o=fd({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function yf(s,o,p){return bt(o,s.child,null,p),s=_h(o,o.pendingProps),s.flags|=2,ar(o),o.memoizedState=null,s}function Dp(s,o,p){var w=o.pendingProps,P=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(It){if(w.mode==="hidden")return s=_h(o,w),o.lanes=536870912,gh(null,s);if(Wa(o),(s=Yi)?(s=mt(s,zr),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:dt!==null?{id:wt,overflow:Wt}:null,retryLane:536870912,hydrationErrors:null},p=yl(s),p.return=o,o.child=p,_n=o,Yi=null)):s=null,s===null)throw Xr(o);return o.lanes=536870912,null}return _h(o,w)}var D=s.memoizedState;if(D!==null){var Y=D.dehydrated;if(Wa(o),P)if(o.flags&256)o.flags&=-257,o=yf(s,o,p);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(l(558));else if(Ns||Hc(s,o,p,!1),P=(p&s.childLanes)!==0,Ns||P){if(w=hs,w!==null&&(Y=at(w,p),Y!==0&&Y!==D.retryLane))throw D.retryLane=Y,da(s,Y),pa(w,s,Y),Ss;kf(),o=yf(s,o,p)}else s=D.treeContext,Yi=Ft(Y.nextSibling),_n=o,It=!0,Aa=null,zr=!1,s!==null&&Tr(o,s),o=_h(o,w),o.flags|=4096;return o}return s=Wr(s.child,{mode:w.mode,children:w.children}),s.ref=o.ref,o.child=s,s.return=o,s}function vh(s,o){var p=o.ref;if(p===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(l(284));(s===null||s.ref!==p)&&(o.flags|=4194816)}}function _f(s,o,p,w,P){return Qs(o),p=td(s,o,p,w,void 0,P),w=Gc(),s!==null&&!Ns?(fc(s,o,P),Hl(s,o,P)):(It&&w&&Hs(o),o.flags|=1,Or(s,o,p,P),o.child)}function Op(s,o,p,w,P,D){return Qs(o),o.updateQueue=null,p=Sl(o,w,p,P),id(s),w=Gc(),s!==null&&!Ns?(fc(s,o,D),Hl(s,o,D)):(It&&w&&Hs(o),o.flags|=1,Or(s,o,p,D),o.child)}function _g(s,o,p,w,P){if(Qs(o),o.stateNode===null){var D=Sr,Y=p.contextType;typeof Y=="object"&&Y!==null&&(D=Ji(Y)),D=new p(w,D),o.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=yc,o.stateNode=D,D._reactInternals=o,D=o.stateNode,D.props=w,D.state=o.memoizedState,D.refs={},ti(o),Y=p.contextType,D.context=typeof Y=="object"&&Y!==null?Ji(Y):Sr,D.state=o.memoizedState,Y=p.getDerivedStateFromProps,typeof Y=="function"&&(mf(o,p,Y,w),D.state=o.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(Y=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),Y!==D.state&&yc.enqueueReplaceState(D,D.state,null),Fn(o,w,D,P),Ci(),D.state=o.memoizedState),typeof D.componentDidMount=="function"&&(o.flags|=4194308),w=!0}else if(s===null){D=o.stateNode;var pe=o.memoizedProps,De=zu(p,pe);D.props=De;var ft=D.context,St=p.contextType;Y=Sr,typeof St=="object"&&St!==null&&(Y=Ji(St));var Lt=p.getDerivedStateFromProps;St=typeof Lt=="function"||typeof D.getSnapshotBeforeUpdate=="function",pe=o.pendingProps!==pe,St||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(pe||ft!==Y)&&dg(o,D,w,Y),Vt=!1;var pt=o.memoizedState;D.state=pt,Fn(o,w,D,P),Ci(),ft=o.memoizedState,pe||pt!==ft||Vt?(typeof Lt=="function"&&(mf(o,p,Lt,w),ft=o.memoizedState),(De=Vt||ph(o,p,De,w,pt,ft,Y))?(St||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(o.flags|=4194308)):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=w,o.memoizedState=ft),D.props=w,D.state=ft,D.context=Y,w=De):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),w=!1)}else{D=o.stateNode,qt(s,o),Y=o.memoizedProps,St=zu(p,Y),D.props=St,Lt=o.pendingProps,pt=D.context,ft=p.contextType,De=Sr,typeof ft=="object"&&ft!==null&&(De=Ji(ft)),pe=p.getDerivedStateFromProps,(ft=typeof pe=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Y!==Lt||pt!==De)&&dg(o,D,w,De),Vt=!1,pt=o.memoizedState,D.state=pt,Fn(o,w,D,P),Ci();var yt=o.memoizedState;Y!==Lt||pt!==yt||Vt||s!==null&&s.dependencies!==null&&lh(s.dependencies)?(typeof pe=="function"&&(mf(o,p,pe,w),yt=o.memoizedState),(St=Vt||ph(o,p,St,w,pt,yt,De)||s!==null&&s.dependencies!==null&&lh(s.dependencies))?(ft||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(w,yt,De),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(w,yt,De)),typeof D.componentDidUpdate=="function"&&(o.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof D.componentDidUpdate!="function"||Y===s.memoizedProps&&pt===s.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&pt===s.memoizedState||(o.flags|=1024),o.memoizedProps=w,o.memoizedState=yt),D.props=w,D.state=yt,D.context=De,w=St):(typeof D.componentDidUpdate!="function"||Y===s.memoizedProps&&pt===s.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&pt===s.memoizedState||(o.flags|=1024),w=!1)}return D=w,vh(s,o),w=(o.flags&128)!==0,D||w?(D=o.stateNode,p=w&&typeof p.getDerivedStateFromError!="function"?null:D.render(),o.flags|=1,s!==null&&w?(o.child=bt(o,s.child,null,P),o.child=bt(o,null,p,P)):Or(s,o,p,P),o.memoizedState=D.state,s=o.child):s=Hl(s,o,P),s}function vg(s,o,p,w){return yo(),o.flags|=256,Or(s,o,p,w),o.child}var Np={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bp(s){return{baseLanes:s,cachePool:z()}}function $p(s,o,p){return s=s!==null?s.childLanes&~p:0,o&&(s|=Qa),s}function _c(s,o,p){var w=o.pendingProps,P=!1,D=(o.flags&128)!==0,Y;if((Y=D)||(Y=s!==null&&s.memoizedState===null?!1:(Ln.current&2)!==0),Y&&(P=!0,o.flags&=-129),Y=(o.flags&32)!==0,o.flags&=-33,s===null){if(It){if(P?Ps(o):_o(),(s=Yi)?(s=mt(s,zr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:dt!==null?{id:wt,overflow:Wt}:null,retryLane:536870912,hydrationErrors:null},p=yl(s),p.return=o,o.child=p,_n=o,Yi=null)):s=null,s===null)throw Xr(o);return Jt(s)?o.lanes=32:o.lanes=536870912,null}var pe=w.children;return w=w.fallback,P?(_o(),P=o.mode,pe=fd({mode:"hidden",children:pe},P),w=Yr(w,P,p,null),pe.return=o,w.return=o,pe.sibling=w,o.child=pe,w=o.child,w.memoizedState=Bp(p),w.childLanes=$p(s,Y,p),o.memoizedState=Np,gh(null,w)):(Ps(o),Up(o,pe))}var De=s.memoizedState;if(De!==null&&(pe=De.dehydrated,pe!==null)){if(D)o.flags&256?(Ps(o),o.flags&=-257,o=iu(s,o,p)):o.memoizedState!==null?(_o(),o.child=s.child,o.flags|=128,o=null):(_o(),pe=w.fallback,P=o.mode,w=fd({mode:"visible",children:w.children},P),pe=Yr(pe,P,p,null),pe.flags|=2,w.return=o,pe.return=o,w.sibling=pe,o.child=w,bt(o,s.child,null,p),w=o.child,w.memoizedState=Bp(p),w.childLanes=$p(s,Y,p),o.memoizedState=Np,o=gh(null,w));else if(Ps(o),Jt(pe)){if(Y=pe.nextSibling&&pe.nextSibling.dataset,Y)var ft=Y.dgst;Y=ft,w=Error(l(419)),w.stack="",w.digest=Y,_l({value:w,source:null,stack:null}),o=iu(s,o,p)}else if(Ns||Hc(s,o,p,!1),Y=(p&s.childLanes)!==0,Ns||Y){if(Y=hs,Y!==null&&(w=at(Y,p),w!==0&&w!==De.retryLane))throw De.retryLane=w,da(s,w),pa(Y,s,w),Ss;Dt(pe)||kf(),o=iu(s,o,p)}else Dt(pe)?(o.flags|=192,o.child=s.child,o=null):(s=De.treeContext,Yi=Ft(pe.nextSibling),_n=o,It=!0,Aa=null,zr=!1,s!==null&&Tr(o,s),o=Up(o,w.children),o.flags|=4096);return o}return P?(_o(),pe=w.fallback,P=o.mode,De=s.child,ft=De.sibling,w=Wr(De,{mode:"hidden",children:w.children}),w.subtreeFlags=De.subtreeFlags&65011712,ft!==null?pe=Wr(ft,pe):(pe=Yr(pe,P,p,null),pe.flags|=2),pe.return=o,w.return=o,w.sibling=pe,o.child=w,gh(null,w),w=o.child,pe=s.child.memoizedState,pe===null?pe=Bp(p):(P=pe.cachePool,P!==null?(De=ys._currentValue,P=P.parent!==De?{parent:De,pool:De}:P):P=z(),pe={baseLanes:pe.baseLanes|p,cachePool:P}),w.memoizedState=pe,w.childLanes=$p(s,Y,p),o.memoizedState=Np,gh(s.child,w)):(Ps(o),p=s.child,s=p.sibling,p=Wr(p,{mode:"visible",children:w.children}),p.return=o,p.sibling=null,s!==null&&(Y=o.deletions,Y===null?(o.deletions=[s],o.flags|=16):Y.push(s)),o.child=p,o.memoizedState=null,p)}function Up(s,o){return o=fd({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function fd(s,o){return s=Js(22,s,null,o),s.lanes=0,s}function iu(s,o,p){return bt(o,s.child,null,p),s=Up(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function xg(s,o,p){s.lanes|=o;var w=s.alternate;w!==null&&(w.lanes|=o),Qh(s.return,o,p)}function Fp(s,o,p,w,P,D){var Y=s.memoizedState;Y===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:P,treeForkCount:D}:(Y.isBackwards=o,Y.rendering=null,Y.renderingStartTime=0,Y.last=w,Y.tail=p,Y.tailMode=P,Y.treeForkCount=D)}function bg(s,o,p){var w=o.pendingProps,P=w.revealOrder,D=w.tail;w=w.children;var Y=Ln.current,pe=(Y&2)!==0;if(pe?(Y=Y&1|2,o.flags|=128):Y&=1,tt(Ln,Y),Or(s,o,w,p),w=It?ce:0,!pe&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&xg(s,p,o);else if(s.tag===19)xg(s,p,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(P){case"forwards":for(p=o.child,P=null;p!==null;)s=p.alternate,s!==null&&dc(s)===null&&(P=p),p=p.sibling;p=P,p===null?(P=o.child,o.child=null):(P=p.sibling,p.sibling=null),Fp(o,!1,P,p,D,w);break;case"backwards":case"unstable_legacy-backwards":for(p=null,P=o.child,o.child=null;P!==null;){if(s=P.alternate,s!==null&&dc(s)===null){o.child=P;break}s=P.sibling,P.sibling=p,p=P,P=s}Fp(o,!0,p,null,D,w);break;case"together":Fp(o,!1,null,null,void 0,w);break;default:o.memoizedState=null}return o.child}function Hl(s,o,p){if(s!==null&&(o.dependencies=s.dependencies),au|=o.lanes,(p&o.childLanes)===0)if(s!==null){if(Hc(s,o,p,!1),(p&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(l(153));if(o.child!==null){for(s=o.child,p=Wr(s,s.pendingProps),o.child=p,p.return=o;s.sibling!==null;)s=s.sibling,p=p.sibling=Wr(s,s.pendingProps),p.return=o;p.sibling=null}return o.child}function vf(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&lh(s)))}function x_(s,o,p){switch(o.tag){case 3:ei(o,o.stateNode.containerInfo),Bo(o,ys,s.memoizedState.cache),yo();break;case 27:case 5:Vi(o);break;case 4:ei(o,o.stateNode.containerInfo);break;case 10:Bo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Wa(o),null;break;case 13:var w=o.memoizedState;if(w!==null)return w.dehydrated!==null?(Ps(o),o.flags|=128,null):(p&o.child.childLanes)!==0?_c(s,o,p):(Ps(o),s=Hl(s,o,p),s!==null?s.sibling:null);Ps(o);break;case 19:var P=(s.flags&128)!==0;if(w=(p&o.childLanes)!==0,w||(Hc(s,o,p,!1),w=(p&o.childLanes)!==0),P){if(w)return bg(s,o,p);o.flags|=128}if(P=o.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),tt(Ln,Ln.current),w)break;return null;case 22:return o.lanes=0,Rp(s,o,p,o.pendingProps);case 24:Bo(o,ys,s.memoizedState.cache)}return Hl(s,o,p)}function wg(s,o,p){if(s!==null)if(s.memoizedProps!==o.pendingProps)Ns=!0;else{if(!vf(s,p)&&(o.flags&128)===0)return Ns=!1,x_(s,o,p);Ns=(s.flags&131072)!==0}else Ns=!1,It&&(o.flags&1048576)!==0&&nn(o,ce,o.index);switch(o.lanes=0,o.tag){case 16:e:{var w=o.pendingProps;if(s=fe(o.elementType),o.type=s,typeof s=="function")Fl(s)?(w=zu(s,w),o.tag=1,o=_g(null,o,s,w,p)):(o.tag=0,o=_f(null,o,s,w,p));else{if(s!=null){var P=s.$$typeof;if(P===me){o.tag=11,o=hd(null,o,s,w,p);break e}else if(P===Me){o.tag=14,o=dd(null,o,s,w,p);break e}}throw o=et(s)||s,Error(l(306,o,""))}}return o;case 0:return _f(s,o,o.type,o.pendingProps,p);case 1:return w=o.type,P=zu(w,o.pendingProps),_g(s,o,w,P,p);case 3:e:{if(ei(o,o.stateNode.containerInfo),s===null)throw Error(l(387));w=o.pendingProps;var D=o.memoizedState;P=D.element,qt(s,o),Fn(o,w,null,p);var Y=o.memoizedState;if(w=Y.cache,Bo(o,ys,w),w!==D.cache&&Au(o,[ys],p,!0),Ci(),w=Y.element,D.isDehydrated)if(D={element:w,isDehydrated:!1,cache:Y.cache},o.updateQueue.baseState=D,o.memoizedState=D,o.flags&256){o=vg(s,o,w,p);break e}else if(w!==P){P=b(Error(l(424)),o),_l(P),o=vg(s,o,w,p);break e}else for(s=o.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Yi=Ft(s.firstChild),_n=o,It=!0,Aa=null,zr=!0,p=$t(o,null,w,p),o.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(yo(),w===P){o=Hl(s,o,p);break e}Or(s,o,w,p)}o=o.child}return o;case 26:return vh(s,o),s===null?(p=Ar(o.type,null,o.pendingProps,null))?o.memoizedState=p:It||(p=o.type,s=o.pendingProps,w=x(Pt.current).createElement(p),w[Ct]=o,w[ni]=s,kr(w,p,s),mn(w),o.stateNode=w):o.memoizedState=Ar(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Vi(o),s===null&&It&&(w=o.stateNode=ri(o.type,o.pendingProps,Pt.current),_n=o,zr=!0,P=Yi,de(o.type)?(Zt=P,Yi=Ft(w.firstChild)):Yi=P),Or(s,o,o.pendingProps.children,p),vh(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&It&&((P=w=Yi)&&(w=Oe(w,o.type,o.pendingProps,zr),w!==null?(o.stateNode=w,_n=o,Yi=Ft(w.firstChild),zr=!1,P=!0):P=!1),P||Xr(o)),Vi(o),P=o.type,D=o.pendingProps,Y=s!==null?s.memoizedProps:null,w=D.children,I(P,D)?w=null:Y!==null&&I(P,Y)&&(o.flags|=32),o.memoizedState!==null&&(P=td(s,o,af,null,null,p),Bh._currentValue=P),vh(s,o),Or(s,o,w,p),o.child;case 6:return s===null&&It&&((s=p=Yi)&&(p=We(p,o.pendingProps,zr),p!==null?(o.stateNode=p,_n=o,Yi=null,s=!0):s=!1),s||Xr(o)),null;case 13:return _c(s,o,p);case 4:return ei(o,o.stateNode.containerInfo),w=o.pendingProps,s===null?o.child=bt(o,null,w,p):Or(s,o,w,p),o.child;case 11:return hd(s,o,o.type,o.pendingProps,p);case 7:return Or(s,o,o.pendingProps,p),o.child;case 8:return Or(s,o,o.pendingProps.children,p),o.child;case 12:return Or(s,o,o.pendingProps.children,p),o.child;case 10:return w=o.pendingProps,Bo(o,o.type,w.value),Or(s,o,w.children,p),o.child;case 9:return P=o.type._context,w=o.pendingProps.children,Qs(o),P=Ji(P),w=w(P),o.flags|=1,Or(s,o,w,p),o.child;case 14:return dd(s,o,o.type,o.pendingProps,p);case 15:return mh(s,o,o.type,o.pendingProps,p);case 19:return bg(s,o,p);case 31:return Dp(s,o,p);case 22:return Rp(s,o,p,o.pendingProps);case 24:return Qs(o),w=Ji(ys),s===null?(P=v(),P===null&&(P=hs,D=Za(),P.pooledCache=D,D.refCount++,D!==null&&(P.pooledCacheLanes|=p),P=D),o.memoizedState={parent:w,cache:P},ti(o),Bo(o,ys,P)):((s.lanes&p)!==0&&(qt(s,o),Fn(o,null,null,p),Ci()),P=s.memoizedState,D=o.memoizedState,P.parent!==w?(P={parent:w,cache:w},o.memoizedState=P,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=P),Bo(o,ys,w)):(w=D.cache,Bo(o,ys,w),w!==P.cache&&Au(o,[ys],p,!0))),Or(s,o,o.pendingProps.children,p),o.child;case 29:throw o.pendingProps}throw Error(l(156,o.tag))}function vc(s){s.flags|=4}function Vp(s,o,p,w,P){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(P&335544128)===P)if(s.stateNode.complete)s.flags|=8192;else if(Ng())s.flags|=8192;else throw _e=X,U}else s.flags&=-16777217}function xf(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!pr(o))if(Ng())s.flags|=8192;else throw _e=X,U}function nu(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?ve():536870912,s.lanes|=o,kh|=o)}function Du(s,o){if(!It)switch(s.tailMode){case"hidden":o=s.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:w.sibling=null}}function Ts(s){var o=s.alternate!==null&&s.alternate.child===s.child,p=0,w=0;if(o)for(var P=s.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags&65011712,w|=P.flags&65011712,P.return=s,P=P.sibling;else for(P=s.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags,w|=P.flags,P.return=s,P=P.sibling;return s.subtreeFlags|=w,s.childLanes=p,o}function b_(s,o,p){var w=o.pendingProps;switch(ws(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ts(o),null;case 1:return Ts(o),null;case 3:return p=o.stateNode,w=null,s!==null&&(w=s.memoizedState.cache),o.memoizedState.cache!==w&&(o.flags|=2048),$o(ys),gi(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Oi(o)?vc(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Cu())),Ts(o),null;case 26:var P=o.type,D=o.memoizedState;return s===null?(vc(o),D!==null?(Ts(o),xf(o,D)):(Ts(o),Vp(o,P,null,w,p))):D?D!==s.memoizedState?(vc(o),Ts(o),xf(o,D)):(Ts(o),o.flags&=-16777217):(s=s.memoizedProps,s!==w&&vc(o),Ts(o),Vp(o,P,s,w,p)),null;case 27:if(pi(o),p=Pt.current,P=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==w&&vc(o);else{if(!w){if(o.stateNode===null)throw Error(l(166));return Ts(o),null}s=rt.current,Oi(o)?No(o):(s=ri(P,w,p),o.stateNode=s,vc(o))}return Ts(o),null;case 5:if(pi(o),P=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==w&&vc(o);else{if(!w){if(o.stateNode===null)throw Error(l(166));return Ts(o),null}if(D=rt.current,Oi(o))No(o);else{var Y=x(Pt.current);switch(D){case 1:D=Y.createElementNS("http://www.w3.org/2000/svg",P);break;case 2:D=Y.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;default:switch(P){case"svg":D=Y.createElementNS("http://www.w3.org/2000/svg",P);break;case"math":D=Y.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;case"script":D=Y.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof w.is=="string"?Y.createElement("select",{is:w.is}):Y.createElement("select"),w.multiple?D.multiple=!0:w.size&&(D.size=w.size);break;default:D=typeof w.is=="string"?Y.createElement(P,{is:w.is}):Y.createElement(P)}}D[Ct]=o,D[ni]=w;e:for(Y=o.child;Y!==null;){if(Y.tag===5||Y.tag===6)D.appendChild(Y.stateNode);else if(Y.tag!==4&&Y.tag!==27&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===o)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===o)break e;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}o.stateNode=D;e:switch(kr(D,P,w),P){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&vc(o)}}return Ts(o),Vp(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,p),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==w&&vc(o);else{if(typeof w!="string"&&o.stateNode===null)throw Error(l(166));if(s=Pt.current,Oi(o)){if(s=o.stateNode,p=o.memoizedProps,w=null,P=_n,P!==null)switch(P.tag){case 27:case 5:w=P.memoizedProps}s[Ct]=o,s=!!(s.nodeValue===p||w!==null&&w.suppressHydrationWarning===!0||Dh(s.nodeValue,p)),s||Xr(o,!0)}else s=x(s).createTextNode(w),s[Ct]=o,o.stateNode=s}return Ts(o),null;case 31:if(p=o.memoizedState,s===null||s.memoizedState!==null){if(w=Oi(o),p!==null){if(s===null){if(!w)throw Error(l(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(l(557));s[Ct]=o}else yo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ts(o),s=!1}else p=Cu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),s=!0;if(!s)return o.flags&256?(ar(o),o):(ar(o),null);if((o.flags&128)!==0)throw Error(l(558))}return Ts(o),null;case 13:if(w=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(P=Oi(o),w!==null&&w.dehydrated!==null){if(s===null){if(!P)throw Error(l(318));if(P=o.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(l(317));P[Ct]=o}else yo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ts(o),P=!1}else P=Cu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=P),P=!0;if(!P)return o.flags&256?(ar(o),o):(ar(o),null)}return ar(o),(o.flags&128)!==0?(o.lanes=p,o):(p=w!==null,s=s!==null&&s.memoizedState!==null,p&&(w=o.child,P=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(P=w.alternate.memoizedState.cachePool.pool),D=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(D=w.memoizedState.cachePool.pool),D!==P&&(w.flags|=2048)),p!==s&&p&&(o.child.flags|=8192),nu(o,o.updateQueue),Ts(o),null);case 4:return gi(),s===null&&dm(o.stateNode.containerInfo),Ts(o),null;case 10:return $o(o.type),Ts(o),null;case 19:if(Le(Ln),w=o.memoizedState,w===null)return Ts(o),null;if(P=(o.flags&128)!==0,D=w.rendering,D===null)if(P)Du(w,!1);else{if(ks!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(D=dc(s),D!==null){for(o.flags|=128,Du(w,!1),s=D.updateQueue,o.updateQueue=s,nu(o,s),o.subtreeFlags=0,s=p,p=o.child;p!==null;)oc(p,s),p=p.sibling;return tt(Ln,Ln.current&1|2),It&&xi(o,w.treeForkCount),o.child}s=s.sibling}w.tail!==null&&sn()>Tf&&(o.flags|=128,P=!0,Du(w,!1),o.lanes=4194304)}else{if(!P)if(s=dc(D),s!==null){if(o.flags|=128,P=!0,s=s.updateQueue,o.updateQueue=s,nu(o,s),Du(w,!0),w.tail===null&&w.tailMode==="hidden"&&!D.alternate&&!It)return Ts(o),null}else 2*sn()-w.renderingStartTime>Tf&&p!==536870912&&(o.flags|=128,P=!0,Du(w,!1),o.lanes=4194304);w.isBackwards?(D.sibling=o.child,o.child=D):(s=w.last,s!==null?s.sibling=D:o.child=D,w.last=D)}return w.tail!==null?(s=w.tail,w.rendering=s,w.tail=s.sibling,w.renderingStartTime=sn(),s.sibling=null,p=Ln.current,tt(Ln,P?p&1|2:p&1),It&&xi(o,w.treeForkCount),s):(Ts(o),null);case 22:case 23:return ar(o),Rr(),w=o.memoizedState!==null,s!==null?s.memoizedState!==null!==w&&(o.flags|=8192):w&&(o.flags|=8192),w?(p&536870912)!==0&&(o.flags&128)===0&&(Ts(o),o.subtreeFlags&6&&(o.flags|=8192)):Ts(o),p=o.updateQueue,p!==null&&nu(o,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),w=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(w=o.memoizedState.cachePool.pool),w!==p&&(o.flags|=2048),s!==null&&Le(g),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),$o(ys),Ts(o),null;case 25:return null;case 30:return null}throw Error(l(156,o.tag))}function Sg(s,o){switch(ws(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return $o(ys),gi(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return pi(o),null;case 31:if(o.memoizedState!==null){if(ar(o),o.alternate===null)throw Error(l(340));yo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(ar(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(l(340));yo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return Le(Ln),null;case 4:return gi(),null;case 10:return $o(o.type),null;case 22:case 23:return ar(o),Rr(),s!==null&&Le(g),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return $o(ys),null;case 25:return null;default:return null}}function Tg(s,o){switch(ws(o),o.tag){case 3:$o(ys),gi();break;case 26:case 27:case 5:pi(o);break;case 4:gi();break;case 31:o.memoizedState!==null&&ar(o);break;case 13:ar(o);break;case 19:Le(Ln);break;case 10:$o(o.type);break;case 22:case 23:ar(o),Rr(),s!==null&&Le(g);break;case 24:$o(ys)}}function pd(s,o){try{var p=o.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var P=w.next;p=P;do{if((p.tag&s)===s){w=void 0;var D=p.create,Y=p.inst;w=D(),Y.destroy=w}p=p.next}while(p!==P)}}catch(pe){Jn(o,o.return,pe)}}function Fo(s,o,p){try{var w=o.updateQueue,P=w!==null?w.lastEffect:null;if(P!==null){var D=P.next;w=D;do{if((w.tag&s)===s){var Y=w.inst,pe=Y.destroy;if(pe!==void 0){Y.destroy=void 0,P=o;var De=p,ft=pe;try{ft()}catch(St){Jn(P,De,St)}}}w=w.next}while(w!==D)}}catch(St){Jn(o,o.return,St)}}function qp(s){var o=s.updateQueue;if(o!==null){var p=s.stateNode;try{an(o,p)}catch(w){Jn(s,s.return,w)}}}function Eg(s,o,p){p.props=zu(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(w){Jn(s,o,w)}}function md(s,o){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var w=s.stateNode;break;case 30:w=s.stateNode;break;default:w=s.stateNode}typeof p=="function"?s.refCleanup=p(w):p.current=w}}catch(P){Jn(s,o,P)}}function Zl(s,o){var p=s.ref,w=s.refCleanup;if(p!==null)if(typeof w=="function")try{w()}catch(P){Jn(s,o,P)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(P){Jn(s,o,P)}else p.current=null}function kg(s){var o=s.type,p=s.memoizedProps,w=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":p.autoFocus&&w.focus();break e;case"img":p.src?w.src=p.src:p.srcSet&&(w.srcset=p.srcSet)}}catch(P){Jn(s,s.return,P)}}function Hp(s,o,p){try{var w=s.stateNode;A_(w,s.type,p,o),w[ni]=o}catch(P){Jn(s,s.return,P)}}function Cg(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&de(s.type)||s.tag===4}function bf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Cg(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&de(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function gd(s,o,p){var w=s.tag;if(w===5||w===6)s=s.stateNode,o?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,o):(o=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,o.appendChild(s),p=p._reactRootContainer,p!=null||o.onclick!==null||(o.onclick=Us));else if(w!==4&&(w===27&&de(s.type)&&(p=s.stateNode,o=null),s=s.child,s!==null))for(gd(s,o,p),s=s.sibling;s!==null;)gd(s,o,p),s=s.sibling}function yd(s,o,p){var w=s.tag;if(w===5||w===6)s=s.stateNode,o?p.insertBefore(s,o):p.appendChild(s);else if(w!==4&&(w===27&&de(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(yd(s,o,p),s=s.sibling;s!==null;)yd(s,o,p),s=s.sibling}function Zp(s){var o=s.stateNode,p=s.memoizedProps;try{for(var w=s.type,P=o.attributes;P.length;)o.removeAttributeNode(P[0]);kr(o,w,p),o[Ct]=s,o[ni]=p}catch(D){Jn(s,s.return,D)}}var Gl=!1,lr=!1,xh=!1,Ag=typeof WeakSet=="function"?WeakSet:Set,Er=null;function w_(s,o){if(s=s.containerInfo,c=Df,s=Va(s),fo(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var P=w.anchorOffset,D=w.focusNode;w=w.focusOffset;try{p.nodeType,D.nodeType}catch{p=null;break e}var Y=0,pe=-1,De=-1,ft=0,St=0,Lt=s,pt=null;t:for(;;){for(var yt;Lt!==p||P!==0&&Lt.nodeType!==3||(pe=Y+P),Lt!==D||w!==0&&Lt.nodeType!==3||(De=Y+w),Lt.nodeType===3&&(Y+=Lt.nodeValue.length),(yt=Lt.firstChild)!==null;)pt=Lt,Lt=yt;for(;;){if(Lt===s)break t;if(pt===p&&++ft===P&&(pe=Y),pt===D&&++St===w&&(De=Y),(yt=Lt.nextSibling)!==null)break;Lt=pt,pt=Lt.parentNode}Lt=yt}p=pe===-1||De===-1?null:{start:pe,end:De}}else p=null}p=p||{start:0,end:0}}else p=null;for(m={focusedElem:s,selectionRange:p},Df=!1,Er=o;Er!==null;)if(o=Er,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Er=s;else for(;Er!==null;){switch(o=Er,D=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(p=0;p<s.length;p++)P=s[p],P.ref.impl=P.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&D!==null){s=void 0,p=o,P=D.memoizedProps,D=D.memoizedState,w=p.stateNode;try{var _i=zu(p.type,P);s=w.getSnapshotBeforeUpdate(_i,D),w.__reactInternalSnapshotBeforeUpdate=s}catch(Ni){Jn(p,p.return,Ni)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,p=s.nodeType,p===9)Je(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Je(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(l(163))}if(s=o.sibling,s!==null){s.return=o.return,Er=s;break}Er=o.return}}function Mg(s,o,p){var w=p.flags;switch(p.tag){case 0:case 11:case 15:Ja(s,p),w&4&&pd(5,p);break;case 1:if(Ja(s,p),w&4)if(s=p.stateNode,o===null)try{s.componentDidMount()}catch(Y){Jn(p,p.return,Y)}else{var P=zu(p.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(P,o,s.__reactInternalSnapshotBeforeUpdate)}catch(Y){Jn(p,p.return,Y)}}w&64&&qp(p),w&512&&md(p,p.return);break;case 3:if(Ja(s,p),w&64&&(s=p.updateQueue,s!==null)){if(o=null,p.child!==null)switch(p.child.tag){case 27:case 5:o=p.child.stateNode;break;case 1:o=p.child.stateNode}try{an(s,o)}catch(Y){Jn(p,p.return,Y)}}break;case 27:o===null&&w&4&&Zp(p);case 26:case 5:Ja(s,p),o===null&&w&4&&kg(p),w&512&&md(p,p.return);break;case 12:Ja(s,p);break;case 31:Ja(s,p),w&4&&Zs(s,p);break;case 13:Ja(s,p),w&4&&Gp(s,p),w&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Ug.bind(null,p),Ti(s,p))));break;case 22:if(w=p.memoizedState!==null||Gl,!w){o=o!==null&&o.memoizedState!==null||lr,P=Gl;var D=lr;Gl=w,(lr=o)&&!D?bc(s,p,(p.subtreeFlags&8772)!==0):Ja(s,p),Gl=P,lr=D}break;case 30:break;default:Ja(s,p)}}function Pg(s){var o=s.alternate;o!==null&&(s.alternate=null,Pg(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&Ne(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Es=null,Ka=!1;function xc(s,o,p){for(p=p.child;p!==null;)bh(s,o,p),p=p.sibling}function bh(s,o,p){if(ii&&typeof ii.onCommitFiberUnmount=="function")try{ii.onCommitFiberUnmount(jt,p)}catch{}switch(p.tag){case 26:lr||Zl(p,o),xc(s,o,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:lr||Zl(p,o);var w=Es,P=Ka;de(p.type)&&(Es=p.stateNode,Ka=!1),xc(s,o,p),vt(p.stateNode),Es=w,Ka=P;break;case 5:lr||Zl(p,o);case 6:if(w=Es,P=Ka,Es=null,xc(s,o,p),Es=w,Ka=P,Es!==null)if(Ka)try{(Es.nodeType===9?Es.body:Es.nodeName==="HTML"?Es.ownerDocument.body:Es).removeChild(p.stateNode)}catch(D){Jn(p,o,D)}else try{Es.removeChild(p.stateNode)}catch(D){Jn(p,o,D)}break;case 18:Es!==null&&(Ka?(s=Es,Te(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),$f(s)):Te(Es,p.stateNode));break;case 4:w=Es,P=Ka,Es=p.stateNode.containerInfo,Ka=!0,xc(s,o,p),Es=w,Ka=P;break;case 0:case 11:case 14:case 15:Fo(2,p,o),lr||Fo(4,p,o),xc(s,o,p);break;case 1:lr||(Zl(p,o),w=p.stateNode,typeof w.componentWillUnmount=="function"&&Eg(p,o,w)),xc(s,o,p);break;case 21:xc(s,o,p);break;case 22:lr=(w=lr)||p.memoizedState!==null,xc(s,o,p),lr=w;break;default:xc(s,o,p)}}function Zs(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{$f(s)}catch(p){Jn(o,o.return,p)}}}function Gp(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{$f(s)}catch(p){Jn(o,o.return,p)}}function jg(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Ag),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Ag),o;default:throw Error(l(435,s.tag))}}function _d(s,o){var p=jg(s);o.forEach(function(w){if(!p.has(w)){p.add(w);var P=k_.bind(null,s,w);w.then(P,P)}})}function en(s,o){var p=o.deletions;if(p!==null)for(var w=0;w<p.length;w++){var P=p[w],D=s,Y=o,pe=Y;e:for(;pe!==null;){switch(pe.tag){case 27:if(de(pe.type)){Es=pe.stateNode,Ka=!1;break e}break;case 5:Es=pe.stateNode,Ka=!1;break e;case 3:case 4:Es=pe.stateNode.containerInfo,Ka=!0;break e}pe=pe.return}if(Es===null)throw Error(l(160));bh(D,Y,P),Es=null,Ka=!1,D=P.alternate,D!==null&&(D.return=null),P.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Wp(o,s),o=o.sibling}var xo=null;function Wp(s,o){var p=s.alternate,w=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:en(o,s),Ma(s),w&4&&(Fo(3,s,s.return),pd(3,s),Fo(5,s,s.return));break;case 1:en(o,s),Ma(s),w&512&&(lr||p===null||Zl(p,p.return)),w&64&&Gl&&(s=s.updateQueue,s!==null&&(w=s.callbacks,w!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?w:p.concat(w))));break;case 26:var P=xo;if(en(o,s),Ma(s),w&512&&(lr||p===null||Zl(p,p.return)),w&4){var D=p!==null?p.memoizedState:null;if(w=s.memoizedState,p===null)if(w===null)if(s.stateNode===null){e:{w=s.type,p=s.memoizedProps,P=P.ownerDocument||P;t:switch(w){case"title":D=P.getElementsByTagName("title")[0],(!D||D[fi]||D[Ct]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=P.createElement(w),P.head.insertBefore(D,P.querySelector("head > title"))),kr(D,w,p),D[Ct]=s,mn(D),w=D;break e;case"link":var Y=kl("link","href",P).get(w+(p.href||""));if(Y){for(var pe=0;pe<Y.length;pe++)if(D=Y[pe],D.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&D.getAttribute("rel")===(p.rel==null?null:p.rel)&&D.getAttribute("title")===(p.title==null?null:p.title)&&D.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){Y.splice(pe,1);break t}}D=P.createElement(w),kr(D,w,p),P.head.appendChild(D);break;case"meta":if(Y=kl("meta","content",P).get(w+(p.content||""))){for(pe=0;pe<Y.length;pe++)if(D=Y[pe],D.getAttribute("content")===(p.content==null?null:""+p.content)&&D.getAttribute("name")===(p.name==null?null:p.name)&&D.getAttribute("property")===(p.property==null?null:p.property)&&D.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&D.getAttribute("charset")===(p.charSet==null?null:p.charSet)){Y.splice(pe,1);break t}}D=P.createElement(w),kr(D,w,p),P.head.appendChild(D);break;default:throw Error(l(468,w))}D[Ct]=s,mn(D),w=D}s.stateNode=w}else To(P,s.type,s.stateNode);else s.stateNode=cs(P,w,s.memoizedProps);else D!==w?(D===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):D.count--,w===null?To(P,s.type,s.stateNode):cs(P,w,s.memoizedProps)):w===null&&s.stateNode!==null&&Hp(s,s.memoizedProps,p.memoizedProps)}break;case 27:en(o,s),Ma(s),w&512&&(lr||p===null||Zl(p,p.return)),p!==null&&w&4&&Hp(s,s.memoizedProps,p.memoizedProps);break;case 5:if(en(o,s),Ma(s),w&512&&(lr||p===null||Zl(p,p.return)),s.flags&32){P=s.stateNode;try{qr(P,"")}catch(_i){Jn(s,s.return,_i)}}w&4&&s.stateNode!=null&&(P=s.memoizedProps,Hp(s,P,p!==null?p.memoizedProps:P)),w&1024&&(xh=!0);break;case 6:if(en(o,s),Ma(s),w&4){if(s.stateNode===null)throw Error(l(162));w=s.memoizedProps,p=s.stateNode;try{p.nodeValue=w}catch(_i){Jn(s,s.return,_i)}}break;case 3:if(So=null,P=xo,xo=Mi(o.containerInfo),en(o,s),xo=P,Ma(s),w&4&&p!==null&&p.memoizedState.isDehydrated)try{$f(o.containerInfo)}catch(_i){Jn(s,s.return,_i)}xh&&(xh=!1,Wl(s));break;case 4:w=xo,xo=Mi(s.stateNode.containerInfo),en(o,s),Ma(s),xo=w;break;case 12:en(o,s),Ma(s);break;case 31:en(o,s),Ma(s),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,_d(s,w)));break;case 13:en(o,s),Ma(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Ah=sn()),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,_d(s,w)));break;case 22:P=s.memoizedState!==null;var De=p!==null&&p.memoizedState!==null,ft=Gl,St=lr;if(Gl=ft||P,lr=St||De,en(o,s),lr=St,Gl=ft,Ma(s),w&8192)e:for(o=s.stateNode,o._visibility=P?o._visibility&-2:o._visibility|1,P&&(p===null||De||Gl||lr||su(s)),p=null,o=s;;){if(o.tag===5||o.tag===26){if(p===null){De=p=o;try{if(D=De.stateNode,P)Y=D.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{pe=De.stateNode;var Lt=De.memoizedProps.style,pt=Lt!=null&&Lt.hasOwnProperty("display")?Lt.display:null;pe.style.display=pt==null||typeof pt=="boolean"?"":(""+pt).trim()}}catch(_i){Jn(De,De.return,_i)}}}else if(o.tag===6){if(p===null){De=o;try{De.stateNode.nodeValue=P?"":De.memoizedProps}catch(_i){Jn(De,De.return,_i)}}}else if(o.tag===18){if(p===null){De=o;try{var yt=De.stateNode;P?Ae(yt,!0):Ae(De.stateNode,!1)}catch(_i){Jn(De,De.return,_i)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;p===o&&(p=null),o=o.return}p===o&&(p=null),o.sibling.return=o.return,o=o.sibling}w&4&&(w=s.updateQueue,w!==null&&(p=w.retryQueue,p!==null&&(w.retryQueue=null,_d(s,p))));break;case 19:en(o,s),Ma(s),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,_d(s,w)));break;case 30:break;case 21:break;default:en(o,s),Ma(s)}}function Ma(s){var o=s.flags;if(o&2){try{for(var p,w=s.return;w!==null;){if(Cg(w)){p=w;break}w=w.return}if(p==null)throw Error(l(160));switch(p.tag){case 27:var P=p.stateNode,D=bf(s);yd(s,D,P);break;case 5:var Y=p.stateNode;p.flags&32&&(qr(Y,""),p.flags&=-33);var pe=bf(s);yd(s,pe,Y);break;case 3:case 4:var De=p.stateNode.containerInfo,ft=bf(s);gd(s,ft,De);break;default:throw Error(l(161))}}catch(St){Jn(s,s.return,St)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Wl(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;Wl(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Ja(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Mg(s,o.alternate,o),o=o.sibling}function su(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Fo(4,o,o.return),su(o);break;case 1:Zl(o,o.return);var p=o.stateNode;typeof p.componentWillUnmount=="function"&&Eg(o,o.return,p),su(o);break;case 27:vt(o.stateNode);case 26:case 5:Zl(o,o.return),su(o);break;case 22:o.memoizedState===null&&su(o);break;case 30:su(o);break;default:su(o)}s=s.sibling}}function bc(s,o,p){for(p=p&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var w=o.alternate,P=s,D=o,Y=D.flags;switch(D.tag){case 0:case 11:case 15:bc(P,D,p),pd(4,D);break;case 1:if(bc(P,D,p),w=D,P=w.stateNode,typeof P.componentDidMount=="function")try{P.componentDidMount()}catch(ft){Jn(w,w.return,ft)}if(w=D,P=w.updateQueue,P!==null){var pe=w.stateNode;try{var De=P.shared.hiddenCallbacks;if(De!==null)for(P.shared.hiddenCallbacks=null,P=0;P<De.length;P++)Hi(De[P],pe)}catch(ft){Jn(w,w.return,ft)}}p&&Y&64&&qp(D),md(D,D.return);break;case 27:Zp(D);case 26:case 5:bc(P,D,p),p&&w===null&&Y&4&&kg(D),md(D,D.return);break;case 12:bc(P,D,p);break;case 31:bc(P,D,p),p&&Y&4&&Zs(P,D);break;case 13:bc(P,D,p),p&&Y&4&&Gp(P,D);break;case 22:D.memoizedState===null&&bc(P,D,p),md(D,D.return);break;case 30:break;default:bc(P,D,p)}o=o.sibling}}function Yp(s,o){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&xl(p))}function Xp(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&xl(s))}function Tl(s,o,p,w){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Ig(s,o,p,w),o=o.sibling}function Ig(s,o,p,w){var P=o.flags;switch(o.tag){case 0:case 11:case 15:Tl(s,o,p,w),P&2048&&pd(9,o);break;case 1:Tl(s,o,p,w);break;case 3:Tl(s,o,p,w),P&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&xl(s)));break;case 12:if(P&2048){Tl(s,o,p,w),s=o.stateNode;try{var D=o.memoizedProps,Y=D.id,pe=D.onPostCommit;typeof pe=="function"&&pe(Y,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(De){Jn(o,o.return,De)}}else Tl(s,o,p,w);break;case 31:Tl(s,o,p,w);break;case 13:Tl(s,o,p,w);break;case 23:break;case 22:D=o.stateNode,Y=o.alternate,o.memoizedState!==null?D._visibility&2?Tl(s,o,p,w):vd(s,o):D._visibility&2?Tl(s,o,p,w):(D._visibility|=2,wh(s,o,p,w,(o.subtreeFlags&10256)!==0||!1)),P&2048&&Yp(Y,o);break;case 24:Tl(s,o,p,w),P&2048&&Xp(o.alternate,o);break;default:Tl(s,o,p,w)}}function wh(s,o,p,w,P){for(P=P&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var D=s,Y=o,pe=p,De=w,ft=Y.flags;switch(Y.tag){case 0:case 11:case 15:wh(D,Y,pe,De,P),pd(8,Y);break;case 23:break;case 22:var St=Y.stateNode;Y.memoizedState!==null?St._visibility&2?wh(D,Y,pe,De,P):vd(D,Y):(St._visibility|=2,wh(D,Y,pe,De,P)),P&&ft&2048&&Yp(Y.alternate,Y);break;case 24:wh(D,Y,pe,De,P),P&&ft&2048&&Xp(Y.alternate,Y);break;default:wh(D,Y,pe,De,P)}o=o.sibling}}function vd(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var p=s,w=o,P=w.flags;switch(w.tag){case 22:vd(p,w),P&2048&&Yp(w.alternate,w);break;case 24:vd(p,w),P&2048&&Xp(w.alternate,w);break;default:vd(p,w)}o=o.sibling}}var xd=8192;function Sh(s,o,p){if(s.subtreeFlags&xd)for(s=s.child;s!==null;)bd(s,o,p),s=s.sibling}function bd(s,o,p){switch(s.tag){case 26:Sh(s,o,p),s.flags&xd&&s.memoizedState!==null&&Sc(p,xo,s.memoizedState,s.memoizedProps);break;case 5:Sh(s,o,p);break;case 3:case 4:var w=xo;xo=Mi(s.stateNode.containerInfo),Sh(s,o,p),xo=w;break;case 22:s.memoizedState===null&&(w=s.alternate,w!==null&&w.memoizedState!==null?(w=xd,xd=16777216,Sh(s,o,p),xd=w):Sh(s,o,p));break;default:Sh(s,o,p)}}function Ou(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function Th(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var w=o[p];Er=w,Lg(w,s)}Ou(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)wf(s),s=s.sibling}function wf(s){switch(s.tag){case 0:case 11:case 15:Th(s),s.flags&2048&&Fo(9,s,s.return);break;case 3:Th(s);break;case 12:Th(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Eh(s)):Th(s);break;default:Th(s)}}function Eh(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var w=o[p];Er=w,Lg(w,s)}Ou(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Fo(8,o,o.return),Eh(o);break;case 22:p=o.stateNode,p._visibility&2&&(p._visibility&=-3,Eh(o));break;default:Eh(o)}s=s.sibling}}function Lg(s,o){for(;Er!==null;){var p=Er;switch(p.tag){case 0:case 11:case 15:Fo(8,p,o);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var w=p.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:xl(p.memoizedState.cache)}if(w=p.child,w!==null)w.return=p,Er=w;else e:for(p=s;Er!==null;){w=Er;var P=w.sibling,D=w.return;if(Pg(w),w===p){Er=null;break e}if(P!==null){P.return=D,Er=P;break e}Er=D}}}var S_={getCacheForType:function(s){var o=Ji(ys),p=o.data.get(s);return p===void 0&&(p=s(),o.data.set(s,p)),p},cacheSignal:function(){return Ji(ys).controller.signal}},T_=typeof WeakMap=="function"?WeakMap:Map,Vn=0,hs=null,Di=null,Sn=0,Kn=0,cr=null,Vo=!1,Yl=!1,ru=!1,qo=0,ks=0,au=0,Nu=0,Sf=0,Qa=0,kh=0,Ch=null,Pa=null,wd=!1,Ah=0,zg=0,Tf=1/0,Sd=null,wc=null,Bs=0,Qr=null,bo=null,Xl=0,Td=0,Kp=null,Rg=null,ou=0,Ed=null;function wo(){return(Vn&2)!==0&&Sn!==0?Sn&-Sn:Be.T!==null?zh():Qt()}function Ef(){if(Qa===0)if((Sn&536870912)===0||It){var s=Zn;Zn<<=1,(Zn&3932160)===0&&(Zn=262144),Qa=s}else Qa=536870912;return s=rs.current,s!==null&&(s.flags|=32),Qa}function pa(s,o,p){(s===hs&&(Kn===2||Kn===9)||s.cancelPendingCommit!==null)&&($u(s,0),Kl(s,Sn,Qa,!1)),ze(s,p),((Vn&2)===0||s!==hs)&&(s===hs&&((Vn&2)===0&&(Nu|=p),ks===4&&Kl(s,Sn,Qa,!1)),Jl(s))}function Bu(s,o,p){if((Vn&6)!==0)throw Error(l(327));var w=!p&&(o&127)===0&&(o&s.expiredLanes)===0||G(s,o),P=w?tm(s,o):em(s,o,!0),D=w;do{if(P===0){Yl&&!w&&Kl(s,o,0,!1);break}else{if(p=s.current.alternate,D&&!Dg(p)){P=em(s,o,!1),D=!1;continue}if(P===2){if(D=o,s.errorRecoveryDisabledLanes&D)var Y=0;else Y=s.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){o=Y;e:{var pe=s;P=Ch;var De=pe.current.memoizedState.isDehydrated;if(De&&($u(pe,Y).flags|=256),Y=em(pe,Y,!1),Y!==2){if(ru&&!De){pe.errorRecoveryDisabledLanes|=D,Nu|=D,P=4;break e}D=Pa,Pa=P,D!==null&&(Pa===null?Pa=D:Pa.push.apply(Pa,D))}P=Y}if(D=!1,P!==2)continue}}if(P===1){$u(s,0),Kl(s,o,0,!0);break}e:{switch(w=s,D=P,D){case 0:case 1:throw Error(l(345));case 4:if((o&4194048)!==o)break;case 6:Kl(w,o,Qa,!Vo);break e;case 2:Pa=null;break;case 3:case 5:break;default:throw Error(l(329))}if((o&62914560)===o&&(P=Ah+300-sn(),10<P)){if(Kl(w,o,Qa,!Vo),te(w,0,!0)!==0)break e;Xl=o,w.timeoutHandle=q(Jp.bind(null,w,p,Pa,Sd,wd,o,Qa,Nu,kh,Vo,D,"Throttled",-0,0),P);break e}Jp(w,p,Pa,Sd,wd,o,Qa,Nu,kh,Vo,D,null,-0,0)}}break}while(!0);Jl(s)}function Jp(s,o,p,w,P,D,Y,pe,De,ft,St,Lt,pt,yt){if(s.timeoutHandle=-1,Lt=o.subtreeFlags,Lt&8192||(Lt&16785408)===16785408){Lt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Us},bd(o,D,Lt);var _i=(D&62914560)===D?Ah-sn():(D&4194048)===D?zg-sn():0;if(_i=Gg(Lt,_i),_i!==null){Xl=D,s.cancelPendingCommit=_i(Cf.bind(null,s,o,D,p,w,P,Y,pe,De,St,Lt,null,pt,yt)),Kl(s,D,Y,!ft);return}}Cf(s,o,D,p,w,P,Y,pe,De)}function Dg(s){for(var o=s;;){var p=o.tag;if((p===0||p===11||p===15)&&o.flags&16384&&(p=o.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var w=0;w<p.length;w++){var P=p[w],D=P.getSnapshot;P=P.value;try{if(!qs(D(),P))return!1}catch{return!1}}if(p=o.child,o.subtreeFlags&16384&&p!==null)p.return=o,o=p;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Kl(s,o,p,w){o&=~Sf,o&=~Nu,s.suspendedLanes|=o,s.pingedLanes&=~o,w&&(s.warmLanes|=o),w=s.expirationTimes;for(var P=o;0<P;){var D=31-Wi(P),Y=1<<D;w[D]=-1,P&=~Y}p!==0&&he(s,p,o)}function kd(){return(Vn&6)===0?(Ih(0),!1):!0}function Mh(){if(Di!==null){if(Kn===0)var s=Di.return;else s=Di,Ha=Kr=null,Wc(s),Ie=null,Re=0,s=Di;for(;s!==null;)Tg(s.alternate,s),s=s.return;Di=null}}function $u(s,o){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,W(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Xl=0,Mh(),hs=s,Di=p=Wr(s.current,null),Sn=o,Kn=0,cr=null,Vo=!1,Yl=G(s,o),ru=!1,kh=Qa=Sf=Nu=au=ks=0,Pa=Ch=null,wd=!1,(o&8)!==0&&(o|=o&32);var w=s.entangledLanes;if(w!==0)for(s=s.entanglements,w&=o;0<w;){var P=31-Wi(w),D=1<<P;o|=s[P],w&=~D}return qo=o,wr(),p}function Og(s,o){ji=null,Be.H=cd,o===O||o===H?(o=Ee(),Kn=3):o===U?(o=Ee(),Kn=4):Kn=o===Ss?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,cr=o,Di===null&&(ks=1,gf(s,b(o,s.current)))}function Ng(){var s=rs.current;return s===null?!0:(Sn&4194048)===Sn?as===null:(Sn&62914560)===Sn||(Sn&536870912)!==0?s===as:!1}function Qp(){var s=Be.H;return Be.H=cd,s===null?cd:s}function Bg(){var s=Be.A;return Be.A=S_,s}function kf(){ks=4,Vo||(Sn&4194048)!==Sn&&rs.current!==null||(Yl=!0),(au&134217727)===0&&(Nu&134217727)===0||hs===null||Kl(hs,Sn,Qa,!1)}function em(s,o,p){var w=Vn;Vn|=2;var P=Qp(),D=Bg();(hs!==s||Sn!==o)&&(Sd=null,$u(s,o)),o=!1;var Y=ks;e:do try{if(Kn!==0&&Di!==null){var pe=Di,De=cr;switch(Kn){case 8:Mh(),Y=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(o=!0);var ft=Kn;if(Kn=0,cr=null,Uu(s,pe,De,ft),p&&Yl){Y=0;break e}break;default:ft=Kn,Kn=0,cr=null,Uu(s,pe,De,ft)}}E_(),Y=ks;break}catch(St){Og(s,St)}while(!0);return o&&s.shellSuspendCounter++,Ha=Kr=null,Vn=w,Be.H=P,Be.A=D,Di===null&&(hs=null,Sn=0,wr()),Y}function E_(){for(;Di!==null;)im(Di)}function tm(s,o){var p=Vn;Vn|=2;var w=Qp(),P=Bg();hs!==s||Sn!==o?(Sd=null,Tf=sn()+500,$u(s,o)):Yl=G(s,o);e:do try{if(Kn!==0&&Di!==null){o=Di;var D=cr;t:switch(Kn){case 1:Kn=0,cr=null,Uu(s,o,D,1);break;case 2:case 9:if(K(D)){Kn=0,cr=null,nm(o);break}o=function(){Kn!==2&&Kn!==9||hs!==s||(Kn=7),Jl(s)},D.then(o,o);break e;case 3:Kn=7;break e;case 4:Kn=5;break e;case 7:K(D)?(Kn=0,cr=null,nm(o)):(Kn=0,cr=null,Uu(s,o,D,7));break;case 5:var Y=null;switch(Di.tag){case 26:Y=Di.memoizedState;case 5:case 27:var pe=Di;if(Y?pr(Y):pe.stateNode.complete){Kn=0,cr=null;var De=pe.sibling;if(De!==null)Di=De;else{var ft=pe.return;ft!==null?(Di=ft,Cd(ft)):Di=null}break t}}Kn=0,cr=null,Uu(s,o,D,5);break;case 6:Kn=0,cr=null,Uu(s,o,D,6);break;case 8:Mh(),ks=6;break e;default:throw Error(l(462))}}lu();break}catch(St){Og(s,St)}while(!0);return Ha=Kr=null,Be.H=w,Be.A=P,Vn=p,Di!==null?0:(hs=null,Sn=0,wr(),ks)}function lu(){for(;Di!==null&&!Rn();)im(Di)}function im(s){var o=wg(s.alternate,s,qo);s.memoizedProps=s.pendingProps,o===null?Cd(s):Di=o}function nm(s){var o=s,p=o.alternate;switch(o.tag){case 15:case 0:o=Op(p,o,o.pendingProps,o.type,void 0,Sn);break;case 11:o=Op(p,o,o.pendingProps,o.type.render,o.ref,Sn);break;case 5:Wc(o);default:Tg(p,o),o=Di=oc(o,qo),o=wg(p,o,qo)}s.memoizedProps=s.pendingProps,o===null?Cd(s):Di=o}function Uu(s,o,p,w){Ha=Kr=null,Wc(o),Ie=null,Re=0;var P=o.return;try{if(v_(s,P,o,p,Sn)){ks=1,gf(s,b(p,s.current)),Di=null;return}}catch(D){if(P!==null)throw Di=P,D;ks=1,gf(s,b(p,s.current)),Di=null;return}o.flags&32768?(It||w===1?s=!0:Yl||(Sn&536870912)!==0?s=!1:(Vo=s=!0,(w===2||w===9||w===3||w===6)&&(w=rs.current,w!==null&&w.tag===13&&(w.flags|=16384))),sm(o,s)):Cd(o)}function Cd(s){var o=s;do{if((o.flags&32768)!==0){sm(o,Vo);return}s=o.return;var p=b_(o.alternate,o,qo);if(p!==null){Di=p;return}if(o=o.sibling,o!==null){Di=o;return}Di=o=s}while(o!==null);ks===0&&(ks=5)}function sm(s,o){do{var p=Sg(s.alternate,s);if(p!==null){p.flags&=32767,Di=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!o&&(s=s.sibling,s!==null)){Di=s;return}Di=s=p}while(s!==null);ks=6,Di=null}function Cf(s,o,p,w,P,D,Y,pe,De){s.cancelPendingCommit=null;do ma();while(Bs!==0);if((Vn&6)!==0)throw Error(l(327));if(o!==null){if(o===s.current)throw Error(l(177));if(D=o.lanes|o.childLanes,D|=ss,Ve(s,p,D,Y,pe,De),s===hs&&(Di=hs=null,Sn=0),bo=o,Qr=s,Xl=p,Td=D,Kp=P,Rg=w,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Fg(kt,function(){return jh(),null})):(s.callbackNode=null,s.callbackPriority=0),w=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||w){w=Be.T,Be.T=null,P=ct.p,ct.p=2,Y=Vn,Vn|=4;try{w_(s,o,p)}finally{Vn=Y,ct.p=P,Be.T=w}}Bs=1,Ph(),rm(),Af()}}function Ph(){if(Bs===1){Bs=0;var s=Qr,o=bo,p=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||p){p=Be.T,Be.T=null;var w=ct.p;ct.p=2;var P=Vn;Vn|=4;try{Wp(o,s);var D=m,Y=Va(s.containerInfo),pe=D.focusedElem,De=D.selectionRange;if(Y!==pe&&pe&&pe.ownerDocument&&sc(pe.ownerDocument.documentElement,pe)){if(De!==null&&fo(pe)){var ft=De.start,St=De.end;if(St===void 0&&(St=ft),"selectionStart"in pe)pe.selectionStart=ft,pe.selectionEnd=Math.min(St,pe.value.length);else{var Lt=pe.ownerDocument||document,pt=Lt&&Lt.defaultView||window;if(pt.getSelection){var yt=pt.getSelection(),_i=pe.textContent.length,Ni=Math.min(De.start,_i),_s=De.end===void 0?Ni:Math.min(De.end,_i);!yt.extend&&Ni>_s&&(Y=_s,_s=Ni,Ni=Y);var Qe=nc(pe,Ni),qe=nc(pe,_s);if(Qe&&qe&&(yt.rangeCount!==1||yt.anchorNode!==Qe.node||yt.anchorOffset!==Qe.offset||yt.focusNode!==qe.node||yt.focusOffset!==qe.offset)){var ht=Lt.createRange();ht.setStart(Qe.node,Qe.offset),yt.removeAllRanges(),Ni>_s?(yt.addRange(ht),yt.extend(qe.node,qe.offset)):(ht.setEnd(qe.node,qe.offset),yt.addRange(ht))}}}}for(Lt=[],yt=pe;yt=yt.parentNode;)yt.nodeType===1&&Lt.push({element:yt,left:yt.scrollLeft,top:yt.scrollTop});for(typeof pe.focus=="function"&&pe.focus(),pe=0;pe<Lt.length;pe++){var At=Lt[pe];At.element.scrollLeft=At.left,At.element.scrollTop=At.top}}Df=!!c,m=c=null}finally{Vn=P,ct.p=w,Be.T=p}}s.current=o,Bs=2}}function rm(){if(Bs===2){Bs=0;var s=Qr,o=bo,p=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||p){p=Be.T,Be.T=null;var w=ct.p;ct.p=2;var P=Vn;Vn|=4;try{Mg(s,o.alternate,o)}finally{Vn=P,ct.p=w,Be.T=p}}Bs=3}}function Af(){if(Bs===4||Bs===3){Bs=0,is();var s=Qr,o=bo,p=Xl,w=Rg;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Bs=5:(Bs=0,bo=Qr=null,am(s,s.pendingLanes));var P=s.pendingLanes;if(P===0&&(wc=null),st(p),o=o.stateNode,ii&&typeof ii.onCommitFiberRoot=="function")try{ii.onCommitFiberRoot(jt,o,void 0,(o.current.flags&128)===128)}catch{}if(w!==null){o=Be.T,P=ct.p,ct.p=2,Be.T=null;try{for(var D=s.onRecoverableError,Y=0;Y<w.length;Y++){var pe=w[Y];D(pe.value,{componentStack:pe.stack})}}finally{Be.T=o,ct.p=P}}(Xl&3)!==0&&ma(),Jl(s),P=s.pendingLanes,(p&261930)!==0&&(P&42)!==0?s===Ed?ou++:(ou=0,Ed=s):ou=0,Ih(0)}}function am(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,xl(o)))}function ma(){return Ph(),rm(),Af(),jh()}function jh(){if(Bs!==5)return!1;var s=Qr,o=Td;Td=0;var p=st(Xl),w=Be.T,P=ct.p;try{ct.p=32>p?32:p,Be.T=null,p=Kp,Kp=null;var D=Qr,Y=Xl;if(Bs=0,bo=Qr=null,Xl=0,(Vn&6)!==0)throw Error(l(331));var pe=Vn;if(Vn|=4,wf(D.current),Ig(D,D.current,Y,p),Vn=pe,Ih(0,!1),ii&&typeof ii.onPostCommitFiberRoot=="function")try{ii.onPostCommitFiberRoot(jt,D)}catch{}return!0}finally{ct.p=P,Be.T=w,am(s,o)}}function om(s,o,p){o=b(p,o),o=ud(s.stateNode,o,2),s=ai(s,o,2),s!==null&&(ze(s,2),Jl(s))}function Jn(s,o,p){if(s.tag===3)om(s,s,p);else for(;o!==null;){if(o.tag===3){om(o,s,p);break}else if(o.tag===1){var w=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(wc===null||!wc.has(w))){s=b(p,s),p=yg(2),w=ai(o,p,2),w!==null&&(Ru(p,w,o,s),ze(w,2),Jl(w));break}}o=o.return}}function Mf(s,o,p){var w=s.pingCache;if(w===null){w=s.pingCache=new T_;var P=new Set;w.set(o,P)}else P=w.get(o),P===void 0&&(P=new Set,w.set(o,P));P.has(p)||(ru=!0,P.add(p),s=$g.bind(null,s,o,p),o.then(s,s))}function $g(s,o,p){var w=s.pingCache;w!==null&&w.delete(o),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,hs===s&&(Sn&p)===p&&(ks===4||ks===3&&(Sn&62914560)===Sn&&300>sn()-Ah?(Vn&2)===0&&$u(s,0):Sf|=p,kh===Sn&&(kh=0)),Jl(s)}function lm(s,o){o===0&&(o=ve()),s=da(s,o),s!==null&&(ze(s,o),Jl(s))}function Ug(s){var o=s.memoizedState,p=0;o!==null&&(p=o.retryLane),lm(s,p)}function k_(s,o){var p=0;switch(s.tag){case 31:case 13:var w=s.stateNode,P=s.memoizedState;P!==null&&(p=P.retryLane);break;case 19:w=s.stateNode;break;case 22:w=s.stateNode._retryCache;break;default:throw Error(l(314))}w!==null&&w.delete(o),lm(s,p)}function Fg(s,o){return mi(s,o)}var El=null,Fu=null,Pf=!1,Ad=!1,jf=!1,cu=0;function Jl(s){s!==Fu&&s.next===null&&(Fu===null?El=Fu=s:Fu=Fu.next=s),Ad=!0,Pf||(Pf=!0,If())}function Ih(s,o){if(!jf&&Ad){jf=!0;do for(var p=!1,w=El;w!==null;){if(s!==0){var P=w.pendingLanes;if(P===0)var D=0;else{var Y=w.suspendedLanes,pe=w.pingedLanes;D=(1<<31-Wi(42|s)+1)-1,D&=P&~(Y&~pe),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(p=!0,Pd(w,D))}else D=Sn,D=te(w,w===hs?D:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(D&3)===0||G(w,D)||(p=!0,Pd(w,D));w=w.next}while(p);jf=!1}}function Lh(){cm()}function cm(){Ad=Pf=!1;var s=0;cu!==0&&F()&&(s=cu);for(var o=sn(),p=null,w=El;w!==null;){var P=w.next,D=Md(w,o);D===0?(w.next=null,p===null?El=P:p.next=P,P===null&&(Fu=p)):(p=w,(s!==0||(D&3)!==0)&&(Ad=!0)),w=P}Bs!==0&&Bs!==5||Ih(s),cu!==0&&(cu=0)}function Md(s,o){for(var p=s.suspendedLanes,w=s.pingedLanes,P=s.expirationTimes,D=s.pendingLanes&-62914561;0<D;){var Y=31-Wi(D),pe=1<<Y,De=P[Y];De===-1?((pe&p)===0||(pe&w)!==0)&&(P[Y]=oe(pe,o)):De<=o&&(s.expiredLanes|=pe),D&=~pe}if(o=hs,p=Sn,p=te(s,s===o?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),w=s.callbackNode,p===0||s===o&&(Kn===2||Kn===9)||s.cancelPendingCommit!==null)return w!==null&&w!==null&&En(w),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||G(s,p)){if(o=p&-p,o===s.callbackPriority)return o;switch(w!==null&&En(w),st(p)){case 2:case 8:p=ns;break;case 32:p=kt;break;case 268435456:p=yn;break;default:p=kt}return w=um.bind(null,s),p=mi(p,w),s.callbackPriority=o,s.callbackNode=p,o}return w!==null&&w!==null&&En(w),s.callbackPriority=2,s.callbackNode=null,2}function um(s,o){if(Bs!==0&&Bs!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(ma()&&s.callbackNode!==p)return null;var w=Sn;return w=te(s,s===hs?w:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),w===0?null:(Bu(s,w,o),Md(s,sn()),s.callbackNode!=null&&s.callbackNode===p?um.bind(null,s):null)}function Pd(s,o){if(ma())return null;Bu(s,o,!0)}function If(){se(function(){(Vn&6)!==0?mi(Gi,Lh):cm()})}function zh(){if(cu===0){var s=bl;s===0&&(s=Pn,Pn<<=1,(Pn&261888)===0&&(Pn=256)),cu=s}return cu}function Vg(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:zl(""+s)}function qg(s,o){var p=o.ownerDocument.createElement("input");return p.name=o.name,p.value=o.value,s.id&&p.setAttribute("form",s.id),o.parentNode.insertBefore(p,o),s=new FormData(s),p.parentNode.removeChild(p),s}function C_(s,o,p,w,P){if(o==="submit"&&p&&p.stateNode===P){var D=Vg((P[ni]||null).action),Y=w.submitter;Y&&(o=(o=Y[ni]||null)?Vg(o.formAction):Y.getAttribute("formAction"),o!==null&&(D=o,Y=null));var pe=new Dc("action","action",null,w,P);s.push({event:pe,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(cu!==0){var De=Y?qg(P,Y):new FormData(P);df(p,{pending:!0,data:De,method:P.method,action:D},null,De)}}else typeof D=="function"&&(pe.preventDefault(),De=Y?qg(P,Y):new FormData(P),df(p,{pending:!0,data:De,method:P.method,action:D},D,De))},currentTarget:P}]})}}for(var uu=0;uu<ha.length;uu++){var ur=ha[uu],hu=ur.toLowerCase(),hm=ur[0].toUpperCase()+ur.slice(1);Wn(hu,"on"+hm)}Wn(Do,"onAnimationEnd"),Wn(ac,"onAnimationIteration"),Wn(fl,"onAnimationStart"),Wn("dblclick","onDoubleClick"),Wn("focusin","onFocus"),Wn("focusout","onBlur"),Wn(Jh,"onTransitionRun"),Wn(Eu,"onTransitionStart"),Wn(qc,"onTransitionCancel"),Wn(Oo,"onTransitionEnd"),Co("onMouseEnter",["mouseout","mouseover"]),Co("onMouseLeave",["mouseout","mouseover"]),Co("onPointerEnter",["pointerout","pointerover"]),Co("onPointerLeave",["pointerout","pointerover"]),Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rh));function Lf(s,o){o=(o&4)!==0;for(var p=0;p<s.length;p++){var w=s[p],P=w.event;w=w.listeners;e:{var D=void 0;if(o)for(var Y=w.length-1;0<=Y;Y--){var pe=w[Y],De=pe.instance,ft=pe.currentTarget;if(pe=pe.listener,De!==D&&P.isPropagationStopped())break e;D=pe,P.currentTarget=ft;try{D(P)}catch(St){Ca(St)}P.currentTarget=null,D=De}else for(Y=0;Y<w.length;Y++){if(pe=w[Y],De=pe.instance,ft=pe.currentTarget,pe=pe.listener,De!==D&&P.isPropagationStopped())break e;D=pe,P.currentTarget=ft;try{D(P)}catch(St){Ca(St)}P.currentTarget=null,D=De}}}}function kn(s,o){var p=o[Ri];p===void 0&&(p=o[Ri]=new Set);var w=s+"__bubble";p.has(w)||(fm(o,s,2,!1),p.add(w))}function zf(s,o,p){var w=0;o&&(w|=4),fm(p,s,w,o)}var jd="_reactListening"+Math.random().toString(36).slice(2);function dm(s){if(!s[jd]){s[jd]=!0,_r.forEach(function(p){p!=="selectionchange"&&(Hg.has(p)||zf(p,!1,s),zf(p,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[jd]||(o[jd]=!0,zf("selectionchange",!1,o))}}function fm(s,o,p,w){switch(Nr(o)){case 2:var P=Cl;break;case 8:P=Of;break;default:P=Nf}p=P.bind(null,o,p,s),P=void 0,!Rl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(P=!0),w?P!==void 0?s.addEventListener(o,p,{capture:!0,passive:P}):s.addEventListener(o,p,!0):P!==void 0?s.addEventListener(o,p,{passive:P}):s.addEventListener(o,p,!1)}function Id(s,o,p,w,P){var D=w;if((o&1)===0&&(o&2)===0&&w!==null)e:for(;;){if(w===null)return;var Y=w.tag;if(Y===3||Y===4){var pe=w.stateNode.containerInfo;if(pe===P)break;if(Y===4)for(Y=w.return;Y!==null;){var De=Y.tag;if((De===3||De===4)&&Y.stateNode.containerInfo===P)return;Y=Y.return}for(;pe!==null;){if(Y=zt(pe),Y===null)return;if(De=Y.tag,De===5||De===6||De===26||De===27){w=D=Y;continue e}pe=pe.parentNode}}w=w.return}zc(function(){var ft=D,St=Fs(p),Lt=[];e:{var pt=Ul.get(s);if(pt!==void 0){var yt=Dc,_i=s;switch(s){case"keypress":if(Qo(p)===0)break e;case"keydown":case"keyup":yt=rh;break;case"focusin":_i="focus",yt=Oc;break;case"focusout":_i="blur",yt=Oc;break;case"beforeblur":case"afterblur":yt=Oc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=el;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=eh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=ah;break;case Do:case ac:case fl:yt=Nc;break;case Oo:yt=Su;break;case"scroll":case"scrollend":yt=Ki;break;case"wheel":yt=xr;break;case"copy":case"cut":case"paste":yt=Sa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=wu;break;case"toggle":case"beforetoggle":yt=nl}var Ni=(o&4)!==0,_s=!Ni&&(s==="scroll"||s==="scrollend"),Qe=Ni?pt!==null?pt+"Capture":null:pt;Ni=[];for(var qe=ft,ht;qe!==null;){var At=qe;if(ht=At.stateNode,At=At.tag,At!==5&&At!==26&&At!==27||ht===null||Qe===null||(At=sa(qe,Qe),At!=null&&Ni.push(Vu(qe,At,ht))),_s)break;qe=qe.return}0<Ni.length&&(pt=new yt(pt,_i,null,p,St),Lt.push({event:pt,listeners:Ni}))}}if((o&7)===0){e:{if(pt=s==="mouseover"||s==="pointerover",yt=s==="mouseout"||s==="pointerout",pt&&p!==Po&&(_i=p.relatedTarget||p.fromElement)&&(zt(_i)||_i[yi]))break e;if((yt||pt)&&(pt=St.window===St?St:(pt=St.ownerDocument)?pt.defaultView||pt.parentWindow:window,yt?(_i=p.relatedTarget||p.toElement,yt=ft,_i=_i?zt(_i):null,_i!==null&&(_s=_(_i),Ni=_i.tag,_i!==_s||Ni!==5&&Ni!==27&&Ni!==6)&&(_i=null)):(yt=null,_i=ft),yt!==_i)){if(Ni=el,At="onMouseLeave",Qe="onMouseEnter",qe="mouse",(s==="pointerout"||s==="pointerover")&&(Ni=wu,At="onPointerLeave",Qe="onPointerEnter",qe="pointer"),_s=yt==null?pt:Zi(yt),ht=_i==null?pt:Zi(_i),pt=new Ni(At,qe+"leave",yt,p,St),pt.target=_s,pt.relatedTarget=ht,At=null,zt(St)===ft&&(Ni=new Ni(Qe,qe+"enter",_i,p,St),Ni.target=ht,Ni.relatedTarget=_s,At=Ni),_s=At,yt&&_i)t:{for(Ni=zd,Qe=yt,qe=_i,ht=0,At=Qe;At;At=Ni(At))ht++;At=0;for(var Li=qe;Li;Li=Ni(Li))At++;for(;0<ht-At;)Qe=Ni(Qe),ht--;for(;0<At-ht;)qe=Ni(qe),At--;for(;ht--;){if(Qe===qe||qe!==null&&Qe===qe.alternate){Ni=Qe;break t}Qe=Ni(Qe),qe=Ni(qe)}Ni=null}else Ni=null;yt!==null&&Rf(Lt,pt,yt,Ni,!1),_i!==null&&_s!==null&&Rf(Lt,_s,_i,Ni,!0)}}e:{if(pt=ft?Zi(ft):window,yt=pt.nodeName&&pt.nodeName.toLowerCase(),yt==="select"||yt==="input"&&pt.type==="file")var es=ol;else if(Lr(pt))if(Fc)es=Bl;else{es=Vc;var Ei=Hr}else yt=pt.nodeName,!yt||yt.toLowerCase()!=="input"||pt.type!=="checkbox"&&pt.type!=="radio"?ft&&Ll(ft.elementType)&&(es=ol):es=Ea;if(es&&(es=es(s,ft))){Ol(Lt,es,p,St);break e}Ei&&Ei(s,pt,ft),s==="focusout"&&ft&&pt.type==="number"&&ft.memoizedProps.value!=null&&ba(pt,"number",pt.value)}switch(Ei=ft?Zi(ft):window,s){case"focusin":(Lr(Ei)||Ei.contentEditable==="true")&&(po=Ei,rc=ft,Ro=null);break;case"focusout":Ro=rc=po=null;break;case"mousedown":mo=!0;break;case"contextmenu":case"mouseup":case"dragend":mo=!1,hl(Lt,p,St);break;case"selectionchange":if(ul)break;case"keydown":case"keyup":hl(Lt,p,St)}var vn;if(sl)e:{switch(s){case"compositionstart":var zn="onCompositionStart";break e;case"compositionend":zn="onCompositionEnd";break e;case"compositionupdate":zn="onCompositionUpdate";break e}zn=void 0}else ho?oh(s,p)&&(zn="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(zn="onCompositionStart");zn&&(Dl&&p.locale!=="ko"&&(ho||zn!=="onCompositionStart"?zn==="onCompositionEnd"&&ho&&(vn=aa()):(Ba=St,Jo="value"in Ba?Ba.value:Ba.textContent,ho=!0)),Ei=Ld(ft,zn),0<Ei.length&&(zn=new co(zn,s,null,p,St),Lt.push({event:zn,listeners:Ei}),vn?zn.data=vn:(vn=qi(p),vn!==null&&(zn.data=vn)))),(vn=rl?hn(s,p):wn(s,p))&&(zn=Ld(ft,"onBeforeInput"),0<zn.length&&(Ei=new co("onBeforeInput","beforeinput",null,p,St),Lt.push({event:Ei,listeners:zn}),Ei.data=vn)),C_(Lt,s,ft,p,St)}Lf(Lt,o)})}function Vu(s,o,p){return{instance:s,listener:o,currentTarget:p}}function Ld(s,o){for(var p=o+"Capture",w=[];s!==null;){var P=s,D=P.stateNode;if(P=P.tag,P!==5&&P!==26&&P!==27||D===null||(P=sa(s,p),P!=null&&w.unshift(Vu(s,P,D)),P=sa(s,o),P!=null&&w.push(Vu(s,P,D))),s.tag===3)return w;s=s.return}return[]}function zd(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Rf(s,o,p,w,P){for(var D=o._reactName,Y=[];p!==null&&p!==w;){var pe=p,De=pe.alternate,ft=pe.stateNode;if(pe=pe.tag,De!==null&&De===w)break;pe!==5&&pe!==26&&pe!==27||ft===null||(De=ft,P?(ft=sa(p,D),ft!=null&&Y.unshift(Vu(p,ft,De))):P||(ft=sa(p,D),ft!=null&&Y.push(Vu(p,ft,De)))),p=p.return}Y.length!==0&&s.push({event:o,listeners:Y})}var Zg=/\r\n?/g,pm=/\u0000|\uFFFD/g;function Rd(s){return(typeof s=="string"?s:""+s).replace(Zg,`
`).replace(pm,"")}function Dh(s,o){return o=Rd(o),Rd(s)===o}function Qn(s,o,p,w,P,D){switch(p){case"children":typeof w=="string"?o==="body"||o==="textarea"&&w===""||qr(s,w):(typeof w=="number"||typeof w=="bigint")&&o!=="body"&&qr(s,""+w);break;case"className":In(s,"class",w);break;case"tabIndex":In(s,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":In(s,p,w);break;case"style":lo(s,w,D);break;case"data":if(o!=="object"){In(s,"data",w);break}case"src":case"href":if(w===""&&(o!=="a"||p!=="href")){s.removeAttribute(p);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){s.removeAttribute(p);break}w=zl(""+w),s.setAttribute(p,w);break;case"action":case"formAction":if(typeof w=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(p==="formAction"?(o!=="input"&&Qn(s,o,"name",P.name,P,null),Qn(s,o,"formEncType",P.formEncType,P,null),Qn(s,o,"formMethod",P.formMethod,P,null),Qn(s,o,"formTarget",P.formTarget,P,null)):(Qn(s,o,"encType",P.encType,P,null),Qn(s,o,"method",P.method,P,null),Qn(s,o,"target",P.target,P,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){s.removeAttribute(p);break}w=zl(""+w),s.setAttribute(p,w);break;case"onClick":w!=null&&(s.onclick=Us);break;case"onScroll":w!=null&&kn("scroll",s);break;case"onScrollEnd":w!=null&&kn("scrollend",s);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(l(61));if(p=w.__html,p!=null){if(P.children!=null)throw Error(l(60));s.innerHTML=p}}break;case"multiple":s.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":s.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){s.removeAttribute("xlink:href");break}p=zl(""+w),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(p,""+w):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":w===!0?s.setAttribute(p,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(p,w):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?s.setAttribute(p,w):s.removeAttribute(p);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?s.removeAttribute(p):s.setAttribute(p,w);break;case"popover":kn("beforetoggle",s),kn("toggle",s),ki(s,"popover",w);break;case"xlinkActuate":gs(s,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":gs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":gs(s,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":gs(s,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":gs(s,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":gs(s,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":gs(s,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":gs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":gs(s,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":ki(s,"is",w);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Ic.get(p)||p,ki(s,p,w))}}function Dd(s,o,p,w,P,D){switch(p){case"style":lo(s,w,D);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(l(61));if(p=w.__html,p!=null){if(P.children!=null)throw Error(l(60));s.innerHTML=p}}break;case"children":typeof w=="string"?qr(s,w):(typeof w=="number"||typeof w=="bigint")&&qr(s,""+w);break;case"onScroll":w!=null&&kn("scroll",s);break;case"onScrollEnd":w!=null&&kn("scrollend",s);break;case"onClick":w!=null&&(s.onclick=Us);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xs.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(P=p.endsWith("Capture"),o=p.slice(2,P?p.length-7:void 0),D=s[ni]||null,D=D!=null?D[p]:null,typeof D=="function"&&s.removeEventListener(o,D,P),typeof w=="function")){typeof D!="function"&&D!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(o,w,P);break e}p in s?s[p]=w:w===!0?s.setAttribute(p,""):ki(s,p,w)}}}function kr(s,o,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kn("error",s),kn("load",s);var w=!1,P=!1,D;for(D in p)if(p.hasOwnProperty(D)){var Y=p[D];if(Y!=null)switch(D){case"src":w=!0;break;case"srcSet":P=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,o));default:Qn(s,o,D,Y,p,null)}}P&&Qn(s,o,"srcSet",p.srcSet,p,null),w&&Qn(s,o,"src",p.src,p,null);return;case"input":kn("invalid",s);var pe=D=Y=P=null,De=null,ft=null;for(w in p)if(p.hasOwnProperty(w)){var St=p[w];if(St!=null)switch(w){case"name":P=St;break;case"type":Y=St;break;case"checked":De=St;break;case"defaultChecked":ft=St;break;case"value":D=St;break;case"defaultValue":pe=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(l(137,o));break;default:Qn(s,o,w,St,p,null)}}un(s,D,pe,De,ft,Y,P,!1);return;case"select":kn("invalid",s),w=Y=D=null;for(P in p)if(p.hasOwnProperty(P)&&(pe=p[P],pe!=null))switch(P){case"value":D=pe;break;case"defaultValue":Y=pe;break;case"multiple":w=pe;default:Qn(s,o,P,pe,p,null)}o=D,p=Y,s.multiple=!!w,o!=null?Gn(s,!!w,o,!1):p!=null&&Gn(s,!!w,p,!0);return;case"textarea":kn("invalid",s),D=P=w=null;for(Y in p)if(p.hasOwnProperty(Y)&&(pe=p[Y],pe!=null))switch(Y){case"value":w=pe;break;case"defaultValue":P=pe;break;case"children":D=pe;break;case"dangerouslySetInnerHTML":if(pe!=null)throw Error(l(91));break;default:Qn(s,o,Y,pe,p,null)}Mo(s,w,P,D);return;case"option":for(De in p)p.hasOwnProperty(De)&&(w=p[De],w!=null)&&(De==="selected"?s.selected=w&&typeof w!="function"&&typeof w!="symbol":Qn(s,o,De,w,p,null));return;case"dialog":kn("beforetoggle",s),kn("toggle",s),kn("cancel",s),kn("close",s);break;case"iframe":case"object":kn("load",s);break;case"video":case"audio":for(w=0;w<Rh.length;w++)kn(Rh[w],s);break;case"image":kn("error",s),kn("load",s);break;case"details":kn("toggle",s);break;case"embed":case"source":case"link":kn("error",s),kn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ft in p)if(p.hasOwnProperty(ft)&&(w=p[ft],w!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,o));default:Qn(s,o,ft,w,p,null)}return;default:if(Ll(o)){for(St in p)p.hasOwnProperty(St)&&(w=p[St],w!==void 0&&Dd(s,o,St,w,p,void 0));return}}for(pe in p)p.hasOwnProperty(pe)&&(w=p[pe],w!=null&&Qn(s,o,pe,w,p,null))}function A_(s,o,p,w){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var P=null,D=null,Y=null,pe=null,De=null,ft=null,St=null;for(yt in p){var Lt=p[yt];if(p.hasOwnProperty(yt)&&Lt!=null)switch(yt){case"checked":break;case"value":break;case"defaultValue":De=Lt;default:w.hasOwnProperty(yt)||Qn(s,o,yt,null,w,Lt)}}for(var pt in w){var yt=w[pt];if(Lt=p[pt],w.hasOwnProperty(pt)&&(yt!=null||Lt!=null))switch(pt){case"type":D=yt;break;case"name":P=yt;break;case"checked":ft=yt;break;case"defaultChecked":St=yt;break;case"value":Y=yt;break;case"defaultValue":pe=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(l(137,o));break;default:yt!==Lt&&Qn(s,o,pt,yt,w,Lt)}}Na(s,Y,pe,De,ft,St,D,P);return;case"select":yt=Y=pe=pt=null;for(D in p)if(De=p[D],p.hasOwnProperty(D)&&De!=null)switch(D){case"value":break;case"multiple":yt=De;default:w.hasOwnProperty(D)||Qn(s,o,D,null,w,De)}for(P in w)if(D=w[P],De=p[P],w.hasOwnProperty(P)&&(D!=null||De!=null))switch(P){case"value":pt=D;break;case"defaultValue":pe=D;break;case"multiple":Y=D;default:D!==De&&Qn(s,o,P,D,w,De)}o=pe,p=Y,w=yt,pt!=null?Gn(s,!!p,pt,!1):!!w!=!!p&&(o!=null?Gn(s,!!p,o,!0):Gn(s,!!p,p?[]:"",!1));return;case"textarea":yt=pt=null;for(pe in p)if(P=p[pe],p.hasOwnProperty(pe)&&P!=null&&!w.hasOwnProperty(pe))switch(pe){case"value":break;case"children":break;default:Qn(s,o,pe,null,w,P)}for(Y in w)if(P=w[Y],D=p[Y],w.hasOwnProperty(Y)&&(P!=null||D!=null))switch(Y){case"value":pt=P;break;case"defaultValue":yt=P;break;case"children":break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(l(91));break;default:P!==D&&Qn(s,o,Y,P,w,D)}Vr(s,pt,yt);return;case"option":for(var _i in p)pt=p[_i],p.hasOwnProperty(_i)&&pt!=null&&!w.hasOwnProperty(_i)&&(_i==="selected"?s.selected=!1:Qn(s,o,_i,null,w,pt));for(De in w)pt=w[De],yt=p[De],w.hasOwnProperty(De)&&pt!==yt&&(pt!=null||yt!=null)&&(De==="selected"?s.selected=pt&&typeof pt!="function"&&typeof pt!="symbol":Qn(s,o,De,pt,w,yt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ni in p)pt=p[Ni],p.hasOwnProperty(Ni)&&pt!=null&&!w.hasOwnProperty(Ni)&&Qn(s,o,Ni,null,w,pt);for(ft in w)if(pt=w[ft],yt=p[ft],w.hasOwnProperty(ft)&&pt!==yt&&(pt!=null||yt!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(l(137,o));break;default:Qn(s,o,ft,pt,w,yt)}return;default:if(Ll(o)){for(var _s in p)pt=p[_s],p.hasOwnProperty(_s)&&pt!==void 0&&!w.hasOwnProperty(_s)&&Dd(s,o,_s,void 0,w,pt);for(St in w)pt=w[St],yt=p[St],!w.hasOwnProperty(St)||pt===yt||pt===void 0&&yt===void 0||Dd(s,o,St,pt,w,yt);return}}for(var Qe in p)pt=p[Qe],p.hasOwnProperty(Qe)&&pt!=null&&!w.hasOwnProperty(Qe)&&Qn(s,o,Qe,null,w,pt);for(Lt in w)pt=w[Lt],yt=p[Lt],!w.hasOwnProperty(Lt)||pt===yt||pt==null&&yt==null||Qn(s,o,Lt,pt,w,yt)}function a(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function n(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,p=performance.getEntriesByType("resource"),w=0;w<p.length;w++){var P=p[w],D=P.transferSize,Y=P.initiatorType,pe=P.duration;if(D&&pe&&a(Y)){for(Y=0,pe=P.responseEnd,w+=1;w<p.length;w++){var De=p[w],ft=De.startTime;if(ft>pe)break;var St=De.transferSize,Lt=De.initiatorType;St&&a(Lt)&&(De=De.responseEnd,Y+=St*(De<pe?1:(pe-ft)/(De-ft)))}if(--w,o+=8*(D+Y)/(P.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var c=null,m=null;function x(s){return s.nodeType===9?s:s.ownerDocument}function k(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function C(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function I(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var R=null;function F(){var s=window.event;return s&&s.type==="popstate"?s===R?!1:(R=s,!0):(R=null,!1)}var q=typeof setTimeout=="function"?setTimeout:void 0,W=typeof clearTimeout=="function"?clearTimeout:void 0,ee=typeof Promise=="function"?Promise:void 0,se=typeof queueMicrotask=="function"?queueMicrotask:typeof ee<"u"?function(s){return ee.resolve(null).then(s).catch(ue)}:q;function ue(s){setTimeout(function(){throw s})}function de(s){return s==="head"}function Te(s,o){var p=o,w=0;do{var P=p.nextSibling;if(s.removeChild(p),P&&P.nodeType===8)if(p=P.data,p==="/$"||p==="/&"){if(w===0){s.removeChild(P),$f(o);return}w--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")w++;else if(p==="html")vt(s.ownerDocument.documentElement);else if(p==="head"){p=s.ownerDocument.head,vt(p);for(var D=p.firstChild;D;){var Y=D.nextSibling,pe=D.nodeName;D[fi]||pe==="SCRIPT"||pe==="STYLE"||pe==="LINK"&&D.rel.toLowerCase()==="stylesheet"||p.removeChild(D),D=Y}}else p==="body"&&vt(s.ownerDocument.body);p=P}while(p);$f(o)}function Ae(s,o){var p=s;s=0;do{var w=p.nextSibling;if(p.nodeType===1?o?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(o?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),w&&w.nodeType===8)if(p=w.data,p==="/$"){if(s===0)break;s--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||s++;p=w}while(p)}function Je(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var p=o;switch(o=o.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Je(p),Ne(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function Oe(s,o,p,w){for(;s.nodeType===1;){var P=p;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!w&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(w){if(!s[fi])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(D=s.getAttribute("rel"),D==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(D!==P.rel||s.getAttribute("href")!==(P.href==null||P.href===""?null:P.href)||s.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin)||s.getAttribute("title")!==(P.title==null?null:P.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(D=s.getAttribute("src"),(D!==(P.src==null?null:P.src)||s.getAttribute("type")!==(P.type==null?null:P.type)||s.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin))&&D&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var D=P.name==null?null:""+P.name;if(P.type==="hidden"&&s.getAttribute("name")===D)return s}else return s;if(s=Ft(s.nextSibling),s===null)break}return null}function We(s,o,p){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=Ft(s.nextSibling),s===null))return null;return s}function mt(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Ft(s.nextSibling),s===null))return null;return s}function Dt(s){return s.data==="$?"||s.data==="$~"}function Jt(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Ti(s,o){var p=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||p.readyState!=="loading")o();else{var w=function(){o(),p.removeEventListener("DOMContentLoaded",w)};p.addEventListener("DOMContentLoaded",w),s._reactRetry=w}}function Ft(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var Zt=null;function di(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var p=s.data;if(p==="/$"||p==="/&"){if(o===0)return Ft(s.nextSibling);o--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||o++}s=s.nextSibling}return null}function li(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(o===0)return s;o--}else p!=="/$"&&p!=="/&"||o++}s=s.previousSibling}return null}function ri(s,o,p){switch(o=x(p),s){case"html":if(s=o.documentElement,!s)throw Error(l(452));return s;case"head":if(s=o.head,!s)throw Error(l(453));return s;case"body":if(s=o.body,!s)throw Error(l(454));return s;default:throw Error(l(451))}}function vt(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);Ne(s)}var oi=new Map,ui=new Set;function Mi(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Tn=ct.d;ct.d={f:Yn,r:hr,D:dr,C:ga,L:ya,m:_a,X:fr,S:Ls,M:ta};function Yn(){var s=Tn.f(),o=kd();return s||o}function hr(s){var o=Kt(s);o!==null&&o.tag===5&&o.type==="form"?Ap(o):Tn.r(s)}var ea=typeof document>"u"?null:document;function Cr(s,o,p){var w=ea;if(w&&typeof o=="string"&&o){var P=On(o);P='link[rel="'+s+'"][href="'+P+'"]',typeof p=="string"&&(P+='[crossorigin="'+p+'"]'),ui.has(P)||(ui.add(P),s={rel:s,crossOrigin:p,href:o},w.querySelector(P)===null&&(o=w.createElement("link"),kr(o,"link",s),mn(o),w.head.appendChild(o)))}}function dr(s){Tn.D(s),Cr("dns-prefetch",s,null)}function ga(s,o){Tn.C(s,o),Cr("preconnect",s,o)}function ya(s,o,p){Tn.L(s,o,p);var w=ea;if(w&&s&&o){var P='link[rel="preload"][as="'+On(o)+'"]';o==="image"&&p&&p.imageSrcSet?(P+='[imagesrcset="'+On(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(P+='[imagesizes="'+On(p.imageSizes)+'"]')):P+='[href="'+On(s)+'"]';var D=P;switch(o){case"style":D=tr(s);break;case"script":D=fn(s)}oi.has(D)||(s=N({rel:"preload",href:o==="image"&&p&&p.imageSrcSet?void 0:s,as:o},p),oi.set(D,s),w.querySelector(P)!==null||o==="style"&&w.querySelector(Gs(D))||o==="script"&&w.querySelector(Bn(D))||(o=w.createElement("link"),kr(o,"link",s),mn(o),w.head.appendChild(o)))}}function _a(s,o){Tn.m(s,o);var p=ea;if(p&&s){var w=o&&typeof o.as=="string"?o.as:"script",P='link[rel="modulepreload"][as="'+On(w)+'"][href="'+On(s)+'"]',D=P;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=fn(s)}if(!oi.has(D)&&(s=N({rel:"modulepreload",href:s},o),oi.set(D,s),p.querySelector(P)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Bn(D)))return}w=p.createElement("link"),kr(w,"link",s),mn(w),p.head.appendChild(w)}}}function Ls(s,o,p){Tn.S(s,o,p);var w=ea;if(w&&s){var P=vi(w).hoistableStyles,D=tr(s);o=o||"default";var Y=P.get(D);if(!Y){var pe={loading:0,preload:null};if(Y=w.querySelector(Gs(D)))pe.loading=5;else{s=N({rel:"stylesheet",href:s,"data-precedence":o},p),(p=oi.get(D))&&ms(s,p);var De=Y=w.createElement("link");mn(De),kr(De,"link",s),De._p=new Promise(function(ft,St){De.onload=ft,De.onerror=St}),De.addEventListener("load",function(){pe.loading|=1}),De.addEventListener("error",function(){pe.loading|=2}),pe.loading|=4,ia(Y,o,w)}Y={type:"stylesheet",instance:Y,count:1,state:pe},P.set(D,Y)}}}function fr(s,o){Tn.X(s,o);var p=ea;if(p&&s){var w=vi(p).hoistableScripts,P=fn(s),D=w.get(P);D||(D=p.querySelector(Bn(P)),D||(s=N({src:s,async:!0},o),(o=oi.get(P))&&du(s,o),D=p.createElement("script"),mn(D),kr(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(P,D))}}function ta(s,o){Tn.M(s,o);var p=ea;if(p&&s){var w=vi(p).hoistableScripts,P=fn(s),D=w.get(P);D||(D=p.querySelector(Bn(P)),D||(s=N({src:s,async:!0,type:"module"},o),(o=oi.get(P))&&du(s,o),D=p.createElement("script"),mn(D),kr(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(P,D))}}function Ar(s,o,p,w){var P=(P=Pt.current)?Mi(P):null;if(!P)throw Error(l(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(o=tr(p.href),p=vi(P).hoistableStyles,w=p.get(o),w||(w={type:"style",instance:null,count:0,state:null},p.set(o,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=tr(p.href);var D=vi(P).hoistableStyles,Y=D.get(s);if(Y||(P=P.ownerDocument||P,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(s,Y),(D=P.querySelector(Gs(s)))&&!D._p&&(Y.instance=D,Y.state.loading=5),oi.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},oi.set(s,p),D||ja(P,s,p,Y.state))),o&&w===null)throw Error(l(528,""));return Y}if(o&&w!==null)throw Error(l(529,""));return null;case"script":return o=p.async,p=p.src,typeof p=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=fn(p),p=vi(P).hoistableScripts,w=p.get(o),w||(w={type:"script",instance:null,count:0,state:null},p.set(o,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,s))}}function tr(s){return'href="'+On(s)+'"'}function Gs(s){return'link[rel="stylesheet"]['+s+"]"}function eo(s){return N({},s,{"data-precedence":s.precedence,precedence:null})}function ja(s,o,p,w){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?w.loading=1:(o=s.createElement("link"),w.preload=o,o.addEventListener("load",function(){return w.loading|=1}),o.addEventListener("error",function(){return w.loading|=2}),kr(o,"link",p),mn(o),s.head.appendChild(o))}function fn(s){return'[src="'+On(s)+'"]'}function Bn(s){return"script[async]"+s}function cs(s,o,p){if(o.count++,o.instance===null)switch(o.type){case"style":var w=s.querySelector('style[data-href~="'+On(p.href)+'"]');if(w)return o.instance=w,mn(w),w;var P=N({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return w=(s.ownerDocument||s).createElement("style"),mn(w),kr(w,"style",P),ia(w,p.precedence,s),o.instance=w;case"stylesheet":P=tr(p.href);var D=s.querySelector(Gs(P));if(D)return o.state.loading|=4,o.instance=D,mn(D),D;w=eo(p),(P=oi.get(P))&&ms(w,P),D=(s.ownerDocument||s).createElement("link"),mn(D);var Y=D;return Y._p=new Promise(function(pe,De){Y.onload=pe,Y.onerror=De}),kr(D,"link",w),o.state.loading|=4,ia(D,p.precedence,s),o.instance=D;case"script":return D=fn(p.src),(P=s.querySelector(Bn(D)))?(o.instance=P,mn(P),P):(w=p,(P=oi.get(D))&&(w=N({},p),du(w,P)),s=s.ownerDocument||s,P=s.createElement("script"),mn(P),kr(P,"link",w),s.head.appendChild(P),o.instance=P);case"void":return null;default:throw Error(l(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(w=o.instance,o.state.loading|=4,ia(w,p.precedence,s));return o.instance}function ia(s,o,p){for(var w=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),P=w.length?w[w.length-1]:null,D=P,Y=0;Y<w.length;Y++){var pe=w[Y];if(pe.dataset.precedence===o)D=pe;else if(D!==P)break}D?D.parentNode.insertBefore(s,D.nextSibling):(o=p.nodeType===9?p.head:p,o.insertBefore(s,o.firstChild))}function ms(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function du(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var So=null;function kl(s,o,p){if(So===null){var w=new Map,P=So=new Map;P.set(p,w)}else P=So,w=P.get(p),w||(w=new Map,P.set(p,w));if(w.has(s))return w;for(w.set(s,null),p=p.getElementsByTagName(s),P=0;P<p.length;P++){var D=p[P];if(!(D[fi]||D[Ct]||s==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=D.getAttribute(o)||"";Y=s+Y;var pe=w.get(Y);pe?pe.push(D):w.set(Y,[D])}}return w}function To(s,o,p){s=s.ownerDocument||s,s.head.insertBefore(p,o==="title"?s.querySelector("head > title"):null)}function Eo(s,o,p){if(p===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(s=o.disabled,typeof o.precedence=="string"&&s==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function pr(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function Sc(s,o,p,w){if(p.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var P=tr(w.href),D=o.querySelector(Gs(P));if(D){o=D._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=Od.bind(s),o.then(s,s)),p.state.loading|=4,p.instance=D,mn(D);return}D=o.ownerDocument||o,w=eo(w),(P=oi.get(P))&&ms(w,P),D=D.createElement("link"),mn(D);var Y=D;Y._p=new Promise(function(pe,De){Y.onload=pe,Y.onerror=De}),kr(D,"link",w),p.instance=D}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(p,o),(o=p.state.preload)&&(p.state.loading&3)===0&&(s.count++,p=Od.bind(s),o.addEventListener("load",p),o.addEventListener("error",p))}}var qu=0;function Gg(s,o){return s.stylesheets&&s.count===0&&Nh(s,s.stylesheets),0<s.count||0<s.imgCount?function(p){var w=setTimeout(function(){if(s.stylesheets&&Nh(s,s.stylesheets),s.unsuspend){var D=s.unsuspend;s.unsuspend=null,D()}},6e4+o);0<s.imgBytes&&qu===0&&(qu=62500*n());var P=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Nh(s,s.stylesheets),s.unsuspend)){var D=s.unsuspend;s.unsuspend=null,D()}},(s.imgBytes>qu?50:800)+o);return s.unsuspend=p,function(){s.unsuspend=null,clearTimeout(w),clearTimeout(P)}}:null}function Od(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Nh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Oh=null;function Nh(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Oh=new Map,o.forEach(Tc,s),Oh=null,Od.call(s))}function Tc(s,o){if(!(o.state.loading&4)){var p=Oh.get(s);if(p)var w=p.get(null);else{p=new Map,Oh.set(s,p);for(var P=s.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<P.length;D++){var Y=P[D];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(p.set(Y.dataset.precedence,Y),w=Y)}w&&p.set(null,w)}P=o.instance,Y=P.getAttribute("data-precedence"),D=p.get(Y)||w,D===w&&p.set(null,P),p.set(Y,P),this.count++,w=Od.bind(this),P.addEventListener("load",w),P.addEventListener("error",w),D?D.parentNode.insertBefore(P,D.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(P,s.firstChild)),o.state.loading|=4}}var Bh={$$typeof:le,Provider:null,Consumer:null,_currentValue:ut,_currentValue2:ut,_threadCount:0};function Wg(s,o,p,w,P,D,Y,pe,De){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=je(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=je(0),this.hiddenUpdates=je(null),this.identifierPrefix=w,this.onUncaughtError=P,this.onCaughtError=D,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function Yg(s,o,p,w,P,D,Y,pe,De,ft,St,Lt){return s=new Wg(s,o,p,Y,De,ft,St,Lt,pe),o=1,D===!0&&(o|=24),D=Js(3,null,null,o),s.current=D,D.stateNode=s,o=Za(),o.refCount++,s.pooledCache=o,o.refCount++,D.memoizedState={element:w,isDehydrated:p,cache:o},ti(D),s}function Xg(s){return s?(s=Sr,s):Sr}function Kg(s,o,p,w,P,D){P=Xg(P),w.context===null?w.context=P:w.pendingContext=P,w=Ut(o),w.payload={element:p},D=D===void 0?null:D,D!==null&&(w.callback=D),p=ai(s,w,o),p!==null&&(pa(p,s,o),Ai(p,s,o))}function Jg(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<o?p:o}}function mm(s,o){Jg(s,o),(s=s.alternate)&&Jg(s,o)}function Qg(s){if(s.tag===13||s.tag===31){var o=da(s,67108864);o!==null&&pa(o,s,67108864),mm(s,67108864)}}function ey(s){if(s.tag===13||s.tag===31){var o=wo();o=Ke(o);var p=da(s,o);p!==null&&pa(p,s,o),mm(s,o)}}var Df=!0;function Cl(s,o,p,w){var P=Be.T;Be.T=null;var D=ct.p;try{ct.p=2,Nf(s,o,p,w)}finally{ct.p=D,Be.T=P}}function Of(s,o,p,w){var P=Be.T;Be.T=null;var D=ct.p;try{ct.p=8,Nf(s,o,p,w)}finally{ct.p=D,Be.T=P}}function Nf(s,o,p,w){if(Df){var P=gm(w);if(P===null)Id(s,o,w,Bf,p),Jx(s,w);else if(y2(P,s,o,p,w))w.stopPropagation();else if(Jx(s,w),o&4&&-1<g2.indexOf(s)){for(;P!==null;){var D=Kt(P);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var Y=we(D.pendingLanes);if(Y!==0){var pe=D;for(pe.pendingLanes|=2,pe.entangledLanes|=2;Y;){var De=1<<31-Wi(Y);pe.entanglements[1]|=De,Y&=~De}Jl(D),(Vn&6)===0&&(Tf=sn()+500,Ih(0))}}break;case 31:case 13:pe=da(D,2),pe!==null&&pa(pe,D,2),kd(),mm(D,2)}if(D=gm(w),D===null&&Id(s,o,w,Bf,p),D===P)break;P=D}P!==null&&w.stopPropagation()}else Id(s,o,w,null,p)}}function gm(s){return s=Fs(s),ym(s)}var Bf=null;function ym(s){if(Bf=null,s=zt(s),s!==null){var o=_(s);if(o===null)s=null;else{var p=o.tag;if(p===13){if(s=y(o),s!==null)return s;s=null}else if(p===31){if(s=d(o),s!==null)return s;s=null}else if(p===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Bf=s,null}function Nr(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xi()){case Gi:return 2;case ns:return 8;case kt:case Hn:return 32;case yn:return 268435456;default:return 32}default:return 32}}var Ia=!1,to=null,Br=null,io=null,no=new Map,_m=new Map,$h=[],g2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jx(s,o){switch(s){case"focusin":case"focusout":to=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":io=null;break;case"pointerover":case"pointerout":no.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":_m.delete(o.pointerId)}}function vm(s,o,p,w,P,D){return s===null||s.nativeEvent!==D?(s={blockedOn:o,domEventName:p,eventSystemFlags:w,nativeEvent:D,targetContainers:[P]},o!==null&&(o=Kt(o),o!==null&&Qg(o)),s):(s.eventSystemFlags|=w,o=s.targetContainers,P!==null&&o.indexOf(P)===-1&&o.push(P),s)}function y2(s,o,p,w,P){switch(o){case"focusin":return to=vm(to,s,o,p,w,P),!0;case"dragenter":return Br=vm(Br,s,o,p,w,P),!0;case"mouseover":return io=vm(io,s,o,p,w,P),!0;case"pointerover":var D=P.pointerId;return no.set(D,vm(no.get(D)||null,s,o,p,w,P)),!0;case"gotpointercapture":return D=P.pointerId,_m.set(D,vm(_m.get(D)||null,s,o,p,w,P)),!0}return!1}function Qx(s){var o=zt(s.target);if(o!==null){var p=_(o);if(p!==null){if(o=p.tag,o===13){if(o=y(p),o!==null){s.blockedOn=o,si(s.priority,function(){ey(p)});return}}else if(o===31){if(o=d(p),o!==null){s.blockedOn=o,si(s.priority,function(){ey(p)});return}}else if(o===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ty(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var p=gm(s.nativeEvent);if(p===null){p=s.nativeEvent;var w=new p.constructor(p.type,p);Po=w,p.target.dispatchEvent(w),Po=null}else return o=Kt(p),o!==null&&Qg(o),s.blockedOn=p,!1;o.shift()}return!0}function eb(s,o,p){ty(s)&&p.delete(o)}function _2(){Ia=!1,to!==null&&ty(to)&&(to=null),Br!==null&&ty(Br)&&(Br=null),io!==null&&ty(io)&&(io=null),no.forEach(eb),_m.forEach(eb)}function iy(s,o){s.blockedOn===o&&(s.blockedOn=null,Ia||(Ia=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,_2)))}var ny=null;function tb(s){ny!==s&&(ny=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){ny===s&&(ny=null);for(var o=0;o<s.length;o+=3){var p=s[o],w=s[o+1],P=s[o+2];if(typeof w!="function"){if(ym(w||p)===null)continue;break}var D=Kt(p);D!==null&&(s.splice(o,3),o-=3,df(D,{pending:!0,data:P,method:p.method,action:w},w,P))}}))}function $f(s){function o(De){return iy(De,s)}to!==null&&iy(to,s),Br!==null&&iy(Br,s),io!==null&&iy(io,s),no.forEach(o),_m.forEach(o);for(var p=0;p<$h.length;p++){var w=$h[p];w.blockedOn===s&&(w.blockedOn=null)}for(;0<$h.length&&(p=$h[0],p.blockedOn===null);)Qx(p),p.blockedOn===null&&$h.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(w=0;w<p.length;w+=3){var P=p[w],D=p[w+1],Y=P[ni]||null;if(typeof D=="function")Y||tb(p);else if(Y){var pe=null;if(D&&D.hasAttribute("formAction")){if(P=D,Y=D[ni]||null)pe=Y.formAction;else if(ym(P)!==null)continue}else pe=Y.action;typeof pe=="function"?p[w+1]=pe:(p.splice(w,3),w-=3),tb(p)}}}function ib(){function s(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(Y){return P=Y})},focusReset:"manual",scroll:"manual"})}function o(){P!==null&&(P(),P=null),w||setTimeout(p,20)}function p(){if(!w&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,P=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(p,100),function(){w=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),P!==null&&(P(),P=null)}}}function M_(s){this._internalRoot=s}sy.prototype.render=M_.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(l(409));var p=o.current,w=wo();Kg(p,w,s,o,null,null)},sy.prototype.unmount=M_.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Kg(s.current,2,null,s,null,null),kd(),o[yi]=null}};function sy(s){this._internalRoot=s}sy.prototype.unstable_scheduleHydration=function(s){if(s){var o=Qt();s={blockedOn:null,target:s,priority:o};for(var p=0;p<$h.length&&o!==0&&o<$h[p].priority;p++);$h.splice(p,0,s),p===0&&Qx(s)}};var nb=e.version;if(nb!=="19.2.0")throw Error(l(527,nb,"19.2.0"));ct.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(l(188)):(s=Object.keys(s).join(","),Error(l(268,s)));return s=j(o),s=s!==null?B(s):null,s=s===null?null:s.stateNode,s};var v2={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Be,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ry=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ry.isDisabled&&ry.supportsFiber)try{jt=ry.inject(v2),ii=ry}catch{}}return bm.createRoot=function(s,o){if(!f(s))throw Error(l(299));var p=!1,w="",P=fg,D=pg,Y=mg;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(w=o.identifierPrefix),o.onUncaughtError!==void 0&&(P=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&(Y=o.onRecoverableError)),o=Yg(s,1,!1,null,null,p,w,null,P,D,Y,ib),s[yi]=o.current,dm(s),new M_(o)},bm.hydrateRoot=function(s,o,p){if(!f(s))throw Error(l(299));var w=!1,P="",D=fg,Y=pg,pe=mg,De=null;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(P=p.identifierPrefix),p.onUncaughtError!==void 0&&(D=p.onUncaughtError),p.onCaughtError!==void 0&&(Y=p.onCaughtError),p.onRecoverableError!==void 0&&(pe=p.onRecoverableError),p.formState!==void 0&&(De=p.formState)),o=Yg(s,1,!0,o,p??null,w,P,De,D,Y,pe,ib),o.context=Xg(null),p=o.current,w=wo(),w=Ke(w),P=Ut(w),P.callback=null,ai(p,P,w),p=w,o.current.lanes=p,ze(o,p),Jl(o),s[yi]=o.current,dm(s),new sy(o)},bm.version="19.2.0",bm}var fb;function A2(){if(fb)return j_.exports;fb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),j_.exports=C2(),j_.exports}var M2=A2();const P2=Xh(M2);var ie=nx();const Nt=Xh(ie),j2="modulepreload",I2=function(t){return"/"+t},pb={},Mc=function(e,r,l){let f=Promise.resolve();if(r&&r.length>0){let A=function(j){return Promise.all(j.map(B=>Promise.resolve(B).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),d=y?.nonce||y?.getAttribute("nonce");f=A(r.map(j=>{if(j=I2(j),j in pb)return;pb[j]=!0;const B=j.endsWith(".css"),N=B?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${j}"]${N}`))return;const V=document.createElement("link");if(V.rel=B?"stylesheet":j2,B||(V.as="script"),V.crossOrigin="",V.href=j,d&&V.setAttribute("nonce",d),document.head.appendChild(V),B)return new Promise((Q,ne)=>{V.addEventListener("load",Q),V.addEventListener("error",()=>ne(new Error(`Unable to preload CSS for ${j}`)))})}))}function _(y){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=y,window.dispatchEvent(d),!d.defaultPrevented)throw y}return f.then(y=>{for(const d of y||[])d.status==="rejected"&&_(d.reason);return e().catch(_)})};var Mr={allRenderFn:!1,element:!0,event:!0,hasRenderFn:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,propChangeCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!0,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1},L2="app",z2=Object.defineProperty,R2=(t,e)=>{for(var r in e)z2(t,r,{get:e[r],enumerable:!0})},D2={isBrowser:!0},O2="http://www.w3.org/2000/svg",N2="http://www.w3.org/1999/xhtml",B2=(t,e)=>{var r;const l=e.$cmpMeta$;Object.entries((r=l.$members$)!=null?r:{}).map(([_,[y]])=>{if(y&31||y&32){const d=t[_],A=$2(Object.getPrototypeOf(t),_)||Object.getOwnPropertyDescriptor(t,_);A&&Object.defineProperty(t,_,{get(){return A.get.call(this)},set(j){A.set.call(this,j)},configurable:!0,enumerable:!0}),t[_]=e.$instanceValues$.has(_)?e.$instanceValues$.get(_):d}})};function $2(t,e){for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r?.get)return r;t=Object.getPrototypeOf(t)}}var Yu=t=>{if(t.__stencil__getHostRef)return t.__stencil__getHostRef()},U2=(t,e)=>{const r={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map,$serializerValues$:new Map};r.$onReadyPromise$=new Promise(f=>r.$onReadyResolve$=f),t["s-p"]=[],t["s-rc"]=[];const l=r;return t.__stencil__getHostRef=()=>l,Mr.modernPropertyDecls&&Mr.state&&B2(t,r),l},mb=(t,e)=>e in t,Xm=(t,e)=>(0,console.error)(t,e),Iy=new Map,Cw=[],F2="slot-fb{display:contents}slot-fb[hidden]{display:none}",gb="http://www.w3.org/1999/xlink",gr=typeof window<"u"?window:{},Ra=gr.HTMLElement||class{},Da={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,r,l)=>t.addEventListener(e,r,l),rel:(t,e,r,l)=>t.removeEventListener(e,r,l),ce:(t,e)=>new CustomEvent(t,e)},V2=(()=>{var t;let e=!1;try{(t=gr.document)==null||t.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),q2=t=>Promise.resolve(t),sx=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),yv=sx?!!gr.document&&Object.getOwnPropertyDescriptor(gr.document.adoptedStyleSheets,"length").writable:!1,_v=!1,vv=[],Aw=[],Mw=(t,e)=>r=>{t.push(r),_v||(_v=!0,e&&Da.$flags$&4?rx(xv):Da.raf(xv))},yb=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(r){Xm(r)}t.length=0},xv=()=>{yb(vv),yb(Aw),(_v=vv.length>0)&&Da.raf(xv)},rx=t=>q2().then(t),Ty=Mw(vv,!1),zm=Mw(Aw,!0),H2=t=>{const e=new URL(t,Da.$resourcesUrl$);return e.origin!==gr.location.origin?e.href:e.pathname},Z2=t=>t!=null&&t!==void 0,ax=t=>(t=typeof t,t==="object"||t==="function");function G2(t){var e,r,l;return(l=(r=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:r.getAttribute("content"))!=null?l:void 0}var W2=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Y2={};R2(Y2,{err:()=>Pw,map:()=>X2,ok:()=>bv,unwrap:()=>K2,unwrapErr:()=>J2});var bv=t=>({isOk:!0,isErr:!1,value:t}),Pw=t=>({isOk:!1,isErr:!0,value:t});function X2(t,e){if(t.isOk){const r=e(t.value);return r instanceof Promise?r.then(l=>bv(l)):bv(r)}if(t.isErr){const r=t.value;return Pw(r)}throw"should never get here"}var K2=t=>{if(t.isOk)return t.value;throw t.value},J2=t=>{if(t.isErr)return t.value;throw t.value};var wm;function Q2(t){var e;const r=this.attachShadow({mode:"open",delegatesFocus:!!(t.$flags$&16)});wm===void 0&&(wm=(e=void 0)!=null?e:null),wm&&(yv?r.adoptedStyleSheets.push(wm):r.adoptedStyleSheets=[...r.adoptedStyleSheets,wm])}var jw=t=>{const e=vb(t,"childNodes");t.tagName&&t.tagName.includes("-")&&t["s-cr"]&&t.tagName!=="SLOT-FB"&&Iw(e,t.tagName).forEach(l=>{l.nodeType===1&&l.tagName==="SLOT-FB"&&(tT(l,ox(l),!1).length?l.hidden=!0:l.hidden=!1)});let r=0;for(r=0;r<e.length;r++){const l=e[r];l.nodeType===1&&vb(l,"childNodes").length&&jw(l)}},eT=t=>{const e=[];for(let r=0;r<t.length;r++){const l=t[r]["s-nr"]||void 0;l&&l.isConnected&&e.push(l)}return e};function Iw(t,e,r){let l=0,f=[],_;for(;l<t.length;l++)_=t[l],_["s-sr"]&&(!e||_["s-hn"]===e)&&r===void 0&&f.push(_),f=[...f,...Iw(_.childNodes,e,r)];return f}var tT=(t,e,r=!0)=>{const l=[];(r&&t["s-sr"]||!t["s-sr"])&&l.push(t);let f=t;for(;f=f.nextSibling;)ox(f)===e&&(r||!f["s-sr"])&&l.push(f);return l},_b=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",ox=t=>typeof t["s-sn"]=="string"?t["s-sn"]:t.nodeType===1&&t.getAttribute("slot")||void 0;function iT(t){if(t.assignedElements||t.assignedNodes||!t["s-sr"])return;const e=r=>(function(l){const f=[],_=this["s-sn"];l?.flatten&&console.error(`
          Flattening is not supported for Stencil non-shadow slots.
          You can use \`.childNodes\` to nested slot fallback content.
          If you have a particular use case, please open an issue on the Stencil repo.
        `);const y=this["s-cr"].parentElement;return(y.__childNodes?y.childNodes:eT(y.childNodes)).forEach(A=>{_===ox(A)&&f.push(A)}),r?f.filter(A=>A.nodeType===1):f}).bind(t);t.assignedElements=e(!0),t.assignedNodes=e(!1)}function vb(t,e){if("__"+e in t){const r=t["__"+e];return typeof r!="function"?r:r.bind(t)}else return typeof t[e]!="function"?t[e]:t[e].bind(t)}var Xd=(t,e="")=>()=>{},ep=new WeakMap,nT=(t,e,r)=>{let l=Iy.get(t);sx&&r?(l=l||new CSSStyleSheet,typeof l=="string"?l=e:l.replaceSync(e)):l=e,Iy.set(t,l)},sT=(t,e,r)=>{var l;const f=Lw(e,r),_=Iy.get(f);if(!gr.document)return f;if(t=t.nodeType===11?t:gr.document,_)if(typeof _=="string"){t=t.head||t;let y=ep.get(t),d;if(y||ep.set(t,y=new Set),!y.has(f)){{d=gr.document.createElement("style"),d.innerHTML=_;const A=(l=Da.$nonce$)!=null?l:G2(gr.document);if(A!=null&&d.setAttribute("nonce",A),!(e.$flags$&1))if(t.nodeName==="HEAD"){const j=t.querySelectorAll("link[rel=preconnect]"),B=j.length>0?j[j.length-1].nextSibling:t.querySelector("style");t.insertBefore(d,B?.parentNode===t?B:null)}else if("host"in t)if(sx){const j=new CSSStyleSheet;j.replaceSync(_),yv?t.adoptedStyleSheets.unshift(j):t.adoptedStyleSheets=[j,...t.adoptedStyleSheets]}else{const j=t.querySelector("style");j?j.innerHTML=_+j.innerHTML:t.prepend(d)}else t.append(d);e.$flags$&1&&t.insertBefore(d,null)}e.$flags$&4&&(d.innerHTML+=F2),y&&y.add(f)}}else t.adoptedStyleSheets.includes(_)||(yv?t.adoptedStyleSheets.push(_):t.adoptedStyleSheets=[...t.adoptedStyleSheets,_]);return f},rT=t=>{const e=t.$cmpMeta$,r=t.$hostElement$,l=e.$flags$,f=Xd("attachStyles",e.$tagName$),_=sT(r.shadowRoot?r.shadowRoot:r.getRootNode(),e,t.$modeName$);l&10&&(r["s-sc"]=_,r.classList.add(_+"-h")),f()},Lw=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),wi=(t,e,...r)=>{let l=null,f=null,_=null,y=!1,d=!1;const A=[],j=N=>{for(let V=0;V<N.length;V++)l=N[V],Array.isArray(l)?j(l):l!=null&&typeof l!="boolean"&&((y=typeof t!="function"&&!ax(l))&&(l=String(l)),y&&d?A[A.length-1].$text$+=l:A.push(y?Ly(null,l):l),d=y)};if(j(r),e){e.key&&(f=e.key),e.name&&(_=e.name);{const N=e.className||e.class;N&&(e.class=typeof N!="object"?N:Object.keys(N).filter(V=>N[V]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,A,oT);const B=Ly(t,null);return B.$attrs$=e,A.length>0&&(B.$children$=A),B.$key$=f,B.$name$=_,B},Ly=(t,e)=>{const r={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return r.$attrs$=null,r.$key$=null,r.$name$=null,r},Yo={},aT=t=>t&&t.$tag$===Yo,oT={forEach:(t,e)=>t.map(xb).forEach(e),map:(t,e)=>t.map(xb).map(e).map(lT)},xb=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),lT=t=>{if(typeof t.vtag=="function"){const r={...t.vattrs};return t.vkey&&(r.key=t.vkey),t.vname&&(r.name=t.vname),wi(t.vtag,r,...t.vchildren||[])}const e=Ly(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},lx=t=>{const e=W2(t);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${e}))(${e}\\b)`,"g")};lx("::slotted");lx(":host");lx(":host-context");var cT=t=>Cw.map(e=>e(t)).find(e=>!!e),uT=t=>Cw.push(t),hT=t=>{var e;return(e=Yu(t))==null?void 0:e.$modeName$},zw=(t,e,r)=>t!=null&&!ax(t)?e&4?t==="false"?!1:t===""||!!t:e&2?typeof t=="string"?parseFloat(t):typeof t=="number"?t:NaN:e&1?String(t):t:t,dT=t=>t,qn=(t,e,r)=>{const l=dT(t);return{emit:f=>Rw(l,e,{bubbles:!!(r&4),composed:!!(r&2),cancelable:!!(r&1),detail:f})}},Rw=(t,e,r)=>{const l=Da.ce(e,r);return t.dispatchEvent(l),l},bb=(t,e,r,l,f,_,y)=>{if(r===l)return;let d=mb(t,e),A=e.toLowerCase();if(e==="class"){const j=t.classList,B=wb(r);let N=wb(l);j.remove(...B.filter(V=>V&&!N.includes(V))),j.add(...N.filter(V=>V&&!B.includes(V)))}else if(e==="style"){for(const j in r)(!l||l[j]==null)&&(j.includes("-")?t.style.removeProperty(j):t.style[j]="");for(const j in l)(!r||l[j]!==r[j])&&(j.includes("-")?t.style.setProperty(j,l[j]):t.style[j]=l[j])}else if(e!=="key")if(e==="ref")l&&l(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):mb(gr,A)?e=A.slice(2):e=A[2]+e.slice(3),r||l){const j=e.endsWith(Dw);e=e.replace(pT,""),r&&Da.rel(t,e,r,j),l&&Da.ael(t,e,l,j)}}else{const j=ax(l);if((d||j&&l!==null)&&!f)try{if(t.tagName.includes("-"))t[e]!==l&&(t[e]=l);else{const N=l??"";e==="list"?d=!1:(r==null||t[e]!=N)&&(typeof t.__lookupSetter__(e)=="function"?t[e]=N:t.setAttribute(e,N))}}catch{}let B=!1;A!==(A=A.replace(/^xlink\:?/,""))&&(e=A,B=!0),l==null||l===!1?(l!==!1||t.getAttribute(e)==="")&&(B?t.removeAttributeNS(gb,e):t.removeAttribute(e)):(!d||_&4||f)&&!j&&t.nodeType===1&&(l=l===!0?"":l,B?t.setAttributeNS(gb,e,l):t.setAttribute(e,l))}},fT=/\s/,wb=t=>(typeof t=="object"&&t&&"baseVal"in t&&(t=t.baseVal),!t||typeof t!="string"?[]:t.split(fT)),Dw="Capture",pT=new RegExp(Dw+"$"),wv=(t,e,r,l)=>{const f=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,_=t&&t.$attrs$||{},y=e.$attrs$||{};for(const d of Sb(Object.keys(_)))d in y||bb(f,d,_[d],void 0,r,e.$flags$);for(const d of Sb(Object.keys(y)))bb(f,d,_[d],y[d],r,e.$flags$)};function Sb(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var Ey,zy,Rm,Sv=!1,Ry=!1,cx=!1,Zo=!1,Dy=(t,e,r)=>{var l;const f=e.$children$[r];let _=0,y,d,A;if(Sv||(cx=!0,f.$tag$==="slot"&&(f.$flags$|=f.$children$?2:1)),f.$text$!==null)y=f.$elm$=gr.document.createTextNode(f.$text$);else if(f.$flags$&1)y=f.$elm$=gr.document.createTextNode(""),wv(null,f,Zo);else{if(Zo||(Zo=f.$tag$==="svg"),!gr.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(y=f.$elm$=gr.document.createElementNS(Zo?O2:N2,!Sv&&Mr.slotRelocation&&f.$flags$&2?"slot-fb":f.$tag$),Zo&&f.$tag$==="foreignObject"&&(Zo=!1),wv(null,f,Zo),Z2(Ey)&&y["s-si"]!==Ey&&y.classList.add(y["s-si"]=Ey),f.$children$)for(_=0;_<f.$children$.length;++_)d=Dy(t,f,_),d&&y.appendChild(d);f.$tag$==="svg"?Zo=!1:y.tagName==="foreignObject"&&(Zo=!0)}return y["s-hn"]=Rm,f.$flags$&3&&(y["s-sr"]=!0,y["s-cr"]=zy,y["s-sn"]=f.$name$||"",y["s-rf"]=(l=f.$attrs$)==null?void 0:l.ref,iT(y),A=t&&t.$children$&&t.$children$[r],A&&A.$tag$===f.$tag$&&t.$elm$&&Dm(t.$elm$,!1),Uw(zy,y,e.$elm$,t?.$elm$)),y},Dm=(t,e)=>{Da.$flags$|=1;const r=Array.from(t.__childNodes||t.childNodes);t["s-sr"]&&Mr.experimentalSlotFixes;for(let l=r.length-1;l>=0;l--){const f=r[l];f["s-hn"]!==Rm&&f["s-ol"]&&(Zh(Om(f).parentNode,f,Om(f)),f["s-ol"].remove(),f["s-ol"]=void 0,f["s-sh"]=void 0,cx=!0),e&&Dm(f,e)}Da.$flags$&=-2},Ow=(t,e,r,l,f,_)=>{let y=t["s-cr"]&&t["s-cr"].parentNode||t,d;for(y.shadowRoot&&y.tagName===Rm&&(y=y.shadowRoot);f<=_;++f)l[f]&&(d=Dy(null,r,f),d&&(l[f].$elm$=d,Zh(y,d,Om(e))))},Nw=(t,e,r)=>{for(let l=e;l<=r;++l){const f=t[l];if(f){const _=f.$elm$;$w(f),_&&(Ry=!0,_["s-ol"]?_["s-ol"].remove():Dm(_,!0),_.remove())}}},mT=(t,e,r,l,f=!1)=>{let _=0,y=0,d=0,A=0,j=e.length-1,B=e[0],N=e[j],V=l.length-1,Q=l[0],ne=l[V],J,ye;for(;_<=j&&y<=V;)if(B==null)B=e[++_];else if(N==null)N=e[--j];else if(Q==null)Q=l[++y];else if(ne==null)ne=l[--V];else if(ay(B,Q,f))Wf(B,Q,f),B=e[++_],Q=l[++y];else if(ay(N,ne,f))Wf(N,ne,f),N=e[--j],ne=l[--V];else if(ay(B,ne,f))(B.$tag$==="slot"||ne.$tag$==="slot")&&Dm(B.$elm$.parentNode,!1),Wf(B,ne,f),Zh(t,B.$elm$,N.$elm$.nextSibling),B=e[++_],ne=l[--V];else if(ay(N,Q,f))(B.$tag$==="slot"||ne.$tag$==="slot")&&Dm(N.$elm$.parentNode,!1),Wf(N,Q,f),Zh(t,N.$elm$,B.$elm$),N=e[--j],Q=l[++y];else{for(d=-1,A=_;A<=j;++A)if(e[A]&&e[A].$key$!==null&&e[A].$key$===Q.$key$){d=A;break}d>=0?(ye=e[d],ye.$tag$!==Q.$tag$?J=Dy(e&&e[y],r,d):(Wf(ye,Q,f),e[d]=void 0,J=ye.$elm$),Q=l[++y]):(J=Dy(e&&e[y],r,y),Q=l[++y]),J&&Zh(Om(B.$elm$).parentNode,J,Om(B.$elm$))}_>j?Ow(t,l[V+1]==null?null:l[V+1].$elm$,r,l,y,V):y>V&&Nw(e,_,j)},ay=(t,e,r=!1)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:r?(r&&!t.$key$&&e.$key$&&(t.$key$=e.$key$),!0):t.$key$===e.$key$:!1,Om=t=>t&&t["s-ol"]||t,Wf=(t,e,r=!1)=>{const l=e.$elm$=t.$elm$,f=t.$children$,_=e.$children$,y=e.$tag$,d=e.$text$;let A;d===null?(Zo=y==="svg"?!0:y==="foreignObject"?!1:Zo,wv(t,e,Zo),f!==null&&_!==null?mT(l,f,e,_,r):_!==null?(t.$text$!==null&&(l.textContent=""),Ow(l,null,e,_,0,_.length-1)):!r&&Mr.updatable&&f!==null&&Nw(f,0,f.length-1),Zo&&y==="svg"&&(Zo=!1)):(A=l["s-cr"])?A.parentNode.textContent=d:t.$text$!==d&&(l.data=d)},Zu=[],Bw=t=>{let e,r,l;const f=t.__childNodes||t.childNodes;for(const _ of f){if(_["s-sr"]&&(e=_["s-cr"])&&e.parentNode){r=e.parentNode.__childNodes||e.parentNode.childNodes;const y=_["s-sn"];for(l=r.length-1;l>=0;l--)if(e=r[l],!e["s-cn"]&&!e["s-nr"]&&e["s-hn"]!==_["s-hn"])if(_b(e,y)){let d=Zu.find(A=>A.$nodeToRelocate$===e);Ry=!0,e["s-sn"]=e["s-sn"]||y,d?(d.$nodeToRelocate$["s-sh"]=_["s-hn"],d.$slotRefNode$=_):(e["s-sh"]=_["s-hn"],Zu.push({$slotRefNode$:_,$nodeToRelocate$:e})),e["s-sr"]&&Zu.map(A=>{_b(A.$nodeToRelocate$,e["s-sn"])&&(d=Zu.find(j=>j.$nodeToRelocate$===e),d&&!A.$slotRefNode$&&(A.$slotRefNode$=d.$slotRefNode$))})}else Zu.some(d=>d.$nodeToRelocate$===e)||Zu.push({$nodeToRelocate$:e})}_.nodeType===1&&Bw(_)}},$w=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map($w)},Zh=(t,e,r)=>(typeof e["s-sn"]=="string"&&e["s-sr"]&&e["s-cr"]&&Uw(e["s-cr"],e,t,e.parentElement),t?.insertBefore(e,r));function Uw(t,e,r,l){var f,_;let y;if(t&&typeof e["s-sn"]=="string"&&e["s-sr"]&&t.parentNode&&t.parentNode["s-sc"]&&(y=e["s-si"]||t.parentNode["s-sc"])){const d=e["s-sn"],A=e["s-hn"];if((f=r.classList)==null||f.add(y+"-s"),l&&((_=l.classList)!=null&&_.contains(y+"-s"))){let j=(l.__childNodes||l.childNodes)[0],B=!1;for(;j;){if(j["s-sn"]!==d&&j["s-hn"]===A&&j["s-sr"]){B=!0;break}j=j.nextSibling}B||l.classList.remove(y+"-s")}}}var gT=(t,e,r=!1)=>{var l,f,_,y,d;const A=t.$hostElement$,j=t.$cmpMeta$,B=t.$vnode$||Ly(null,null),V=aT(e)?e:wi(null,null,e);if(Rm=A.tagName,j.$attrsToReflect$&&(V.$attrs$=V.$attrs$||{},j.$attrsToReflect$.forEach(([Q,ne])=>{Mr.serializer&&t.$serializerValues$.has(Q)?V.$attrs$[ne]=t.$serializerValues$.get(Q):V.$attrs$[ne]=A[Q]})),r&&V.$attrs$)for(const Q of Object.keys(V.$attrs$))A.hasAttribute(Q)&&!["key","ref","style","class"].includes(Q)&&(V.$attrs$[Q]=A[Q]);V.$tag$=null,V.$flags$|=4,t.$vnode$=V,V.$elm$=B.$elm$=A.shadowRoot||A,Ey=A["s-sc"],Sv=!!(j.$flags$&1)&&!(j.$flags$&128),zy=A["s-cr"],Ry=!1,Wf(B,V,r);{if(Da.$flags$|=1,cx){Bw(V.$elm$);for(const Q of Zu){const ne=Q.$nodeToRelocate$;if(!ne["s-ol"]&&gr.document){const J=gr.document.createTextNode("");J["s-nr"]=ne,Zh(ne.parentNode,ne["s-ol"]=J,ne)}}for(const Q of Zu){const ne=Q.$nodeToRelocate$,J=Q.$slotRefNode$;if(J){const ye=J.parentNode;let re=J.nextSibling;{let me=(l=ne["s-ol"])==null?void 0:l.previousSibling;for(;me;){let be=(f=me["s-nr"])!=null?f:null;if(be&&be["s-sn"]===ne["s-sn"]&&ye===(be.__parentNode||be.parentNode)){for(be=be.nextSibling;be===ne||be?.["s-sr"];)be=be?.nextSibling;if(!be||!be["s-nr"]){re=be;break}}me=me.previousSibling}}const ge=ne.__parentNode||ne.parentNode,le=ne.__nextSibling||ne.nextSibling;(!re&&ye!==ge||le!==re)&&ne!==re&&(!ne["s-hn"]&&ne["s-ol"]&&(ne["s-hn"]=ne["s-ol"].parentNode.nodeName),Zh(ye,ne,re),ne.nodeType===1&&ne.tagName!=="SLOT-FB"&&(ne.hidden=(_=ne["s-ih"])!=null?_:!1)),ne&&typeof J["s-rf"]=="function"&&J["s-rf"](J)}else ne.nodeType===1&&(r&&(ne["s-ih"]=(y=ne.hidden)!=null?y:!1),ne.hidden=!0)}}Ry&&jw(V.$elm$),Da.$flags$&=-2,Zu.length=0}if(Mr.experimentalScopedSlotChanges&&j.$flags$&2){const Q=V.$elm$.__childNodes||V.$elm$.childNodes;for(const ne of Q)ne["s-hn"]!==Rm&&!ne["s-sh"]&&(r&&ne["s-ih"]==null&&(ne["s-ih"]=(d=ne.hidden)!=null?d:!1),ne.hidden=!0)}zy=void 0},Fw=(t,e)=>{if(e&&!t.$onRenderResolve$&&e["s-p"]){const r=e["s-p"].push(new Promise(l=>t.$onRenderResolve$=()=>{e["s-p"].splice(r-1,1),l()}))}},n_=(t,e)=>{if(t.$flags$|=16,t.$flags$&4){t.$flags$|=512;return}Fw(t,t.$ancestorComponent$);const r=()=>yT(t,e);if(e){queueMicrotask(()=>{r()});return}return zm(r)},yT=(t,e)=>{const r=t.$hostElement$,l=Xd("scheduleUpdate",t.$cmpMeta$.$tagName$),f=r;if(!f)throw new Error(`Can't render component <${r.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let _;return e?_=sp(f,"componentWillLoad",void 0,r):_=sp(f,"componentWillUpdate",void 0,r),_=Tb(_,()=>sp(f,"componentWillRender",void 0,r)),l(),Tb(_,()=>vT(t,f,e))},Tb=(t,e)=>_T(t)?t.then(e).catch(r=>{console.error(r),e()}):e(),_T=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",vT=async(t,e,r)=>{var l;const f=t.$hostElement$,_=Xd("update",t.$cmpMeta$.$tagName$),y=f["s-rc"];r&&rT(t);const d=Xd("render",t.$cmpMeta$.$tagName$);xT(t,e,f,r),y&&(y.map(A=>A()),f["s-rc"]=void 0),d(),_();{const A=(l=f["s-p"])!=null?l:[],j=()=>bT(t);A.length===0?j():(Promise.all(A).then(j),t.$flags$|=4,A.length=0)}},Eb=null,xT=(t,e,r,l)=>{try{Eb=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(Mr.hasRenderFn||Mr.reflect)&&(Mr.vdomRender||Mr.reflect)&&(Mr.hydrateServerSide||gT(t,e,l))}catch(A){Xm(A,t.$hostElement$)}return Eb=null,null},bT=t=>{const e=t.$cmpMeta$.$tagName$,r=t.$hostElement$,l=Xd("postUpdate",e),f=r,_=t.$ancestorComponent$;sp(f,"componentDidRender",void 0,r),t.$flags$&64?(sp(f,"componentDidUpdate",void 0,r),l()):(t.$flags$|=64,ST(r),sp(f,"componentDidLoad",void 0,r),l(),t.$onReadyResolve$(r),_||wT()),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),t.$flags$&512&&rx(()=>n_(t,!1)),t.$flags$&=-517},kb=t=>{var e;{const r=Yu(t),l=(e=r?.$hostElement$)==null?void 0:e.isConnected;return l&&(r.$flags$&18)===2&&n_(r,!1),l}},wT=t=>{rx(()=>Rw(gr,"appload",{detail:{namespace:L2}}))},sp=(t,e,r,l)=>{if(t&&t[e])try{return t[e](r)}catch(f){Xm(f,l)}},ST=t=>{var e;return t.classList.add((e=Mr.hydratedSelectorName)!=null?e:"hydrated")},TT=(t,e)=>Yu(t).$instanceValues$.get(e),Cb=(t,e,r,l)=>{const f=Yu(t);if(!f||Mr.serializer&&f.$serializerValues$.has(e)&&f.$serializerValues$.get(e)===r)return;const _=t,y=f.$instanceValues$.get(e),d=f.$flags$,A=_;r=zw(r,l.$members$[e][0]);const j=Number.isNaN(y)&&Number.isNaN(r);if(r!==y&&!j){if(f.$instanceValues$.set(e,r),Mr.serializer&&Mr.reflect&&l.$attrsToReflect$&&A&&l.$serializers$&&l.$serializers$[e]){let N=r;for(const V of l.$serializers$[e])N=A[V](N,e);f.$serializerValues$.set(e,N)}{if(l.$watchers$&&d&128){const N=l.$watchers$[e];N&&N.map(V=>{try{A[V](r,y,e)}catch(Q){Xm(Q,_)}})}if((d&18)===2){if(A.componentShouldUpdate&&A.componentShouldUpdate(r,y,e)===!1)return;n_(f,!1)}}}},ET=(t,e,r)=>{var l,f;const _=t.prototype;if(e.$members$||Mr.propChangeCallback){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers),t.deserializers&&!e.$deserializers$&&(e.$deserializers$=t.deserializers),t.serializers&&!e.$serializers$&&(e.$serializers$=t.serializers);const y=Object.entries((l=e.$members$)!=null?l:{});y.map(([d,[A]])=>{if(A&31||A&32){const{get:j,set:B}=Object.getOwnPropertyDescriptor(_,d)||{};j&&(e.$members$[d][0]|=2048),B&&(e.$members$[d][0]|=4096),Object.defineProperty(_,d,{get(){return j?j.apply(this):TT(this,d)},configurable:!0,enumerable:!0}),Object.defineProperty(_,d,{set(N){const V=Yu(this);if(V){if(B){typeof(A&32?this[d]:V.$hostElement$[d])>"u"&&V.$instanceValues$.get(d)&&(N=V.$instanceValues$.get(d)),B.apply(this,[zw(N,A)]),N=A&32?this[d]:V.$hostElement$[d],Cb(this,d,N,e);return}{Cb(this,d,N,e);return}}}})}});{const d=new Map;_.attributeChangedCallback=function(A,j,B){Da.jmp(()=>{var N;const V=d.get(A),Q=Yu(this);if(Mr.serializer&&Q.$serializerValues$.has(V)&&Q.$serializerValues$.get(V)===B)return;if(this.hasOwnProperty(V)&&Mr.lazyLoad,Mr.deserializer&&e.$deserializers$&&e.$deserializers$[V]){const J=(ye,re)=>{const ge=re?.[ye](B,V);ge!==this[V]&&(this[V]=ge)};for(const ye of e.$deserializers$[V])J(ye,this);return}else{if(_.hasOwnProperty(V)&&typeof this[V]=="number"&&this[V]==B)return;if(V==null){const J=Q?.$flags$;if(Q&&J&&!(J&8)&&J&128&&B!==j){const re=this,ge=(N=e.$watchers$)==null?void 0:N[A];ge?.forEach(le=>{re[le]!=null&&re[le].call(re,B,j,A)})}return}}const ne=Object.getOwnPropertyDescriptor(_,V);B=B===null&&typeof this[V]=="boolean"?!1:B,B!=this[V]&&(!ne.get||ne.set)&&(this[V]=B)})},t.observedAttributes=Array.from(new Set([...Object.keys((f=e.$watchers$)!=null?f:{}),...y.filter(([A,j])=>j[0]&31).map(([A,j])=>{var B;const N=j[1]||A;return d.set(N,A),j[0]&512&&((B=e.$attrsToReflect$)==null||B.push([A,N])),N})]))}}return t},kT=async(t,e,r,l)=>{let f;if((e.$flags$&32)===0){e.$flags$|=32,r.$lazyBundleId$;{f=t.constructor;const d=t.localName;customElements.whenDefined(d).then(()=>e.$flags$|=128)}if(f&&f.style){let d;typeof f.style=="string"?d=f.style:typeof f.style!="string"&&(e.$modeName$=cT(t),e.$modeName$&&(d=f.style[e.$modeName$]));const A=Lw(r,e.$modeName$);if(!Iy.has(A)){const j=Xd("registerStyles",r.$tagName$);nT(A,d,!!(r.$flags$&1)),j()}}}const _=e.$ancestorComponent$,y=()=>n_(e,!0);_&&_["s-rc"]?_["s-rc"].push(y):y()},Ab=(t,e)=>{},CT=t=>{if((Da.$flags$&1)===0){const e=Yu(t);if(!e)return;const r=e.$cmpMeta$,l=Xd("connectedCallback",r.$tagName$);if(e.$flags$&1)Vw(t,e,r.$listeners$),e?.$lazyInstance$?Ab(e.$lazyInstance$):e?.$onReadyPromise$&&e.$onReadyPromise$.then(()=>Ab(e.$lazyInstance$));else{e.$flags$|=1,r.$flags$&12&&AT(t);{let f=t;for(;f=f.parentNode||f.host;)if(f["s-p"]){Fw(e,e.$ancestorComponent$=f);break}}r.$members$&&Object.entries(r.$members$).map(([f,[_]])=>{if(_&31&&f in t&&t[f]!==Object.prototype[f]){const y=t[f];delete t[f],t[f]=y}}),kT(t,e,r)}l()}},AT=t=>{if(!gr.document)return;const e=t["s-cr"]=gr.document.createComment("");e["s-cn"]=!0,Zh(t,e,t.firstChild)},MT=async t=>{if((Da.$flags$&1)===0){const e=Yu(t);e?.$rmListeners$&&(e.$rmListeners$.map(r=>r()),e.$rmListeners$=void 0)}ep.has(t)&&ep.delete(t),t.shadowRoot&&ep.has(t.shadowRoot)&&ep.delete(t.shadowRoot)},ko=(t,e)=>{const r={$flags$:e[0],$tagName$:e[1]};r.$members$=e[2],r.$listeners$=e[3],r.$watchers$=t.$watchers$,r.$deserializers$=t.$deserializers$,r.$serializers$=t.$serializers$,r.$attrsToReflect$=[],!(r.$flags$&1)&&r.$flags$&256;const l=t.prototype.connectedCallback,f=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__hasHostListenerAttached:!1,__registerHost(){U2(this,r)},connectedCallback(){if(!this.__hasHostListenerAttached){const _=Yu(this);if(!_)return;Vw(this,_,r.$listeners$),this.__hasHostListenerAttached=!0}CT(this),l&&l.call(this)},disconnectedCallback(){MT(this),f&&f.call(this)},__attachShadow(){if(!this.shadowRoot)Q2.call(this,r);else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${r.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=r.$tagName$,ET(t,r)},Vw=(t,e,r,l)=>{r&&gr.document&&r.map(([f,_,y])=>{const d=jT(gr.document,t,f),A=PT(e,y),j=IT(f);Da.ael(d,_,A,j),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>Da.rel(d,_,A,j))})},PT=(t,e)=>r=>{var l;try{Mr.lazyLoad||t.$hostElement$[e](r)}catch(f){Xm(f,t.$hostElement$)}},jT=(t,e,r)=>r&4?t:r&8?gr:r&16?t.body:e,IT=t=>V2?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0;class LT{constructor(){this.m=new Map}reset(e){this.m=new Map(Object.entries(e))}get(e,r){const l=this.m.get(e);return l!==void 0?l:r}getBoolean(e,r=!1){const l=this.m.get(e);return l===void 0?r:typeof l=="string"?l==="true":!!l}getNumber(e,r){const l=parseFloat(this.m.get(e));return isNaN(l)?r!==void 0?r:NaN:l}set(e,r){this.m.set(e,r)}}const xn=new LT,zT=t=>{try{const e=t.sessionStorage.getItem(qw);return e!==null?JSON.parse(e):{}}catch{return{}}},RT=(t,e)=>{try{t.sessionStorage.setItem(qw,JSON.stringify(e))}catch{return}},DT=t=>{const e={};return t.location.search.slice(1).split("&").map(r=>r.split("=")).map(([r,l])=>{try{return[decodeURIComponent(r),decodeURIComponent(l)]}catch{return["",""]}}).filter(([r])=>OT(r,Mb)).map(([r,l])=>[r.slice(Mb.length),l]).forEach(([r,l])=>{e[r]=l}),e},OT=(t,e)=>t.substr(0,e.length)===e,Mb="ionic:",qw="ionic-persist-config";var Wd;(function(t){t.OFF="OFF",t.ERROR="ERROR",t.WARN="WARN"})(Wd||(Wd={}));const jl=(t,...e)=>{const r=xn.get("logLevel",Wd.WARN);if([Wd.WARN].includes(r))return console.warn(`[Ionic Warning]: ${t}`,...e)},Ju=(t,...e)=>{const r=xn.get("logLevel",Wd.ERROR);if([Wd.ERROR,Wd.WARN].includes(r))return console.error(`[Ionic Error]: ${t}`,...e)},NT=(t,...e)=>console.error(`<${t.tagName.toLowerCase()}> must be used inside ${e.join(" or ")}.`);const $s=typeof window<"u"?window:void 0,Mm=typeof document<"u"?document:void 0;let D_;const BT=t=>{if(D_===void 0){const e=t.style.animationName!==void 0,r=t.style.webkitAnimationName!==void 0;D_=!e&&r?"-webkit-":""}return D_},O_=(t,e,r)=>{const l=e.startsWith("animation")?BT(t):"";t.style.setProperty(l+e,r)},oy=(t=[],e)=>{if(e!==void 0){const r=Array.isArray(e)?e:[e];return[...t,...r]}return t},pn=t=>{let e,r,l,f,_,y,d=[],A=[],j=[],B=!1,N,V={},Q=[],ne=[],J={},ye=0,re=!1,ge=!1,le,me,be,ke=!0,Me=!1,Ue=!0,Fe,He=!1;const lt=t,Ye=[],Mt=[],et=[],Tt=[],Be=[],ct=[],ut=[],Et=[],ot=[],xe=[],Le=[],tt=typeof AnimationEffect=="function"||$s!==void 0&&typeof $s.AnimationEffect=="function",rt=typeof Element=="function"&&typeof Element.prototype.animate=="function"&&tt,gt=()=>Le,Pt=Ne=>(Be.forEach(zt=>{zt.destroy(Ne)}),Ot(Ne),Tt.length=0,Be.length=0,d.length=0,gn(),B=!1,Ue=!0,Fe),Ot=Ne=>{ln(),Ne&&$n()},ei=()=>{re=!1,ge=!1,Ue=!0,le=void 0,me=void 0,be=void 0,ye=0,Me=!1,ke=!0,He=!1},gi=()=>ye!==0&&!He,Vi=(Ne,zt)=>{const Kt=zt.findIndex(Zi=>Zi.c===Ne);Kt>-1&&zt.splice(Kt,1)},pi=(Ne,zt)=>(et.push({c:Ne,o:zt}),Fe),zi=(Ne,zt)=>((zt?.oneTimeCallback?Mt:Ye).push({c:Ne,o:zt}),Fe),gn=()=>(Ye.length=0,Mt.length=0,Fe),ln=()=>{rt&&(Le.forEach(Ne=>{Ne.cancel()}),Le.length=0)},$n=()=>{ct.forEach(Ne=>{Ne?.parentNode&&Ne.parentNode.removeChild(Ne)}),ct.length=0},it=Ne=>(ut.push(Ne),Fe),Cn=Ne=>(Et.push(Ne),Fe),Mn=Ne=>(ot.push(Ne),Fe),Si=Ne=>(xe.push(Ne),Fe),mi=Ne=>(A=oy(A,Ne),Fe),En=Ne=>(j=oy(j,Ne),Fe),Rn=(Ne={})=>(V=Ne,Fe),is=(Ne=[])=>{for(const zt of Ne)V[zt]="";return Fe},sn=Ne=>(Q=oy(Q,Ne),Fe),Xi=Ne=>(ne=oy(ne,Ne),Fe),Gi=(Ne={})=>(J=Ne,Fe),ns=(Ne=[])=>{for(const zt of Ne)J[zt]="";return Fe},kt=()=>_!==void 0?_:N?N.getFill():"both",Hn=()=>le!==void 0?le:y!==void 0?y:N?N.getDirection():"normal",yn=()=>re?"linear":l!==void 0?l:N?N.getEasing():"linear",bn=()=>ge?0:me!==void 0?me:r!==void 0?r:N?N.getDuration():0,Un=()=>f!==void 0?f:N?N.getIterations():1,jt=()=>be!==void 0?be:e!==void 0?e:N?N.getDelay():0,ii=()=>d,Xt=Ne=>(y=Ne,at(!0),Fe),Wi=Ne=>(_=Ne,at(!0),Fe),Dn=Ne=>(e=Ne,at(!0),Fe),hi=Ne=>(l=Ne,at(!0),Fe),xs=Ne=>(!rt&&Ne===0&&(Ne=1),r=Ne,at(!0),Fe),Pn=Ne=>(f=Ne,at(!0),Fe),Zn=Ne=>(N=Ne,Fe),rn=Ne=>{if(Ne!=null)if(Ne.nodeType===1)Tt.push(Ne);else if(Ne.length>=0)for(let zt=0;zt<Ne.length;zt++)Tt.push(Ne[zt]);else Ju("createAnimation - Invalid addElement value.");return Fe},we=Ne=>{if(Ne!=null)if(Array.isArray(Ne))for(const zt of Ne)zt.parent(Fe),Be.push(zt);else Ne.parent(Fe),Be.push(Ne);return Fe},te=Ne=>{const zt=d!==Ne;return d=Ne,zt&&G(d),Fe},G=Ne=>{rt&&gt().forEach(zt=>{const Kt=zt.effect;if(Kt.setKeyframes)Kt.setKeyframes(Ne);else{const Zi=new KeyframeEffect(Kt.target,Ne,Kt.getTiming());zt.effect=Zi}})},oe=()=>{ut.forEach(Zi=>Zi()),Et.forEach(Zi=>Zi());const Ne=A,zt=j,Kt=V;Tt.forEach(Zi=>{const vi=Zi.classList;Ne.forEach(mn=>vi.add(mn)),zt.forEach(mn=>vi.remove(mn));for(const mn in Kt)Kt.hasOwnProperty(mn)&&O_(Zi,mn,Kt[mn])})},ve=()=>{ot.forEach(vi=>vi()),xe.forEach(vi=>vi());const Ne=ke?1:0,zt=Q,Kt=ne,Zi=J;Tt.forEach(vi=>{const mn=vi.classList;zt.forEach(_r=>mn.add(_r)),Kt.forEach(_r=>mn.remove(_r));for(const _r in Zi)Zi.hasOwnProperty(_r)&&O_(vi,_r,Zi[_r])}),me=void 0,le=void 0,be=void 0,Ye.forEach(vi=>vi.c(Ne,Fe)),Mt.forEach(vi=>vi.c(Ne,Fe)),Mt.length=0,Ue=!0,ke&&(Me=!0),ke=!0},je=()=>{ye!==0&&(ye--,ye===0&&(ve(),N&&N.animationFinish()))},ze=()=>{Tt.forEach(Ne=>{const zt=Ne.animate(d,{id:lt,delay:jt(),duration:bn(),easing:yn(),iterations:Un(),fill:kt(),direction:Hn()});zt.pause(),Le.push(zt)}),Le.length>0&&(Le[0].onfinish=()=>{je()})},Ve=()=>{oe(),d.length>0&&rt&&ze(),B=!0},he=Ne=>{Ne=Math.min(Math.max(Ne,0),.9999),rt&&Le.forEach(zt=>{zt.currentTime=zt.effect.getComputedTiming().delay+bn()*Ne,zt.pause()})},Ge=Ne=>{Le.forEach(zt=>{zt.effect.updateTiming({delay:jt(),duration:bn(),easing:yn(),iterations:Un(),fill:kt(),direction:Hn()})}),Ne!==void 0&&he(Ne)},at=(Ne=!1,zt=!0,Kt)=>(Ne&&Be.forEach(Zi=>{Zi.update(Ne,zt,Kt)}),rt&&Ge(Kt),Fe),Ke=(Ne=!1,zt)=>(Be.forEach(Kt=>{Kt.progressStart(Ne,zt)}),si(),re=Ne,B||Ve(),at(!1,!0,zt),Fe),st=Ne=>(Be.forEach(zt=>{zt.progressStep(Ne)}),he(Ne),Fe),Qt=(Ne,zt,Kt)=>(re=!1,Be.forEach(Zi=>{Zi.progressEnd(Ne,zt,Kt)}),Kt!==void 0&&(me=Kt),Me=!1,ke=!0,Ne===0?(le=Hn()==="reverse"?"normal":"reverse",le==="reverse"&&(ke=!1),rt?(at(),he(1-zt)):(be=(1-zt)*bn()*-1,at(!1,!1))):Ne===1&&(rt?(at(),he(zt)):(be=zt*bn()*-1,at(!1,!1))),Ne!==void 0&&!N&&Ri(),Fe),si=()=>{B&&(rt?Le.forEach(Ne=>{Ne.pause()}):Tt.forEach(Ne=>{O_(Ne,"animation-play-state","paused")}),He=!0)},Bt=()=>(Be.forEach(Ne=>{Ne.pause()}),si(),Fe),Ct=()=>{je()},ni=()=>{Le.forEach(Ne=>{Ne.play()}),(d.length===0||Tt.length===0)&&je()},yi=()=>{rt&&(he(0),Ge())},Ri=Ne=>new Promise(zt=>{Ne?.sync&&(ge=!0,zi(()=>ge=!1,{oneTimeCallback:!0})),B||Ve(),Me&&(yi(),Me=!1),Ue&&(ye=Be.length+1,Ue=!1);const Kt=()=>{Vi(Zi,Mt),zt()},Zi=()=>{Vi(Kt,et),zt()};zi(Zi,{oneTimeCallback:!0}),pi(Kt,{oneTimeCallback:!0}),Be.forEach(vi=>{vi.play()}),rt?ni():Ct(),He=!1}),_t=()=>{Be.forEach(Ne=>{Ne.stop()}),B&&(ln(),B=!1),ei(),et.forEach(Ne=>Ne.c(0,Fe)),et.length=0},xt=(Ne,zt)=>{const Kt=d[0];return Kt!==void 0&&(Kt.offset===void 0||Kt.offset===0)?Kt[Ne]=zt:d=[{offset:0,[Ne]:zt},...d],Fe};return Fe={parentAnimation:N,elements:Tt,childAnimations:Be,id:lt,animationFinish:je,from:xt,to:(Ne,zt)=>{const Kt=d[d.length-1];return Kt!==void 0&&(Kt.offset===void 0||Kt.offset===1)?Kt[Ne]=zt:d=[...d,{offset:1,[Ne]:zt}],Fe},fromTo:(Ne,zt,Kt)=>xt(Ne,zt).to(Ne,Kt),parent:Zn,play:Ri,pause:Bt,stop:_t,destroy:Pt,keyframes:te,addAnimation:we,addElement:rn,update:at,fill:Wi,direction:Xt,iterations:Pn,duration:xs,easing:hi,delay:Dn,getWebAnimations:gt,getKeyframes:ii,getFill:kt,getDirection:Hn,getDelay:jt,getIterations:Un,getEasing:yn,getDuration:bn,afterAddRead:Mn,afterAddWrite:Si,afterClearStyles:ns,afterStyles:Gi,afterRemoveClass:Xi,afterAddClass:sn,beforeAddRead:it,beforeAddWrite:Cn,beforeClearStyles:is,beforeStyles:Rn,beforeRemoveClass:En,beforeAddClass:mi,onFinish:zi,isRunning:gi,progressStart:Ke,progressStep:st,progressEnd:Qt}};const Kd=(t,e)=>{t.componentOnReady?t.componentOnReady().then(r=>e(r)):mu(()=>e(t))},Oy=t=>t.componentOnReady!==void 0,ux=(t,e=[])=>{const r={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(r[l]=t.getAttribute(l)),t.removeAttribute(l))}),r},$T=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],Hw=(t,e)=>ux(t,$T),UT=(t,e,r,l)=>t.addEventListener(e,r,l),FT=(t,e,r,l)=>t.removeEventListener(e,r,l),Pr=(t,e=t)=>t.shadowRoot||e,mu=t=>typeof __zone_symbol__requestAnimationFrame=="function"?__zone_symbol__requestAnimationFrame(t):typeof requestAnimationFrame=="function"?requestAnimationFrame(t):setTimeout(t),Zw=t=>{if(t.focus(),t.classList.contains("ion-focusable")){const e=t.closest("ion-app");e&&e.setFocus([t])}},Ny=(t,e,r)=>Math.max(t,Math.min(e,r)),Ho=(t,e)=>{if(!t){const r="ASSERT: "+e;Ju(r);debugger;throw new Error(r)}},gD=t=>{if(t){const e=t.changedTouches;if(e&&e.length>0){const r=e[0];return{x:r.clientX,y:r.clientY}}if(t.pageX!==void 0)return{x:t.pageX,y:t.pageY}}return{x:0,y:0}},Gw=(t,e)=>{if(t??(t={}),e??(e={}),t===e)return!0;const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(const l of r)if(!(l in e)||t[l]!==e[l])return!1;return!0},VT="ionViewWillEnter",qT="ionViewDidEnter",Ww="ionViewWillLeave",Yw="ionViewDidLeave",N_="ionViewWillUnload",Sm=t=>{t.tabIndex=-1,t.focus()},ly=t=>t.offsetParent!==null,HT=()=>({saveViewFocus:r=>{if(xn.get("focusManagerPriority",!1)){const f=document.activeElement;f!==null&&r?.contains(f)&&f.setAttribute(Pb,"true")}},setViewFocus:r=>{const l=xn.get("focusManagerPriority",!1);if(Array.isArray(l)&&!r.contains(document.activeElement)){const f=r.querySelector(`[${Pb}]`);if(f&&ly(f)){Sm(f);return}for(const _ of l)switch(_){case"content":const y=r.querySelector('main, [role="main"]');if(y&&ly(y)){Sm(y);return}break;case"heading":const d=r.querySelector('h1, [role="heading"][aria-level="1"]');if(d&&ly(d)){Sm(d);return}break;case"banner":const A=r.querySelector('header, [role="banner"]');if(A&&ly(A)){Sm(A);return}break;default:jl(`Unrecognized focus manager priority value ${_}`);break}Sm(r)}}}),Pb="ion-last-focus",ZT=()=>Mc(()=>import("./ios.transition-BJTvr0D6.js"),[]),GT=()=>Mc(()=>import("./md.transition-BCrw36HE.js"),[]),Xw=HT(),Kw=t=>new Promise((e,r)=>{zm(()=>{const l=nE(t);WT(t,l),YT(t).then(f=>{f.animation&&f.animation.destroy(),jb(t),e(f)},f=>{jb(t),r(f)}).finally(()=>{t1(l,!1)})})}),WT=(t,e)=>{const r=t.enteringEl,l=t.leavingEl;Xw.saveViewFocus(l),iE(r,l,t.direction),t1(e,!0),t.showGoBack?r.classList.add("can-go-back"):r.classList.remove("can-go-back"),Tv(r,!1),r.style.setProperty("pointer-events","none"),l&&(Tv(l,!1),l.style.setProperty("pointer-events","none"))},YT=async t=>{const e=await XT(t);return e&&D2.isBrowser?KT(e,t):JT(t)},jb=t=>{const e=t.enteringEl,r=t.leavingEl;e.classList.remove("ion-page-invisible"),e.style.removeProperty("pointer-events"),r!==void 0&&(r.classList.remove("ion-page-invisible"),r.style.removeProperty("pointer-events")),Xw.setViewFocus(e)},XT=async t=>!t.leavingEl||!t.animated||t.duration===0?void 0:t.animationBuilder?t.animationBuilder:t.mode==="ios"?(await ZT()).iosTransitionAnimation:(await GT()).mdTransitionAnimation,KT=async(t,e)=>{await Jw(e,!0);const r=t(e.baseEl,e);Qw(e.enteringEl,e.leavingEl);const l=await eE(r,e);return e.progressCallback&&e.progressCallback(void 0),l&&e1(e.enteringEl,e.leavingEl),{hasCompleted:l,animation:r}},JT=async t=>{const e=t.enteringEl,r=t.leavingEl,l=xn.get("focusManagerPriority",!1);return await Jw(t,l),Qw(e,r),e1(e,r),{hasCompleted:!0}},Jw=async(t,e)=>{(t.deepWait!==void 0?t.deepWait:e)&&await Promise.all([By(t.enteringEl),By(t.leavingEl)]),await QT(t.viewIsReady,t.enteringEl)},QT=async(t,e)=>{t&&await t(e)},eE=(t,e)=>{const r=e.progressCallback,l=new Promise(f=>{t.onFinish(_=>f(_===1))});return r?(t.progressStart(!0),r(t)):t.play(),l},Qw=(t,e)=>{Gu(e,Ww),Gu(t,VT)},e1=(t,e)=>{Gu(t,qT),Gu(e,Yw)},Gu=(t,e)=>{if(t){const r=new CustomEvent(e,{bubbles:!1,cancelable:!1});t.dispatchEvent(r)}},tE=()=>new Promise(t=>mu(()=>mu(()=>t()))),By=async t=>{const e=t;if(e){if(e.componentOnReady!=null){if(await e.componentOnReady()!=null)return}else if(e.__registerHost!=null){await new Promise(l=>mu(l));return}await Promise.all(Array.from(e.children).map(By))}},Tv=(t,e)=>{e?(t.setAttribute("aria-hidden","true"),t.classList.add("ion-page-hidden")):(t.hidden=!1,t.removeAttribute("aria-hidden"),t.classList.remove("ion-page-hidden"))},iE=(t,e,r)=>{t!==void 0&&(t.style.zIndex=r==="back"?"99":"101"),e!==void 0&&(e.style.zIndex="100")},t1=(t,e)=>{if(!t)return;const r="header-transitioning";e?t.classList.add(r):t.classList.remove(r)},yD=t=>{if(t.classList.contains("ion-page"))return t;const e=t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return e||t},nE=t=>{const e=t.enteringEl,r=t.leavingEl,l=t.direction;if(t.mode!=="ios")return null;const _=l==="back"?r:e;return _?_.querySelector("ion-header"):null};const up=(t,e,r,l,f)=>rE(t[1],e[1],r[1],l[1],f).map(_=>sE(t[0],e[0],r[0],l[0],_)),sE=(t,e,r,l,f)=>{const _=3*e*Math.pow(f-1,2),y=-3*r*f+3*r+l*f,d=t*Math.pow(f-1,3);return f*(_+f*y)-d},rE=(t,e,r,l,f)=>(t-=f,e-=f,r-=f,l-=f,oE(l-3*r+3*e-t,3*r-6*e+3*t,3*e-3*t,t).filter(y=>y>=0&&y<=1)),aE=(t,e,r)=>{const l=e*e-4*t*r;return l<0?[]:[(-e+Math.sqrt(l))/(2*t),(-e-Math.sqrt(l))/(2*t)]},oE=(t,e,r,l)=>{if(t===0)return aE(e,r,l);e/=t,r/=t,l/=t;const f=(3*r-e*e)/3,_=(2*e*e*e-9*e*r+27*l)/27;if(f===0)return[Math.pow(-_,1/3)];if(_===0)return[Math.sqrt(-f),-Math.sqrt(-f)];const y=Math.pow(_/2,2)+Math.pow(f/3,3);if(y===0)return[Math.pow(_/2,1/2)-e/3];if(y>0)return[Math.pow(-(_/2)+Math.sqrt(y),1/3)-Math.pow(_/2+Math.sqrt(y),1/3)-e/3];const d=Math.sqrt(Math.pow(-(f/3),3)),A=Math.acos(-(_/(2*Math.sqrt(Math.pow(-(f/3),3))))),j=2*Math.pow(d,1/3);return[j*Math.cos(A/3)-e/3,j*Math.cos((A+2*Math.PI)/3)-e/3,j*Math.cos((A+4*Math.PI)/3)-e/3]};class lE{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(e){var r;return new cE(this,this.newID(),e.name,(r=e.priority)!==null&&r!==void 0?r:0,!!e.disableScroll)}createBlocker(e={}){return new uE(this,this.newID(),e.disable,!!e.disableScroll)}start(e,r,l){return this.canStart(e)?(this.requestedStart.set(r,l),!0):(this.requestedStart.delete(r),!1)}capture(e,r,l){if(!this.start(e,r,l))return!1;const f=this.requestedStart;let _=-1e4;if(f.forEach(y=>{_=Math.max(_,y)}),_===l){this.capturedId=r,f.clear();const y=new CustomEvent("ionGestureCaptured",{detail:{gestureName:e}});return document.dispatchEvent(y),!0}return f.delete(r),!1}release(e){this.requestedStart.delete(e),this.capturedId===e&&(this.capturedId=void 0)}disableGesture(e,r){let l=this.disabledGestures.get(e);l===void 0&&(l=new Set,this.disabledGestures.set(e,l)),l.add(r)}enableGesture(e,r){const l=this.disabledGestures.get(e);l!==void 0&&l.delete(r)}disableScroll(e){this.disabledScroll.add(e),this.disabledScroll.size===1&&document.body.classList.add($y)}enableScroll(e){this.disabledScroll.delete(e),this.disabledScroll.size===0&&document.body.classList.remove($y)}canStart(e){return!(this.capturedId!==void 0||this.isDisabled(e))}isCaptured(){return this.capturedId!==void 0}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(e){const r=this.disabledGestures.get(e);return!!(r&&r.size>0)}newID(){return this.gestureId++,this.gestureId}}class cE{constructor(e,r,l,f,_){this.id=r,this.name=l,this.disableScroll=_,this.priority=f*1e6+r,this.ctrl=e}canStart(){return this.ctrl?this.ctrl.canStart(this.name):!1}start(){return this.ctrl?this.ctrl.start(this.name,this.id,this.priority):!1}capture(){if(!this.ctrl)return!1;const e=this.ctrl.capture(this.name,this.id,this.priority);return e&&this.disableScroll&&this.ctrl.disableScroll(this.id),e}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class uE{constructor(e,r,l,f){this.id=r,this.disable=l,this.disableScroll=f,this.ctrl=e}block(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.disableGesture(e,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.enableGesture(e,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const $y="backdrop-no-scroll",hE=new lE;const Nd=(t,e,r,l)=>{const f=dE(t)?{capture:!1,passive:!!l.passive}:!1;let _,y;return t.__zone_symbol__addEventListener?(_="__zone_symbol__addEventListener",y="__zone_symbol__removeEventListener"):(_="addEventListener",y="removeEventListener"),t[_](e,r,f),()=>{t[y](e,r,f)}},dE=t=>{if(cy===void 0)try{const e=Object.defineProperty({},"passive",{get:()=>{cy=!0}});t.addEventListener("optsTest",()=>{},e)}catch{cy=!1}return!!cy};let cy;const fE=2e3,pE=(t,e,r,l,f)=>{let _,y,d,A,j,B,N,V=0;const Q=ke=>{V=Date.now()+fE,e(ke)&&(!y&&r&&(y=Nd(t,"touchmove",r,f)),d||(d=Nd(ke.target,"touchend",J,f)),A||(A=Nd(ke.target,"touchcancel",J,f)))},ne=ke=>{V>Date.now()||e(ke)&&(!B&&r&&(B=Nd(Ib(t),"mousemove",r,f)),N||(N=Nd(Ib(t),"mouseup",ye,f)))},J=ke=>{re(),l&&l(ke)},ye=ke=>{ge(),l&&l(ke)},re=()=>{y&&y(),d&&d(),A&&A(),y=d=A=void 0},ge=()=>{B&&B(),N&&N(),B=N=void 0},le=()=>{re(),ge()},me=(ke=!0)=>{ke?(_||(_=Nd(t,"touchstart",Q,f)),j||(j=Nd(t,"mousedown",ne,f))):(_&&_(),j&&j(),_=j=void 0,le())};return{enable:me,stop:le,destroy:()=>{me(!1),l=r=e=void 0}}},Ib=t=>t instanceof Document?t:t.ownerDocument,mE=(t,e,r)=>{const l=r*(Math.PI/180),f=t==="x",_=Math.cos(l),y=e*e;let d=0,A=0,j=!1,B=0;return{start(N,V){d=N,A=V,B=0,j=!0},detect(N,V){if(!j)return!1;const Q=N-d,ne=V-A,J=Q*Q+ne*ne;if(J<y)return!1;const ye=Math.sqrt(J),re=(f?Q:ne)/ye;return re>_?B=1:re<-_?B=-1:B=0,j=!1,!0},isGesture(){return B!==0},getDirection(){return B}}},hx=t=>{let e=!1,r=!1,l=!0,f=!1;const _=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},t),y=_.canStart,d=_.onWillStart,A=_.onStart,j=_.onEnd,B=_.notCaptured,N=_.onMove,V=_.threshold,Q=_.passive,ne=_.blurOnStart,J={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},ye=mE(_.direction,_.threshold,_.maxAngle),re=hE.createGesture({name:t.gestureName,priority:t.gesturePriority,disableScroll:t.disableScroll}),ge=Ye=>{const Mt=n1(Ye);return r||!l||(i1(Ye,J),J.startX=J.currentX,J.startY=J.currentY,J.startTime=J.currentTime=Mt,J.velocityX=J.velocityY=J.deltaX=J.deltaY=0,J.event=Ye,y&&y(J)===!1)||(re.release(),!re.start())?!1:(r=!0,V===0?be():(ye.start(J.startX,J.startY),!0))},le=Ye=>{if(e){!f&&l&&(f=!0,B_(J,Ye),requestAnimationFrame(me));return}B_(J,Ye),ye.detect(J.currentX,J.currentY)&&(!ye.isGesture()||!be())&&lt()},me=()=>{e&&(f=!1,N&&N(J))},be=()=>re.capture()?(e=!0,l=!1,J.startX=J.currentX,J.startY=J.currentY,J.startTime=J.currentTime,d?d(J).then(Me):Me(),!0):!1,ke=()=>{if(typeof document<"u"){const Ye=document.activeElement;Ye?.blur&&Ye.blur()}},Me=()=>{ne&&ke(),A&&A(J),l=!0},Ue=()=>{e=!1,r=!1,f=!1,l=!0,re.release()},Fe=Ye=>{const Mt=e,et=l;if(Ue(),!!et){if(B_(J,Ye),Mt){j&&j(J);return}B&&B(J)}},He=pE(_.el,ge,le,Fe,{passive:Q}),lt=()=>{Ue(),He.stop(),B&&B(J)};return{enable(Ye=!0){Ye||(e&&Fe(void 0),Ue()),He.enable(Ye)},destroy(){re.destroy(),He.destroy()}}},B_=(t,e)=>{if(!e)return;const r=t.currentX,l=t.currentY,f=t.currentTime;i1(e,t);const _=t.currentX,y=t.currentY,A=(t.currentTime=n1(e))-f;if(A>0&&A<100){const j=(_-r)/A,B=(y-l)/A;t.velocityX=j*.7+t.velocityX*.3,t.velocityY=B*.7+t.velocityY*.3}t.deltaX=_-t.startX,t.deltaY=y-t.startY,t.event=e},i1=(t,e)=>{let r=0,l=0;if(t){const f=t.changedTouches;if(f&&f.length>0){const _=f[0];r=_.clientX,l=_.clientY}else t.pageX!==void 0&&(r=t.pageX,l=t.pageY)}e.currentX=r,e.currentY=l},n1=t=>t.timeStamp||Date.now();const gE=t=>s1(t),qh=(t,e)=>(typeof t=="string"&&(e=t,t=void 0),gE(t).includes(e)),s1=(t=window)=>{if(typeof t>"u")return[];t.Ionic=t.Ionic||{};let e=t.Ionic.platforms;return e==null&&(e=t.Ionic.platforms=yE(t),e.forEach(r=>t.document.documentElement.classList.add(`plt-${r}`))),e},yE=t=>{const e=xn.get("platform");return Object.keys(Lb).filter(r=>{const l=e?.[r];return typeof l=="function"?l(t):Lb[r](t)})},_E=t=>s_(t)&&!a1(t),dx=t=>!!(Jd(t,/iPad/i)||Jd(t,/Macintosh/i)&&s_(t)),vE=t=>Jd(t,/iPhone/i),xE=t=>Jd(t,/iPhone|iPod/i)||dx(t),r1=t=>Jd(t,/android|sink/i),bE=t=>r1(t)&&!Jd(t,/mobile/i),wE=t=>{const e=t.innerWidth,r=t.innerHeight,l=Math.min(e,r),f=Math.max(e,r);return l>390&&l<520&&f>620&&f<800},SE=t=>{const e=t.innerWidth,r=t.innerHeight,l=Math.min(e,r),f=Math.max(e,r);return dx(t)||bE(t)||l>460&&l<820&&f>780&&f<1400},s_=t=>CE(t,"(any-pointer:coarse)"),TE=t=>!s_(t),a1=t=>o1(t)||l1(t),o1=t=>!!(t.cordova||t.phonegap||t.PhoneGap),l1=t=>{const e=t.Capacitor;return!!(e?.isNative||e?.isNativePlatform&&e.isNativePlatform())},EE=t=>Jd(t,/electron/i),kE=t=>{var e;return!!(!((e=t.matchMedia)===null||e===void 0)&&e.call(t,"(display-mode: standalone)").matches||t.navigator.standalone)},Jd=(t,e)=>e.test(t.navigator.userAgent),CE=(t,e)=>{var r;return(r=t.matchMedia)===null||r===void 0?void 0:r.call(t,e).matches},Lb={ipad:dx,iphone:vE,ios:xE,android:r1,phablet:wE,tablet:SE,cordova:o1,capacitor:l1,electron:EE,pwa:kE,mobile:s_,mobileweb:_E,desktop:TE,hybrid:a1};let Yf;const Cs=t=>t&&hT(t)||Yf,AE=(t={})=>{if(typeof window>"u")return;const e=window.document,r=window,l=r.Ionic=r.Ionic||{},f=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},zT(r)),{persistConfig:!1}),l.config),DT(r)),t);xn.reset(f),xn.getBoolean("persistConfig")&&RT(r,f),s1(r),l.config=xn,l.mode=Yf=xn.get("mode",e.documentElement.getAttribute("mode")||(qh(r,"ios")?"ios":"md")),xn.set("mode",Yf),e.documentElement.setAttribute("mode",Yf),e.documentElement.classList.add(Yf),xn.getBoolean("_testing")&&xn.set("animated",!1);const _=d=>{var A;return(A=d.tagName)===null||A===void 0?void 0:A.startsWith("ION-")},y=d=>["ios","md"].includes(d);uT(d=>{for(;d;){const A=d.mode||d.getAttribute("mode");if(A){if(y(A))return A;_(d)&&jl('Invalid ionic mode: "'+A+'", expected: "ios" or "md"')}d=d.parentElement}return Yf})};const ME=t=>{try{if(t instanceof LE)return t.value;if(!PE()||typeof t!="string"||t==="")return t;if(t.includes("onload="))return"";const e=document.createDocumentFragment(),r=document.createElement("div");e.appendChild(r),r.innerHTML=t,IE.forEach(y=>{const d=e.querySelectorAll(y);for(let A=d.length-1;A>=0;A--){const j=d[A];j.parentNode?j.parentNode.removeChild(j):e.removeChild(j);const B=kv(j);for(let N=0;N<B.length;N++)Ev(B[N])}});const l=kv(e);for(let y=0;y<l.length;y++)Ev(l[y]);const f=document.createElement("div");f.appendChild(e);const _=f.querySelector("div");return _!==null?_.innerHTML:f.innerHTML}catch(e){return Ju("sanitizeDOMString",e),""}},Ev=t=>{if(t.nodeType&&t.nodeType!==1)return;if(typeof NamedNodeMap<"u"&&!(t.attributes instanceof NamedNodeMap)){t.remove();return}for(let r=t.attributes.length-1;r>=0;r--){const l=t.attributes.item(r),f=l.name;if(!jE.includes(f.toLowerCase())){t.removeAttribute(f);continue}const _=l.value,y=t[f];(_!=null&&_.toLowerCase().includes("javascript:")||y!=null&&y.toLowerCase().includes("javascript:"))&&t.removeAttribute(f)}const e=kv(t);for(let r=0;r<e.length;r++)Ev(e[r])},kv=t=>t.children!=null?t.children:t.childNodes,PE=()=>{var t;const e=window,r=(t=e?.Ionic)===null||t===void 0?void 0:t.config;return r?r.get?r.get("sanitizerEnabled",!0):r.sanitizerEnabled===!0||r.sanitizerEnabled===void 0:!0},jE=["class","id","href","src","name","slot"],IE=["script","style","iframe","meta","link","object","embed"];class LE{constructor(e){this.value=e}}const zE=!1;const Cv=(t,e)=>e.closest(t)!==null,Km=(t,e)=>typeof t=="string"&&t.length>0?Object.assign({"ion-color":!0,[`ion-color-${t}`]:!0},e):e,RE=t=>t!==void 0?(Array.isArray(t)?t:t.split(" ")).filter(r=>r!=null).map(r=>r.trim()).filter(r=>r!==""):[],c1=t=>{const e={};return RE(t).forEach(r=>e[r]=!0),e},DE=/^[a-z][a-z0-9+\-.]*:/,OE=async(t,e,r,l)=>{if(t!=null&&t[0]!=="#"&&!DE.test(t)){const f=document.querySelector("ion-router");if(f)return e?.preventDefault(),f.push(t,r,l)}return!1};const Nm=()=>xn.get("experimentalCloseWatcher",!1)&&$s!==void 0&&"CloseWatcher"in $s,NE=()=>{document.addEventListener("backbutton",()=>{})},BE=()=>{const t=document;let e=!1;const r=()=>{if(e)return;let l=0,f=[];const _=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(A,j){f.push({priority:A,handler:j,id:l++})}}});t.dispatchEvent(_);const y=async A=>{try{if(A?.handler){const j=A.handler(d);j!=null&&await j}}catch(j){Ju("[ion-app] - Exception in startHardwareBackButton:",j)}},d=()=>{if(f.length>0){let A={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};f.forEach(j=>{j.priority>=A.priority&&(A=j)}),e=!0,f=f.filter(j=>j.id!==A.id),y(A).then(()=>e=!1)}};d()};if(Nm()){let l;const f=()=>{l?.destroy(),l=new $s.CloseWatcher,l.onclose=()=>{r(),f()}};f()}else t.addEventListener("backbutton",r)},u1=100,$E=99,UE=Object.freeze(Object.defineProperty({__proto__:null,MENU_BACK_BUTTON_PRIORITY:$E,OVERLAY_BACK_BUTTON_PRIORITY:u1,blockHardwareBackButton:NE,shouldUseCloseWatcher:Nm,startHardwareBackButton:BE},Symbol.toStringTag,{value:"Module"}));const r_=async(t,e,r,l,f,_)=>{var y;if(t)return t.attachViewToDom(e,r,f,l);if(!_&&typeof r!="string"&&!(r instanceof HTMLElement))throw new Error("framework delegate is missing");const d=typeof r=="string"?(y=e.ownerDocument)===null||y===void 0?void 0:y.createElement(r):r;return l&&l.forEach(A=>d.classList.add(A)),f&&Object.assign(d,f),e.appendChild(d),await new Promise(A=>Kd(d,A)),d},h1=(t,e)=>{if(e){if(t){const r=e.parentElement;return t.removeViewFromDom(r,e)}e.remove()}return Promise.resolve()},d1=()=>{let t,e;return{attachViewToDom:async(f,_,y={},d=[])=>{var A,j;t=f;let B;if(_){const V=typeof _=="string"?(A=t.ownerDocument)===null||A===void 0?void 0:A.createElement(_):_;d.forEach(Q=>V.classList.add(Q)),Object.assign(V,y),t.appendChild(V),B=V,await new Promise(Q=>Kd(V,Q))}else if(t.children.length>0&&(t.tagName==="ION-MODAL"||t.tagName==="ION-POPOVER")&&!(B=t.children[0]).classList.contains("ion-delegate-host")){const Q=(j=t.ownerDocument)===null||j===void 0?void 0:j.createElement("div");Q.classList.add("ion-delegate-host"),d.forEach(ne=>Q.classList.add(ne)),Q.append(...t.children),t.appendChild(Q),B=Q}const N=document.querySelector("ion-app")||document.body;return e=document.createComment("ionic teleport"),t.parentNode.insertBefore(e,t),N.appendChild(t),B??t},removeViewFromDom:()=>(t&&e&&(e.parentNode.insertBefore(t,e),e.remove()),Promise.resolve())}};const Jm='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-checkbox:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-radio:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',zb=(t,e)=>{const r=t.querySelector(Jm);f1(r,e??t)},Rb=(t,e)=>{const r=Array.from(t.querySelectorAll(Jm)),l=r.length>0?r[r.length-1]:null;f1(l,e??t)},f1=(t,e)=>{let r=t;const l=t?.shadowRoot;if(l&&(r=l.querySelector(Jm)||t),r){const f=r.closest("ion-radio-group");f?f.setFocus():Zw(r)}else e.focus()};let Av=0,FE=0;const Uy=new WeakMap,Mv=t=>{var e;return t.showBackdrop!==!1&&!(((e=t.backdropBreakpoint)!==null&&e!==void 0?e:0)>0)},VE=t=>({create(e){return HE(t,e)},dismiss(e,r,l){return YE(document,e,r,t,l)},async getTop(){return Bm(document,t)}}),qE=VE("ion-toast"),p1=t=>{typeof document<"u"&&WE(document);const e=Av++;t.overlayIndex=e},m1=t=>(t.hasAttribute("id")||(t.id=`ion-overlay-${++FE}`),t.id),HE=(t,e)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(t).then(()=>{const r=document.createElement(t);return r.classList.add("overlay-hidden"),Object.assign(r,Object.assign(Object.assign({},e),{hasController:!0})),fx(document).appendChild(r),new Promise(l=>Kd(r,l))}):Promise.resolve(),ZE=t=>t.classList.contains("overlay-hidden"),Db=(t,e)=>{let r=t;const l=t?.shadowRoot;l&&(r=l.querySelector(Jm)||t),r?Zw(r):e.focus()},GE=(t,e)=>{const r=Bm(e,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover"),l=t.target;if(!r||!l||r.classList.contains(qy))return;const f=()=>{if(r===l)r.lastFocus=void 0;else if(l.tagName==="ION-TOAST")Db(r.lastFocus,r);else{const y=Pr(r);if(!y.contains(l))return;const d=y.querySelector(".ion-overlay-wrapper");if(!d)return;if(d.contains(l)||l===y.querySelector("ion-backdrop"))r.lastFocus=l;else{const A=r.lastFocus;zb(d,r),A===e.activeElement&&Rb(d,r),r.lastFocus=e.activeElement}}},_=()=>{if(r.contains(l))r.lastFocus=l;else if(l.tagName==="ION-TOAST")Db(r.lastFocus,r);else{const y=r.lastFocus;zb(r),y===e.activeElement&&Rb(r),r.lastFocus=e.activeElement}};r.shadowRoot?_():f()},WE=t=>{Av===0&&(Av=1,t.addEventListener("focus",e=>{GE(e,t)},!0),t.addEventListener("ionBackButton",e=>{const r=Bm(t);r?.backdropDismiss&&e.detail.register(u1,()=>{r.dismiss(void 0,Vy)})}),Nm()||t.addEventListener("keydown",e=>{if(e.key==="Escape"){const r=Bm(t);r?.backdropDismiss&&r.dismiss(void 0,Vy)}}))},YE=(t,e,r,l,f)=>{const _=Bm(t,l,f);return _?_.dismiss(e,r):Promise.reject("overlay does not exist")},XE=(t,e)=>(e===void 0&&(e="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover,ion-toast"),Array.from(t.querySelectorAll(e)).filter(r=>r.overlayIndex>0)),g1=(t,e)=>XE(t,e).filter(r=>!ZE(r)),Bm=(t,e,r)=>{const l=g1(t,e);return(r===void 0?l:l.filter(f=>f.id===r)).slice(-1)[0]},y1=(t=!1)=>{const r=fx(document).querySelector("ion-router-outlet, #ion-view-container-root");r&&(t?r.setAttribute("aria-hidden","true"):r.removeAttribute("aria-hidden"))},_1=async(t,e,r,l,f)=>{var _,y;if(t.presented)return;t.el.tagName!=="ION-TOAST"&&KE(t.el);const d=t.el,j=d.tagName!=="ION-TOAST"&&d.focusTrap!==!1&&Mv(d);if(t.presented=!0,t.willPresent.emit(),j){const ne=fx(document).querySelector("ion-router-outlet, #ion-view-container-root");ne&&ne.contains(d)||y1(!0),document.body.classList.add($y)}(_=t.willPresentShorthand)===null||_===void 0||_.emit();const B=Cs(t),N=t.enterAnimation?t.enterAnimation:xn.get(e,B==="ios"?r:l);await x1(t,N,t.el,f)&&(t.didPresent.emit(),(y=t.didPresentShorthand)===null||y===void 0||y.emit()),t.keyboardClose&&(document.activeElement===null||!t.el.contains(document.activeElement))&&t.el.focus(),t.el.removeAttribute("aria-hidden"),t.el.removeAttribute("inert")},KE=async t=>{let e=document.activeElement;if(!e)return;e.blur();const r=e?.shadowRoot;r&&(e=r.querySelector(Jm)||e),await t.onDidDismiss(),(document.activeElement===null||document.activeElement===document.body)&&e.focus()},v1=async(t,e,r,l,f,_,y)=>{var d,A;if(!t.presented)return!1;const B=(Mm!==void 0?g1(Mm):[]).filter(ne=>{const J=ne;return J.tagName!=="ION-TOAST"&&J.focusTrap!==!1&&Mv(J)}),N=t.el;N.tagName!=="ION-TOAST"&&N.focusTrap!==!1&&Mv(N)&&B.length===1&&B[0].id===N.id&&(y1(!1),document.body.classList.remove($y)),t.presented=!1;try{t.el.style.setProperty("pointer-events","none"),t.willDismiss.emit({data:e,role:r}),(d=t.willDismissShorthand)===null||d===void 0||d.emit({data:e,role:r});const ne=Cs(t),J=t.leaveAnimation?t.leaveAnimation:xn.get(l,ne==="ios"?f:_);r!==rp&&await x1(t,J,t.el,y),t.didDismiss.emit({data:e,role:r}),(A=t.didDismissShorthand)===null||A===void 0||A.emit({data:e,role:r}),(Uy.get(t)||[]).forEach(re=>re.destroy()),Uy.delete(t),t.el.classList.add("overlay-hidden"),t.el.style.removeProperty("pointer-events"),t.el.lastFocus!==void 0&&(t.el.lastFocus=void 0)}catch(ne){Ju(`[${t.el.tagName.toLowerCase()}] - `,ne)}return t.el.remove(),!0},fx=t=>t.querySelector("ion-app")||t.body,x1=async(t,e,r,l)=>{r.classList.remove("overlay-hidden");const f=t.el,_=e(f,l);(!t.animated||!xn.getBoolean("animated",!0))&&_.duration(0),t.keyboardClose&&_.beforeAddWrite(()=>{const d=r.ownerDocument.activeElement;d?.matches("input,ion-input, ion-textarea")&&d.blur()});const y=Uy.get(t)||[];return Uy.set(t,[...y,_]),await _.play(),!0},Fy=(t,e)=>{let r;const l=new Promise(f=>r=f);return JE(t,e,f=>{r(f.detail)}),l},JE=(t,e,r)=>{const l=f=>{FT(t,e,l),r(f)};UT(t,e,l)},Pv=t=>t==="cancel"||t===Vy,QE=t=>t(),ek=(t,e)=>{if(typeof t=="function")return xn.get("_zoneGate",QE)(()=>{try{return t(e)}catch(l){throw l}})},Vy="backdrop",rp="gesture",b1=39,tk=t=>{let e=!1,r;const l=d1(),f=(d=!1)=>{if(r&&!d)return{delegate:r,inline:e};const{el:A,hasController:j,delegate:B}=t;return e=A.parentNode!==null&&!j,r=e?B||l:B,{inline:e,delegate:r}};return{attachViewToDom:async d=>{const{delegate:A}=f(!0);if(A)return await A.attachViewToDom(t.el,d);const{hasController:j}=t;if(j&&d!==void 0)throw new Error("framework delegate is missing");return null},removeViewFromDom:()=>{const{delegate:d}=f();d&&t.el!==void 0&&d.removeViewFromDom(t.el.parentElement,t.el)}}},w1=()=>{let t;const e=()=>{t&&(t(),t=void 0)};return{addClickListener:(l,f)=>{e();const _=f!==void 0?document.getElementById(f):null;if(!_){jl(`[${l.tagName.toLowerCase()}] - A trigger element with the ID "${f}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,l);return}t=((d,A)=>{const j=()=>{A.present()};return d.addEventListener("click",j),()=>{d.removeEventListener("click",j)}})(_,l)},removeClickListener:e}},qy="ion-disable-focus-trap";var S1=kw();const ik=Xh(S1);const nk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M244 400 100 256l144-144M120 256h292' stroke-linecap='square' stroke-miterlimit='10' stroke-width='48px' class='ionicon-fill-none'/></svg>",sk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M328 112 184 256l144 144' stroke-linecap='round' stroke-linejoin='round' stroke-width='48px' class='ionicon-fill-none'/></svg>";let $_;const rk=()=>{if(typeof window>"u")return new Map;if(!$_){const t=window;t.Ionicons=t.Ionicons||{},$_=t.Ionicons.map=t.Ionicons.map||new Map}return $_},ak=t=>{let e=U_(t.src);return e||(e=T1(t.name,t.icon,t.mode,t.ios,t.md),e?ok(e,t):t.icon&&(e=U_(t.icon),e||(e=U_(t.icon[t.mode]),e))?e:null)},ok=(t,e)=>{const r=rk().get(t);if(r)return r;try{return H2(`svg/${t}.svg`)}catch(l){console.log("e",l),console.warn(`[Ionicons Warning]: Could not load icon with name "${t}". Ensure that the icon is registered using addIcons or that the icon SVG data is passed directly to the icon component.`,e)}},T1=(t,e,r,l,f)=>(r=(r&&uy(r))==="ios"?"ios":"md",l&&r==="ios"?t=uy(l):f&&r==="md"?t=uy(f):(!t&&e&&!E1(e)&&(t=e),Hy(t)&&(t=uy(t))),!Hy(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),U_=t=>Hy(t)&&(t=t.trim(),E1(t))?t:null,E1=t=>t.length>0&&/(\/|\.)/.test(t),Hy=t=>typeof t=="string",uy=t=>t.toLowerCase(),lk=(t,e=[])=>{const r={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(r[l]=t.getAttribute(l)),t.removeAttribute(l))}),r},ck=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl",uk=t=>{const e=document.createElement("div");e.innerHTML=t;for(let l=e.childNodes.length-1;l>=0;l--)e.childNodes[l].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[l]);const r=e.firstElementChild;if(r&&r.nodeName.toLowerCase()==="svg"){const l=r.getAttribute("class")||"";if(r.setAttribute("class",(l+" s-ion-icon").trim()),k1(r))return e.innerHTML}return""},k1=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const r=t.attributes[e].name;if(Hy(r)&&r.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!k1(t.childNodes[e]))return!1}return!0},hk=t=>t.startsWith("data:image/svg+xml"),dk=t=>t.indexOf(";utf8,")!==-1,ap=new Map,C1=new Map;let F_;function jv(t){return ap.set(t,""),""}const fk=(t,e)=>{const r=C1.get(t);return r||(typeof fetch<"u"&&typeof document<"u"?hk(t)&&dk(t)?Promise.resolve(pk(t)):mk(t,e):Promise.resolve(jv(t)))};function pk(t){F_||(F_=new DOMParser);const r=F_.parseFromString(t,"text/html").querySelector("svg");if(r)return ap.set(t,r.outerHTML),r.outerHTML;throw new Error(`Could not parse svg from ${t}`)}function mk(t,e){const r=fetch(t).then(l=>l.text().then(f=>{f&&e!==!1&&(f=uk(f));const _=f||"";return ap.set(t,_),_}).catch(()=>jv(t))).catch(()=>jv(t));return C1.set(t,r),r}const gk=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:1.125rem !important}:host(.icon-large){font-size:2rem !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",yk=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.didLoadIcon=!1,this.isVisible=!1,this.mode=_k(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=lk(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}componentDidLoad(){this.didLoadIcon||this.loadIcon()}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,r,l){if(!!!(this.lazy&&typeof window<"u"&&window.IntersectionObserver))return l();const _=this.io=new window.IntersectionObserver(y=>{y[0].isIntersecting&&(_.disconnect(),this.io=void 0,l())},{rootMargin:r});_.observe(e)}loadIcon(){if(this.isVisible){const e=ak(this);e&&(ap.has(e)?this.svgContent=ap.get(e):fk(e,this.sanitize).then(()=>this.svgContent=ap.get(e)),this.didLoadIcon=!0)}this.iconName=T1(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:r,inheritedAttributes:l,el:f}=this,_=this.mode||"md",y=r?(r.includes("arrow")||r.includes("chevron"))&&e!==!1:!1,d=e||y;return wi(Yo,Object.assign({key:"0578c899781ca145dd8205acd9670af39b57cf2e",role:"img",class:Object.assign(Object.assign({[_]:!0},vk(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":d,"icon-rtl":d&&ck(f)})},l),this.svgContent?wi("div",{class:"icon-inner",innerHTML:this.svgContent}):wi("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return gk}},[257,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},void 0,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]),_k=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",vk=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function A1(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{e==="ion-icon"&&(customElements.get(e)||customElements.define(e,yk))})}const xk=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",bk=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",wk=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionBackdropTap=qn(this,"ionBackdropTap",7),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}onMouseDown(e){this.emitTap(e)}emitTap(e){this.stopPropagation&&(e.preventDefault(),e.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const e=Cs(this);return wi(Yo,{key:"7abaf2c310aa399607451b14063265e8a5846938","aria-hidden":"true",class:{[e]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:xk,md:bk}}},[289,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]);function Sk(){if(typeof customElements>"u")return;["ion-backdrop"].forEach(e=>{e==="ion-backdrop"&&(customElements.get(e)||customElements.define(e,wk))})}const Tk=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}",Ek=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(e,r){return new Promise(l=>{Ty(()=>{const f=this.el.getBoundingClientRect(),_=f.width,y=f.height,d=Math.sqrt(_*_+y*y),A=Math.max(y,_),j=this.unbounded?A:d+Ck,B=Math.floor(A*Ak),N=j/B;let V=e-f.left,Q=r-f.top;this.unbounded&&(V=_*.5,Q=y*.5);const ne=V-B*.5,J=Q-B*.5,ye=_*.5-V,re=y*.5-Q;zm(()=>{const ge=document.createElement("div");ge.classList.add("ripple-effect");const le=ge.style;le.top=J+"px",le.left=ne+"px",le.width=le.height=B+"px",le.setProperty("--final-scale",`${N}`),le.setProperty("--translate-end",`${ye}px, ${re}px`),(this.el.shadowRoot||this.el).appendChild(ge),setTimeout(()=>{l(()=>{kk(ge)})},325)})})})}get unbounded(){return this.type==="unbounded"}render(){const e=Cs(this);return wi(Yo,{key:"ae9d3b1ed6773a9b9bb2267129f7e9af23b6c9fc",role:"presentation",class:{[e]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return Tk}},[257,"ion-ripple-effect",{type:[1],addRipple:[64]}]),kk=t=>{t.classList.add("fade-out"),setTimeout(()=>{t.remove()},200)},Ck=10,Ak=.5;function px(){if(typeof customElements>"u")return;["ion-ripple-effect"].forEach(e=>{e==="ion-ripple-effect"&&(customElements.get(e)||customElements.define(e,Ek))})}const hy=typeof window<"u"?window:void 0;hy&&(hy.CSS&&hy.CSS.supports&&hy.CSS.supports("--a: 0"));const Mk=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl";const Pk=':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-ms-touch-action:pan-x pan-y pinch-zoom;touch-action:pan-x pan-y pinch-zoom}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;z-index:0;will-change:scroll-position}.scroll-y{overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{overflow-x:var(--overflow);overscroll-behavior-x:contain}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:0;contain:none}:host(.content-sizing) .inner-scroll{position:relative;top:0;bottom:0;margin-top:calc(var(--offset-top) * -1);margin-bottom:calc(var(--offset-bottom) * -1)}.transition-effect{display:none;position:absolute;width:100%;height:100vh;opacity:0;pointer-events:none}:host(.content-ltr) .transition-effect{left:-100%;}:host(.content-rtl) .transition-effect{right:-100%;}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;width:100%;height:100%;-webkit-box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03);box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03)}:host(.content-ltr) .transition-shadow{right:0;}:host(.content-rtl) .transition-shadow{left:0;-webkit-transform:scaleX(-1);transform:scaleX(-1)}::slotted([slot=fixed]){position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}',jk=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionScrollStart=qn(this,"ionScrollStart",7),this.ionScroll=qn(this,"ionScroll",7),this.ionScrollEnd=qn(this,"ionScrollEnd",7),this.watchDog=null,this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.isMainContent=!0,this.resizeTimeout=null,this.inheritedAttributes={},this.tabsElement=null,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.fullscreen=!1,this.fixedSlotPlacement="after",this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1}componentWillLoad(){this.inheritedAttributes=Hw(this.el)}connectedCallback(){if(this.isMainContent=this.el.closest("ion-menu, ion-popover, ion-modal")===null,Oy(this.el)){const e=this.tabsElement=this.el.closest("ion-tabs");e!==null&&(this.tabsLoadCallback=()=>this.resize(),e.addEventListener("ionTabBarLoaded",this.tabsLoadCallback))}}disconnectedCallback(){if(this.onScrollEnd(),Oy(this.el)){const{tabsElement:e,tabsLoadCallback:r}=this;e!==null&&r!==void 0&&e.removeEventListener("ionTabBarLoaded",r),this.tabsElement=null,this.tabsLoadCallback=void 0}}onResize(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeTimeout=setTimeout(()=>{this.el.offsetParent!==null&&this.resize()},100)}shouldForceOverscroll(){const{forceOverscroll:e}=this,r=Cs(this);return e===void 0?r==="ios"&&qh("ios"):e}resize(){this.fullscreen?Ty(()=>this.readDimensions()):(this.cTop!==0||this.cBottom!==0)&&(this.cTop=this.cBottom=0,kb(this))}async recalculateDimensions(){Ty(()=>this.readDimensions())}readDimensions(){const e=Lk(this.el),r=Math.max(this.el.offsetTop,0),l=Math.max(e.offsetHeight-r-this.el.offsetHeight,0);(r!==this.cTop||l!==this.cBottom)&&(this.cTop=r,this.cBottom=l,kb(this))}onScroll(e){const r=Date.now(),l=!this.isScrolling;this.lastScroll=r,l&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,Ty(f=>{this.queued=!1,this.detail.event=e,zk(this.detail,this.scrollEl,f,l),this.ionScroll.emit(this.detail)}))}async getScrollElement(){return this.scrollEl||await new Promise(e=>Kd(this.el,e)),Promise.resolve(this.scrollEl)}async getBackgroundElement(){return this.backgroundContentEl||await new Promise(e=>Kd(this.el,e)),Promise.resolve(this.backgroundContentEl)}scrollToTop(e=0){return this.scrollToPoint(void 0,0,e)}async scrollToBottom(e=0){const r=await this.getScrollElement(),l=r.scrollHeight-r.clientHeight;return this.scrollToPoint(void 0,l,e)}async scrollByPoint(e,r,l){const f=await this.getScrollElement();return this.scrollToPoint(e+f.scrollLeft,r+f.scrollTop,l)}async scrollToPoint(e,r,l=0){const f=await this.getScrollElement();if(l<32){r!=null&&(f.scrollTop=r),e!=null&&(f.scrollLeft=e);return}let _,y=0;const d=new Promise(Q=>_=Q),A=f.scrollTop,j=f.scrollLeft,B=r!=null?r-A:0,N=e!=null?e-j:0,V=Q=>{const ne=Math.min(1,(Q-y)/l)-1,J=Math.pow(ne,3)+1;B!==0&&(f.scrollTop=Math.floor(J*B+A)),N!==0&&(f.scrollLeft=Math.floor(J*N+j)),J<1?requestAnimationFrame(V):_()};return requestAnimationFrame(Q=>{y=Q,V(Q)}),d}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval(()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()},100)}onScrollEnd(){this.watchDog&&clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{fixedSlotPlacement:e,inheritedAttributes:r,isMainContent:l,scrollX:f,scrollY:_,el:y}=this,d=Mk(y)?"rtl":"ltr",A=Cs(this),j=this.shouldForceOverscroll(),B=A==="ios";return this.resize(),wi(Yo,Object.assign({key:"cd8781f848d8dc926fe66f43d43c49564425a507",role:l?"main":void 0,class:Km(this.color,{[A]:!0,"content-sizing":Cv("ion-popover",this.el),overscroll:j,[`content-${d}`]:!0}),style:{"--offset-top":`${this.cTop}px`,"--offset-bottom":`${this.cBottom}px`}},r),wi("div",{key:"95b112d7cae30f22ef778ceffb88edb4d941c170",ref:N=>this.backgroundContentEl=N,id:"background-content",part:"background"}),e==="before"?wi("slot",{name:"fixed"}):null,wi("div",{key:"2fdfcbc39fb66f11b6191911f2941c660f4c12e5",class:{"inner-scroll":!0,"scroll-x":f,"scroll-y":_,overscroll:(f||_)&&j},ref:N=>this.scrollEl=N,onScroll:this.scrollEvents?N=>this.onScroll(N):void 0,part:"scroll"},wi("slot",{key:"6bc77e0054ec8e21635a7f2abfe0ca46e0962e03"})),B?wi("div",{class:"transition-effect"},wi("div",{class:"transition-cover"}),wi("div",{class:"transition-shadow"})):null,e==="after"?wi("slot",{name:"fixed"}):null)}get el(){return this}static get style(){return Pk}},[257,"ion-content",{color:[513],fullscreen:[4],fixedSlotPlacement:[1,"fixed-slot-placement"],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"],recalculateDimensions:[64],getScrollElement:[64],getBackgroundElement:[64],scrollToTop:[64],scrollToBottom:[64],scrollByPoint:[64],scrollToPoint:[64]},[[9,"resize","onResize"]]]),Ik=t=>{var e;return t.parentElement?t.parentElement:!((e=t.parentNode)===null||e===void 0)&&e.host?t.parentNode.host:null},Lk=t=>{const e=t.closest("ion-tabs");if(e)return e;const r=t.closest("ion-app, ion-page, .ion-page, page-inner, .popover-content");return r||Ik(t)},zk=(t,e,r,l)=>{const f=t.currentX,_=t.currentY,y=t.currentTime,d=e.scrollLeft,A=e.scrollTop,j=r-y;if(l&&(t.startTime=r,t.startX=d,t.startY=A,t.velocityX=t.velocityY=0),t.currentTime=r,t.currentX=t.scrollLeft=d,t.currentY=t.scrollTop=A,t.deltaX=d-t.startX,t.deltaY=A-t.startY,j>0&&j<100){const B=(d-f)/j,N=(A-_)/j;t.velocityX=B*.7+t.velocityX*.3,t.velocityY=N*.7+t.velocityY*.3}};function Rk(){if(typeof customElements>"u")return;["ion-content"].forEach(e=>{e==="ion-content"&&(customElements.get(e)||customElements.define(e,jk))})}const Dk=Rk;const M1=()=>{if($s!==void 0)return $s.Capacitor};const mx=()=>{let t;return{lock:async()=>{const r=t;let l;return t=new Promise(f=>l=f),r!==void 0&&await r,l}}};const Ok="ION-CONTENT",P1="ion-content",j1=".ion-content-scroll-host",I1=`${P1}, ${j1}`,gu=t=>t.tagName===Ok,wD=async t=>gu(t)?(await new Promise(e=>Kd(t,e)),t.getScrollElement()):t,Nk=t=>{const e=t.querySelector(j1);return e||t.querySelector(I1)},Iv=t=>t.closest(I1),SD=(t,e)=>gu(t)?t.scrollToTop(e):Promise.resolve(t.scrollTo({top:0,left:0,behavior:"smooth"})),TD=(t,e,r,l)=>gu(t)?t.scrollByPoint(e,r,l):Promise.resolve(t.scrollBy({top:r,left:e,behavior:l>0?"smooth":"auto"})),Bk=t=>NT(t,P1),Ob=t=>{if(gu(t)){const e=t,r=e.scrollY;return e.scrollY=!1,r}else return t.style.setProperty("overflow","hidden"),!0},$k=(t,e)=>{gu(t)?t.scrollY=e:t.style.removeProperty("overflow")};var Lv;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Lv||(Lv={}));var zv;(function(t){t.Body="body",t.Ionic="ionic",t.Native="native",t.None="none"})(zv||(zv={}));const L1={getEngine(){const t=M1();if(t?.isPluginAvailable("Keyboard"))return t.Plugins.Keyboard},getResizeMode(){const t=this.getEngine();return t?.getResizeMode?t.getResizeMode().catch(e=>{if(e.code!==Lv.Unimplemented)throw e}):Promise.resolve(void 0)}};const z1=t=>{if(Mm===void 0||t===zv.None||t===void 0)return null;const e=Mm.querySelector("ion-app");return e??Mm.body},Nb=t=>{const e=z1(t);return e===null?0:e.clientHeight},Uk=async t=>{let e,r,l,f;const _=async()=>{const B=await L1.getResizeMode(),N=B===void 0?void 0:B.mode;e=()=>{f===void 0&&(f=Nb(N)),l=!0,y(l,N)},r=()=>{l=!1,y(l,N)},$s?.addEventListener("keyboardWillShow",e),$s?.addEventListener("keyboardWillHide",r)},y=(B,N)=>{t&&t(B,d(N))},d=B=>{if(f===0||f===Nb(B))return;const N=z1(B);if(N!==null)return new Promise(V=>{const Q=()=>{N.clientHeight===f&&(ne.disconnect(),V())},ne=new ResizeObserver(Q);ne.observe(N)})},A=()=>{$s?.removeEventListener("keyboardWillShow",e),$s?.removeEventListener("keyboardWillHide",r),e=r=void 0},j=()=>l;return await _(),{init:_,destroy:A,isKeyboardVisible:j}};const Fk={bubbles:{dur:1e3,circles:9,fn:(t,e,r)=>{const l=`${t*e/r-t}ms`,f=2*Math.PI*e/r;return{r:5,style:{top:`${32*Math.sin(f)}%`,left:`${32*Math.cos(f)}%`,"animation-delay":l}}}},circles:{dur:1e3,circles:8,fn:(t,e,r)=>{const l=e/r,f=`${t*l-t}ms`,_=2*Math.PI*l;return{r:5,style:{top:`${32*Math.sin(_)}%`,left:`${32*Math.cos(_)}%`,"animation-delay":f}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(t,e)=>{const r=-(110*e)+"ms";return{r:6,style:{left:`${32-32*e}%`,"animation-delay":r}}}},lines:{dur:1e3,lines:8,fn:(t,e,r)=>{const l=`rotate(${360/r*e+(e<r/2?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:14,y2:26,style:{transform:l,"animation-delay":f}}}},"lines-small":{dur:1e3,lines:8,fn:(t,e,r)=>{const l=`rotate(${360/r*e+(e<r/2?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:12,y2:20,style:{transform:l,"animation-delay":f}}}},"lines-sharp":{dur:1e3,lines:12,fn:(t,e,r)=>{const l=`rotate(${30*e+(e<6?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:17,y2:29,style:{transform:l,"animation-delay":f}}}},"lines-sharp-small":{dur:1e3,lines:12,fn:(t,e,r)=>{const l=`rotate(${30*e+(e<6?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:12,y2:20,style:{transform:l,"animation-delay":f}}}}},Bb=Fk,Vk=":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{-webkit-transform-origin:center;transform-origin:center;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}[dir=rtl] svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}@supports selector(:dir(rtl)){svg:dir(rtl){-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:7px}:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-width:4px}:host(.spinner-lines) line,:host(.spinner-lines-small) line,:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg,:host(.spinner-lines-sharp) svg,:host(.spinner-lines-sharp-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular) svg{-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}",qk=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.paused=!1}getName(){const e=this.name||xn.get("spinner"),r=Cs(this);return e||(r==="ios"?"lines":"circular")}render(){var e;const r=this,l=Cs(r),f=r.getName(),_=(e=Bb[f])!==null&&e!==void 0?e:Bb.lines,y=typeof r.duration=="number"&&r.duration>10?r.duration:_.dur,d=[];if(_.circles!==void 0)for(let A=0;A<_.circles;A++)d.push(Hk(_,y,A,_.circles));else if(_.lines!==void 0)for(let A=0;A<_.lines;A++)d.push(Zk(_,y,A,_.lines));return wi(Yo,{key:"a33d6421fcc885995fbc7a348516525f68ca496c",class:Km(r.color,{[l]:!0,[`spinner-${f}`]:!0,"spinner-paused":r.paused||xn.getBoolean("_testing")}),role:"progressbar",style:_.elmDuration?{animationDuration:y+"ms"}:{}},d)}static get style(){return Vk}},[257,"ion-spinner",{color:[513],duration:[2],name:[1],paused:[4]}]),Hk=(t,e,r,l)=>{const f=t.fn(e,r,l);return f.style["animation-duration"]=e+"ms",wi("svg",{viewBox:f.viewBox||"0 0 64 64",style:f.style},wi("circle",{transform:f.transform||"translate(32,32)",cx:f.cx,cy:f.cy,r:f.r,style:t.elmDuration?{animationDuration:e+"ms"}:{}}))},Zk=(t,e,r,l)=>{const f=t.fn(e,r,l);return f.style["animation-duration"]=e+"ms",wi("svg",{viewBox:f.viewBox||"0 0 64 64",style:f.style},wi("line",{transform:"translate(32,32)",y1:f.y1,y2:f.y2}))};function Gk(){if(typeof customElements>"u")return;["ion-spinner"].forEach(e=>{e==="ion-spinner"&&(customElements.get(e)||customElements.define(e,qk))})}const R1=1,D1=2,Zy=3;class Rv{constructor(e,r){this.component=e,this.params=r,this.state=R1}async init(e){if(this.state=D1,!this.element){const r=this.component;this.element=await r_(this.delegate,e,r,["ion-page","ion-page-invisible"],this.params)}}_destroy(){Ho(this.state!==Zy,"view state must be ATTACHED");const e=this.element;e&&(this.delegate?this.delegate.removeViewFromDom(e.parentElement,e):e.remove()),this.nav=void 0,this.state=Zy}}const $b=(t,e,r)=>!t||t.component!==e?!1:Gw(t.params,r),Ub=(t,e)=>t?t instanceof Rv?t:new Rv(t,e):null,Wk=t=>t.map(e=>e instanceof Rv?e:"component"in e?Ub(e.component,e.componentProps===null?void 0:e.componentProps):Ub(e,void 0)).filter(e=>e!==null),Yk=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",Xk=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=qn(this,"ionNavWillLoad",7),this.ionNavWillChange=qn(this,"ionNavWillChange",3),this.ionNavDidChange=qn(this,"ionNavDidChange",3),this.transInstr=[],this.gestureOrAnimationInProgress=!1,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.animated=!0}swipeGestureChanged(){this.gesture&&this.gesture.enable(this.swipeGesture===!0)}rootChanged(){this.root!==void 0&&this.didLoad!==!1&&(this.useRouter||this.root!==void 0&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=document.querySelector("ion-router")!==null&&this.el.closest("[no-router]")===null,this.swipeGesture===void 0){const e=Cs(this);this.swipeGesture=xn.getBoolean("swipeBackEnabled",e==="ios")}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await Mc(async()=>{const{createSwipeBackGesture:e}=await import("./swipe-back-BkA_VY-8.js");return{createSwipeBackGesture:e}},[])).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const e of this.views)Gu(e.element,N_),e._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(e,r,l,f){return this.insert(-1,e,r,l,f)}insert(e,r,l,f,_){return this.insertPages(e,[{component:r,componentProps:l}],f,_)}insertPages(e,r,l,f){return this.queueTrns({insertStart:e,insertViews:r,opts:l},f)}pop(e,r){return this.removeIndex(-1,1,e,r)}popTo(e,r,l){const f={removeStart:-1,removeCount:-1,opts:r};return typeof e=="object"&&e.component?(f.removeView=e,f.removeStart=1):typeof e=="number"&&(f.removeStart=e+1),this.queueTrns(f,l)}popToRoot(e,r){return this.removeIndex(1,-1,e,r)}removeIndex(e,r=1,l,f){return this.queueTrns({removeStart:e,removeCount:r,opts:l},f)}setRoot(e,r,l,f){return this.setPages([{component:e,componentProps:r}],l,f)}setPages(e,r,l){return r??(r={}),r.animated!==!0&&(r.animated=!1),this.queueTrns({insertStart:0,insertViews:e,removeStart:0,removeCount:-1,opts:r},l)}setRouteId(e,r,l,f){const _=this.getActiveSync();if($b(_,e,r))return Promise.resolve({changed:!1,element:_.element});let y;const d=new Promise(B=>y=B);let A;const j={updateURL:!1,viewIsReady:B=>{let N;const V=new Promise(Q=>N=Q);return y({changed:!0,element:B,markVisible:async()=>{N(),await A}}),V}};if(l==="root")A=this.setRoot(e,r,j);else{const B=this.views.find(N=>$b(N,e,r));B?A=this.popTo(B,Object.assign(Object.assign({},j),{direction:"back",animationBuilder:f})):l==="forward"?A=this.push(e,r,Object.assign(Object.assign({},j),{animationBuilder:f})):l==="back"&&(A=this.setRoot(e,r,Object.assign(Object.assign({},j),{direction:"back",animated:!0,animationBuilder:f})))}return d}async getRouteId(){const e=this.getActiveSync();if(e)return{id:e.element.tagName,params:e.params,element:e.element}}async getActive(){return this.getActiveSync()}async getByIndex(e){return this.views[e]}async canGoBack(e){return this.canGoBackSync(e)}async getPrevious(e){return this.getPreviousSync(e)}async getLength(){return Promise.resolve(this.views.length)}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(e=this.getActiveSync()){return!!(e&&this.getPreviousSync(e))}getPreviousSync(e=this.getActiveSync()){if(!e)return;const r=this.views,l=r.indexOf(e);return l>0?r[l-1]:void 0}async queueTrns(e,r){var l,f;if(this.isTransitioning&&(!((l=e.opts)===null||l===void 0)&&l.skipIfBusy))return!1;const _=new Promise((y,d)=>{e.resolve=y,e.reject=d});if(e.done=r,e.opts&&e.opts.updateURL!==!1&&this.useRouter){const y=document.querySelector("ion-router");if(y){const d=await y.canTransition();if(d===!1)return!1;if(typeof d=="string")return y.push(d,e.opts.direction||"back"),!1}}return((f=e.insertViews)===null||f===void 0?void 0:f.length)===0&&(e.insertViews=void 0),this.transInstr.push(e),this.nextTrns(),_}success(e,r){if(this.destroyed){this.fireError("nav controller was destroyed",r);return}if(r.done&&r.done(e.hasCompleted,e.requiresTransition,e.enteringView,e.leavingView,e.direction),r.resolve(e.hasCompleted),r.opts.updateURL!==!1&&this.useRouter){const l=document.querySelector("ion-router");if(l){const f=e.direction==="back"?"back":"forward";l.navChanged(f)}}}failed(e,r){if(this.destroyed){this.fireError("nav controller was destroyed",r);return}this.transInstr.length=0,this.fireError(e,r)}fireError(e,r){r.done&&r.done(!1,!1,e),r.reject&&!this.destroyed?r.reject(e):r.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const e=this.transInstr.shift();return e?(this.runTransition(e),!0):!1}async runTransition(e){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(e);const r=this.getActiveSync(),l=this.getEnteringView(e,r);if(!r&&!l)throw new Error("no views in the stack to be removed");l&&l.state===R1&&await l.init(this.el),this.postViewInit(l,r,e);const f=(e.enteringRequiresTransition||e.leavingRequiresTransition)&&l!==r;f&&e.opts&&r&&(e.opts.direction==="back"&&(e.opts.animationBuilder=e.opts.animationBuilder||l?.animationBuilder),r.animationBuilder=e.opts.animationBuilder);let _;f?_=await this.transition(l,r,e):_={hasCompleted:!0,requiresTransition:!1},this.success(_,e),this.ionNavDidChange.emit()}catch(r){this.failed(r,e)}this.isTransitioning=!1,this.nextTrns()}prepareTI(e){var r,l,f;const _=this.views.length;if((r=e.opts)!==null&&r!==void 0||(e.opts={}),(l=(f=e.opts).delegate)!==null&&l!==void 0||(f.delegate=this.delegate),e.removeView!==void 0){Ho(e.removeStart!==void 0,"removeView needs removeStart"),Ho(e.removeCount!==void 0,"removeView needs removeCount");const A=this.views.indexOf(e.removeView);if(A<0)throw new Error("removeView was not found");e.removeStart+=A}e.removeStart!==void 0&&(e.removeStart<0&&(e.removeStart=_-1),e.removeCount<0&&(e.removeCount=_-e.removeStart),e.leavingRequiresTransition=e.removeCount>0&&e.removeStart+e.removeCount===_),e.insertViews&&((e.insertStart<0||e.insertStart>_)&&(e.insertStart=_),e.enteringRequiresTransition=e.insertStart===_);const y=e.insertViews;if(!y)return;Ho(y.length>0,"length can not be zero");const d=Wk(y);if(d.length===0)throw new Error("invalid views to insert");for(const A of d){A.delegate=e.opts.delegate;const j=A.nav;if(j&&j!==this)throw new Error("inserted view was already inserted");if(A.state===Zy)throw new Error("inserted view was already destroyed")}e.insertViews=d}getEnteringView(e,r){const l=e.insertViews;if(l!==void 0)return l[l.length-1];const f=e.removeStart;if(f!==void 0){const _=this.views,y=f+e.removeCount;for(let d=_.length-1;d>=0;d--){const A=_[d];if((d<f||d>=y)&&A!==r)return A}}}postViewInit(e,r,l){var f,_,y;Ho(r||e,"Both leavingView and enteringView are null"),Ho(l.resolve,"resolve must be valid"),Ho(l.reject,"reject must be valid");const d=l.opts,{insertViews:A,removeStart:j,removeCount:B}=l;let N;if(j!==void 0&&B!==void 0){Ho(j>=0,"removeStart can not be negative"),Ho(B>=0,"removeCount can not be negative"),N=[];for(let Q=j;Q<j+B;Q++){const ne=this.views[Q];ne!==void 0&&ne!==e&&ne!==r&&N.push(ne)}(f=d.direction)!==null&&f!==void 0||(d.direction="back")}const V=this.views.length+((_=A?.length)!==null&&_!==void 0?_:0)-(B??0);if(Ho(V>=0,"final balance can not be negative"),V===0)throw jl("[ion-nav] - You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(A){let Q=l.insertStart;for(const ne of A)this.insertViewAt(ne,Q),Q++;l.enteringRequiresTransition&&((y=d.direction)!==null&&y!==void 0||(d.direction="forward"))}if(N&&N.length>0){for(const Q of N)Gu(Q.element,Ww),Gu(Q.element,Yw),Gu(Q.element,N_);for(const Q of N)this.destroyView(Q)}}async transition(e,r,l){const f=l.opts,_=f.progressAnimation?N=>{N!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,N.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0}),N.progressEnd(0,0,0)):this.sbAni=N}:void 0,y=Cs(this),d=e.element,A=r&&r.element,j=Object.assign(Object.assign({mode:y,showGoBack:this.canGoBackSync(e),baseEl:this.el,progressCallback:_,animated:this.animated&&xn.getBoolean("animated",!0),enteringEl:d,leavingEl:A},f),{animationBuilder:f.animationBuilder||this.animation||xn.get("navAnimation")}),{hasCompleted:B}=await Kw(j);return this.transitionFinish(B,e,r,f)}transitionFinish(e,r,l,f){const _=e?r:l;return _&&this.unmountInactiveViews(_),{hasCompleted:e,requiresTransition:!0,enteringView:r,leavingView:l,direction:f.direction}}insertViewAt(e,r){const l=this.views,f=l.indexOf(e);f>-1?(Ho(e.nav===this,"view is not part of the nav"),l.splice(f,1),l.splice(r,0,e)):(Ho(!e.nav,"nav is used"),e.nav=this,l.splice(r,0,e))}removeView(e){Ho(e.state===D1||e.state===Zy,"view state should be loaded or destroyed");const r=this.views,l=r.indexOf(e);Ho(l>-1,"view must be part of the stack"),l>=0&&r.splice(l,1)}destroyView(e){e._destroy(),this.removeView(e)}unmountInactiveViews(e){if(this.destroyed)return;const r=this.views,l=r.indexOf(e);for(let f=r.length-1;f>=0;f--){const _=r[f],y=_.element;y&&(f>l?(Gu(y,N_),this.destroyView(_)):f<l&&Tv(y,!0))}}canStart(){return!this.gestureOrAnimationInProgress&&!!this.swipeGesture&&!this.isTransitioning&&this.transInstr.length===0&&this.canGoBackSync()}onStart(){this.gestureOrAnimationInProgress=!0,this.pop({direction:"back",progressAnimation:!0})}onMove(e){this.sbAni&&this.sbAni.progressStep(e)}onEnd(e,r,l){if(this.sbAni){this.sbAni.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0});let f=e?-.001:.001;e?f+=up([0,0],[.32,.72],[0,1],[1,1],r)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),f+=up([0,0],[1,0],[.68,.28],[1,1],r)[0]),this.sbAni.progressEnd(e?1:0,f,l)}else this.gestureOrAnimationInProgress=!1}render(){return wi("slot",{key:"8067c9835d255daec61f33dba200fd3a6ff839a0"})}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return Yk}},[257,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64],getLength:[64]},void 0,{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}]);function Kk(){if(typeof customElements>"u")return;["ion-nav"].forEach(e=>{e==="ion-nav"&&(customElements.get(e)||customElements.define(e,Xk))})}const Jk=Kk;const Gy="ionKeyboardDidShow",O1="ionKeyboardDidHide",Qk=150;let Wy={},Wu={},fp=!1;const eC=()=>{Wy={},Wu={},fp=!1},tC=t=>{if(L1.getEngine())iC(t);else{if(!t.visualViewport)return;Wu=vx(t.visualViewport),t.visualViewport.onresize=()=>{$1(t),N1()||B1(t)?gx(t):_x(t)&&yx(t)}}},iC=t=>{t.addEventListener("keyboardDidShow",e=>gx(t,e)),t.addEventListener("keyboardDidHide",()=>yx(t))},gx=(t,e)=>{nC(t,e),fp=!0},yx=t=>{sC(t),fp=!1},N1=()=>{const t=(Wy.height-Wu.height)*Wu.scale;return!fp&&Wy.width===Wu.width&&t>Qk},B1=t=>fp&&!_x(t),_x=t=>fp&&Wu.height===t.innerHeight,nC=(t,e)=>{const r=e?e.keyboardHeight:t.innerHeight-Wu.height,l=new CustomEvent(Gy,{detail:{keyboardHeight:r}});t.dispatchEvent(l)},sC=t=>{const e=new CustomEvent(O1);t.dispatchEvent(e)},$1=t=>{Wy=Object.assign({},Wu),Wu=vx(t.visualViewport)},vx=t=>({width:Math.round(t.width),height:Math.round(t.height),offsetTop:t.offsetTop,offsetLeft:t.offsetLeft,pageTop:t.pageTop,pageLeft:t.pageLeft,scale:t.scale}),rC=Object.freeze(Object.defineProperty({__proto__:null,KEYBOARD_DID_CLOSE:O1,KEYBOARD_DID_OPEN:Gy,copyVisualViewport:vx,keyboardDidClose:_x,keyboardDidOpen:N1,keyboardDidResize:B1,resetKeyboardAssist:eC,setKeyboardClose:yx,setKeyboardOpen:gx,startKeyboardAssist:tC,trackViewportChanges:$1},Symbol.toStringTag,{value:"Module"}));var hp;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(hp||(hp={}));const xx={getEngine(){const t=M1();if(t?.isPluginAvailable("StatusBar"))return t.Plugins.StatusBar},setStyle(t){const e=this.getEngine();e&&e.setStyle(t)},getStyle:async function(){const t=this.getEngine();if(!t)return hp.Default;const{style:e}=await t.getInfo();return e}},Dv=(t,e)=>{if(e===1)return 0;const r=1/(1-e),l=-(e*r);return t*r+l},U1=()=>{!$s||$s.innerWidth>=768||xx.setStyle({style:hp.Dark})},Ov=(t=hp.Default)=>{!$s||$s.innerWidth>=768||xx.setStyle({style:t})},F1=async(t,e)=>{typeof t.canDismiss!="function"||!await t.canDismiss(void 0,rp)||(e.isRunning()?e.onFinish(()=>{t.dismiss(void 0,"handler")},{oneTimeCallback:!0}):t.dismiss(void 0,"handler"))},Nv=t=>.00255275*2.71828**(-14.9619*t)-1.00255*2.71828**(-.0380968*t)+1,Xu={MIN_PRESENTING_SCALE:.915},aC=(t,e,r,l)=>{const _=t.offsetHeight;let y=!1,d=!1,A=null,j=null;const B=.2;let N=!0,V=0;const Q=()=>A&&gu(A)?A.scrollY:!0,ge=hx({el:t,gestureName:"modalSwipeToClose",gesturePriority:b1,direction:"y",threshold:10,canStart:le=>{const me=le.event.target;return me===null||!me.closest?!0:(A=Iv(me),A?(gu(A)?j=Pr(A).querySelector(".inner-scroll"):j=A,!!!A.querySelector("ion-refresher")&&j.scrollTop===0):me.closest("ion-footer")===null)},onStart:le=>{const{deltaY:me}=le;N=Q(),d=t.canDismiss!==void 0&&t.canDismiss!==!0,me>0&&A&&Ob(A),e.progressStart(!0,y?1:0)},onMove:le=>{const{deltaY:me}=le;me>0&&A&&Ob(A);const be=le.deltaY/_,ke=be>=0&&d,Me=ke?B:.9999,Ue=ke?Nv(be/Me):be,Fe=Ny(1e-4,Ue,Me);e.progressStep(Fe),Fe>=.5&&V<.5?Ov(r):Fe<.5&&V>=.5&&U1(),V=Fe},onEnd:le=>{const me=le.velocityY,be=le.deltaY/_,ke=be>=0&&d,Me=ke?B:.9999,Ue=ke?Nv(be/Me):be,Fe=Ny(1e-4,Ue,Me),He=(le.deltaY+me*1e3)/_,lt=!ke&&He>=.5;let Ye=lt?-.001:.001;lt?(e.easing("cubic-bezier(0.32, 0.72, 0, 1)"),Ye+=up([0,0],[.32,.72],[0,1],[1,1],Fe)[0]):(e.easing("cubic-bezier(1, 0, 0.68, 0.28)"),Ye+=up([0,0],[1,0],[.68,.28],[1,1],Fe)[0]);const Mt=Fb(lt?be*_:(1-Fe)*_,me);y=lt,ge.enable(!1),A&&$k(A,N),e.onFinish(()=>{lt||ge.enable(!0)}).progressEnd(lt?1:0,Ye,Mt),ke&&Fe>Me/4?F1(t,e):lt&&l()}});return ge},Fb=(t,e)=>Ny(400,t/Math.abs(e*1.1),500),V1=t=>{const{currentBreakpoint:e,backdropBreakpoint:r,expandToScroll:l}=t,f=r===void 0||r<e,_=f?`calc(var(--backdrop-opacity) * ${e})`:"0",y=pn("backdropAnimation").fromTo("opacity",0,_);f&&y.beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]);const d=pn("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:`translateY(${100-e*100}%)`}]),A=l?void 0:pn("contentAnimation").keyframes([{offset:0,opacity:1,maxHeight:`${(1-e)*100}%`},{offset:1,opacity:1,maxHeight:`${e*100}%`}]);return{wrapperAnimation:d,backdropAnimation:y,contentAnimation:A}},q1=t=>{const{currentBreakpoint:e,backdropBreakpoint:r}=t,l=`calc(var(--backdrop-opacity) * ${Dv(e,r)})`,f=[{offset:0,opacity:l},{offset:1,opacity:0}],_=[{offset:0,opacity:l},{offset:r,opacity:0},{offset:1,opacity:0}],y=pn("backdropAnimation").keyframes(r!==0?_:f);return{wrapperAnimation:pn("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:`translateY(${100-e*100}%)`},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:y}},oC=()=>{const t=pn().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=pn().fromTo("transform","translateY(100vh)","translateY(0vh)");return{backdropAnimation:t,wrapperAnimation:e,contentAnimation:void 0}},Vb=(t,e)=>{const{presentingEl:r,currentBreakpoint:l,expandToScroll:f}=e,_=Pr(t),{wrapperAnimation:y,backdropAnimation:d,contentAnimation:A}=l!==void 0?V1(e):oC();d.addElement(_.querySelector("ion-backdrop")),y.addElement(_.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1}),!f&&A?.addElement(t.querySelector(".ion-page"));const j=pn("entering-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation([y]);if(A&&j.addAnimation(A),r){const B=window.innerWidth<768,N=r.tagName==="ION-MODAL"&&r.presentingElement!==void 0,V=Pr(r),Q=pn().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),ne=document.body;if(B){const J=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",ye=N?"-10px":J,re=Xu.MIN_PRESENTING_SCALE,ge=`translateY(${ye}) scale(${re})`;Q.afterStyles({transform:ge}).beforeAddWrite(()=>ne.style.setProperty("background-color","black")).addElement(r).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:ge,borderRadius:"10px 10px 0 0"}]),j.addAnimation(Q)}else if(j.addAnimation(d),!N)y.fromTo("opacity","0","1");else{const ye=`translateY(-10px) scale(${N?Xu.MIN_PRESENTING_SCALE:1})`;Q.afterStyles({transform:ye}).addElement(V.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:ye}]);const re=pn().afterStyles({transform:ye}).addElement(V.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:ye}]);j.addAnimation([Q,re])}}else j.addAnimation(d);return j},lC=()=>{const t=pn().fromTo("opacity","var(--backdrop-opacity)",0),e=pn().fromTo("transform","translateY(0vh)","translateY(100vh)");return{backdropAnimation:t,wrapperAnimation:e}},qb=(t,e,r=500)=>{const{presentingEl:l,currentBreakpoint:f}=e,_=Pr(t),{wrapperAnimation:y,backdropAnimation:d}=f!==void 0?q1(e):lC();d.addElement(_.querySelector("ion-backdrop")),y.addElement(_.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const A=pn("leaving-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(r).addAnimation(y);if(l){const j=window.innerWidth<768,B=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,N=Pr(l),V=pn().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish(ne=>{if(ne!==1)return;l.style.setProperty("overflow",""),Array.from(Q.querySelectorAll("ion-modal:not(.overlay-hidden)")).filter(ye=>ye.presentingElement!==void 0).length<=1&&Q.style.setProperty("background-color","")}),Q=document.body;if(j){const ne=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",J=B?"-10px":ne,ye=Xu.MIN_PRESENTING_SCALE,re=`translateY(${J}) scale(${ye})`;V.addElement(l).keyframes([{offset:0,filter:"contrast(0.85)",transform:re,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),A.addAnimation(V)}else if(A.addAnimation(d),!B)y.fromTo("opacity","1","0");else{const J=`translateY(-10px) scale(${B?Xu.MIN_PRESENTING_SCALE:1})`;V.addElement(N.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:J},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const ye=pn().addElement(N.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:J},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);A.addAnimation([V,ye])}}else A.addAnimation(d);return A},cC=(t,e,r=300)=>{const{presentingEl:l}=e;if(!l)return pn("portrait-to-landscape-transition");const f=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,_=Pr(l),y=document.body,d=pn("portrait-to-landscape-transition").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(r),A=pn().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"});if(f){const B=`translateY(-10px) scale(${Xu.MIN_PRESENTING_SCALE})`,N="translateY(0px) scale(1)";A.addElement(l).afterStyles({transform:N}).fromTo("transform",B,N).fromTo("filter","contrast(0.85)","contrast(1)");const V=pn().addElement(_.querySelector(".modal-shadow")).afterStyles({transform:N,opacity:"0"}).fromTo("transform",B,N);d.addAnimation([A,V])}else{const j=Pr(t),B=pn().addElement(j.querySelectorAll(".modal-wrapper, .modal-shadow")).fromTo("opacity","1","1"),N=pn().addElement(j.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)","var(--backdrop-opacity)"),V=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",Q=Xu.MIN_PRESENTING_SCALE,ne=`translateY(${V}) scale(${Q})`;A.addElement(l).afterStyles({transform:"translateY(0px) scale(1)","border-radius":"0px"}).beforeAddWrite(()=>y.style.setProperty("background-color","")).fromTo("transform",ne,"translateY(0px) scale(1)").fromTo("filter","contrast(0.85)","contrast(1)").fromTo("border-radius","10px 10px 0 0","0px"),d.addAnimation([A,B,N])}return d},uC=(t,e,r=300)=>{const{presentingEl:l}=e;if(!l)return pn("landscape-to-portrait-transition");const f=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,_=Pr(l),y=document.body,d=pn("landscape-to-portrait-transition").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(r),A=pn().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"});if(f){const B=`translateY(-10px) scale(${Xu.MIN_PRESENTING_SCALE})`,N="translateY(0) scale(1)";A.addElement(l).afterStyles({transform:N}).fromTo("transform",B,N);const V=pn().addElement(_.querySelector(".modal-shadow")).afterStyles({transform:N,opacity:"0"}).fromTo("transform",B,N);d.addAnimation([A,V])}else{const j=Pr(t),B=pn().addElement(j.querySelectorAll(".modal-wrapper, .modal-shadow")).fromTo("opacity","1","1"),N=pn().addElement(j.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)","var(--backdrop-opacity)"),V=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",Q=Xu.MIN_PRESENTING_SCALE,ne=`translateY(${V}) scale(${Q})`;A.addElement(l).afterStyles({transform:ne}).beforeAddWrite(()=>y.style.setProperty("background-color","black")).keyframes([{offset:0,transform:"translateY(0px) scale(1)",filter:"contrast(1)",borderRadius:"0px"},{offset:.2,transform:"translateY(0px) scale(1)",filter:"contrast(1)",borderRadius:"10px 10px 0 0"},{offset:1,transform:ne,filter:"contrast(0.85)",borderRadius:"10px 10px 0 0"}]),d.addAnimation([A,B,N])}return d},hC=()=>{const t=pn().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=pn().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}]);return{backdropAnimation:t,wrapperAnimation:e,contentAnimation:void 0}},dC=(t,e)=>{const{currentBreakpoint:r,expandToScroll:l}=e,f=Pr(t),{wrapperAnimation:_,backdropAnimation:y,contentAnimation:d}=r!==void 0?V1(e):hC();y.addElement(f.querySelector("ion-backdrop")),_.addElement(f.querySelector(".modal-wrapper")),!l&&d?.addElement(t.querySelector(".ion-page"));const A=pn().addElement(t).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([y,_]);return d&&A.addAnimation(d),A},fC=()=>{const t=pn().fromTo("opacity","var(--backdrop-opacity)",0),e=pn().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}]);return{backdropAnimation:t,wrapperAnimation:e}},pC=(t,e)=>{const{currentBreakpoint:r}=e,l=Pr(t),{wrapperAnimation:f,backdropAnimation:_}=r!==void 0?q1(e):fC();return _.addElement(l.querySelector("ion-backdrop")),f.addElement(l.querySelector(".modal-wrapper")),pn().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([_,f])},mC=(t,e,r,l,f,_,y=[],d,A,j,B)=>{const N=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}],V=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-f,opacity:0},{offset:1,opacity:0}],Q={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:f!==0?V:N,CONTENT_KEYFRAMES:[{offset:0,maxHeight:"100%"},{offset:1,maxHeight:"0%"}]},ne=t.querySelector("ion-content"),J=r.clientHeight;let ye=l,re=0,ge=!1,le=null,me=null,be=null,ke=null;const Me=.95,Ue=y[y.length-1],Fe=y[0],He=_.childAnimations.find(Le=>Le.id==="wrapperAnimation"),lt=_.childAnimations.find(Le=>Le.id==="backdropAnimation"),Ye=_.childAnimations.find(Le=>Le.id==="contentAnimation"),Mt=()=>{const Le=t;Le.focusTrap===!1||Le.showBackdrop===!1||(t.style.setProperty("pointer-events","auto"),e.style.setProperty("pointer-events","auto"),t.classList.remove(qy))},et=()=>{t.style.setProperty("pointer-events","none"),e.style.setProperty("pointer-events","none"),t.classList.add(qy)},Tt=Le=>{if(!me&&(me=Array.from(t.querySelectorAll("ion-footer")),!me.length))return;const tt=t.querySelector(".ion-page");if(ke=Le,Le==="stationary")me.forEach(rt=>{rt.classList.remove("modal-footer-moving"),rt.style.removeProperty("position"),rt.style.removeProperty("width"),rt.style.removeProperty("height"),rt.style.removeProperty("top"),rt.style.removeProperty("left"),tt?.style.removeProperty("padding-bottom"),tt?.appendChild(rt)});else{let rt=0;me.forEach((gt,Pt)=>{const Ot=gt.getBoundingClientRect(),ei=document.body.getBoundingClientRect();rt+=gt.clientHeight;const gi=Ot.top-ei.top,Vi=Ot.left-ei.left;if(gt.style.setProperty("--pinned-width",`${gt.clientWidth}px`),gt.style.setProperty("--pinned-height",`${gt.clientHeight}px`),gt.style.setProperty("--pinned-top",`${gi}px`),gt.style.setProperty("--pinned-left",`${Vi}px`),Pt===0){be=gi;const pi=t.querySelector("ion-header");pi&&(be-=pi.clientHeight)}}),me.forEach(gt=>{tt?.style.setProperty("padding-bottom",`${rt}px`),gt.classList.add("modal-footer-moving"),gt.style.setProperty("position","absolute"),gt.style.setProperty("width","var(--pinned-width)"),gt.style.setProperty("height","var(--pinned-height)"),gt.style.setProperty("top","var(--pinned-top)"),gt.style.setProperty("left","var(--pinned-left)"),document.body.appendChild(gt)})}};He&&lt&&(He.keyframes([...Q.WRAPPER_KEYFRAMES]),lt.keyframes([...Q.BACKDROP_KEYFRAMES]),Ye?.keyframes([...Q.CONTENT_KEYFRAMES]),_.progressStart(!0,1-ye),ye>f&&t.focusTrap!==!1&&t.showBackdrop!==!1?Mt():et()),ne&&ye!==Ue&&d&&(ne.scrollY=!1);const Be=Le=>{const tt=Iv(Le.event.target);if(ye=A(),!d&&tt)return(gu(tt)?Pr(tt).querySelector(".inner-scroll"):tt).scrollTop===0;if(ye===1&&tt){const rt=gu(tt)?Pr(tt).querySelector(".inner-scroll"):tt;return!!!tt.querySelector("ion-refresher")&&rt.scrollTop===0}return!0},ct=Le=>{if(ge=t.canDismiss!==void 0&&t.canDismiss!==!0&&Fe===0,!d){const tt=Iv(Le.event.target);le=tt&&gu(tt)?Pr(tt).querySelector(".inner-scroll"):tt}d||Tt("moving"),Le.deltaY>0&&ne&&(ne.scrollY=!1),mu(()=>{t.focus()}),_.progressStart(!0,1-ye)},ut=Le=>{if(!d&&be!==null&&ke!==null&&(Le.currentY>=be&&ke==="moving"?Tt("stationary"):Le.currentY<be&&ke==="stationary"&&Tt("moving")),!d&&Le.deltaY<=0&&le)return;Le.deltaY>0&&ne&&(ne.scrollY=!1);const tt=1-ye,rt=y.length>1?1-y[1]:void 0,gt=tt+Le.deltaY/J,Pt=rt!==void 0&&gt>=rt&&ge,Ot=Pt?Me:.9999,ei=Pt&&rt!==void 0?rt+Nv((gt-rt)/(Ot-rt)):gt;re=Ny(1e-4,ei,Ot),_.progressStep(re)},Et=Le=>{if(!d&&Le.deltaY<=0&&le&&le.scrollTop>0){Tt("stationary");return}const tt=Le.velocityY,rt=(Le.deltaY+tt*350)/J,gt=ye-rt,Pt=y.reduce((Ot,ei)=>Math.abs(ei-gt)<Math.abs(Ot-gt)?ei:Ot);ot({breakpoint:Pt,breakpointOffset:re,canDismiss:ge,animated:!0})},ot=Le=>{const{breakpoint:tt,canDismiss:rt,breakpointOffset:gt,animated:Pt}=Le,Ot=rt&&tt===0,ei=Ot?ye:tt,gi=ei!==0;return ye=0,He&&lt&&(He.keyframes([{offset:0,transform:`translateY(${gt*100}%)`},{offset:1,transform:`translateY(${(1-ei)*100}%)`}]),lt.keyframes([{offset:0,opacity:`calc(var(--backdrop-opacity) * ${Dv(1-gt,f)})`},{offset:1,opacity:`calc(var(--backdrop-opacity) * ${Dv(ei,f)})`}]),Ye&&Ye.keyframes([{offset:0,maxHeight:`${(1-gt)*100}%`},{offset:1,maxHeight:`${ei*100}%`}]),_.progressStep(0)),xe.enable(!1),Ot?F1(t,_):gi||j(),ne&&(ei===y[y.length-1]||!d)&&(ne.scrollY=!0),!d&&ei===0&&Tt("stationary"),new Promise(Vi=>{_.onFinish(()=>{gi?(d||Tt("stationary"),He&&lt?mu(()=>{He.keyframes([...Q.WRAPPER_KEYFRAMES]),lt.keyframes([...Q.BACKDROP_KEYFRAMES]),Ye?.keyframes([...Q.CONTENT_KEYFRAMES]),_.progressStart(!0,1-ei),ye=ei,B(ye),ye>f&&t.focusTrap!==!1&&t.showBackdrop!==!1?Mt():et(),xe.enable(!0),Vi()}):(xe.enable(!0),Vi())):Vi()},{oneTimeCallback:!0}).progressEnd(1,0,Pt?500:0)})},xe=hx({el:r,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:Be,onStart:ct,onMove:ut,onEnd:Et});return{gesture:xe,moveSheetToBreakpoint:ot}},gC=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, var(--ion-background-color-step-350, #c0c0be));cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host(.modal-sheet.modal-no-expand-scroll) ion-footer{position:absolute;bottom:0;width:var(--width)}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-start-start-radius:var(--border-radius);border-start-end-radius:var(--border-radius);border-end-end-radius:0;border-end-start-radius:0}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-start-start-radius:var(--border-radius);border-start-end-radius:var(--border-radius);border-end-end-radius:0;border-end-start-radius:0}',yC=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, var(--ion-background-color-step-350, #c0c0be));cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host(.modal-sheet.modal-no-expand-scroll) ion-footer{position:absolute;bottom:0;width:var(--width)}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}',_C=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.didPresent=qn(this,"ionModalDidPresent",7),this.willPresent=qn(this,"ionModalWillPresent",7),this.willDismiss=qn(this,"ionModalWillDismiss",7),this.didDismiss=qn(this,"ionModalDidDismiss",7),this.ionBreakpointDidChange=qn(this,"ionBreakpointDidChange",7),this.didPresentShorthand=qn(this,"didPresent",7),this.willPresentShorthand=qn(this,"willPresent",7),this.willDismissShorthand=qn(this,"willDismiss",7),this.didDismissShorthand=qn(this,"didDismiss",7),this.ionMount=qn(this,"ionMount",7),this.lockController=mx(),this.triggerController=w1(),this.coreDelegate=d1(),this.isSheetModal=!1,this.inheritedAttributes={},this.inline=!1,this.gestureAnimationDismissing=!1,this.presented=!1,this.hasController=!1,this.keyboardClose=!0,this.expandToScroll=!0,this.backdropBreakpoint=0,this.handleBehavior="none",this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.isOpen=!1,this.keepContentsMounted=!1,this.focusTrap=!0,this.canDismiss=!0,this.onHandleClick=()=>{const{sheetTransition:r,handleBehavior:l}=this;l!=="cycle"||r!==void 0||this.moveToNextBreakpoint()},this.onBackdropTap=()=>{const{sheetTransition:r}=this;r===void 0&&this.dismiss(void 0,Vy)},this.onLifecycle=r=>{const l=this.usersElement,f=vC[r.type];if(l&&f){const _=new CustomEvent(f,{bubbles:!1,cancelable:!1,detail:r.detail});l.dispatchEvent(_)}},this.onModalFocus=r=>{const{dragHandleEl:l,el:f}=this;r.target===f&&l&&l.tabIndex!==-1&&l.focus()},this.onSlotChange=({target:r})=>{r.assignedElements().forEach(f=>{f.querySelectorAll("ion-modal").forEach(_=>{_.getAttribute("data-parent-ion-modal")===null&&_.setAttribute("data-parent-ion-modal",this.el.id)})})}}onIsOpenChange(e,r){e===!0&&r===!1?this.present():e===!1&&r===!0&&this.dismiss()}triggerChanged(){const{trigger:e,el:r,triggerController:l}=this;e&&l.addClickListener(r,e)}onWindowResize(){Cs(this)!=="ios"||!this.presentingElement||this.enterAnimation||this.leaveAnimation||(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.handleViewTransition()},50))}breakpointsChanged(e){e!==void 0&&(this.sortedBreakpoints=e.sort((r,l)=>r-l))}connectedCallback(){const{el:e}=this;p1(e),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener(),this.cleanupViewTransitionListener(),this.cleanupParentRemovalObserver()}componentWillLoad(){var e;const{breakpoints:r,initialBreakpoint:l,el:f,htmlAttributes:_}=this,y=this.isSheetModal=r!==void 0&&l!==void 0,d=["aria-label","role"];this.inheritedAttributes=ux(f,d),f.parentNode&&(this.cachedOriginalParent=f.parentNode),_!==void 0&&d.forEach(A=>{_[A]&&(this.inheritedAttributes=Object.assign(Object.assign({},this.inheritedAttributes),{[A]:_[A]}),delete _[A])}),y&&(this.currentBreakpoint=this.initialBreakpoint),r!==void 0&&l!==void 0&&!r.includes(l)&&jl("[ion-modal] - Your breakpoints array must include the initialBreakpoint value."),!((e=this.htmlAttributes)===null||e===void 0)&&e.id||m1(this.el)}componentDidLoad(){this.isOpen===!0&&mu(()=>this.present()),this.breakpointsChanged(this.breakpoints),this.triggerChanged()}getDelegate(e=!1){if(this.workingDelegate&&!e)return{delegate:this.workingDelegate,inline:this.inline};const r=this.el.parentNode,l=this.inline=r!==null&&!this.hasController,f=this.workingDelegate=l?this.delegate||this.coreDelegate:this.delegate;return{inline:l,delegate:f}}async checkCanDismiss(e,r){const{canDismiss:l}=this;return typeof l=="function"?l(e,r):l}async present(){const e=await this.lockController.lock();if(this.presented){e();return}const{presentingElement:r,el:l}=this;this.currentBreakpoint=this.initialBreakpoint;const{inline:f,delegate:_}=this.getDelegate(!0);this.ionMount.emit(),this.usersElement=await r_(_,l,this.component,["ion-page"],this.componentProps,f),Oy(l)?await By(this.usersElement):this.keepContentsMounted||await tE(),zm(()=>this.el.classList.add("show-modal"));const y=r!==void 0;y&&Cs(this)==="ios"&&(this.statusBarStyle=await xx.getStyle(),U1()),await _1(this,"modalEnter",Vb,dC,{presentingEl:r,currentBreakpoint:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint,expandToScroll:this.expandToScroll}),typeof window<"u"&&(this.keyboardOpenCallback=()=>{this.gesture&&(this.gesture.enable(!1),mu(()=>{this.gesture&&this.gesture.enable(!0)}))},window.addEventListener(Gy,this.keyboardOpenCallback));const d=this.breakpoints!==void 0&&this.initialBreakpoint!==void 0;this.isSheetModal=d,d?this.initSheetGesture():y&&this.initSwipeToClose(),this.initViewTransitionListener(),this.initParentRemovalObserver(),e()}initSwipeToClose(){var e;if(Cs(this)!=="ios")return;const{el:r}=this,l=this.leaveAnimation||xn.get("modalLeave",qb),f=this.animation=l(r,{presentingEl:this.presentingElement,expandToScroll:this.expandToScroll});if(!Nk(r)){Bk(r);return}const y=(e=this.statusBarStyle)!==null&&e!==void 0?e:hp.Default;this.gesture=aC(r,f,y,()=>{this.gestureAnimationDismissing=!0,Ov(this.statusBarStyle),this.animation.onFinish(async()=>{await this.dismiss(void 0,rp),this.gestureAnimationDismissing=!1})}),this.gesture.enable(!0)}initSheetGesture(){const{wrapperEl:e,initialBreakpoint:r,backdropBreakpoint:l}=this;if(!e||r===void 0)return;const f=this.enterAnimation||xn.get("modalEnter",Vb),_=this.animation=f(this.el,{presentingEl:this.presentingElement,currentBreakpoint:r,backdropBreakpoint:l,expandToScroll:this.expandToScroll});_.progressStart(!0,1);const{gesture:y,moveSheetToBreakpoint:d}=mC(this.el,this.backdropEl,e,r,l,_,this.sortedBreakpoints,this.expandToScroll,()=>{var j;return(j=this.currentBreakpoint)!==null&&j!==void 0?j:0},()=>this.sheetOnDismiss(),j=>{this.currentBreakpoint!==j&&(this.currentBreakpoint=j,this.ionBreakpointDidChange.emit({breakpoint:j}))});this.gesture=y,this.moveSheetToBreakpoint=d,this.gesture.enable(!0),(this.showBackdrop===!1||this.focusTrap===!1||l>0)&&this.setupChildRoutePassthrough()}setupChildRoutePassthrough(){var e;this.cachedPageParent=this.getOriginalPageParent();const r=this.cachedPageParent;if(!r||r.tagName==="ION-APP"||Array.from(r.children).some(_=>{var y;return _!==this.el&&!(_ instanceof Ra&&window.getComputedStyle(_).display==="none")&&_.tagName!=="TEMPLATE"&&_.tagName!=="SLOT"&&!(_.nodeType===Node.TEXT_NODE&&!(!((y=_.textContent)===null||y===void 0)&&y.trim()))}))return;r.classList.add("ion-page-overlay-passthrough");const f=r.parentElement;f?.tagName==="ION-ROUTER-OUTLET"&&((e=f.parentElement)===null||e===void 0?void 0:e.tagName)!=="ION-APP"&&(f.style.setProperty("pointer-events","none"),f.setAttribute("data-overlay-passthrough","true"))}getOriginalPageParent(){if(!this.cachedOriginalParent)return null;let e=this.cachedOriginalParent;for(;e&&!e.classList.contains("ion-page");)e=e.parentElement;return e}cleanupChildRoutePassthrough(){const e=this.cachedPageParent;if(!e)return;e.classList.remove("ion-page-overlay-passthrough");const r=e.parentElement;r?.hasAttribute("data-overlay-passthrough")&&(r.style.removeProperty("pointer-events"),r.removeAttribute("data-overlay-passthrough")),this.cachedPageParent=void 0}sheetOnDismiss(){this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{this.currentBreakpoint=0,this.ionBreakpointDidChange.emit({breakpoint:this.currentBreakpoint}),await this.dismiss(void 0,rp),this.gestureAnimationDismissing=!1})}async dismiss(e,r){var l;if(this.gestureAnimationDismissing&&r!==rp)return!1;const f=await this.lockController.lock();if(await this.dismissNestedModals(),r!=="handler"&&!await this.checkCanDismiss(e,r))return f(),!1;const{presentingElement:_}=this;_!==void 0&&Cs(this)==="ios"&&Ov(this.statusBarStyle),typeof window<"u"&&this.keyboardOpenCallback&&(window.removeEventListener(Gy,this.keyboardOpenCallback),this.keyboardOpenCallback=void 0);const d=await v1(this,e,r,"modalLeave",qb,pC,{presentingEl:_,currentBreakpoint:(l=this.currentBreakpoint)!==null&&l!==void 0?l:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint,expandToScroll:this.expandToScroll});if(d){const{delegate:A}=this.getDelegate();await h1(A,this.usersElement),zm(()=>this.el.classList.remove("show-modal")),this.animation&&this.animation.destroy(),this.gesture&&this.gesture.destroy(),this.cleanupViewTransitionListener(),this.cleanupParentRemovalObserver(),this.cleanupChildRoutePassthrough()}return this.currentBreakpoint=void 0,this.animation=void 0,f(),d}onDidDismiss(){return Fy(this.el,"ionModalDidDismiss")}onWillDismiss(){return Fy(this.el,"ionModalWillDismiss")}async setCurrentBreakpoint(e){if(!this.isSheetModal){jl("[ion-modal] - setCurrentBreakpoint is only supported on sheet modals.");return}if(!this.breakpoints.includes(e)){jl(`[ion-modal] - Attempted to set invalid breakpoint value ${e}. Please double check that the breakpoint value is part of your defined breakpoints.`);return}const{currentBreakpoint:r,moveSheetToBreakpoint:l,canDismiss:f,breakpoints:_,animated:y}=this;r!==e&&l&&(this.sheetTransition=l({breakpoint:e,breakpointOffset:1-r,canDismiss:f!==void 0&&f!==!0&&_[0]===0,animated:y}),await this.sheetTransition,this.sheetTransition=void 0)}async getCurrentBreakpoint(){return this.currentBreakpoint}async moveToNextBreakpoint(){const{breakpoints:e,currentBreakpoint:r}=this;if(!e||r==null)return!1;const l=e.filter(d=>d!==0),_=(l.indexOf(r)+1)%l.length,y=l[_];return await this.setCurrentBreakpoint(y),!0}initViewTransitionListener(){Cs(this)!=="ios"||!this.presentingElement||this.enterAnimation||this.leaveAnimation||(this.currentViewIsPortrait=window.innerWidth<768)}handleViewTransition(){if(!this.presented)return;const e=window.innerWidth<768;if(this.currentViewIsPortrait===e)return;this.viewTransitionAnimation&&(this.viewTransitionAnimation.destroy(),this.viewTransitionAnimation=void 0);const{presentingElement:r}=this;if(!r)return;let l;this.currentViewIsPortrait&&!e?l=cC(this.el,{presentingEl:r}):l=uC(this.el,{presentingEl:r}),this.currentViewIsPortrait=e,this.viewTransitionAnimation=l,l.play().then(()=>{this.viewTransitionAnimation=void 0,this.reinitSwipeToClose()})}cleanupViewTransitionListener(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=void 0),this.viewTransitionAnimation&&(this.viewTransitionAnimation.destroy(),this.viewTransitionAnimation=void 0)}reinitSwipeToClose(){Cs(this)!=="ios"||!this.presentingElement||(this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.animation&&(this.animation.progressEnd(0,0,0),this.animation.destroy(),this.animation=void 0),mu(()=>{this.ensureCorrectModalPosition(),this.initSwipeToClose()}))}ensureCorrectModalPosition(){const{el:e,presentingElement:r}=this,f=Pr(e).querySelector(".modal-wrapper");if(f&&(f.style.transform="translateY(0vh)",f.style.opacity="1"),r?.tagName==="ION-MODAL")if(window.innerWidth<768){const y=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",d=Xu.MIN_PRESENTING_SCALE;r.style.transform=`translateY(${y}) scale(${d})`}else r.style.transform="translateY(0px) scale(1)"}async dismissNestedModals(){const e=document.querySelectorAll(`ion-modal[data-parent-ion-modal="${this.el.id}"]`);e?.forEach(async r=>{await r.dismiss(void 0,"parent-dismissed")})}initParentRemovalObserver(){typeof MutationObserver>"u"||typeof window>"u"||!this.cachedOriginalParent||this.cachedOriginalParent.nodeType===Node.DOCUMENT_NODE||this.cachedOriginalParent.nodeType===Node.DOCUMENT_FRAGMENT_NODE||this.hasController||this.cachedOriginalParent===document.body||this.cachedOriginalParent.tagName==="ION-APP"||(this.parentRemovalObserver=new MutationObserver(e=>{e.forEach(r=>{if(r.type==="childList"&&r.removedNodes.length>0){const l=Array.from(r.removedNodes).some(_=>{var y,d;const A=_===this.cachedOriginalParent,j=this.cachedOriginalParent?(d=(y=_).contains)===null||d===void 0?void 0:d.call(y,this.cachedOriginalParent):!1;return A||j}),f=this.cachedOriginalParent&&!this.cachedOriginalParent.isConnected;(l||f)&&(this.dismiss(void 0,"parent-removed"),this.cachedOriginalParent=void 0)}})}),this.parentRemovalObserver.observe(document.body,{childList:!0,subtree:!0}))}cleanupParentRemovalObserver(){var e;(e=this.parentRemovalObserver)===null||e===void 0||e.disconnect(),this.parentRemovalObserver=void 0}render(){const{handle:e,isSheetModal:r,presentingElement:l,htmlAttributes:f,handleBehavior:_,inheritedAttributes:y,focusTrap:d,expandToScroll:A}=this,j=e!==!1&&r,B=Cs(this),N=l!==void 0&&B==="ios",V=_==="cycle";return wi(Yo,Object.assign({key:"87328006ea6c75ebc518ace300438492a567223e","no-router":!0,tabIndex:V&&(r&&j)?0:-1},f,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[B]:!0,"modal-default":!N&&!r,"modal-card":N,"modal-sheet":r,"modal-no-expand-scroll":r&&!A,"overlay-hidden":!0,[qy]:d===!1},c1(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle,onFocus:this.onModalFocus}),wi("ion-backdrop",{key:"ee94ff8e09b691dd4ad4e4db1720f06bc3c5a469",ref:ne=>this.backdropEl=ne,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),B==="ios"&&wi("div",{key:"bffd69b4635c22d9f249725bd952c1e93d5615c7",class:"modal-shadow"}),wi("div",Object.assign({key:"1d394d3c68916e464ff1fbf5242419f4a3d3cca1",role:"dialog"},y,{"aria-modal":"true",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:ne=>this.wrapperEl=ne}),j&&wi("button",{key:"2dcf58792018e557e0c323baad2d672bc99c0bb1",class:"modal-handle",tabIndex:V?0:-1,"aria-label":"Activate to adjust the size of the dialog overlaying the screen",onClick:V?this.onHandleClick:void 0,part:"handle",ref:ne=>this.dragHandleEl=ne}),wi("slot",{key:"44164b1e8710c3895400ad9f44ecd99873874ad5",onSlotchange:this.onSlotChange})))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:gC,md:yC}}},[289,"ion-modal",{hasController:[4,"has-controller"],overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],breakpoints:[16],expandToScroll:[4,"expand-to-scroll"],initialBreakpoint:[2,"initial-breakpoint"],backdropBreakpoint:[2,"backdrop-breakpoint"],handle:[4],handleBehavior:[1,"handle-behavior"],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],presentingElement:[16],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],keepContentsMounted:[4,"keep-contents-mounted"],focusTrap:[4,"focus-trap"],canDismiss:[4,"can-dismiss"],isSheetModal:[32],presented:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64],setCurrentBreakpoint:[64],getCurrentBreakpoint:[64]},[[9,"resize","onWindowResize"]],{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}]),vC={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"};function xC(){if(typeof customElements>"u")return;["ion-modal","ion-backdrop"].forEach(e=>{switch(e){case"ion-modal":customElements.get(e)||customElements.define(e,_C);break;case"ion-backdrop":customElements.get(e)||Sk();break}})}const bC=Gk;const wC=":host(.tab-hidden){display:none !important}",SC=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.loaded=!1,this.active=!1}async componentWillLoad(){this.active&&await this.setActive()}async setActive(){await this.prepareLazyLoaded(),this.active=!0}changeActive(e){e&&this.prepareLazyLoaded()}prepareLazyLoaded(){if(!this.loaded&&this.component!=null){this.loaded=!0;try{return r_(this.delegate,this.el,this.component,["ion-page"])}catch(e){Ju("[ion-tab] - Exception in prepareLazyLoaded:",e)}}return Promise.resolve(void 0)}render(){const{tab:e,active:r,component:l}=this;return wi(Yo,{key:"dbad8fe9f1566277d14647626308eaf1601ab01f",role:"tabpanel","aria-hidden":r?null:"true","aria-labelledby":`tab-button-${e}`,class:{"ion-page":l===void 0,"tab-hidden":!r}},wi("slot",{key:"3be64f4e7161f6769aaf8e4dcb5293fcaa09af45"}))}get el(){return this}static get watchers(){return{active:["changeActive"]}}static get style(){return wC}},[257,"ion-tab",{active:[1028],delegate:[16],tab:[1],component:[1],setActive:[64]},void 0,{active:["changeActive"]}]);function TC(){if(typeof customElements>"u")return;["ion-tab"].forEach(e=>{e==="ion-tab"&&(customElements.get(e)||customElements.define(e,SC))})}const EC=TC;function kC(t,e,r,l){let f;if(r==="md"?f=t==="top"?8:-8:f=t==="top"?10:-10,e&&$s){CC(e,l);const _=e.getBoundingClientRect();return t==="top"?f+=_.bottom:t==="bottom"&&(f-=$s.innerHeight-_.top),{top:`${f}px`,bottom:`${f}px`}}else return{top:`calc(${f}px + var(--ion-safe-area-top, 0px))`,bottom:`calc(${f}px - var(--ion-safe-area-bottom, 0px))`}}function CC(t,e){t.offsetParent===null&&jl("[ion-toast] - The positionAnchor element for ion-toast was found in the DOM, but appears to be hidden. This may lead to unexpected positioning of the toast.",e)}const bx=(t,e)=>Math.floor(t/2-e/2),AC=(t,e)=>{const r=pn(),l=pn(),{position:f,top:_,bottom:y}=e,A=Pr(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":l.fromTo("transform","translateY(-100%)",`translateY(${_})`);break;case"middle":const j=bx(t.clientHeight,A.clientHeight);A.style.top=`${j}px`,l.fromTo("opacity",.01,1);break;default:l.fromTo("transform","translateY(100%)",`translateY(${y})`);break}return r.easing("cubic-bezier(.155,1.105,.295,1.12)").duration(400).addAnimation(l)},MC=(t,e)=>{const r=pn(),l=pn(),{position:f,top:_,bottom:y}=e,A=Pr(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":l.fromTo("transform",`translateY(${_})`,"translateY(-100%)");break;case"middle":l.fromTo("opacity",.99,0);break;default:l.fromTo("transform",`translateY(${y})`,"translateY(100%)");break}return r.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(l)},PC=(t,e)=>{const r=pn(),l=pn(),{position:f,top:_,bottom:y}=e,A=Pr(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":A.style.setProperty("transform",`translateY(${_})`),l.fromTo("opacity",.01,1);break;case"middle":const j=bx(t.clientHeight,A.clientHeight);A.style.top=`${j}px`,l.fromTo("opacity",.01,1);break;default:A.style.setProperty("transform",`translateY(${y})`),l.fromTo("opacity",.01,1);break}return r.easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation(l)},jC=t=>{const e=pn(),r=pn(),f=Pr(t).querySelector(".toast-wrapper");return r.addElement(f).fromTo("opacity",.99,0),e.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(r)},IC=(t,e,r)=>{const l=Pr(t).querySelector(".toast-wrapper"),f=t.clientHeight,_=l.getBoundingClientRect();let y=0;const d=.5,A=t.position==="middle"?.5:0,j=t.position==="top"?-1:1,B=bx(f,_.height),N=[{offset:0,transform:`translateY(-${B+_.height}px)`},{offset:.5,transform:"translateY(0px)"},{offset:1,transform:`translateY(${B+_.height}px)`}],V=pn("toast-swipe-to-dismiss-animation").addElement(l).duration(100);switch(t.position){case"middle":y=f+_.height,V.keyframes(N),V.progressStart(!0,.5);break;case"top":y=_.bottom,V.keyframes([{offset:0,transform:`translateY(${e.top})`},{offset:1,transform:"translateY(-100%)"}]),V.progressStart(!0,0);break;default:y=f-_.top,V.keyframes([{offset:0,transform:`translateY(${e.bottom})`},{offset:1,transform:"translateY(100%)"}]),V.progressStart(!0,0);break}const Q=re=>re*j/y,ye=hx({el:l,gestureName:"toast-swipe-to-dismiss",gesturePriority:b1,direction:"y",onMove:re=>{const ge=A+Q(re.deltaY);V.progressStep(ge)},onEnd:re=>{const ge=re.velocityY,le=(re.deltaY+ge*1e3)/y*j;ye.enable(!1);let me=!0,be=1,ke=0,Me=0;if(t.position==="middle"){me=le>=d/2||le<=-.5/2,be=1,ke=0;const Fe=l.getBoundingClientRect(),He=Fe.top-B,lt=`${He}px`,Ye=re.deltaY<=0?-1:1,Mt=(B+Fe.height)*Ye,et=me?`${Mt}px`:"0px",Tt=[{offset:0,transform:`translateY(${lt})`},{offset:1,transform:`translateY(${et})`}];V.keyframes(Tt),Me=Mt-He}else me=le>=d,be=me?1:0,ke=Q(re.deltaY),Me=(me?1-ke:ke)*y;const Ue=Math.min(Math.abs(Me)/Math.abs(ge),200);V.onFinish(()=>{me?(r(),V.destroy()):(t.position==="middle"?V.keyframes(N).progressStart(!0,.5):V.progressStart(!0,0),ye.enable(!0))},{oneTimeCallback:!0}).progressEnd(be,ke,Ue)}});return ye},LC=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host{inset-inline-start:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);pointer-events:auto}.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-content{min-width:0}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-50, var(--ion-background-color-step-50, #f2f2f2));--border-radius:14px;--button-color:var(--ion-color-primary, #0054e9);--color:var(--ion-color-step-850, var(--ion-text-color-step-150, #262626));--max-width:700px;--max-height:478px;--start:10px;--end:10px;font-size:clamp(14px, 0.875rem, 43.4px)}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;z-index:10}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.toast-translucent) .toast-wrapper{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}:host(.ion-color.toast-translucent) .toast-wrapper{background:rgba(var(--ion-color-base-rgb), 0.8)}}.toast-wrapper.toast-middle{opacity:0.01}.toast-content{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:15px;padding-bottom:15px}.toast-header{margin-bottom:2px;font-weight:500}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;min-height:44px;-webkit-transition:background-color, opacity 100ms linear;transition:background-color, opacity 100ms linear;border:0;background-color:transparent;font-family:var(--ion-font-family);font-size:clamp(17px, 1.0625rem, 21.998px);font-weight:500;overflow:hidden}.toast-button.ion-activated{opacity:0.4}@media (any-hover: hover){.toast-button:hover{opacity:0.6}}",zC=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host{inset-inline-start:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);pointer-events:auto}.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-content{min-width:0}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-800, var(--ion-background-color-step-800, #333333));--border-radius:4px;--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--button-color:var(--ion-color-primary, #0054e9);--color:var(--ion-color-step-50, var(--ion-text-color-step-950, #f2f2f2));--max-width:700px;--start:8px;--end:8px;font-size:0.875rem}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;opacity:0.01;z-index:10}.toast-content{-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px;padding-top:14px;padding-bottom:14px}.toast-header{margin-bottom:2px;font-weight:500;line-height:1.25rem}.toast-message{line-height:1.25rem}.toast-layout-baseline .toast-button-group-start{-webkit-margin-start:8px;margin-inline-start:8px}.toast-layout-stacked .toast-button-group-start{-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px}.toast-layout-baseline .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px}.toast-layout-stacked .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px;margin-bottom:8px}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;font-family:var(--ion-font-family);font-size:0.875rem;font-weight:500;letter-spacing:0.84px;text-transform:uppercase;overflow:hidden}.toast-button-cancel{color:var(--ion-color-step-100, var(--ion-text-color-step-900, #e6e6e6))}.toast-button-icon-only{border-radius:50%;-webkit-padding-start:9px;padding-inline-start:9px;-webkit-padding-end:9px;padding-inline-end:9px;padding-top:9px;padding-bottom:9px;width:36px;height:36px}@media (any-hover: hover){.toast-button:hover{background-color:rgba(var(--ion-color-primary-rgb, 0, 84, 233), 0.08)}.toast-button-cancel:hover{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.08)}}",RC=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.didPresent=qn(this,"ionToastDidPresent",7),this.willPresent=qn(this,"ionToastWillPresent",7),this.willDismiss=qn(this,"ionToastWillDismiss",7),this.didDismiss=qn(this,"ionToastDidDismiss",7),this.didPresentShorthand=qn(this,"didPresent",7),this.willPresentShorthand=qn(this,"willPresent",7),this.willDismissShorthand=qn(this,"willDismiss",7),this.didDismissShorthand=qn(this,"didDismiss",7),this.delegateController=tk(this),this.lockController=mx(),this.triggerController=w1(),this.customHTMLEnabled=xn.get("innerHTMLTemplatesEnabled",zE),this.presented=!1,this.revealContentToScreenReader=!1,this.hasController=!1,this.duration=xn.getNumber("toastDuration",0),this.layout="baseline",this.keyboardClose=!1,this.position="bottom",this.translucent=!1,this.animated=!0,this.isOpen=!1,this.dispatchCancelHandler=r=>{const l=r.detail.role;if(Pv(l)){const f=this.getButtons().find(_=>_.role==="cancel");this.callButtonHandler(f)}},this.createSwipeGesture=r=>{(this.gesture=IC(this.el,r,()=>{this.dismiss(void 0,rp)})).enable(!0)},this.destroySwipeGesture=()=>{const{gesture:r}=this;r!==void 0&&(r.destroy(),this.gesture=void 0)},this.prefersSwipeGesture=()=>{const{swipeGesture:r}=this;return r==="vertical"}}swipeGestureChanged(){this.destroySwipeGesture(),this.presented&&this.prefersSwipeGesture()&&this.createSwipeGesture(this.lastPresentedPosition)}onIsOpenChange(e,r){e===!0&&r===!1?this.present():e===!1&&r===!0&&this.dismiss()}triggerChanged(){const{trigger:e,el:r,triggerController:l}=this;e&&l.addClickListener(r,e)}connectedCallback(){p1(this.el),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){var e;!((e=this.htmlAttributes)===null||e===void 0)&&e.id||m1(this.el)}componentDidLoad(){this.isOpen===!0&&mu(()=>this.present()),this.triggerChanged()}async present(){const e=await this.lockController.lock();await this.delegateController.attachViewToDom();const{el:r,position:l}=this,f=this.getAnchorElement(),_=kC(l,f,Cs(this),r);this.lastPresentedPosition=_,await _1(this,"toastEnter",AC,PC,{position:l,top:_.top,bottom:_.bottom}),this.revealContentToScreenReader=!0,this.duration>0&&(this.durationTimeout=setTimeout(()=>this.dismiss(void 0,"timeout"),this.duration)),this.prefersSwipeGesture()&&this.createSwipeGesture(_),e()}async dismiss(e,r){var l,f;const _=await this.lockController.lock(),{durationTimeout:y,position:d,lastPresentedPosition:A}=this;y&&clearTimeout(y);const j=await v1(this,e,r,"toastLeave",MC,jC,{position:d,top:(l=A?.top)!==null&&l!==void 0?l:"",bottom:(f=A?.bottom)!==null&&f!==void 0?f:""});return j&&(this.delegateController.removeViewFromDom(),this.revealContentToScreenReader=!1),this.lastPresentedPosition=void 0,this.destroySwipeGesture(),_(),j}onDidDismiss(){return Fy(this.el,"ionToastDidDismiss")}onWillDismiss(){return Fy(this.el,"ionToastWillDismiss")}getButtons(){return this.buttons?this.buttons.map(r=>typeof r=="string"?{text:r}:r):[]}getAnchorElement(){const{position:e,positionAnchor:r,el:l}=this;if(r!==void 0){if(e==="middle"&&r!==void 0){jl('[ion-toast] - The positionAnchor property is ignored when using position="middle".',this.el);return}if(typeof r=="string"){const f=document.getElementById(r);if(f===null){jl(`[ion-toast] - An anchor element with an ID of "${r}" was not found in the DOM.`,l);return}return f}if(r instanceof Ra)return r;jl("[ion-toast] - Invalid positionAnchor value:",r,l)}}async buttonClick(e){const r=e.role;return Pv(r)?this.dismiss(void 0,r):await this.callButtonHandler(e)?this.dismiss(void 0,r):Promise.resolve()}async callButtonHandler(e){if(e?.handler)try{if(await ek(e.handler)===!1)return!1}catch(r){Ju("[ion-toast] - Exception in callButtonHandler:",r)}return!0}renderButtons(e,r){if(e.length===0)return;const l=Cs(this),f={"toast-button-group":!0,[`toast-button-group-${r}`]:!0};return wi("div",{class:f},e.map(_=>wi("button",Object.assign({},_.htmlAttributes,{type:"button",class:DC(_),tabIndex:0,onClick:()=>this.buttonClick(_),part:OC(_)}),wi("div",{class:"toast-button-inner"},_.icon&&wi("ion-icon",{"aria-hidden":"true",icon:_.icon,slot:_.text===void 0?"icon-only":void 0,class:"toast-button-icon"}),_.text),l==="md"&&wi("ion-ripple-effect",{type:_.icon!==void 0&&_.text===void 0?"unbounded":"bounded"}))))}renderToastMessage(e,r=null){const{customHTMLEnabled:l,message:f}=this;return l?wi("div",{key:e,"aria-hidden":r,class:"toast-message",part:"message",innerHTML:ME(f)}):wi("div",{key:e,"aria-hidden":r,class:"toast-message",part:"message"},f)}renderHeader(e,r=null){return wi("div",{key:e,class:"toast-header","aria-hidden":r,part:"header"},this.header)}render(){const{layout:e,el:r,revealContentToScreenReader:l,header:f,message:_}=this,y=this.getButtons(),d=y.filter(N=>N.side==="start"),A=y.filter(N=>N.side!=="start"),j=Cs(this),B={"toast-wrapper":!0,[`toast-${this.position}`]:!0,[`toast-layout-${e}`]:!0};return e==="stacked"&&d.length>0&&A.length>0&&jl("[ion-toast] - This toast is using start and end buttons with the stacked toast layout. We recommend following the best practice of using either start or end buttons with the stacked toast layout.",r),wi(Yo,Object.assign({key:"d1ecd90c87700aad4685e230cdd430aa286b8791",tabindex:"-1"},this.htmlAttributes,{style:{zIndex:`${6e4+this.overlayIndex}`},class:Km(this.color,Object.assign(Object.assign({[j]:!0},c1(this.cssClass)),{"overlay-hidden":!0,"toast-translucent":this.translucent})),onIonToastWillDismiss:this.dispatchCancelHandler}),wi("div",{key:"4bfc863417324de69e222054d5cf9c452038b41e",class:B},wi("div",{key:"3417940afec0392e81b7d54c7cb00f3ab6c30d47",class:"toast-container",part:"container"},this.renderButtons(d,"start"),this.icon!==void 0&&wi("ion-icon",{key:"6bf878fbc85c01e1e5faa9d97d46255a6511a952",class:"toast-icon",part:"icon",icon:this.icon,lazy:!1,"aria-hidden":"true"}),wi("div",{key:"54b500348a9c37660c3aff37436d9188e4374947",class:"toast-content",role:"status","aria-atomic":"true","aria-live":"polite"},!l&&f!==void 0&&this.renderHeader("oldHeader","true"),!l&&_!==void 0&&this.renderToastMessage("oldMessage","true"),l&&f!==void 0&&this.renderHeader("header"),l&&_!==void 0&&this.renderToastMessage("header")),this.renderButtons(A,"end"))))}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:LC,md:zC}}},[289,"ion-toast",{overlayIndex:[2,"overlay-index"],delegate:[16],hasController:[4,"has-controller"],color:[513],enterAnimation:[16],leaveAnimation:[16],cssClass:[1,"css-class"],duration:[2],header:[1],layout:[1],message:[1],keyboardClose:[4,"keyboard-close"],position:[1],positionAnchor:[1,"position-anchor"],buttons:[16],translucent:[4],animated:[4],icon:[1],htmlAttributes:[16],swipeGesture:[1,"swipe-gesture"],isOpen:[4,"is-open"],trigger:[1],revealContentToScreenReader:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64]},void 0,{swipeGesture:["swipeGestureChanged"],isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}]),DC=t=>({"toast-button":!0,"toast-button-icon-only":t.icon!==void 0&&t.text===void 0,[`toast-button-${t.role}`]:t.role!==void 0,"ion-focusable":!0,"ion-activatable":!0}),OC=t=>Pv(t.role)?"button cancel":"button";function NC(){if(typeof customElements>"u")return;["ion-toast","ion-icon","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-toast":customElements.get(e)||customElements.define(e,RC);break;case"ion-icon":customElements.get(e)||A1();break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const BC=NC;const $C=xC,UC="html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html.plt-mobile ion-app [contenteditable]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}",FC=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost()}componentDidLoad(){qC(async()=>{const e=qh(window,"hybrid");if(xn.getBoolean("_testing")||Mc(()=>import("./index7-BP8bFLVR.js"),[]).then(f=>f.startTapClick(xn)),xn.getBoolean("statusTap",e)&&Mc(()=>import("./status-tap-AR-oWCC-.js"),[]).then(f=>f.startStatusTap()),xn.getBoolean("inputShims",VC())){const f=qh(window,"ios")?"ios":"android";Mc(()=>import("./input-shims-z4QEiCRY.js"),[]).then(_=>_.startInputShims(xn,f))}const r=await Mc(()=>Promise.resolve().then(()=>UE),void 0),l=e||Nm();xn.getBoolean("hardwareBackButton",l)?r.startHardwareBackButton():(Nm()&&jl("[ion-app] - experimentalCloseWatcher was set to `true`, but hardwareBackButton was set to `false`. Both config options must be `true` for the Close Watcher API to be used."),r.blockHardwareBackButton()),typeof window<"u"&&Mc(()=>Promise.resolve().then(()=>rC),void 0).then(f=>f.startKeyboardAssist(window)),Mc(()=>import("./focus-visible-DY9QzpaF.js"),[]).then(f=>this.focusVisible=f.startFocusVisible())})}async setFocus(e){this.focusVisible&&this.focusVisible.setFocus(e)}render(){const e=Cs(this);return wi(Yo,{key:"9be440c65819e4fa67c2c3c6477ab40b3ad3eed3",class:{[e]:!0,"ion-page":!0,"force-statusbar-padding":xn.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return UC}},[256,"ion-app",{setFocus:[64]}]),VC=()=>!!(qh(window,"ios")&&qh(window,"mobile")||qh(window,"android")&&qh(window,"mobileweb")),qC=t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,32)};function HC(){if(typeof customElements>"u")return;["ion-app"].forEach(e=>{e==="ion-app"&&(customElements.get(e)||customElements.define(e,FC))})}const ZC=HC;const GC=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}ion-ripple-effect{color:var(--ripple-color)}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--background-hover:transparent;--background-hover-opacity:1;--background-focused:currentColor;--background-focused-opacity:.1;--border-radius:4px;--color:var(--ion-color-primary, #0054e9);--icon-margin-end:1px;--icon-margin-start:-4px;--icon-font-size:1.6em;--min-height:32px;font-size:clamp(17px, 1.0625rem, 21.998px)}.button-native{-webkit-transform:translateZ(0);transform:translateZ(0);overflow:visible;z-index:99}:host(.ion-activated) .button-native{opacity:0.4}@media (any-hover: hover){:host(:hover){opacity:0.6}}',WC=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}ion-ripple-effect{color:var(--ripple-color)}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--border-radius:4px;--background-focused:currentColor;--background-focused-opacity:.12;--background-hover:currentColor;--background-hover-opacity:0.04;--color:currentColor;--icon-margin-end:0;--icon-margin-start:0;--icon-font-size:1.5rem;--icon-font-weight:normal;--min-height:32px;--min-width:44px;--padding-start:12px;--padding-end:12px;font-size:0.875rem;font-weight:500;text-transform:uppercase}:host(.back-button-has-icon-only){--border-radius:50%;min-width:48px;min-height:48px;aspect-ratio:1/1}.button-native{-webkit-box-shadow:none;box-shadow:none}.button-text{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:0;padding-bottom:0}ion-icon{line-height:0.67;text-align:start}@media (any-hover: hover){:host(.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}',YC=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.inheritedAttributes={},this.disabled=!1,this.type="button",this.onClick=async r=>{const l=this.el.closest("ion-nav");return r.preventDefault(),l&&await l.canGoBack()?l.pop({animationBuilder:this.routerAnimation,skipIfBusy:!0}):OE(this.defaultHref,r,"back",this.routerAnimation)}}componentWillLoad(){this.inheritedAttributes=Hw(this.el),this.defaultHref===void 0&&(this.defaultHref=xn.get("backButtonDefaultHref"))}get backButtonIcon(){const e=this.icon;return e??(Cs(this)==="ios"?xn.get("backButtonIcon",sk):xn.get("backButtonIcon",nk))}get backButtonText(){const e=Cs(this)==="ios"?"Back":null;return this.text!=null?this.text:xn.get("backButtonText",e)}get hasIconOnly(){return this.backButtonIcon&&!this.backButtonText}get rippleType(){return this.hasIconOnly?"unbounded":"bounded"}render(){const{color:e,defaultHref:r,disabled:l,type:f,hasIconOnly:_,backButtonIcon:y,backButtonText:d,icon:A,inheritedAttributes:j}=this,B=r!==void 0,N=Cs(this),V=j["aria-label"]||d||"back";return wi(Yo,{key:"5466624a10f1ab56f5469e6dc07080303880f2fe",onClick:this.onClick,class:Km(e,{[N]:!0,button:!0,"back-button-disabled":l,"back-button-has-icon-only":_,"in-toolbar":Cv("ion-toolbar",this.el),"in-toolbar-color":Cv("ion-toolbar[color]",this.el),"ion-activatable":!0,"ion-focusable":!0,"show-back-button":B})},wi("button",{key:"63bc75ef0ad7cc9fb79e58217a3314b20acd73e3",type:f,disabled:l,class:"button-native",part:"native","aria-label":V},wi("span",{key:"5d3eacbd11af2245c6e1151cab446a0d96559ad8",class:"button-inner"},y&&wi("ion-icon",{key:"6439af0ae463764174e7d3207f02267811df666d",part:"icon",icon:y,"aria-hidden":"true",lazy:!1,"flip-rtl":A===void 0}),d&&wi("span",{key:"8ee89fb18dfdb5b75948a8b197ff4cdbc008742f",part:"text","aria-hidden":"true",class:"button-text"},d)),N==="md"&&wi("ion-ripple-effect",{key:"63803a884998bc73bea5afe0b2a0a14e3fa4d6bf",type:this.rippleType})))}get el(){return this}static get style(){return{ios:GC,md:WC}}},[289,"ion-back-button",{color:[513],defaultHref:[1025,"default-href"],disabled:[516],icon:[1],text:[1],type:[1],routerAnimation:[16]}]);function XC(){if(typeof customElements>"u")return;["ion-back-button","ion-icon","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-back-button":customElements.get(e)||customElements.define(e,YC);break;case"ion-icon":customElements.get(e)||A1();break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const KC=XC,JC=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",QC=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=qn(this,"ionNavWillLoad",7),this.ionNavWillChange=qn(this,"ionNavWillChange",3),this.ionNavDidChange=qn(this,"ionNavDidChange",3),this.lockController=mx(),this.gestureOrAnimationInProgress=!1,this.mode=Cs(this),this.animated=!0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(this.swipeHandler!==void 0)}async connectedCallback(){const e=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await Mc(async()=>{const{createSwipeBackGesture:r}=await import("./swipe-back-BkA_VY-8.js");return{createSwipeBackGesture:r}},[])).createSwipeBackGesture(this.el,()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart(),()=>e(),r=>{var l;return(l=this.ani)===null||l===void 0?void 0:l.progressStep(r)},(r,l,f)=>{if(this.ani){this.ani.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(r)},{oneTimeCallback:!0});let _=r?-.001:.001;r?_+=up([0,0],[.32,.72],[0,1],[1,1],l)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),_+=up([0,0],[1,0],[.68,.28],[1,1],l)[0]),this.ani.progressEnd(r?1:0,_,f)}else this.gestureOrAnimationInProgress=!1}),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(e,r,l){const f=await this.lockController.lock();let _=!1;try{_=await this.transition(e,r,l)}catch(y){Ju("[ion-router-outlet] - Exception in commit:",y)}return f(),_}async setRouteId(e,r,l,f){return{changed:await this.setRoot(e,r,{duration:l==="root"?0:void 0,direction:l==="back"?"back":"forward",animationBuilder:f}),element:this.activeEl}}async getRouteId(){const e=this.activeEl;return e?{id:e.tagName,element:e,params:this.activeParams}:void 0}async setRoot(e,r,l){if(this.activeComponent===e&&Gw(r,this.activeParams))return!1;const f=this.activeEl,_=await r_(this.delegate,this.el,e,["ion-page","ion-page-invisible"],r);return this.activeComponent=e,this.activeEl=_,this.activeParams=r,await this.commit(_,f,l),await h1(this.delegate,f),!0}async transition(e,r,l={}){if(r===e)return!1;this.ionNavWillChange.emit();const{el:f,mode:_}=this,y=this.animated&&xn.getBoolean("animated",!0),d=l.animationBuilder||this.animation||xn.get("navAnimation");return await Kw(Object.assign(Object.assign({mode:_,animated:y,enteringEl:e,leavingEl:r,baseEl:f,deepWait:Oy(f),progressCallback:l.progressAnimation?A=>{A!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,A.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)},{oneTimeCallback:!0}),A.progressEnd(0,0,0)):this.ani=A}:void 0},l),{animationBuilder:d})),this.ionNavDidChange.emit(),!0}render(){return wi("slot",{key:"84b50f1155b0d780dff802ee13223287259fd525"})}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return JC}},[257,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]},void 0,{swipeHandler:["swipeHandlerChanged"]}]);function eA(){if(typeof customElements>"u")return;["ion-router-outlet"].forEach(e=>{e==="ion-router-outlet"&&(customElements.get(e)||customElements.define(e,QC))})}const tA=eA;const iA=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, var(--ion-background-color-step-50, #f7f7f7)));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, var(--ion-background-color-step-150, rgba(0, 0, 0, 0.2)))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, var(--ion-text-color-step-400, #666666)));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #0054e9));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",nA=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, var(--ion-background-color-step-150, rgba(0, 0, 0, 0.07)))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, var(--ion-text-color-step-350, #595959)));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #0054e9));height:56px}",sA=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=qn(this,"ionTabBarChanged",7),this.ionTabBarLoaded=qn(this,"ionTabBarLoaded",7),this.keyboardCtrl=null,this.didLoad=!1,this.keyboardVisible=!1,this.translucent=!1}selectedTabChanged(){this.didLoad&&this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentDidLoad(){this.ionTabBarLoaded.emit(),this.didLoad=!0,this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}async connectedCallback(){this.keyboardCtrl=await Uk(async(e,r)=>{e===!1&&r!==void 0&&await r,this.keyboardVisible=e})}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}render(){const{color:e,translucent:r,keyboardVisible:l}=this,f=Cs(this),_=l&&this.el.getAttribute("slot")!=="top";return wi(Yo,{key:"388ec37ce308035bab78d6c9a016bb616e9517a9",role:"tablist","aria-hidden":_?"true":null,class:Km(e,{[f]:!0,"tab-bar-translucent":r,"tab-bar-hidden":_})},wi("slot",{key:"ce10ade2b86725e24f3254516483eeedd8ecb16a"}))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:iA,md:nA}}},[289,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]},void 0,{selectedTab:["selectedTabChanged"]}]);function rA(){if(typeof customElements>"u")return;["ion-tab-bar"].forEach(e=>{e==="ion-tab-bar"&&(customElements.get(e)||customElements.define(e,sA))})}const aA=rA;const oA=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:24px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){font-size:30px}',lA=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}',cA=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=qn(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.disabled=!1,this.selected=!1,this.onKeyUp=r=>{(r.key==="Enter"||r.key===" ")&&this.selectTab(r)},this.onClick=r=>{this.selectTab(r)}}onTabBarChanged(e){const r=e.target,l=this.el.parentElement;(e.composedPath().includes(l)||r?.contains(this.el))&&(this.selected=this.tab===e.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},ux(this.el,["aria-label"])),this.layout===void 0&&(this.layout=xn.get("tabButtonLayout","icon-top"))}selectTab(e){this.tab!==void 0&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),e.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:e,hasIcon:r,hasLabel:l,href:f,rel:_,target:y,layout:d,selected:A,tab:j,inheritedAttributes:B}=this,N=Cs(this),V={download:this.download,href:f,rel:_,target:y};return wi(Yo,{key:"ce9d29ced0c781d6b2fa62cd5feb801c11fc42e8",onClick:this.onClick,onKeyup:this.onKeyUp,id:j!==void 0?`tab-button-${j}`:null,class:{[N]:!0,"tab-selected":A,"tab-disabled":e,"tab-has-label":l,"tab-has-icon":r,"tab-has-label-only":l&&!r,"tab-has-icon-only":r&&!l,[`tab-layout-${d}`]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},wi("a",Object.assign({key:"01cb0ed2e77c5c1a8abd48da1bb07ac1b305d0b6"},V,{class:"button-native",part:"native",role:"tab","aria-selected":A?"true":null,"aria-disabled":e?"true":null,tabindex:e?"-1":void 0},B),wi("span",{key:"d0240c05f42217cfb186b86ff8a0c9cd70b9c8df",class:"button-inner"},wi("slot",{key:"0a20b84925037dbaa8bb4a495b813d3f7c2e58ac"})),N==="md"&&wi("ion-ripple-effect",{key:"4c92c27178cdac89d69cffef8d2c39c3644914e8",type:"unbounded"})))}get el(){return this}static get style(){return{ios:oA,md:lA}}},[289,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]);function uA(){if(typeof customElements>"u")return;["ion-tab-button","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-tab-button":customElements.get(e)||customElements.define(e,cA);break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const hA=uA;const dA=":host{left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%;contain:layout size style;z-index:0}.tabs-inner{position:relative;-ms-flex:1;flex:1;contain:layout size style}",fA=ko(class extends Ra{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=qn(this,"ionNavWillLoad",7),this.ionTabsWillChange=qn(this,"ionTabsWillChange",3),this.ionTabsDidChange=qn(this,"ionTabsDidChange",3),this.transitioning=!1,this.useRouter=!1,this.onTabClicked=r=>{const{href:l,tab:f}=r.detail;if(this.useRouter&&l!==void 0){const _=document.querySelector("ion-router");_&&_.push(l)}else this.select(f)}}async componentWillLoad(){if(this.useRouter||(this.useRouter=(!!this.el.querySelector("ion-router-outlet")||!!document.querySelector("ion-router"))&&!this.el.closest("[no-router]")),!this.useRouter){const e=this.tabs;e.length>0&&await this.select(e[0])}this.ionNavWillLoad.emit()}componentDidLoad(){this.updateTabBar()}componentDidUpdate(){this.updateTabBar()}updateTabBar(){const e=this.el.querySelector("ion-tab-bar");if(!e)return;const r=this.selectedTab?this.selectedTab.tab:void 0;r!==void 0&&e.selectedTab!==r&&(e.selectedTab=r)}async select(e){const r=V_(this.tabs,e);return this.shouldSwitch(r)?(await this.setActive(r),await this.notifyRouter(),this.tabSwitch(),!0):!1}async getTab(e){return V_(this.tabs,e)}getSelected(){return Promise.resolve(this.selectedTab?this.selectedTab.tab:void 0)}async setRouteId(e){const r=V_(this.tabs,e);return this.shouldSwitch(r)?(await this.setActive(r),{changed:!0,element:this.selectedTab,markVisible:()=>this.tabSwitch()}):{changed:!1,element:this.selectedTab}}async getRouteId(){var e;const r=(e=this.selectedTab)===null||e===void 0?void 0:e.tab;return r!==void 0?{id:r,element:this.selectedTab}:void 0}setActive(e){return this.transitioning?Promise.reject("transitioning already happening"):(this.transitioning=!0,this.leavingTab=this.selectedTab,this.selectedTab=e,this.ionTabsWillChange.emit({tab:e.tab}),e.active=!0,this.updateTabBar(),Promise.resolve())}tabSwitch(){const e=this.selectedTab,r=this.leavingTab;this.leavingTab=void 0,this.transitioning=!1,e&&r!==e&&(r&&(r.active=!1),this.ionTabsDidChange.emit({tab:e.tab}))}notifyRouter(){if(this.useRouter){const e=document.querySelector("ion-router");if(e)return e.navChanged("forward")}return Promise.resolve(!1)}shouldSwitch(e){const r=this.selectedTab;return e!==void 0&&e!==r&&!this.transitioning}get tabs(){return Array.from(this.el.querySelectorAll("ion-tab"))}render(){return wi(Yo,{key:"7b4b302f2942d8d131f6fc24e817989a8be08867",onIonTabButtonClick:this.onTabClicked},wi("slot",{key:"2c51cf14c0f17a8ddf2d879858c984cdf8fd3147",name:"top"}),wi("div",{key:"7e9d6055092d41bd9bc80ae15965f77e216feb84",class:"tabs-inner"},wi("slot",{key:"c308a787e37ff7f6653531d70deca597a7602d26"})),wi("slot",{key:"d5f5e693710c853570811602f859cf3e88272684",name:"bottom"}))}get el(){return this}static get style(){return dA}},[257,"ion-tabs",{useRouter:[1028,"use-router"],selectedTab:[32],select:[64],getTab:[64],getSelected:[64],setRouteId:[64],getRouteId:[64]}]),V_=(t,e)=>{const r=typeof e=="string"?t.find(l=>l.tab===e):e;return r||Ju(`[ion-tabs] - Tab with id: "${r}" does not exist`),r};function pA(){if(typeof customElements>"u")return;["ion-tabs"].forEach(e=>{e==="ion-tabs"&&(customElements.get(e)||customElements.define(e,fA))})}const mA=pA,gA="ionicons",a_={hydratedSelectorName:"hydrated",lazyLoad:!1,updatable:!0};var yA=Object.defineProperty,_A=(t,e)=>{for(var r in e)yA(t,r,{get:e[r],enumerable:!0})},Qd=t=>{if(t.__stencil__getHostRef)return t.__stencil__getHostRef()},vA=(t,e)=>{const r={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};r.$onReadyPromise$=new Promise(f=>r.$onReadyResolve$=f),t["s-p"]=[],t["s-rc"]=[];const l=r;return t.__stencil__getHostRef=()=>l,l},Hb=(t,e)=>e in t,o_=(t,e)=>(0,console.error)(t,e),Yy=new Map,xA="slot-fb{display:contents}slot-fb[hidden]{display:none}",Zb="http://www.w3.org/1999/xlink",Pc=typeof window<"u"?window:{},bA=Pc.HTMLElement||class{},Gh={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,r,l)=>t.addEventListener(e,r,l),rel:(t,e,r,l)=>t.removeEventListener(e,r,l),ce:(t,e)=>new CustomEvent(t,e)},wA=t=>Promise.resolve(t),H1=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),Bv=!1,Gb=[],Z1=[],SA=(t,e)=>r=>{t.push(r),Bv||(Bv=!0,Gh.raf(G1))},Wb=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(r){o_(r)}t.length=0},G1=()=>{Wb(Gb),Wb(Z1),(Bv=Gb.length>0)&&Gh.raf(G1)},wx=t=>wA().then(t),TA=SA(Z1),EA=t=>{const e=new URL(t,Gh.$resourcesUrl$);return e.origin!==Pc.location.origin?e.href:e.pathname},Sx=t=>(t=typeof t,t==="object"||t==="function");function kA(t){var e,r,l;return(l=(r=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:r.getAttribute("content"))!=null?l:void 0}var CA=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),AA={};_A(AA,{err:()=>W1,map:()=>MA,ok:()=>$v,unwrap:()=>PA,unwrapErr:()=>jA});var $v=t=>({isOk:!0,isErr:!1,value:t}),W1=t=>({isOk:!1,isErr:!0,value:t});function MA(t,e){if(t.isOk){const r=e(t.value);return r instanceof Promise?r.then(l=>$v(l)):$v(r)}if(t.isErr){const r=t.value;return W1(r)}throw"should never get here"}var PA=t=>{if(t.isOk)return t.value;throw t.value},jA=t=>{if(t.isErr)return t.value;throw t.value};var dy;function IA(t){var e;const r=this.attachShadow({mode:"open"});dy===void 0&&(dy=(e=void 0)!=null?e:null),dy&&r.adoptedStyleSheets.push(dy)}var ef=(t,e="")=>()=>{},tp=new WeakMap,LA=(t,e,r)=>{let l=Yy.get(t);H1&&r?(l=l||new CSSStyleSheet,typeof l=="string"?l=e:l.replaceSync(e)):l=e,Yy.set(t,l)},zA=(t,e,r)=>{var l;const f=Y1(e),_=Yy.get(f);if(!Pc.document)return f;if(t=t.nodeType===11?t:Pc.document,_)if(typeof _=="string"){t=t.head||t;let y=tp.get(t),d;if(y||tp.set(t,y=new Set),!y.has(f)){{d=Pc.document.createElement("style"),d.innerHTML=_;const A=(l=Gh.$nonce$)!=null?l:kA(Pc.document);if(A!=null&&d.setAttribute("nonce",A),!(e.$flags$&1))if(t.nodeName==="HEAD"){const j=t.querySelectorAll("link[rel=preconnect]"),B=j.length>0?j[j.length-1].nextSibling:t.querySelector("style");t.insertBefore(d,B?.parentNode===t?B:null)}else if("host"in t)if(H1){const j=new CSSStyleSheet;j.replaceSync(_),t.adoptedStyleSheets.unshift(j)}else{const j=t.querySelector("style");j?j.innerHTML=_+j.innerHTML:t.prepend(d)}else t.append(d);e.$flags$&1&&t.insertBefore(d,null)}e.$flags$&4&&(d.innerHTML+=xA),y&&y.add(f)}}else t.adoptedStyleSheets.includes(_)||t.adoptedStyleSheets.push(_);return f},RA=t=>{const e=t.$cmpMeta$,r=t.$hostElement$,l=e.$flags$,f=ef("attachStyles",e.$tagName$),_=zA(r.shadowRoot?r.shadowRoot:r.getRootNode(),e);l&10&&(r["s-sc"]=_,r.classList.add(_+"-h")),f()},Y1=(t,e)=>"sc-"+t.$tagName$,ky=(t,e,...r)=>{let l=null,f=null,_=!1,y=!1;const d=[],A=B=>{for(let N=0;N<B.length;N++)l=B[N],Array.isArray(l)?A(l):l!=null&&typeof l!="boolean"&&((_=typeof t!="function"&&!Sx(l))&&(l=String(l)),_&&y?d[d.length-1].$text$+=l:d.push(_?Uv(null,l):l),y=_)};if(A(r),e){e.key&&(f=e.key);{const B=e.className||e.class;B&&(e.class=typeof B!="object"?B:Object.keys(B).filter(N=>B[N]).join(" "))}}const j=Uv(t,null);return j.$attrs$=e,d.length>0&&(j.$children$=d),j.$key$=f,j},Uv=(t,e)=>{const r={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return r.$attrs$=null,r.$key$=null,r},X1={},DA=t=>t&&t.$tag$===X1,Tx=t=>{const e=CA(t);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${e}))(${e}\\b)`,"g")};Tx("::slotted");Tx(":host");Tx(":host-context");var K1=(t,e,r)=>t!=null&&!Sx(t)?e&4?t==="false"?!1:t===""||!!t:e&1?String(t):t:t,OA=(t,e,r)=>{const l=Gh.ce(e,r);return t.dispatchEvent(l),l},Yb=(t,e,r,l,f,_,y)=>{if(r===l)return;let d=Hb(t,e),A=e.toLowerCase();if(e==="class"){const j=t.classList,B=Xb(r);let N=Xb(l);j.remove(...B.filter(V=>V&&!N.includes(V))),j.add(...N.filter(V=>V&&!B.includes(V)))}else if(e==="style"){for(const j in r)(!l||l[j]==null)&&(j.includes("-")?t.style.removeProperty(j):t.style[j]="");for(const j in l)(!r||l[j]!==r[j])&&(j.includes("-")?t.style.setProperty(j,l[j]):t.style[j]=l[j])}else if(e!=="key")if(e==="ref")l&&l(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):Hb(Pc,A)?e=A.slice(2):e=A[2]+e.slice(3),r||l){const j=e.endsWith(J1);e=e.replace(BA,""),r&&Gh.rel(t,e,r,j),l&&Gh.ael(t,e,l,j)}}else{const j=Sx(l);if(d||j&&l!==null)try{if(t.tagName.includes("-"))t[e]!==l&&(t[e]=l);else{const N=l??"";e==="list"?d=!1:(r==null||t[e]!=N)&&(typeof t.__lookupSetter__(e)=="function"?t[e]=N:t.setAttribute(e,N))}}catch{}let B=!1;A!==(A=A.replace(/^xlink\:?/,""))&&(e=A,B=!0),l==null||l===!1?(l!==!1||t.getAttribute(e)==="")&&(B?t.removeAttributeNS(Zb,e):t.removeAttribute(e)):(!d||_&4||f)&&!j&&t.nodeType===1&&(l=l===!0?"":l,B?t.setAttributeNS(Zb,e,l):t.setAttribute(e,l))}},NA=/\s/,Xb=t=>(typeof t=="object"&&t&&"baseVal"in t&&(t=t.baseVal),!t||typeof t!="string"?[]:t.split(NA)),J1="Capture",BA=new RegExp(J1+"$"),Q1=(t,e,r,l)=>{const f=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,_=t&&t.$attrs$||{},y=e.$attrs$||{};for(const d of Kb(Object.keys(_)))d in y||Yb(f,d,_[d],void 0,r,e.$flags$);for(const d of Kb(Object.keys(y)))Yb(f,d,_[d],y[d],r,e.$flags$)};function Kb(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var Ex,eS=!1,Xy=(t,e,r)=>{const l=e.$children$[r];let f=0,_,y;if(l.$text$!==null)_=l.$elm$=Pc.document.createTextNode(l.$text$);else{if(!Pc.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(_=l.$elm$=Pc.document.createElement(l.$tag$),Q1(null,l,eS),l.$children$)for(f=0;f<l.$children$.length;++f)y=Xy(t,l,f),y&&_.appendChild(y)}return _["s-hn"]=Ex,_},tS=(t,e,r,l,f,_)=>{let y=t,d;for(y.shadowRoot&&y.tagName===Ex&&(y=y.shadowRoot);f<=_;++f)l[f]&&(d=Xy(null,r,f),d&&(l[f].$elm$=d,Cy(y,d,e)))},iS=(t,e,r)=>{for(let l=e;l<=r;++l){const f=t[l];if(f){const _=f.$elm$;nS(f),_&&_.remove()}}},$A=(t,e,r,l,f=!1)=>{let _=0,y=0,d=0,A=0,j=e.length-1,B=e[0],N=e[j],V=l.length-1,Q=l[0],ne=l[V],J,ye;for(;_<=j&&y<=V;)if(B==null)B=e[++_];else if(N==null)N=e[--j];else if(Q==null)Q=l[++y];else if(ne==null)ne=l[--V];else if(fy(B,Q,f))Xf(B,Q,f),B=e[++_],Q=l[++y];else if(fy(N,ne,f))Xf(N,ne,f),N=e[--j],ne=l[--V];else if(fy(B,ne,f))Xf(B,ne,f),Cy(t,B.$elm$,N.$elm$.nextSibling),B=e[++_],ne=l[--V];else if(fy(N,Q,f))Xf(N,Q,f),Cy(t,N.$elm$,B.$elm$),N=e[--j],Q=l[++y];else{for(d=-1,A=_;A<=j;++A)if(e[A]&&e[A].$key$!==null&&e[A].$key$===Q.$key$){d=A;break}d>=0?(ye=e[d],ye.$tag$!==Q.$tag$?J=Xy(e&&e[y],r,d):(Xf(ye,Q,f),e[d]=void 0,J=ye.$elm$),Q=l[++y]):(J=Xy(e&&e[y],r,y),Q=l[++y]),J&&Cy(B.$elm$.parentNode,J,B.$elm$)}_>j?tS(t,l[V+1]==null?null:l[V+1].$elm$,r,l,y,V):y>V&&iS(e,_,j)},fy=(t,e,r=!1)=>t.$tag$===e.$tag$?r?(r&&!t.$key$&&e.$key$&&(t.$key$=e.$key$),!0):t.$key$===e.$key$:!1,Xf=(t,e,r=!1)=>{const l=e.$elm$=t.$elm$,f=t.$children$,_=e.$children$,y=e.$text$;y===null?(Q1(t,e,eS),f!==null&&_!==null?$A(l,f,e,_,r):_!==null?(t.$text$!==null&&(l.textContent=""),tS(l,null,e,_,0,_.length-1)):!r&&a_.updatable&&f!==null&&iS(f,0,f.length-1)):t.$text$!==y&&(l.data=y)},nS=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(nS)},Cy=(t,e,r)=>t?.insertBefore(e,r),UA=(t,e,r=!1)=>{const l=t.$hostElement$,f=t.$cmpMeta$,_=t.$vnode$||Uv(null,null),d=DA(e)?e:ky(null,null,e);if(Ex=l.tagName,f.$attrsToReflect$&&(d.$attrs$=d.$attrs$||{},f.$attrsToReflect$.map(([A,j])=>d.$attrs$[j]=l[A])),r&&d.$attrs$)for(const A of Object.keys(d.$attrs$))l.hasAttribute(A)&&!["key","ref","style","class"].includes(A)&&(d.$attrs$[A]=l[A]);d.$tag$=null,d.$flags$|=4,t.$vnode$=d,d.$elm$=_.$elm$=l.shadowRoot||l,Xf(_,d,r)},sS=(t,e)=>{if(e&&!t.$onRenderResolve$&&e["s-p"]){const r=e["s-p"].push(new Promise(l=>t.$onRenderResolve$=()=>{e["s-p"].splice(r-1,1),l()}))}},kx=(t,e)=>{if(t.$flags$|=16,t.$flags$&4){t.$flags$|=512;return}return sS(t,t.$ancestorComponent$),TA(()=>FA(t,e))},FA=(t,e)=>{const r=t.$hostElement$,l=ef("scheduleUpdate",t.$cmpMeta$.$tagName$),f=r;if(!f)throw new Error(`Can't render component <${r.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let _;return e?_=op(f,"componentWillLoad",void 0,r):_=op(f,"componentWillUpdate",void 0,r),_=Jb(_,()=>op(f,"componentWillRender",void 0,r)),l(),Jb(_,()=>qA(t,f,e))},Jb=(t,e)=>VA(t)?t.then(e).catch(r=>{console.error(r),e()}):e(),VA=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",qA=async(t,e,r)=>{var l;const f=t.$hostElement$,_=ef("update",t.$cmpMeta$.$tagName$),y=f["s-rc"];r&&RA(t);const d=ef("render",t.$cmpMeta$.$tagName$);HA(t,e,f,r),y&&(y.map(A=>A()),f["s-rc"]=void 0),d(),_();{const A=(l=f["s-p"])!=null?l:[],j=()=>ZA(t);A.length===0?j():(Promise.all(A).then(j),t.$flags$|=4,A.length=0)}},HA=(t,e,r,l)=>{try{e=e.render(),t.$flags$&=-17,t.$flags$|=2,UA(t,e,l)}catch(f){o_(f,t.$hostElement$)}return null},ZA=t=>{const e=t.$cmpMeta$.$tagName$,r=t.$hostElement$,l=ef("postUpdate",e),f=r,_=t.$ancestorComponent$;op(f,"componentDidRender",void 0,r),t.$flags$&64?(op(f,"componentDidUpdate",void 0,r),l()):(t.$flags$|=64,WA(r),op(f,"componentDidLoad",void 0,r),l(),t.$onReadyResolve$(r),_||GA()),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),t.$flags$&512&&wx(()=>kx(t,!1)),t.$flags$&=-517},GA=t=>{wx(()=>OA(Pc,"appload",{detail:{namespace:gA}}))},op=(t,e,r,l)=>{if(t&&t[e])try{return t[e](r)}catch(f){o_(f,l)}},WA=t=>{var e;return t.classList.add((e=a_.hydratedSelectorName)!=null?e:"hydrated")},YA=(t,e)=>Qd(t).$instanceValues$.get(e),Qb=(t,e,r,l)=>{const f=Qd(t),_=t,y=f.$instanceValues$.get(e),d=f.$flags$,A=_;r=K1(r,l.$members$[e][0]);const j=Number.isNaN(y)&&Number.isNaN(r);if(r!==y&&!j){f.$instanceValues$.set(e,r);{if(l.$watchers$&&d&128){const N=l.$watchers$[e];N&&N.map(V=>{try{A[V](r,y,e)}catch(Q){o_(Q,_)}})}if((d&18)===2){if(A.componentShouldUpdate&&A.componentShouldUpdate(r,y,e)===!1)return;kx(f,!1)}}}},XA=(t,e,r)=>{var l,f;const _=t.prototype;if(e.$members$||e.$watchers$||t.watchers){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers);const y=Object.entries((l=e.$members$)!=null?l:{});y.map(([d,[A]])=>{if(A&31||A&32){const{get:j,set:B}=Object.getOwnPropertyDescriptor(_,d)||{};j&&(e.$members$[d][0]|=2048),B&&(e.$members$[d][0]|=4096),Object.defineProperty(_,d,{get(){return j?j.apply(this):YA(this,d)},configurable:!0,enumerable:!0}),Object.defineProperty(_,d,{set(N){const V=Qd(this);if(B){const Q=A&32?this[d]:V.$hostElement$[d];typeof Q>"u"&&V.$instanceValues$.get(d)?N=V.$instanceValues$.get(d):!V.$instanceValues$.get(d)&&Q&&V.$instanceValues$.set(d,Q),B.apply(this,[K1(N,A)]),N=A&32?this[d]:V.$hostElement$[d],Qb(this,d,N,e);return}{Qb(this,d,N,e);return}}})}});{const d=new Map;_.attributeChangedCallback=function(A,j,B){Gh.jmp(()=>{var N;const V=d.get(A);if(!(this.hasOwnProperty(V)&&a_.lazyLoad)){if(_.hasOwnProperty(V)&&typeof this[V]=="number"&&this[V]==B)return;if(V==null){const ne=Qd(this),J=ne?.$flags$;if(J&&!(J&8)&&J&128&&B!==j){const re=this,ge=(N=e.$watchers$)==null?void 0:N[A];ge?.forEach(le=>{re[le]!=null&&re[le].call(re,B,j,A)})}return}}const Q=Object.getOwnPropertyDescriptor(_,V);B=B===null&&typeof this[V]=="boolean"?!1:B,B!==this[V]&&(!Q.get||Q.set)&&(this[V]=B)})},t.observedAttributes=Array.from(new Set([...Object.keys((f=e.$watchers$)!=null?f:{}),...y.filter(([A,j])=>j[0]&15).map(([A,j])=>{var B;const N=j[1]||A;return d.set(N,A),j[0]&512&&((B=e.$attrsToReflect$)==null||B.push([A,N])),N})]))}}return t},e0=async(t,e,r,l)=>{let f;if((e.$flags$&32)===0){e.$flags$|=32;{f=t.constructor;const d=t.localName;customElements.whenDefined(d).then(()=>e.$flags$|=128)}if(f&&f.style){let d;typeof f.style=="string"&&(d=f.style);const A=Y1(r);if(!Yy.has(A)){const j=ef("registerStyles",r.$tagName$);LA(A,d,!!(r.$flags$&1)),j()}}}const _=e.$ancestorComponent$,y=()=>kx(e,!0);_&&_["s-rc"]?_["s-rc"].push(y):y()},KA=(t,e)=>{},JA=t=>{{const e=Qd(t),r=e.$cmpMeta$,l=ef("connectedCallback",r.$tagName$);if(e.$flags$&1)e?.$lazyInstance$||e?.$onReadyPromise$&&e.$onReadyPromise$.then(()=>KA());else{e.$flags$|=1;{let f=t;for(;f=f.parentNode||f.host;)if(f["s-p"]){sS(e,e.$ancestorComponent$=f);break}}r.$members$&&Object.entries(r.$members$).map(([f,[_]])=>{if(_&31&&t.hasOwnProperty(f)){const y=t[f];delete t[f],t[f]=y}}),a_.initializeNextTick?wx(()=>e0(t,e,r)):e0(t,e,r)}l()}},QA=async t=>{Qd(t),tp.has(t)&&tp.delete(t),t.shadowRoot&&tp.has(t.shadowRoot)&&tp.delete(t.shadowRoot)},eM=(t,e)=>{const r={$flags$:e[0],$tagName$:e[1]};r.$members$=e[2],r.$watchers$=t.$watchers$,r.$attrsToReflect$=[];const l=t.prototype.connectedCallback,f=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__hasHostListenerAttached:!1,__registerHost(){vA(this,r)},connectedCallback(){this.__hasHostListenerAttached||(Qd(this),this.__hasHostListenerAttached=!0),JA(this),l&&l.call(this)},disconnectedCallback(){QA(this),f&&f.call(this)},__attachShadow(){if(!this.shadowRoot)IA.call(this,r);else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${r.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=r.$tagName$,XA(t,r)};let q_;const tM=()=>{if(typeof window>"u")return new Map;if(!q_){const t=window;t.Ionicons=t.Ionicons||{},q_=t.Ionicons.map=t.Ionicons.map||new Map}return q_},iM=t=>{let e=H_(t.src);return e||(e=rS(t.name,t.icon,t.mode,t.ios,t.md),e?nM(e,t):t.icon&&(e=H_(t.icon),e||(e=H_(t.icon[t.mode]),e))?e:null)},nM=(t,e)=>{const r=tM().get(t);if(r)return r;try{return EA(`svg/${t}.svg`)}catch(l){console.log("e",l),console.warn(`[Ionicons Warning]: Could not load icon with name "${t}". Ensure that the icon is registered using addIcons or that the icon SVG data is passed directly to the icon component.`,e)}},rS=(t,e,r,l,f)=>(r=(r&&py(r))==="ios"?"ios":"md",l&&r==="ios"?t=py(l):f&&r==="md"?t=py(f):(!t&&e&&!aS(e)&&(t=e),Ky(t)&&(t=py(t))),!Ky(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),H_=t=>Ky(t)&&(t=t.trim(),aS(t))?t:null,aS=t=>t.length>0&&/(\/|\.)/.test(t),Ky=t=>typeof t=="string",py=t=>t.toLowerCase(),sM=(t,e=[])=>{const r={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(r[l]=t.getAttribute(l)),t.removeAttribute(l))}),r},rM=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl",aM=t=>{const e=document.createElement("div");e.innerHTML=t;for(let l=e.childNodes.length-1;l>=0;l--)e.childNodes[l].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[l]);const r=e.firstElementChild;if(r&&r.nodeName.toLowerCase()==="svg"){const l=r.getAttribute("class")||"";if(r.setAttribute("class",(l+" s-ion-icon").trim()),oS(r))return e.innerHTML}return""},oS=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const r=t.attributes[e].name;if(Ky(r)&&r.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!oS(t.childNodes[e]))return!1}return!0},oM=t=>t.startsWith("data:image/svg+xml"),lM=t=>t.indexOf(";utf8,")!==-1,lp=new Map,lS=new Map;let Z_;function Fv(t){return lp.set(t,""),""}const cM=(t,e)=>{const r=lS.get(t);return r||(typeof fetch<"u"&&typeof document<"u"?oM(t)&&lM(t)?Promise.resolve(uM(t)):hM(t,e):Promise.resolve(Fv(t)))};function uM(t){Z_||(Z_=new DOMParser);const r=Z_.parseFromString(t,"text/html").querySelector("svg");if(r)return lp.set(t,r.outerHTML),r.outerHTML;throw new Error(`Could not parse svg from ${t}`)}function hM(t,e){const r=fetch(t).then(l=>l.text().then(f=>{f&&e!==!1&&(f=aM(f));const _=f||"";return lp.set(t,_),_}).catch(()=>Fv(t))).catch(()=>Fv(t));return lS.set(t,r),r}const dM=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{transform:scaleX(1)}}:host(.icon-small){font-size:1.125rem !important}:host(.icon-large){font-size:2rem !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",fM=eM(class extends bA{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.didLoadIcon=!1,this.isVisible=!1,this.mode=pM(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=sM(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}componentDidLoad(){this.didLoadIcon||this.loadIcon()}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,r,l){if(!!!(this.lazy&&typeof window<"u"&&window.IntersectionObserver))return l();const _=this.io=new window.IntersectionObserver(y=>{y[0].isIntersecting&&(_.disconnect(),this.io=void 0,l())},{rootMargin:r});_.observe(e)}loadIcon(){if(this.isVisible){const e=iM(this);e&&(lp.has(e)?this.svgContent=lp.get(e):cM(e,this.sanitize).then(()=>this.svgContent=lp.get(e)),this.didLoadIcon=!0)}this.iconName=rS(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:r,inheritedAttributes:l,el:f}=this,_=this.mode||"md",y=r?(r.includes("arrow")||r.includes("chevron"))&&e!==!1:!1,d=e||y;return ky(X1,Object.assign({key:"0578c899781ca145dd8205acd9670af39b57cf2e",role:"img",class:Object.assign(Object.assign({[_]:!0},mM(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":d,"icon-rtl":d&&rM(f)})},l),this.svgContent?ky("div",{class:"icon-inner",innerHTML:this.svgContent}):ky("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return dM}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},void 0,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]),pM=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",mM=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function gM(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{e==="ion-icon"&&(customElements.get(e)||customElements.define(e,fM))})}const yM=gM,l_=Nt.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{},cleanupIonViewWillEnter:()=>{},cleanupIonViewDidEnter:()=>{},cleanupIonViewWillLeave:()=>{},cleanupIonViewDidLeave:()=>{}}),_M=class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[],this.ionViewWillEnterDestructorCallbacks=[],this.ionViewDidEnterDestructorCallbacks=[],this.ionViewWillLeaveDestructorCallbacks=[],this.ionViewDidLeaveDestructorCallbacks=[]}onIonViewWillEnter(t){if(t.id){const e=this.ionViewWillEnterCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewWillEnterCallbacks[e]=t:this.ionViewWillEnterCallbacks.push(t)}else this.ionViewWillEnterCallbacks.push(t)}teardownCallback(t,e){const r=e.filter(l=>l.id===t.id);r.length!==0&&(r.forEach(l=>{l&&typeof l.destructor=="function"&&l.destructor()}),e=e.filter(l=>l.id!==t.id))}cleanupIonViewWillEnter(t){this.teardownCallback(t,this.ionViewWillEnterDestructorCallbacks)}cleanupIonViewDidEnter(t){this.teardownCallback(t,this.ionViewDidEnterDestructorCallbacks)}cleanupIonViewWillLeave(t){this.teardownCallback(t,this.ionViewWillLeaveDestructorCallbacks)}cleanupIonViewDidLeave(t){this.teardownCallback(t,this.ionViewDidLeaveDestructorCallbacks)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewWillEnterDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewDidEnter(t){if(t.id){const e=this.ionViewDidEnterCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewDidEnterCallbacks[e]=t:this.ionViewDidEnterCallbacks.push(t)}else this.ionViewDidEnterCallbacks.push(t)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewDidEnterDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewWillLeave(t){if(t.id){const e=this.ionViewWillLeaveCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewWillLeaveCallbacks[e]=t:this.ionViewWillLeaveCallbacks.push(t)}else this.ionViewWillLeaveCallbacks.push(t)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewWillLeaveDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewDidLeave(t){if(t.id){const e=this.ionViewDidLeaveCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewDidLeaveCallbacks[e]=t:this.ionViewDidLeaveCallbacks.push(t)}else this.ionViewDidLeaveCallbacks.push(t)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewDidLeaveDestructorCallbacks.push({id:t.id,destructor:e})}),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(t){this.componentCanBeDestroyedCallback=t}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},vM=(t,e=[])=>{const r=ie.useContext(l_),l=ie.useRef();l.current=l.current||Math.floor(Math.random()*1e6),ie.useEffect(()=>(t.id=l.current,r.onIonViewDidEnter(t),()=>{r.cleanupIonViewDidEnter(t)}),e)},yu=Nt.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:t=>{typeof window<"u"&&(typeof t=="string"?window.location.pathname=t:window.history.back())},navigate:t=>{typeof window<"u"&&(window.location.pathname=t)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)},resetTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)}}),cS=t=>t.toLowerCase().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(""),Cx=t=>t.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`),Ax=(t,e,r={})=>{if(t instanceof Element){const l=xM(t.classList,e,r);l!==""&&(t.className=l),Object.keys(e).forEach(f=>{if(!(f==="children"||f==="style"||f==="ref"||f==="class"||f==="className"||f==="forwardedRef"))if(f.indexOf("on")===0&&f[2]===f[2].toUpperCase()){const _=f.substring(2),y=_[0].toLowerCase()+_.substring(1);c_(y)||wM(t,y,e[f])}else t[f]=e[f],typeof e[f]==="string"&&t.setAttribute(Cx(f),e[f])})}},xM=(t,e,r)=>{const l=e.className||e.class,f=r.className||r.class,_=G_(t),y=G_(l?l.split(" "):[]),d=G_(f?f.split(" "):[]),A=[];return _.forEach(j=>{y.has(j)?(A.push(j),y.delete(j)):d.has(j)||A.push(j)}),y.forEach(j=>A.push(j)),A.join(" ")},bM=t=>t==="doubleclick"?"dblclick":t;const c_=t=>{if(typeof document>"u")return!0;{const e="on"+bM(t);let r=e in document;if(!r){const l=document.createElement("div");l.setAttribute(e,"return;"),r=typeof l[e]=="function"}return r}},wM=(t,e,r)=>{const l=t.__events||(t.__events={}),f=l[e];f&&t.removeEventListener(e,f),t.addEventListener(e,l[e]=function(y){r&&r.call(this,y)})},G_=t=>{const e=new Map;return t.forEach(r=>e.set(r,r)),e},SM=(t,e)=>{typeof t=="function"?t(e):t!=null&&(t.current=e)},Mx=(...t)=>e=>{t.forEach(r=>{SM(r,e)})},TM=(t,e)=>{const r=(l,f)=>S.jsx(t,{...l,forwardedRef:f});return r.displayName=e,Nt.forwardRef(r)},jc=(t,e,r,l)=>{l!==void 0&&l();const f=cS(t),_=class extends Nt.Component{constructor(y){super(y),this.setComponentElRef=d=>{this.componentEl=d}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(y){Ax(this.componentEl,this.props,y)}render(){const{children:y,forwardedRef:d,style:A,className:j,ref:B,...N}=this.props,Q={...Object.keys(N).reduce((ne,J)=>{const ye=N[J];if(J.indexOf("on")===0&&J[2]===J[2].toUpperCase()){const re=J.substring(2).toLowerCase();typeof document<"u"&&c_(re)&&(ne[J]=ye)}else{const re=typeof ye;(re==="string"||re==="boolean"||re==="number")&&(ne[Cx(J)]=ye)}return ne},{}),ref:Mx(d,this.setComponentElRef),style:A};return ie.createElement(t,Q,y)}static get displayName(){return f}};return TM(_,f)},vs=jc("ion-content",void 0,void 0,Dk),Ys=jc("ion-spinner",void 0,void 0,bC),EM=jc("ion-tab",void 0,void 0,EC),pp=(t,e)=>{const r=(l,f)=>S.jsx(t,{...l,forwardedRef:f});return r.displayName=e,Nt.forwardRef(r)},Px=()=>{if(typeof window<"u"){const t=window.Ionic;if(t&&t.config)return t.config}return null},kM=(t,e)=>{t instanceof Element&&Object.keys(e).forEach(r=>{if(r.indexOf("on")===0&&r[2]===r[2].toUpperCase()){const l=r.substring(2),f=l[0].toLowerCase()+l.substring(1);c_(f)||CM(t,f)}})},CM=(t,e)=>{const r=t.__events||(t.__events={}),l=r[e];l&&(t.removeEventListener(e,l),r[e]=void 0)},AM=(t,e,r)=>{e&&e();const l=cS(t),f=class extends Nt.Component{constructor(_){super(_),this.handleIonMount=()=>{this.setState({isOpen:!0})},this.handleWillPresent=y=>{this.setState({isOpen:!0}),this.props.onWillPresent&&this.props.onWillPresent(y)},this.handleDidDismiss=y=>{const d=this.wrapperRef.current,A=this.ref.current;d&&A&&(A.append(d),this.setState({isOpen:!1})),this.props.onDidDismiss&&this.props.onDidDismiss(y)},this.ref=Nt.createRef(),this.stableMergedRefs=Mx(this.ref,this.props.forwardedRef),this.state={isOpen:!1},this.wrapperRef=Nt.createRef()}componentDidMount(){this.componentDidUpdate(this.props),this.ref.current?.addEventListener("ionMount",this.handleIonMount),this.ref.current?.addEventListener("willPresent",this.handleWillPresent),this.ref.current?.addEventListener("didDismiss",this.handleDidDismiss)}componentDidUpdate(_){const y=this.ref.current,{onDidDismiss:d,onWillPresent:A,...j}=this.props;Ax(y,j,_)}componentWillUnmount(){const _=this.ref.current;_&&this.state.isOpen&&(_.removeEventListener("didDismiss",this.handleDidDismiss),_.remove(),kM(_,this.props))}render(){const{children:_,forwardedRef:y,style:d,className:A,ref:j,...B}=this.props,V={...Object.keys(B).reduce((ne,J)=>{if(J.indexOf("on")===0&&J[2]===J[2].toUpperCase()){const ye=J.substring(2).toLowerCase();c_(ye)&&(ne[J]=B[J])}else["string","boolean","number"].includes(typeof B[J])&&(ne[Cx(J)]=B[J]);return ne},{}),ref:this.stableMergedRefs,style:d},Q=()=>r?`${t0} ion-page`:t0;return ie.createElement("template",{},ie.createElement(t,V,this.state.isOpen||this.props.keepContentsMounted?ie.createElement("div",{ref:this.wrapperRef,className:Q()},_):null))}static get displayName(){return l}};return pp(f,l)},t0="ion-delegate-host",$m=AM("ion-modal",$C,!0),MM=Nt.createContext({addOverlay:()=>{},removeOverlay:()=>{}}),PM=({onAddOverlay:t,onRemoveOverlay:e})=>{const[r,l]=ie.useState({}),f=ie.useRef({});ie.useEffect(()=>{t(_),e(y)},[]);const _=(A,j,B)=>{const N={...f.current};N[A]={component:j,containerElement:B},f.current=N,l(N)},y=A=>{const j={...f.current};delete j[A],f.current=j,l(j)},d=Object.keys(r);return S.jsx(S.Fragment,{children:d.map(A=>{const j=r[A];return ik.createPortal(j.component,j.containerElement,`overlay-${A}`)})})},jM=jc("ion-tab-button",void 0,void 0,hA),IM=jc("ion-tab-bar",void 0,void 0,aA),i0=jc("ion-tabs",void 0,void 0,mA),LM=jc("ion-back-button",void 0,void 0,KC),Vv=jc("ion-router-outlet",void 0,void 0,tA),zM=jc("ion-app",void 0,void 0,ZC),RM=jc("ion-icon",void 0,void 0,yM);class uS extends Nt.Component{constructor(e){super(e),this.ionContext={addOverlay:(r,l,f)=>{this.addOverlayCallback&&this.addOverlayCallback(r,l,f)},removeOverlay:r=>{this.removeOverlayCallback&&this.removeOverlayCallback(r)}}}render(){return S.jsxs(MM.Provider,{value:this.ionContext,children:[S.jsx(zM,{...this.props,children:this.props.children}),S.jsx(PM,{onAddOverlay:e=>{this.addOverlayCallback=e},onRemoveOverlay:e=>{this.removeOverlayCallback=e}})]})}}uS.displayName="IonApp";const jx=Nt.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class Ix extends Nt.PureComponent{constructor(e){super(e),this.ionPageElementRef=Nt.createRef(),this.stableMergedRefs=Mx(this.ionPageElementRef,this.props.forwardedRef),this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const{className:e,children:r,routeInfo:l,forwardedRef:f,..._}=this.props;return S.jsx(l_.Consumer,{children:y=>(this.ionLifeCycleContext=y,S.jsx("div",{className:e?`${e} ion-page`:"ion-page",ref:this.stableMergedRefs,..._,children:r}))})}static get contextType(){return jx}}class DM extends Nt.Component{constructor(e){super(e)}render(){const{className:e,children:r,forwardedRef:l,...f}=this.props;return this.context.hasIonicRouter()?S.jsx(Ix,{className:e?`${e}`:"",routeInfo:this.context.routeInfo,forwardedRef:l,...f,children:r}):S.jsx("div",{className:e?`ion-page ${e}`:"ion-page",ref:l,...f,children:r})}static get displayName(){return"IonPage"}static get contextType(){return yu}}const nr=pp(DM,"IonPage"),n0={main:0},Um=(t="main")=>{const e=(n0[t]??0)+1;return n0[t]=e,e.toString()},OM=(t,e)=>{const r=new WeakMap,l=`react-delegate-${Um()}`;let f=0;return{attachViewToDom:async(d,A,j,B)=>{const N=document.createElement("div");B&&N.classList.add(...B),d.appendChild(N);const V=A(j),Q=`${l}-${f++}`,ne=S1.createPortal(V,N,Q);return r.set(N,ne),t(ne),Promise.resolve(N)},removeViewFromDom:(d,A)=>{const j=r.get(A);return j&&e(j),A.remove(),Promise.resolve()}}},NM=jc("ion-nav",void 0,void 0,Jk),BM=({children:t,forwardedRef:e,...r})=>{const[l,f]=ie.useState([]),_=A=>f(j=>[...j,A]),y=A=>f(j=>j.filter(B=>B!==A)),d=ie.useMemo(()=>OM(_,y),[]);return S.jsx(NM,{delegate:d,ref:e,...r,children:l})};pp(BM,"IonNav");const hS=Nt.createContext({activeTab:void 0,selectTab:()=>!1,hasRouterOutlet:!1,tabBarProps:{ref:Nt.createRef()}}),$M=typeof HTMLElement<"u"?HTMLElement:class{};class UM extends Nt.Component{constructor(e){super(e),this.outletIsReady=!1,this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||Kd(this.ionRouterOutlet,()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)}),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const{StackManager:e,children:r,routeInfo:l,...f}=this.props;return S.jsx(l_.Consumer,{children:_=>(this.ionLifeCycleContext=_,S.jsx(e,{routeInfo:l,children:S.jsx(Vv,{setRef:y=>this.ionRouterOutlet=y,...f,children:r})}))})}static get contextType(){return jx}}class FM extends Nt.Component{constructor(e){super(e)}render(){const e=this.context.getStackManager(),{children:r,forwardedRef:l,...f}=this.props;return this.context.hasIonicRouter()?f.ionPage?S.jsx(UM,{StackManager:e,routeInfo:this.context.routeInfo,...f,children:r}):S.jsx(e,{routeInfo:this.context.routeInfo,children:S.jsx(Vv,{...f,forwardedRef:l,children:r})}):S.jsx(Vv,{ref:l,...this.props,children:this.props.children})}static get contextType(){return yu}}const ip=pp(FM,"IonRouterOutlet");class VM extends $M{constructor(){super()}}typeof window<"u"&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",VM));class qM extends Nt.Component{shouldComponentUpdate(){return!0}constructor(e){super(e),this.routerOutletRef=Nt.createRef(),this.tabBarRef=Nt.createRef(),this.ionTabContextState={activeTab:void 0,selectTab:()=>!1,hasRouterOutlet:!1,tabBarProps:{ref:this.tabBarRef}}}componentDidMount(){this.tabBarRef.current&&(this.ionTabContextState.activeTab=this.tabBarRef.current.state.activeTab,this.tabBarRef.current.setActiveTabOnContext=e=>{this.ionTabContextState.activeTab=e},this.ionTabContextState.selectTab=this.tabBarRef.current.selectTab)}renderTabsInner(e,r){return S.jsx(i0,{...this.props,children:Nt.Children.map(e,l=>Nt.isValidElement(l)&&(l.type===ip||l.type.isRouterOutlet||l.type===ie.Fragment&&l.props.children[0].type===ip)?r:l)})}render(){let e,r=!1;const{className:l,onIonTabsDidChange:f,onIonTabsWillChange:_,...y}=this.props,d=typeof this.props.children=="function"?this.props.children(this.ionTabContextState):this.props.children;if(Nt.Children.forEach(d,A=>{if(A==null||typeof A!="object"||!A.hasOwnProperty("type"))return;A.type===ip||A.type.isRouterOutlet?e=Nt.cloneElement(A):A.type===ie.Fragment&&A.props.children[0].type===ip?e=Nt.cloneElement(A.props.children[0]):A.type===EM&&(r=!0),this.ionTabContextState.hasRouterOutlet=!!e;let j={...this.ionTabContextState.tabBarProps};f!==void 0&&(j={...j,onIonTabsDidChange:f}),_!==void 0&&(j={...j,onIonTabsWillChange:_}),this.ionTabContextState.tabBarProps=j}),!e&&!r)throw new Error("IonTabs must contain an IonRouterOutlet or an IonTab");if(e&&r)throw new Error("IonTabs cannot contain an IonRouterOutlet and an IonTab at the same time");return r?S.jsx(i0,{...this.props}):S.jsx(hS.Provider,{value:this.ionTabContextState,children:this.context.hasIonicRouter()?S.jsx(Ix,{className:l?`${l}`:"",routeInfo:this.context.routeInfo,...y,children:this.renderTabsInner(d,e)}):this.renderTabsInner(d,e)})}static get contextType(){return yu}}class Hd extends Nt.Component{shouldComponentUpdate(){return!0}constructor(e){super(e),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const{onClick:e,...r}=this.props;return S.jsx(jM,{onIonTabButtonClick:this.handleIonTabButtonClick,...r})}static get displayName(){return"IonTabButton"}}const s0=(t,e)=>{if(e===void 0)return!1;const r=e.endsWith("/")&&e!=="/"?e.slice(0,-1):e;return t===r||t.startsWith(r+"/")};class HM extends Nt.PureComponent{constructor(e){super(e),this.setActiveTabOnContext=l=>{};const r={};Nt.Children.forEach(e.children,l=>{l!=null&&typeof l=="object"&&l.props&&(l.type===Hd||l.type.isTabButton)&&(r[l.props.tab]={originalHref:l.props.href,currentHref:l.props.href,originalRouteOptions:l.props.href===e.routeInfo?.pathname?e.routeInfo?.routeOptions:void 0,currentRouteOptions:l.props.href===e.routeInfo?.pathname?e.routeInfo?.routeOptions:void 0})}),this.state={tabs:r},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const e=this.state.tabs,l=Object.keys(e).find(f=>{const _=e[f].originalHref;return s0(this.props.routeInfo.pathname,_)});l&&this.setState({activeTab:l})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(e){const r=this.state.tabs[e];return r?(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:r.currentHref,tab:e,selected:e===this.state.activeTab,routeOptions:void 0}})),!0):!1}static getDerivedStateFromProps(e,r){const l={...r.tabs},_=Object.keys(r.tabs).find(d=>{const A=r.tabs[d].originalHref;return s0(e.routeInfo.pathname,A)});Nt.Children.forEach(e.children,d=>{if(d!=null&&typeof d=="object"&&d.props&&(d.type===Hd||d.type.isTabButton)){const A=l[d.props.tab];(!A||A.originalHref!==d.props.href)&&(l[d.props.tab]={originalHref:d.props.href,currentHref:d.props.href,originalRouteOptions:d.props.routeOptions,currentRouteOptions:d.props.routeOptions})}});const{activeTab:y}=r;if(_&&y){const d=r.tabs[y].currentHref,A=r.tabs[y].currentRouteOptions;(_!==y||d!==e.routeInfo?.pathname||A!==e.routeInfo?.routeOptions)&&(l[_]={originalHref:l[_].originalHref,currentHref:e.routeInfo.pathname+(e.routeInfo.search||""),originalRouteOptions:l[_].originalRouteOptions,currentRouteOptions:e.routeInfo?.routeOptions},e.routeInfo.routeAction==="pop"&&_!==y&&(l[y]={originalHref:l[y].originalHref,currentHref:l[y].originalHref,originalRouteOptions:l[y].originalRouteOptions,currentRouteOptions:l[y].currentRouteOptions}))}return _&&e.onSetCurrentTab(_,e.routeInfo),{activeTab:_,tabs:l}}onTabButtonClick(e,r){const l=this.state.tabs[e.detail.tab],f=l.originalHref,_=this.props.tabsContext?.hasRouterOutlet,y=_?e.detail.href:"",{activeTab:d}=this.state;r&&r(e),d===e.detail.tab?f!==y&&this.context.resetTab(e.detail.tab,f,l.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:e.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:e.detail.tab}})),_&&(this.setActiveTabOnContext(e.detail.tab),this.context.changeTab(e.detail.tab,y,e.detail.routeOptions)))}renderTabButton(e){return r=>{if(r!=null&&r.props&&(r.type===Hd||r.type.isTabButton)){const l=r.props.tab===e?this.props.routeInfo?.pathname:this.state.tabs[r.props.tab].currentHref,f=r.props.tab===e?this.props.routeInfo?.routeOptions:this.state.tabs[r.props.tab].currentRouteOptions;return Nt.cloneElement(r,{href:l,routeOptions:f,onClick:_=>this.onTabButtonClick(_,r.props.onClick)})}return null}}render(){const{activeTab:e}=this.state;return S.jsx(IM,{...this.props,selectedTab:e,children:Nt.Children.map(this.props.children,this.renderTabButton(e))})}static get contextType(){return yu}}const ZM=Nt.memo(({forwardedRef:t,...e})=>{const r=ie.useContext(yu),l=ie.useContext(hS),f=t||l.tabBarProps.ref,_={...l.tabBarProps,ref:f};return S.jsx(HM,{ref:f,...e,routeInfo:e.routeInfo||r.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:r.setCurrentTab,tabsContext:{...l,tabBarProps:_},children:e.children})}),GM=pp(ZM,"IonTabBar");class OD extends Nt.Component{constructor(){super(...arguments),this.clickButton=e=>{if(e.target&&e.target.closest("ion-nav")!==null)return;const{defaultHref:r,routerAnimation:l}=this.props;this.context.hasIonicRouter()?(e.stopPropagation(),this.context.goBack(r,l)):r!==void 0&&(window.location.href=r)}}render(){return S.jsx(LM,{onClick:this.clickButton,...this.props})}static get displayName(){return"IonBackButton"}static get contextType(){return yu}shouldComponentUpdate(){return!0}}class WM extends Nt.PureComponent{constructor(e){super(e),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){const{icon:e,ios:r,md:l,mode:f,..._}=this.props;let y;const d=Px(),A=f||d?.get("mode");return r||l?A==="ios"?y=r??l??e:y=l??r??e:y=e,S.jsx(RM,{ref:this.props.forwardedRef,icon:y,..._,children:this.props.children})}static get contextType(){return yu}}pp(WM,"IonIcon");class Lx extends Nt.PureComponent{render(){const e=this.context.getIonRoute();return!this.context.hasIonicRouter()||!Lx?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null):S.jsx(e,{...this.props})}static get contextType(){return yu}}class dS extends Nt.PureComponent{render(){const e=this.context.getIonRedirect();return!this.context.hasIonicRouter()||!dS?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRedirect>"),null):S.jsx(e,{...this.props})}static get contextType(){return yu}}const YM=Nt.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});class ND extends Nt.PureComponent{constructor(e){super(e),this.nodes=new Map,this.animation=pn(e.id)}setupAnimation(e){const r=this.animation;this.nodes.size>0&&r.addElement(Array.from(this.nodes.values())),r0(r,e),a0(r,e)}componentDidMount(){const e=this.props;this.setupAnimation(e)}componentDidUpdate(e){const r=this.animation,l=this.props;r0(r,l,e),XM(r,l,e),a0(r,l,e)}render(){const{children:e}=this.props;return S.jsx(S.Fragment,{children:Nt.Children.map(e,(r,l)=>Nt.cloneElement(r,{ref:f=>this.nodes.set(l,f)}))})}}const r0=(t,e={},r={})=>{const l=["children","progressStart","progressStep","progressEnd","pause","stop","destroy","play","from","to","fromTo","onFinish"];for(const A in e)e.hasOwnProperty(A)&&!l.includes(A)&&e[A]!==r[A]&&t[A](e[A]);const f=e.from;f&&f!==r.from&&(Array.isArray(f)?f:[f]).forEach(j=>t.from(j.property,j.value));const _=e.to;_&&_!==r.to&&(Array.isArray(_)?_:[_]).forEach(j=>t.to(j.property,j.value));const y=e.fromTo;y&&y!==r.fromTo&&(Array.isArray(y)?y:[y]).forEach(j=>t.fromTo(j.property,j.fromValue,j.toValue));const d=e.onFinish;d&&d!==r.onFinish&&(Array.isArray(d)?d:[d]).forEach(j=>t.onFinish(j.callback,j.opts))},XM=(t,e={},r={})=>{const{progressStart:l,progressStep:f,progressEnd:_}=e;l&&(r.progressStart?.forceLinearEasing!==l?.forceLinearEasing||r.progressStart?.step!==l?.step)&&t.progressStart(l.forceLinearEasing,l.step),f&&r.progressStep?.step!==f?.step&&t.progressStep(f.step),_&&(r.progressEnd?.playTo!==_?.playTo||r.progressEnd?.step!==_?.step||r?.dur!==_?.dur)&&t.progressEnd(_.playTo,_.step,_.dur)},a0=(t,e={},r={})=>{!r.play&&e.play&&t.play(),!r.pause&&e.pause&&t.pause(),!r.stop&&e.stop&&t.stop(),!r.destroy&&e.destroy&&t.destroy()};function KM(t,e,r){const l=ie.useRef(),f=ie.useMemo(()=>`on${t}DidDismiss`,[t]),_=ie.useMemo(()=>`on${t}DidPresent`,[t]),y=ie.useMemo(()=>`on${t}WillDismiss`,[t]),d=ie.useMemo(()=>`on${t}WillPresent`,[t]);r();const A=ie.useCallback(async B=>{if(l.current)return;const{onDidDismiss:N,onWillDismiss:V,onDidPresent:Q,onWillPresent:ne,...J}=B,ye=re=>{N&&N(re),l.current=void 0};l.current=await e.create({...J}),Ax(l.current,{[f]:ye,[_]:re=>Q&&Q(re),[y]:re=>V&&V(re),[d]:re=>ne&&ne(re)}),l.current.present()},[e]),j=ie.useCallback(async()=>{l.current&&await l.current.dismiss(),l.current=void 0},[]);return{present:A,dismiss:j}}function JM(){const t=KM("IonToast",qE,BC);return[ie.useCallback((r,l)=>typeof r=="string"?t.present({message:r,duration:l}):t.present(r),[t.present]),t.dismiss]}const QM=(t={})=>{typeof document<"u"&&document.documentElement.classList.add("ion-ce"),AE({...t})},fS=Nt.createContext({addViewItem:()=>{},canGoBack:()=>{},clearOutlet:()=>{},createViewItem:()=>{},findViewItemByPathname:()=>{},findLeavingViewItemByRouteInfo:()=>{},findViewItemByRouteInfo:()=>{},getChildrenToRender:()=>{},goBack:()=>{},unMountViewItem:()=>{}});class o0 extends Nt.Component{constructor(e){super(e),this.ionLifeCycleContext=new _M,this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed(()=>{this.props.mount||this._isMounted&&this.setState({show:!1},()=>this.props.removeView())}),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:e}=this.state;return S.jsx(l_.Provider,{value:this.ionLifeCycleContext,children:e&&this.props.children})}}class eP{constructor(){this.locationHistory=[],this.tabHistory={}}add(e){e.routeAction==="push"||e.routeAction==null?this._add(e):e.routeAction==="pop"?this._pop(e):e.routeAction==="replace"&&this._replace(e),e.routeDirection==="root"&&(this._clear(),this._add(e))}clearTabStack(e){const r=this._getRouteInfosByKey(e);r&&(r.forEach(l=>{this.locationHistory=this.locationHistory.filter(f=>f.id!==l.id)}),this.tabHistory[e]=[])}update(e){const r=this.locationHistory.findIndex(f=>f.id===e.id);r>-1&&this.locationHistory.splice(r,1,e);const l=this.tabHistory[e.tab||""];if(l){const f=l.findIndex(_=>_.id===e.id);f>-1?l.splice(f,1,e):l.push(e)}else e.tab&&(this.tabHistory[e.tab]=[e])}_add(e){const r=this._getRouteInfosByKey(e.tab);r&&(this._areRoutesEqual(r[r.length-1],e)&&r.pop(),r.push(e)),this.locationHistory.push(e)}_areRoutesEqual(e,r){return!e||!r?!1:e.pathname===r.pathname&&e.search===r.search}_pop(e){const r=this._getRouteInfosByKey(e.tab);r&&(r.pop(),r.pop(),r.push(e)),this.locationHistory.pop(),this.locationHistory.pop(),this.locationHistory.push(e)}_replace(e){const r=this._getRouteInfosByKey(e.tab);r&&r.pop(),this.locationHistory.pop(),this._add(e)}_clear(){Object.keys(this.tabHistory).forEach(r=>this.tabHistory[r]=[]),this.locationHistory=[]}_getRouteInfosByKey(e){let r;return e&&(r=this.tabHistory[e],r||(r=this.tabHistory[e]=[])),r}getFirstRouteInfoForTab(e){const r=this._getRouteInfosByKey(e);if(r)return r[0]}getCurrentRouteInfoForTab(e){const r=this._getRouteInfosByKey(e);if(r)return r[r.length-1]}findLastLocation(e){const r=this._getRouteInfosByKey(e.tab);if(r)for(let l=r.length-2;l>=0;l--){const f=r[l];if(f&&f.pathname===e.pushedByRoute)return f}for(let l=this.locationHistory.length-2;l>=0;l--){const f=this.locationHistory[l];if(f&&f.pathname===e.pushedByRoute)return f}}previous(){return this.locationHistory[this.locationHistory.length-2]||this.locationHistory[this.locationHistory.length-1]}current(){return this.locationHistory[this.locationHistory.length-1]}canGoBack(){return this.locationHistory.length>1}}class tP extends Nt.PureComponent{constructor(e){super(e),this.ionRouterContextValue={push:(r,l,f,_,y)=>{this.navigate(r,l,f,y,_)},back:r=>{this.goBack(void 0,r)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){typeof document<"u"&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){typeof document<"u"&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(e){e.detail.register(0,r=>{this.nativeGoBack(),r()})}goBack(e,r){this.props.onNavigateBack(e,r)}nativeGoBack(){this.props.onNativeBack()}navigate(e,r="forward",l="push",f,_,y){this.props.onNavigate(e,l,r,f,_,y)}getPageManager(){return Ix}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return S.jsx(yu.Provider,{value:{...this.state,routeInfo:this.props.routeInfo},children:S.jsx(YM.Provider,{value:{...this.ionRouterContextValue,routeInfo:this.props.routeInfo},children:this.props.children})})}}class iP{constructor(){this.viewStacks={},this.add=this.add.bind(this),this.clear=this.clear.bind(this),this.getViewItemsForOutlet=this.getViewItemsForOutlet.bind(this),this.remove=this.remove.bind(this)}add(e){const{outletId:r}=e;this.viewStacks[r]?this.viewStacks[r].push(e):this.viewStacks[r]=[e]}clear(e){return setTimeout(()=>{delete this.viewStacks[e]},500)}getViewItemsForOutlet(e){return this.viewStacks[e]||[]}remove(e){const{outletId:r}=e,l=this.viewStacks[r];if(l){const f=l.find(_=>_.id===e.id);f&&(f.mount=!1,this.viewStacks[r]=l.filter(_=>_.id!==f.id))}}getStackIds(){return Object.keys(this.viewStacks)}getAllViewItems(){const e=this.getStackIds(),r=[];return e.forEach(l=>{r.push(...this.viewStacks[l])}),r}}function Ku(t,e){var r={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(r[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(t);f<l.length;f++)e.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(t,l[f])&&(r[l[f]]=t[l[f]]);return r}function nP(t,e,r,l){function f(_){return _ instanceof r?_:new r(function(y){y(_)})}return new(r||(r=Promise))(function(_,y){function d(B){try{j(l.next(B))}catch(N){y(N)}}function A(B){try{j(l.throw(B))}catch(N){y(N)}}function j(B){B.done?_(B.value):f(B.value).then(d,A)}j((l=l.apply(t,e||[])).next())})}function Wo(){return Wo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var l in r)({}).hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Wo.apply(null,arguments)}function my(t){return t.charAt(0)==="/"}function W_(t,e){for(var r=e,l=r+1,f=t.length;l<f;r+=1,l+=1)t[r]=t[l];t.pop()}function sP(t,e){e===void 0&&(e="");var r=t&&t.split("/")||[],l=e&&e.split("/")||[],f=t&&my(t),_=e&&my(e),y=f||_;if(t&&my(t)?l=r:r.length&&(l.pop(),l=l.concat(r)),!l.length)return"/";var d;if(l.length){var A=l[l.length-1];d=A==="."||A===".."||A===""}else d=!1;for(var j=0,B=l.length;B>=0;B--){var N=l[B];N==="."?W_(l,B):N===".."?(W_(l,B),j++):j&&(W_(l,B),j--)}if(!y)for(;j--;j)l.unshift("..");y&&l[0]!==""&&(!l[0]||!my(l[0]))&&l.unshift("");var V=l.join("/");return d&&V.substr(-1)!=="/"&&(V+="/"),V}function l0(t){return t.valueOf?t.valueOf():Object.prototype.valueOf.call(t)}function Ay(t,e){if(t===e)return!0;if(t==null||e==null)return!1;if(Array.isArray(t))return Array.isArray(e)&&t.length===e.length&&t.every(function(f,_){return Ay(f,e[_])});if(typeof t=="object"||typeof e=="object"){var r=l0(t),l=l0(e);return r!==t||l!==e?Ay(r,l):Object.keys(Object.assign({},t,e)).every(function(f){return Ay(t[f],e[f])})}return!1}var rP="Invariant failed";function nf(t,e){throw new Error(rP)}function Pm(t){return t.charAt(0)==="/"?t:"/"+t}function c0(t){return t.charAt(0)==="/"?t.substr(1):t}function aP(t,e){return t.toLowerCase().indexOf(e.toLowerCase())===0&&"/?#".indexOf(t.charAt(e.length))!==-1}function pS(t,e){return aP(t,e)?t.substr(e.length):t}function mS(t){return t.charAt(t.length-1)==="/"?t.slice(0,-1):t}function oP(t){var e=t||"/",r="",l="",f=e.indexOf("#");f!==-1&&(l=e.substr(f),e=e.substr(0,f));var _=e.indexOf("?");return _!==-1&&(r=e.substr(_),e=e.substr(0,_)),{pathname:e,search:r==="?"?"":r,hash:l==="#"?"":l}}function Ql(t){var e=t.pathname,r=t.search,l=t.hash,f=e||"/";return r&&r!=="?"&&(f+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(f+=l.charAt(0)==="#"?l:"#"+l),f}function Go(t,e,r,l){var f;typeof t=="string"?(f=oP(t),f.state=e):(f=Wo({},t),f.pathname===void 0&&(f.pathname=""),f.search?f.search.charAt(0)!=="?"&&(f.search="?"+f.search):f.search="",f.hash?f.hash.charAt(0)!=="#"&&(f.hash="#"+f.hash):f.hash="",e!==void 0&&f.state===void 0&&(f.state=e));try{f.pathname=decodeURI(f.pathname)}catch(_){throw _ instanceof URIError?new URIError('Pathname "'+f.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):_}return r&&(f.key=r),l?f.pathname?f.pathname.charAt(0)!=="/"&&(f.pathname=sP(f.pathname,l.pathname)):f.pathname=l.pathname:f.pathname||(f.pathname="/"),f}function lP(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&Ay(t.state,e.state)}function zx(){var t=null;function e(y){return t=y,function(){t===y&&(t=null)}}function r(y,d,A,j){if(t!=null){var B=typeof t=="function"?t(y,d):t;typeof B=="string"?typeof A=="function"?A(B,j):j(!0):j(B!==!1)}else j(!0)}var l=[];function f(y){var d=!0;function A(){d&&y.apply(void 0,arguments)}return l.push(A),function(){d=!1,l=l.filter(function(j){return j!==A})}}function _(){for(var y=arguments.length,d=new Array(y),A=0;A<y;A++)d[A]=arguments[A];l.forEach(function(j){return j.apply(void 0,d)})}return{setPrompt:e,confirmTransitionTo:r,appendListener:f,notifyListeners:_}}var gS=!!(typeof window<"u"&&window.document&&window.document.createElement);function yS(t,e){e(window.confirm(t))}function cP(){var t=window.navigator.userAgent;return(t.indexOf("Android 2.")!==-1||t.indexOf("Android 4.0")!==-1)&&t.indexOf("Mobile Safari")!==-1&&t.indexOf("Chrome")===-1&&t.indexOf("Windows Phone")===-1?!1:window.history&&"pushState"in window.history}function uP(){return window.navigator.userAgent.indexOf("Trident")===-1}function hP(){return window.navigator.userAgent.indexOf("Firefox")===-1}function dP(t){return t.state===void 0&&navigator.userAgent.indexOf("CriOS")===-1}var u0="popstate",h0="hashchange";function d0(){try{return window.history.state||{}}catch{return{}}}function fP(t){t===void 0&&(t={}),gS||nf();var e=window.history,r=cP(),l=!uP(),f=t,_=f.forceRefresh,y=_===void 0?!1:_,d=f.getUserConfirmation,A=d===void 0?yS:d,j=f.keyLength,B=j===void 0?6:j,N=t.basename?mS(Pm(t.basename)):"";function V(Et){var ot=Et||{},xe=ot.key,Le=ot.state,tt=window.location,rt=tt.pathname,gt=tt.search,Pt=tt.hash,Ot=rt+gt+Pt;return N&&(Ot=pS(Ot,N)),Go(Ot,Le,xe)}function Q(){return Math.random().toString(36).substr(2,B)}var ne=zx();function J(Et){Wo(ut,Et),ut.length=e.length,ne.notifyListeners(ut.location,ut.action)}function ye(Et){dP(Et)||le(V(Et.state))}function re(){le(V(d0()))}var ge=!1;function le(Et){if(ge)ge=!1,J();else{var ot="POP";ne.confirmTransitionTo(Et,ot,A,function(xe){xe?J({action:ot,location:Et}):me(Et)})}}function me(Et){var ot=ut.location,xe=ke.indexOf(ot.key);xe===-1&&(xe=0);var Le=ke.indexOf(Et.key);Le===-1&&(Le=0);var tt=xe-Le;tt&&(ge=!0,He(tt))}var be=V(d0()),ke=[be.key];function Me(Et){return N+Ql(Et)}function Ue(Et,ot){var xe="PUSH",Le=Go(Et,ot,Q(),ut.location);ne.confirmTransitionTo(Le,xe,A,function(tt){if(tt){var rt=Me(Le),gt=Le.key,Pt=Le.state;if(r)if(e.pushState({key:gt,state:Pt},null,rt),y)window.location.href=rt;else{var Ot=ke.indexOf(ut.location.key),ei=ke.slice(0,Ot+1);ei.push(Le.key),ke=ei,J({action:xe,location:Le})}else window.location.href=rt}})}function Fe(Et,ot){var xe="REPLACE",Le=Go(Et,ot,Q(),ut.location);ne.confirmTransitionTo(Le,xe,A,function(tt){if(tt){var rt=Me(Le),gt=Le.key,Pt=Le.state;if(r)if(e.replaceState({key:gt,state:Pt},null,rt),y)window.location.replace(rt);else{var Ot=ke.indexOf(ut.location.key);Ot!==-1&&(ke[Ot]=Le.key),J({action:xe,location:Le})}else window.location.replace(rt)}})}function He(Et){e.go(Et)}function lt(){He(-1)}function Ye(){He(1)}var Mt=0;function et(Et){Mt+=Et,Mt===1&&Et===1?(window.addEventListener(u0,ye),l&&window.addEventListener(h0,re)):Mt===0&&(window.removeEventListener(u0,ye),l&&window.removeEventListener(h0,re))}var Tt=!1;function Be(Et){Et===void 0&&(Et=!1);var ot=ne.setPrompt(Et);return Tt||(et(1),Tt=!0),function(){return Tt&&(Tt=!1,et(-1)),ot()}}function ct(Et){var ot=ne.appendListener(Et);return et(1),function(){et(-1),ot()}}var ut={length:e.length,action:"POP",location:be,createHref:Me,push:Ue,replace:Fe,go:He,goBack:lt,goForward:Ye,block:Be,listen:ct};return ut}var f0="hashchange",pP={hashbang:{encodePath:function(e){return e.charAt(0)==="!"?e:"!/"+c0(e)},decodePath:function(e){return e.charAt(0)==="!"?e.substr(1):e}},noslash:{encodePath:c0,decodePath:Pm},slash:{encodePath:Pm,decodePath:Pm}};function _S(t){var e=t.indexOf("#");return e===-1?t:t.slice(0,e)}function Tm(){var t=window.location.href,e=t.indexOf("#");return e===-1?"":t.substring(e+1)}function mP(t){window.location.hash=t}function Y_(t){window.location.replace(_S(window.location.href)+"#"+t)}function gP(t){t===void 0&&(t={}),gS||nf();var e=window.history;hP();var r=t,l=r.getUserConfirmation,f=l===void 0?yS:l,_=r.hashType,y=_===void 0?"slash":_,d=t.basename?mS(Pm(t.basename)):"",A=pP[y],j=A.encodePath,B=A.decodePath;function N(){var ot=B(Tm());return d&&(ot=pS(ot,d)),Go(ot)}var V=zx();function Q(ot){Wo(Et,ot),Et.length=e.length,V.notifyListeners(Et.location,Et.action)}var ne=!1,J=null;function ye(ot,xe){return ot.pathname===xe.pathname&&ot.search===xe.search&&ot.hash===xe.hash}function re(){var ot=Tm(),xe=j(ot);if(ot!==xe)Y_(xe);else{var Le=N(),tt=Et.location;if(!ne&&ye(tt,Le)||J===Ql(Le))return;J=null,ge(Le)}}function ge(ot){if(ne)ne=!1,Q();else{var xe="POP";V.confirmTransitionTo(ot,xe,f,function(Le){Le?Q({action:xe,location:ot}):le(ot)})}}function le(ot){var xe=Et.location,Le=Me.lastIndexOf(Ql(xe));Le===-1&&(Le=0);var tt=Me.lastIndexOf(Ql(ot));tt===-1&&(tt=0);var rt=Le-tt;rt&&(ne=!0,lt(rt))}var me=Tm(),be=j(me);me!==be&&Y_(be);var ke=N(),Me=[Ql(ke)];function Ue(ot){var xe=document.querySelector("base"),Le="";return xe&&xe.getAttribute("href")&&(Le=_S(window.location.href)),Le+"#"+j(d+Ql(ot))}function Fe(ot,xe){var Le="PUSH",tt=Go(ot,void 0,void 0,Et.location);V.confirmTransitionTo(tt,Le,f,function(rt){if(rt){var gt=Ql(tt),Pt=j(d+gt),Ot=Tm()!==Pt;if(Ot){J=gt,mP(Pt);var ei=Me.lastIndexOf(Ql(Et.location)),gi=Me.slice(0,ei+1);gi.push(gt),Me=gi,Q({action:Le,location:tt})}else Q()}})}function He(ot,xe){var Le="REPLACE",tt=Go(ot,void 0,void 0,Et.location);V.confirmTransitionTo(tt,Le,f,function(rt){if(rt){var gt=Ql(tt),Pt=j(d+gt),Ot=Tm()!==Pt;Ot&&(J=gt,Y_(Pt));var ei=Me.indexOf(Ql(Et.location));ei!==-1&&(Me[ei]=gt),Q({action:Le,location:tt})}})}function lt(ot){e.go(ot)}function Ye(){lt(-1)}function Mt(){lt(1)}var et=0;function Tt(ot){et+=ot,et===1&&ot===1?window.addEventListener(f0,re):et===0&&window.removeEventListener(f0,re)}var Be=!1;function ct(ot){ot===void 0&&(ot=!1);var xe=V.setPrompt(ot);return Be||(Tt(1),Be=!0),function(){return Be&&(Be=!1,Tt(-1)),xe()}}function ut(ot){var xe=V.appendListener(ot);return Tt(1),function(){Tt(-1),xe()}}var Et={length:e.length,action:"POP",location:ke,createHref:Ue,push:Fe,replace:He,go:lt,goBack:Ye,goForward:Mt,block:ct,listen:ut};return Et}function p0(t,e,r){return Math.min(Math.max(t,e),r)}function yP(t){t===void 0&&(t={});var e=t,r=e.getUserConfirmation,l=e.initialEntries,f=l===void 0?["/"]:l,_=e.initialIndex,y=_===void 0?0:_,d=e.keyLength,A=d===void 0?6:d,j=zx();function B(Ue){Wo(Me,Ue),Me.length=Me.entries.length,j.notifyListeners(Me.location,Me.action)}function N(){return Math.random().toString(36).substr(2,A)}var V=p0(y,0,f.length-1),Q=f.map(function(Ue){return typeof Ue=="string"?Go(Ue,void 0,N()):Go(Ue,void 0,Ue.key||N())}),ne=Ql;function J(Ue,Fe){var He="PUSH",lt=Go(Ue,Fe,N(),Me.location);j.confirmTransitionTo(lt,He,r,function(Ye){if(Ye){var Mt=Me.index,et=Mt+1,Tt=Me.entries.slice(0);Tt.length>et?Tt.splice(et,Tt.length-et,lt):Tt.push(lt),B({action:He,location:lt,index:et,entries:Tt})}})}function ye(Ue,Fe){var He="REPLACE",lt=Go(Ue,Fe,N(),Me.location);j.confirmTransitionTo(lt,He,r,function(Ye){Ye&&(Me.entries[Me.index]=lt,B({action:He,location:lt}))})}function re(Ue){var Fe=p0(Me.index+Ue,0,Me.entries.length-1),He="POP",lt=Me.entries[Fe];j.confirmTransitionTo(lt,He,r,function(Ye){Ye?B({action:He,location:lt,index:Fe}):B()})}function ge(){re(-1)}function le(){re(1)}function me(Ue){var Fe=Me.index+Ue;return Fe>=0&&Fe<Me.entries.length}function be(Ue){return Ue===void 0&&(Ue=!1),j.setPrompt(Ue)}function ke(Ue){return j.appendListener(Ue)}var Me={length:Q.length,action:"POP",location:Q[V],index:V,entries:Q,createHref:ne,push:J,replace:ye,go:re,goBack:ge,goForward:le,canGo:me,block:be,listen:ke};return Me}function qv(t,e){return qv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,l){return r.__proto__=l,r},qv(t,e)}function Wh(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,qv(t,e)}var X_={exports:{}},K_,m0;function _P(){if(m0)return K_;m0=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K_=t,K_}var J_,g0;function vP(){if(g0)return J_;g0=1;var t=_P();function e(){}function r(){}return r.resetWarningCache=e,J_=function(){function l(y,d,A,j,B,N){if(N!==t){var V=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw V.name="Invariant Violation",V}}l.isRequired=l;function f(){return l}var _={array:l,bigint:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:f,element:l,elementType:l,instanceOf:f,node:l,objectOf:f,oneOf:f,oneOfType:f,shape:f,exact:f,checkPropTypes:r,resetWarningCache:e};return _.PropTypes=_,_},J_}var y0;function xP(){return y0||(y0=1,X_.exports=vP()()),X_.exports}var bP=xP();const _0=Xh(bP);var Bd={exports:{}},Q_,v0;function wP(){return v0||(v0=1,Q_=Array.isArray||function(t){return Object.prototype.toString.call(t)=="[object Array]"}),Q_}var x0;function SP(){if(x0)return Bd.exports;x0=1;var t=wP();Bd.exports=ye,Bd.exports.parse=r,Bd.exports.compile=f,Bd.exports.tokensToFunction=d,Bd.exports.tokensToRegExp=J;var e=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function r(re,ge){for(var le=[],me=0,be=0,ke="",Me=ge&&ge.delimiter||"/",Ue;(Ue=e.exec(re))!=null;){var Fe=Ue[0],He=Ue[1],lt=Ue.index;if(ke+=re.slice(be,lt),be=lt+Fe.length,He){ke+=He[1];continue}var Ye=re[be],Mt=Ue[2],et=Ue[3],Tt=Ue[4],Be=Ue[5],ct=Ue[6],ut=Ue[7];ke&&(le.push(ke),ke="");var Et=Mt!=null&&Ye!=null&&Ye!==Mt,ot=ct==="+"||ct==="*",xe=ct==="?"||ct==="*",Le=Mt||Me,tt=Tt||Be,rt=Mt||(typeof le[le.length-1]=="string"?le[le.length-1]:"");le.push({name:et||me++,prefix:Mt||"",delimiter:Le,optional:xe,repeat:ot,partial:Et,asterisk:!!ut,pattern:tt?j(tt):ut?".*":l(Le,rt)})}return be<re.length&&(ke+=re.substr(be)),ke&&le.push(ke),le}function l(re,ge){return!ge||ge.indexOf(re)>-1?"[^"+A(re)+"]+?":A(ge)+"|(?:(?!"+A(ge)+")[^"+A(re)+"])+?"}function f(re,ge){return d(r(re,ge),ge)}function _(re){return encodeURI(re).replace(/[\/?#]/g,function(ge){return"%"+ge.charCodeAt(0).toString(16).toUpperCase()})}function y(re){return encodeURI(re).replace(/[?#]/g,function(ge){return"%"+ge.charCodeAt(0).toString(16).toUpperCase()})}function d(re,ge){for(var le=new Array(re.length),me=0;me<re.length;me++)typeof re[me]=="object"&&(le[me]=new RegExp("^(?:"+re[me].pattern+")$",N(ge)));return function(be,ke){for(var Me="",Ue=be||{},Fe=ke||{},He=Fe.pretty?_:encodeURIComponent,lt=0;lt<re.length;lt++){var Ye=re[lt];if(typeof Ye=="string"){Me+=Ye;continue}var Mt=Ue[Ye.name],et;if(Mt==null)if(Ye.optional){Ye.partial&&(Me+=Ye.prefix);continue}else throw new TypeError('Expected "'+Ye.name+'" to be defined');if(t(Mt)){if(!Ye.repeat)throw new TypeError('Expected "'+Ye.name+'" to not repeat, but received `'+JSON.stringify(Mt)+"`");if(Mt.length===0){if(Ye.optional)continue;throw new TypeError('Expected "'+Ye.name+'" to not be empty')}for(var Tt=0;Tt<Mt.length;Tt++){if(et=He(Mt[Tt]),!le[lt].test(et))throw new TypeError('Expected all "'+Ye.name+'" to match "'+Ye.pattern+'", but received `'+JSON.stringify(et)+"`");Me+=(Tt===0?Ye.prefix:Ye.delimiter)+et}continue}if(et=Ye.asterisk?y(Mt):He(Mt),!le[lt].test(et))throw new TypeError('Expected "'+Ye.name+'" to match "'+Ye.pattern+'", but received "'+et+'"');Me+=Ye.prefix+et}return Me}}function A(re){return re.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function j(re){return re.replace(/([=!:$\/()])/g,"\\$1")}function B(re,ge){return re.keys=ge,re}function N(re){return re&&re.sensitive?"":"i"}function V(re,ge){var le=re.source.match(/\((?!\?)/g);if(le)for(var me=0;me<le.length;me++)ge.push({name:me,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return B(re,ge)}function Q(re,ge,le){for(var me=[],be=0;be<re.length;be++)me.push(ye(re[be],ge,le).source);var ke=new RegExp("(?:"+me.join("|")+")",N(le));return B(ke,ge)}function ne(re,ge,le){return J(r(re,le),ge,le)}function J(re,ge,le){t(ge)||(le=ge||le,ge=[]),le=le||{};for(var me=le.strict,be=le.end!==!1,ke="",Me=0;Me<re.length;Me++){var Ue=re[Me];if(typeof Ue=="string")ke+=A(Ue);else{var Fe=A(Ue.prefix),He="(?:"+Ue.pattern+")";ge.push(Ue),Ue.repeat&&(He+="(?:"+Fe+He+")*"),Ue.optional?Ue.partial?He=Fe+"("+He+")?":He="(?:"+Fe+"("+He+"))?":He=Fe+"("+He+")",ke+=He}}var lt=A(le.delimiter||"/"),Ye=ke.slice(-lt.length)===lt;return me||(ke=(Ye?ke.slice(0,-lt.length):ke)+"(?:"+lt+"(?=$))?"),be?ke+="$":ke+=me&&Ye?"":"(?="+lt+"|$)",B(new RegExp("^"+ke,N(le)),ge)}function ye(re,ge,le){return t(ge)||(le=ge||le,ge=[]),le=le||{},re instanceof RegExp?V(re,ge):t(re)?Q(re,ge,le):ne(re,ge,le)}return Bd.exports}var TP=SP();const vS=Xh(TP);var ev={exports:{}},ds={};var b0;function EP(){if(b0)return ds;b0=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,l=t?Symbol.for("react.fragment"):60107,f=t?Symbol.for("react.strict_mode"):60108,_=t?Symbol.for("react.profiler"):60114,y=t?Symbol.for("react.provider"):60109,d=t?Symbol.for("react.context"):60110,A=t?Symbol.for("react.async_mode"):60111,j=t?Symbol.for("react.concurrent_mode"):60111,B=t?Symbol.for("react.forward_ref"):60112,N=t?Symbol.for("react.suspense"):60113,V=t?Symbol.for("react.suspense_list"):60120,Q=t?Symbol.for("react.memo"):60115,ne=t?Symbol.for("react.lazy"):60116,J=t?Symbol.for("react.block"):60121,ye=t?Symbol.for("react.fundamental"):60117,re=t?Symbol.for("react.responder"):60118,ge=t?Symbol.for("react.scope"):60119;function le(be){if(typeof be=="object"&&be!==null){var ke=be.$$typeof;switch(ke){case e:switch(be=be.type,be){case A:case j:case l:case _:case f:case N:return be;default:switch(be=be&&be.$$typeof,be){case d:case B:case ne:case Q:case y:return be;default:return ke}}case r:return ke}}}function me(be){return le(be)===j}return ds.AsyncMode=A,ds.ConcurrentMode=j,ds.ContextConsumer=d,ds.ContextProvider=y,ds.Element=e,ds.ForwardRef=B,ds.Fragment=l,ds.Lazy=ne,ds.Memo=Q,ds.Portal=r,ds.Profiler=_,ds.StrictMode=f,ds.Suspense=N,ds.isAsyncMode=function(be){return me(be)||le(be)===A},ds.isConcurrentMode=me,ds.isContextConsumer=function(be){return le(be)===d},ds.isContextProvider=function(be){return le(be)===y},ds.isElement=function(be){return typeof be=="object"&&be!==null&&be.$$typeof===e},ds.isForwardRef=function(be){return le(be)===B},ds.isFragment=function(be){return le(be)===l},ds.isLazy=function(be){return le(be)===ne},ds.isMemo=function(be){return le(be)===Q},ds.isPortal=function(be){return le(be)===r},ds.isProfiler=function(be){return le(be)===_},ds.isStrictMode=function(be){return le(be)===f},ds.isSuspense=function(be){return le(be)===N},ds.isValidElementType=function(be){return typeof be=="string"||typeof be=="function"||be===l||be===j||be===_||be===f||be===N||be===V||typeof be=="object"&&be!==null&&(be.$$typeof===ne||be.$$typeof===Q||be.$$typeof===y||be.$$typeof===d||be.$$typeof===B||be.$$typeof===ye||be.$$typeof===re||be.$$typeof===ge||be.$$typeof===J)},ds.typeOf=le,ds}var w0;function xS(){return w0||(w0=1,ev.exports=EP()),ev.exports}xS();function bS(t,e){if(t==null)return{};var r={};for(var l in t)if({}.hasOwnProperty.call(t,l)){if(e.indexOf(l)!==-1)continue;r[l]=t[l]}return r}var tv,S0;function kP(){if(S0)return tv;S0=1;var t=xS(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},f={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},_={};_[t.ForwardRef]=l,_[t.Memo]=f;function y(ne){return t.isMemo(ne)?f:_[ne.$$typeof]||e}var d=Object.defineProperty,A=Object.getOwnPropertyNames,j=Object.getOwnPropertySymbols,B=Object.getOwnPropertyDescriptor,N=Object.getPrototypeOf,V=Object.prototype;function Q(ne,J,ye){if(typeof J!="string"){if(V){var re=N(J);re&&re!==V&&Q(ne,re,ye)}var ge=A(J);j&&(ge=ge.concat(j(J)));for(var le=y(ne),me=y(J),be=0;be<ge.length;++be){var ke=ge[be];if(!r[ke]&&!(ye&&ye[ke])&&!(me&&me[ke])&&!(le&&le[ke])){var Me=B(J,ke);try{d(ne,ke,Me)}catch{}}}}return ne}return tv=Q,tv}var CP=kP();const AP=Xh(CP);var iv=1073741823,T0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{};function MP(){var t="__global_unique_id__";return T0[t]=(T0[t]||0)+1}function PP(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function jP(t){var e=[];return{on:function(l){e.push(l)},off:function(l){e=e.filter(function(f){return f!==l})},get:function(){return t},set:function(l,f){t=l,e.forEach(function(_){return _(t,f)})}}}function IP(t){return Array.isArray(t)?t[0]:t}function LP(t,e){var r,l,f="__create-react-context-"+MP()+"__",_=(function(d){Wh(A,d);function A(){for(var B,N=arguments.length,V=new Array(N),Q=0;Q<N;Q++)V[Q]=arguments[Q];return B=d.call.apply(d,[this].concat(V))||this,B.emitter=jP(B.props.value),B}var j=A.prototype;return j.getChildContext=function(){var N;return N={},N[f]=this.emitter,N},j.componentWillReceiveProps=function(N){if(this.props.value!==N.value){var V=this.props.value,Q=N.value,ne;PP(V,Q)?ne=0:(ne=typeof e=="function"?e(V,Q):iv,ne|=0,ne!==0&&this.emitter.set(N.value,ne))}},j.render=function(){return this.props.children},A})(Nt.Component);_.childContextTypes=(r={},r[f]=_0.object.isRequired,r);var y=(function(d){Wh(A,d);function A(){for(var B,N=arguments.length,V=new Array(N),Q=0;Q<N;Q++)V[Q]=arguments[Q];return B=d.call.apply(d,[this].concat(V))||this,B.observedBits=void 0,B.state={value:B.getValue()},B.onUpdate=function(ne,J){var ye=B.observedBits|0;(ye&J)!==0&&B.setState({value:B.getValue()})},B}var j=A.prototype;return j.componentWillReceiveProps=function(N){var V=N.observedBits;this.observedBits=V??iv},j.componentDidMount=function(){this.context[f]&&this.context[f].on(this.onUpdate);var N=this.props.observedBits;this.observedBits=N??iv},j.componentWillUnmount=function(){this.context[f]&&this.context[f].off(this.onUpdate)},j.getValue=function(){return this.context[f]?this.context[f].get():t},j.render=function(){return IP(this.props.children)(this.state.value)},A})(Nt.Component);return y.contextTypes=(l={},l[f]=_0.object,l),{Provider:_,Consumer:y}}var zP=Nt.createContext||LP,wS=function(e){var r=zP();return r.displayName=e,r},SS=wS("Router-History"),Yh=wS("Router"),Qm=(function(t){Wh(e,t),e.computeRootMatch=function(f){return{path:"/",url:"/",params:{},isExact:f==="/"}};function e(l){var f;return f=t.call(this,l)||this,f.state={location:l.history.location},f._isMounted=!1,f._pendingLocation=null,l.staticContext||(f.unlisten=l.history.listen(function(_){f._pendingLocation=_})),f}var r=e.prototype;return r.componentDidMount=function(){var f=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen(function(_){f._isMounted&&f.setState({location:_})})),this._pendingLocation&&this.setState({location:this._pendingLocation})},r.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},r.render=function(){return Nt.createElement(Yh.Provider,{value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},Nt.createElement(SS.Provider,{children:this.props.children||null,value:this.props.history}))},e})(Nt.Component);Nt.Component;var RP=(function(t){Wh(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},r.componentDidUpdate=function(f){this.props.onUpdate&&this.props.onUpdate.call(this,this,f)},r.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},r.render=function(){return null},e})(Nt.Component),nv={},DP=1e4,E0=0;function OP(t){if(nv[t])return nv[t];var e=vS.compile(t);return E0<DP&&(nv[t]=e,E0++),e}function k0(t,e){return t===void 0&&(t="/"),e===void 0&&(e={}),t==="/"?t:OP(t)(e,{pretty:!0})}function kc(t){var e=t.computedMatch,r=t.to,l=t.push,f=l===void 0?!1:l;return Nt.createElement(Yh.Consumer,null,function(_){_||nf();var y=_.history,d=_.staticContext,A=f?y.push:y.replace,j=Go(e?typeof r=="string"?k0(r,e.params):Wo({},r,{pathname:k0(r.pathname,e.params)}):r);return d?(A(j),null):Nt.createElement(RP,{onMount:function(){A(j)},onUpdate:function(N,V){var Q=Go(V.to);lP(Q,Wo({},j,{key:Q.key}))||A(j)},to:r})})}var C0={},NP=1e4,A0=0;function BP(t,e){var r=""+e.end+e.strict+e.sensitive,l=C0[r]||(C0[r]={});if(l[t])return l[t];var f=[],_=vS(t,f,e),y={regexp:_,keys:f};return A0<NP&&(l[t]=y,A0++),y}function Rx(t,e){e===void 0&&(e={}),(typeof e=="string"||Array.isArray(e))&&(e={path:e});var r=e,l=r.path,f=r.exact,_=f===void 0?!1:f,y=r.strict,d=y===void 0?!1:y,A=r.sensitive,j=A===void 0?!1:A,B=[].concat(l);return B.reduce(function(N,V){if(!V&&V!=="")return null;if(N)return N;var Q=BP(V,{end:_,strict:d,sensitive:j}),ne=Q.regexp,J=Q.keys,ye=ne.exec(t);if(!ye)return null;var re=ye[0],ge=ye.slice(1),le=t===re;return _&&!le?null:{path:V,url:V==="/"&&re===""?"/":re,isExact:le,params:J.reduce(function(me,be,ke){return me[be.name]=ge[ke],me},{})}},null)}function $P(t){return Nt.Children.count(t)===0}var Ws=(function(t){Wh(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.render=function(){var f=this;return Nt.createElement(Yh.Consumer,null,function(_){_||nf();var y=f.props.location||_.location,d=f.props.computedMatch?f.props.computedMatch:f.props.path?Rx(y.pathname,f.props):_.match,A=Wo({},_,{location:y,match:d}),j=f.props,B=j.children,N=j.component,V=j.render;return Array.isArray(B)&&$P(B)&&(B=null),Nt.createElement(Yh.Provider,{value:A},A.match?B?typeof B=="function"?B(A):B:N?Nt.createElement(N,A):V?V(A):null:typeof B=="function"?B(A):null)})},e})(Nt.Component);function Dx(t){return t.charAt(0)==="/"?t:"/"+t}function UP(t,e){return t?Wo({},e,{pathname:Dx(t)+e.pathname}):e}function FP(t,e){if(!t)return e;var r=Dx(t);return e.pathname.indexOf(r)!==0?e:Wo({},e,{pathname:e.pathname.substr(r.length)})}function M0(t){return typeof t=="string"?t:Ql(t)}function sv(t){return function(){nf()}}function P0(){}Nt.Component;Nt.Component;function VP(t){var e="withRouter("+(t.displayName||t.name)+")",r=function(f){var _=f.wrappedComponentRef,y=bS(f,["wrappedComponentRef"]);return Nt.createElement(Yh.Consumer,null,function(d){return d||nf(),Nt.createElement(t,Wo({},y,d,{ref:_}))})};return r.displayName=e,r.WrappedComponent=t,AP(r,t)}var Ox=Nt.useContext;function Ur(){return Ox(SS)}function mp(){return Ox(Yh).location}function eg(){var t=Ox(Yh).match;return t?t.params:{}}class qP extends Nt.PureComponent{render(){return Nt.createElement(Ws,Object.assign({path:this.props.path,exact:this.props.exact,render:this.props.render},this.props.computedMatch!==void 0?{computedMatch:this.props.computedMatch}:{}))}}const Fm=({pathname:t,componentProps:e})=>{const{exact:r,component:l}=e,f=e.path||e.from,y=Rx(t,{exact:r,path:f,component:l});return y||!1};class HP extends iP{constructor(){super(),this.createViewItem=this.createViewItem.bind(this),this.findViewItemByRouteInfo=this.findViewItemByRouteInfo.bind(this),this.findLeavingViewItemByRouteInfo=this.findLeavingViewItemByRouteInfo.bind(this),this.getChildrenToRender=this.getChildrenToRender.bind(this),this.findViewItemByPathname=this.findViewItemByPathname.bind(this)}createViewItem(e,r,l,f){const _={id:Um("viewItem"),outletId:e,ionPageElement:f,reactElement:r,mount:!0,ionRoute:!1};return r.type===Lx&&(_.ionRoute=!0,_.disableIonPageManagement=r.props.disableIonPageManagement),_.routeData={match:Fm({pathname:l.pathname,componentProps:r.props}),childProps:r.props},_}getChildrenToRender(e,r,l){const f=this.getViewItemsForOutlet(e);return Nt.Children.forEach(r.props.children,y=>{const d=f.find(A=>j0(y,A.routeData.childProps.path||A.routeData.childProps.from));d&&(d.reactElement=y)}),f.map(y=>{let d;if(y.ionRoute&&!y.disableIonPageManagement)d=Nt.createElement(o0,{key:`view-${y.id}`,mount:y.mount,removeView:()=>this.remove(y)},Nt.cloneElement(y.reactElement,{computedMatch:y.routeData.match}));else{const A=j0(y.reactElement,l.pathname);d=Nt.createElement(o0,{key:`view-${y.id}`,mount:y.mount,removeView:()=>this.remove(y)},Nt.cloneElement(y.reactElement,{computedMatch:y.routeData.match})),!A&&y.routeData.match&&(y.routeData.match=void 0,y.mount=!1)}return d})}findViewItemByRouteInfo(e,r,l){const{viewItem:f,match:_}=this.findViewItemByPath(e.pathname,r);return(l===void 0||l===!0)&&f&&_&&(f.routeData.match=_),f}findLeavingViewItemByRouteInfo(e,r,l=!0){const{viewItem:f}=this.findViewItemByPath(e.lastPathname,r,l);return f}findViewItemByPathname(e,r){const{viewItem:l}=this.findViewItemByPath(e,r);return l}findViewItemByPath(e,r,l){let f,_,y;if(r)y=this.getViewItemsForOutlet(r),y.some(d),f||y.some(A);else{const j=this.getAllViewItems();j.some(d),f||j.some(A)}return{viewItem:f,match:_};function d(j){var B,N;if(l&&!j.ionRoute)return!1;if(_=Fm({pathname:e,componentProps:j.routeData.childProps}),_){const V=_.path.includes(":");if(!V||V&&_.url===((N=(B=j.routeData)===null||B===void 0?void 0:B.match)===null||N===void 0?void 0:N.url))return f=j,!0}return!1}function A(j){return!j.routeData.childProps.path&&!j.routeData.childProps.from?(_={path:e,url:e,isExact:!0,params:{}},f=j,!0):!1}}}function j0(t,e){return Fm({pathname:e,componentProps:t.props})}function ZP(t){let e;if(typeof t=="string"?e=t:e=t.outerHTML,document){const r=document.createElement("div");r.innerHTML=e,r.style.zIndex="";const l=r.getElementsByTagName("ion-back-button");return l[0]&&l[0].remove(),r.firstChild}}const I0=t=>!t.classList.contains("ion-page-invisible")&&!t.classList.contains("ion-page-hidden");class GP extends Nt.PureComponent{constructor(e){super(e),this.stackContextValue={registerIonPage:this.registerIonPage.bind(this),isInOutlet:()=>!0},this.pendingPageTransition=!1,this.registerIonPage=this.registerIonPage.bind(this),this.transitionPage=this.transitionPage.bind(this),this.handlePageTransition=this.handlePageTransition.bind(this),this.id=Um("routerOutlet"),this.prevProps=void 0,this.skipTransition=!1}componentDidMount(){this.clearOutletTimeout&&clearTimeout(this.clearOutletTimeout),this.routerOutletElement&&(this.setupRouterOutlet(this.routerOutletElement),this.handlePageTransition(this.props.routeInfo))}componentDidUpdate(e){const{pathname:r}=this.props.routeInfo,{pathname:l}=e.routeInfo;r!==l?(this.prevProps=e,this.handlePageTransition(this.props.routeInfo)):this.pendingPageTransition&&(this.handlePageTransition(this.props.routeInfo),this.pendingPageTransition=!1)}componentWillUnmount(){this.clearOutletTimeout=this.context.clearOutlet(this.id)}async handlePageTransition(e){var r,l;if(!this.routerOutletElement||!this.routerOutletElement.commit)this.pendingPageTransition=!0;else{let f=this.context.findViewItemByRouteInfo(e,this.id),_=this.context.findLeavingViewItemByRouteInfo(e,this.id);!_&&e.prevRouteLastPathname&&(_=this.context.findViewItemByPathname(e.prevRouteLastPathname,this.id)),_&&(e.routeAction==="replace"?_.mount=!1:e.routeAction==="push"&&e.routeDirection==="forward"?!((r=e.routeOptions)===null||r===void 0)&&r.unmount&&(_.mount=!1):e.routeDirection!=="none"&&f!==_&&(_.mount=!1));const y=WP((l=this.ionRouterOutlet)===null||l===void 0?void 0:l.props.children,e);if(f?f.reactElement=y:y&&(f=this.context.createViewItem(this.id,y,e),this.context.addViewItem(f)),f&&f.ionPageElement){if(f===_&&f.routeData.match.url!==e.pathname||(!_&&this.props.routeInfo.prevRouteLastPathname&&(_=this.context.findViewItemByPathname(this.props.routeInfo.prevRouteLastPathname,this.id)),I0(f.ionPageElement)&&_!==void 0&&!I0(_.ionPageElement)))return;this.transitionPage(e,f,_)}else _&&!y&&!f&&_.ionPageElement&&(_.ionPageElement.classList.add("ion-page-hidden"),_.ionPageElement.setAttribute("aria-hidden","true"));this.forceUpdate()}}registerIonPage(e,r){const l=this.context.findViewItemByRouteInfo(r,this.id);if(l){const f=l.ionPageElement;if(l.ionPageElement=e,l.ionRoute=!0,f===e)return}this.handlePageTransition(r)}async setupRouterOutlet(e){const r=()=>{const _=Px();if(!(_&&_.get("swipeBackEnabled",e.mode==="ios")))return!1;const{routeInfo:d}=this.props,A=this.prevProps&&this.prevProps.routeInfo.pathname===d.pushedByRoute?this.prevProps.routeInfo:{pathname:d.pushedByRoute||""},j=this.context.findViewItemByRouteInfo(A,this.id,!1);return!!j&&j.mount&&j.routeData.match.path!==d.pathname},l=async()=>{const{routeInfo:_}=this.props,y=this.prevProps&&this.prevProps.routeInfo.pathname===_.pushedByRoute?this.prevProps.routeInfo:{pathname:_.pushedByRoute||""},d=this.context.findViewItemByRouteInfo(y,this.id,!1),A=this.context.findViewItemByRouteInfo(_,this.id,!1);return d&&A&&await this.transitionPage(_,d,A,"back",!0),Promise.resolve()},f=_=>{if(_)this.skipTransition=!0,this.context.goBack();else{const{routeInfo:y}=this.props,d=this.prevProps&&this.prevProps.routeInfo.pathname===y.pushedByRoute?this.prevProps.routeInfo:{pathname:y.pushedByRoute||""},A=this.context.findViewItemByRouteInfo(d,this.id,!1),j=this.context.findViewItemByRouteInfo(y,this.id,!1);if(A!==j&&A?.ionPageElement!==void 0){const{ionPageElement:B}=A;B.setAttribute("aria-hidden","true"),B.classList.add("ion-page-hidden")}}};e.swipeHandler={canStart:r,onStart:l,onEnd:f}}async transitionPage(e,r,l,f,_=!1){const y=async(B,N)=>{const V=this.skipTransition;V?this.skipTransition=!1:(B.classList.add("ion-page"),B.classList.add("ion-page-invisible")),await d.commit(B,N,{duration:V||j===void 0?0:void 0,direction:j,showGoBack:!!e.pushedByRoute,progressAnimation:_,animationBuilder:e.routeAnimation})},d=this.routerOutletElement,A=e.routeDirection==="none"||e.routeDirection==="root"?void 0:e.routeDirection,j=f??A;if(r&&r.ionPageElement&&this.routerOutletElement)if(l&&l.ionPageElement&&r===l)if(YP(l.reactElement,e.pathname,!0)){const N=ZP(l.ionPageElement.outerHTML);N&&(this.routerOutletElement.appendChild(N),await y(r.ionPageElement,N),this.routerOutletElement.removeChild(N))}else await y(r.ionPageElement,void 0);else await y(r.ionPageElement,l?.ionPageElement),l&&l.ionPageElement&&!_&&(l.ionPageElement.classList.add("ion-page-hidden"),l.ionPageElement.setAttribute("aria-hidden","true"))}render(){const{children:e}=this.props,r=Nt.Children.only(e);this.ionRouterOutlet=r;const l=this.context.getChildrenToRender(this.id,this.ionRouterOutlet,this.props.routeInfo,()=>{this.forceUpdate()});return Nt.createElement(jx.Provider,{value:this.stackContextValue},Nt.cloneElement(r,{ref:f=>{r.props.setRef&&r.props.setRef(f),r.props.forwardedRef&&(r.props.forwardedRef.current=f),this.routerOutletElement=f;const{ref:_}=r;typeof _=="function"&&_(f)}},l))}static get contextType(){return fS}}function WP(t,e){let r;return Nt.Children.forEach(t,l=>{Fm({pathname:e.pathname,componentProps:l.props})&&(r=l)}),r||(Nt.Children.forEach(t,l=>{l.props.path||l.props.from||(r=l)}),r)}function YP(t,e,r){return Fm({pathname:e,componentProps:Object.assign(Object.assign({},t.props),{exact:r})})}class XP extends Nt.PureComponent{constructor(e){super(e),this.exitViewFromOtherOutletHandlers=[],this.locationHistory=new eP,this.viewStack=new HP,this.routeMangerContextState={canGoBack:()=>this.locationHistory.canGoBack(),clearOutlet:this.viewStack.clear,findViewItemByPathname:this.viewStack.findViewItemByPathname,getChildrenToRender:this.viewStack.getChildrenToRender,goBack:()=>this.handleNavigateBack(),createViewItem:this.viewStack.createViewItem,findViewItemByRouteInfo:this.viewStack.findViewItemByRouteInfo,findLeavingViewItemByRouteInfo:this.viewStack.findLeavingViewItemByRouteInfo,addViewItem:this.viewStack.add,unMountViewItem:this.viewStack.remove};const r={id:Um("routeInfo"),pathname:this.props.location.pathname,search:this.props.location.search};this.locationHistory.add(r),this.handleChangeTab=this.handleChangeTab.bind(this),this.handleResetTab=this.handleResetTab.bind(this),this.handleNativeBack=this.handleNativeBack.bind(this),this.handleNavigate=this.handleNavigate.bind(this),this.handleNavigateBack=this.handleNavigateBack.bind(this),this.props.registerHistoryListener(this.handleHistoryChange.bind(this)),this.handleSetCurrentTab=this.handleSetCurrentTab.bind(this),this.state={routeInfo:r}}handleChangeTab(e,r,l){if(!r)return;const f=this.locationHistory.getCurrentRouteInfoForTab(e),[_,y]=r.split("?");f?(this.incomingRouteParams=Object.assign(Object.assign({},f),{routeAction:"push",routeDirection:"none"}),f.pathname===_?(this.incomingRouteParams.routeOptions=l,this.props.history.push(f.pathname+(f.search||""))):(this.incomingRouteParams.pathname=_,this.incomingRouteParams.search=y?"?"+y:void 0,this.incomingRouteParams.routeOptions=l,this.props.history.push(_+(y?"?"+y:"")))):this.handleNavigate(_,"push","none",void 0,l,e)}handleHistoryChange(e,r){var l,f,_;let y;if(this.incomingRouteParams?this.incomingRouteParams.routeAction==="replace"?y=this.locationHistory.previous():y=this.locationHistory.current():y=this.locationHistory.current(),y.pathname+y.search!==e.pathname){if(!this.incomingRouteParams){if(r==="REPLACE"&&(this.incomingRouteParams={routeAction:"replace",routeDirection:"none",tab:this.currentTab}),r==="POP"){const j=this.locationHistory.current();if(j&&j.pushedByRoute){const B=this.locationHistory.findLastLocation(j);this.incomingRouteParams=Object.assign(Object.assign({},B),{routeAction:"pop",routeDirection:"back"})}else this.incomingRouteParams={routeAction:"pop",routeDirection:"none",tab:this.currentTab}}this.incomingRouteParams||(this.incomingRouteParams={routeAction:"push",routeDirection:((l=e.state)===null||l===void 0?void 0:l.direction)||"forward",routeOptions:(f=e.state)===null||f===void 0?void 0:f.routerOptions,tab:this.currentTab})}let A;if(!((_=this.incomingRouteParams)===null||_===void 0)&&_.id)A=Object.assign(Object.assign({},this.incomingRouteParams),{lastPathname:y.pathname}),this.locationHistory.add(A);else{const j=this.incomingRouteParams.routeAction==="push"&&this.incomingRouteParams.routeDirection==="forward";if(A=Object.assign(Object.assign({id:Um("routeInfo")},this.incomingRouteParams),{lastPathname:y.pathname,pathname:e.pathname,search:e.search,params:this.props.match.params,prevRouteLastPathname:y.lastPathname}),j)A.tab=y.tab,A.pushedByRoute=y.pathname;else if(A.routeAction==="pop"){const B=this.locationHistory.findLastLocation(A);A.pushedByRoute=B?.pushedByRoute}else if(A.routeAction==="push"&&A.tab!==y.tab){const B=this.locationHistory.getCurrentRouteInfoForTab(A.tab);A.pushedByRoute=B?.pushedByRoute}else if(A.routeAction==="replace"){const B=this.locationHistory.current(),N=B?.pushedByRoute,V=N!==void 0&&N!==A.pathname?N:A.pushedByRoute;A.lastPathname=B?.pathname||A.lastPathname,A.prevRouteLastPathname=B?.lastPathname,A.pushedByRoute=V,A.routeDirection=A.routeDirection||B?.routeDirection,A.routeAnimation=A.routeAnimation||B?.routeAnimation}this.locationHistory.add(A)}this.setState({routeInfo:A})}this.incomingRouteParams=void 0}handleNativeBack(){const e=this.props.history;(e.goBack||e.back)()}handleNavigate(e,r,l,f,_,y){this.incomingRouteParams=Object.assign(this.incomingRouteParams||{},{routeAction:r,routeDirection:l,routeOptions:_,routeAnimation:f,tab:y}),r==="push"?this.props.history.push(e):this.props.history.replace(e)}handleNavigateBack(e="/",r){const l=Px();e=e||l&&l.get("backButtonDefaultHref");const f=this.locationHistory.current();if(f&&f.pushedByRoute){const _=this.locationHistory.findLastLocation(f);if(_){const y=r||f.routeAnimation;if(this.incomingRouteParams=Object.assign(Object.assign({},_),{routeAction:"pop",routeDirection:"back",routeAnimation:y}),f.lastPathname===f.pushedByRoute||_.pathname===f.pushedByRoute&&f.tab===""&&_.tab===""){const d=this.props.history;(d.goBack||d.back)()}else this.handleNavigate(_.pathname+(_.search||""),"pop","back",y)}else this.handleNavigate(e,"pop","back",r)}else this.handleNavigate(e,"pop","back",r)}handleResetTab(e,r,l){const f=this.locationHistory.getFirstRouteInfoForTab(e);if(f){const _=Object.assign({},f);_.pathname=r,_.routeOptions=l,this.incomingRouteParams=Object.assign(Object.assign({},_),{routeAction:"pop",routeDirection:"back"}),this.props.history.push(_.pathname+(_.search||""))}}handleSetCurrentTab(e){this.currentTab=e;const r=Object.assign({},this.locationHistory.current());r.tab!==e&&(r.tab=e,this.locationHistory.update(r))}render(){return Nt.createElement(fS.Provider,{value:this.routeMangerContextState},Nt.createElement(tP,{ionRoute:qP,ionRedirect:{},stackManager:GP,routeInfo:this.state.routeInfo,onNativeBack:this.handleNativeBack,onNavigateBack:this.handleNavigateBack,onNavigate:this.handleNavigate,onSetCurrentTab:this.handleSetCurrentTab,onChangeTab:this.handleChangeTab,onResetTab:this.handleResetTab,locationHistory:this.locationHistory},this.props.children))}}const u_=VP(XP);u_.displayName="IonRouter";class KP extends Nt.Component{constructor(e){super(e);const{history:r}=e,l=Ku(e,["history"]);this.history=r||fP(l),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,r){const l=e.location||e,f=e.action||r;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:r}=e,l=Ku(e,["children"]);return Nt.createElement(Qm,Object.assign({history:this.history},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},r))}}class BD extends Nt.Component{constructor(e){super(e),this.history=e.history,this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,r){const l=e.location||e,f=e.action||r;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:r}=e,l=Ku(e,["children"]);return Nt.createElement(Qm,Object.assign({},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},r))}}class $D extends Nt.Component{constructor(e){super(e);const{history:r}=e,l=Ku(e,["history"]);this.history=r||gP(l),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,r){const l=e.location||e,f=e.action||r;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:r}=e,l=Ku(e,["children"]);return Nt.createElement(Qm,Object.assign({history:this.history},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},r))}}const ro=t=>({width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.8,strokeLinecap:"round",strokeLinejoin:"round"}),TS=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("rect",{x:"3",y:"5",width:"18",height:"16",rx:"3"}),S.jsx("path",{d:"M8 3v4M16 3v4M3 10h18"})]}),h_=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("path",{d:"M12 21s6-6.5 6-11a6 6 0 0 0-12 0c0 4.5 6 11 6 11z"}),S.jsx("circle",{cx:"12",cy:"10",r:"2.5"})]}),My=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"8",r:"3.5"}),S.jsx("path",{d:"M4 20c1.6-3.6 5-5 8-5s6.4 1.4 8 5"})]}),L0=({className:t,size:e=20})=>S.jsx("svg",{...ro(e),className:t,children:S.jsx("path",{d:"M8 6l10 6-10 6z"})}),Nx=({className:t,size:e=20})=>S.jsx("svg",{...ro(e),className:t,children:S.jsx("path",{d:"M12 20s-7-4.6-7-9.5A4.5 4.5 0 0 1 12 7a4.5 4.5 0 0 1 7 3.5C19 15.4 12 20 12 20z"})}),JP=({className:t,size:e=20})=>S.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",className:t,fill:"currentColor",children:S.jsx("path",{d:"M12 20s-7-4.6-7-9.5A4.5 4.5 0 0 1 12 7a4.5 4.5 0 0 1 7 3.5C19 15.4 12 20 12 20z"})}),QP=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M8.5 12.5l2.5 2.5 4.5-5"})]}),ES=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("path",{d:"M16 6l-8 4 8 4"}),S.jsx("circle",{cx:"17.5",cy:"6",r:"2.5"}),S.jsx("circle",{cx:"6.5",cy:"12",r:"2.5"}),S.jsx("circle",{cx:"17.5",cy:"18",r:"2.5"})]}),ej=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("path",{d:"M12 20h9"}),S.jsx("path",{d:"M16.5 3.5l4 4L8 20l-5 1 1-5 12.5-12.5z"})]}),tj=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),S.jsx("path",{d:"M16 17l5-5-5-5"}),S.jsx("path",{d:"M21 12H9"})]}),ij=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),S.jsx("rect",{x:"5",y:"5",width:"10",height:"10",rx:"2"})]}),nj=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),S.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),sj=({className:t,size:e=20})=>S.jsx("svg",{...ro(e),className:t,children:S.jsx("path",{d:"M15 18l-6-6 6-6"})}),rj=({className:t,size:e=20})=>S.jsx("svg",{...ro(e),className:t,children:S.jsx("path",{d:"M6 9l6 6 6-6"})}),aj=({className:t,size:e=20})=>S.jsx("svg",{...ro(e),className:t,children:S.jsx("path",{d:"M18 15l-6-6-6 6"})}),z0=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2"}),S.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),oj=({className:t,size:e=20})=>S.jsxs("svg",{...ro(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M14.5 9.5l-1.3 3.7-3.7 1.3 1.3-3.7 3.7-1.3z"}),S.jsx("path",{d:"M12 3v2M21 12h-2M12 21v-2M3 12h2"})]}),lj=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Bx extends Error{constructor(e,r="FunctionsError",l){super(e),this.name=r,this.context=l}}class cj extends Bx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class R0 extends Bx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class D0 extends Bx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Hv;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Hv||(Hv={}));class uj{constructor(e,{headers:r={},customFetch:l,region:f=Hv.Any}={}){this.url=e,this.headers=r,this.region=f,this.fetch=lj(l)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return nP(this,arguments,void 0,function*(r,l={}){var f;let _,y;try{const{headers:d,method:A,body:j,signal:B,timeout:N}=l;let V={},{region:Q}=l;Q||(Q=this.region);const ne=new URL(`${this.url}/${r}`);Q&&Q!=="any"&&(V["x-region"]=Q,ne.searchParams.set("forceFunctionRegion",Q));let J;j&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&j instanceof Blob||j instanceof ArrayBuffer?(V["Content-Type"]="application/octet-stream",J=j):typeof j=="string"?(V["Content-Type"]="text/plain",J=j):typeof FormData<"u"&&j instanceof FormData?J=j:(V["Content-Type"]="application/json",J=JSON.stringify(j)):j&&typeof j!="string"&&!(typeof Blob<"u"&&j instanceof Blob)&&!(j instanceof ArrayBuffer)&&!(typeof FormData<"u"&&j instanceof FormData)?J=JSON.stringify(j):J=j;let ye=B;N&&(y=new AbortController,_=setTimeout(()=>y.abort(),N),B?(ye=y.signal,B.addEventListener("abort",()=>y.abort())):ye=y.signal);const re=yield this.fetch(ne.toString(),{method:A||"POST",headers:Object.assign(Object.assign(Object.assign({},V),this.headers),d),body:J,signal:ye}).catch(be=>{throw new cj(be)}),ge=re.headers.get("x-relay-error");if(ge&&ge==="true")throw new R0(re);if(!re.ok)throw new D0(re);let le=((f=re.headers.get("Content-Type"))!==null&&f!==void 0?f:"text/plain").split(";")[0].trim(),me;return le==="application/json"?me=yield re.json():le==="application/octet-stream"||le==="application/pdf"?me=yield re.blob():le==="text/event-stream"?me=re:le==="multipart/form-data"?me=yield re.formData():me=yield re.text(),{data:me,error:null,response:re}}catch(d){return{data:null,error:d,response:d instanceof D0||d instanceof R0?d.context:void 0}}finally{_&&clearTimeout(_)}})}}var hj=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},dj=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let f=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async _=>{let y=null,d=null,A=null,j=_.status,B=_.statusText;if(_.ok){var N,V;if(r.method!=="HEAD"){var Q;const re=await _.text();re===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((Q=r.headers.get("Accept"))===null||Q===void 0)&&Q.includes("application/vnd.pgrst.plan+text"))?d=re:d=JSON.parse(re))}const J=(N=r.headers.get("Prefer"))===null||N===void 0?void 0:N.match(/count=(exact|planned|estimated)/),ye=(V=_.headers.get("content-range"))===null||V===void 0?void 0:V.split("/");J&&ye&&ye.length>1&&(A=parseInt(ye[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(d)&&(d.length>1?(y={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,A=null,j=406,B="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var ne;const J=await _.text();try{y=JSON.parse(J),Array.isArray(y)&&_.status===404&&(d=[],y=null,j=200,B="OK")}catch{_.status===404&&J===""?(j=204,B="No Content"):y={message:J}}if(y&&r.isMaybeSingle&&(!(y==null||(ne=y.details)===null||ne===void 0)&&ne.includes("0 rows"))&&(y=null,j=200,B="OK"),y&&r.shouldThrowOnError)throw new hj(y)}return{error:y,data:d,count:A,status:j,statusText:B}});return this.shouldThrowOnError||(f=f.catch(_=>{var y;let d="";const A=_?.cause;if(A){var j,B,N,V;const ne=(j=A?.message)!==null&&j!==void 0?j:"",J=(B=A?.code)!==null&&B!==void 0?B:"";d=`${(N=_?.name)!==null&&N!==void 0?N:"FetchError"}: ${_?.message}`,d+=`

Caused by: ${(V=A?.name)!==null&&V!==void 0?V:"Error"}: ${ne}`,J&&(d+=` (${J})`),A?.stack&&(d+=`
${A.stack}`)}else{var Q;d=(Q=_?.stack)!==null&&Q!==void 0?Q:""}return{error:{message:`${(y=_?.name)!==null&&y!==void 0?y:"FetchError"}: ${_?.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),f.then(t,e)}returns(){return this}overrideTypes(){return this}},fj=class extends dj{select(t){let e=!1;const r=(t??"*").split("").map(l=>/\s/.test(l)&&!e?"":(l==='"'&&(e=!e),l)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:l,referencedTable:f=l}={}){const _=f?`${f}.order`:"order",y=this.url.searchParams.get(_);return this.url.searchParams.set(_,`${y?`${y},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const l=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(l,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:l=r}={}){const f=typeof l>"u"?"offset":`${l}.offset`,_=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(f,`${t}`),this.url.searchParams.set(_,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:l=!1,wal:f=!1,format:_="text"}={}){var y;const d=[t?"analyze":null,e?"verbose":null,r?"settings":null,l?"buffers":null,f?"wal":null].filter(Boolean).join("|"),A=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${_}; for="${A}"; options=${d};`),_==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const O0=new RegExp("[,()]");var Kf=class extends fj{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(l=>typeof l=="string"&&O0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(l=>typeof l=="string"&&O0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:l}={}){let f="";l==="plain"?f="pl":l==="phrase"?f="ph":l==="websearch"&&(f="w");const _=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${f}fts${_}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const l=r?`${r}.or`:"or";return this.url.searchParams.append(l,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},pj=class{constructor(t,{headers:e={},schema:r,fetch:l}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=l}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:r=!1,count:l}=e??{},f=r?"HEAD":"GET";let _=!1;const y=(t??"*").split("").map(j=>/\s/.test(j)&&!_?"":(j==='"'&&(_=!_),j)).join(""),{url:d,headers:A}=this.cloneRequestState();return d.searchParams.set("select",y),l&&A.append("Prefer",`count=${l}`),new Kf({method:f,url:d,headers:A,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var l;const f="POST",{url:_,headers:y}=this.cloneRequestState();if(e&&y.append("Prefer",`count=${e}`),r||y.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((A,j)=>A.concat(Object.keys(j)),[]);if(d.length>0){const A=[...new Set(d)].map(j=>`"${j}"`);_.searchParams.set("columns",A.join(","))}}return new Kf({method:f,url:_,headers:y,schema:this.schema,body:t,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:l,defaultToNull:f=!0}={}){var _;const y="POST",{url:d,headers:A}=this.cloneRequestState();if(A.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&d.searchParams.set("on_conflict",e),l&&A.append("Prefer",`count=${l}`),f||A.append("Prefer","missing=default"),Array.isArray(t)){const j=t.reduce((B,N)=>B.concat(Object.keys(N)),[]);if(j.length>0){const B=[...new Set(j)].map(N=>`"${N}"`);d.searchParams.set("columns",B.join(","))}}return new Kf({method:y,url:d,headers:A,schema:this.schema,body:t,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}update(t,{count:e}={}){var r;const l="PATCH",{url:f,headers:_}=this.cloneRequestState();return e&&_.append("Prefer",`count=${e}`),new Kf({method:l,url:f,headers:_,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE",{url:l,headers:f}=this.cloneRequestState();return t&&f.append("Prefer",`count=${t}`),new Kf({method:r,url:l,headers:f,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},mj=class kS{constructor(e,{headers:r={},schema:l,fetch:f}={}){this.url=e,this.headers=new Headers(r),this.schemaName=l,this.fetch=f}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new pj(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new kS(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:l=!1,get:f=!1,count:_}={}){var y;let d;const A=new URL(`${this.url}/rpc/${e}`);let j;const B=Q=>Q!==null&&typeof Q=="object"&&(!Array.isArray(Q)||Q.some(B)),N=l&&Object.values(r).some(B);N?(d="POST",j=r):l||f?(d=l?"HEAD":"GET",Object.entries(r).filter(([Q,ne])=>ne!==void 0).map(([Q,ne])=>[Q,Array.isArray(ne)?`{${ne.join(",")}}`:`${ne}`]).forEach(([Q,ne])=>{A.searchParams.append(Q,ne)})):(d="POST",j=r);const V=new Headers(this.headers);return N?V.set("Prefer",_?`count=${_},return=minimal`:"return=minimal"):_&&V.set("Prefer",`count=${_}`),new Kf({method:d,url:A,headers:V,schema:this.schemaName,body:j,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}};class gj{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const l=r.versions;if(l&&l.node){const f=l.node,_=parseInt(f.replace(/^v/,"").split(".")[0]);return _>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${_} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${_} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const l=this.getWebSocketConstructor();return new l(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const yj="2.90.1",_j=`realtime-js/${yj}`,CS="1.0.0",vj="2.0.0",N0=CS,Zv=1e4,xj=1e3,bj=100;var Fh;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Fh||(Fh={}));var na;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(na||(na={}));var Ac;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ac||(Ac={}));var Gv;(function(t){t.websocket="websocket"})(Gv||(Gv={}));var Vd;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Vd||(Vd={}));class wj{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let l=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(l))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,l;const f=(l=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,f)}_encodeJsonUserBroadcastPush(e){var r,l;const f=(l=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:{},y=new TextEncoder().encode(JSON.stringify(f)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,y)}_encodeUserBroadcastPush(e,r,l){var f,_;const y=e.topic,d=(f=e.ref)!==null&&f!==void 0?f:"",A=(_=e.join_ref)!==null&&_!==void 0?_:"",j=e.payload.event,B=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},N=Object.keys(B).length===0?"":JSON.stringify(B);if(A.length>255)throw new Error(`joinRef length ${A.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`topic length ${y.length} exceeds maximum of 255`);if(j.length>255)throw new Error(`userEvent length ${j.length} exceeds maximum of 255`);if(N.length>255)throw new Error(`metadata length ${N.length} exceeds maximum of 255`);const V=this.USER_BROADCAST_PUSH_META_LENGTH+A.length+d.length+y.length+j.length+N.length,Q=new ArrayBuffer(this.HEADER_LENGTH+V);let ne=new DataView(Q),J=0;ne.setUint8(J++,this.KINDS.userBroadcastPush),ne.setUint8(J++,A.length),ne.setUint8(J++,d.length),ne.setUint8(J++,y.length),ne.setUint8(J++,j.length),ne.setUint8(J++,N.length),ne.setUint8(J++,r),Array.from(A,re=>ne.setUint8(J++,re.charCodeAt(0))),Array.from(d,re=>ne.setUint8(J++,re.charCodeAt(0))),Array.from(y,re=>ne.setUint8(J++,re.charCodeAt(0))),Array.from(j,re=>ne.setUint8(J++,re.charCodeAt(0))),Array.from(N,re=>ne.setUint8(J++,re.charCodeAt(0)));var ye=new Uint8Array(Q.byteLength+l.byteLength);return ye.set(new Uint8Array(Q),0),ye.set(new Uint8Array(l),Q.byteLength),ye.buffer}decode(e,r){if(this._isArrayBuffer(e)){let l=this._binaryDecode(e);return r(l)}if(typeof e=="string"){const l=JSON.parse(e),[f,_,y,d,A]=l;return r({join_ref:f,ref:_,topic:y,event:d,payload:A})}return r({})}_binaryDecode(e){const r=new DataView(e),l=r.getUint8(0),f=new TextDecoder;if(l===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,r,f)}_decodeUserBroadcast(e,r,l){const f=r.getUint8(1),_=r.getUint8(2),y=r.getUint8(3),d=r.getUint8(4);let A=this.HEADER_LENGTH+4;const j=l.decode(e.slice(A,A+f));A=A+f;const B=l.decode(e.slice(A,A+_));A=A+_;const N=l.decode(e.slice(A,A+y));A=A+y;const V=e.slice(A,e.byteLength),Q=d===this.JSON_ENCODING?JSON.parse(l.decode(V)):V,ne={type:this.BROADCAST_EVENT,event:B,payload:Q};return y>0&&(ne.meta=JSON.parse(N)),{join_ref:null,ref:null,topic:j,event:this.BROADCAST_EVENT,payload:ne}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([l])=>r.includes(l)))}}class AS{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var zs;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(zs||(zs={}));const B0=(t,e,r={})=>{var l;const f=(l=r.skipTypes)!==null&&l!==void 0?l:[];return e?Object.keys(e).reduce((_,y)=>(_[y]=Sj(y,t,e,f),_),{}):{}},Sj=(t,e,r,l)=>{const f=e.find(d=>d.name===t),_=f?.type,y=r[t];return _&&!l.includes(_)?MS(_,y):Wv(y)},MS=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Cj(e,r)}switch(t){case zs.bool:return Tj(e);case zs.float4:case zs.float8:case zs.int2:case zs.int4:case zs.int8:case zs.numeric:case zs.oid:return Ej(e);case zs.json:case zs.jsonb:return kj(e);case zs.timestamp:return Aj(e);case zs.abstime:case zs.date:case zs.daterange:case zs.int4range:case zs.int8range:case zs.money:case zs.reltime:case zs.text:case zs.time:case zs.timestamptz:case zs.timetz:case zs.tsrange:case zs.tstzrange:return Wv(e);default:return Wv(e)}},Wv=t=>t,Tj=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Ej=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},kj=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Cj=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,l=t[r];if(t[0]==="{"&&l==="}"){let _;const y=t.slice(1,r);try{_=JSON.parse("["+y+"]")}catch{_=y?y.split(","):[]}return _.map(d=>MS(e,d))}return t},Aj=t=>typeof t=="string"?t.replace(" ","T"):t,PS=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class rv{constructor(e,r,l={},f=Zv){this.channel=e,this.event=r,this.payload=l,this.timeout=f,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var l;return this._hasReceived(e)&&r((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(l=>l.status===e).forEach(l=>l.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $0;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})($0||($0={}));class jm{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},f=>{const{onJoin:_,onLeave:y,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jm.syncState(this.state,f,_,y),this.pendingDiffs.forEach(A=>{this.state=jm.syncDiff(this.state,A,_,y)}),this.pendingDiffs=[],d()}),this.channel._on(l.diff,{},f=>{const{onJoin:_,onLeave:y,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(f):(this.state=jm.syncDiff(this.state,f,_,y),d())}),this.onJoin((f,_,y)=>{this.channel._trigger("presence",{event:"join",key:f,currentPresences:_,newPresences:y})}),this.onLeave((f,_,y)=>{this.channel._trigger("presence",{event:"leave",key:f,currentPresences:_,leftPresences:y})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,l,f){const _=this.cloneDeep(e),y=this.transformState(r),d={},A={};return this.map(_,(j,B)=>{y[j]||(A[j]=B)}),this.map(y,(j,B)=>{const N=_[j];if(N){const V=B.map(ye=>ye.presence_ref),Q=N.map(ye=>ye.presence_ref),ne=B.filter(ye=>Q.indexOf(ye.presence_ref)<0),J=N.filter(ye=>V.indexOf(ye.presence_ref)<0);ne.length>0&&(d[j]=ne),J.length>0&&(A[j]=J)}else d[j]=B}),this.syncDiff(_,{joins:d,leaves:A},l,f)}static syncDiff(e,r,l,f){const{joins:_,leaves:y}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return l||(l=()=>{}),f||(f=()=>{}),this.map(_,(d,A)=>{var j;const B=(j=e[d])!==null&&j!==void 0?j:[];if(e[d]=this.cloneDeep(A),B.length>0){const N=e[d].map(Q=>Q.presence_ref),V=B.filter(Q=>N.indexOf(Q.presence_ref)<0);e[d].unshift(...V)}l(d,B,A)}),this.map(y,(d,A)=>{let j=e[d];if(!j)return;const B=A.map(N=>N.presence_ref);j=j.filter(N=>B.indexOf(N.presence_ref)<0),e[d]=j,f(d,j,A),j.length===0&&delete e[d]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(l=>r(l,e[l]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,l)=>{const f=e[l];return"metas"in f?r[l]=f.metas.map(_=>(_.presence_ref=_.phx_ref,delete _.phx_ref,delete _.phx_ref_prev,_)):r[l]=f,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var U0;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(U0||(U0={}));var Im;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Im||(Im={}));var Hu;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Hu||(Hu={}));class np{constructor(e,r={config:{}},l){var f,_;if(this.topic=e,this.params=r,this.socket=l,this.bindings={},this.state=na.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new rv(this,Ac.join,this.params,this.timeout),this.rejoinTimer=new AS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=na.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(y=>y.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=na.closed,this.socket._remove(this)}),this._onError(y=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,y),this.state=na.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=na.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",y=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,y),this.state=na.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ac.reply,{},(y,d)=>{this._trigger(this._replyEventName(d),y)}),this.presence=new jm(this),this.broadcastEndpointURL=PS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((_=(f=this.params.config)===null||f===void 0?void 0:f.broadcast)===null||_===void 0)&&_.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var l,f,_;if(this.socket.isConnected()||this.socket.connect(),this.state==na.closed){const{config:{broadcast:y,presence:d,private:A}}=this.params,j=(f=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(Q=>Q.filter))!==null&&f!==void 0?f:[],B=!!this.bindings[Im.PRESENCE]&&this.bindings[Im.PRESENCE].length>0||((_=this.params.config.presence)===null||_===void 0?void 0:_.enabled)===!0,N={},V={broadcast:y,presence:Object.assign(Object.assign({},d),{enabled:B}),postgres_changes:j,private:A};this.socket.accessTokenValue&&(N.access_token=this.socket.accessTokenValue),this._onError(Q=>e?.(Hu.CHANNEL_ERROR,Q)),this._onClose(()=>e?.(Hu.CLOSED)),this.updateJoinPayload(Object.assign({config:V},N)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:Q})=>{var ne;if(this.socket._isManualToken()||this.socket.setAuth(),Q===void 0){e?.(Hu.SUBSCRIBED);return}else{const J=this.bindings.postgres_changes,ye=(ne=J?.length)!==null&&ne!==void 0?ne:0,re=[];for(let ge=0;ge<ye;ge++){const le=J[ge],{filter:{event:me,schema:be,table:ke,filter:Me}}=le,Ue=Q&&Q[ge];if(Ue&&Ue.event===me&&np.isFilterValueEqual(Ue.schema,be)&&np.isFilterValueEqual(Ue.table,ke)&&np.isFilterValueEqual(Ue.filter,Me))re.push(Object.assign(Object.assign({},le),{id:Ue.id}));else{this.unsubscribe(),this.state=na.errored,e?.(Hu.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=re,e&&e(Hu.SUBSCRIBED);return}}).receive("error",Q=>{this.state=na.errored,e?.(Hu.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(Q).join(", ")||"error")))}).receive("timeout",()=>{e?.(Hu.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,l){return this.state===na.joined&&e===Im.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,l)}async httpSend(e,r,l={}){var f;if(r==null)return Promise.reject("Payload is required for httpSend()");const _={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(_.Authorization=`Bearer ${this.socket.accessTokenValue}`);const y={method:"POST",headers:_,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,y,(f=l.timeout)!==null&&f!==void 0?f:this.timeout);if(d.status===202)return{success:!0};let A=d.statusText;try{const j=await d.json();A=j.error||j.message||A}catch{}return Promise.reject(new Error(A))}async send(e,r={}){var l,f;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:_,payload:y}=e,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const A={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:_,payload:y,private:this.private}]})};try{const j=await this._fetchWithTimeout(this.broadcastEndpointURL,A,(l=r.timeout)!==null&&l!==void 0?l:this.timeout);return await((f=j.body)===null||f===void 0?void 0:f.cancel()),j.ok?"ok":"error"}catch(j){return j.name==="AbortError"?"timed out":"error"}}else return new Promise(_=>{var y,d,A;const j=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((A=(d=(y=this.params)===null||y===void 0?void 0:y.config)===null||d===void 0?void 0:d.broadcast)===null||A===void 0)&&A.ack)&&_("ok"),j.receive("ok",()=>_("ok")),j.receive("error",()=>_("error")),j.receive("timeout",()=>_("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=na.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ac.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(f=>{l=new rv(this,Ac.leave,{},e),l.receive("ok",()=>{r(),f("ok")}).receive("timeout",()=>{r(),f("timed out")}).receive("error",()=>{f("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=na.closed,this.bindings={}}async _fetchWithTimeout(e,r,l){const f=new AbortController,_=setTimeout(()=>f.abort(),l),y=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:f.signal}));return clearTimeout(_),y}_push(e,r,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let f=new rv(this,e,r,l);return this._canPush()?f.send():this._addToPushBuffer(f),f}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bj){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,l){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,l){var f,_;const y=e.toLocaleLowerCase(),{close:d,error:A,leave:j,join:B}=Ac;if(l&&[d,A,j,B].indexOf(y)>=0&&l!==this._joinRef())return;let V=this._onMessage(y,r,l);if(r&&!V)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(y)?(f=this.bindings.postgres_changes)===null||f===void 0||f.filter(Q=>{var ne,J,ye;return((ne=Q.filter)===null||ne===void 0?void 0:ne.event)==="*"||((ye=(J=Q.filter)===null||J===void 0?void 0:J.event)===null||ye===void 0?void 0:ye.toLocaleLowerCase())===y}).map(Q=>Q.callback(V,l)):(_=this.bindings[y])===null||_===void 0||_.filter(Q=>{var ne,J,ye,re,ge,le,me,be;if(["broadcast","presence","postgres_changes"].includes(y))if("id"in Q){const ke=Q.id,Me=(ne=Q.filter)===null||ne===void 0?void 0:ne.event;return ke&&((J=r.ids)===null||J===void 0?void 0:J.includes(ke))&&(Me==="*"||Me?.toLocaleLowerCase()===((ye=r.data)===null||ye===void 0?void 0:ye.type.toLocaleLowerCase()))&&(!(!((re=Q.filter)===null||re===void 0)&&re.table)||Q.filter.table===((ge=r.data)===null||ge===void 0?void 0:ge.table))}else{const ke=(me=(le=Q?.filter)===null||le===void 0?void 0:le.event)===null||me===void 0?void 0:me.toLocaleLowerCase();return ke==="*"||ke===((be=r?.event)===null||be===void 0?void 0:be.toLocaleLowerCase())}else return Q.type.toLocaleLowerCase()===y}).map(Q=>{if(typeof V=="object"&&"ids"in V){const ne=V.data,{schema:J,table:ye,commit_timestamp:re,type:ge,errors:le}=ne;V=Object.assign(Object.assign({},{schema:J,table:ye,commit_timestamp:re,eventType:ge,new:{},old:{},errors:le}),this._getPayloadRecords(ne))}Q.callback(V,l)})}_isClosed(){return this.state===na.closed}_isJoined(){return this.state===na.joined}_isJoining(){return this.state===na.joining}_isLeaving(){return this.state===na.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,l){const f=e.toLocaleLowerCase(),_={type:f,filter:r,callback:l};return this.bindings[f]?this.bindings[f].push(_):this.bindings[f]=[_],this}_off(e,r){const l=e.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(f=>{var _;return!(((_=f.type)===null||_===void 0?void 0:_.toLocaleLowerCase())===l&&np.isEqual(f.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const l in e)if(e[l]!==r[l])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ac.close,{},e)}_onError(e){this._on(Ac.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=na.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=B0(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=B0(e.columns,e.old_record)),r}}const av=()=>{},gy={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Mj=[1e3,2e3,5e3,1e4],Pj=1e4,jj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ij{constructor(e,r){var l;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zv,this.transport=null,this.heartbeatIntervalMs=gy.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=av,this.ref=0,this.reconnectTimer=null,this.vsn=N0,this.logger=av,this.conn=null,this.sendBuffer=[],this.serializer=new wj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=f=>f?(..._)=>f(..._):(..._)=>fetch(..._),!(!((l=r?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Gv.websocket}`,this.httpEndpoint=PS(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=gj.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,l){this.logger(e,r,l)}connectionState(){switch(this.conn&&this.conn.readyState){case Fh.connecting:return Vd.Connecting;case Fh.open:return Vd.Open;case Fh.closing:return Vd.Closing;default:return Vd.Closed}}isConnected(){return this.connectionState()===Vd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const l=`realtime:${e}`,f=this.getChannels().find(_=>_.topic===l);if(f)return f;{const _=new np(`realtime:${e}`,r,this);return this.channels.push(_),_}}push(e){const{topic:r,event:l,payload:f,ref:_}=e,y=()=>{this.encode(e,d=>{var A;(A=this.conn)===null||A===void 0||A.send(d)})};this.log("push",`${r} ${l} (${_})`,f),this.isConnected()?y():this.sendBuffer.push(y)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(xj,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},gy.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(l=>l.topic===e&&(l._isJoined()||l._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const j=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",j)}catch(B){this.log("error","error in heartbeat callback",B)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:l,event:f,payload:_,ref:y}=r,d=y?`(${y})`:"",A=_.status||"";this.log("receive",`${A} ${l} ${f} ${d}`.trim(),_),this.channels.filter(j=>j._isMember(l)).forEach(j=>j._trigger(f,_,y)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Fh.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Fh.open||this.conn.readyState===Fh.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ac.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const l=e.match(/\?/)?"&":"?",f=new URLSearchParams(r);return`${e}${l}${f}`}_workerObjectUrl(e){let r;if(e)r=e;else{const l=new Blob([jj],{type:"application/javascript"});r=URL.createObjectURL(l)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,l=!1;if(e)r=e,l=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(f){this.log("error","Error fetching access token from callback",f),r=this.accessTokenValue}else r=this.accessTokenValue;l?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(f=>{const _={access_token:r,version:_j};r&&f.updateJoinPayload(_),f.joinedOnce&&f._isJoined()&&f._push(Ac.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(l=>{try{l(r)}catch(f){this.log("error",`error in ${e} callback`,f)}})}catch(l){this.log("error",`error triggering ${e} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new AS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gy.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,l,f,_,y,d,A,j,B,N,V,Q;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(l=e?.timeout)!==null&&l!==void 0?l:Zv,this.heartbeatIntervalMs=(f=e?.heartbeatIntervalMs)!==null&&f!==void 0?f:gy.HEARTBEAT_INTERVAL,this.worker=(_=e?.worker)!==null&&_!==void 0?_:!1,this.accessToken=(y=e?.accessToken)!==null&&y!==void 0?y:null,this.heartbeatCallback=(d=e?.heartbeatCallback)!==null&&d!==void 0?d:av,this.vsn=(A=e?.vsn)!==null&&A!==void 0?A:N0,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(j=e?.reconnectAfterMs)!==null&&j!==void 0?j:(ne=>Mj[ne-1]||Pj),this.vsn){case CS:this.encode=(B=e?.encode)!==null&&B!==void 0?B:((ne,J)=>J(JSON.stringify(ne))),this.decode=(N=e?.decode)!==null&&N!==void 0?N:((ne,J)=>J(JSON.parse(ne)));break;case vj:this.encode=(V=e?.encode)!==null&&V!==void 0?V:this.serializer.encode.bind(this.serializer),this.decode=(Q=e?.decode)!==null&&Q!==void 0?Q:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Vm=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Lj(t,e,r){const l=new URL(e,t);if(r)for(const[f,_]of Object.entries(r))_!==void 0&&l.searchParams.set(f,_);return l.toString()}async function zj(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function Rj(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:l,query:f,body:_,headers:y}){const d=Lj(t.baseUrl,l,f),A=await zj(t.auth),j=await e(d,{method:r,headers:{..._?{"Content-Type":"application/json"}:{},...A,...y},body:_?JSON.stringify(_):void 0}),B=await j.text(),N=(j.headers.get("content-type")||"").includes("application/json"),V=N&&B?JSON.parse(B):B;if(!j.ok){const Q=N?V:void 0,ne=Q?.error;throw new Vm(ne?.message??`Request failed with status ${j.status}`,{status:j.status,icebergType:ne?.type,icebergCode:ne?.code,details:Q})}return{status:j.status,headers:j.headers,data:V}}}}function yy(t){return t.join("")}var Dj=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:yy(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(l=>({namespace:l}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${yy(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${yy(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${yy(t.namespace)}`}),!0}catch(e){if(e instanceof Vm&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Vm&&r.status===409)return;throw r}}};function Uf(t){return t.join("")}var Oj=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Uf(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Vm&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Vm&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},Nj=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=Rj({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new Dj(this.client,e),this.tableOps=new Oj(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},d_=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function ir(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Bj=class extends d_{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Yv=class extends d_{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const $x=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),$j=()=>Response,Xv=t=>{if(Array.isArray(t))return t.map(r=>Xv(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,l])=>{const f=r.replace(/([-_][a-z])/gi,_=>_.toUpperCase().replace(/[-_]/g,""));e[f]=Xv(l)}),e},Uj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Fj=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function qm(t){"@babel/helpers - typeof";return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qm(t)}function Vj(t,e){if(qm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var l=r.call(t,e);if(qm(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qj(t){var e=Vj(t,"string");return qm(e)=="symbol"?e:e+""}function Hj(t,e,r){return(e=qj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),r.push.apply(r,l)}return r}function Fi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F0(Object(r),!0).forEach(function(l){Hj(t,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F0(Object(r)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(r,l))})}return t}const ov=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Zj=async(t,e,r)=>{t instanceof await $j()&&!r?.noResolveJson?t.json().then(l=>{const f=t.status||500,_=l?.statusCode||f+"";e(new Bj(ov(l),f,_))}).catch(l=>{e(new Yv(ov(l),l))}):e(new Yv(ov(t),t))},Gj=(t,e,r,l)=>{const f={method:t,headers:e?.headers||{}};return t==="GET"||!l?f:(Uj(l)?(f.headers=Fi({"Content-Type":"application/json"},e?.headers),f.body=JSON.stringify(l)):f.body=l,e?.duplex&&(f.duplex=e.duplex),Fi(Fi({},f),r))};async function tg(t,e,r,l,f,_){return new Promise((y,d)=>{t(r,Gj(e,l,f,_)).then(A=>{if(!A.ok)throw A;return l?.noResolveJson?A:A.json()}).then(A=>y(A)).catch(A=>Zj(A,d,l))})}async function Hm(t,e,r,l){return tg(t,"GET",e,r,l)}async function Cc(t,e,r,l,f){return tg(t,"POST",e,l,f,r)}async function Kv(t,e,r,l,f){return tg(t,"PUT",e,l,f,r)}async function Wj(t,e,r,l){return tg(t,"HEAD",e,Fi(Fi({},r),{},{noResolveJson:!0}),l)}async function Ux(t,e,r,l,f){return tg(t,"DELETE",e,l,f,r)}var Yj=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ir(e))return{data:null,error:e};throw e}}};let jS;jS=Symbol.toStringTag;var Xj=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[jS]="BlobDownloadBuilder",this.promise=null}asStream(){return new Yj(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ir(e))return{data:null,error:e};throw e}}};const Kj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},V0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Jj=class{constructor(t,e={},r,l){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=$x(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,l){var f=this;try{let _;const y=Fi(Fi({},V0),l);let d=Fi(Fi({},f.headers),t==="POST"&&{"x-upsert":String(y.upsert)});const A=y.metadata;typeof Blob<"u"&&r instanceof Blob?(_=new FormData,_.append("cacheControl",y.cacheControl),A&&_.append("metadata",f.encodeMetadata(A)),_.append("",r)):typeof FormData<"u"&&r instanceof FormData?(_=r,_.has("cacheControl")||_.append("cacheControl",y.cacheControl),A&&!_.has("metadata")&&_.append("metadata",f.encodeMetadata(A))):(_=r,d["cache-control"]=`max-age=${y.cacheControl}`,d["content-type"]=y.contentType,A&&(d["x-metadata"]=f.toBase64(f.encodeMetadata(A))),(typeof ReadableStream<"u"&&_ instanceof ReadableStream||_&&typeof _=="object"&&"pipe"in _&&typeof _.pipe=="function")&&!y.duplex&&(y.duplex="half")),l?.headers&&(d=Fi(Fi({},d),l.headers));const j=f._removeEmptyFolders(e),B=f._getFinalPath(j),N=await(t=="PUT"?Kv:Cc)(f.fetch,`${f.url}/object/${B}`,_,Fi({headers:d},y?.duplex?{duplex:y.duplex}:{}));return{data:{path:j,id:N.Id,fullPath:N.Key},error:null}}catch(_){if(f.shouldThrowOnError)throw _;if(ir(_))return{data:null,error:_};throw _}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,l){var f=this;const _=f._removeEmptyFolders(t),y=f._getFinalPath(_),d=new URL(f.url+`/object/upload/sign/${y}`);d.searchParams.set("token",e);try{let A;const j=Fi({upsert:V0.upsert},l),B=Fi(Fi({},f.headers),{"x-upsert":String(j.upsert)});return typeof Blob<"u"&&r instanceof Blob?(A=new FormData,A.append("cacheControl",j.cacheControl),A.append("",r)):typeof FormData<"u"&&r instanceof FormData?(A=r,A.append("cacheControl",j.cacheControl)):(A=r,B["cache-control"]=`max-age=${j.cacheControl}`,B["content-type"]=j.contentType),{data:{path:_,fullPath:(await Kv(f.fetch,d.toString(),A,{headers:B})).Key},error:null}}catch(A){if(f.shouldThrowOnError)throw A;if(ir(A))return{data:null,error:A};throw A}}async createSignedUploadUrl(t,e){var r=this;try{let l=r._getFinalPath(t);const f=Fi({},r.headers);e?.upsert&&(f["x-upsert"]="true");const _=await Cc(r.fetch,`${r.url}/object/upload/sign/${l}`,{},{headers:f}),y=new URL(r.url+_.url),d=y.searchParams.get("token");if(!d)throw new d_("No token returned by API");return{data:{signedUrl:y.toString(),path:t,token:d},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(ir(l))return{data:null,error:l};throw l}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var l=this;try{return{data:await Cc(l.fetch,`${l.url}/object/move`,{bucketId:l.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:l.headers}),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(ir(f))return{data:null,error:f};throw f}}async copy(t,e,r){var l=this;try{return{data:{path:(await Cc(l.fetch,`${l.url}/object/copy`,{bucketId:l.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:l.headers})).Key},error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(ir(f))return{data:null,error:f};throw f}}async createSignedUrl(t,e,r){var l=this;try{let f=l._getFinalPath(t),_=await Cc(l.fetch,`${l.url}/object/sign/${f}`,Fi({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:l.headers});const y=r?.download?`&download=${r.download===!0?"":r.download}`:"";return _={signedUrl:encodeURI(`${l.url}${_.signedURL}${y}`)},{data:_,error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(ir(f))return{data:null,error:f};throw f}}async createSignedUrls(t,e,r){var l=this;try{const f=await Cc(l.fetch,`${l.url}/object/sign/${l.bucketId}`,{expiresIn:e,paths:t},{headers:l.headers}),_=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:f.map(y=>Fi(Fi({},y),{},{signedUrl:y.signedURL?encodeURI(`${l.url}${y.signedURL}${_}`):null})),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(ir(f))return{data:null,error:f};throw f}}download(t,e){const r=typeof e?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(e?.transform||{}),f=l?`?${l}`:"",_=this._getFinalPath(t),y=()=>Hm(this.fetch,`${this.url}/${r}/${_}${f}`,{headers:this.headers,noResolveJson:!0});return new Xj(y,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:Xv(await Hm(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(l){if(e.shouldThrowOnError)throw l;if(ir(l))return{data:null,error:l};throw l}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await Wj(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(l){if(e.shouldThrowOnError)throw l;if(ir(l)&&l instanceof Yv){const f=l.originalError;if([400,404].includes(f?.status))return{data:!1,error:l}}throw l}}getPublicUrl(t,e){const r=this._getFinalPath(t),l=[],f=e?.download?`download=${e.download===!0?"":e.download}`:"";f!==""&&l.push(f);const _=typeof e?.transform<"u"?"render/image":"object",y=this.transformOptsToQueryString(e?.transform||{});y!==""&&l.push(y);let d=l.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${_}/public/${r}${d}`)}}}async remove(t){var e=this;try{return{data:await Ux(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}async list(t,e,r){var l=this;try{const f=Fi(Fi(Fi({},Kj),e),{},{prefix:t||""});return{data:await Cc(l.fetch,`${l.url}/object/list/${l.bucketId}`,f,{headers:l.headers},r),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(ir(f))return{data:null,error:f};throw f}}async listV2(t,e){var r=this;try{const l=Fi({},t);return{data:await Cc(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,l,{headers:r.headers},e),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(ir(l))return{data:null,error:l};throw l}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const IS="2.90.1",LS={"X-Client-Info":`storage-js/${IS}`};var Qj=class{constructor(t,e={},r,l){this.shouldThrowOnError=!1;const f=new URL(t);l?.useNewHostname&&/supabase\.(co|in|red)$/.test(f.hostname)&&!f.hostname.includes("storage.supabase.")&&(f.hostname=f.hostname.replace("supabase.","storage.supabase.")),this.url=f.href.replace(/\/$/,""),this.headers=Fi(Fi({},LS),e),this.fetch=$x(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await Hm(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Hm(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await Cc(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(ir(l))return{data:null,error:l};throw l}}async updateBucket(t,e){var r=this;try{return{data:await Kv(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(ir(l))return{data:null,error:l};throw l}}async emptyBucket(t){var e=this;try{return{data:await Cc(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ux(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},eI=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Fi(Fi({},LS),e),this.fetch=$x(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Cc(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const l=r.toString(),f=l?`${e.url}/bucket?${l}`:`${e.url}/bucket`;return{data:await Hm(e.fetch,f,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ux(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ir(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!Fj(t))throw new d_("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Nj({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),l=this.shouldThrowOnError;return new Proxy(r,{get(f,_){const y=f[_];return typeof y!="function"?y:async(...d)=>{try{return{data:await y.apply(f,d),error:null}}catch(A){if(l)throw A;return{data:null,error:A}}}}})}};const Fx={"X-Client-Info":`storage-js/${IS}`,"Content-Type":"application/json"};var zS=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ml(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var lv=class extends zS{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},tI=class extends zS{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Vx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),iI=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},q0=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),nI=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const l=t.status||500,f=t;if(typeof f.json=="function")f.json().then(_=>{const y=_?.statusCode||_?.code||l+"";e(new lv(q0(_),l,y))}).catch(()=>{const _=l+"";e(new lv(f.statusText||`HTTP ${l} error`,l,_))});else{const _=l+"";e(new lv(f.statusText||`HTTP ${l} error`,l,_))}}else e(new tI(q0(t),t))},sI=(t,e,r,l)=>{const f={method:t,headers:e?.headers||{}};return l?(iI(l)?(f.headers=Fi({"Content-Type":"application/json"},e?.headers),f.body=JSON.stringify(l)):f.body=l,Fi(Fi({},f),r)):f};async function rI(t,e,r,l,f,_){return new Promise((y,d)=>{t(r,sI(e,l,f,_)).then(A=>{if(!A.ok)throw A;if(l?.noResolveJson)return A;const j=A.headers.get("content-type");return!j||!j.includes("application/json")?{}:A.json()}).then(A=>y(A)).catch(A=>nI(A,d,l))})}async function Pl(t,e,r,l,f){return rI(t,"POST",e,l,f,r)}var aI=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Fi(Fi({},Fx),e),this.fetch=Vx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await Pl(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(Ml(l))return{data:null,error:l};throw l}}async listIndexes(t){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await Pl(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(Ml(l))return{data:null,error:l};throw l}}},oI=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Fi(Fi({},Fx),e),this.fetch=Vx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Pl(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Pl(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Pl(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}},lI=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Fi(Fi({},Fx),e),this.fetch=Vx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Pl(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ml(r))return{data:null,error:r};throw r}}},cI=class extends lI{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new uI(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},uI=class extends aI{constructor(t,e,r,l){super(t,e,l),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,Fi(Fi({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,Fi(Fi({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new hI(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},hI=class extends oI{constructor(t,e,r,l,f){super(t,e,f),this.vectorBucketName=r,this.indexName=l}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,Fi(Fi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,Fi(Fi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,Fi(Fi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,Fi(Fi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,Fi(Fi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},dI=class extends Qj{constructor(t,e={},r,l){super(t,e,r,l)}from(t){return new Jj(this.url,this.headers,t,this.fetch)}get vectors(){return new cI(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new eI(this.url+"/iceberg",this.headers,this.fetch)}};const RS="2.90.1",Jf=30*1e3,Jv=3,cv=Jv*Jf,fI="http://localhost:9999",pI="supabase.auth.token",mI={"X-Client-Info":`gotrue-js/${RS}`},Qv="X-Supabase-Api-Version",DS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gI=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yI=600*1e3;class Zm extends Error{constructor(e,r,l){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=l}}function Pi(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class _I extends Zm{constructor(e,r,l){super(e,r,l),this.name="AuthApiError",this.status=r,this.code=l}}function vI(t){return Pi(t)&&t.name==="AuthApiError"}class qd extends Zm{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Qu extends Zm{constructor(e,r,l,f){super(e,l,f),this.name=r,this.status=l}}class Al extends Qu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function xI(t){return Pi(t)&&t.name==="AuthSessionMissingError"}class Ff extends Qu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _y extends Qu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class vy extends Qu{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function bI(t){return Pi(t)&&t.name==="AuthImplicitGrantRedirectError"}class H0 extends Qu{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wI extends Qu{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ex extends Qu{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function uv(t){return Pi(t)&&t.name==="AuthRetryableFetchError"}class Z0 extends Qu{constructor(e,r,l){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=l}}class tx extends Qu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),G0=` 	
\r=`.split(""),SI=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<G0.length;e+=1)t[G0[e].charCodeAt(0)]=-2;for(let e=0;e<Jy.length;e+=1)t[Jy[e].charCodeAt(0)]=e;return t})();function W0(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const l=e.queue>>e.queuedBits-6&63;r(Jy[l]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const l=e.queue>>e.queuedBits-6&63;r(Jy[l]),e.queuedBits-=6}}function OS(t,e,r){const l=SI[t];if(l>-1)for(e.queue=e.queue<<6|l,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Y0(t){const e=[],r=y=>{e.push(String.fromCodePoint(y))},l={utf8seq:0,codepoint:0},f={queue:0,queuedBits:0},_=y=>{kI(y,l,r)};for(let y=0;y<t.length;y+=1)OS(t.charCodeAt(y),f,_);return e.join("")}function TI(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function EI(t,e){for(let r=0;r<t.length;r+=1){let l=t.charCodeAt(r);if(l>55295&&l<=56319){const f=(l-55296)*1024&65535;l=(t.charCodeAt(r+1)-56320&65535|f)+65536,r+=1}TI(l,e)}}function kI(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let l=1;l<6;l+=1)if((t>>7-l&1)===0){e.utf8seq=l;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function cp(t){const e=[],r={queue:0,queuedBits:0},l=f=>{e.push(f)};for(let f=0;f<t.length;f+=1)OS(t.charCodeAt(f),r,l);return new Uint8Array(e)}function CI(t){const e=[];return EI(t,r=>e.push(r)),new Uint8Array(e)}function Zd(t){const e=[],r={queue:0,queuedBits:0},l=f=>{e.push(f)};return t.forEach(f=>W0(f,r,l)),W0(null,r,l),e.join("")}function AI(t){return Math.round(Date.now()/1e3)+t}function MI(){return Symbol("auth-callback")}const za=()=>typeof window<"u"&&typeof document<"u",$d={tested:!1,writable:!1},NS=()=>{if(!za())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if($d.tested)return $d.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),$d.tested=!0,$d.writable=!0}catch{$d.tested=!0,$d.writable=!1}return $d.writable};function PI(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((f,_)=>{e[_]=f})}catch{}return r.searchParams.forEach((l,f)=>{e[f]=l}),e}const BS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),jI=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Qf=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Ud=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},La=async(t,e)=>{await t.removeItem(e)};class f_{constructor(){this.promise=new f_.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}f_.promiseConstructor=Promise;function hv(t){const e=t.split(".");if(e.length!==3)throw new tx("Invalid JWT structure");for(let l=0;l<e.length;l++)if(!gI.test(e[l]))throw new tx("JWT not in base64url format");return{header:JSON.parse(Y0(e[0])),payload:JSON.parse(Y0(e[1])),signature:cp(e[2]),raw:{header:e[0],payload:e[1]}}}async function II(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function LI(t,e){return new Promise((l,f)=>{(async()=>{for(let _=0;_<1/0;_++)try{const y=await t(_);if(!e(_,null,y)){l(y);return}}catch(y){if(!e(_,y)){f(y);return}}})()})}function zI(t){return("0"+t.toString(16)).substr(-2)}function RI(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=r.length;let f="";for(let _=0;_<56;_++)f+=r.charAt(Math.floor(Math.random()*l));return f}return crypto.getRandomValues(e),Array.from(e,zI).join("")}async function DI(t){const r=new TextEncoder().encode(t),l=await crypto.subtle.digest("SHA-256",r),f=new Uint8Array(l);return Array.from(f).map(_=>String.fromCharCode(_)).join("")}async function OI(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await DI(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vf(t,e,r=!1){const l=RI();let f=l;r&&(f+="/PASSWORD_RECOVERY"),await Qf(t,`${e}-code-verifier`,f);const _=await OI(l);return[_,l===_?"plain":"s256"]}const NI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function BI(t){const e=t.headers.get(Qv);if(!e||!e.match(NI))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function $I(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function UI(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const FI=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qf(t){if(!FI.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dv(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function VI(t,e){return new Proxy(t,{get:(r,l,f)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const _=l.toString();if(_==="Symbol(Symbol.toPrimitive)"||_==="Symbol(Symbol.toStringTag)"||_==="Symbol(util.inspect.custom)"||_==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,l,f)}return!e.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,l,f)}})}function X0(t){return JSON.parse(JSON.stringify(t))}const Fd=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),qI=[502,503,504];async function K0(t){var e;if(!jI(t))throw new ex(Fd(t),0);if(qI.includes(t.status))throw new ex(Fd(t),t.status);let r;try{r=await t.json()}catch(_){throw new qd(Fd(_),_)}let l;const f=BI(t);if(f&&f.getTime()>=DS["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?l=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(l=r.error_code),l){if(l==="weak_password")throw new Z0(Fd(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(l==="session_not_found")throw new Al}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((_,y)=>_&&typeof y=="string",!0))throw new Z0(Fd(r),t.status,r.weak_password.reasons);throw new _I(Fd(r),t.status||500,l)}const HI=(t,e,r,l)=>{const f={method:t,headers:e?.headers||{}};return t==="GET"?f:(f.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),f.body=JSON.stringify(l),Object.assign(Object.assign({},f),r))};async function Ui(t,e,r,l){var f;const _=Object.assign({},l?.headers);_[Qv]||(_[Qv]=DS["2024-01-01"].name),l?.jwt&&(_.Authorization=`Bearer ${l.jwt}`);const y=(f=l?.query)!==null&&f!==void 0?f:{};l?.redirectTo&&(y.redirect_to=l.redirectTo);const d=Object.keys(y).length?"?"+new URLSearchParams(y).toString():"",A=await ZI(t,e,r+d,{headers:_,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(A):{data:Object.assign({},A),error:null}}async function ZI(t,e,r,l,f,_){const y=HI(e,l,f,_);let d;try{d=await t(r,Object.assign({},y))}catch(A){throw console.error(A),new ex(Fd(A),0)}if(d.ok||await K0(d),l?.noResolveJson)return d;try{return await d.json()}catch(A){await K0(A)}}function Ec(t){var e;let r=null;YI(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=AI(t.expires_in)));const l=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:l},error:null}}function J0(t){const e=Ec(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,l)=>r&&typeof l=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Vh(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function GI(t){return{data:t,error:null}}function WI(t){const{action_link:e,email_otp:r,hashed_token:l,redirect_to:f,verification_type:_}=t,y=Ku(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:r,hashed_token:l,redirect_to:f,verification_type:_},A=Object.assign({},y);return{data:{properties:d,user:A},error:null}}function Q0(t){return t}function YI(t){return t.access_token&&t.refresh_token&&t.expires_in}const fv=["global","local","others"];class XI{constructor({url:e="",headers:r={},fetch:l}){this.url=e,this.headers=r,this.fetch=BS(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=fv[0]){if(fv.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fv.join(", ")}`);try{return await Ui(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Pi(l))return{data:null,error:l};throw l}}async inviteUserByEmail(e,r={}){try{return await Ui(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Vh})}catch(l){if(Pi(l))return{data:{user:null},error:l};throw l}}async generateLink(e){try{const{options:r}=e,l=Ku(e,["options"]),f=Object.assign(Object.assign({},l),r);return"newEmail"in l&&(f.new_email=l?.newEmail,delete f.newEmail),await Ui(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:f,headers:this.headers,xform:WI,redirectTo:r?.redirectTo})}catch(r){if(Pi(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Ui(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Vh})}catch(r){if(Pi(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,l,f,_,y,d,A;try{const j={nextPage:null,lastPage:0,total:0},B=await Ui(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(_=(f=e?.perPage)===null||f===void 0?void 0:f.toString())!==null&&_!==void 0?_:""},xform:Q0});if(B.error)throw B.error;const N=await B.json(),V=(y=B.headers.get("x-total-count"))!==null&&y!==void 0?y:0,Q=(A=(d=B.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&A!==void 0?A:[];return Q.length>0&&(Q.forEach(ne=>{const J=parseInt(ne.split(";")[0].split("=")[1].substring(0,1)),ye=JSON.parse(ne.split(";")[1].split("=")[1]);j[`${ye}Page`]=J}),j.total=parseInt(V)),{data:Object.assign(Object.assign({},N),j),error:null}}catch(j){if(Pi(j))return{data:{users:[]},error:j};throw j}}async getUserById(e){qf(e);try{return await Ui(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Vh})}catch(r){if(Pi(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){qf(e);try{return await Ui(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Vh})}catch(l){if(Pi(l))return{data:{user:null},error:l};throw l}}async deleteUser(e,r=!1){qf(e);try{return await Ui(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Vh})}catch(l){if(Pi(l))return{data:{user:null},error:l};throw l}}async _listFactors(e){qf(e.userId);try{const{data:r,error:l}=await Ui(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:f=>({data:{factors:f},error:null})});return{data:r,error:l}}catch(r){if(Pi(r))return{data:null,error:r};throw r}}async _deleteFactor(e){qf(e.userId),qf(e.id);try{return{data:await Ui(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Pi(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,l,f,_,y,d,A;try{const j={nextPage:null,lastPage:0,total:0},B=await Ui(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(_=(f=e?.perPage)===null||f===void 0?void 0:f.toString())!==null&&_!==void 0?_:""},xform:Q0});if(B.error)throw B.error;const N=await B.json(),V=(y=B.headers.get("x-total-count"))!==null&&y!==void 0?y:0,Q=(A=(d=B.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&A!==void 0?A:[];return Q.length>0&&(Q.forEach(ne=>{const J=parseInt(ne.split(";")[0].split("=")[1].substring(0,1)),ye=JSON.parse(ne.split(";")[1].split("=")[1]);j[`${ye}Page`]=J}),j.total=parseInt(V)),{data:Object.assign(Object.assign({},N),j),error:null}}catch(j){if(Pi(j))return{data:{clients:[]},error:j};throw j}}async _createOAuthClient(e){try{return await Ui(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pi(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Ui(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pi(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Ui(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Pi(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(e){try{return await Ui(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Pi(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Ui(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pi(r))return{data:null,error:r};throw r}}}function ew(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Hf={debug:!!(globalThis&&NS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $S extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class KI extends $S{}async function JI(t,e,r){Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const l=new globalThis.AbortController;return e>0&&setTimeout(()=>{l.abort(),Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async f=>{if(f){Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,f.name);try{return await r()}finally{Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,f.name)}}else{if(e===0)throw Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new KI(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Hf.debug)try{const _=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(_,null,"  "))}catch(_){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",_)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function QI(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function US(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function eL(t){return parseInt(t,16)}function tL(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,l=>l.toString(16).padStart(2,"0")).join("")}function iL(t){var e;const{chainId:r,domain:l,expirationTime:f,issuedAt:_=new Date,nonce:y,notBefore:d,requestId:A,resources:j,scheme:B,uri:N,version:V}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(y&&y.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${y}`);if(!N)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(V!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${V}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const Q=US(t.address),ne=B?`${B}://${l}`:l,J=t.statement?`${t.statement}
`:"",ye=`${ne} wants you to sign in with your Ethereum account:
${Q}

${J}`;let re=`URI: ${N}
Version: ${V}
Chain ID: ${r}${y?`
Nonce: ${y}`:""}
Issued At: ${_.toISOString()}`;if(f&&(re+=`
Expiration Time: ${f.toISOString()}`),d&&(re+=`
Not Before: ${d.toISOString()}`),A&&(re+=`
Request ID: ${A}`),j){let ge=`
Resources:`;for(const le of j){if(!le||typeof le!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${le}`);ge+=`
- ${le}`}re+=ge}return`${ye}
${re}`}class $r extends Error{constructor({message:e,code:r,cause:l,name:f}){var _;super(e,{cause:l}),this.__isWebAuthnError=!0,this.name=(_=f??(l instanceof Error?l.name:void 0))!==null&&_!==void 0?_:"Unknown Error",this.code=r}}class Qy extends $r{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function nL({error:t,options:e}){var r,l,f;const{publicKey:_}=e;if(!_)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new $r({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=_.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new $r({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((l=_.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new $r({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((f=_.authenticatorSelection)===null||f===void 0?void 0:f.userVerification)==="required")return new $r({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new $r({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new $r({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return _.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new $r({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new $r({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const y=window.location.hostname;if(FS(y)){if(_.rp.id!==y)return new $r({message:`The RP ID "${_.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new $r({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(_.user.id.byteLength<1||_.user.id.byteLength>64)return new $r({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new $r({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new $r({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function sL({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new $r({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new $r({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(FS(l)){if(r.rpId!==l)return new $r({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new $r({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new $r({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new $r({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class rL{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const aL=new rL;function oL(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:l}=t,f=Ku(t,["challenge","user","excludeCredentials"]),_=cp(e).buffer,y=Object.assign(Object.assign({},r),{id:cp(r.id).buffer}),d=Object.assign(Object.assign({},f),{challenge:_,user:y});if(l&&l.length>0){d.excludeCredentials=new Array(l.length);for(let A=0;A<l.length;A++){const j=l[A];d.excludeCredentials[A]=Object.assign(Object.assign({},j),{id:cp(j.id).buffer,type:j.type||"public-key",transports:j.transports})}}return d}function lL(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,l=Ku(t,["challenge","allowCredentials"]),f=cp(e).buffer,_=Object.assign(Object.assign({},l),{challenge:f});if(r&&r.length>0){_.allowCredentials=new Array(r.length);for(let y=0;y<r.length;y++){const d=r[y];_.allowCredentials[y]=Object.assign(Object.assign({},d),{id:cp(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return _}function cL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Zd(new Uint8Array(t.response.attestationObject)),clientDataJSON:Zd(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function uL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,l=t.getClientExtensionResults(),f=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Zd(new Uint8Array(f.authenticatorData)),clientDataJSON:Zd(new Uint8Array(f.clientDataJSON)),signature:Zd(new Uint8Array(f.signature)),userHandle:f.userHandle?Zd(new Uint8Array(f.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function FS(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function tw(){var t,e;return!!(za()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function hL(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Qy("Browser returned unexpected credential type",e)}:{data:null,error:new Qy("Empty credential response",e)}}catch(e){return{data:null,error:nL({error:e,options:t})}}}async function dL(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Qy("Browser returned unexpected credential type",e)}:{data:null,error:new Qy("Empty credential response",e)}}catch(e){return{data:null,error:sL({error:e,options:t})}}}const fL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},pL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function e_(...t){const e=f=>f!==null&&typeof f=="object"&&!Array.isArray(f),r=f=>f instanceof ArrayBuffer||ArrayBuffer.isView(f),l={};for(const f of t)if(f)for(const _ in f){const y=f[_];if(y!==void 0)if(Array.isArray(y))l[_]=y;else if(r(y))l[_]=y;else if(e(y)){const d=l[_];e(d)?l[_]=e_(d,y):l[_]=e_(y)}else l[_]=y}return l}function mL(t,e){return e_(fL,t,e||{})}function gL(t,e){return e_(pL,t,e||{})}class yL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:l,signal:f},_){try{const{data:y,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!y)return{data:null,error:d};const A=f??aL.createNewAbortSignal();if(y.webauthn.type==="create"){const{user:j}=y.webauthn.credential_options.publicKey;j.name||(j.name=`${j.id}:${l}`),j.displayName||(j.displayName=j.name)}switch(y.webauthn.type){case"create":{const j=mL(y.webauthn.credential_options.publicKey,_?.create),{data:B,error:N}=await hL({publicKey:j,signal:A});return B?{data:{factorId:e,challengeId:y.id,webauthn:{type:y.webauthn.type,credential_response:B}},error:null}:{data:null,error:N}}case"request":{const j=gL(y.webauthn.credential_options.publicKey,_?.request),{data:B,error:N}=await dL(Object.assign(Object.assign({},y.webauthn.credential_options),{publicKey:j,signal:A}));return B?{data:{factorId:e,challengeId:y.id,webauthn:{type:y.webauthn.type,credential_response:B}},error:null}:{data:null,error:N}}}}catch(y){return Pi(y)?{data:null,error:y}:{data:null,error:new qd("Unexpected error in challenge",y)}}}async _verify({challengeId:e,factorId:r,webauthn:l}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:l})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:f}={}},_){if(!r)return{data:null,error:new Zm("rpId is required for WebAuthn authentication")};try{if(!tw())return{data:null,error:new qd("Browser does not support WebAuthn",null)};const{data:y,error:d}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:l},signal:f},{request:_});if(!y)return{data:null,error:d};const{webauthn:A}=y;return this._verify({factorId:e,challengeId:y.challengeId,webauthn:{type:A.type,rpId:r,rpOrigins:l,credential_response:A.credential_response}})}catch(y){return Pi(y)?{data:null,error:y}:{data:null,error:new qd("Unexpected error in authenticate",y)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:f}={}},_){if(!r)return{data:null,error:new Zm("rpId is required for WebAuthn registration")};try{if(!tw())return{data:null,error:new qd("Browser does not support WebAuthn",null)};const{data:y,error:d}=await this._enroll({friendlyName:e});if(!y)return await this.client.mfa.listFactors().then(B=>{var N;return(N=B.data)===null||N===void 0?void 0:N.all.find(V=>V.factor_type==="webauthn"&&V.friendly_name===e&&V.status!=="unverified")}).then(B=>B?this.client.mfa.unenroll({factorId:B?.id}):void 0),{data:null,error:d};const{data:A,error:j}=await this._challenge({factorId:y.id,friendlyName:y.friendly_name,webauthn:{rpId:r,rpOrigins:l},signal:f},{create:_});return A?this._verify({factorId:y.id,challengeId:A.challengeId,webauthn:{rpId:r,rpOrigins:l,type:A.webauthn.type,credential_response:A.webauthn.credential_response}}):{data:null,error:j}}catch(y){return Pi(y)?{data:null,error:y}:{data:null,error:new qd("Unexpected error in register",y)}}}}QI();const _L={url:fI,storageKey:pI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function iw(t,e,r){return await r()}const Zf={};class Gm{get jwks(){var e,r;return(r=(e=Zf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Zf[this.storageKey]=Object.assign(Object.assign({},Zf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Zf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Zf[this.storageKey]=Object.assign(Object.assign({},Zf[this.storageKey]),{cachedAt:e})}constructor(e){var r,l,f;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const _=Object.assign(Object.assign({},_L),e);if(this.storageKey=_.storageKey,this.instanceID=(r=Gm.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Gm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!_.debug,typeof _.debug=="function"&&(this.logger=_.debug),this.instanceID>0&&za()){const y=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(y),this.logDebugMessages&&console.trace(y)}if(this.persistSession=_.persistSession,this.autoRefreshToken=_.autoRefreshToken,this.admin=new XI({url:_.url,headers:_.headers,fetch:_.fetch}),this.url=_.url,this.headers=_.headers,this.fetch=BS(_.fetch),this.lock=_.lock||iw,this.detectSessionInUrl=_.detectSessionInUrl,this.flowType=_.flowType,this.hasCustomAuthorizationHeader=_.hasCustomAuthorizationHeader,this.throwOnError=_.throwOnError,this.lockAcquireTimeout=_.lockAcquireTimeout,_.lock?this.lock=_.lock:this.persistSession&&za()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=JI:this.lock=iw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new yL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(_.storage?this.storage=_.storage:NS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ew(this.memoryStorage)),_.userStorage&&(this.userStorage=_.userStorage)):(this.memoryStorage={},this.storage=ew(this.memoryStorage)),za()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(y){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",y)}(f=this.broadcastChannel)===null||f===void 0||f.addEventListener("message",async y=>{this._debug("received broadcast notification from other tab or client",y),await this._notifyAllSubscribers(y.data.event,y.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${RS}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},l="none";if(za()&&(r=PI(window.location.href),this._isImplicitGrantCallback(r)?l="implicit":await this._isPKCECallback(r)&&(l="pkce")),za()&&this.detectSessionInUrl&&l!=="none"){const{data:f,error:_}=await this._getSessionFromURL(r,l);if(_){if(this._debug("#_initialize()","error detecting session from URL",_),bI(_)){const A=(e=_.details)===null||e===void 0?void 0:e.code;if(A==="identity_already_exists"||A==="identity_not_found"||A==="single_identity_not_deletable")return{error:_}}return{error:_}}const{session:y,redirectType:d}=f;return this._debug("#_initialize()","detected session in URL",y,"redirect type",d),await this._saveSession(y),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",y):await this._notifyAllSubscribers("SIGNED_IN",y)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pi(r)?this._returnResult({error:r}):this._returnResult({error:new qd("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,l,f;try{const _=await Ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(f=e?.options)===null||f===void 0?void 0:f.captchaToken}},xform:Ec}),{data:y,error:d}=_;if(d||!y)return this._returnResult({data:{user:null,session:null},error:d});const A=y.session,j=y.user;return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",A)),this._returnResult({data:{user:j,session:A},error:null})}catch(_){if(Pi(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signUp(e){var r,l,f;try{let _;if("email"in e){const{email:B,password:N,options:V}=e;let Q=null,ne=null;this.flowType==="pkce"&&([Q,ne]=await Vf(this.storage,this.storageKey)),_=await Ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:V?.emailRedirectTo,body:{email:B,password:N,data:(r=V?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:V?.captchaToken},code_challenge:Q,code_challenge_method:ne},xform:Ec})}else if("phone"in e){const{phone:B,password:N,options:V}=e;_=await Ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:B,password:N,data:(l=V?.data)!==null&&l!==void 0?l:{},channel:(f=V?.channel)!==null&&f!==void 0?f:"sms",gotrue_meta_security:{captcha_token:V?.captchaToken}},xform:Ec})}else throw new _y("You must provide either an email or phone number and a password");const{data:y,error:d}=_;if(d||!y)return await La(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const A=y.session,j=y.user;return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",A)),this._returnResult({data:{user:j,session:A},error:null})}catch(_){if(await La(this.storage,`${this.storageKey}-code-verifier`),Pi(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithPassword(e){try{let r;if("email"in e){const{email:_,password:y,options:d}=e;r=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:_,password:y,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:J0})}else if("phone"in e){const{phone:_,password:y,options:d}=e;r=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:_,password:y,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:J0})}else throw new _y("You must provide either an email or phone number and a password");const{data:l,error:f}=r;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!l||!l.session||!l.user){const _=new Ff;return this._returnResult({data:{user:null,session:null},error:_})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:f})}catch(r){if(Pi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,l,f,_;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:(_=e.options)===null||_===void 0?void 0:_.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,l,f,_,y,d,A,j,B,N,V;let Q,ne;if("message"in e)Q=e.message,ne=e.signature;else{const{chain:J,wallet:ye,statement:re,options:ge}=e;let le;if(za())if(typeof ye=="object")le=ye;else{const Fe=window;if("ethereum"in Fe&&typeof Fe.ethereum=="object"&&"request"in Fe.ethereum&&typeof Fe.ethereum.request=="function")le=Fe.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof ye!="object"||!ge?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");le=ye}const me=new URL((r=ge?.url)!==null&&r!==void 0?r:window.location.href),be=await le.request({method:"eth_requestAccounts"}).then(Fe=>Fe).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!be||be.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ke=US(be[0]);let Me=(l=ge?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!Me){const Fe=await le.request({method:"eth_chainId"});Me=eL(Fe)}const Ue={domain:me.host,address:ke,statement:re,uri:me.href,version:"1",chainId:Me,nonce:(f=ge?.signInWithEthereum)===null||f===void 0?void 0:f.nonce,issuedAt:(y=(_=ge?.signInWithEthereum)===null||_===void 0?void 0:_.issuedAt)!==null&&y!==void 0?y:new Date,expirationTime:(d=ge?.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(A=ge?.signInWithEthereum)===null||A===void 0?void 0:A.notBefore,requestId:(j=ge?.signInWithEthereum)===null||j===void 0?void 0:j.requestId,resources:(B=ge?.signInWithEthereum)===null||B===void 0?void 0:B.resources};Q=iL(Ue),ne=await le.request({method:"personal_sign",params:[tL(Q),ke]})}try{const{data:J,error:ye}=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:Q,signature:ne},!((N=e.options)===null||N===void 0)&&N.captchaToken?{gotrue_meta_security:{captcha_token:(V=e.options)===null||V===void 0?void 0:V.captchaToken}}:null),xform:Ec});if(ye)throw ye;if(!J||!J.session||!J.user){const re=new Ff;return this._returnResult({data:{user:null,session:null},error:re})}return J.session&&(await this._saveSession(J.session),await this._notifyAllSubscribers("SIGNED_IN",J.session)),this._returnResult({data:Object.assign({},J),error:ye})}catch(J){if(Pi(J))return this._returnResult({data:{user:null,session:null},error:J});throw J}}async signInWithSolana(e){var r,l,f,_,y,d,A,j,B,N,V,Q;let ne,J;if("message"in e)ne=e.message,J=e.signature;else{const{chain:ye,wallet:re,statement:ge,options:le}=e;let me;if(za())if(typeof re=="object")me=re;else{const ke=window;if("solana"in ke&&typeof ke.solana=="object"&&("signIn"in ke.solana&&typeof ke.solana.signIn=="function"||"signMessage"in ke.solana&&typeof ke.solana.signMessage=="function"))me=ke.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof re!="object"||!le?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");me=re}const be=new URL((r=le?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in me&&me.signIn){const ke=await me.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},le?.signInWithSolana),{version:"1",domain:be.host,uri:be.href}),ge?{statement:ge}:null));let Me;if(Array.isArray(ke)&&ke[0]&&typeof ke[0]=="object")Me=ke[0];else if(ke&&typeof ke=="object"&&"signedMessage"in ke&&"signature"in ke)Me=ke;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Me&&"signature"in Me&&(typeof Me.signedMessage=="string"||Me.signedMessage instanceof Uint8Array)&&Me.signature instanceof Uint8Array)ne=typeof Me.signedMessage=="string"?Me.signedMessage:new TextDecoder().decode(Me.signedMessage),J=Me.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in me)||typeof me.signMessage!="function"||!("publicKey"in me)||typeof me!="object"||!me.publicKey||!("toBase58"in me.publicKey)||typeof me.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");ne=[`${be.host} wants you to sign in with your Solana account:`,me.publicKey.toBase58(),...ge?["",ge,""]:[""],"Version: 1",`URI: ${be.href}`,`Issued At: ${(f=(l=le?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date().toISOString()}`,...!((_=le?.signInWithSolana)===null||_===void 0)&&_.notBefore?[`Not Before: ${le.signInWithSolana.notBefore}`]:[],...!((y=le?.signInWithSolana)===null||y===void 0)&&y.expirationTime?[`Expiration Time: ${le.signInWithSolana.expirationTime}`]:[],...!((d=le?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${le.signInWithSolana.chainId}`]:[],...!((A=le?.signInWithSolana)===null||A===void 0)&&A.nonce?[`Nonce: ${le.signInWithSolana.nonce}`]:[],...!((j=le?.signInWithSolana)===null||j===void 0)&&j.requestId?[`Request ID: ${le.signInWithSolana.requestId}`]:[],...!((N=(B=le?.signInWithSolana)===null||B===void 0?void 0:B.resources)===null||N===void 0)&&N.length?["Resources",...le.signInWithSolana.resources.map(Me=>`- ${Me}`)]:[]].join(`
`);const ke=await me.signMessage(new TextEncoder().encode(ne),"utf8");if(!ke||!(ke instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");J=ke}}try{const{data:ye,error:re}=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:ne,signature:Zd(J)},!((V=e.options)===null||V===void 0)&&V.captchaToken?{gotrue_meta_security:{captcha_token:(Q=e.options)===null||Q===void 0?void 0:Q.captchaToken}}:null),xform:Ec});if(re)throw re;if(!ye||!ye.session||!ye.user){const ge=new Ff;return this._returnResult({data:{user:null,session:null},error:ge})}return ye.session&&(await this._saveSession(ye.session),await this._notifyAllSubscribers("SIGNED_IN",ye.session)),this._returnResult({data:Object.assign({},ye),error:re})}catch(ye){if(Pi(ye))return this._returnResult({data:{user:null,session:null},error:ye});throw ye}}async _exchangeCodeForSession(e){const r=await Ud(this.storage,`${this.storageKey}-code-verifier`),[l,f]=(r??"").split("/");try{if(!l&&this.flowType==="pkce")throw new wI;const{data:_,error:y}=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:l},xform:Ec});if(await La(this.storage,`${this.storageKey}-code-verifier`),y)throw y;if(!_||!_.session||!_.user){const d=new Ff;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign(Object.assign({},_),{redirectType:f??null}),error:y})}catch(_){if(await La(this.storage,`${this.storageKey}-code-verifier`),Pi(_))return this._returnResult({data:{user:null,session:null,redirectType:null},error:_});throw _}}async signInWithIdToken(e){try{const{options:r,provider:l,token:f,access_token:_,nonce:y}=e,d=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:f,access_token:_,nonce:y,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ec}),{data:A,error:j}=d;if(j)return this._returnResult({data:{user:null,session:null},error:j});if(!A||!A.session||!A.user){const B=new Ff;return this._returnResult({data:{user:null,session:null},error:B})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:A,error:j})}catch(r){if(Pi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,l,f,_,y;try{if("email"in e){const{email:d,options:A}=e;let j=null,B=null;this.flowType==="pkce"&&([j,B]=await Vf(this.storage,this.storageKey));const{error:N}=await Ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=A?.data)!==null&&r!==void 0?r:{},create_user:(l=A?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:A?.captchaToken},code_challenge:j,code_challenge_method:B},redirectTo:A?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:N})}if("phone"in e){const{phone:d,options:A}=e,{data:j,error:B}=await Ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(f=A?.data)!==null&&f!==void 0?f:{},create_user:(_=A?.shouldCreateUser)!==null&&_!==void 0?_:!0,gotrue_meta_security:{captcha_token:A?.captchaToken},channel:(y=A?.channel)!==null&&y!==void 0?y:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:j?.message_id},error:B})}throw new _y("You must provide either an email or phone number.")}catch(d){if(await La(this.storage,`${this.storageKey}-code-verifier`),Pi(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var r,l;try{let f,_;"options"in e&&(f=(r=e.options)===null||r===void 0?void 0:r.redirectTo,_=(l=e.options)===null||l===void 0?void 0:l.captchaToken);const{data:y,error:d}=await Ui(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:_}}),redirectTo:f,xform:Ec});if(d)throw d;if(!y)throw new Error("An error occurred on token verification.");const A=y.session,j=y.user;return A?.access_token&&(await this._saveSession(A),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",A)),this._returnResult({data:{user:j,session:A},error:null})}catch(f){if(Pi(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async signInWithSSO(e){var r,l,f,_,y;try{let d=null,A=null;this.flowType==="pkce"&&([d,A]=await Vf(this.storage,this.storageKey));const j=await Ui(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(l=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&l!==void 0?l:void 0}),!((f=e?.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:A}),headers:this.headers,xform:GI});return!((_=j.data)===null||_===void 0)&&_.url&&za()&&!(!((y=e.options)===null||y===void 0)&&y.skipBrowserRedirect)&&window.location.assign(j.data.url),this._returnResult(j)}catch(d){if(await La(this.storage,`${this.storageKey}-code-verifier`),Pi(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:l}=e;if(l)throw l;if(!r)throw new Al;const{error:f}=await Ui(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:f})})}catch(e){if(Pi(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:l,type:f,options:_}=e,{error:y}=await Ui(this.fetch,"POST",r,{headers:this.headers,body:{email:l,type:f,gotrue_meta_security:{captcha_token:_?.captchaToken}},redirectTo:_?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}else if("phone"in e){const{phone:l,type:f,options:_}=e,{data:y,error:d}=await Ui(this.fetch,"POST",r,{headers:this.headers,body:{phone:l,type:f,gotrue_meta_security:{captcha_token:_?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:y?.message_id},error:d})}throw new _y("You must provide either an email or phone number and a type")}catch(r){if(Pi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),f=(async()=>(await l,await r()))();return this.pendingInLock.push((async()=>{try{await f}catch{}})()),f}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=r();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const f=[...this.pendingInLock];await Promise.all(f),this.pendingInLock.splice(0,f.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Ud(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const l=e.expires_at?e.expires_at*1e3-Date.now()<cv:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",e.expires_at),!l){if(this.userStorage){const y=await Ud(this.userStorage,this.storageKey+"-user");y?.user?e.user=y.user:e.user=dv()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const y={value:this.suppressGetSessionWarning};e.user=VI(e.user,y),y.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:f,error:_}=await this._callRefreshToken(e.refresh_token);return _?this._returnResult({data:{session:null},error:_}):this._returnResult({data:{session:f},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await Ui(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Vh}):await this._useSession(async r=>{var l,f,_;const{data:y,error:d}=r;if(d)throw d;return!(!((l=y.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Al}:await Ui(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(_=(f=y.session)===null||f===void 0?void 0:f.access_token)!==null&&_!==void 0?_:void 0,xform:Vh})})}catch(r){if(Pi(r))return xI(r)&&(await this._removeSession(),await La(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async l=>{const{data:f,error:_}=l;if(_)throw _;if(!f.session)throw new Al;const y=f.session;let d=null,A=null;this.flowType==="pkce"&&e.email!=null&&([d,A]=await Vf(this.storage,this.storageKey));const{data:j,error:B}=await Ui(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:A}),jwt:y.access_token,xform:Vh});if(B)throw B;return y.user=j.user,await this._saveSession(y),await this._notifyAllSubscribers("USER_UPDATED",y),this._returnResult({data:{user:y.user},error:null})})}catch(l){if(await La(this.storage,`${this.storageKey}-code-verifier`),Pi(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Al;const r=Date.now()/1e3;let l=r,f=!0,_=null;const{payload:y}=hv(e.access_token);if(y.exp&&(l=y.exp,f=l<=r),f){const{data:d,error:A}=await this._callRefreshToken(e.refresh_token);if(A)return this._returnResult({data:{user:null,session:null},error:A});if(!d)return{data:{user:null,session:null},error:null};_=d}else{const{data:d,error:A}=await this._getUser(e.access_token);if(A)throw A;_={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:l-r,expires_at:l},await this._saveSession(_),await this._notifyAllSubscribers("SIGNED_IN",_)}return this._returnResult({data:{user:_.user,session:_},error:null})}catch(r){if(Pi(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var l;if(!e){const{data:y,error:d}=r;if(d)throw d;e=(l=y.session)!==null&&l!==void 0?l:void 0}if(!e?.refresh_token)throw new Al;const{data:f,error:_}=await this._callRefreshToken(e.refresh_token);return _?this._returnResult({data:{user:null,session:null},error:_}):f?this._returnResult({data:{user:f.user,session:f},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Pi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!za())throw new vy("No browser detected.");if(e.error||e.error_description||e.error_code)throw new vy(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new H0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new vy("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new H0("No code detected.");const{data:ge,error:le}=await this._exchangeCodeForSession(e.code);if(le)throw le;const me=new URL(window.location.href);return me.searchParams.delete("code"),window.history.replaceState(window.history.state,"",me.toString()),{data:{session:ge.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:f,access_token:_,refresh_token:y,expires_in:d,expires_at:A,token_type:j}=e;if(!_||!d||!y||!j)throw new vy("No session defined in URL");const B=Math.round(Date.now()/1e3),N=parseInt(d);let V=B+N;A&&(V=parseInt(A));const Q=V-B;Q*1e3<=Jf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${Q}s, should have been closer to ${N}s`);const ne=V-N;B-ne>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",ne,V,B):B-ne<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",ne,V,B);const{data:J,error:ye}=await this._getUser(_);if(ye)throw ye;const re={provider_token:l,provider_refresh_token:f,access_token:_,expires_in:N,expires_at:V,refresh_token:y,token_type:j,user:J.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:re,redirectType:e.type},error:null})}catch(l){if(Pi(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Ud(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var l;const{data:f,error:_}=r;if(_)return this._returnResult({error:_});const y=(l=f.session)===null||l===void 0?void 0:l.access_token;if(y){const{error:d}=await this.admin.signOut(y,e);if(d&&!(vI(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await La(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=MI(),l={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,l),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:l}}}async _emitInitialSession(e){return await this._useSession(async r=>{var l,f;try{const{data:{session:_},error:y}=r;if(y)throw y;await((l=this.stateChangeEmitters.get(e))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",_)),this._debug("INITIAL_SESSION","callback id",e,"session",_)}catch(_){await((f=this.stateChangeEmitters.get(e))===null||f===void 0?void 0:f.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",_),console.error(_)}})}async resetPasswordForEmail(e,r={}){let l=null,f=null;this.flowType==="pkce"&&([l,f]=await Vf(this.storage,this.storageKey,!0));try{return await Ui(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:l,code_challenge_method:f,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(_){if(await La(this.storage,`${this.storageKey}-code-verifier`),Pi(_))return this._returnResult({data:null,error:_});throw _}}async getUserIdentities(){var e;try{const{data:r,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:l,error:f}=await this._useSession(async _=>{var y,d,A,j,B;const{data:N,error:V}=_;if(V)throw V;const Q=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(y=e.options)===null||y===void 0?void 0:y.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(A=e.options)===null||A===void 0?void 0:A.queryParams,skipBrowserRedirect:!0});return await Ui(this.fetch,"GET",Q,{headers:this.headers,jwt:(B=(j=N.session)===null||j===void 0?void 0:j.access_token)!==null&&B!==void 0?B:void 0})});if(f)throw f;return za()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:e.provider,url:l?.url},error:null})}catch(l){if(Pi(l))return this._returnResult({data:{provider:e.provider,url:null},error:l});throw l}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var l;try{const{error:f,data:{session:_}}=r;if(f)throw f;const{options:y,provider:d,token:A,access_token:j,nonce:B}=e,N=await Ui(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=_?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:d,id_token:A,access_token:j,nonce:B,link_identity:!0,gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Ec}),{data:V,error:Q}=N;return Q?this._returnResult({data:{user:null,session:null},error:Q}):!V||!V.session||!V.user?this._returnResult({data:{user:null,session:null},error:new Ff}):(V.session&&(await this._saveSession(V.session),await this._notifyAllSubscribers("USER_UPDATED",V.session)),this._returnResult({data:V,error:Q}))}catch(f){if(await La(this.storage,`${this.storageKey}-code-verifier`),Pi(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var l,f;const{data:_,error:y}=r;if(y)throw y;return await Ui(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(f=(l=_.session)===null||l===void 0?void 0:l.access_token)!==null&&f!==void 0?f:void 0})})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const l=Date.now();return await LI(async f=>(f>0&&await II(200*Math.pow(2,f-1)),this._debug(r,"refreshing attempt",f),await Ui(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ec})),(f,_)=>{const y=200*Math.pow(2,f);return _&&uv(_)&&Date.now()+y-l<Jf})}catch(l){if(this._debug(r,"error",l),Pi(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const l=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",l),za()&&!r.skipBrowserRedirect&&window.location.assign(l),{data:{provider:e,url:l},error:null}}async _recoverAndRefresh(){var e,r;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const f=await Ud(this.storage,this.storageKey);if(f&&this.userStorage){let y=await Ud(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!y&&(y={user:f.user},await Qf(this.userStorage,this.storageKey+"-user",y)),f.user=(e=y?.user)!==null&&e!==void 0?e:dv()}else if(f&&!f.user&&!f.user){const y=await Ud(this.storage,this.storageKey+"-user");y&&y?.user?(f.user=y.user,await La(this.storage,this.storageKey+"-user"),await Qf(this.storage,this.storageKey,f)):f.user=dv()}if(this._debug(l,"session from storage",f),!this._isValidSession(f)){this._debug(l,"session is not valid"),f!==null&&await this._removeSession();return}const _=((r=f.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<cv;if(this._debug(l,`session has${_?"":" not"} expired with margin of ${cv}s`),_){if(this.autoRefreshToken&&f.refresh_token){const{error:y}=await this._callRefreshToken(f.refresh_token);y&&(console.error(y),uv(y)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",y),await this._removeSession()))}}else if(f.user&&f.user.__isUserNotAvailableProxy===!0)try{const{data:y,error:d}=await this._getUser(f.access_token);!d&&y?.user?(f.user=y.user,await this._saveSession(f),await this._notifyAllSubscribers("SIGNED_IN",f)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(y){console.error("Error getting user data:",y),this._debug(l,"error getting user data, skipping SIGNED_IN notification",y)}else await this._notifyAllSubscribers("SIGNED_IN",f)}catch(f){this._debug(l,"error",f),console.error(f);return}finally{this._debug(l,"end")}}async _callRefreshToken(e){var r,l;if(!e)throw new Al;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const f=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(f,"begin");try{this.refreshingDeferred=new f_;const{data:_,error:y}=await this._refreshAccessToken(e);if(y)throw y;if(!_.session)throw new Al;await this._saveSession(_.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",_.session);const d={data:_.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(_){if(this._debug(f,"error",_),Pi(_)){const y={data:null,error:_};return uv(_)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(y),y}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(_),_}finally{this.refreshingDeferred=null,this._debug(f,"end")}}async _notifyAllSubscribers(e,r,l=!0){const f=`#_notifyAllSubscribers(${e})`;this._debug(f,"begin",r,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:e,session:r});const _=[],y=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,r)}catch(A){_.push(A)}});if(await Promise.all(y),_.length>0){for(let d=0;d<_.length;d+=1)console.error(_[d]);throw _[0]}}finally{this._debug(f,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await La(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),l=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&r.user&&await Qf(this.userStorage,this.storageKey+"-user",{user:r.user});const f=Object.assign({},r);delete f.user;const _=X0(f);await Qf(this.storage,this.storageKey,_)}else{const f=X0(r);await Qf(this.storage,this.storageKey,f)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await La(this.storage,this.storageKey),await La(this.storage,this.storageKey+"-code-verifier"),await La(this.storage,this.storageKey+"-user"),this.userStorage&&await La(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&za()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Jf);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:l}}=r;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const f=Math.floor((l.expires_at*1e3-e)/Jf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${f} ticks, a tick lasts ${Jf}ms, refresh threshold is ${Jv} ticks`),f<=Jv&&await this._callRefreshToken(l.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof $S)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!za()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,l){const f=[`provider=${encodeURIComponent(r)}`];if(l?.redirectTo&&f.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&f.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[_,y]=await Vf(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(_)}`,code_challenge_method:`${encodeURIComponent(y)}`});f.push(d.toString())}if(l?.queryParams){const _=new URLSearchParams(l.queryParams);f.push(_.toString())}return l?.skipBrowserRedirect&&f.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${e}?${f.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var l;const{data:f,error:_}=r;return _?this._returnResult({data:null,error:_}):await Ui(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token})})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var l,f;const{data:_,error:y}=r;if(y)return this._returnResult({data:null,error:y});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:A,error:j}=await Ui(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(l=_?.session)===null||l===void 0?void 0:l.access_token});return j?this._returnResult({data:null,error:j}):(e.factorType==="totp"&&A.type==="totp"&&(!((f=A?.totp)===null||f===void 0)&&f.qr_code)&&(A.totp.qr_code=`data:image/svg+xml;utf-8,${A.totp.qr_code}`),this._returnResult({data:A,error:null}))})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var l;const{data:f,error:_}=r;if(_)return this._returnResult({data:null,error:_});const y=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?cL(e.webauthn.credential_response):uL(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:A}=await Ui(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:y,headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token});return A?this._returnResult({data:null,error:A}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:A}))})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var l;const{data:f,error:_}=r;if(_)return this._returnResult({data:null,error:_});const y=await Ui(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token});if(y.error)return y;const{data:d}=y;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:oL(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:lL(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:l}=await this._challenge({factorId:e.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:l}=await this.getUser();if(l)return{data:null,error:l};const f={all:[],phone:[],totp:[],webauthn:[]};for(const _ of(e=r?.factors)!==null&&e!==void 0?e:[])f.all.push(_),_.status==="verified"&&f[_.factor_type].push(_);return{data:f,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:l},error:f}=await this.getSession();if(f)return this._returnResult({data:null,error:f});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:_}=hv(l.access_token);let y=null;_.aal&&(y=_.aal);let d=y;((r=(e=l.user.factors)===null||e===void 0?void 0:e.filter(B=>B.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const j=_.amr||[];return{data:{currentLevel:y,nextLevel:d,currentAuthenticationMethods:j},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:l},error:f}=r;return f?this._returnResult({data:null,error:f}):l?await Ui(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:l.access_token,xform:_=>({data:_,error:null})}):this._returnResult({data:null,error:new Al})})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async l=>{const{data:{session:f},error:_}=l;if(_)return this._returnResult({data:null,error:_});if(!f)return this._returnResult({data:null,error:new Al});const y=await Ui(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:f.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return y.data&&y.data.redirect_url&&za()&&!r?.skipBrowserRedirect&&window.location.assign(y.data.redirect_url),y})}catch(l){if(Pi(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(e,r){try{return await this._useSession(async l=>{const{data:{session:f},error:_}=l;if(_)return this._returnResult({data:null,error:_});if(!f)return this._returnResult({data:null,error:new Al});const y=await Ui(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:f.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return y.data&&y.data.redirect_url&&za()&&!r?.skipBrowserRedirect&&window.location.assign(y.data.redirect_url),y})}catch(l){if(Pi(l))return this._returnResult({data:null,error:l});throw l}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:l}=e;return l?this._returnResult({data:null,error:l}):r?await Ui(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:f=>({data:f,error:null})}):this._returnResult({data:null,error:new Al})})}catch(e){if(Pi(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:l},error:f}=r;return f?this._returnResult({data:null,error:f}):l?(await Ui(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:l.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Al})})}catch(r){if(Pi(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let l=r.keys.find(d=>d.kid===e);if(l)return l;const f=Date.now();if(l=this.jwks.keys.find(d=>d.kid===e),l&&this.jwks_cached_at+yI>f)return l;const{data:_,error:y}=await Ui(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(y)throw y;return!_.keys||_.keys.length===0||(this.jwks=_,this.jwks_cached_at=f,l=_.keys.find(d=>d.kid===e),!l)?null:l}async getClaims(e,r={}){try{let l=e;if(!l){const{data:Q,error:ne}=await this.getSession();if(ne||!Q.session)return this._returnResult({data:null,error:ne});l=Q.session.access_token}const{header:f,payload:_,signature:y,raw:{header:d,payload:A}}=hv(l);r?.allowExpired||$I(_.exp);const j=!f.alg||f.alg.startsWith("HS")||!f.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(f.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!j){const{error:Q}=await this.getUser(l);if(Q)throw Q;return{data:{claims:_,header:f,signature:y},error:null}}const B=UI(f.alg),N=await crypto.subtle.importKey("jwk",j,B,!0,["verify"]);if(!await crypto.subtle.verify(B,N,y,CI(`${d}.${A}`)))throw new tx("Invalid JWT signature");return{data:{claims:_,header:f,signature:y},error:null}}catch(l){if(Pi(l))return this._returnResult({data:null,error:l});throw l}}}Gm.nextInstanceID={};const vL=Gm,xL="2.90.1";let km="";typeof Deno<"u"?km="deno":typeof document<"u"?km="web":typeof navigator<"u"&&navigator.product==="ReactNative"?km="react-native":km="node";const bL={"X-Client-Info":`supabase-js-${km}/${xL}`},wL={headers:bL},SL={schema:"public"},TL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},EL={};function Wm(t){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wm(t)}function kL(t,e){if(Wm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var l=r.call(t,e);if(Wm(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CL(t){var e=kL(t,"string");return Wm(e)=="symbol"?e:e+""}function AL(t,e,r){return(e=CL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),r.push.apply(r,l)}return r}function mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nw(Object(r),!0).forEach(function(l){AL(t,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nw(Object(r)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(r,l))})}return t}const ML=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),PL=()=>Headers,jL=(t,e,r)=>{const l=ML(r),f=PL();return async(_,y)=>{var d;const A=(d=await e())!==null&&d!==void 0?d:t;let j=new f(y?.headers);return j.has("apikey")||j.set("apikey",t),j.has("Authorization")||j.set("Authorization",`Bearer ${A}`),l(_,mr(mr({},y),{},{headers:j}))}};function IL(t){return t.endsWith("/")?t:t+"/"}function LL(t,e){var r,l;const{db:f,auth:_,realtime:y,global:d}=t,{db:A,auth:j,realtime:B,global:N}=e,V={db:mr(mr({},A),f),auth:mr(mr({},j),_),realtime:mr(mr({},B),y),storage:{},global:mr(mr(mr({},N),d),{},{headers:mr(mr({},(r=N?.headers)!==null&&r!==void 0?r:{}),(l=d?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return t.accessToken?V.accessToken=t.accessToken:delete V.accessToken,V}function zL(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(IL(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var RL=class extends vL{constructor(t){super(t)}},DL=class{constructor(t,e,r){var l,f;this.supabaseUrl=t,this.supabaseKey=e;const _=zL(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",_),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",_),this.storageUrl=new URL("storage/v1",_),this.functionsUrl=new URL("functions/v1",_);const y=`sb-${_.hostname.split(".")[0]}-auth-token`,d={db:SL,realtime:EL,auth:mr(mr({},TL),{},{storageKey:y}),global:wL},A=LL(r??{},d);if(this.storageKey=(l=A.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(f=A.global.headers)!==null&&f!==void 0?f:{},A.accessToken)this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(B,N)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(N)} is not possible`)}});else{var j;this.auth=this._initSupabaseAuthClient((j=A.auth)!==null&&j!==void 0?j:{},this.headers,A.global.fetch)}this.fetch=jL(e,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(mr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.accessToken&&this.accessToken().then(B=>this.realtime.setAuth(B)).catch(B=>console.warn("Failed to set initial Realtime auth token:",B)),this.rest=new mj(new URL("rest/v1",_).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new dI(this.storageUrl.href,this.headers,this.fetch,r?.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new uj(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:l}=await t.auth.getSession();return(e=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:l,userStorage:f,storageKey:_,flowType:y,lock:d,debug:A,throwOnError:j},B,N){const V={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new RL({url:this.authUrl.href,headers:mr(mr({},V),B),storageKey:_,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:l,userStorage:f,flowType:y,lock:d,debug:A,throwOnError:j,fetch:N,hasCustomAuthorizationHeader:Object.keys(this.headers).some(Q=>Q.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Ij(this.realtimeUrl.href,mr(mr({},t),{},{params:mr(mr({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const OL=(t,e,r)=>new DL(t,e,r);function NL(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}NL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const BL={DEV:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFlc2Nva2xrZHllaHlmcHNxbnRyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1Njk4MTEsImV4cCI6MjA4MDE0NTgxMX0.9rWg2urAfOCc3qZs7_yXNPjRjCm9WP7bcD1qQ20CxFM",VITE_SUPABASE_URL:"https://aescoklkdyehyfpsqntr.supabase.co"},Ym=BL||{},t_=Ym.VITE_SUPABASE_URL||Ym.NEXT_PUBLIC_SUPABASE_URL||"",Lm=Ym.VITE_SUPABASE_ANON_KEY||Ym.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",p_=!!Ym.DEV,$L=!!(t_&&Lm),UL=async(...t)=>{if(p_){const e=t[0],r=typeof e=="string"?e:e instanceof URL?e.toString():e.url;console.info("[supabase] request",r)}return fetch(...t)},FL=async(t,e,r)=>r(),Rt=OL(t_,Lm,{global:{fetch:p_?UL:fetch},auth:{lock:FL}});if(p_){let t="missing";if(t_)try{t=new URL(t_).host}catch{t="invalid-url"}const e=Lm?`${Lm.slice(0,6)}...${Lm.slice(-4)}`:"missing";console.info("[supabase] config",{host:t,key:e,isConfigured:$L})}p_&&(window.supabase=Rt);const Gd=new Map,Yd=new Map,yr=async(t,e,r)=>{const l=r?.ttlMs??15e3,f=Date.now(),_=Yd.get(t);if(_&&_.expiresAt>f)return _.value;const y=Gd.get(t);if(y)return y;const d=e().then(A=>(Gd.delete(t),Yd.set(t,{value:A,expiresAt:f+l}),A)).catch(A=>{throw Gd.delete(t),Yd.delete(t),A});return Gd.set(t,d),d},ix=(t,e,r)=>{const l=r?.ttlMs??15e3;Yd.set(t,{value:e,expiresAt:Date.now()+l})},VS=t=>{if(!t){Gd.clear(),Yd.clear();return}for(const e of Array.from(Gd.keys()))e.startsWith(t)&&Gd.delete(e);for(const e of Array.from(Yd.keys()))e.startsWith(t)&&Yd.delete(e)},qS=ie.createContext(void 0),va=()=>{const t=ie.useContext(qS);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},VL=({children:t})=>{const[e,r]=ie.useState({user:null,profile:null,loading:!0}),l=!1,f=ie.useRef(null),_=ie.useRef(null),y=async(J,ye,re)=>{if(re&&!(f.current===J&&e.profile&&!e.loading)&&_.current!==J){_.current=J,r(ge=>({...ge,user:ye,loading:!0}));try{const ge=`profiles:${J}`,le=await yr(ge,async()=>{const{data:Ue,error:Fe}=await Rt.from("profiles").select("*").eq("id",J).maybeSingle();if(Fe)throw Fe;return Ue},{ttlMs:3e4});if(!re||_.current!==J)return;let me=le;if(!me){const Ue=ye.user_metadata??{},{data:Fe,error:He}=await Rt.from("profiles").insert({id:J,username:Ue.username??null,display_name:Ue.display_name??Ue.displayName??null,primary_city:Ue.primary_city??Ue.primaryCity??null}).select("*").single();if(He)throw He;me=Fe,ix(ge,Fe,{ttlMs:3e4})}const be=`subject:user:${J}`,ke=await yr(be,async()=>{const{data:Ue,error:Fe}=await Rt.rpc("get_or_create_user_subject",{p_profile_id:J});if(Fe)throw Fe;return Ue},{ttlMs:1440*60*1e3});if(!re||_.current!==J)return;const Me=me?{...me,subject_id:ke}:null;f.current=J,r({user:ye,profile:Me??null,loading:!1})}catch(ge){console.error("[auth] failed to load profile",ge),re&&r(le=>({...le,loading:!1}))}finally{_.current===J&&(_.current=null)}}};ie.useEffect(()=>{let J=!0,ye=null;return(async()=>{const{data:{session:ge}}=await Rt.auth.getSession();J&&(ge?.user?await y(ge.user.id,ge.user,J):r({user:null,profile:null,loading:!1}));const{data:le}=Rt.auth.onAuthStateChange(async(me,be)=>{J&&(me==="SIGNED_IN"||me==="TOKEN_REFRESHED"||me==="USER_UPDATED"?be?.user&&await y(be.user.id,be.user,J):me==="SIGNED_OUT"&&(f.current=null,r({user:null,profile:null,loading:!1})))});ye=le})(),()=>{J=!1,ye&&ye.subscription.unsubscribe()}},[]),ie.useEffect(()=>{const J=()=>{document.visibilityState==="visible"&&Q().catch(()=>{})};return window.addEventListener("focus",J),document.addEventListener("visibilitychange",J),()=>{window.removeEventListener("focus",J),document.removeEventListener("visibilitychange",J)}},[e.user]);const d=async(J,ye)=>{const{error:re}=await Rt.auth.signInWithPassword({email:J,password:ye});return{error:re}},A=async(J,ye,re)=>{const{error:ge}=await Rt.auth.signUp({email:J,password:ye,options:{data:{username:re.username||null,display_name:re.displayName||null,primary_city:re.primaryCity||null}}});return{error:ge}},j=async J=>{const{error:ye}=await Rt.auth.resetPasswordForEmail(J,{redirectTo:`${window.location.origin}/reset`});return{error:ye}},B=async J=>{const{error:ye}=await Rt.auth.updateUser({password:J});return{error:ye}},N=async()=>{try{const{error:J}=await Rt.auth.signOut();J&&await Rt.auth.signOut({scope:"local"})}finally{f.current=null,r({user:null,profile:null,loading:!1})}},V=async J=>{if(!e.user)return{error:{message:"No user logged in"}};const{role:ye,...re}=J,ge={id:e.user.id,...re};l&&ye&&(ge.role=ye);const{data:le,error:me}=await Rt.from("profiles").upsert(ge,{onConflict:"id"}).select("*").single();return!me&&le&&r(be=>({...be,profile:le})),{error:me}},Q=async()=>{if(!e.user)return;const{data:J}=await Rt.from("profiles").select("*").eq("id",e.user.id).single();J&&r(ye=>({...ye,profile:J}))},ne={...e,signIn:d,signUp:A,sendPasswordReset:j,updatePassword:B,signOut:N,updateProfile:V,refreshProfile:Q};return S.jsx(qS.Provider,{value:ne,children:t})},Cm={async getManagedEntities(t){const e=await yr(`subject:user:${t}`,async()=>{const{data:f,error:_}=await Rt.rpc("get_or_create_user_subject",{p_profile_id:t});if(_)throw _;return f},{ttlMs:864e5}),{data:r,error:l}=await Rt.from("entity_members").select(`
        admin_subject_id,
        entity_subject_id,
        role,
        subjects:entity_subject_id (
          id,
          type
        )
      `).eq("admin_subject_id",e);if(l)throw l;return Promise.all(r.map(async f=>{const _=f.subjects.type,y={subject_id:f.entity_subject_id,role:f.role,type:_};if(_==="artist"){const d=await yr(`v_subject_artists:by_subject:${f.entity_subject_id}`,async()=>{const{data:A,error:j}=await Rt.from("v_subject_artists").select("*").eq("subject_id",f.entity_subject_id).maybeSingle();if(j)throw j;return A},{ttlMs:6e4});d&&(y.artist={...d,id:d.artist_id??d.id})}else if(_==="venue"){const d=await yr(`v_subject_venues:by_subject:${f.entity_subject_id}`,async()=>{const{data:A,error:j}=await Rt.from("v_subject_venues").select("*").eq("subject_id",f.entity_subject_id).maybeSingle();if(j)throw j;return A},{ttlMs:6e4});d&&(y.venue={...d,id:d.venue_place_id??d.id})}return y}))},async adminGrantEntityAccess(t,e,r,l="admin"){const{error:f}=await Rt.rpc("admin_grant_entity_access",{p_target_profile_id:t,p_entity_type:e,p_entity_id:r,p_role:l});if(f)throw f},async removeMember(t,e){const{error:r}=await Rt.from("entity_members").delete().match({admin_subject_id:t,entity_subject_id:e});if(r)throw r},async searchProfiles(t){const{data:e,error:r}=await Rt.from("profiles").select("id, username, display_name, avatar_url").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(10);if(r)throw r;return e},async searchArtists(t){const{data:e,error:r}=await Rt.from("artists").select("id, name, artist_type, city, avatar_url").ilike("name",`%${t}%`).order("name",{ascending:!0}).limit(10);if(r)throw r;return e?.map(l=>({...l,image_url:l.avatar_url??null}))},async searchVenues(t){const{data:e,error:r}=await Rt.from("venue_places").select("id, name, city, photos, venue_type").or(`name.ilike.%${t}%,city.ilike.%${t}%`).order("name",{ascending:!0}).limit(10);if(r)throw r;return e?.map(l=>({...l,image_url:l.photos?.[0]??null}))}},HS=ie.createContext(void 0),qL="live_space.workspace.",HL=({children:t})=>{const{profile:e}=va(),[r,l]=ie.useState([]),[f,_]=ie.useState(null),[y,d]=ie.useState(!0),[A,j]=ie.useState(null),B=e?.id?`${qL}${e.id}`:null,N=ge=>{if(!(!B||typeof window>"u"))try{ge?.subject_id?window.localStorage.setItem(B,ge.subject_id):window.localStorage.removeItem(B)}catch{}},V=ge=>{console.log("[workspace] setActiveWorkspace ->",ge),_(ge),N(ge)},Q=()=>{if(!B||typeof window>"u")return null;try{return window.localStorage.getItem(B)}catch{return null}},ne=async()=>{if(!e?.id){l([]),V(null),d(!1),j(null);return}try{d(!0);const ge=await Cm.getManagedEntities(e.id);if(console.log("[workspace] fetched entities",ge),l(ge),f)ge.find(me=>me.subject_id===f.subject_id)||V(null);else{const le=Q();if(le){const me=ge.find(be=>be.subject_id===le);me&&(console.log("[workspace] restoring stored workspace",le),_(me))}}}catch(ge){console.error("Error fetching managed entities:",ge)}finally{d(!1),j(e.id)}};ie.useEffect(()=>{ne()},[e?.id]),ie.useEffect(()=>{const ge=()=>{document.visibilityState==="visible"&&e?.id&&ne().catch(()=>{})};return window.addEventListener("focus",ge),document.addEventListener("visibilitychange",ge),()=>{window.removeEventListener("focus",ge),document.removeEventListener("visibilitychange",ge)}},[e?.id]);const J=f!==null,ye=f!==null&&["owner","admin","editor"].includes(f.role),re=!!(e?.id&&A===e.id);return S.jsx(HS.Provider,{value:{managedEntities:r,activeWorkspace:f,setActiveWorkspace:V,loading:y,ready:re,refreshWorkspaces:ne,isActingAsEntity:J,canCreateEvent:ye},children:t})},sf=()=>{const t=ie.useContext(HS);if(t===void 0)throw new Error("useWorkspace must be used within a WorkspaceProvider");return t},ZL=()=>S.jsxs("div",{className:"inline-flex items-center gap-2",children:[S.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-[10px] bg-white/10 text-[11px] font-bold uppercase tracking-[0.2em] text-white","aria-hidden":"true",children:"LS"}),S.jsx("span",{className:"font-display text-sm font-semibold uppercase tracking-[0.2em] text-white/90",children:"Live Space"})]}),GL=()=>{const{managedEntities:t,activeWorkspace:e,setActiveWorkspace:r}=sf(),[l,f]=ie.useState(!1),_=Ur(),y=d=>{console.log("[workspace-switcher] selecting",d),r(d?{...d,artist:d.artist?{...d.artist,id:d.artist.id??d.artist.artist_id}:void 0,venue:d.venue?{...d.venue,id:d.venue.id??d.venue.venue_place_id}:void 0}:null),f(!1),d?.type==="artist"&&d.artist?.id?_.replace(`/tabs/artist/${d.artist.id}`):d?.type==="venue"&&d.venue?.id?_.replace(`/tabs/venue/${d.venue.id}`):_.replace("/tabs/profile")};return t.length===0?null:S.jsxs("div",{className:"relative",children:[S.jsxs("button",{onClick:()=>f(!l),className:"flex items-center gap-2 px-2 py-1 text-white/80 transition-colors hover:text-white",children:[S.jsx("div",{className:"flex h-5 w-5 items-center justify-center text-white/70",children:e?S.jsx(z0,{size:12}):S.jsx(My,{size:12})}),S.jsx("span",{className:"max-w-[120px] truncate text-xs font-medium text-white/80",children:e?e.artist?.name||e.venue?.name||"Workspace":"Personal Profile"}),l?S.jsx(aj,{size:14,className:"text-white/50"}):S.jsx(rj,{size:14,className:"text-white/50"})]}),l&&S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>f(!1)}),S.jsxs("div",{className:"absolute right-0 top-full z-40 mt-2 w-64 overflow-hidden rounded-xl bg-black/95",children:[S.jsx("div",{className:"px-4 pb-2 pt-4 text-[10px] font-semibold uppercase tracking-[0.24em] text-white/40",children:"Personal"}),S.jsxs("button",{onClick:()=>y(null),className:`flex w-full items-center gap-3 px-4 py-3 text-left transition-colors hover:bg-white/5 ${e?"text-white/80":"text-white"}`,children:[S.jsx("div",{className:"flex h-8 w-8 items-center justify-center bg-white/10 text-white/80",children:S.jsx(My,{size:16})}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("div",{className:"truncate text-sm font-medium",children:"Personal Profile"}),S.jsx("div",{className:"text-[10px] text-white/50",children:"Viewing as yourself"})]})]}),S.jsx("div",{className:"px-4 pb-2 pt-4 text-[10px] font-semibold uppercase tracking-[0.24em] text-white/40",children:"Workspaces"}),S.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.map(d=>S.jsxs("button",{onClick:()=>y(d),className:`flex w-full items-center gap-3 px-4 py-3 text-left transition-colors hover:bg-white/5 ${e?.subject_id===d.subject_id?"text-white":"text-white/80"}`,children:[S.jsx("div",{className:"relative",children:d.type==="artist"?d.artist?.avatar_url?S.jsx("img",{src:d.artist.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-white/10 text-white/70",children:S.jsx(My,{size:16})}):d.venue?.photos?.[0]?S.jsx("img",{src:d.venue.photos[0],alt:"",className:"h-8 w-8 rounded object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded bg-white/10 text-white/70",children:S.jsx(z0,{size:16})})}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("div",{className:"truncate text-sm font-medium",children:d.type==="artist"?d.artist?.name:d.venue?.name}),S.jsx("div",{className:"text-[10px] uppercase tracking-[0.22em] text-white/45",children:d.role})]})]},d.subject_id))})]})]})]})},ao=({title:t,rightSlot:e,showBack:r})=>{const l=Ur(),f=mp(),{activeWorkspace:_}=sf(),y=r??!["/tabs/feed","/tabs/events","/tabs/map","/tabs/upload","/tabs/profile"].includes(f.pathname),d=()=>{l.push("/")},A=()=>{l.goBack()};return S.jsx("header",{className:"sticky top-0 z-20 bg-app-bg px-4 py-3 pt-[calc(12px+env(safe-area-inset-top,0px))]",children:S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[y?S.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-3 py-2 text-sm font-semibold text-white/80 disabled:cursor-not-allowed disabled:opacity-60",onClick:A,"aria-label":"Go back",children:S.jsx(sj,{className:"h-4 w-4"})}):null,t?S.jsx("h1",{className:"text-lg font-bold text-app-light",children:t}):S.jsx("button",{type:"button",className:"flex items-center",onClick:d,"aria-label":"Go to home",children:S.jsx(ZL,{})})]}),S.jsxs("div",{className:"inline-flex items-center gap-2",children:[S.jsx(GL,{}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-3 py-2 text-sm font-semibold text-white/80 disabled:cursor-not-allowed disabled:opacity-60","aria-label":"Notifications",disabled:!0,children:S.jsx(nj,{className:"h-4 w-4"})}),e]})]})})},WL=()=>{const[t,e]=ie.useState(!1),[r,l]=ie.useState(""),[f,_]=ie.useState(""),[y,d]=ie.useState(""),[A,j]=ie.useState(""),[B,N]=ie.useState(""),[V,Q]=ie.useState(!1),[ne,J]=ie.useState(""),[ye,re]=ie.useState(!1),[ge,le]=ie.useState(""),[me,be]=ie.useState(!1),ke=Ur(),{signIn:Me,signUp:Ue,sendPasswordReset:Fe}=va(),He=async()=>{Q(!0),J("");try{if(!r||!f||t&&!y){J("Please fill in all required fields");return}if(t){const{error:Ye}=await Ue(r,f,{username:y,displayName:A,primaryCity:B});if(Ye){J(Ye.message);return}}else{const{error:Ye}=await Me(r,f);if(Ye){J(Ye.message);return}}ke.replace("/tabs/events")}catch{J("An unexpected error occurred")}finally{Q(!1)}},lt=async()=>{Q(!0),J(""),be(!1);try{const Ye=ge||r;if(!Ye){J("Enter your email to reset password");return}const{error:Mt}=await Fe(Ye);if(Mt){J(Mt.message);return}be(!0)}catch{J("Could not send reset email")}finally{Q(!1)}};return S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsx("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:S.jsxs("div",{className:"relative min-h-full",children:[S.jsxs("div",{className:"mx-auto max-w-md text-center",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"Your concert archive"}),S.jsx("h1",{className:"mt-4 font-display text-4xl font-bold leading-tight text-white",children:"Live Space"}),S.jsx("p",{className:"mt-3 text-sm text-white/70",children:"Keep what happened last night  and relive it when you want."})]}),S.jsxs("div",{className:"mt-8 space-y-4 rounded-2xl bg-white/5 p-5",children:[S.jsx("h2",{className:"font-display text-base font-semibold text-white",children:t?"Create Account":"Sign In"}),S.jsxs("div",{className:"space-y-3",children:[t&&S.jsxs(S.Fragment,{children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{value:y,onChange:Ye=>d(Ye.target.value),placeholder:"Choose a username",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Display name"}),S.jsx("input",{value:A,onChange:Ye=>j(Ye.target.value),placeholder:"How should we call you?",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Primary city"}),S.jsx("input",{value:B,onChange:Ye=>N(Ye.target.value),placeholder:"Barcelona",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Email"}),S.jsx("input",{type:"email",value:r,onChange:Ye=>l(Ye.target.value),placeholder:"your@email.com",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Password"}),S.jsx("input",{type:"password",value:f,onChange:Ye=>_(Ye.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),ne&&S.jsx("p",{className:"text-sm text-rose-400",children:ne}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:He,disabled:V||!r||!f||t&&!y,children:V?S.jsxs("span",{className:"flex items-center gap-2",children:[S.jsx(Ys,{name:"crescent"}),"Loading..."]}):t?"Sign Up":"Sign In"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>e(!t),children:t?"Already have an account? Sign In":"Don't have an account? Sign Up"}),!t&&S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>re(Ye=>!Ye),children:"Forgot your password?"}),ye&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Reset email"}),S.jsx("input",{type:"email",value:ge||r,onChange:Ye=>le(Ye.target.value),placeholder:"you@email.com",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:lt,disabled:V,children:"Send reset link"}),me&&S.jsx("p",{className:"text-sm text-emerald-400",children:"Check your inbox for the reset link."})]})]})]})})]})})})},pv=6,YL=()=>{const{profile:t}=va(),[e,r]=ie.useState([]),[l,f]=ie.useState(0),[_,y]=ie.useState(!0),[d,A]=ie.useState(!1),[j,B]=ie.useState(""),[N,V]=ie.useState(!0),Q=ie.useRef(null),ne=Ur(),J=async(re,ge=!1)=>{const le=re*pv,me=le+pv-1,{data:be,error:ke}=await Rt.from("posts").select(`
        id,
        user_id,
        event_id,
        media_url,
        media_type,
        thumbnail_url,
        caption,
        created_at,
        profiles:profiles!posts_user_id_fkey (
          id,
          username,
          display_name,
          avatar_url
        ),
        events:events!posts_event_id_fkey (
          id,
          name,
          city,
          starts_at,
          cover_image_url
        )
        `).order("created_at",{ascending:!1}).range(le,me);if(ke)throw ke;be&&(r(Me=>ge?be:[...Me,...be]),V(be.length===pv))};ie.useEffect(()=>{(async()=>{y(!0),B("");try{await J(0,!0)}catch{V(!1),B("Could not load the feed. Check your Supabase connection.")}finally{y(!1)}})()},[]),ie.useEffect(()=>{!_&&e.length===0&&(B(""),V(!0),f(0),J(0,!0).catch(()=>{V(!1),B("Could not load the feed. Check your Supabase connection.")}))},[_,e.length]);const ye=async()=>{if(d||!N)return;const re=l+1;A(!0);try{await J(re),f(re)}catch{V(!1),B("Could not load more posts.")}finally{A(!1)}};return ie.useEffect(()=>{if(!N||_||d)return;const re=Q.current;if(!re)return;const ge=new IntersectionObserver(le=>{le[0].isIntersecting&&ye()},{rootMargin:"200px"});return ge.observe(re),()=>ge.disconnect()},[N,_,d,l]),S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("header",{className:"space-y-2",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:t?.primary_city?`Tonight in ${t.primary_city}`:"Tonight"}),S.jsx("p",{className:"text-sm text-white/55",children:"Relive what people lived."})]}),_?S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})}):S.jsxs("div",{className:"space-y-4",children:[j&&S.jsx("p",{className:"text-sm text-rose-400",children:j}),e.map(re=>{const ge=re.profiles?.username?`@${re.profiles.username}`:re.profiles?.display_name||"Anonymous",le=re.caption||re.events?.name||"Relive the moment",me=`${re.events?.city||"Unknown"}  ${new Date(re.created_at).toLocaleDateString()}`,be=re.thumbnail_url||re.events?.cover_image_url||null;return S.jsx("button",{type:"button",className:"-mx-4 block w-[calc(100%+2rem)] text-left",onClick:()=>ne.push(`/post/${re.id}`),children:S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[re.media_type==="image"?S.jsx("img",{src:re.media_url,alt:le,className:"absolute inset-0 h-full w-full object-cover"}):be?S.jsx("img",{src:be,alt:le,className:"absolute inset-0 h-full w-full object-cover"}):S.jsx("video",{muted:!0,playsInline:!0,preload:"metadata",className:"absolute inset-0 h-full w-full object-cover",children:S.jsx("source",{src:re.media_url})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:ge}),S.jsx("h3",{className:"mt-2 font-display text-2xl font-bold text-white line-clamp-2",children:le}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:me})]})]})},re.id)})]}),N&&S.jsx("div",{ref:Q,className:"flex items-center justify-center py-6",children:d&&S.jsx(Ys,{name:"crescent"})})]})]})})})},ZS="live_space.last_location",XL=()=>{try{const t=window.localStorage.getItem(ZS);if(!t)return null;const e=JSON.parse(t),r=typeof e.lat=="number"?e.lat:Number(e.lat),l=typeof e.lng=="number"?e.lng:Number(e.lng),f=typeof e.ts=="number"?e.ts:Number(e.ts);if(!Number.isFinite(r)||!Number.isFinite(l)||!Number.isFinite(f))return null;const _=Date.now()-f;return _<0||_>1e3*60*60*24*30?null:{lat:r,lng:l}}catch{return null}},GS=()=>{const[t,e]=ie.useState(null);return ie.useEffect(()=>{e(XL())},[]),t},KL=t=>{try{window.localStorage.setItem(ZS,JSON.stringify({...t,ts:Date.now()}))}catch{}},JL=()=>{const t=GS(),[e,r]=ie.useState(null),[l,f]=ie.useState(!1),[_,y]=ie.useState("");ie.useEffect(()=>{t&&r(t)},[t]);const d=ie.useCallback(()=>{if(!navigator.geolocation){y("Location is not supported on this device.");return}f(!0),y(""),navigator.geolocation.getCurrentPosition(A=>{const j={lat:A.coords.latitude,lng:A.coords.longitude};r(j),KL(j),f(!1)},()=>{f(!1),y("Enable location to see concerts near you.")},{enableHighAccuracy:!0,timeout:5e3})},[]);return{location:e,loading:l,error:_,requestLocation:d}},pu={async follow(t,e){const{error:r}=await Rt.from("follows").insert({follower_subject_id:t,target_subject_id:e});if(r)throw r},async unfollow(t,e){const{error:r}=await Rt.from("follows").delete().match({follower_subject_id:t,target_subject_id:e});if(r)throw r},async isFollowing(t,e){const{data:r,error:l}=await Rt.from("follows").select("created_at").match({follower_subject_id:t,target_subject_id:e}).maybeSingle();if(l)throw l;return!!r},async getFollowersCount(t){const{count:e,error:r}=await Rt.from("follows").select("*",{count:"exact",head:!0}).eq("target_subject_id",t);if(r)throw r;return e||0},async getFollowingCount(t){const{count:e,error:r}=await Rt.from("follows").select("*",{count:"exact",head:!0}).eq("follower_subject_id",t);if(r)throw r;return e||0}},WS=()=>{const{user:t,profile:e}=va(),r=e?.subject_id||null,[l,f]=ie.useState(new Set),[_,y]=ie.useState(!1),[d,A]=ie.useState(new Set),j=!!(t&&r);ie.useEffect(()=>{if(!r)return;let Q=!1;return y(!0),yr(`follows:${r}`,async()=>{const{data:ne,error:J}=await Rt.from("follows").select("target_subject_id").eq("follower_subject_id",r);if(J)throw J;return(ne||[]).map(ye=>ye.target_subject_id).filter(Boolean)},{ttlMs:1e4}).then(ne=>{Q||f(new Set(ne))}).catch(()=>{Q||f(new Set)}).finally(()=>{Q||y(!1)}),()=>{Q=!0}},[r]);const B=ie.useCallback(Q=>l.has(Q),[l]),N=ie.useCallback(Q=>d.has(Q),[d]),V=ie.useCallback(async Q=>{if(!t||!r)return{ok:!1,reason:"not-authenticated"};if(!Q)return{ok:!1,reason:"invalid-target"};const ne=new Set(l),J=ne.has(Q);J?ne.delete(Q):ne.add(Q),f(ne),A(ye=>new Set(ye).add(Q));try{return J?await pu.unfollow(r,Q):await pu.follow(r,Q),ix(`follows:${r}`,Array.from(ne),{ttlMs:1e4}),{ok:!0}}catch{const re=new Set(ne);return J?re.add(Q):re.delete(Q),f(re),ix(`follows:${r}`,Array.from(re),{ttlMs:2e3}),{ok:!1,reason:"network"}}finally{A(ye=>{const re=new Set(ye);return re.delete(Q),re})}},[r,l,t]);return ie.useMemo(()=>({canFollow:j,loading:_,followedSubjectIds:l,isFollowing:B,isToggling:N,toggleFollowSubject:V}),[j,l,B,N,_,V])},Hh=t=>{if(t==null)return null;if(typeof t=="number")return t;const e=Number(t);return Number.isNaN(e)?null:e},qx=(t,e,r,l)=>{const _=(r-t)*Math.PI/180,y=(l-e)*Math.PI/180,d=Math.sin(_/2)*Math.sin(_/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(y/2)*Math.sin(y/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},m_=t=>{const e=new Date(t);try{return new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric"}).format(e)}catch{return e.toLocaleDateString()}},QL=t=>t<1?`${(t*1e3).toFixed(0)} m`:t<10?`${t.toFixed(1)} km`:`${t.toFixed(0)} km`,g_=t=>(t.event_artists||[]).find(r=>r.artist?.name)?.artist?.name||t.name,dp=t=>t.cover_image_url||(t.event_artists||[]).find(e=>e.artist?.avatar_url)?.artist?.avatar_url||null,ez=t=>new Date(t).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric"}),tz=t=>t?.display_name||t?.username||null,iz=t=>{const e=t.event_artists?.find(r=>r.artist)?.artist;return e?.name?e.name:t.organizer&&t.organizer.role!=="venue"?tz(t.organizer):null},nz=t=>t.venue_place?.name||t.address||t.city||null,ec=({event:t,onSelect:e,className:r,title:l,subtitle:f,kicker:_,badge:y})=>{const d=t.cover_image_url||t.event_artists?.find(N=>N.artist?.avatar_url)?.artist?.avatar_url||null,A=ie.useMemo(()=>l||iz(t)||t.name,[t.name,l]),j=ie.useMemo(()=>f||nz(t)||"Venue",[t,f]),B=ie.useMemo(()=>_||ez(t.starts_at),[t.starts_at,_]);return S.jsx("button",{type:"button",className:r||"w-[220px] shrink-0",onClick:()=>e(t),children:S.jsxs("div",{className:"relative aspect-[4/5] overflow-hidden",children:[d?S.jsx("img",{src:d,alt:t.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),y&&S.jsx("div",{className:"absolute left-3 top-3",children:S.jsx("span",{className:"rounded-md bg-black/60 px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-white/90",children:y})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4 text-left",children:[S.jsx("p",{className:"font-display text-lg font-bold text-white line-clamp-2",children:A}),S.jsx("p",{className:"mt-1 text-xs font-semibold uppercase tracking-[0.18em] text-white/80 line-clamp-1",children:j}),S.jsx("p",{className:"mt-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65 line-clamp-1",children:B})]})]})})},sz=({canCreateEvent:t,loading:e,loadError:r,location:l,locationLoading:f,locationError:_,onRequestLocation:y,nearbyUpcoming:d})=>{const A=Ur();return S.jsxs("section",{className:"animate-fade-up motion-reduce:animate-none space-y-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Concerts near you"}),S.jsx("p",{className:"mt-2 text-sm text-white/55",children:"Today + the next two weeks."})]}),t&&S.jsx("div",{className:"flex flex-col items-end gap-2",children:S.jsx("button",{type:"button",className:"inline-flex items-center gap-2 bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>A.push("/create-event"),children:"Create event"})})]}),_&&S.jsx("p",{className:"text-xs text-rose-400",children:_}),e?S.jsx("div",{className:"flex items-center justify-center py-8",children:S.jsx(Ys,{name:"crescent"})}):S.jsxs(S.Fragment,{children:[r&&S.jsx("p",{className:"text-sm text-rose-400",children:r}),l?d.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No concerts nearby today"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Try the map to explore whats happening around you."}),S.jsx("div",{className:"mt-4 flex items-center gap-3",children:S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>A.push("/tabs/map"),children:"Explore map"})})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:d.slice(0,10).map(j=>S.jsx(ec,{event:{...j,cover_image_url:dp(j)},className:"w-[220px] shrink-0",kicker:m_(j.starts_at),title:g_(j),subtitle:j.venue_place?.name||j.city,badge:QL(j.distanceKm),onSelect:B=>A.push(`/event/${B.id}`)},j.id))}):S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"See concerts near you"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Use your location to get nearby events and distances."}),S.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:opacity-60",onClick:y,disabled:f,children:"Use my location"}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white/90",onClick:()=>A.push("/tabs/map"),children:"Explore map"})]})]})]})]})};function rz(t,e){const r=ie.useRef(e);ie.useEffect(function(){e!==r.current&&t.attributionControl!=null&&(r.current!=null&&t.attributionControl.removeAttribution(r.current),e!=null&&t.attributionControl.addAttribution(e)),r.current=e},[t,e])}function az(t,e,r){e.center!==r.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==r.radius&&t.setRadius(e.radius)}const oz=1;function lz(t){return Object.freeze({__version:oz,map:t})}function YS(t,e){return Object.freeze({...t,...e})}const Hx=ie.createContext(null);function Zx(){const t=ie.use(Hx);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function XS(t){function e(r,l){const{instance:f,context:_}=t(r).current;ie.useImperativeHandle(l,()=>f);const{children:y}=r;return y==null?null:Nt.createElement(Hx,{value:_},y)}return ie.forwardRef(e)}function cz(t){function e(r,l){const{instance:f}=t(r).current;return ie.useImperativeHandle(l,()=>f),null}return ie.forwardRef(e)}function KS(t,e){const r=ie.useRef(void 0);ie.useEffect(function(){return e!=null&&t.instance.on(e),r.current=e,function(){r.current!=null&&t.instance.off(r.current),r.current=null}},[t,e])}function Gx(t,e){const r=t.pane??e.pane;return r?{...t,pane:r}:t}var Am={exports:{}};var uz=Am.exports,sw;function JS(){return sw||(sw=1,(function(t,e){(function(r,l){l(e)})(uz,(function(r){var l="1.9.4";function f(u){var b,M,$,Z;for(M=1,$=arguments.length;M<$;M++){Z=arguments[M];for(b in Z)u[b]=Z[b]}return u}var _=Object.create||(function(){function u(){}return function(b){return u.prototype=b,new u}})();function y(u,b){var M=Array.prototype.slice;if(u.bind)return u.bind.apply(u,M.call(arguments,1));var $=M.call(arguments,2);return function(){return u.apply(b,$.length?$.concat(M.call(arguments)):arguments)}}var d=0;function A(u){return"_leaflet_id"in u||(u._leaflet_id=++d),u._leaflet_id}function j(u,b,M){var $,Z,ce,Ce;return Ce=function(){$=!1,Z&&(ce.apply(M,Z),Z=!1)},ce=function(){$?Z=arguments:(u.apply(M,arguments),setTimeout(Ce,b),$=!0)},ce}function B(u,b,M){var $=b[1],Z=b[0],ce=$-Z;return u===$&&M?u:((u-Z)%ce+ce)%ce+Z}function N(){return!1}function V(u,b){if(b===!1)return u;var M=Math.pow(10,b===void 0?6:b);return Math.round(u*M)/M}function Q(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function ne(u){return Q(u).split(/\s+/)}function J(u,b){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?_(u.options):{});for(var M in b)u.options[M]=b[M];return u.options}function ye(u,b,M){var $=[];for(var Z in u)$.push(encodeURIComponent(M?Z.toUpperCase():Z)+"="+encodeURIComponent(u[Z]));return(!b||b.indexOf("?")===-1?"?":"&")+$.join("&")}var re=/\{ *([\w_ -]+) *\}/g;function ge(u,b){return u.replace(re,function(M,$){var Z=b[$];if(Z===void 0)throw new Error("No value provided for variable "+M);return typeof Z=="function"&&(Z=Z(b)),Z})}var le=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function me(u,b){for(var M=0;M<u.length;M++)if(u[M]===b)return M;return-1}var be="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ke(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var Me=0;function Ue(u){var b=+new Date,M=Math.max(0,16-(b-Me));return Me=b+M,window.setTimeout(u,M)}var Fe=window.requestAnimationFrame||ke("RequestAnimationFrame")||Ue,He=window.cancelAnimationFrame||ke("CancelAnimationFrame")||ke("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function lt(u,b,M){if(M&&Fe===Ue)u.call(b);else return Fe.call(window,y(u,b))}function Ye(u){u&&He.call(window,u)}var Mt={__proto__:null,extend:f,create:_,bind:y,get lastId(){return d},stamp:A,throttle:j,wrapNum:B,falseFn:N,formatNum:V,trim:Q,splitWords:ne,setOptions:J,getParamString:ye,template:ge,isArray:le,indexOf:me,emptyImageUrl:be,requestFn:Fe,cancelFn:He,requestAnimFrame:lt,cancelAnimFrame:Ye};function et(){}et.extend=function(u){var b=function(){J(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},M=b.__super__=this.prototype,$=_(M);$.constructor=b,b.prototype=$;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(b[Z]=this[Z]);return u.statics&&f(b,u.statics),u.includes&&(Tt(u.includes),f.apply(null,[$].concat(u.includes))),f($,u),delete $.statics,delete $.includes,$.options&&($.options=M.options?_(M.options):{},f($.options,u.options)),$._initHooks=[],$.callInitHooks=function(){if(!this._initHooksCalled){M.callInitHooks&&M.callInitHooks.call(this),this._initHooksCalled=!0;for(var ce=0,Ce=$._initHooks.length;ce<Ce;ce++)$._initHooks[ce].call(this)}},b},et.include=function(u){var b=this.prototype.options;return f(this.prototype,u),u.options&&(this.prototype.options=b,this.mergeOptions(u.options)),this},et.mergeOptions=function(u){return f(this.prototype.options,u),this},et.addInitHook=function(u){var b=Array.prototype.slice.call(arguments,1),M=typeof u=="function"?u:function(){this[u].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(M),this};function Tt(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=le(u)?u:[u];for(var b=0;b<u.length;b++)u[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Be={on:function(u,b,M){if(typeof u=="object")for(var $ in u)this._on($,u[$],b);else{u=ne(u);for(var Z=0,ce=u.length;Z<ce;Z++)this._on(u[Z],b,M)}return this},off:function(u,b,M){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var $ in u)this._off($,u[$],b);else{u=ne(u);for(var Z=arguments.length===1,ce=0,Ce=u.length;ce<Ce;ce++)Z?this._off(u[ce]):this._off(u[ce],b,M)}return this},_on:function(u,b,M,$){if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}if(this._listens(u,b,M)===!1){M===this&&(M=void 0);var Z={fn:b,ctx:M};$&&(Z.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(Z)}},_off:function(u,b,M){var $,Z,ce;if(this._events&&($=this._events[u],!!$)){if(arguments.length===1){if(this._firingCount)for(Z=0,ce=$.length;Z<ce;Z++)$[Z].fn=N;delete this._events[u];return}if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}var Ce=this._listens(u,b,M);if(Ce!==!1){var Xe=$[Ce];this._firingCount&&(Xe.fn=N,this._events[u]=$=$.slice()),$.splice(Ce,1)}}},fire:function(u,b,M){if(!this.listens(u,M))return this;var $=f({},b,{type:u,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events){var Z=this._events[u];if(Z){this._firingCount=this._firingCount+1||1;for(var ce=0,Ce=Z.length;ce<Ce;ce++){var Xe=Z[ce],dt=Xe.fn;Xe.once&&this.off(u,dt,Xe.ctx),dt.call(Xe.ctx||this,$)}this._firingCount--}}return M&&this._propagateEvent($),this},listens:function(u,b,M,$){typeof u!="string"&&console.warn('"string" type argument expected');var Z=b;typeof b!="function"&&($=!!b,Z=void 0,M=void 0);var ce=this._events&&this._events[u];if(ce&&ce.length&&this._listens(u,Z,M)!==!1)return!0;if($){for(var Ce in this._eventParents)if(this._eventParents[Ce].listens(u,b,M,$))return!0}return!1},_listens:function(u,b,M){if(!this._events)return!1;var $=this._events[u]||[];if(!b)return!!$.length;M===this&&(M=void 0);for(var Z=0,ce=$.length;Z<ce;Z++)if($[Z].fn===b&&$[Z].ctx===M)return Z;return!1},once:function(u,b,M){if(typeof u=="object")for(var $ in u)this._on($,u[$],b,!0);else{u=ne(u);for(var Z=0,ce=u.length;Z<ce;Z++)this._on(u[Z],b,M,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[A(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[A(u)],this},_propagateEvent:function(u){for(var b in this._eventParents)this._eventParents[b].fire(u.type,f({layer:u.target,propagatedFrom:u.target},u),!0)}};Be.addEventListener=Be.on,Be.removeEventListener=Be.clearAllEventListeners=Be.off,Be.addOneTimeEventListener=Be.once,Be.fireEvent=Be.fire,Be.hasEventListeners=Be.listens;var ct=et.extend(Be);function ut(u,b,M){this.x=M?Math.round(u):u,this.y=M?Math.round(b):b}var Et=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};ut.prototype={clone:function(){return new ut(this.x,this.y)},add:function(u){return this.clone()._add(ot(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(ot(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new ut(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new ut(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Et(this.x),this.y=Et(this.y),this},distanceTo:function(u){u=ot(u);var b=u.x-this.x,M=u.y-this.y;return Math.sqrt(b*b+M*M)},equals:function(u){return u=ot(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=ot(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+V(this.x)+", "+V(this.y)+")"}};function ot(u,b,M){return u instanceof ut?u:le(u)?new ut(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new ut(u.x,u.y):new ut(u,b,M)}function xe(u,b){if(u)for(var M=b?[u,b]:u,$=0,Z=M.length;$<Z;$++)this.extend(M[$])}xe.prototype={extend:function(u){var b,M;if(!u)return this;if(u instanceof ut||typeof u[0]=="number"||"x"in u)b=M=ot(u);else if(u=Le(u),b=u.min,M=u.max,!b||!M)return this;return!this.min&&!this.max?(this.min=b.clone(),this.max=M.clone()):(this.min.x=Math.min(b.x,this.min.x),this.max.x=Math.max(M.x,this.max.x),this.min.y=Math.min(b.y,this.min.y),this.max.y=Math.max(M.y,this.max.y)),this},getCenter:function(u){return ot((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return ot(this.min.x,this.max.y)},getTopRight:function(){return ot(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var b,M;return typeof u[0]=="number"||u instanceof ut?u=ot(u):u=Le(u),u instanceof xe?(b=u.min,M=u.max):b=M=u,b.x>=this.min.x&&M.x<=this.max.x&&b.y>=this.min.y&&M.y<=this.max.y},intersects:function(u){u=Le(u);var b=this.min,M=this.max,$=u.min,Z=u.max,ce=Z.x>=b.x&&$.x<=M.x,Ce=Z.y>=b.y&&$.y<=M.y;return ce&&Ce},overlaps:function(u){u=Le(u);var b=this.min,M=this.max,$=u.min,Z=u.max,ce=Z.x>b.x&&$.x<M.x,Ce=Z.y>b.y&&$.y<M.y;return ce&&Ce},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var b=this.min,M=this.max,$=Math.abs(b.x-M.x)*u,Z=Math.abs(b.y-M.y)*u;return Le(ot(b.x-$,b.y-Z),ot(M.x+$,M.y+Z))},equals:function(u){return u?(u=Le(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function Le(u,b){return!u||u instanceof xe?u:new xe(u,b)}function tt(u,b){if(u)for(var M=b?[u,b]:u,$=0,Z=M.length;$<Z;$++)this.extend(M[$])}tt.prototype={extend:function(u){var b=this._southWest,M=this._northEast,$,Z;if(u instanceof gt)$=u,Z=u;else if(u instanceof tt){if($=u._southWest,Z=u._northEast,!$||!Z)return this}else return u?this.extend(Pt(u)||rt(u)):this;return!b&&!M?(this._southWest=new gt($.lat,$.lng),this._northEast=new gt(Z.lat,Z.lng)):(b.lat=Math.min($.lat,b.lat),b.lng=Math.min($.lng,b.lng),M.lat=Math.max(Z.lat,M.lat),M.lng=Math.max(Z.lng,M.lng)),this},pad:function(u){var b=this._southWest,M=this._northEast,$=Math.abs(b.lat-M.lat)*u,Z=Math.abs(b.lng-M.lng)*u;return new tt(new gt(b.lat-$,b.lng-Z),new gt(M.lat+$,M.lng+Z))},getCenter:function(){return new gt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new gt(this.getNorth(),this.getWest())},getSouthEast:function(){return new gt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof gt||"lat"in u?u=Pt(u):u=rt(u);var b=this._southWest,M=this._northEast,$,Z;return u instanceof tt?($=u.getSouthWest(),Z=u.getNorthEast()):$=Z=u,$.lat>=b.lat&&Z.lat<=M.lat&&$.lng>=b.lng&&Z.lng<=M.lng},intersects:function(u){u=rt(u);var b=this._southWest,M=this._northEast,$=u.getSouthWest(),Z=u.getNorthEast(),ce=Z.lat>=b.lat&&$.lat<=M.lat,Ce=Z.lng>=b.lng&&$.lng<=M.lng;return ce&&Ce},overlaps:function(u){u=rt(u);var b=this._southWest,M=this._northEast,$=u.getSouthWest(),Z=u.getNorthEast(),ce=Z.lat>b.lat&&$.lat<M.lat,Ce=Z.lng>b.lng&&$.lng<M.lng;return ce&&Ce},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,b){return u?(u=rt(u),this._southWest.equals(u.getSouthWest(),b)&&this._northEast.equals(u.getNorthEast(),b)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function rt(u,b){return u instanceof tt?u:new tt(u,b)}function gt(u,b,M){if(isNaN(u)||isNaN(b))throw new Error("Invalid LatLng object: ("+u+", "+b+")");this.lat=+u,this.lng=+b,M!==void 0&&(this.alt=+M)}gt.prototype={equals:function(u,b){if(!u)return!1;u=Pt(u);var M=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return M<=(b===void 0?1e-9:b)},toString:function(u){return"LatLng("+V(this.lat,u)+", "+V(this.lng,u)+")"},distanceTo:function(u){return ei.distance(this,Pt(u))},wrap:function(){return ei.wrapLatLng(this)},toBounds:function(u){var b=180*u/40075017,M=b/Math.cos(Math.PI/180*this.lat);return rt([this.lat-b,this.lng-M],[this.lat+b,this.lng+M])},clone:function(){return new gt(this.lat,this.lng,this.alt)}};function Pt(u,b,M){return u instanceof gt?u:le(u)&&typeof u[0]!="object"?u.length===3?new gt(u[0],u[1],u[2]):u.length===2?new gt(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new gt(u.lat,"lng"in u?u.lng:u.lon,u.alt):b===void 0?null:new gt(u,b,M)}var Ot={latLngToPoint:function(u,b){var M=this.projection.project(u),$=this.scale(b);return this.transformation._transform(M,$)},pointToLatLng:function(u,b){var M=this.scale(b),$=this.transformation.untransform(u,M);return this.projection.unproject($)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var b=this.projection.bounds,M=this.scale(u),$=this.transformation.transform(b.min,M),Z=this.transformation.transform(b.max,M);return new xe($,Z)},infinite:!1,wrapLatLng:function(u){var b=this.wrapLng?B(u.lng,this.wrapLng,!0):u.lng,M=this.wrapLat?B(u.lat,this.wrapLat,!0):u.lat,$=u.alt;return new gt(M,b,$)},wrapLatLngBounds:function(u){var b=u.getCenter(),M=this.wrapLatLng(b),$=b.lat-M.lat,Z=b.lng-M.lng;if($===0&&Z===0)return u;var ce=u.getSouthWest(),Ce=u.getNorthEast(),Xe=new gt(ce.lat-$,ce.lng-Z),dt=new gt(Ce.lat-$,Ce.lng-Z);return new tt(Xe,dt)}},ei=f({},Ot,{wrapLng:[-180,180],R:6371e3,distance:function(u,b){var M=Math.PI/180,$=u.lat*M,Z=b.lat*M,ce=Math.sin((b.lat-u.lat)*M/2),Ce=Math.sin((b.lng-u.lng)*M/2),Xe=ce*ce+Math.cos($)*Math.cos(Z)*Ce*Ce,dt=2*Math.atan2(Math.sqrt(Xe),Math.sqrt(1-Xe));return this.R*dt}}),gi=6378137,Vi={R:gi,MAX_LATITUDE:85.0511287798,project:function(u){var b=Math.PI/180,M=this.MAX_LATITUDE,$=Math.max(Math.min(M,u.lat),-M),Z=Math.sin($*b);return new ut(this.R*u.lng*b,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(u){var b=180/Math.PI;return new gt((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*b,u.x*b/this.R)},bounds:(function(){var u=gi*Math.PI;return new xe([-u,-u],[u,u])})()};function pi(u,b,M,$){if(le(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=b,this._c=M,this._d=$}pi.prototype={transform:function(u,b){return this._transform(u.clone(),b)},_transform:function(u,b){return b=b||1,u.x=b*(this._a*u.x+this._b),u.y=b*(this._c*u.y+this._d),u},untransform:function(u,b){return b=b||1,new ut((u.x/b-this._b)/this._a,(u.y/b-this._d)/this._c)}};function zi(u,b,M,$){return new pi(u,b,M,$)}var gn=f({},ei,{code:"EPSG:3857",projection:Vi,transformation:(function(){var u=.5/(Math.PI*Vi.R);return zi(u,.5,-u,.5)})()}),ln=f({},gn,{code:"EPSG:900913"});function $n(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function it(u,b){var M="",$,Z,ce,Ce,Xe,dt;for($=0,ce=u.length;$<ce;$++){for(Xe=u[$],Z=0,Ce=Xe.length;Z<Ce;Z++)dt=Xe[Z],M+=(Z?"L":"M")+dt.x+" "+dt.y;M+=b?st.svg?"z":"x":""}return M||"M0 0"}var Cn=document.documentElement.style,Mn="ActiveXObject"in window,Si=Mn&&!document.addEventListener,mi="msLaunchUri"in navigator&&!("documentMode"in document),En=Ke("webkit"),Rn=Ke("android"),is=Ke("android 2")||Ke("android 3"),sn=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Xi=Rn&&Ke("Google")&&sn<537&&!("AudioNode"in window),Gi=!!window.opera,ns=!mi&&Ke("chrome"),kt=Ke("gecko")&&!En&&!Gi&&!Mn,Hn=!ns&&Ke("safari"),yn=Ke("phantom"),bn="OTransition"in Cn,Un=navigator.platform.indexOf("Win")===0,jt=Mn&&"transition"in Cn,ii="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!is,Xt="MozPerspective"in Cn,Wi=!window.L_DISABLE_3D&&(jt||ii||Xt)&&!bn&&!yn,Dn=typeof orientation<"u"||Ke("mobile"),hi=Dn&&En,xs=Dn&&ii,Pn=!window.PointerEvent&&window.MSPointerEvent,Zn=!!(window.PointerEvent||Pn),rn="ontouchstart"in window||!!window.TouchEvent,we=!window.L_NO_TOUCH&&(rn||Zn),te=Dn&&Gi,G=Dn&&kt,oe=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ve=(function(){var u=!1;try{var b=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",N,b),window.removeEventListener("testPassiveEventSupport",N,b)}catch{}return u})(),je=(function(){return!!document.createElement("canvas").getContext})(),ze=!!(document.createElementNS&&$n("svg").createSVGRect),Ve=!!ze&&(function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),he=!ze&&(function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var b=u.firstChild;return b.style.behavior="url(#default#VML)",b&&typeof b.adj=="object"}catch{return!1}})(),Ge=navigator.platform.indexOf("Mac")===0,at=navigator.platform.indexOf("Linux")===0;function Ke(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var st={ie:Mn,ielt9:Si,edge:mi,webkit:En,android:Rn,android23:is,androidStock:Xi,opera:Gi,chrome:ns,gecko:kt,safari:Hn,phantom:yn,opera12:bn,win:Un,ie3d:jt,webkit3d:ii,gecko3d:Xt,any3d:Wi,mobile:Dn,mobileWebkit:hi,mobileWebkit3d:xs,msPointer:Pn,pointer:Zn,touch:we,touchNative:rn,mobileOpera:te,mobileGecko:G,retina:oe,passiveEvents:ve,canvas:je,svg:ze,vml:he,inlineSvg:Ve,mac:Ge,linux:at},Qt=st.msPointer?"MSPointerDown":"pointerdown",si=st.msPointer?"MSPointerMove":"pointermove",Bt=st.msPointer?"MSPointerUp":"pointerup",Ct=st.msPointer?"MSPointerCancel":"pointercancel",ni={touchstart:Qt,touchmove:si,touchend:Bt,touchcancel:Ct},yi={touchstart:vi,touchmove:Zi,touchend:Zi,touchcancel:Zi},Ri={},_t=!1;function xt(u,b,M){return b==="touchstart"&&Kt(),yi[b]?(M=yi[b].bind(this,M),u.addEventListener(ni[b],M,!1),M):(console.warn("wrong event specified:",b),N)}function Gt(u,b,M){if(!ni[b]){console.warn("wrong event specified:",b);return}u.removeEventListener(ni[b],M,!1)}function fi(u){Ri[u.pointerId]=u}function Ne(u){Ri[u.pointerId]&&(Ri[u.pointerId]=u)}function zt(u){delete Ri[u.pointerId]}function Kt(){_t||(document.addEventListener(Qt,fi,!0),document.addEventListener(si,Ne,!0),document.addEventListener(Bt,zt,!0),document.addEventListener(Ct,zt,!0),_t=!0)}function Zi(u,b){if(b.pointerType!==(b.MSPOINTER_TYPE_MOUSE||"mouse")){b.touches=[];for(var M in Ri)b.touches.push(Ri[M]);b.changedTouches=[b],u(b)}}function vi(u,b){b.MSPOINTER_TYPE_TOUCH&&b.pointerType===b.MSPOINTER_TYPE_TOUCH&&bs(b),Zi(u,b)}function mn(u){var b={},M,$;for($ in u)M=u[$],b[$]=M&&M.bind?M.bind(u):M;return u=b,b.type="dblclick",b.detail=2,b.isTrusted=!1,b._simulated=!0,b}var _r=200;function Xs(u,b){u.addEventListener("dblclick",b);var M=0,$;function Z(ce){if(ce.detail!==1){$=ce.detail;return}if(!(ce.pointerType==="mouse"||ce.sourceCapabilities&&!ce.sourceCapabilities.firesTouchEvents)){var Ce=Qo(ce);if(!(Ce.some(function(dt){return dt instanceof HTMLLabelElement&&dt.attributes.for})&&!Ce.some(function(dt){return dt instanceof HTMLInputElement||dt instanceof HTMLSelectElement}))){var Xe=Date.now();Xe-M<=_r?($++,$===2&&b(mn(ce))):$=1,M=Xe}}}return u.addEventListener("click",Z),{dblclick:b,simDblclick:Z}}function Rs(u,b){u.removeEventListener("dblclick",b.dblclick),u.removeEventListener("click",b.simDblclick)}var Co=un(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),sr=un(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),vr=sr==="webkitTransition"||sr==="OTransition"?sr+"End":"transitionend";function Ao(u){return typeof u=="string"?document.getElementById(u):u}function xa(u,b){var M=u.style[b]||u.currentStyle&&u.currentStyle[b];if((!M||M==="auto")&&document.defaultView){var $=document.defaultView.getComputedStyle(u,null);M=$?$[b]:null}return M==="auto"?null:M}function ki(u,b,M){var $=document.createElement(u);return $.className=b||"",M&&M.appendChild($),$}function In(u){var b=u.parentNode;b&&b.removeChild(u)}function gs(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function cn(u){var b=u.parentNode;b&&b.lastChild!==u&&b.appendChild(u)}function Oa(u){var b=u.parentNode;b&&b.firstChild!==u&&b.insertBefore(u,b.firstChild)}function Fr(u,b){if(u.classList!==void 0)return u.classList.contains(b);var M=Xo(u);return M.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(M)}function Bi(u,b){if(u.classList!==void 0)for(var M=ne(b),$=0,Z=M.length;$<Z;$++)u.classList.add(M[$]);else if(!Fr(u,b)){var ce=Xo(u);Il(u,(ce?ce+" ":"")+b)}}function An(u,b){u.classList!==void 0?u.classList.remove(b):Il(u,Q((" "+Xo(u)+" ").replace(" "+b+" "," ")))}function Il(u,b){u.className.baseVal===void 0?u.className=b:u.className.baseVal=b}function Xo(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function On(u,b){"opacity"in u.style?u.style.opacity=b:"filter"in u.style&&Na(u,b)}function Na(u,b){var M=!1,$="DXImageTransform.Microsoft.Alpha";try{M=u.filters.item($)}catch{if(b===1)return}b=Math.round(b*100),M?(M.Enabled=b!==100,M.Opacity=b):u.style.filter+=" progid:"+$+"(opacity="+b+")"}function un(u){for(var b=document.documentElement.style,M=0;M<u.length;M++)if(u[M]in b)return u[M];return!1}function ba(u,b,M){var $=b||new ut(0,0);u.style[Co]=(st.ie3d?"translate("+$.x+"px,"+$.y+"px)":"translate3d("+$.x+"px,"+$.y+"px,0)")+(M?" scale("+M+")":"")}function Gn(u,b){u._leaflet_pos=b,st.any3d?ba(u,b):(u.style.left=b.x+"px",u.style.top=b.y+"px")}function Vr(u){return u._leaflet_pos||new ut(0,0)}var Mo,qr,Ko;if("onselectstart"in document)Mo=function(){Ii(window,"selectstart",bs)},qr=function(){jn(window,"selectstart",bs)};else{var oo=un(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Mo=function(){if(oo){var u=document.documentElement.style;Ko=u[oo],u[oo]="none"}},qr=function(){oo&&(document.documentElement.style[oo]=Ko,Ko=void 0)}}function lo(){Ii(window,"dragstart",bs)}function Ll(){jn(window,"dragstart",bs)}var Ic,Lc;function zl(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&(Us(),Ic=u,Lc=u.style.outlineStyle,u.style.outlineStyle="none",Ii(window,"keydown",Us))}function Us(){Ic&&(Ic.style.outlineStyle=Lc,Ic=void 0,Lc=void 0,jn(window,"keydown",Us))}function Po(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function Fs(u){var b=u.getBoundingClientRect();return{x:b.width/u.offsetWidth||1,y:b.height/u.offsetHeight||1,boundingClientRect:b}}var Ds={__proto__:null,TRANSFORM:Co,TRANSITION:sr,TRANSITION_END:vr,get:Ao,getStyle:xa,create:ki,remove:In,empty:gs,toFront:cn,toBack:Oa,hasClass:Fr,addClass:Bi,removeClass:An,setClass:Il,getClass:Xo,setOpacity:On,testProp:un,setTransform:ba,setPosition:Gn,getPosition:Vr,get disableTextSelection(){return Mo},get enableTextSelection(){return qr},disableImageDrag:lo,enableImageDrag:Ll,preventOutline:zl,restoreOutline:Us,getSizedParentNode:Po,getScale:Fs};function Ii(u,b,M,$){if(b&&typeof b=="object")for(var Z in b)wa(u,Z,b[Z],M);else{b=ne(b);for(var ce=0,Ce=b.length;ce<Ce;ce++)wa(u,b[ce],M,$)}return this}var jr="_leaflet_events";function jn(u,b,M,$){if(arguments.length===1)zc(u),delete u[jr];else if(b&&typeof b=="object")for(var Z in b)Rl(u,Z,b[Z],M);else if(b=ne(b),arguments.length===2)zc(u,function(Xe){return me(b,Xe)!==-1});else for(var ce=0,Ce=b.length;ce<Ce;ce++)Rl(u,b[ce],M,$);return this}function zc(u,b){for(var M in u[jr]){var $=M.split(/\d/)[0];(!b||b($))&&Rl(u,$,null,null,M)}}var sa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function wa(u,b,M,$){var Z=b+A(M)+($?"_"+A($):"");if(u[jr]&&u[jr][Z])return this;var ce=function(Xe){return M.call($||u,Xe||window.event)},Ce=ce;!st.touchNative&&st.pointer&&b.indexOf("touch")===0?ce=xt(u,b,ce):st.touch&&b==="dblclick"?ce=Xs(u,ce):"addEventListener"in u?b==="touchstart"||b==="touchmove"||b==="wheel"||b==="mousewheel"?u.addEventListener(sa[b]||b,ce,st.passiveEvents?{passive:!1}:!1):b==="mouseenter"||b==="mouseleave"?(ce=function(Xe){Xe=Xe||window.event,Vs(u,Xe)&&Ce(Xe)},u.addEventListener(sa[b],ce,!1)):u.addEventListener(b,Ce,!1):u.attachEvent("on"+b,ce),u[jr]=u[jr]||{},u[jr][Z]=ce}function Rl(u,b,M,$,Z){Z=Z||b+A(M)+($?"_"+A($):"");var ce=u[jr]&&u[jr][Z];if(!ce)return this;!st.touchNative&&st.pointer&&b.indexOf("touch")===0?Gt(u,b,ce):st.touch&&b==="dblclick"?Rs(u,ce):"removeEventListener"in u?u.removeEventListener(sa[b]||b,ce,!1):u.detachEvent("on"+b,ce),u[jr][Z]=null}function ra(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function Ba(u){return wa(u,"wheel",ra),this}function Jo(u){return Ii(u,"mousedown touchstart dblclick contextmenu",ra),u._leaflet_disable_click=!0,this}function bs(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function aa(u){return bs(u),ra(u),this}function Qo(u){if(u.composedPath)return u.composedPath();for(var b=[],M=u.target;M;)b.push(M),M=M.parentNode;return b}function jo(u,b){if(!b)return new ut(u.clientX,u.clientY);var M=Fs(b),$=M.boundingClientRect;return new ut((u.clientX-$.left)/M.x-b.clientLeft,(u.clientY-$.top)/M.y-b.clientTop)}var Rc=st.linux&&st.chrome?window.devicePixelRatio:st.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ks(u){return st.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/Rc:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function Vs(u,b){var M=b.relatedTarget;if(!M)return!0;try{for(;M&&M!==u;)M=M.parentNode}catch{return!1}return M!==u}var Dc={__proto__:null,on:Ii,off:jn,stopPropagation:ra,disableScrollPropagation:Ba,disableClickPropagation:Jo,preventDefault:bs,stop:aa,getPropagationPath:Qo,getMousePosition:jo,getWheelDelta:Ks,isExternalTarget:Vs,addListener:Ii,removeListener:jn},Io=ct.extend({run:function(u,b,M,$){this.stop(),this._el=u,this._inProgress=!0,this._duration=M||.25,this._easeOutPower=1/Math.max($||.5,.2),this._startPos=Vr(u),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=lt(this._animate,this),this._step()},_step:function(u){var b=+new Date-this._startTime,M=this._duration*1e3;b<M?this._runFrame(this._easeOut(b/M),u):(this._runFrame(1),this._complete())},_runFrame:function(u,b){var M=this._startPos.add(this._offset.multiplyBy(u));b&&M._round(),Gn(this._el,M),this.fire("step")},_complete:function(){Ye(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),Ki=ct.extend({options:{crs:gn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,b){b=J(this,b),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=y(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==void 0&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==void 0&&this.setView(Pt(b.center),b.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=sr&&st.any3d&&!st.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ii(this._proxy,vr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,b,M){if(b=b===void 0?this._zoom:this._limitZoom(b),u=this._limitCenter(Pt(u),b,this.options.maxBounds),M=M||{},this._stop(),this._loaded&&!M.reset&&M!==!0){M.animate!==void 0&&(M.zoom=f({animate:M.animate},M.zoom),M.pan=f({animate:M.animate,duration:M.duration},M.pan));var $=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,b,M.zoom):this._tryAnimatedPan(u,M.pan);if($)return clearTimeout(this._sizeTimer),this}return this._resetView(u,b,M.pan&&M.pan.noMoveStart),this},setZoom:function(u,b){return this._loaded?this.setView(this.getCenter(),u,{zoom:b}):(this._zoom=u,this)},zoomIn:function(u,b){return u=u||(st.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,b)},zoomOut:function(u,b){return u=u||(st.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,b)},setZoomAround:function(u,b,M){var $=this.getZoomScale(b),Z=this.getSize().divideBy(2),ce=u instanceof ut?u:this.latLngToContainerPoint(u),Ce=ce.subtract(Z).multiplyBy(1-1/$),Xe=this.containerPointToLatLng(Z.add(Ce));return this.setView(Xe,b,{zoom:M})},_getBoundsCenterZoom:function(u,b){b=b||{},u=u.getBounds?u.getBounds():rt(u);var M=ot(b.paddingTopLeft||b.padding||[0,0]),$=ot(b.paddingBottomRight||b.padding||[0,0]),Z=this.getBoundsZoom(u,!1,M.add($));if(Z=typeof b.maxZoom=="number"?Math.min(b.maxZoom,Z):Z,Z===1/0)return{center:u.getCenter(),zoom:Z};var ce=$.subtract(M).divideBy(2),Ce=this.project(u.getSouthWest(),Z),Xe=this.project(u.getNorthEast(),Z),dt=this.unproject(Ce.add(Xe).divideBy(2).add(ce),Z);return{center:dt,zoom:Z}},fitBounds:function(u,b){if(u=rt(u),!u.isValid())throw new Error("Bounds are not valid.");var M=this._getBoundsCenterZoom(u,b);return this.setView(M.center,M.zoom,b)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,b){return this.setView(u,this._zoom,{pan:b})},panBy:function(u,b){if(u=ot(u).round(),b=b||{},!u.x&&!u.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Io,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){Bi(this._mapPane,"leaflet-pan-anim");var M=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,M,b.duration||.25,b.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,b,M){if(M=M||{},M.animate===!1||!st.any3d)return this.setView(u,b,M);this._stop();var $=this.project(this.getCenter()),Z=this.project(u),ce=this.getSize(),Ce=this._zoom;u=Pt(u),b=b===void 0?Ce:b;var Xe=Math.max(ce.x,ce.y),dt=Xe*this.getZoomScale(Ce,b),wt=Z.distanceTo($)||1,Wt=1.42,xi=Wt*Wt;function nn(ps){var Oi=ps?-1:1,yo=ps?dt:Xe,Cu=dt*dt-Xe*Xe+Oi*xi*xi*wt*wt,_l=2*yo*xi*wt,uc=Cu/_l,Kr=Math.sqrt(uc*uc+1)-uc,Ha=Kr<1e-9?-18:Math.log(Kr);return Ha}function Hs(ps){return(Math.exp(ps)-Math.exp(-ps))/2}function ws(ps){return(Math.exp(ps)+Math.exp(-ps))/2}function Tr(ps){return Hs(ps)/ws(ps)}var _n=nn(0);function Yi(ps){return Xe*(ws(_n)/ws(_n+Wt*ps))}function It(ps){return Xe*(ws(_n)*Tr(_n+Wt*ps)-Hs(_n))/xi}function Aa(ps){return 1-Math.pow(1-ps,1.5)}var zr=Date.now(),cc=(nn(1)-_n)/Wt,Xr=M.duration?1e3*M.duration:1e3*cc*.8;function No(){var ps=(Date.now()-zr)/Xr,Oi=Aa(ps)*cc;ps<=1?(this._flyToFrame=lt(No,this),this._move(this.unproject($.add(Z.subtract($).multiplyBy(It(Oi)/wt)),Ce),this.getScaleZoom(Xe/Yi(Oi),Ce),{flyTo:!0})):this._move(u,b)._moveEnd(!0)}return this._moveStart(!0,M.noMoveStart),No.call(this),this},flyToBounds:function(u,b){var M=this._getBoundsCenterZoom(u,b);return this.flyTo(M.center,M.zoom,b)},setMaxBounds:function(u){return u=rt(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var b=this.options.minZoom;return this.options.minZoom=u,this._loaded&&b!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var b=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&b!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,b){this._enforcingBounds=!0;var M=this.getCenter(),$=this._limitCenter(M,this._zoom,rt(u));return M.equals($)||this.panTo($,b),this._enforcingBounds=!1,this},panInside:function(u,b){b=b||{};var M=ot(b.paddingTopLeft||b.padding||[0,0]),$=ot(b.paddingBottomRight||b.padding||[0,0]),Z=this.project(this.getCenter()),ce=this.project(u),Ce=this.getPixelBounds(),Xe=Le([Ce.min.add(M),Ce.max.subtract($)]),dt=Xe.getSize();if(!Xe.contains(ce)){this._enforcingBounds=!0;var wt=ce.subtract(Xe.getCenter()),Wt=Xe.extend(ce).getSize().subtract(dt);Z.x+=wt.x<0?-Wt.x:Wt.x,Z.y+=wt.y<0?-Wt.y:Wt.y,this.panTo(this.unproject(Z),b),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=f({animate:!1,pan:!0},u===!0?{animate:!0}:u);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var M=this.getSize(),$=b.divideBy(2).round(),Z=M.divideBy(2).round(),ce=$.subtract(Z);return!ce.x&&!ce.y?this:(u.animate&&u.pan?this.panBy(ce):(u.pan&&this._rawPanBy(ce),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(y(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:M}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=f({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=y(this._handleGeolocationResponse,this),M=y(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,M,u):navigator.geolocation.getCurrentPosition(b,M,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var b=u.code,M=u.message||(b===1?"permission denied":b===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+M+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var b=u.coords.latitude,M=u.coords.longitude,$=new gt(b,M),Z=$.toBounds(u.coords.accuracy*2),ce=this._locateOptions;if(ce.setView){var Ce=this.getBoundsZoom(Z);this.setView($,ce.maxZoom?Math.min(Ce,ce.maxZoom):Ce)}var Xe={latlng:$,bounds:Z,timestamp:u.timestamp};for(var dt in u.coords)typeof u.coords[dt]=="number"&&(Xe[dt]=u.coords[dt]);this.fire("locationfound",Xe)}},addHandler:function(u,b){if(!b)return this;var M=this[u]=new b(this);return this._handlers.push(M),this.options[u]&&M.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),In(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Ye(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)In(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,b){var M="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),$=ki("div",M,b||this._mapPane);return u&&(this._panes[u]=$),$},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),b=this.unproject(u.getBottomLeft()),M=this.unproject(u.getTopRight());return new tt(b,M)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,b,M){u=rt(u),M=ot(M||[0,0]);var $=this.getZoom()||0,Z=this.getMinZoom(),ce=this.getMaxZoom(),Ce=u.getNorthWest(),Xe=u.getSouthEast(),dt=this.getSize().subtract(M),wt=Le(this.project(Xe,$),this.project(Ce,$)).getSize(),Wt=st.any3d?this.options.zoomSnap:1,xi=dt.x/wt.x,nn=dt.y/wt.y,Hs=b?Math.max(xi,nn):Math.min(xi,nn);return $=this.getScaleZoom(Hs,$),Wt&&($=Math.round($/(Wt/100))*(Wt/100),$=b?Math.ceil($/Wt)*Wt:Math.floor($/Wt)*Wt),Math.max(Z,Math.min(ce,$))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ut(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,b){var M=this._getTopLeftPoint(u,b);return new xe(M,M.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,b){var M=this.options.crs;return b=b===void 0?this._zoom:b,M.scale(u)/M.scale(b)},getScaleZoom:function(u,b){var M=this.options.crs;b=b===void 0?this._zoom:b;var $=M.zoom(u*M.scale(b));return isNaN($)?1/0:$},project:function(u,b){return b=b===void 0?this._zoom:b,this.options.crs.latLngToPoint(Pt(u),b)},unproject:function(u,b){return b=b===void 0?this._zoom:b,this.options.crs.pointToLatLng(ot(u),b)},layerPointToLatLng:function(u){var b=ot(u).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(u){var b=this.project(Pt(u))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(Pt(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(rt(u))},distance:function(u,b){return this.options.crs.distance(Pt(u),Pt(b))},containerPointToLayerPoint:function(u){return ot(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return ot(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var b=this.containerPointToLayerPoint(ot(u));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Pt(u)))},mouseEventToContainerPoint:function(u){return jo(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var b=this._container=Ao(u);if(b){if(b._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ii(b,"scroll",this._onScroll,this),this._containerId=A(b)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&st.any3d,Bi(u,"leaflet-container"+(st.touch?" leaflet-touch":"")+(st.retina?" leaflet-retina":"")+(st.ielt9?" leaflet-oldie":"")+(st.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=xa(u,"position");b!=="absolute"&&b!=="relative"&&b!=="fixed"&&b!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Gn(this._mapPane,new ut(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Bi(u.markerPane,"leaflet-zoom-hide"),Bi(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,b,M){Gn(this._mapPane,new ut(0,0));var $=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var Z=this._zoom!==b;this._moveStart(Z,M)._move(u,b)._moveEnd(Z),this.fire("viewreset"),$&&this.fire("load")},_moveStart:function(u,b){return u&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(u,b,M,$){b===void 0&&(b=this._zoom);var Z=this._zoom!==b;return this._zoom=b,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),$?M&&M.pinch&&this.fire("zoom",M):((Z||M&&M.pinch)&&this.fire("zoom",M),this.fire("move",M)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Ye(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){Gn(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[A(this._container)]=this;var b=u?jn:Ii;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),st.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Ye(this._resizeRequest),this._resizeRequest=lt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,b){for(var M=[],$,Z=b==="mouseout"||b==="mouseover",ce=u.target||u.srcElement,Ce=!1;ce;){if($=this._targets[A(ce)],$&&(b==="click"||b==="preclick")&&this._draggableMoved($)){Ce=!0;break}if($&&$.listens(b,!0)&&(Z&&!Vs(ce,u)||(M.push($),Z))||ce===this._container)break;ce=ce.parentNode}return!M.length&&!Ce&&!Z&&this.listens(b,!0)&&(M=[this]),M},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var b=u.target||u.srcElement;if(!(!this._loaded||b._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(b))){var M=u.type;M==="mousedown"&&zl(b),this._fireDOMEvent(u,M)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,b,M){if(u.type==="click"){var $=f({},u);$.type="preclick",this._fireDOMEvent($,$.type,M)}var Z=this._findEventTargets(u,b);if(M){for(var ce=[],Ce=0;Ce<M.length;Ce++)M[Ce].listens(b,!0)&&ce.push(M[Ce]);Z=ce.concat(Z)}if(Z.length){b==="contextmenu"&&bs(u);var Xe=Z[0],dt={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var wt=Xe.getLatLng&&(!Xe._radius||Xe._radius<=10);dt.containerPoint=wt?this.latLngToContainerPoint(Xe.getLatLng()):this.mouseEventToContainerPoint(u),dt.layerPoint=this.containerPointToLayerPoint(dt.containerPoint),dt.latlng=wt?Xe.getLatLng():this.layerPointToLatLng(dt.layerPoint)}for(Ce=0;Ce<Z.length;Ce++)if(Z[Ce].fire(b,dt,!0),dt.originalEvent._stopped||Z[Ce].options.bubblingMouseEvents===!1&&me(this._mouseEvents,b)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,b=this._handlers.length;u<b;u++)this._handlers[u].disable()},whenReady:function(u,b){return this._loaded?u.call(b||this,{target:this}):this.on("load",u,b),this},_getMapPanePos:function(){return Vr(this._mapPane)||new ut(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,b){var M=u&&b!==void 0?this._getNewPixelOrigin(u,b):this.getPixelOrigin();return M.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,b){var M=this.getSize()._divideBy(2);return this.project(u,b)._subtract(M)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,b,M){var $=this._getNewPixelOrigin(M,b);return this.project(u,b)._subtract($)},_latLngBoundsToNewLayerBounds:function(u,b,M){var $=this._getNewPixelOrigin(M,b);return Le([this.project(u.getSouthWest(),b)._subtract($),this.project(u.getNorthWest(),b)._subtract($),this.project(u.getSouthEast(),b)._subtract($),this.project(u.getNorthEast(),b)._subtract($)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,b,M){if(!M)return u;var $=this.project(u,b),Z=this.getSize().divideBy(2),ce=new xe($.subtract(Z),$.add(Z)),Ce=this._getBoundsOffset(ce,M,b);return Math.abs(Ce.x)<=1&&Math.abs(Ce.y)<=1?u:this.unproject($.add(Ce),b)},_limitOffset:function(u,b){if(!b)return u;var M=this.getPixelBounds(),$=new xe(M.min.add(u),M.max.add(u));return u.add(this._getBoundsOffset($,b))},_getBoundsOffset:function(u,b,M){var $=Le(this.project(b.getNorthEast(),M),this.project(b.getSouthWest(),M)),Z=$.min.subtract(u.min),ce=$.max.subtract(u.max),Ce=this._rebound(Z.x,-ce.x),Xe=this._rebound(Z.y,-ce.y);return new ut(Ce,Xe)},_rebound:function(u,b){return u+b>0?Math.round(u-b)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(b))},_limitZoom:function(u){var b=this.getMinZoom(),M=this.getMaxZoom(),$=st.any3d?this.options.zoomSnap:1;return $&&(u=Math.round(u/$)*$),Math.max(b,Math.min(M,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){An(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,b){var M=this._getCenterOffset(u)._trunc();return(b&&b.animate)!==!0&&!this.getSize().contains(M)?!1:(this.panBy(M,b),!0)},_createAnimProxy:function(){var u=this._proxy=ki("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(b){var M=Co,$=this._proxy.style[M];ba(this._proxy,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),$===this._proxy.style[M]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){In(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),b=this.getZoom();ba(this._proxy,this.project(u,b),this.getZoomScale(b,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,b,M){if(this._animatingZoom)return!0;if(M=M||{},!this._zoomAnimated||M.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var $=this.getZoomScale(b),Z=this._getCenterOffset(u)._divideBy(1-1/$);return M.animate!==!0&&!this.getSize().contains(Z)?!1:(lt(function(){this._moveStart(!0,M.noMoveStart||!1)._animateZoom(u,b,!0)},this),!0)},_animateZoom:function(u,b,M,$){this._mapPane&&(M&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=b,Bi(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:b,noUpdate:$}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(y(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&An(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function $a(u,b){return new Ki(u,b)}var $i=et.extend({options:{position:"topright"},initialize:function(u){J(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var b=this._map;return b&&b.removeControl(this),this.options.position=u,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var b=this._container=this.onAdd(u),M=this.getPosition(),$=u._controlCorners[M];return Bi(b,"leaflet-control"),M.indexOf("bottom")!==-1?$.insertBefore(b,$.firstChild):$.appendChild(b),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(In(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),oa=function(u){return new $i(u)};Ki.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},b="leaflet-",M=this._controlContainer=ki("div",b+"control-container",this._container);function $(Z,ce){var Ce=b+Z+" "+b+ce;u[Z+ce]=ki("div",Ce,M)}$("top","left"),$("top","right"),$("bottom","left"),$("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)In(this._controlCorners[u]);In(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var tc=$i.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,b,M,$){return M<$?-1:$<M?1:0}},initialize:function(u,b,M){J(this,M),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var $ in u)this._addLayer(u[$],$);for($ in b)this._addLayer(b[$],$,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return $i.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,b){return this._addLayer(u,b),this._map?this._update():this},addOverlay:function(u,b){return this._addLayer(u,b,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var b=this._getLayer(A(u));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){Bi(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?(Bi(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):An(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return An(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",b=this._container=ki("div",u),M=this.options.collapsed;b.setAttribute("aria-haspopup",!0),Jo(b),Ba(b);var $=this._section=ki("section",u+"-list");M&&(this._map.on("click",this.collapse,this),Ii(b,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=ki("a",u+"-toggle",b);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),Ii(Z,{keydown:function(ce){ce.keyCode===13&&this._expandSafely()},click:function(ce){bs(ce),this._expandSafely()}},this),M||this.expand(),this._baseLayersList=ki("div",u+"-base",$),this._separator=ki("div",u+"-separator",$),this._overlaysList=ki("div",u+"-overlays",$),b.appendChild($)},_getLayer:function(u){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&A(this._layers[b].layer)===u)return this._layers[b]},_addLayer:function(u,b,M){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:b,overlay:M}),this.options.sortLayers&&this._layers.sort(y(function($,Z){return this.options.sortFunction($.layer,Z.layer,$.name,Z.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;gs(this._baseLayersList),gs(this._overlaysList),this._layerControlInputs=[];var u,b,M,$,Z=0;for(M=0;M<this._layers.length;M++)$=this._layers[M],this._addItem($),b=b||$.overlay,u=u||!$.overlay,Z+=$.overlay?0:1;return this.options.hideSingleBase&&(u=u&&Z>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=b&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var b=this._getLayer(A(u.target)),M=b.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;M&&this._map.fire(M,b)},_createRadioElement:function(u,b){var M='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(b?' checked="checked"':"")+"/>",$=document.createElement("div");return $.innerHTML=M,$.firstChild},_addItem:function(u){var b=document.createElement("label"),M=this._map.hasLayer(u.layer),$;u.overlay?($=document.createElement("input"),$.type="checkbox",$.className="leaflet-control-layers-selector",$.defaultChecked=M):$=this._createRadioElement("leaflet-base-layers_"+A(this),M),this._layerControlInputs.push($),$.layerId=A(u.layer),Ii($,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+u.name;var ce=document.createElement("span");b.appendChild(ce),ce.appendChild($),ce.appendChild(Z);var Ce=u.overlay?this._overlaysList:this._baseLayersList;return Ce.appendChild(b),this._checkDisabledLayers(),b},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,b,M,$=[],Z=[];this._handlingClick=!0;for(var ce=u.length-1;ce>=0;ce--)b=u[ce],M=this._getLayer(b.layerId).layer,b.checked?$.push(M):b.checked||Z.push(M);for(ce=0;ce<Z.length;ce++)this._map.hasLayer(Z[ce])&&this._map.removeLayer(Z[ce]);for(ce=0;ce<$.length;ce++)this._map.hasLayer($[ce])||this._map.addLayer($[ce]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,b,M,$=this._map.getZoom(),Z=u.length-1;Z>=0;Z--)b=u[Z],M=this._getLayer(b.layerId).layer,b.disabled=M.options.minZoom!==void 0&&$<M.options.minZoom||M.options.maxZoom!==void 0&&$>M.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,Ii(u,"click",bs),this.expand();var b=this;setTimeout(function(){jn(u,"click",bs),b._preventClick=!1})}}),el=function(u,b,M){return new tc(u,b,M)},_u=$i.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var b="leaflet-control-zoom",M=ki("div",b+" leaflet-bar"),$=this.options;return this._zoomInButton=this._createButton($.zoomInText,$.zoomInTitle,b+"-in",M,this._zoomIn),this._zoomOutButton=this._createButton($.zoomOutText,$.zoomOutTitle,b+"-out",M,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),M},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,b,M,$,Z){var ce=ki("a",M,$);return ce.innerHTML=u,ce.href="#",ce.title=b,ce.setAttribute("role","button"),ce.setAttribute("aria-label",b),Jo(ce),Ii(ce,"click",aa),Ii(ce,"click",Z,this),Ii(ce,"click",this._refocusOnMap,this),ce},_updateDisabled:function(){var u=this._map,b="leaflet-disabled";An(this._zoomInButton,b),An(this._zoomOutButton,b),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&(Bi(this._zoomOutButton,b),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&(Bi(this._zoomInButton,b),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ki.mergeOptions({zoomControl:!0}),Ki.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new _u,this.addControl(this.zoomControl))});var eh=function(u){return new _u(u)},th=$i.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var b="leaflet-control-scale",M=ki("div",b),$=this.options;return this._addScales($,b+"-line",M),u.on($.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),M},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,b,M){u.metric&&(this._mScale=ki("div",b,M)),u.imperial&&(this._iScale=ki("div",b,M))},_update:function(){var u=this._map,b=u.getSize().y/2,M=u.distance(u.containerPointToLatLng([0,b]),u.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(M)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var b=this._getRoundNum(u),M=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,M,b/u)},_updateImperial:function(u){var b=u*3.2808399,M,$,Z;b>5280?(M=b/5280,$=this._getRoundNum(M),this._updateScale(this._iScale,$+" mi",$/M)):(Z=this._getRoundNum(b),this._updateScale(this._iScale,Z+" ft",Z/b))},_updateScale:function(u,b,M){u.style.width=Math.round(this.options.maxWidth*M)+"px",u.innerHTML=b},_getRoundNum:function(u){var b=Math.pow(10,(Math.floor(u)+"").length-1),M=u/b;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:1,b*M}}),Oc=function(u){return new th(u)},vu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Nc=$i.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(st.inlineSvg?vu+" ":"")+"Leaflet</a>"},initialize:function(u){J(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=ki("div","leaflet-control-attribution"),Jo(this._container);for(var b in u._layers)u._layers[b].getAttribution&&this.addAttribution(u._layers[b].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var b in this._attributions)this._attributions[b]&&u.push(b);var M=[];this.options.prefix&&M.push(this.options.prefix),u.length&&M.push(u.join(", ")),this._container.innerHTML=M.join(' <span aria-hidden="true">|</span> ')}}});Ki.mergeOptions({attributionControl:!0}),Ki.addInitHook(function(){this.options.attributionControl&&new Nc().addTo(this)});var ih=function(u){return new Nc(u)};$i.Layers=tc,$i.Zoom=_u,$i.Scale=th,$i.Attribution=Nc,oa.layers=el,oa.zoom=eh,oa.scale=Oc,oa.attribution=ih;var Sa=et.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Sa.addTo=function(u,b){return u.addHandler(b,this),this};var nh={Events:Be},co=st.touch?"touchstart mousedown":"mousedown",uo=ct.extend({options:{clickTolerance:3},initialize:function(u,b,M,$){J(this,$),this._element=u,this._dragStartTarget=b||u,this._preventOutline=M},enable:function(){this._enabled||(Ii(this._dragStartTarget,co,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(uo._dragging===this&&this.finishDrag(!0),jn(this._dragStartTarget,co,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!Fr(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){uo._dragging===this&&this.finishDrag();return}if(!(uo._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(uo._dragging=this,this._preventOutline&&zl(this._element),lo(),Mo(),!this._moving)){this.fire("down");var b=u.touches?u.touches[0]:u,M=Po(this._element);this._startPoint=new ut(b.clientX,b.clientY),this._startPos=Vr(this._element),this._parentScale=Fs(M);var $=u.type==="mousedown";Ii(document,$?"mousemove":"touchmove",this._onMove,this),Ii(document,$?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var b=u.touches&&u.touches.length===1?u.touches[0]:u,M=new ut(b.clientX,b.clientY)._subtract(this._startPoint);!M.x&&!M.y||Math.abs(M.x)+Math.abs(M.y)<this.options.clickTolerance||(M.x/=this._parentScale.x,M.y/=this._parentScale.y,bs(u),this._moved||(this.fire("dragstart"),this._moved=!0,Bi(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Bi(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(M),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),Gn(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){An(document.body,"leaflet-dragging"),this._lastTarget&&(An(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),jn(document,"mousemove touchmove",this._onMove,this),jn(document,"mouseup touchend touchcancel",this._onUp,this),Ll(),qr();var b=this._moved&&this._moving;this._moving=!1,uo._dragging=!1,b&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function sh(u,b,M){var $,Z=[1,4,2,8],ce,Ce,Xe,dt,wt,Wt,xi,nn;for(ce=0,Wt=u.length;ce<Wt;ce++)u[ce]._code=xr(u[ce],b);for(Xe=0;Xe<4;Xe++){for(xi=Z[Xe],$=[],ce=0,Wt=u.length,Ce=Wt-1;ce<Wt;Ce=ce++)dt=u[ce],wt=u[Ce],dt._code&xi?wt._code&xi||(nn=il(wt,dt,xi,b,M),nn._code=xr(nn,b),$.push(nn)):(wt._code&xi&&(nn=il(wt,dt,xi,b,M),nn._code=xr(nn,b),$.push(nn)),$.push(dt));u=$}return u}function xu(u,b){var M,$,Z,ce,Ce,Xe,dt,wt,Wt;if(!u||u.length===0)throw new Error("latlngs not passed");Ir(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var xi=Pt([0,0]),nn=rt(u),Hs=nn.getNorthWest().distanceTo(nn.getSouthWest())*nn.getNorthEast().distanceTo(nn.getNorthWest());Hs<1700&&(xi=tl(u));var ws=u.length,Tr=[];for(M=0;M<ws;M++){var _n=Pt(u[M]);Tr.push(b.project(Pt([_n.lat-xi.lat,_n.lng-xi.lng])))}for(Xe=dt=wt=0,M=0,$=ws-1;M<ws;$=M++)Z=Tr[M],ce=Tr[$],Ce=Z.y*ce.x-ce.y*Z.x,dt+=(Z.x+ce.x)*Ce,wt+=(Z.y+ce.y)*Ce,Xe+=Ce*3;Xe===0?Wt=Tr[0]:Wt=[dt/Xe,wt/Xe];var Yi=b.unproject(ot(Wt));return Pt([Yi.lat+xi.lat,Yi.lng+xi.lng])}function tl(u){for(var b=0,M=0,$=0,Z=0;Z<u.length;Z++){var ce=Pt(u[Z]);b+=ce.lat,M+=ce.lng,$++}return Pt([b/$,M/$])}var bu={__proto__:null,clipPolygon:sh,polygonCenter:xu,centroid:tl};function ic(u,b){if(!b||!u.length)return u.slice();var M=b*b;return u=ah(u,M),u=wu(u,M),u}function rh(u,b,M){return Math.sqrt(nl(u,b,M,!0))}function Kh(u,b,M){return nl(u,b,M)}function wu(u,b){var M=u.length,$=typeof Uint8Array<"u"?Uint8Array:Array,Z=new $(M);Z[0]=Z[M-1]=1,Bc(u,Z,b,0,M-1);var ce,Ce=[];for(ce=0;ce<M;ce++)Z[ce]&&Ce.push(u[ce]);return Ce}function Bc(u,b,M,$,Z){var ce=0,Ce,Xe,dt;for(Xe=$+1;Xe<=Z-1;Xe++)dt=nl(u[Xe],u[$],u[Z],!0),dt>ce&&(Ce=Xe,ce=dt);ce>M&&(b[Ce]=1,Bc(u,b,M,$,Ce),Bc(u,b,M,Ce,Z))}function ah(u,b){for(var M=[u[0]],$=1,Z=0,ce=u.length;$<ce;$++)Tu(u[$],u[Z])>b&&(M.push(u[$]),Z=$);return Z<ce-1&&M.push(u[ce-1]),M}var $c;function Su(u,b,M,$,Z){var ce=$?$c:xr(u,M),Ce=xr(b,M),Xe,dt,wt;for($c=Ce;;){if(!(ce|Ce))return[u,b];if(ce&Ce)return!1;Xe=ce||Ce,dt=il(u,b,Xe,M,Z),wt=xr(dt,M),Xe===ce?(u=dt,ce=wt):(b=dt,Ce=wt)}}function il(u,b,M,$,Z){var ce=b.x-u.x,Ce=b.y-u.y,Xe=$.min,dt=$.max,wt,Wt;return M&8?(wt=u.x+ce*(dt.y-u.y)/Ce,Wt=dt.y):M&4?(wt=u.x+ce*(Xe.y-u.y)/Ce,Wt=Xe.y):M&2?(wt=dt.x,Wt=u.y+Ce*(dt.x-u.x)/ce):M&1&&(wt=Xe.x,Wt=u.y+Ce*(Xe.x-u.x)/ce),new ut(wt,Wt,Z)}function xr(u,b){var M=0;return u.x<b.min.x?M|=1:u.x>b.max.x&&(M|=2),u.y<b.min.y?M|=4:u.y>b.max.y&&(M|=8),M}function Tu(u,b){var M=b.x-u.x,$=b.y-u.y;return M*M+$*$}function nl(u,b,M,$){var Z=b.x,ce=b.y,Ce=M.x-Z,Xe=M.y-ce,dt=Ce*Ce+Xe*Xe,wt;return dt>0&&(wt=((u.x-Z)*Ce+(u.y-ce)*Xe)/dt,wt>1?(Z=M.x,ce=M.y):wt>0&&(Z+=Ce*wt,ce+=Xe*wt)),Ce=u.x-Z,Xe=u.y-ce,$?Ce*Ce+Xe*Xe:new ut(Z,ce)}function Ir(u){return!le(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function sl(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ir(u)}function Lo(u,b){var M,$,Z,ce,Ce,Xe,dt,wt;if(!u||u.length===0)throw new Error("latlngs not passed");Ir(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Wt=Pt([0,0]),xi=rt(u),nn=xi.getNorthWest().distanceTo(xi.getSouthWest())*xi.getNorthEast().distanceTo(xi.getNorthWest());nn<1700&&(Wt=tl(u));var Hs=u.length,ws=[];for(M=0;M<Hs;M++){var Tr=Pt(u[M]);ws.push(b.project(Pt([Tr.lat-Wt.lat,Tr.lng-Wt.lng])))}for(M=0,$=0;M<Hs-1;M++)$+=ws[M].distanceTo(ws[M+1])/2;if($===0)wt=ws[0];else for(M=0,ce=0;M<Hs-1;M++)if(Ce=ws[M],Xe=ws[M+1],Z=Ce.distanceTo(Xe),ce+=Z,ce>$){dt=(ce-$)/Z,wt=[Xe.x-dt*(Xe.x-Ce.x),Xe.y-dt*(Xe.y-Ce.y)];break}var _n=b.unproject(ot(wt));return Pt([_n.lat+Wt.lat,_n.lng+Wt.lng])}var rl={__proto__:null,simplify:ic,pointToSegmentDistance:rh,closestPointOnSegment:Kh,clipSegment:Su,_getEdgeIntersection:il,_getBitCode:xr,_sqClosestPointOnSegment:nl,isFlat:Ir,_flat:sl,polylineCenter:Lo},Dl={project:function(u){return new ut(u.lng,u.lat)},unproject:function(u){return new gt(u.y,u.x)},bounds:new xe([-180,-90],[180,90])},Uc={R:6378137,R_MINOR:6356752314245179e-9,bounds:new xe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var b=Math.PI/180,M=this.R,$=u.lat*b,Z=this.R_MINOR/M,ce=Math.sqrt(1-Z*Z),Ce=ce*Math.sin($),Xe=Math.tan(Math.PI/4-$/2)/Math.pow((1-Ce)/(1+Ce),ce/2);return $=-M*Math.log(Math.max(Xe,1e-10)),new ut(u.lng*b*M,$)},unproject:function(u){for(var b=180/Math.PI,M=this.R,$=this.R_MINOR/M,Z=Math.sqrt(1-$*$),ce=Math.exp(-u.y/M),Ce=Math.PI/2-2*Math.atan(ce),Xe=0,dt=.1,wt;Xe<15&&Math.abs(dt)>1e-7;Xe++)wt=Z*Math.sin(Ce),wt=Math.pow((1-wt)/(1+wt),Z/2),dt=Math.PI/2-2*Math.atan(ce*wt)-Ce,Ce+=dt;return new gt(Ce*b,u.x*b/M)}},fs={__proto__:null,LonLat:Dl,Mercator:Uc,SphericalMercator:Vi},oh=f({},ei,{code:"EPSG:3395",projection:Uc,transformation:(function(){var u=.5/(Math.PI*Uc.R);return zi(u,.5,-u,.5)})()}),qi=f({},ei,{code:"EPSG:4326",projection:Dl,transformation:zi(1/180,1,-1/180,.5)}),ho=f({},Ot,{projection:Dl,transformation:zi(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,b){var M=b.lng-u.lng,$=b.lat-u.lat;return Math.sqrt(M*M+$*$)},infinite:!0});Ot.Earth=ei,Ot.EPSG3395=oh,Ot.EPSG3857=gn,Ot.EPSG900913=ln,Ot.EPSG4326=qi,Ot.Simple=ho;var hn=ct.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[A(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[A(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var b=u.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var M=this.getEvents();b.on(M,this),this.once("remove",function(){b.off(M,this)},this)}this.onAdd(b),this.fire("add"),b.fire("layeradd",{layer:this})}}});Ki.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var b=A(u);return this._layers[b]?this:(this._layers[b]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var b=A(u);return this._layers[b]?(this._loaded&&u.onRemove(this),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return A(u)in this._layers},eachLayer:function(u,b){for(var M in this._layers)u.call(b,this._layers[M]);return this},_addLayers:function(u){u=u?le(u)?u:[u]:[];for(var b=0,M=u.length;b<M;b++)this.addLayer(u[b])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[A(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var b=A(u);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,b=-1/0,M=this._getZoomSpan();for(var $ in this._zoomBoundLayers){var Z=this._zoomBoundLayers[$].options;u=Z.minZoom===void 0?u:Math.min(u,Z.minZoom),b=Z.maxZoom===void 0?b:Math.max(b,Z.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=u===1/0?void 0:u,M!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var wn=hn.extend({initialize:function(u,b){J(this,b),this._layers={};var M,$;if(u)for(M=0,$=u.length;M<$;M++)this.addLayer(u[M])},addLayer:function(u){var b=this.getLayerId(u);return this._layers[b]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var b=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(u){var b=typeof u=="number"?u:this.getLayerId(u);return b in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var b=Array.prototype.slice.call(arguments,1),M,$;for(M in this._layers)$=this._layers[M],$[u]&&$[u].apply($,b);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,b){for(var M in this._layers)u.call(b,this._layers[M]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return A(u)}}),al=function(u,b){return new wn(u,b)},Lr=wn.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),wn.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),wn.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new tt;for(var b in this._layers){var M=this._layers[b];u.extend(M.getBounds?M.getBounds():M.getLatLng())}return u}}),Ol=function(u,b){return new Lr(u,b)},la=et.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){J(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,b){var M=this._getIconUrl(u);if(!M){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var $=this._createImg(M,b&&b.tagName==="IMG"?b:null);return this._setIconStyles($,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&($.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),$},_setIconStyles:function(u,b){var M=this.options,$=M[b+"Size"];typeof $=="number"&&($=[$,$]);var Z=ot($),ce=ot(b==="shadow"&&M.shadowAnchor||M.iconAnchor||Z&&Z.divideBy(2,!0));u.className="leaflet-marker-"+b+" "+(M.className||""),ce&&(u.style.marginLeft=-ce.x+"px",u.style.marginTop=-ce.y+"px"),Z&&(u.style.width=Z.x+"px",u.style.height=Z.y+"px")},_createImg:function(u,b){return b=b||document.createElement("img"),b.src=u,b},_getIconUrl:function(u){return st.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function Ta(u){return new la(u)}var Ua=la.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof Ua.imagePath!="string"&&(Ua.imagePath=this._detectIconPath()),(this.options.imagePath||Ua.imagePath)+la.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var b=function(M,$,Z){var ce=$.exec(M);return ce&&ce[Z]};return u=b(u,/^url\((['"])?(.+)\1\)$/,2),u&&b(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=ki("div","leaflet-default-icon-path",document.body),b=xa(u,"background-image")||xa(u,"backgroundImage");if(document.body.removeChild(u),b=this._stripUrl(b),b)return b;var M=document.querySelector('link[href$="leaflet.css"]');return M?M.href.substring(0,M.href.length-11-1):""}}),rr=Sa.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new uo(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Bi(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&An(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var b=this._marker,M=b._map,$=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,ce=Vr(b._icon),Ce=M.getPixelBounds(),Xe=M.getPixelOrigin(),dt=Le(Ce.min._subtract(Xe).add(Z),Ce.max._subtract(Xe).subtract(Z));if(!dt.contains(ce)){var wt=ot((Math.max(dt.max.x,ce.x)-dt.max.x)/(Ce.max.x-dt.max.x)-(Math.min(dt.min.x,ce.x)-dt.min.x)/(Ce.min.x-dt.min.x),(Math.max(dt.max.y,ce.y)-dt.max.y)/(Ce.max.y-dt.max.y)-(Math.min(dt.min.y,ce.y)-dt.min.y)/(Ce.min.y-dt.min.y)).multiplyBy($);M.panBy(wt,{animate:!1}),this._draggable._newPos._add(wt),this._draggable._startPos._add(wt),Gn(b._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=lt(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(Ye(this._panRequest),this._panRequest=lt(this._adjustPan.bind(this,u)))},_onDrag:function(u){var b=this._marker,M=b._shadow,$=Vr(b._icon),Z=b._map.layerPointToLatLng($);M&&Gn(M,$),b._latlng=Z,u.latlng=Z,u.oldLatLng=this._oldLatLng,b.fire("move",u).fire("drag",u)},_onDragEnd:function(u){Ye(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),ol=hn.extend({options:{icon:new Ua,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,b){J(this,b),this._latlng=Pt(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var b=this._latlng;return this._latlng=Pt(u),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),M=u.icon.createIcon(this._icon),$=!1;M!==this._icon&&(this._icon&&this._removeIcon(),$=!0,u.title&&(M.title=u.title),M.tagName==="IMG"&&(M.alt=u.alt||"")),Bi(M,b),u.keyboard&&(M.tabIndex="0",M.setAttribute("role","button")),this._icon=M,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ii(M,"focus",this._panOnFocus,this);var Z=u.icon.createShadow(this._shadow),ce=!1;Z!==this._shadow&&(this._removeShadow(),ce=!0),Z&&(Bi(Z,b),Z.alt=""),this._shadow=Z,u.opacity<1&&this._updateOpacity(),$&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&ce&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&jn(this._icon,"focus",this._panOnFocus,this),In(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&In(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&Gn(this._icon,u),this._shadow&&Gn(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(Bi(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),rr)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new rr(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&On(this._icon,u),this._shadow&&On(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var b=this.options.icon.options,M=b.iconSize?ot(b.iconSize):ot(0,0),$=b.iconAnchor?ot(b.iconAnchor):ot(0,0);u.panInside(this._latlng,{paddingTopLeft:$,paddingBottomRight:M.subtract($)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Fc(u,b){return new ol(u,b)}var ca=hn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return J(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ua=ca.extend({options:{fill:!0,radius:10},initialize:function(u,b){J(this,b),this._latlng=Pt(u),this._radius=this.options.radius},setLatLng:function(u){var b=this._latlng;return this._latlng=Pt(u),this.redraw(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var b=u&&u.radius||this._radius;return ca.prototype.setStyle.call(this,u),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,b=this._radiusY||u,M=this._clickTolerance(),$=[u+M,b+M];this._pxBounds=new xe(this._point.subtract($),this._point.add($))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Nl(u,b){return new ua(u,b)}var zo=ua.extend({initialize:function(u,b,M){if(typeof b=="number"&&(b=f({},M,{radius:b})),J(this,b),this._latlng=Pt(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new tt(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:ca.prototype.setStyle,_project:function(){var u=this._latlng.lng,b=this._latlng.lat,M=this._map,$=M.options.crs;if($.distance===ei.distance){var Z=Math.PI/180,ce=this._mRadius/ei.R/Z,Ce=M.project([b+ce,u]),Xe=M.project([b-ce,u]),dt=Ce.add(Xe).divideBy(2),wt=M.unproject(dt).lat,Wt=Math.acos((Math.cos(ce*Z)-Math.sin(b*Z)*Math.sin(wt*Z))/(Math.cos(b*Z)*Math.cos(wt*Z)))/Z;(isNaN(Wt)||Wt===0)&&(Wt=ce/Math.cos(Math.PI/180*b)),this._point=dt.subtract(M.getPixelOrigin()),this._radius=isNaN(Wt)?0:dt.x-M.project([wt,u-Wt]).x,this._radiusY=dt.y-Ce.y}else{var xi=$.unproject($.project(this._latlng).subtract([this._mRadius,0]));this._point=M.latLngToLayerPoint(this._latlng),this._radius=this._point.x-M.latLngToLayerPoint(xi).x}this._updateBounds()}});function ll(u,b,M){return new zo(u,b,M)}var Hr=ca.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,b){J(this,b),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var b=1/0,M=null,$=nl,Z,ce,Ce=0,Xe=this._parts.length;Ce<Xe;Ce++)for(var dt=this._parts[Ce],wt=1,Wt=dt.length;wt<Wt;wt++){Z=dt[wt-1],ce=dt[wt];var xi=$(u,Z,ce,!0);xi<b&&(b=xi,M=$(u,Z,ce))}return M&&(M.distance=Math.sqrt(b)),M},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Lo(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,b){return b=b||this._defaultShape(),u=Pt(u),b.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new tt,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return Ir(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var b=[],M=Ir(u),$=0,Z=u.length;$<Z;$++)M?(b[$]=Pt(u[$]),this._bounds.extend(b[$])):b[$]=this._convertLatLngs(u[$]);return b},_project:function(){var u=new xe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),b=new ut(u,u);this._rawPxBounds&&(this._pxBounds=new xe([this._rawPxBounds.min.subtract(b),this._rawPxBounds.max.add(b)]))},_projectLatlngs:function(u,b,M){var $=u[0]instanceof gt,Z=u.length,ce,Ce;if($){for(Ce=[],ce=0;ce<Z;ce++)Ce[ce]=this._map.latLngToLayerPoint(u[ce]),M.extend(Ce[ce]);b.push(Ce)}else for(ce=0;ce<Z;ce++)this._projectLatlngs(u[ce],b,M)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var b=this._parts,M,$,Z,ce,Ce,Xe,dt;for(M=0,Z=0,ce=this._rings.length;M<ce;M++)for(dt=this._rings[M],$=0,Ce=dt.length;$<Ce-1;$++)Xe=Su(dt[$],dt[$+1],u,$,!0),Xe&&(b[Z]=b[Z]||[],b[Z].push(Xe[0]),(Xe[1]!==dt[$+1]||$===Ce-2)&&(b[Z].push(Xe[1]),Z++))}},_simplifyPoints:function(){for(var u=this._parts,b=this.options.smoothFactor,M=0,$=u.length;M<$;M++)u[M]=ic(u[M],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,b){var M,$,Z,ce,Ce,Xe,dt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(M=0,ce=this._parts.length;M<ce;M++)for(Xe=this._parts[M],$=0,Ce=Xe.length,Z=Ce-1;$<Ce;Z=$++)if(!(!b&&$===0)&&rh(u,Xe[Z],Xe[$])<=dt)return!0;return!1}});function Vc(u,b){return new Hr(u,b)}Hr._flat=sl;var Ea=Hr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var b=Hr.prototype._convertLatLngs.call(this,u),M=b.length;return M>=2&&b[0]instanceof gt&&b[0].equals(b[M-1])&&b.pop(),b},_setLatLngs:function(u){Hr.prototype._setLatLngs.call(this,u),Ir(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ir(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,b=this.options.weight,M=new ut(b,b);if(u=new xe(u.min.subtract(M),u.max.add(M)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var $=0,Z=this._rings.length,ce;$<Z;$++)ce=sh(this._rings[$],u,!0),ce.length&&this._parts.push(ce)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var b=!1,M,$,Z,ce,Ce,Xe,dt,wt;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(ce=0,dt=this._parts.length;ce<dt;ce++)for(M=this._parts[ce],Ce=0,wt=M.length,Xe=wt-1;Ce<wt;Xe=Ce++)$=M[Ce],Z=M[Xe],$.y>u.y!=Z.y>u.y&&u.x<(Z.x-$.x)*(u.y-$.y)/(Z.y-$.y)+$.x&&(b=!b);return b||Hr.prototype._containsPoint.call(this,u,!0)}});function Bl(u,b){return new Ea(u,b)}var Fa=Lr.extend({initialize:function(u,b){J(this,b),this._layers={},u&&this.addData(u)},addData:function(u){var b=le(u)?u:u.features,M,$,Z;if(b){for(M=0,$=b.length;M<$;M++)Z=b[M],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var ce=this.options;if(ce.filter&&!ce.filter(u))return this;var Ce=qs(u,ce);return Ce?(Ce.feature=ul(u),Ce.defaultOptions=Ce.options,this.resetStyle(Ce),ce.onEachFeature&&ce.onEachFeature(u,Ce),this.addLayer(Ce)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=f({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(b){this._setLayerStyle(b,u)},this)},_setLayerStyle:function(u,b){u.setStyle&&(typeof b=="function"&&(b=b(u.feature)),u.setStyle(b))}});function qs(u,b){var M=u.type==="Feature"?u.geometry:u,$=M?M.coordinates:null,Z=[],ce=b&&b.pointToLayer,Ce=b&&b.coordsToLatLng||cl,Xe,dt,wt,Wt;if(!$&&!M)return null;switch(M.type){case"Point":return Xe=Ce($),tn(ce,u,Xe,b);case"MultiPoint":for(wt=0,Wt=$.length;wt<Wt;wt++)Xe=Ce($[wt]),Z.push(tn(ce,u,Xe,b));return new Lr(Z);case"LineString":case"MultiLineString":return dt=nc($,M.type==="LineString"?0:1,Ce),new Hr(dt,b);case"Polygon":case"MultiPolygon":return dt=nc($,M.type==="Polygon"?1:2,Ce),new Ea(dt,b);case"GeometryCollection":for(wt=0,Wt=M.geometries.length;wt<Wt;wt++){var xi=qs({geometry:M.geometries[wt],type:"Feature",properties:u.properties},b);xi&&Z.push(xi)}return new Lr(Z);case"FeatureCollection":for(wt=0,Wt=M.features.length;wt<Wt;wt++){var nn=qs(M.features[wt],b);nn&&Z.push(nn)}return new Lr(Z);default:throw new Error("Invalid GeoJSON object.")}}function tn(u,b,M,$){return u?u(b,M):new ol(M,$&&$.markersInheritOptions&&$)}function cl(u){return new gt(u[1],u[0],u[2])}function nc(u,b,M){for(var $=[],Z=0,ce=u.length,Ce;Z<ce;Z++)Ce=b?nc(u[Z],b-1,M):(M||cl)(u[Z]),$.push(Ce);return $}function sc(u,b){return u=Pt(u),u.alt!==void 0?[V(u.lng,b),V(u.lat,b),V(u.alt,b)]:[V(u.lng,b),V(u.lat,b)]}function Va(u,b,M,$){for(var Z=[],ce=0,Ce=u.length;ce<Ce;ce++)Z.push(b?Va(u[ce],Ir(u[ce])?0:b-1,M,$):sc(u[ce],$));return!b&&M&&Z.length>0&&Z.push(Z[0].slice()),Z}function fo(u,b){return u.feature?f({},u.feature,{geometry:b}):ul(b)}function ul(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var po={toGeoJSON:function(u){return fo(this,{type:"Point",coordinates:sc(this.getLatLng(),u)})}};ol.include(po),zo.include(po),ua.include(po),Hr.include({toGeoJSON:function(u){var b=!Ir(this._latlngs),M=Va(this._latlngs,b?1:0,!1,u);return fo(this,{type:(b?"Multi":"")+"LineString",coordinates:M})}}),Ea.include({toGeoJSON:function(u){var b=!Ir(this._latlngs),M=b&&!Ir(this._latlngs[0]),$=Va(this._latlngs,M?2:b?1:0,!0,u);return b||($=[$]),fo(this,{type:(M?"Multi":"")+"Polygon",coordinates:$})}}),wn.include({toMultiPoint:function(u){var b=[];return this.eachLayer(function(M){b.push(M.toGeoJSON(u).geometry.coordinates)}),fo(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(u){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(b==="MultiPoint")return this.toMultiPoint(u);var M=b==="GeometryCollection",$=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var ce=Z.toGeoJSON(u);if(M)$.push(ce.geometry);else{var Ce=ul(ce);Ce.type==="FeatureCollection"?$.push.apply($,Ce.features):$.push(Ce)}}}),M?fo(this,{geometries:$,type:"GeometryCollection"}):{type:"FeatureCollection",features:$}}});function rc(u,b){return new Fa(u,b)}var Ro=rc,mo=hn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,b,M){this._url=u,this._bounds=rt(b),J(this,M)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Bi(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){In(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&cn(this._image),this},bringToBack:function(){return this._map&&Oa(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=rt(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",b=this._image=u?this._url:ki("img");if(Bi(b,"leaflet-image-layer"),this._zoomAnimated&&Bi(b,"leaflet-zoom-animated"),this.options.className&&Bi(b,this.options.className),b.onselectstart=N,b.onmousemove=N,b.onload=y(this.fire,this,"load"),b.onerror=y(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=b.src;return}b.src=this._url,b.alt=this.options.alt},_animateZoom:function(u){var b=this._map.getZoomScale(u.zoom),M=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;ba(this._image,M,b)},_reset:function(){var u=this._image,b=new xe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),M=b.getSize();Gn(u,b.min),u.style.width=M.x+"px",u.style.height=M.y+"px"},_updateOpacity:function(){On(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),hl=function(u,b,M){return new mo(u,b,M)},Zr=mo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",b=this._image=u?this._url:ki("video");if(Bi(b,"leaflet-image-layer"),this._zoomAnimated&&Bi(b,"leaflet-zoom-animated"),this.options.className&&Bi(b,this.options.className),b.onselectstart=N,b.onmousemove=N,b.onloadeddata=y(this.fire,this,"load"),u){for(var M=b.getElementsByTagName("source"),$=[],Z=0;Z<M.length;Z++)$.push(M[Z].src);this._url=M.length>0?$:[b.src];return}le(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(b.style,"objectFit")&&(b.style.objectFit="fill"),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,b.muted=!!this.options.muted,b.playsInline=!!this.options.playsInline;for(var ce=0;ce<this._url.length;ce++){var Ce=ki("source");Ce.src=this._url[ce],b.appendChild(Ce)}}});function ka(u,b,M){return new Zr(u,b,M)}var $l=mo.extend({_initImage:function(){var u=this._image=this._url;Bi(u,"leaflet-image-layer"),this._zoomAnimated&&Bi(u,"leaflet-zoom-animated"),this.options.className&&Bi(u,this.options.className),u.onselectstart=N,u.onmousemove=N}});function dl(u,b,M){return new $l(u,b,M)}var As=hn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,b){u&&(u instanceof gt||le(u))?(this._latlng=Pt(u),J(this,b)):(J(this,u),this._source=b),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&On(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&On(this._container,1),this.bringToFront(),this.options.interactive&&(Bi(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(On(this._container,0),this._removeTimeout=setTimeout(y(In,void 0,this._container),200)):In(this._container),this.options.interactive&&(An(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=Pt(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&cn(this._container),this},bringToBack:function(){return this._map&&Oa(this._container),this},_prepareOpen:function(u){var b=this._source;if(!b._map)return!1;if(b instanceof Lr){b=null;var M=this._source._layers;for(var $ in M)if(M[$]._map){b=M[$];break}if(!b)return!1;this._source=b}if(!u)if(b.getCenter)u=b.getCenter();else if(b.getLatLng)u=b.getLatLng();else if(b.getBounds)u=b.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,b=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof b=="string")u.innerHTML=b;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),b=ot(this.options.offset),M=this._getAnchor();this._zoomAnimated?Gn(this._container,u.add(M)):b=b.add(u).add(M);var $=this._containerBottom=-b.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=$+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});Ki.include({_initOverlay:function(u,b,M,$){var Z=b;return Z instanceof u||(Z=new u($).setContent(b)),M&&Z.setLatLng(M),Z}}),hn.include({_initOverlay:function(u,b,M,$){var Z=M;return Z instanceof u?(J(Z,$),Z._source=this):(Z=b&&!$?b:new u($,this),Z.setContent(M)),Z}});var Do=As.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,As.prototype.openOn.call(this,u)},onAdd:function(u){As.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ca||this._source.on("preclick",ra))},onRemove:function(u){As.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ca||this._source.off("preclick",ra))},getEvents:function(){var u=As.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",b=this._container=ki("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),M=this._wrapper=ki("div",u+"-content-wrapper",b);if(this._contentNode=ki("div",u+"-content",M),Jo(b),Ba(this._contentNode),Ii(b,"contextmenu",ra),this._tipContainer=ki("div",u+"-tip-container",b),this._tip=ki("div",u+"-tip",this._tipContainer),this.options.closeButton){var $=this._closeButton=ki("a",u+"-close-button",b);$.setAttribute("role","button"),$.setAttribute("aria-label","Close popup"),$.href="#close",$.innerHTML='<span aria-hidden="true">&#215;</span>',Ii($,"click",function(Z){bs(Z),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,b=u.style;b.width="",b.whiteSpace="nowrap";var M=u.offsetWidth;M=Math.min(M,this.options.maxWidth),M=Math.max(M,this.options.minWidth),b.width=M+1+"px",b.whiteSpace="",b.height="";var $=u.offsetHeight,Z=this.options.maxHeight,ce="leaflet-popup-scrolled";Z&&$>Z?(b.height=Z+"px",Bi(u,ce)):An(u,ce),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),M=this._getAnchor();Gn(this._container,b.add(M))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,b=parseInt(xa(this._container,"marginBottom"),10)||0,M=this._container.offsetHeight+b,$=this._containerWidth,Z=new ut(this._containerLeft,-M-this._containerBottom);Z._add(Vr(this._container));var ce=u.layerPointToContainerPoint(Z),Ce=ot(this.options.autoPanPadding),Xe=ot(this.options.autoPanPaddingTopLeft||Ce),dt=ot(this.options.autoPanPaddingBottomRight||Ce),wt=u.getSize(),Wt=0,xi=0;ce.x+$+dt.x>wt.x&&(Wt=ce.x+$-wt.x+dt.x),ce.x-Wt-Xe.x<0&&(Wt=ce.x-Xe.x),ce.y+M+dt.y>wt.y&&(xi=ce.y+M-wt.y+dt.y),ce.y-xi-Xe.y<0&&(xi=ce.y-Xe.y),(Wt||xi)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([Wt,xi]))}},_getAnchor:function(){return ot(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ac=function(u,b){return new Do(u,b)};Ki.mergeOptions({closePopupOnClick:!0}),Ki.include({openPopup:function(u,b,M){return this._initOverlay(Do,u,b,M).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),hn.include({bindPopup:function(u,b){return this._popup=this._initOverlay(Do,this._popup,u,b),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof Lr||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){aa(u);var b=u.layer||u.target;if(this._popup._source===b&&!(b instanceof ca)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=b,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var fl=As.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){As.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){As.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=As.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",b=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ki("div",b),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+A(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var b,M,$=this._map,Z=this._container,ce=$.latLngToContainerPoint($.getCenter()),Ce=$.layerPointToContainerPoint(u),Xe=this.options.direction,dt=Z.offsetWidth,wt=Z.offsetHeight,Wt=ot(this.options.offset),xi=this._getAnchor();Xe==="top"?(b=dt/2,M=wt):Xe==="bottom"?(b=dt/2,M=0):Xe==="center"?(b=dt/2,M=wt/2):Xe==="right"?(b=0,M=wt/2):Xe==="left"?(b=dt,M=wt/2):Ce.x<ce.x?(Xe="right",b=0,M=wt/2):(Xe="left",b=dt+(Wt.x+xi.x)*2,M=wt/2),u=u.subtract(ot(b,M,!0)).add(Wt).add(xi),An(Z,"leaflet-tooltip-right"),An(Z,"leaflet-tooltip-left"),An(Z,"leaflet-tooltip-top"),An(Z,"leaflet-tooltip-bottom"),Bi(Z,"leaflet-tooltip-"+Xe),Gn(Z,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&On(this._container,u)},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(b)},_getAnchor:function(){return ot(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Jh=function(u,b){return new fl(u,b)};Ki.include({openTooltip:function(u,b,M){return this._initOverlay(fl,u,b,M).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),hn.include({bindTooltip:function(u,b){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(fl,this._tooltip,u,b),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var b=u?"off":"on",M={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?M.add=this._openTooltip:(M.mouseover=this._openTooltip,M.mouseout=this.closeTooltip,M.click=this._openTooltip,this._map?this._addFocusListeners():M.add=this._addFocusListeners),this._tooltip.options.sticky&&(M.mousemove=this._moveTooltip),this[b](M),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof Lr||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var b=typeof u.getElement=="function"&&u.getElement();b&&(Ii(b,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),Ii(b,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var b=typeof u.getElement=="function"&&u.getElement();b&&b.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var b=this;this._map.once("moveend",function(){b._openOnceFlag=!1,b._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var b=u.latlng,M,$;this._tooltip.options.sticky&&u.originalEvent&&(M=this._map.mouseEventToContainerPoint(u.originalEvent),$=this._map.containerPointToLayerPoint(M),b=this._map.layerPointToLatLng($)),this._tooltip.setLatLng(b)}});var Eu=la.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var b=u&&u.tagName==="DIV"?u:document.createElement("div"),M=this.options;if(M.html instanceof Element?(gs(b),b.appendChild(M.html)):b.innerHTML=M.html!==!1?M.html:"",M.bgPos){var $=ot(M.bgPos);b.style.backgroundPosition=-$.x+"px "+-$.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});function qc(u){return new Eu(u)}la.Default=Ua;var Oo=hn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:st.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){J(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),In(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(cn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Oa(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=j(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof ut?u:new ut(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var b=this.getPane().children,M=-u(-1/0,1/0),$=0,Z=b.length,ce;$<Z;$++)ce=b[$].style.zIndex,b[$]!==this._container&&ce&&(M=u(M,+ce));isFinite(M)&&(this.options.zIndex=M+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!st.ielt9){On(this._container,this.options.opacity);var u=+new Date,b=!1,M=!1;for(var $ in this._tiles){var Z=this._tiles[$];if(!(!Z.current||!Z.loaded)){var ce=Math.min(1,(u-Z.loaded)/200);On(Z.el,ce),ce<1?b=!0:(Z.active?M=!0:this._onOpaqueTile(Z),Z.active=!0)}}M&&!this._noPrune&&this._pruneTiles(),b&&(Ye(this._fadeFrame),this._fadeFrame=lt(this._updateOpacity,this))}},_onOpaqueTile:N,_initContainer:function(){this._container||(this._container=ki("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,b=this.options.maxZoom;if(u!==void 0){for(var M in this._levels)M=Number(M),this._levels[M].el.children.length||M===u?(this._levels[M].el.style.zIndex=b-Math.abs(u-M),this._onUpdateLevel(M)):(In(this._levels[M].el),this._removeTilesAtZoom(M),this._onRemoveLevel(M),delete this._levels[M]);var $=this._levels[u],Z=this._map;return $||($=this._levels[u]={},$.el=ki("div","leaflet-tile-container leaflet-zoom-animated",this._container),$.el.style.zIndex=b,$.origin=Z.project(Z.unproject(Z.getPixelOrigin()),u).round(),$.zoom=u,this._setZoomTransform($,Z.getCenter(),Z.getZoom()),N($.el.offsetWidth),this._onCreateLevel($)),this._level=$,$}},_onUpdateLevel:N,_onRemoveLevel:N,_onCreateLevel:N,_pruneTiles:function(){if(this._map){var u,b,M=this._map.getZoom();if(M>this.options.maxZoom||M<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)b=this._tiles[u],b.retain=b.current;for(u in this._tiles)if(b=this._tiles[u],b.current&&!b.active){var $=b.coords;this._retainParent($.x,$.y,$.z,$.z-5)||this._retainChildren($.x,$.y,$.z,$.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var b in this._tiles)this._tiles[b].coords.z===u&&this._removeTile(b)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)In(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,b,M,$){var Z=Math.floor(u/2),ce=Math.floor(b/2),Ce=M-1,Xe=new ut(+Z,+ce);Xe.z=+Ce;var dt=this._tileCoordsToKey(Xe),wt=this._tiles[dt];return wt&&wt.active?(wt.retain=!0,!0):(wt&&wt.loaded&&(wt.retain=!0),Ce>$?this._retainParent(Z,ce,Ce,$):!1)},_retainChildren:function(u,b,M,$){for(var Z=2*u;Z<2*u+2;Z++)for(var ce=2*b;ce<2*b+2;ce++){var Ce=new ut(Z,ce);Ce.z=M+1;var Xe=this._tileCoordsToKey(Ce),dt=this._tiles[Xe];if(dt&&dt.active){dt.retain=!0;continue}else dt&&dt.loaded&&(dt.retain=!0);M+1<$&&this._retainChildren(Z,ce,M+1,$)}},_resetView:function(u){var b=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var b=this.options;return b.minNativeZoom!==void 0&&u<b.minNativeZoom?b.minNativeZoom:b.maxNativeZoom!==void 0&&b.maxNativeZoom<u?b.maxNativeZoom:u},_setView:function(u,b,M,$){var Z=Math.round(b);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var ce=this.options.updateWhenZooming&&Z!==this._tileZoom;(!$||ce)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(u),M||this._pruneTiles(),this._noPrune=!!M),this._setZoomTransforms(u,b)},_setZoomTransforms:function(u,b){for(var M in this._levels)this._setZoomTransform(this._levels[M],u,b)},_setZoomTransform:function(u,b,M){var $=this._map.getZoomScale(M,u.zoom),Z=u.origin.multiplyBy($).subtract(this._map._getNewPixelOrigin(b,M)).round();st.any3d?ba(u.el,Z,$):Gn(u.el,Z)},_resetGrid:function(){var u=this._map,b=u.options.crs,M=this._tileSize=this.getTileSize(),$=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,b.wrapLng[0]],$).x/M.x),Math.ceil(u.project([0,b.wrapLng[1]],$).x/M.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([b.wrapLat[0],0],$).y/M.x),Math.ceil(u.project([b.wrapLat[1],0],$).y/M.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var b=this._map,M=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),$=b.getZoomScale(M,this._tileZoom),Z=b.project(u,this._tileZoom).floor(),ce=b.getSize().divideBy($*2);return new xe(Z.subtract(ce),Z.add(ce))},_update:function(u){var b=this._map;if(b){var M=this._clampZoom(b.getZoom());if(u===void 0&&(u=b.getCenter()),this._tileZoom!==void 0){var $=this._getTiledPixelBounds(u),Z=this._pxBoundsToTileRange($),ce=Z.getCenter(),Ce=[],Xe=this.options.keepBuffer,dt=new xe(Z.getBottomLeft().subtract([Xe,-Xe]),Z.getTopRight().add([Xe,-Xe]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var wt in this._tiles){var Wt=this._tiles[wt].coords;(Wt.z!==this._tileZoom||!dt.contains(new ut(Wt.x,Wt.y)))&&(this._tiles[wt].current=!1)}if(Math.abs(M-this._tileZoom)>1){this._setView(u,M);return}for(var xi=Z.min.y;xi<=Z.max.y;xi++)for(var nn=Z.min.x;nn<=Z.max.x;nn++){var Hs=new ut(nn,xi);if(Hs.z=this._tileZoom,!!this._isValidTile(Hs)){var ws=this._tiles[this._tileCoordsToKey(Hs)];ws?ws.current=!0:Ce.push(Hs)}}if(Ce.sort(function(_n,Yi){return _n.distanceTo(ce)-Yi.distanceTo(ce)}),Ce.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Tr=document.createDocumentFragment();for(nn=0;nn<Ce.length;nn++)this._addTile(Ce[nn],Tr);this._level.el.appendChild(Tr)}}}},_isValidTile:function(u){var b=this._map.options.crs;if(!b.infinite){var M=this._globalTileRange;if(!b.wrapLng&&(u.x<M.min.x||u.x>M.max.x)||!b.wrapLat&&(u.y<M.min.y||u.y>M.max.y))return!1}if(!this.options.bounds)return!0;var $=this._tileCoordsToBounds(u);return rt(this.options.bounds).overlaps($)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var b=this._map,M=this.getTileSize(),$=u.scaleBy(M),Z=$.add(M),ce=b.unproject($,u.z),Ce=b.unproject(Z,u.z);return[ce,Ce]},_tileCoordsToBounds:function(u){var b=this._tileCoordsToNwSe(u),M=new tt(b[0],b[1]);return this.options.noWrap||(M=this._map.wrapLatLngBounds(M)),M},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var b=u.split(":"),M=new ut(+b[0],+b[1]);return M.z=+b[2],M},_removeTile:function(u){var b=this._tiles[u];b&&(In(b.el),delete this._tiles[u],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){Bi(u,"leaflet-tile");var b=this.getTileSize();u.style.width=b.x+"px",u.style.height=b.y+"px",u.onselectstart=N,u.onmousemove=N,st.ielt9&&this.options.opacity<1&&On(u,this.options.opacity)},_addTile:function(u,b){var M=this._getTilePos(u),$=this._tileCoordsToKey(u),Z=this.createTile(this._wrapCoords(u),y(this._tileReady,this,u));this._initTile(Z),this.createTile.length<2&&lt(y(this._tileReady,this,u,null,Z)),Gn(Z,M),this._tiles[$]={el:Z,coords:u,current:!0},b.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:u})},_tileReady:function(u,b,M){b&&this.fire("tileerror",{error:b,tile:M,coords:u});var $=this._tileCoordsToKey(u);M=this._tiles[$],M&&(M.loaded=+new Date,this._map._fadeAnimated?(On(M.el,0),Ye(this._fadeFrame),this._fadeFrame=lt(this._updateOpacity,this)):(M.active=!0,this._pruneTiles()),b||(Bi(M.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:M.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),st.ielt9||!this._map._fadeAnimated?lt(this._pruneTiles,this):setTimeout(y(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var b=new ut(this._wrapX?B(u.x,this._wrapX):u.x,this._wrapY?B(u.y,this._wrapY):u.y);return b.z=u.z,b},_pxBoundsToTileRange:function(u){var b=this.getTileSize();return new xe(u.min.unscaleBy(b).floor(),u.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function Ul(u){return new Oo(u)}var ha=Oo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,b){this._url=u,b=J(this,b),b.detectRetina&&st.retina&&b.maxZoom>0?(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom=Math.min(b.maxZoom,b.minZoom+1)):(b.zoomOffset++,b.maxZoom=Math.max(b.minZoom,b.maxZoom-1)),b.minZoom=Math.max(0,b.minZoom)):b.zoomReverse?b.minZoom=Math.min(b.maxZoom,b.minZoom):b.maxZoom=Math.max(b.minZoom,b.maxZoom),typeof b.subdomains=="string"&&(b.subdomains=b.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,b){return this._url===u&&b===void 0&&(b=!0),this._url=u,b||this.redraw(),this},createTile:function(u,b){var M=document.createElement("img");return Ii(M,"load",y(this._tileOnLoad,this,b,M)),Ii(M,"error",y(this._tileOnError,this,b,M)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(M.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(M.referrerPolicy=this.options.referrerPolicy),M.alt="",M.src=this.getTileUrl(u),M},getTileUrl:function(u){var b={r:st.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var M=this._globalTileRange.max.y-u.y;this.options.tms&&(b.y=M),b["-y"]=M}return ge(this._url,f(b,this.options))},_tileOnLoad:function(u,b){st.ielt9?setTimeout(y(u,this,null,b),0):u(null,b)},_tileOnError:function(u,b,M){var $=this.options.errorTileUrl;$&&b.getAttribute("src")!==$&&(b.src=$),u(M,b)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,b=this.options.maxZoom,M=this.options.zoomReverse,$=this.options.zoomOffset;return M&&(u=b-u),u+$},_getSubdomain:function(u){var b=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var u,b;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(b=this._tiles[u].el,b.onload=N,b.onerror=N,!b.complete)){b.src=be;var M=this._tiles[u].coords;In(b),delete this._tiles[u],this.fire("tileabort",{tile:b,coords:M})}},_removeTile:function(u){var b=this._tiles[u];if(b)return b.el.setAttribute("src",be),Oo.prototype._removeTile.call(this,u)},_tileReady:function(u,b,M){if(!(!this._map||M&&M.getAttribute("src")===be))return Oo.prototype._tileReady.call(this,u,b,M)}});function Wn(u,b){return new ha(u,b)}var Ca=ha.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,b){this._url=u;var M=f({},this.defaultWmsParams);for(var $ in b)$ in this.options||(M[$]=b[$]);b=J(this,b);var Z=b.detectRetina&&st.retina?2:1,ce=this.getTileSize();M.width=ce.x*Z,M.height=ce.y*Z,this.wmsParams=M},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,ha.prototype.onAdd.call(this,u)},getTileUrl:function(u){var b=this._tileCoordsToNwSe(u),M=this._crs,$=Le(M.project(b[0]),M.project(b[1])),Z=$.min,ce=$.max,Ce=(this._wmsVersion>=1.3&&this._crs===qi?[Z.y,Z.x,ce.y,ce.x]:[Z.x,Z.y,ce.x,ce.y]).join(","),Xe=ha.prototype.getTileUrl.call(this,u);return Xe+ye(this.wmsParams,Xe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ce},setParams:function(u,b){return f(this.wmsParams,u),b||this.redraw(),this}});function Gr(u,b){return new Ca(u,b)}ha.WMS=Ca,Wn.wms=Gr;var br=hn.extend({options:{padding:.1},initialize:function(u){J(this,u),A(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Bi(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,b){var M=this._map.getZoomScale(b,this._zoom),$=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,b),ce=$.multiplyBy(-M).add(Z).subtract(this._map._getNewPixelOrigin(u,b));st.any3d?ba(this._container,ce,M):Gn(this._container,ce)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,b=this._map.getSize(),M=this._map.containerPointToLayerPoint(b.multiplyBy(-u)).round();this._bounds=new xe(M,M.add(b.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ss=br.extend({options:{tolerance:0},getEvents:function(){var u=br.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){br.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");Ii(u,"mousemove",this._onMouseMove,this),Ii(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ii(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){Ye(this._redrawRequest),delete this._ctx,In(this._container),jn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var b in this._layers)u=this._layers[b],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){br.prototype._update.call(this);var u=this._bounds,b=this._container,M=u.getSize(),$=st.retina?2:1;Gn(b,u.min),b.width=$*M.x,b.height=$*M.y,b.style.width=M.x+"px",b.style.height=M.y+"px",st.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){br.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[A(u)]=u;var b=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var b=u._order,M=b.next,$=b.prev;M?M.prev=$:this._drawLast=$,$?$.next=M:this._drawFirst=M,delete u._order,delete this._layers[A(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var b=u.options.dashArray.split(/[, ]+/),M=[],$,Z;for(Z=0;Z<b.length;Z++){if($=Number(b[Z]),isNaN($))return;M.push($)}u.options._dashArray=M}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||lt(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var b=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new xe,this._redrawBounds.extend(u._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(u._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var b=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,b.x,b.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,b=this._redrawBounds;if(this._ctx.save(),b){var M=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,M.x,M.y),this._ctx.clip()}this._drawing=!0;for(var $=this._drawFirst;$;$=$.next)u=$.layer,(!b||u._pxBounds&&u._pxBounds.intersects(b))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,b){if(this._drawing){var M,$,Z,ce,Ce=u._parts,Xe=Ce.length,dt=this._ctx;if(Xe){for(dt.beginPath(),M=0;M<Xe;M++){for($=0,Z=Ce[M].length;$<Z;$++)ce=Ce[M][$],dt[$?"lineTo":"moveTo"](ce.x,ce.y);b&&dt.closePath()}this._fillStroke(dt,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var b=u._point,M=this._ctx,$=Math.max(Math.round(u._radius),1),Z=(Math.max(Math.round(u._radiusY),1)||$)/$;Z!==1&&(M.save(),M.scale(1,Z)),M.beginPath(),M.arc(b.x,b.y/Z,$,0,Math.PI*2,!1),Z!==1&&M.restore(),this._fillStroke(M,u)}},_fillStroke:function(u,b){var M=b.options;M.fill&&(u.globalAlpha=M.fillOpacity,u.fillStyle=M.fillColor||M.color,u.fill(M.fillRule||"evenodd")),M.stroke&&M.weight!==0&&(u.setLineDash&&u.setLineDash(b.options&&b.options._dashArray||[]),u.globalAlpha=M.opacity,u.lineWidth=M.weight,u.strokeStyle=M.color,u.lineCap=M.lineCap,u.lineJoin=M.lineJoin,u.stroke())},_onClick:function(u){for(var b=this._map.mouseEventToLayerPoint(u),M,$,Z=this._drawFirst;Z;Z=Z.next)M=Z.layer,M.options.interactive&&M._containsPoint(b)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(M))&&($=M);this._fireEvent($?[$]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var b=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,b)}},_handleMouseOut:function(u){var b=this._hoveredLayer;b&&(An(this._container,"leaflet-interactive"),this._fireEvent([b],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,b){if(!this._mouseHoverThrottled){for(var M,$,Z=this._drawFirst;Z;Z=Z.next)M=Z.layer,M.options.interactive&&M._containsPoint(b)&&($=M);$!==this._hoveredLayer&&(this._handleMouseOut(u),$&&(Bi(this._container,"leaflet-interactive"),this._fireEvent([$],u,"mouseover"),this._hoveredLayer=$)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(y(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,b,M){this._map._fireDOMEvent(b,M||b.type,u)},_bringToFront:function(u){var b=u._order;if(b){var M=b.next,$=b.prev;if(M)M.prev=$;else return;$?$.next=M:M&&(this._drawFirst=M),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(u)}},_bringToBack:function(u){var b=u._order;if(b){var M=b.next,$=b.prev;if($)$.next=M;else return;M?M.prev=$:$&&(this._drawLast=$),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(u)}}});function wr(u){return st.canvas?new ss(u):null}var Ms=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),pl={_initContainer:function(){this._container=ki("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(br.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var b=u._container=Ms("shape");Bi(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",u._path=Ms("path"),b.appendChild(u._path),this._updateStyle(u),this._layers[A(u)]=u},_addPath:function(u){var b=u._container;this._container.appendChild(b),u.options.interactive&&u.addInteractiveTarget(b)},_removePath:function(u){var b=u._container;In(b),u.removeInteractiveTarget(b),delete this._layers[A(u)]},_updateStyle:function(u){var b=u._stroke,M=u._fill,$=u.options,Z=u._container;Z.stroked=!!$.stroke,Z.filled=!!$.fill,$.stroke?(b||(b=u._stroke=Ms("stroke")),Z.appendChild(b),b.weight=$.weight+"px",b.color=$.color,b.opacity=$.opacity,$.dashArray?b.dashStyle=le($.dashArray)?$.dashArray.join(" "):$.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=$.lineCap.replace("butt","flat"),b.joinstyle=$.lineJoin):b&&(Z.removeChild(b),u._stroke=null),$.fill?(M||(M=u._fill=Ms("fill")),Z.appendChild(M),M.color=$.fillColor||$.color,M.opacity=$.fillOpacity):M&&(Z.removeChild(M),u._fill=null)},_updateCircle:function(u){var b=u._point.round(),M=Math.round(u._radius),$=Math.round(u._radiusY||M);this._setPath(u,u._empty()?"M0 0":"AL "+b.x+","+b.y+" "+M+","+$+" 0,"+65535*360)},_setPath:function(u,b){u._path.v=b},_bringToFront:function(u){cn(u._container)},_bringToBack:function(u){Oa(u._container)}},da=st.vml?Ms:$n,go=br.extend({_initContainer:function(){this._container=da("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=da("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){In(this._container),jn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){br.prototype._update.call(this);var u=this._bounds,b=u.getSize(),M=this._container;(!this._svgSize||!this._svgSize.equals(b))&&(this._svgSize=b,M.setAttribute("width",b.x),M.setAttribute("height",b.y)),Gn(M,u.min),M.setAttribute("viewBox",[u.min.x,u.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(u){var b=u._path=da("path");u.options.className&&Bi(b,u.options.className),u.options.interactive&&Bi(b,"leaflet-interactive"),this._updateStyle(u),this._layers[A(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){In(u._path),u.removeInteractiveTarget(u._path),delete this._layers[A(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var b=u._path,M=u.options;b&&(M.stroke?(b.setAttribute("stroke",M.color),b.setAttribute("stroke-opacity",M.opacity),b.setAttribute("stroke-width",M.weight),b.setAttribute("stroke-linecap",M.lineCap),b.setAttribute("stroke-linejoin",M.lineJoin),M.dashArray?b.setAttribute("stroke-dasharray",M.dashArray):b.removeAttribute("stroke-dasharray"),M.dashOffset?b.setAttribute("stroke-dashoffset",M.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),M.fill?(b.setAttribute("fill",M.fillColor||M.color),b.setAttribute("fill-opacity",M.fillOpacity),b.setAttribute("fill-rule",M.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(u,b){this._setPath(u,it(u._parts,b))},_updateCircle:function(u){var b=u._point,M=Math.max(Math.round(u._radius),1),$=Math.max(Math.round(u._radiusY),1)||M,Z="a"+M+","+$+" 0 1,0 ",ce=u._empty()?"M0 0":"M"+(b.x-M)+","+b.y+Z+M*2+",0 "+Z+-M*2+",0 ";this._setPath(u,ce)},_setPath:function(u,b){u._path.setAttribute("d",b)},_bringToFront:function(u){cn(u._path)},_bringToBack:function(u){Oa(u._path)}});st.vml&&go.include(pl);function qa(u){return st.svg||st.vml?new go(u):null}Ki.include({getRenderer:function(u){var b=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var b=this._paneRenderers[u];return b===void 0&&(b=this._createRenderer({pane:u}),this._paneRenderers[u]=b),b},_createRenderer:function(u){return this.options.preferCanvas&&wr(u)||qa(u)}});var Sr=Ea.extend({initialize:function(u,b){Ea.prototype.initialize.call(this,this._boundsToLatLngs(u),b)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=rt(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function ku(u,b){return new Sr(u,b)}go.create=da,go.pointsToPath=it,Fa.geometryToLayer=qs,Fa.coordsToLatLng=cl,Fa.coordsToLatLngs=nc,Fa.latLngToCoords=sc,Fa.latLngsToCoords=Va,Fa.getFeature=fo,Fa.asFeature=ul,Ki.mergeOptions({boxZoom:!0});var Js=Sa.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){Ii(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){jn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){In(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Mo(),lo(),this._startPoint=this._map.mouseEventToContainerPoint(u),Ii(document,{contextmenu:aa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=ki("div","leaflet-zoom-box",this._container),Bi(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var b=new xe(this._point,this._startPoint),M=b.getSize();Gn(this._box,b.min),this._box.style.width=M.x+"px",this._box.style.height=M.y+"px"},_finish:function(){this._moved&&(In(this._box),An(this._container,"leaflet-crosshair")),qr(),Ll(),jn(document,{contextmenu:aa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(y(this._resetState,this),0);var b=new tt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ki.addInitHook("addHandler","boxZoom",Js),Ki.mergeOptions({doubleClickZoom:!0});var Fl=Sa.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var b=this._map,M=b.getZoom(),$=b.options.zoomDelta,Z=u.originalEvent.shiftKey?M-$:M+$;b.options.doubleClickZoom==="center"?b.setZoom(Z):b.setZoomAround(u.containerPoint,Z)}});Ki.addInitHook("addHandler","doubleClickZoom",Fl),Ki.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Wr=Sa.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new uo(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}Bi(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){An(this._map._container,"leaflet-grab"),An(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=rt(this._map.options.maxBounds);this._offsetLimit=Le(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var b=this._lastTime=+new Date,M=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(M),this._times.push(b),this._prunePositions(b)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,b){return u-(u-b)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;u.x<b.min.x&&(u.x=this._viscousLimit(u.x,b.min.x)),u.y<b.min.y&&(u.y=this._viscousLimit(u.y,b.min.y)),u.x>b.max.x&&(u.x=this._viscousLimit(u.x,b.max.x)),u.y>b.max.y&&(u.y=this._viscousLimit(u.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,b=Math.round(u/2),M=this._initialWorldOffset,$=this._draggable._newPos.x,Z=($-b+M)%u+b-M,ce=($+b+M)%u-b-M,Ce=Math.abs(Z+M)<Math.abs(ce+M)?Z:ce;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ce},_onDragEnd:function(u){var b=this._map,M=b.options,$=!M.inertia||u.noInertia||this._times.length<2;if(b.fire("dragend",u),$)b.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),ce=(this._lastTime-this._times[0])/1e3,Ce=M.easeLinearity,Xe=Z.multiplyBy(Ce/ce),dt=Xe.distanceTo([0,0]),wt=Math.min(M.inertiaMaxSpeed,dt),Wt=Xe.multiplyBy(wt/dt),xi=wt/(M.inertiaDeceleration*Ce),nn=Wt.multiplyBy(-xi/2).round();!nn.x&&!nn.y?b.fire("moveend"):(nn=b._limitOffset(nn,b.options.maxBounds),lt(function(){b.panBy(nn,{duration:xi,easeLinearity:Ce,noMoveStart:!0,animate:!0})}))}}});Ki.addInitHook("addHandler","dragging",Wr),Ki.mergeOptions({keyboard:!0,keyboardPanDelta:80});var oc=Sa.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),Ii(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),jn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,b=document.documentElement,M=u.scrollTop||b.scrollTop,$=u.scrollLeft||b.scrollLeft;this._map._container.focus(),window.scrollTo($,M)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var b=this._panKeys={},M=this.keyCodes,$,Z;for($=0,Z=M.left.length;$<Z;$++)b[M.left[$]]=[-1*u,0];for($=0,Z=M.right.length;$<Z;$++)b[M.right[$]]=[u,0];for($=0,Z=M.down.length;$<Z;$++)b[M.down[$]]=[0,u];for($=0,Z=M.up.length;$<Z;$++)b[M.up[$]]=[0,-1*u]},_setZoomDelta:function(u){var b=this._zoomKeys={},M=this.keyCodes,$,Z;for($=0,Z=M.zoomIn.length;$<Z;$++)b[M.zoomIn[$]]=u;for($=0,Z=M.zoomOut.length;$<Z;$++)b[M.zoomOut[$]]=-u},_addHooks:function(){Ii(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){jn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var b=u.keyCode,M=this._map,$;if(b in this._panKeys){if(!M._panAnim||!M._panAnim._inProgress)if($=this._panKeys[b],u.shiftKey&&($=ot($).multiplyBy(3)),M.options.maxBounds&&($=M._limitOffset(ot($),M.options.maxBounds)),M.options.worldCopyJump){var Z=M.wrapLatLng(M.unproject(M.project(M.getCenter()).add($)));M.panTo(Z)}else M.panBy($)}else if(b in this._zoomKeys)M.setZoom(M.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[b]);else if(b===27&&M._popup&&M._popup.options.closeOnEscapeKey)M.closePopup();else return;aa(u)}}});Ki.addInitHook("addHandler","keyboard",oc),Ki.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ml=Sa.extend({addHooks:function(){Ii(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){jn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var b=Ks(u),M=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var $=Math.max(M-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(y(this._performZoom,this),$),aa(u)},_performZoom:function(){var u=this._map,b=u.getZoom(),M=this._map.options.zoomSnap||0;u._stop();var $=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs($))))/Math.LN2,ce=M?Math.ceil(Z/M)*M:Z,Ce=u._limitZoom(b+(this._delta>0?ce:-ce))-b;this._delta=0,this._startTime=null,Ce&&(u.options.scrollWheelZoom==="center"?u.setZoom(b+Ce):u.setZoomAround(this._lastMousePos,b+Ce))}});Ki.addInitHook("addHandler","scrollWheelZoom",ml);var Yr=600;Ki.mergeOptions({tapHold:st.touchNative&&st.safari&&st.mobile,tapTolerance:15});var gl=Sa.extend({addHooks:function(){Ii(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){jn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var b=u.touches[0];this._startPos=this._newPos=new ut(b.clientX,b.clientY),this._holdTimeout=setTimeout(y(function(){this._cancel(),this._isTapValid()&&(Ii(document,"touchend",bs),Ii(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",b))},this),Yr),Ii(document,"touchend touchcancel contextmenu",this._cancel,this),Ii(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){jn(document,"touchend",bs),jn(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),jn(document,"touchend touchcancel contextmenu",this._cancel,this),jn(document,"touchmove",this._onMove,this)},_onMove:function(u){var b=u.touches[0];this._newPos=new ut(b.clientX,b.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,b){var M=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY});M._simulated=!0,b.target.dispatchEvent(M)}});Ki.addInitHook("addHandler","tapHold",gl),Ki.mergeOptions({touchZoom:st.touch,bounceAtZoomLimits:!0});var yl=Sa.extend({addHooks:function(){Bi(this._map._container,"leaflet-touch-zoom"),Ii(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){An(this._map._container,"leaflet-touch-zoom"),jn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var b=this._map;if(!(!u.touches||u.touches.length!==2||b._animatingZoom||this._zooming)){var M=b.mouseEventToContainerPoint(u.touches[0]),$=b.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),b.options.touchZoom!=="center"&&(this._pinchStartLatLng=b.containerPointToLatLng(M.add($)._divideBy(2))),this._startDist=M.distanceTo($),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),Ii(document,"touchmove",this._onTouchMove,this),Ii(document,"touchend touchcancel",this._onTouchEnd,this),bs(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var b=this._map,M=b.mouseEventToContainerPoint(u.touches[0]),$=b.mouseEventToContainerPoint(u.touches[1]),Z=M.distanceTo($)/this._startDist;if(this._zoom=b.getScaleZoom(Z,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&Z<1||this._zoom>b.getMaxZoom()&&Z>1)&&(this._zoom=b._limitZoom(this._zoom)),b.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var ce=M._add($)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&ce.x===0&&ce.y===0)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(ce),this._zoom)}this._moved||(b._moveStart(!0,!1),this._moved=!0),Ye(this._animRequest);var Ce=y(b._move,b,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=lt(Ce,this,!0),bs(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Ye(this._animRequest),jn(document,"touchmove",this._onTouchMove,this),jn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ki.addInitHook("addHandler","touchZoom",yl),Ki.BoxZoom=Js,Ki.DoubleClickZoom=Fl,Ki.Drag=Wr,Ki.Keyboard=oc,Ki.ScrollWheelZoom=ml,Ki.TapHold=gl,Ki.TouchZoom=yl,r.Bounds=xe,r.Browser=st,r.CRS=Ot,r.Canvas=ss,r.Circle=zo,r.CircleMarker=ua,r.Class=et,r.Control=$i,r.DivIcon=Eu,r.DivOverlay=As,r.DomEvent=Dc,r.DomUtil=Ds,r.Draggable=uo,r.Evented=ct,r.FeatureGroup=Lr,r.GeoJSON=Fa,r.GridLayer=Oo,r.Handler=Sa,r.Icon=la,r.ImageOverlay=mo,r.LatLng=gt,r.LatLngBounds=tt,r.Layer=hn,r.LayerGroup=wn,r.LineUtil=rl,r.Map=Ki,r.Marker=ol,r.Mixin=nh,r.Path=ca,r.Point=ut,r.PolyUtil=bu,r.Polygon=Ea,r.Polyline=Hr,r.Popup=Do,r.PosAnimation=Io,r.Projection=fs,r.Rectangle=Sr,r.Renderer=br,r.SVG=go,r.SVGOverlay=$l,r.TileLayer=ha,r.Tooltip=fl,r.Transformation=pi,r.Util=Mt,r.VideoOverlay=Zr,r.bind=y,r.bounds=Le,r.canvas=wr,r.circle=ll,r.circleMarker=Nl,r.control=oa,r.divIcon=qc,r.extend=f,r.featureGroup=Ol,r.geoJSON=rc,r.geoJson=Ro,r.gridLayer=Ul,r.icon=Ta,r.imageOverlay=hl,r.latLng=Pt,r.latLngBounds=rt,r.layerGroup=al,r.map=$a,r.marker=Fc,r.point=ot,r.polygon=Bl,r.polyline=Vc,r.popup=ac,r.rectangle=ku,r.setOptions=J,r.stamp=A,r.svg=qa,r.svgOverlay=dl,r.tileLayer=Wn,r.tooltip=Jh,r.transformation=zi,r.version=l,r.videoOverlay=ka;var lc=window.L;r.noConflict=function(){return window.L=lc,this},window.L=r}))})(Am,Am.exports)),Am.exports}var ig=JS();const tf=Xh(ig);function Wx(t,e,r){return Object.freeze({instance:t,context:e,container:r})}function Yx(t,e){return e==null?function(l,f){const _=ie.useRef(void 0);return _.current||(_.current=t(l,f)),_}:function(l,f){const _=ie.useRef(void 0);_.current||(_.current=t(l,f));const y=ie.useRef(l),{instance:d}=_.current;return ie.useEffect(function(){y.current!==l&&(e(d,l,y.current),y.current=l)},[d,l,e]),_}}function QS(t,e){ie.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function e2(t){return function(r){const l=Zx(),f=t(Gx(r,l),l);return rz(l.map,r.attribution),KS(f.current,r.eventHandlers),QS(f.current,l),f}}function hz(t,e){const r=ie.useRef(void 0);ie.useEffect(function(){if(e.pathOptions!==r.current){const f=e.pathOptions??{};t.instance.setStyle(f),r.current=f}},[t,e])}function dz(t){return function(r){const l=Zx(),f=t(Gx(r,l),l);return KS(f.current,r.eventHandlers),QS(f.current,l),hz(f.current,r),f}}function fz(t,e){const r=Yx(t,e),l=e2(r);return XS(l)}function pz(t,e){const r=Yx(t,e),l=dz(r);return XS(l)}function mz(t,e){const r=Yx(t,e),l=e2(r);return cz(l)}function gz(t,e,r){const{opacity:l,zIndex:f}=e;l!=null&&l!==r.opacity&&t.setOpacity(l),f!=null&&f!==r.zIndex&&t.setZIndex(f)}function gp(){return Zx().map}function t2(t){const e=gp();return ie.useEffect(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}const rw=pz(function({center:e,children:r,...l},f){const _=new ig.CircleMarker(e,l);return Wx(_,YS(f,{overlayContainer:_}))},az);function yz({bounds:t,boundsOptions:e,center:r,children:l,className:f,id:_,placeholder:y,style:d,whenReady:A,zoom:j,...B},N){const[V]=ie.useState({className:f,id:_,style:d}),[Q,ne]=ie.useState(null),J=ie.useRef(void 0);ie.useImperativeHandle(N,()=>Q?.map??null,[Q]);const ye=ie.useCallback(ge=>{if(ge!==null&&!J.current){const le=new ig.Map(ge,B);J.current=le,r!=null&&j!=null?le.setView(r,j):t!=null&&le.fitBounds(t,e),A!=null&&le.whenReady(A),ne(lz(le))}},[]);ie.useEffect(()=>()=>{Q?.map.remove()},[Q]);const re=Q?Nt.createElement(Hx,{value:Q},l):y??null;return Nt.createElement("div",{...V,ref:ye},re)}const Xx=ie.forwardRef(yz),i_=fz(function({position:e,...r},l){const f=new ig.Marker(e,r);return Wx(f,YS(l,{overlayContainer:f}))},function(e,r,l){r.position!==l.position&&e.setLatLng(r.position),r.icon!=null&&r.icon!==l.icon&&e.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==l.zIndexOffset&&e.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==l.opacity&&e.setOpacity(r.opacity),e.dragging!=null&&r.draggable!==l.draggable&&(r.draggable===!0?e.dragging.enable():e.dragging.disable())}),_z=mz(function({url:e,...r},l){const f=new ig.TileLayer(e,Gx(r,l));return Wx(f,l)},function(e,r,l){gz(e,r,l);const{url:f}=r;f!=null&&f!==l.url&&e.setUrl(f)}),Kx=()=>{const t=gp();return ie.useEffect(()=>{const e=t.getContainer();if(!e)return;let r=0;const l=()=>{r&&cancelAnimationFrame(r),r=requestAnimationFrame(()=>{t.invalidateSize();const _=t._maplibreMap;_?.resize&&_.resize()})};l();let f=null;return"ResizeObserver"in window?(f=new ResizeObserver(()=>l()),f.observe(e)):window.addEventListener("resize",l),()=>{f?f.disconnect():window.removeEventListener("resize",l),r&&cancelAnimationFrame(r)}},[t]),null},vz=({center:t,pins:e})=>{const r=gp();return ie.useEffect(()=>{const l=[];t&&l.push([t.lat,t.lng]);for(const _ of e)l.push([_.lat,_.lng]);if(l.length===0)return;const f=tf.latLngBounds(l);r.fitBounds(f,{padding:[18,18],maxZoom:13,animate:!1})},[t,r,e]),null},xz=({center:t,pins:e,onOpenMap:r})=>{const l=ie.useMemo(()=>t?[t.lat,t.lng]:e.length>0?[e[0].lat,e[0].lng]:[37.3891,-5.9845],[t,e]);return S.jsx("section",{className:"space-y-3",children:S.jsx("button",{type:"button",onClick:r,className:"relative w-full overflow-hidden text-left",children:S.jsxs("div",{className:"relative h-44 w-full overflow-hidden bg-black",children:[S.jsx("div",{className:"pointer-events-none absolute inset-0",children:S.jsxs(Xx,{center:l,zoom:12,className:"h-full w-full",zoomControl:!1,dragging:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,keyboard:!1,attributionControl:!1,children:[S.jsx(Kx,{}),S.jsx(_z,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),S.jsx(vz,{center:t,pins:e}),t&&S.jsx(rw,{center:[t.lat,t.lng],radius:6,pathOptions:{color:"#ffffff",fillColor:"#ffffff",fillOpacity:1,weight:2}}),e.map(f=>S.jsx(rw,{center:[f.lat,f.lng],radius:7,pathOptions:{color:"#ff6b4a",fillColor:"#ff6b4a",fillOpacity:.95,weight:2}},f.id))]})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Map"}),S.jsx("p",{className:"mt-1 text-sm font-semibold text-white/90",children:e.length>0?`${e.length} nearby`:"Open the map to explore"})]})]})})})},bz=({loading:t,trending:e,meta:r})=>{const l=Ur();return S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Trending"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Trending this week"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>l.push("/tabs/map"),children:"Explore"})]}),t?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(Ys,{name:"crescent"})}):e.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No trending nights yet"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Open the map to see what people are going to."})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:e.map(f=>{const _=r[f.id],d=[_?.saves?`${_.saves} likes`:null,_?.going?`${_.going} going`:null,_?.attended?`${_.attended} attended`:null,_?.moments?`${_.moments} moments`:null].filter(Boolean).slice(0,2).join("  ");return S.jsx(ec,{event:{...f,cover_image_url:dp(f)},className:"w-[220px] shrink-0",kicker:m_(f.starts_at),title:g_(f),subtitle:f.venue_place?.name||f.city,badge:d||void 0,onSelect:A=>l.push(`/event/${A.id}`)},f.id)})})]})},wz=({loading:t,canFollow:e,followedSubjectIds:r,suggestedArtists:l,suggestedVenues:f,onToggleFollowSubject:_})=>{const y=Ur();return S.jsxs("section",{className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Discover"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Artists & venues"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Follow to keep them close."})]}),t?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(Ys,{name:"crescent"})}):S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Artists"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>y.push("/tabs/discover",{initialTab:"artists"}),children:"Explore"})]}),l.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No suggestions yet."}):S.jsx("div",{className:"space-y-2",children:l.slice(0,6).map(d=>{const A=r.has(d.subject_id);return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:()=>y.push(`/artist/${d.id}`),children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:d.avatar_url?S.jsx("img",{src:d.avatar_url,alt:d.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:d.name}),S.jsxs("p",{className:"text-xs text-white/55",children:[d.upcomingCount," upcoming"]})]})]}),S.jsx("button",{type:"button",className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${A?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,onClick:()=>_(d.subject_id),disabled:!e,children:A?"Following":"Follow"})]},d.id)})})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venues"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>y.push("/tabs/discover",{initialTab:"venues"}),children:"Explore"})]}),f.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No suggestions yet."}):S.jsx("div",{className:"space-y-2",children:f.slice(0,6).map(d=>{const A=r.has(d.subject_id);return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"min-w-0 flex-1 text-left",onClick:()=>y.push(`/venue/${d.id}`),children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:d.name}),S.jsxs("p",{className:"mt-1 text-xs text-white/55",children:[d.city,"  ",d.upcomingCount," upcoming"]})]}),S.jsx("button",{type:"button",className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${A?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,onClick:()=>_(d.subject_id),disabled:!e,children:A?"Following":"Follow"})]},d.id)})})]})]})]})},Sz=({visible:t,events:e})=>{const r=Ur();return t?S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Following"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"From artists you follow"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>r.push("/tabs/map"),children:"Explore"})]}),e.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No upcoming shows from artists you follow"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Open the map to find something new."})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:e.map(l=>S.jsx(ec,{event:{...l,cover_image_url:dp(l)},className:"w-[220px] shrink-0",kicker:m_(l.starts_at),title:g_(l),subtitle:l.venue_place?.name||l.city,onSelect:f=>r.push(`/event/${f.id}`)},l.id))})]}):null},Tz=t=>{const[e,r]=ie.useState([]),[l,f]=ie.useState(!0),[_,y]=ie.useState("");return ie.useEffect(()=>{let d=!1;return f(!0),y(""),yr(`events:list:${t.startIso}:${t.endIso}`,async()=>{const{data:A,error:j}=await Rt.from("events").select(`
            *,
            organizer:profiles!events_organizer_id_fkey (
              id,
              username,
              display_name,
              role
            ),
            venue_place:venue_places!events_venue_place_id_fkey (
              id,
              name,
              city,
              address,
              latitude,
              longitude
            ),
            event_artists (
              artist:artists!event_artists_artist_entity_fk (
                id,
                name,
                avatar_url
              )
            )
          `).gte("starts_at",t.startIso).lte("starts_at",t.endIso).order("starts_at",{ascending:!0});if(j)throw j;return A||[]},{ttlMs:1e4}).then(A=>{d||r(A)}).catch(()=>{d||(y("Could not load events. Check your Supabase connection."),r([]))}).finally(()=>{d||f(!1)}),()=>{d=!0}},[t.endIso,t.startIso]),{events:e,loading:l,error:_}},Ez=(t,e)=>{const[r,l]=ie.useState([]),[f,_]=ie.useState({}),[y,d]=ie.useState(!1);return ie.useEffect(()=>{if(t.length===0){l([]),_({});return}let A=!1;return(async()=>{d(!0);try{const B=new Date(Date.now()-2592e5).toISOString(),[N,V,Q]=await yr(`trending:since:${B}`,async()=>{const[le,me,be]=await Promise.all([Rt.from("event_saves").select("event_id,created_at").gte("created_at",B).limit(1e3),Rt.from("event_attendance").select("event_id,status,created_at").gte("created_at",B).limit(1e3),Rt.from("posts").select("event_id,created_at").gte("created_at",B).limit(1e3)]);return[le.data||[],me.data||[],be.data||[]]},{ttlMs:1e4}),ne={},J=(le,me)=>{ne[le]||={saves:0,going:0,attended:0,moments:0,score:0},ne[le][me]+=1};for(const le of N)le?.event_id&&J(le.event_id,"saves");for(const le of V)le?.event_id&&J(le.event_id,le.status==="attended"?"attended":"going");for(const le of Q)le?.event_id&&J(le.event_id,"moments");for(const[le,me]of Object.entries(ne)){me.score=me.saves*2+me.going*3+me.attended*4+me.moments*4;const be=t.find(Ue=>Ue.id===le);if(!be){me.score=0;continue}const ke=new Date(be.starts_at);ke.getTime()>=e.getTime()-1e3*60*60*24&&ke.getTime()<=e.getTime()+1e3*60*60*24*7||(me.score=0)}const ye=Object.entries(ne).filter(([,le])=>le.score>0).sort((le,me)=>me[1].score-le[1].score).slice(0,6).map(([le])=>le),re=ye.map(le=>t.find(me=>me.id===le)).filter(Boolean),ge={};for(const le of ye){const me=ne[le];me&&(ge[le]={saves:me.saves,going:me.going,attended:me.attended,moments:me.moments})}if(A)return;l(re),_(ge)}catch{if(A)return;l([]),_({})}finally{A||d(!1)}})(),()=>{A=!0}},[t,e]),{trending:r,meta:f,loading:y}},kz=(t,e)=>{const[r,l]=ie.useState([]),[f,_]=ie.useState([]),[y,d]=ie.useState(!1);return ie.useEffect(()=>{if(t.length===0){l([]),_([]);return}let A=!1;return(async()=>{d(!0);try{const B=t.filter(re=>{const ge=new Date(re.starts_at);return ge>=e.startOfToday&&ge<=e.endOfEventsWindow}),N=new Map,V=new Map;for(const re of B){for(const ge of re.event_artists||[]){if(!ge?.artist?.id)continue;const le=N.get(ge.artist.id);N.set(ge.artist.id,{id:ge.artist.id,count:(le?.count||0)+1})}if(re.venue_place?.id){const ge=V.get(re.venue_place.id);V.set(re.venue_place.id,{id:re.venue_place.id,name:re.venue_place.name,city:re.venue_place.city,count:(ge?.count||0)+1})}}const Q=Array.from(N.values()).sort((re,ge)=>ge.count-re.count).slice(0,10).map(re=>re.id),ne=await(async()=>{if(Q.length===0)return[];const re=Array.from(new Set(Q)).sort(),ge=re.join(","),le=await yr(`artists:by_ids:${ge}`,async()=>{const{data:be,error:ke}=await Rt.from("v_subject_artists").select("artist_id,name,avatar_url,subject_id").in("artist_id",re);if(ke)throw ke;return be||[]},{ttlMs:6e4}),me=new Map;for(const be of le)be.artist_id&&me.set(be.artist_id,be);return Q.map(be=>{const ke=me.get(be),Me=N.get(be);return!ke?.subject_id||!Me?null:{id:be,subject_id:ke.subject_id,name:ke.name,avatar_url:ke.avatar_url,upcomingCount:Me.count}}).filter(Boolean)})(),J=Array.from(V.values()).sort((re,ge)=>ge.count-re.count).slice(0,10),ye=await yr(`home:suggested:venues:${J.map(re=>re.id).join(",")}`,async()=>{if(J.length===0)return[];const re=J.map(le=>le.id),ge=new Map;try{const{data:le,error:me}=await Rt.from("subjects").select("id,venue_place_id,type").eq("type","venue").in("venue_place_id",re);if(me)throw me;for(const be of le||[]){const ke=be.venue_place_id,Me=be.id;ke&&Me&&ge.set(ke,Me)}}catch{}for(const le of J){if(ge.has(le.id))continue;const me=await yr(`subject:venue:${le.id}`,async()=>{const{data:be,error:ke}=await Rt.rpc("get_or_create_venue_subject",{p_venue_place_id:le.id});if(ke)throw ke;return be},{ttlMs:1440*60*1e3}).catch(()=>null);typeof me=="string"&&ge.set(le.id,me)}return J.map(le=>{const me=ge.get(le.id);return me?{id:le.id,subject_id:me,name:le.name,city:le.city,upcomingCount:le.count}:null}).filter(Boolean)},{ttlMs:3e4});if(A)return;l(ne),_(ye)}catch{if(A)return;l([]),_([])}finally{A||d(!1)}})(),()=>{A=!0}},[t,e.endOfEventsWindow,e.startOfToday]),{suggestedArtists:r,suggestedVenues:f,loading:y}},Cz=t=>{const[e,r]=ie.useState(new Set);return ie.useEffect(()=>{const l=Array.from(t);if(l.length===0){r(new Set);return}let f=!1;return yr(`subjects:artist_ids:${l.sort().join(",")}`,async()=>{const{data:_,error:y}=await Rt.from("subjects").select("id,type,artist_id").in("id",l);if(y)throw y;return(_||[]).filter(d=>d.type==="artist"&&d.artist_id).map(d=>d.artist_id)},{ttlMs:1e4}).then(_=>{f||r(new Set(_))}).catch(()=>{f||r(new Set)}),()=>{f=!0}},[t]),e},i2="live_space.pending_moments.dismissed",Az=()=>{try{const t=window.localStorage.getItem(i2);if(!t)return{};const e=JSON.parse(t);return e&&typeof e=="object"?e:{}}catch{return{}}},Mz=t=>{try{window.localStorage.setItem(i2,JSON.stringify(t))}catch{}},Pz=t=>{const e=new Date(t.starts_at);return t.ends_at?new Date(t.ends_at):new Date(e.getTime()+360*60*1e3)},jz=t=>t<24?"You attended yesterday":t<48?"You attended 2 days ago":"You attended recently",Iz=async(t,e)=>await yr(`posts:count:user:${t}:event:${e}`,async()=>{const{count:l,error:f}=await Rt.from("posts").select("id",{count:"exact",head:!0}).eq("user_id",t).eq("event_id",e);if(f)throw f;return l||0},{ttlMs:1e4})>0,Lz=async t=>yr(`attendance:user:${t}`,async()=>{const{data:e,error:r}=await Rt.from("event_attendance").select("event_id,status,created_at").eq("user_id",t).in("status",["going","attended"]).order("created_at",{ascending:!1}).limit(50);if(r)throw r;return e||[]},{ttlMs:1e4}),zz=async t=>yr(`event:detail:${t}`,async()=>{const{data:e,error:r}=await Rt.from("events").select(`
          *,
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `).eq("id",t).maybeSingle();if(r)throw r;return e||null},{ttlMs:6e4}),Rz=t=>{const{user:e}=va(),r=e?.id||null,l=t.now?t.now.getTime():null,[f,_]=ie.useState({});ie.useEffect(()=>{_(Az())},[]);const y=V=>{const Q={...f,[V]:Date.now()};_(Q),Mz(Q)},[d,A]=ie.useState({kind:"loading"}),[j,B]=ie.useState(null);ie.useEffect(()=>{if(!r){A({kind:"cold_start"}),B(null);return}let V=!1;return(async()=>{A({kind:"loading"}),B(null);try{const ne=new Date(l??Date.now()),J=await Lz(r);if(V)return;const ye=new Map;for(const Me of t.events)ye.set(Me.id,Me);const re=async Me=>{const Ue=ye.get(Me);if(Ue)return Ue;const Fe=await zz(Me);return Fe&&ye.set(Me,Fe),Fe},ge=J.filter(Me=>Me.status==="attended"),le=[];for(const Me of ge){const Ue=await re(Me.event_id);if(!Ue)continue;const Fe=Pz(Ue),He=(ne.getTime()-Fe.getTime())/(1e3*60*60);He<0||He>72||le.push({event:Ue,hoursSinceEnd:He})}le.sort((Me,Ue)=>Me.hoursSinceEnd-Ue.hoursSinceEnd);const me=async()=>{const Me=J.filter(Fe=>Fe.status==="going"),Ue=[];for(const Fe of Me){const He=await re(Fe.event_id);!He||new Date(He.starts_at).getTime()<ne.getTime()||Ue.push(He)}return Ue.sort((Fe,He)=>new Date(Fe.starts_at).getTime()-new Date(He.starts_at).getTime()),Ue};for(const Me of le){const Ue=f[Me.event.id];if(Ue&&Date.now()-Ue<1e3*60*60*24*7||await Iz(r,Me.event.id))continue;const He=await me();B(He[0]||null);const lt=Me.hoursSinceEnd<=36?"hero":"compact",Ye=jz(Me.hoursSinceEnd);A({kind:"just_attended",event:Me.event,hoursSinceEnd:Me.hoursSinceEnd,timeLabel:Ye,size:lt});return}const be=await me(),ke=be[0]||null;if(B(be[1]||null),ke){A({kind:"upcoming",event:ke});return}A({kind:"cold_start"})}catch{if(V)return;A({kind:"cold_start"}),B(null)}})(),()=>{V=!0}},[f,l,t.events,r]);const N=V=>{r&&VS(`posts:count:user:${r}:event:${V}`)};return ie.useMemo(()=>({hero:d,nextUpcoming:j,dismissPendingMoments:y,refreshMomentsForEvent:N}),[y,d,j])},aw=t=>t.venue_place?.name||t.address||t.city||"Venue",ow=t=>t.event_artists?.find(r=>r.artist)?.artist?.name||t.name,lw=t=>new Date(t).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),Dz=({state:t,onDismissPendingMoments:e})=>{const r=Ur(),l=ie.useMemo(()=>{if(t.kind==="loading")return S.jsx("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("div",{className:"h-8 w-3/4 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-3 h-4 w-1/2 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-2 h-3 w-1/3 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-5 h-11 w-full animate-pulse rounded bg-white/10"})]})});if(t.kind==="cold_start")return S.jsx("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:"Discover concerts near you"}),S.jsxs("div",{className:"mt-5 flex items-center gap-3",children:[S.jsx("button",{type:"button",className:"rounded bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>r.push("/tabs/map"),children:"Explore map"}),S.jsx("button",{type:"button",className:"rounded bg-white/10 px-4 py-2 text-sm font-semibold text-white/90",onClick:()=>r.push("/tabs/discover"),children:"Discover"})]})]})});if(t.kind==="upcoming"){const A=dp(t.event),j=ow(t.event),B=aw(t.event),N=lw(t.event.starts_at);return S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[A?S.jsx("img",{src:A,alt:t.event.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Youre going to"}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:j}),S.jsx("p",{className:"mt-2 text-sm font-semibold uppercase tracking-[0.18em] text-white/80",children:B}),S.jsx("p",{className:"mt-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:N}),S.jsx("div",{className:"mt-5",children:S.jsx("button",{type:"button",className:"w-full rounded bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>r.push(`/event/${t.event.id}`),children:"View event"})})]})]})}const f=dp(t.event),_=ow(t.event),y=aw(t.event),d=lw(t.event.starts_at);return S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[f?S.jsx("img",{src:f,alt:t.event.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),e&&S.jsx("button",{type:"button",className:"absolute right-4 top-4 z-10 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>e(t.event.id),children:"Dismiss"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:["Last night at ",y]}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:_}),S.jsx("p",{className:"mt-2 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:d}),S.jsx("div",{className:"mt-5",children:S.jsx("button",{type:"button",className:"w-full rounded bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white",onClick:()=>r.push(`/event/${t.event.id}`,{openAddMoments:!0}),children:"Add your moments"})})]})]})},[r,e,t]);return S.jsx("section",{children:l})},Oz=50,Nz=4,Bz=()=>{const t=Ur(),{canCreateEvent:e}=sf(),r=ie.useMemo(()=>{const et=new Date;return et.setHours(0,0,0,0),et},[]),l=ie.useMemo(()=>{const et=new Date(r);return et.setDate(et.getDate()+14),et.setHours(23,59,59,999),et},[r]),f=ie.useMemo(()=>{const et=new Date(r);return et.setDate(et.getDate()+30),et.setHours(23,59,59,999),et},[r]),_=ie.useMemo(()=>new Date(r.getTime()-1e3*60*60*24*Nz).toISOString(),[r]),y=ie.useMemo(()=>f.toISOString(),[f]),{location:d,loading:A,error:j,requestLocation:B}=JL(),{events:N,loading:V,error:Q}=Tz({startIso:_,endIso:y}),{hero:ne,nextUpcoming:J,dismissPendingMoments:ye}=Rz({events:N}),re=ie.useMemo(()=>{if(!d)return[];const et=[];for(const Tt of N){const Be=new Date(Tt.starts_at);if(Be<r||Be>l)continue;const ct=Hh(Tt.latitude??Tt.venue_place?.latitude??null),ut=Hh(Tt.longitude??Tt.venue_place?.longitude??null);if(ct===null||ut===null)continue;const Et=qx(d.lat,d.lng,ct,ut);Et>Oz||et.push({...Tt,distanceKm:Et})}return et.sort((Tt,Be)=>new Date(Tt.starts_at).getTime()-new Date(Be.starts_at).getTime()||Tt.distanceKm-Be.distanceKm),et},[l,N,d,r]),ge=ie.useMemo(()=>re.map(et=>{const Tt=Hh(et.latitude??et.venue_place?.latitude??null),Be=Hh(et.longitude??et.venue_place?.longitude??null);return Tt===null||Be===null?null:{id:et.id,lat:Tt,lng:Be}}).filter(Boolean).slice(0,12),[re]),{trending:le,meta:me,loading:be}=Ez(N,r),{suggestedArtists:ke,suggestedVenues:Me,loading:Ue}=kz(N,{startOfToday:r,endOfEventsWindow:f}),{canFollow:Fe,followedSubjectIds:He,toggleFollowSubject:lt}=WS(),Ye=Cz(He),Mt=ie.useMemo(()=>{if(Ye.size===0)return[];const et=N.filter(Tt=>{const Be=new Date(Tt.starts_at);return Be<r||Be>f?!1:(Tt.event_artists||[]).some(ct=>ct.artist?.id&&Ye.has(ct.artist.id))});return et.sort((Tt,Be)=>new Date(Tt.starts_at).getTime()-new Date(Be.starts_at).getTime()),et.slice(0,6)},[f,N,Ye,r]);return S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsx(Dz,{state:ne,onDismissPendingMoments:ne.kind==="just_attended"?ye:void 0}),ne.kind!=="just_attended"&&S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[ne.kind!=="cold_start"&&J&&S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Next"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Coming up"})]}),S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:S.jsx(ec,{event:{...J,cover_image_url:dp(J)},className:"w-[220px] shrink-0",kicker:m_(J.starts_at),title:g_(J),subtitle:J.venue_place?.name||J.city,onSelect:et=>t.push(`/event/${et.id}`)})})]}),ne.kind==="cold_start"&&S.jsx(sz,{canCreateEvent:e,loading:V,loadError:Q,location:d,locationLoading:A,locationError:j,onRequestLocation:B,nearbyUpcoming:re}),S.jsx(xz,{center:d,pins:ge,onOpenMap:()=>t.push("/tabs/map")}),S.jsx(bz,{loading:be,trending:le,meta:me}),S.jsx(wz,{loading:Ue,canFollow:Fe,followedSubjectIds:He,suggestedArtists:ke,suggestedVenues:Me,onToggleFollowSubject:et=>{lt(et)}}),S.jsx(Sz,{visible:Ye.size>0,events:Mt})]})]})})})},$z=()=>{const{user:t,profile:e,updateProfile:r,signOut:l,refreshProfile:f}=va(),{managedEntities:_,activeWorkspace:y,setActiveWorkspace:d}=sf(),[A,j]=ie.useState(!1),B=Ur(),N=mp(),V=!1,[Q,ne]=ie.useState([]),[J,ye]=ie.useState([]),[re,ge]=ie.useState([]),[le,me]=ie.useState([]),[be,ke]=ie.useState([]),[Me,Ue]=ie.useState(!0),[Fe,He]=ie.useState(""),[lt,Ye]=ie.useState("moments"),[Mt,et]=ie.useState(!1),[Tt,Be]=ie.useState(e?.display_name||""),[ct,ut]=ie.useState(e?.username||""),[Et,ot]=ie.useState(e?.primary_city||""),[xe,Le]=ie.useState(e?.bio||""),[tt,rt]=ie.useState(e?.role||"user"),[gt,Pt]=ie.useState(e?.external_links?.website||""),[Ot,ei]=ie.useState(e?.external_links?.instagram||""),[gi,Vi]=ie.useState(e?.external_links?.spotify||""),[pi,zi]=ie.useState(null),[gn,ln]=ie.useState(""),[$n,it]=ie.useState(""),[Cn,Mn]=ie.useState(""),[Si,mi]=ie.useState(""),[En,Rn]=ie.useState(""),[is,sn]=ie.useState(""),[Xi,Gi]=ie.useState(""),[ns,kt]=ie.useState(""),[Hn,yn]=ie.useState(""),[bn,Un]=ie.useState(""),[jt,ii]=ie.useState(""),[Xt,Wi]=ie.useState(!1),[Dn,hi]=ie.useState(!1);ie.useEffect(()=>{j(!!y)},[y]),ie.useEffect(()=>{if(y){if(y.type==="artist"&&y.artist?.id){const he=`/tabs/artist/${y.artist.id}`;N.pathname.startsWith(he)||B.replace(he)}else if(y.type==="venue"&&y.venue?.id){const he=`/tabs/venue/${y.venue.id}`;N.pathname.startsWith(he)||B.replace(he)}}},[y,B,N.pathname]);const xs=A&&y?y.type==="user"?y.profile:null:e,Pn=Nt.useRef(""),Zn=async(he=!1)=>{if(!t?.id)return;const Ge=`${t.id}-${A}-${y?.subject_id}`;if(!(!he&&Pn.current===Ge)){Ue(!0),He("");try{const at=`
        id,
        name,
        city,
        address,
        starts_at,
        cover_image_url,
        venue_place:venue_places!events_venue_place_id_fkey (
          id,
          name,
          city,
          address
        ),
        event_artists (
          artist:artists!event_artists_artist_entity_fk (
            id,
            name,
            avatar_url
          )
        )
      `,Ke=Ge;let st=Rt.from("posts").select("id, media_url, media_type, caption, created_at, event_offset_ms, song_title");A&&y?st=st.eq("actor_subject_id",y.subject_id):st=st.eq("user_id",t.id);const[Qt,si,Bt]=await Promise.all([st.order("created_at",{ascending:!1}).limit(12),Rt.from("event_saves").select(`events!inner (${at})`).eq("user_id",t.id),Rt.from("event_attendance").select(`status, events!inner (${at})`).eq("user_id",t.id)]);if(Pn.current!==Ke&&!he)return;const Ct=Qt.data,ni=si.data,yi=Bt.data;let Ri=[],_t=[];const xt=A&&y?y.type:e?.role;if(xt==="artist"){const Ne=A&&y?y.artist?.id:null;if(Ne){const{data:zt}=await Rt.from("event_artists").select(`
                events!inner (
                  ${at}
                )
              `).eq("artist_entity_id",Ne);Ri=(zt||[]).map(Kt=>Kt.events).filter(Kt=>!!Kt)}}if(xt==="venue"){const Ne=A&&y?y.venue?.id:null;if(Ne){const{data:zt}=await Rt.from("events").select(at).eq("venue_place_id",Ne).order("starts_at",{ascending:!1});_t=zt||[]}}if(Pn.current!==Ke&&!he)return;ne(Ct||[]);const Gt=(ni||[]).map(Ne=>Ne.events).filter(Ne=>!!Ne),fi=(yi||[]).map(Ne=>Ne.events).filter(Ne=>!!Ne);ye(Gt),ge([...fi,...Ri]),me(Ri),ke(_t),Pn.current=Ke}catch{He("Could not load profile data. Check your Supabase connection.")}finally{Ue(!1)}}};ie.useEffect(()=>{t?.id&&Zn()},[t?.id,e?.role,A,y?.subject_id]),ie.useEffect(()=>{Be(e?.display_name||""),ut(e?.username||""),ot(e?.primary_city||""),Le(e?.bio||""),rt(e?.role||"user"),Pt(e?.external_links?.website||""),ei(e?.external_links?.instagram||""),Vi(e?.external_links?.spotify||"")},[e]);const rn=_.find(he=>he.venue?.id===pi)?.venue||null,we=rn??_.find(he=>he.type==="venue")?.venue??null;ie.useEffect(()=>{if(!rn){ln(""),it(""),Mn(""),mi(""),Rn(""),sn(""),Gi(""),kt(""),yn("");return}ln(rn.name||""),it(rn.city||""),Mn(rn.address||""),mi(rn.website_url||""),Rn(rn.capacity!==null?rn.capacity.toString():""),sn(rn.venue_type||""),Gi(rn.latitude!==null?rn.latitude.toString():""),kt(rn.longitude!==null?rn.longitude.toString():""),yn((rn.photos||[]).join(`
`))},[rn]);const te=he=>{const Ge=he.trim();if(!Ge)return null;const at=Number(Ge);return Number.isNaN(at)?null:at},G=he=>{const Ge=he.trim();if(!Ge)return null;const at=Number(Ge);return Number.isFinite(at)?Math.round(at):null},oe=async()=>{ii(""),Un(""),Wi(!0);const he={...xs?.external_links||{}},Ge=(st,Qt)=>{const si=Qt.trim();si?he[st]=si:delete he[st]};Ge("website",gt),Ge("instagram",Ot),Ge("spotify",gi);const at={display_name:Tt||null,username:ct||null,primary_city:Et||null,bio:xe||null,external_links:he};V&&(at.role=tt);const{error:Ke}=await r(at);if(Ke){ii(Ke.message),Wi(!1);return}if(e?.role==="venue"&&t&&pi){if(!gn.trim()||!$n.trim()){ii("Venue name and city are required."),Wi(!1);return}const st=Hn.split(/\n|,/).map(si=>si.trim()).filter(Boolean),{error:Qt}=await Rt.from("venue_places").update({name:gn.trim()||null,city:$n.trim()||Et||"",address:Cn.trim()||null,website_url:Si.trim()||null,capacity:G(En),venue_type:is.trim()||null,latitude:te(Xi),longitude:te(ns),photos:st}).eq("id",pi);if(Qt){ii(Qt.message),Wi(!1);return}}await f(),await Zn(),Un("Profile updated."),et(!1),Wi(!1)},ve=async()=>{ii(""),Un(""),hi(!0);try{await l(),B.replace("/welcome")}catch{ii("Sign out failed. Check your Supabase connection.")}finally{hi(!1)}},je=()=>e?.role==="artist"?"Concerts":e?.role==="venue"?"Events":"Attended",ze=()=>e?.role==="artist"?L0:TS,Ve=()=>Me?S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})}):Fe?S.jsx("p",{className:"text-sm text-rose-400",children:Fe}):e?.role==="artist"&&lt==="attended"?le.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No shows here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Find a show"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:le.map(he=>S.jsx(ec,{event:he,className:"w-full",onSelect:Ge=>B.push(`/event/${Ge.id}`)},he.id))}):e?.role==="venue"&&lt==="attended"?be.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No nights here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Explore nearby"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:be.map(he=>S.jsx(ec,{event:he,className:"w-full",onSelect:Ge=>B.push(`/event/${Ge.id}`)},he.id))}):lt==="liked"?J.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"Nothing saved yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/discover"),children:"Discover concerts"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:J.map(he=>S.jsx(ec,{event:he,className:"w-full",onSelect:Ge=>B.push(`/event/${Ge.id}`)},he.id))}):lt==="attended"?re.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No nights here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Find a show"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:re.map(he=>S.jsx(ec,{event:he,className:"w-full",onSelect:Ge=>B.push(`/event/${Ge.id}`)},he.id))}):Q.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"Your concert memories start after the show."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/events"),children:"Go to Main"})]}):S.jsx("div",{className:"grid grid-cols-3 gap-2",children:Q.map(he=>S.jsx("button",{type:"button",onClick:()=>B.push(`/post/${he.id}`),className:"overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:he.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:he.media_url})}):S.jsx("img",{src:he.media_url,alt:he.caption||"Moment",className:"h-full w-full object-cover"})},he.id))});return S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[!A&&S.jsxs("div",{className:"space-y-4 animate-fade-up motion-reduce:animate-none",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:S.jsx("img",{src:e?.avatar_url||`https://picsum.photos/seed/${e?.id}/120/120`,alt:"Profile avatar",className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"min-w-0 flex-1",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Profile"}),S.jsx("h2",{className:"mt-2 font-display text-2xl font-bold text-white line-clamp-1",children:e?.username?`@${e.username}`:e?.display_name||"You"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:e?.primary_city||""})]}),S.jsx("button",{type:"button",className:"px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>et(he=>!he),children:"Edit"})]}),S.jsx("p",{className:"text-sm text-white/70",children:"Your concert memories live here."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/discover"),children:"Discover concerts"})]}),A&&S.jsxs("div",{className:"flex items-center gap-4 animate-fade-up motion-reduce:animate-none",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:S.jsx("img",{src:y?y.type==="artist"?y.artist?.avatar_url||`https://picsum.photos/seed/artist-${y.subject_id}/120/120`:y.venue?.photos?.[0]||`https://picsum.photos/seed/venue-${y.subject_id}/120/120`:e?.avatar_url||`https://picsum.photos/seed/${e?.id}/120/120`,alt:"Profile avatar",className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"flex-1",children:[S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:y?y.type==="artist"?y.artist?.name:y.venue?.name:e?.display_name||e?.username||"Your profile"}),S.jsx("p",{className:"text-sm text-white/55",children:y?y.type==="artist"?"Managed artist":"Managed venue":""})]}),S.jsxs("div",{className:"flex flex-col gap-2",children:[y?.type==="artist"&&y.artist?.id&&S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>B.push(`/tabs/artist/${y.artist.id||y.artist.artist_id}`),children:"View profile"}),y?.type==="venue"&&y.venue?.id&&S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>B.push(`/tabs/venue/${y.venue.id||y.venue.venue_place_id}`),children:"View profile"}),S.jsx("button",{type:"button",className:"px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>et(he=>!he),children:"Edit"})]})]}),A&&_.length>1&&S.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 animate-fade-in",children:_.map(he=>S.jsx("button",{type:"button",className:`flex-shrink-0 rounded-xl px-4 py-1.5 text-xs font-semibold transition ${y?.subject_id===he.subject_id?"bg-white/10 text-app-accent":"bg-white/5 text-white/60 hover:bg-white/10 hover:text-white/80"}`,onClick:()=>d(he),children:he.type==="artist"?he.artist?.name:he.venue?.name},he.subject_id))}),e?.role==="artist"&&(gt||Ot||gi)&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artist links"}),S.jsxs("div",{className:"space-y-2 text-sm text-white/80",children:[gt&&S.jsx("a",{href:gt,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:gt.replace(/^https?:\/\//,"")}),Ot&&S.jsx("a",{href:Ot,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:Ot.replace(/^https?:\/\//,"")}),gi&&S.jsx("a",{href:gi,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:gi.replace(/^https?:\/\//,"")})]})]}),e?.role==="venue"&&we&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue details"}),S.jsxs("div",{className:"space-y-2 text-sm text-white/80",children:[(we.address||e.primary_city)&&S.jsx("p",{children:we.address||e.primary_city}),we.website_url&&S.jsx("a",{href:we.website_url,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:we.website_url.replace(/^https?:\/\//,"")})]}),(we.photos??[]).length>0&&S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:(we.photos??[]).map((he,Ge)=>S.jsx("div",{className:"h-24 w-40 flex-shrink-0 overflow-hidden rounded-2xl bg-black/30",children:S.jsx("img",{src:he,alt:"Venue",className:"h-full w-full object-cover"})},`${he}-${Ge}`))})]}),Mt&&S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Display name"}),S.jsx("input",{value:Tt,onChange:he=>Be(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{value:ct,onChange:he=>ut(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Primary city"}),S.jsx("input",{value:Et,onChange:he=>ot(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Bio"}),S.jsx("textarea",{value:xe,onChange:he=>Le(he.target.value),className:"min-h-[96px] w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),V&&S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Role (dev)"}),S.jsxs("select",{value:tt,onChange:he=>rt(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",children:[S.jsx("option",{value:"user",children:"User"}),S.jsx("option",{value:"artist",children:"Artist"}),S.jsx("option",{value:"venue",children:"Venue"}),S.jsx("option",{value:"label",children:"Label"})]}),S.jsx("span",{className:"text-xs text-white/60",children:"Solo para testing. En prod queda bloqueado."})]}),e?.role==="artist"&&S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artist links"}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Website"}),S.jsx("input",{value:gt,onChange:he=>Pt(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://your-site.com"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Instagram"}),S.jsx("input",{value:Ot,onChange:he=>ei(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://instagram.com/you"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Spotify"}),S.jsx("input",{value:gi,onChange:he=>Vi(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://open.spotify.com/artist/..."})]})]}),e?.role==="venue"&&S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue management"}),_.filter(he=>he.type==="venue").length===0?S.jsx("p",{className:"text-sm text-white/60",children:"No managed venue place yet. Create or claim a venue to edit its details."}):S.jsxs(S.Fragment,{children:[_.filter(he=>he.type==="venue").length>1&&S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Managed venue"}),S.jsx("select",{value:pi||"",onChange:he=>zi(he.target.value||null),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",children:_.filter(he=>he.type==="venue").map(he=>S.jsx("option",{value:he.venue?.id,children:he.venue?.name},he.venue?.id))})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue name"}),S.jsx("input",{value:gn,onChange:he=>ln(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Venue name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("input",{value:$n,onChange:he=>it(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"City"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue type"}),S.jsx("input",{value:is,onChange:he=>sn(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Club, hall, theatre..."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Capacity"}),S.jsx("input",{value:En,onChange:he=>Rn(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"450"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Address"}),S.jsx("input",{value:Cn,onChange:he=>Mn(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Street address"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Website"}),S.jsx("input",{value:Si,onChange:he=>mi(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://venue-site.com"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Latitude"}),S.jsx("input",{value:Xi,onChange:he=>Gi(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Longitude"}),S.jsx("input",{value:ns,onChange:he=>kt(he.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue photos (URLs)"}),S.jsx("textarea",{value:Hn,onChange:he=>yn(he.target.value),className:"min-h-[96px] w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"One URL per line"})]})]})]}),jt&&S.jsx("p",{className:"text-sm text-rose-400",children:jt}),bn&&S.jsx("p",{className:"text-sm text-emerald-400",children:bn}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:oe,disabled:Xt,children:Xt?"Saving...":"Save changes"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>et(!1),children:"Cancel"})]}),S.jsxs("div",{className:"flex gap-2 animate-fade-up motion-reduce:animate-none",style:{animationDelay:"0.16s"},children:[S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${lt==="moments"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>Ye("moments"),children:[S.jsx(L0,{className:"h-4 w-4"}),"Moments"]}),S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${lt==="attended"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>Ye("attended"),children:[Nt.createElement(ze(),{className:"h-4 w-4"}),je()]}),S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${lt==="liked"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>Ye("liked"),children:[S.jsx(Nx,{className:"h-4 w-4"}),"Liked"]})]}),S.jsx("div",{className:"animate-fade-up motion-reduce:animate-none",style:{animationDelay:"0.24s"},children:Ve()}),!Mt&&jt&&S.jsx("p",{className:"text-sm text-rose-400",children:jt}),!Mt&&bn&&S.jsx("p",{className:"text-sm text-emerald-400",children:bn}),S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:ve,disabled:Dn,children:[S.jsx(tj,{className:"h-4 w-4"}),Dn?"Signing out...":"Log out"]})]})]})})})};var Py={exports:{}};var Uz=Py.exports,cw;function s2(){return cw||(cw=1,(function(t,e){(function(r,l){t.exports=l()})(Uz,(function(){var r={},l={};function f(y,d,A){if(l[y]=A,y==="index"){var j="var sharedModule = {}; ("+l.shared+")(sharedModule); ("+l.worker+")(sharedModule);",B={};return l.shared(B),l.index(r,B),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([j],{type:"text/javascript"}))),r}}f("shared",["exports"],(function(y){function d(a,n,c,m){return new(c||(c=Promise))((function(x,k){function C(F){try{R(m.next(F))}catch(q){k(q)}}function I(F){try{R(m.throw(F))}catch(q){k(q)}}function R(F){var q;F.done?x(F.value):(q=F.value,q instanceof c?q:new c((function(W){W(q)}))).then(C,I)}R((m=m.apply(a,n||[])).next())}))}function A(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var j=B;function B(a,n){this.x=a,this.y=n}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,n){return this.clone()._rotateAround(a,n)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var n=a.x-this.x,c=a.y-this.y;return n*n+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,n){return Math.atan2(this.x*n-this.y*a,this.x*a+this.y*n)},_matMult:function(a){var n=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=n,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var n=Math.cos(a),c=Math.sin(a),m=c*this.x+n*this.y;return this.x=n*this.x-c*this.y,this.y=m,this},_rotateAround:function(a,n){var c=Math.cos(a),m=Math.sin(a),x=n.y+m*(this.x-n.x)+c*(this.y-n.y);return this.x=n.x+c*(this.x-n.x)-m*(this.y-n.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(a){return a instanceof B?a:Array.isArray(a)?new B(a[0],a[1]):a};var N=A(j),V=Q;function Q(a,n,c,m){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=n,this.p2x=c,this.p2y=m}Q.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,n){if(n===void 0&&(n=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,m=0;m<8;m++){var x=this.sampleCurveX(c)-a;if(Math.abs(x)<n)return c;var k=this.sampleCurveDerivativeX(c);if(Math.abs(k)<1e-6)break;c-=x/k}var C=0,I=1;for(c=a,m=0;m<20&&(x=this.sampleCurveX(c),!(Math.abs(x-a)<n));m++)a>x?C=c:I=c,c=.5*(I-C)+C;return c},solve:function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))}};var ne=A(V);let J,ye;function re(){return J==null&&(J=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),J}function ge(){if(ye==null&&(ye=!1,re())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let m=0;m<25;m++){const x=4*m;n.fillStyle=`rgb(${x},${x+1},${x+2})`,n.fillRect(m%5,Math.floor(m/5),1,1)}const c=n.getImageData(0,0,5,5).data;for(let m=0;m<100;m++)if(m%4!=3&&c[m]!==m){ye=!0;break}}}return ye||!1}function le(a,n,c,m){const x=new ne(a,n,c,m);return k=>x.solve(k)}const me=le(.25,.1,.25,1);function be(a,n,c){return Math.min(c,Math.max(n,a))}function ke(a,n,c){const m=c-n,x=((a-n)%m+m)%m+n;return x===n?c:x}function Me(a,...n){for(const c of n)for(const m in c)a[m]=c[m];return a}let Ue=1;function Fe(a,n,c){const m={};for(const x in a)m[x]=n.call(this,a[x],x,a);return m}function He(a,n,c){const m={};for(const x in a)n.call(this,a[x],x,a)&&(m[x]=a[x]);return m}function lt(a){return Array.isArray(a)?a.map(lt):typeof a=="object"&&a?Fe(a,lt):a}const Ye={};function Mt(a){Ye[a]||(typeof console<"u"&&console.warn(a),Ye[a]=!0)}function et(a,n,c){return(c.y-a.y)*(n.x-a.x)>(n.y-a.y)*(c.x-a.x)}function Tt(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Be=null;function ct(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Et(a,n,c,m,x){return d(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const k=new VideoFrame(a,{timestamp:0});try{const C=k?.format;if(!C||!C.startsWith("BGR")&&!C.startsWith("RGB"))throw new Error(`Unrecognized format ${C}`);const I=C.startsWith("BGR"),R=new Uint8ClampedArray(m*x*4);if(yield k.copyTo(R,(function(F,q,W,ee,se){const ue=4*Math.max(-q,0),de=(Math.max(0,W)-W)*ee*4+ue,Te=4*ee,Ae=Math.max(0,q),Je=Math.max(0,W);return{rect:{x:Ae,y:Je,width:Math.min(F.width,q+ee)-Ae,height:Math.min(F.height,W+se)-Je},layout:[{offset:de,stride:Te}]}})(a,n,c,m,x)),I)for(let F=0;F<R.length;F+=4){const q=R[F];R[F]=R[F+2],R[F+2]=q}return R}finally{k.close()}}))}let ot,xe;const Le="AbortError";function tt(){return new Error(Le)}const rt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function gt(a){return rt.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Pt="global-dispatcher";class Ot extends Error{constructor(n,c,m,x){super(`AJAXError: ${c} (${n}): ${m}`),this.status=n,this.statusText=c,this.url=m,this.body=x}}const ei=()=>Tt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,gi=function(a,n){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const m=gt(a.url);if(m)return m(a,n);if(Tt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Pt},n)}if(!(/^file:/.test(c=a.url)||/^file:/.test(ei())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(m,x){return d(this,void 0,void 0,(function*(){const k=new Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,cache:m.cache,referrer:ei(),signal:x.signal});m.type!=="json"||k.headers.has("Accept")||k.headers.set("Accept","application/json");const C=yield fetch(k);if(!C.ok){const F=yield C.blob();throw new Ot(C.status,C.statusText,m.url,F)}let I;I=m.type==="arrayBuffer"||m.type==="image"?C.arrayBuffer():m.type==="json"?C.json():C.text();const R=yield I;if(x.signal.aborted)throw tt();return{data:R,cacheControl:C.headers.get("Cache-Control"),expires:C.headers.get("Expires")}}))})(a,n);if(Tt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Pt},n)}var c;return(function(m,x){return new Promise(((k,C)=>{var I;const R=new XMLHttpRequest;R.open(m.method||"GET",m.url,!0),m.type!=="arrayBuffer"&&m.type!=="image"||(R.responseType="arraybuffer");for(const F in m.headers)R.setRequestHeader(F,m.headers[F]);m.type==="json"&&(R.responseType="text",!((I=m.headers)===null||I===void 0)&&I.Accept||R.setRequestHeader("Accept","application/json")),R.withCredentials=m.credentials==="include",R.onerror=()=>{C(new Error(R.statusText))},R.onload=()=>{if(!x.signal.aborted)if((R.status>=200&&R.status<300||R.status===0)&&R.response!==null){let F=R.response;if(m.type==="json")try{F=JSON.parse(R.response)}catch(q){return void C(q)}k({data:F,cacheControl:R.getResponseHeader("Cache-Control"),expires:R.getResponseHeader("Expires")})}else{const F=new Blob([R.response],{type:R.getResponseHeader("Content-Type")});C(new Ot(R.status,R.statusText,m.url,F))}},x.signal.addEventListener("abort",(()=>{R.abort(),C(tt())})),R.send(m.body)}))})(a,n)};function Vi(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const n=new URL(a),c=window.location;return n.protocol===c.protocol&&n.host===c.host}function pi(a,n,c){c[a]&&c[a].indexOf(n)!==-1||(c[a]=c[a]||[],c[a].push(n))}function zi(a,n,c){if(c&&c[a]){const m=c[a].indexOf(n);m!==-1&&c[a].splice(m,1)}}class gn{constructor(n,c={}){Me(this,c),this.type=n}}class ln extends gn{constructor(n,c={}){super("error",Me({error:n},c))}}class $n{on(n,c){return this._listeners=this._listeners||{},pi(n,c,this._listeners),this}off(n,c){return zi(n,c,this._listeners),zi(n,c,this._oneTimeListeners),this}once(n,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},pi(n,c,this._oneTimeListeners),this):new Promise((m=>this.once(n,m)))}fire(n,c){typeof n=="string"&&(n=new gn(n,c||{}));const m=n.type;if(this.listens(m)){n.target=this;const x=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const I of x)I.call(this,n);const k=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const I of k)zi(m,I,this._oneTimeListeners),I.call(this,n);const C=this._eventedParent;C&&(Me(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(n))}else n instanceof ln&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,c){return this._eventedParent=n,this._eventedParentData=c,this}}var it={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Cn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Mn(a,n){const c={};for(const m in a)m!=="ref"&&(c[m]=a[m]);return Cn.forEach((m=>{m in n&&(c[m]=n[m])})),c}function Si(a,n){if(Array.isArray(a)){if(!Array.isArray(n)||a.length!==n.length)return!1;for(let c=0;c<a.length;c++)if(!Si(a[c],n[c]))return!1;return!0}if(typeof a=="object"&&a!==null&&n!==null){if(typeof n!="object"||Object.keys(a).length!==Object.keys(n).length)return!1;for(const c in a)if(!Si(a[c],n[c]))return!1;return!0}return a===n}function mi(a,n){a.push(n)}function En(a,n,c){mi(c,{command:"addSource",args:[a,n[a]]})}function Rn(a,n,c){mi(n,{command:"removeSource",args:[a]}),c[a]=!0}function is(a,n,c,m){Rn(a,c,m),En(a,n,c)}function sn(a,n,c){let m;for(m in a[c])if(Object.prototype.hasOwnProperty.call(a[c],m)&&m!=="data"&&!Si(a[c][m],n[c][m]))return!1;for(m in n[c])if(Object.prototype.hasOwnProperty.call(n[c],m)&&m!=="data"&&!Si(a[c][m],n[c][m]))return!1;return!0}function Xi(a,n,c,m,x,k){a=a||{},n=n||{};for(const C in a)Object.prototype.hasOwnProperty.call(a,C)&&(Si(a[C],n[C])||c.push({command:k,args:[m,C,n[C],x]}));for(const C in n)Object.prototype.hasOwnProperty.call(n,C)&&!Object.prototype.hasOwnProperty.call(a,C)&&(Si(a[C],n[C])||c.push({command:k,args:[m,C,n[C],x]}))}function Gi(a){return a.id}function ns(a,n){return a[n.id]=n,a}class kt{constructor(n,c,m,x){this.message=(n?`${n}: `:"")+m,x&&(this.identifier=x),c!=null&&c.__line__&&(this.line=c.__line__)}}function Hn(a,...n){for(const c of n)for(const m in c)a[m]=c[m];return a}class yn extends Error{constructor(n,c){super(c),this.message=c,this.key=n}}class bn{constructor(n,c=[]){this.parent=n,this.bindings={};for(const[m,x]of c)this.bindings[m]=x}concat(n){return new bn(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Un={kind:"null"},jt={kind:"number"},ii={kind:"string"},Xt={kind:"boolean"},Wi={kind:"color"},Dn={kind:"object"},hi={kind:"value"},xs={kind:"collator"},Pn={kind:"formatted"},Zn={kind:"padding"},rn={kind:"resolvedImage"},we={kind:"variableAnchorOffsetCollection"};function te(a,n){return{kind:"array",itemType:a,N:n}}function G(a){if(a.kind==="array"){const n=G(a.itemType);return typeof a.N=="number"?`array<${n}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${n}>`}return a.kind}const oe=[Un,jt,ii,Xt,Wi,Pn,Dn,te(hi),Zn,rn,we];function ve(a,n){if(n.kind==="error")return null;if(a.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ve(a.itemType,n.itemType))&&(typeof a.N!="number"||a.N===n.N))return null}else{if(a.kind===n.kind)return null;if(a.kind==="value"){for(const c of oe)if(!ve(c,n))return null}}return`Expected ${G(a)} but found ${G(n)} instead.`}function je(a,n){return n.some((c=>c.kind===a.kind))}function ze(a,n){return n.some((c=>c==="null"?a===null:c==="array"?Array.isArray(a):c==="object"?a&&!Array.isArray(a)&&typeof a=="object":c===typeof a))}function Ve(a,n){return a.kind==="array"&&n.kind==="array"?a.itemType.kind===n.itemType.kind&&typeof a.N=="number":a.kind===n.kind}const he=.96422,Ge=.82521,at=4/29,Ke=6/29,st=3*Ke*Ke,Qt=Ke*Ke*Ke,si=Math.PI/180,Bt=180/Math.PI;function Ct(a){return(a%=360)<0&&(a+=360),a}function ni([a,n,c,m]){let x,k;const C=Ri((.2225045*(a=yi(a))+.7168786*(n=yi(n))+.0606169*(c=yi(c)))/1);a===n&&n===c?x=k=C:(x=Ri((.4360747*a+.3850649*n+.1430804*c)/he),k=Ri((.0139322*a+.0971045*n+.7141733*c)/Ge));const I=116*C-16;return[I<0?0:I,500*(x-C),200*(C-k),m]}function yi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Ri(a){return a>Qt?Math.pow(a,1/3):a/st+at}function _t([a,n,c,m]){let x=(a+16)/116,k=isNaN(n)?x:x+n/500,C=isNaN(c)?x:x-c/200;return x=1*Gt(x),k=he*Gt(k),C=Ge*Gt(C),[xt(3.1338561*k-1.6168667*x-.4906146*C),xt(-.9787684*k+1.9161415*x+.033454*C),xt(.0719453*k-.2289914*x+1.4052427*C),m]}function xt(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Gt(a){return a>Ke?a*a*a:st*(a-at)}function fi(a){return parseInt(a.padEnd(2,a),16)/255}function Ne(a,n){return zt(n?a/100:a,0,1)}function zt(a,n,c){return Math.min(Math.max(n,a),c)}function Kt(a){return!a.some(Number.isNaN)}const Zi={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class vi{constructor(n,c,m,x=1,k=!0){this.r=n,this.g=c,this.b=m,this.a=x,k||(this.r*=x,this.g*=x,this.b*=x,x||this.overwriteGetter("rgb",[n,c,m,x]))}static parse(n){if(n instanceof vi)return n;if(typeof n!="string")return;const c=(function(m){if((m=m.toLowerCase().trim())==="transparent")return[0,0,0,0];const x=Zi[m];if(x){const[C,I,R]=x;return[C/255,I/255,R/255,1]}if(m.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(m)){const C=m.length<6?1:2;let I=1;return[fi(m.slice(I,I+=C)),fi(m.slice(I,I+=C)),fi(m.slice(I,I+=C)),fi(m.slice(I,I+C)||"ff")]}if(m.startsWith("rgb")){const C=m.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[I,R,F,q,W,ee,se,ue,de,Te,Ae,Je]=C,Oe=[q||" ",se||" ",Te].join("");if(Oe==="  "||Oe==="  /"||Oe===",,"||Oe===",,,"){const We=[F,ee,de].join(""),mt=We==="%%%"?100:We===""?255:0;if(mt){const Dt=[zt(+R/mt,0,1),zt(+W/mt,0,1),zt(+ue/mt,0,1),Ae?Ne(+Ae,Je):1];if(Kt(Dt))return Dt}}return}}const k=m.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[C,I,R,F,q,W,ee,se,ue]=k,de=[R||" ",q||" ",ee].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const Te=[+I,zt(+F,0,100),zt(+W,0,100),se?Ne(+se,ue):1];if(Kt(Te))return(function([Ae,Je,Oe,We]){function mt(Dt){const Jt=(Dt+Ae/30)%12,Ti=Je*Math.min(Oe,1-Oe);return Oe-Ti*Math.max(-1,Math.min(Jt-3,9-Jt,1))}return Ae=Ct(Ae),Je/=100,Oe/=100,[mt(0),mt(8),mt(4),We]})(Te)}}})(n);return c?new vi(...c,!1):void 0}get rgb(){const{r:n,g:c,b:m,a:x}=this,k=x||1/0;return this.overwriteGetter("rgb",[n/k,c/k,m/k,x])}get hcl(){return this.overwriteGetter("hcl",(function(n){const[c,m,x,k]=ni(n),C=Math.sqrt(m*m+x*x);return[Math.round(1e4*C)?Ct(Math.atan2(x,m)*Bt):NaN,C,c,k]})(this.rgb))}get lab(){return this.overwriteGetter("lab",ni(this.rgb))}overwriteGetter(n,c){return Object.defineProperty(this,n,{value:c}),c}toString(){const[n,c,m,x]=this.rgb;return`rgba(${[n,c,m].map((k=>Math.round(255*k))).join(",")},${x})`}}vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1);class mn{constructor(n,c,m){this.sensitivity=n?c?"variant":"case":c?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,c){return this.collator.compare(n,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class _r{constructor(n,c,m,x,k){this.text=n,this.image=c,this.scale=m,this.fontStack=x,this.textColor=k}}class Xs{constructor(n){this.sections=n}static fromString(n){return new Xs([new _r(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((n=>n.text.length!==0||n.image&&n.image.name.length!==0))}static factory(n){return n instanceof Xs?n:Xs.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map((n=>n.text)).join("")}}class Rs{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Rs)return n;if(typeof n=="number")return new Rs([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const c of n)if(typeof c!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Rs(n)}}toString(){return JSON.stringify(this.values)}}const Co=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class sr{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof sr)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let c=0;c<n.length;c+=2){const m=n[c],x=n[c+1];if(typeof m!="string"||!Co.has(m)||!Array.isArray(x)||x.length!==2||typeof x[0]!="number"||typeof x[1]!="number")return}return new sr(n)}}toString(){return JSON.stringify(this.values)}}class vr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new vr({name:n,available:!1}):null}}function Ao(a,n,c,m){return typeof a=="number"&&a>=0&&a<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof c=="number"&&c>=0&&c<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[a,n,c,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[a,n,c,m]:[a,n,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function xa(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof vi||a instanceof mn||a instanceof Xs||a instanceof Rs||a instanceof sr||a instanceof vr)return!0;if(Array.isArray(a)){for(const n of a)if(!xa(n))return!1;return!0}if(typeof a=="object"){for(const n in a)if(!xa(a[n]))return!1;return!0}return!1}function ki(a){if(a===null)return Un;if(typeof a=="string")return ii;if(typeof a=="boolean")return Xt;if(typeof a=="number")return jt;if(a instanceof vi)return Wi;if(a instanceof mn)return xs;if(a instanceof Xs)return Pn;if(a instanceof Rs)return Zn;if(a instanceof sr)return we;if(a instanceof vr)return rn;if(Array.isArray(a)){const n=a.length;let c;for(const m of a){const x=ki(m);if(c){if(c===x)continue;c=hi;break}c=x}return te(c||hi,n)}return Dn}function In(a){const n=typeof a;return a===null?"":n==="string"||n==="number"||n==="boolean"?String(a):a instanceof vi||a instanceof Xs||a instanceof Rs||a instanceof sr||a instanceof vr?a.toString():JSON.stringify(a)}class gs{constructor(n,c){this.type=n,this.value=c}static parse(n,c){if(n.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!xa(n[1]))return c.error("invalid value");const m=n[1];let x=ki(m);const k=c.expectedType;return x.kind!=="array"||x.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(x=k),new gs(x,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class cn{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Oa={string:ii,number:jt,boolean:Xt,object:Dn};class Fr{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");let m,x=1;const k=n[0];if(k==="array"){let I,R;if(n.length>2){const F=n[1];if(typeof F!="string"||!(F in Oa)||F==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);I=Oa[F],x++}else I=hi;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return c.error('The length argument to "array" must be a positive integer literal',2);R=n[2],x++}m=te(I,R)}else{if(!Oa[k])throw new Error(`Types doesn't contain name = ${k}`);m=Oa[k]}const C=[];for(;x<n.length;x++){const I=c.parse(n[x],x,hi);if(!I)return null;C.push(I)}return new Fr(m,C)}evaluate(n){for(let c=0;c<this.args.length;c++){const m=this.args[c].evaluate(n);if(!ve(this.type,ki(m)))return m;if(c===this.args.length-1)throw new cn(`Expected value to be of type ${G(this.type)}, but found ${G(ki(m))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const Bi={"to-boolean":Xt,"to-color":Wi,"to-number":jt,"to-string":ii};class An{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");const m=n[0];if(!Bi[m])throw new Error(`Can't parse ${m} as it is not part of the known types`);if((m==="to-boolean"||m==="to-string")&&n.length!==2)return c.error("Expected one argument.");const x=Bi[m],k=[];for(let C=1;C<n.length;C++){const I=c.parse(n[C],C,hi);if(!I)return null;k.push(I)}return new An(x,k)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let c,m;for(const x of this.args){if(c=x.evaluate(n),m=null,c instanceof vi)return c;if(typeof c=="string"){const k=n.parseColor(c);if(k)return k}else if(Array.isArray(c)&&(m=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Ao(c[0],c[1],c[2],c[3]),!m))return new vi(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new cn(m||`Could not parse color from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"padding":{let c;for(const m of this.args){c=m.evaluate(n);const x=Rs.parse(c);if(x)return x}throw new cn(`Could not parse padding from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"variableAnchorOffsetCollection":{let c;for(const m of this.args){c=m.evaluate(n);const x=sr.parse(c);if(x)return x}throw new cn(`Could not parse variableAnchorOffsetCollection from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"number":{let c=null;for(const m of this.args){if(c=m.evaluate(n),c===null)return 0;const x=Number(c);if(!isNaN(x))return x}throw new cn(`Could not convert ${JSON.stringify(c)} to number.`)}case"formatted":return Xs.fromString(In(this.args[0].evaluate(n)));case"resolvedImage":return vr.fromString(In(this.args[0].evaluate(n)));default:return In(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const Il=["Unknown","Point","LineString","Polygon"];class Xo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Il[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let c=this._parseColorCache[n];return c||(c=this._parseColorCache[n]=vi.parse(n)),c}}class On{constructor(n,c,m=[],x,k=new bn,C=[]){this.registry=n,this.path=m,this.key=m.map((I=>`[${I}]`)).join(""),this.scope=k,this.errors=C,this.expectedType=x,this._isConstant=c}parse(n,c,m,x,k={}){return c?this.concat(c,m,x)._parse(n,k):this._parse(n,k)}_parse(n,c){function m(x,k,C){return C==="assert"?new Fr(k,[x]):C==="coerce"?new An(k,[x]):x}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const x=n[0];if(typeof x!="string")return this.error(`Expression name must be a string, but found ${typeof x} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[x];if(k){let C=k.parse(n,this);if(!C)return null;if(this.expectedType){const I=this.expectedType,R=C.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||R.kind!=="value")if(I.kind!=="color"&&I.kind!=="formatted"&&I.kind!=="resolvedImage"||R.kind!=="value"&&R.kind!=="string")if(I.kind!=="padding"||R.kind!=="value"&&R.kind!=="number"&&R.kind!=="array")if(I.kind!=="variableAnchorOffsetCollection"||R.kind!=="value"&&R.kind!=="array"){if(this.checkSubtype(I,R))return null}else C=m(C,I,c.typeAnnotation||"coerce");else C=m(C,I,c.typeAnnotation||"coerce");else C=m(C,I,c.typeAnnotation||"coerce");else C=m(C,I,c.typeAnnotation||"assert")}if(!(C instanceof gs)&&C.type.kind!=="resolvedImage"&&this._isConstant(C)){const I=new Xo;try{C=new gs(C.type,C.evaluate(I))}catch(R){return this.error(R.message),null}}return C}return this.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,c,m){const x=typeof n=="number"?this.path.concat(n):this.path,k=m?this.scope.concat(m):this.scope;return new On(this.registry,this._isConstant,x,c||null,k,this.errors)}error(n,...c){const m=`${this.key}${c.map((x=>`[${x}]`)).join("")}`;this.errors.push(new yn(m,n))}checkSubtype(n,c){const m=ve(n,c);return m&&this.error(m),m}}class Na{constructor(n,c){this.type=c.type,this.bindings=[].concat(n),this.result=c}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const c of this.bindings)n(c[1]);n(this.result)}static parse(n,c){if(n.length<4)return c.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const m=[];for(let k=1;k<n.length-1;k+=2){const C=n[k];if(typeof C!="string")return c.error(`Expected string, but found ${typeof C} instead.`,k);if(/[^a-zA-Z0-9_]/.test(C))return c.error("Variable names must contain only alphanumeric characters or '_'.",k);const I=c.parse(n[k+1],k+1);if(!I)return null;m.push([C,I])}const x=c.parse(n[n.length-1],n.length-1,c.expectedType,m);return x?new Na(m,x):null}outputDefined(){return this.result.outputDefined()}}class un{constructor(n,c){this.type=c.type,this.name=n,this.boundExpression=c}static parse(n,c){if(n.length!==2||typeof n[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const m=n[1];return c.scope.has(m)?new un(m,c.scope.get(m)):c.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class ba{constructor(n,c,m){this.type=n,this.index=c,this.input=m}static parse(n,c){if(n.length!==3)return c.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,jt),x=c.parse(n[2],2,te(c.expectedType||hi));return m&&x?new ba(x.type.itemType,m,x):null}evaluate(n){const c=this.index.evaluate(n),m=this.input.evaluate(n);if(c<0)throw new cn(`Array index out of bounds: ${c} < 0.`);if(c>=m.length)throw new cn(`Array index out of bounds: ${c} > ${m.length-1}.`);if(c!==Math.floor(c))throw new cn(`Array index must be an integer, but found ${c} instead.`);return m[c]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Gn{constructor(n,c){this.type=Xt,this.needle=n,this.haystack=c}static parse(n,c){if(n.length!==3)return c.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,hi),x=c.parse(n[2],2,hi);return m&&x?je(m.type,[Xt,ii,jt,Un,hi])?new Gn(m,x):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(m.type)} instead`):null}evaluate(n){const c=this.needle.evaluate(n),m=this.haystack.evaluate(n);if(!m)return!1;if(!ze(c,["boolean","string","number","null"]))throw new cn(`Expected first argument to be of type boolean, string, number or null, but found ${G(ki(c))} instead.`);if(!ze(m,["string","array"]))throw new cn(`Expected second argument to be of type array or string, but found ${G(ki(m))} instead.`);return m.indexOf(c)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Vr{constructor(n,c,m){this.type=jt,this.needle=n,this.haystack=c,this.fromIndex=m}static parse(n,c){if(n.length<=2||n.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,hi),x=c.parse(n[2],2,hi);if(!m||!x)return null;if(!je(m.type,[Xt,ii,jt,Un,hi]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(m.type)} instead`);if(n.length===4){const k=c.parse(n[3],3,jt);return k?new Vr(m,x,k):null}return new Vr(m,x)}evaluate(n){const c=this.needle.evaluate(n),m=this.haystack.evaluate(n);if(!ze(c,["boolean","string","number","null"]))throw new cn(`Expected first argument to be of type boolean, string, number or null, but found ${G(ki(c))} instead.`);let x;if(this.fromIndex&&(x=this.fromIndex.evaluate(n)),ze(m,["string"])){const k=m.indexOf(c,x);return k===-1?-1:[...m.slice(0,k)].length}if(ze(m,["array"]))return m.indexOf(c,x);throw new cn(`Expected second argument to be of type array or string, but found ${G(ki(m))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Mo{constructor(n,c,m,x,k,C){this.inputType=n,this.type=c,this.input=m,this.cases=x,this.outputs=k,this.otherwise=C}static parse(n,c){if(n.length<5)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return c.error("Expected an even number of arguments.");let m,x;c.expectedType&&c.expectedType.kind!=="value"&&(x=c.expectedType);const k={},C=[];for(let F=2;F<n.length-1;F+=2){let q=n[F];const W=n[F+1];Array.isArray(q)||(q=[q]);const ee=c.concat(F);if(q.length===0)return ee.error("Expected at least one branch label.");for(const ue of q){if(typeof ue!="number"&&typeof ue!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof ue=="number"&&Math.abs(ue)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ue=="number"&&Math.floor(ue)!==ue)return ee.error("Numeric branch labels must be integer values.");if(m){if(ee.checkSubtype(m,ki(ue)))return null}else m=ki(ue);if(k[String(ue)]!==void 0)return ee.error("Branch labels must be unique.");k[String(ue)]=C.length}const se=c.parse(W,F,x);if(!se)return null;x=x||se.type,C.push(se)}const I=c.parse(n[1],1,hi);if(!I)return null;const R=c.parse(n[n.length-1],n.length-1,x);return R?I.type.kind!=="value"&&c.concat(1).checkSubtype(m,I.type)?null:new Mo(m,x,I,k,C,R):null}evaluate(n){const c=this.input.evaluate(n);return(ki(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))&&this.otherwise.outputDefined()}}class qr{constructor(n,c,m){this.type=n,this.branches=c,this.otherwise=m}static parse(n,c){if(n.length<4)return c.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return c.error("Expected an odd number of arguments.");let m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const x=[];for(let C=1;C<n.length-1;C+=2){const I=c.parse(n[C],C,Xt);if(!I)return null;const R=c.parse(n[C+1],C+1,m);if(!R)return null;x.push([I,R]),m=m||R.type}const k=c.parse(n[n.length-1],n.length-1,m);if(!k)return null;if(!m)throw new Error("Can't infer output type");return new qr(m,x,k)}evaluate(n){for(const[c,m]of this.branches)if(c.evaluate(n))return m.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[c,m]of this.branches)n(c),n(m);n(this.otherwise)}outputDefined(){return this.branches.every((([n,c])=>c.outputDefined()))&&this.otherwise.outputDefined()}}class Ko{constructor(n,c,m,x){this.type=n,this.input=c,this.beginIndex=m,this.endIndex=x}static parse(n,c){if(n.length<=2||n.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,hi),x=c.parse(n[2],2,jt);if(!m||!x)return null;if(!je(m.type,[te(hi),ii,hi]))return c.error(`Expected first argument to be of type array or string, but found ${G(m.type)} instead`);if(n.length===4){const k=c.parse(n[3],3,jt);return k?new Ko(m.type,m,x,k):null}return new Ko(m.type,m,x)}evaluate(n){const c=this.input.evaluate(n),m=this.beginIndex.evaluate(n);let x;if(this.endIndex&&(x=this.endIndex.evaluate(n)),ze(c,["string"]))return[...c].slice(m,x).join("");if(ze(c,["array"]))return c.slice(m,x);throw new cn(`Expected first argument to be of type array or string, but found ${G(ki(c))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function oo(a,n){const c=a.length-1;let m,x,k=0,C=c,I=0;for(;k<=C;)if(I=Math.floor((k+C)/2),m=a[I],x=a[I+1],m<=n){if(I===c||n<x)return I;k=I+1}else{if(!(m>n))throw new cn("Input is not a number.");C=I-1}return 0}class lo{constructor(n,c,m){this.type=n,this.input=c,this.labels=[],this.outputs=[];for(const[x,k]of m)this.labels.push(x),this.outputs.push(k)}static parse(n,c){if(n.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return c.error("Expected an even number of arguments.");const m=c.parse(n[1],1,jt);if(!m)return null;const x=[];let k=null;c.expectedType&&c.expectedType.kind!=="value"&&(k=c.expectedType);for(let C=1;C<n.length;C+=2){const I=C===1?-1/0:n[C],R=n[C+1],F=C,q=C+1;if(typeof I!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(x.length&&x[x.length-1][0]>=I)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const W=c.parse(R,q,k);if(!W)return null;k=k||W.type,x.push([I,W])}return new lo(k,m,x)}evaluate(n){const c=this.labels,m=this.outputs;if(c.length===1)return m[0].evaluate(n);const x=this.input.evaluate(n);if(x<=c[0])return m[0].evaluate(n);const k=c.length;return x>=c[k-1]?m[k-1].evaluate(n):m[oo(c,x)].evaluate(n)}eachChild(n){n(this.input);for(const c of this.outputs)n(c)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function Ll(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ic=Lc;function Lc(a,n,c,m){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=n,this.p2x=c,this.p2y=m}Lc.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,n){if(n===void 0&&(n=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,m=0;m<8;m++){var x=this.sampleCurveX(c)-a;if(Math.abs(x)<n)return c;var k=this.sampleCurveDerivativeX(c);if(Math.abs(k)<1e-6)break;c-=x/k}var C=0,I=1;for(c=a,m=0;m<20&&(x=this.sampleCurveX(c),!(Math.abs(x-a)<n));m++)a>x?C=c:I=c,c=.5*(I-C)+C;return c},solve:function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))}};var zl=Ll(Ic);function Us(a,n,c){return a+c*(n-a)}function Po(a,n,c){return a.map(((m,x)=>Us(m,n[x],c)))}const Fs={number:Us,color:function(a,n,c,m="rgb"){switch(m){case"rgb":{const[x,k,C,I]=Po(a.rgb,n.rgb,c);return new vi(x,k,C,I,!1)}case"hcl":{const[x,k,C,I]=a.hcl,[R,F,q,W]=n.hcl;let ee,se;if(isNaN(x)||isNaN(R))isNaN(x)?isNaN(R)?ee=NaN:(ee=R,C!==1&&C!==0||(se=F)):(ee=x,q!==1&&q!==0||(se=k));else{let Je=R-x;R>x&&Je>180?Je-=360:R<x&&x-R>180&&(Je+=360),ee=x+c*Je}const[ue,de,Te,Ae]=(function([Je,Oe,We,mt]){return Je=isNaN(Je)?0:Je*si,_t([We,Math.cos(Je)*Oe,Math.sin(Je)*Oe,mt])})([ee,se??Us(k,F,c),Us(C,q,c),Us(I,W,c)]);return new vi(ue,de,Te,Ae,!1)}case"lab":{const[x,k,C,I]=_t(Po(a.lab,n.lab,c));return new vi(x,k,C,I,!1)}}},array:Po,padding:function(a,n,c){return new Rs(Po(a.values,n.values,c))},variableAnchorOffsetCollection:function(a,n,c){const m=a.values,x=n.values;if(m.length!==x.length)throw new cn(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${n.toString()}`);const k=[];for(let C=0;C<m.length;C+=2){if(m[C]!==x[C])throw new cn(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${m[C]}, to[${C}]: ${x[C]}`);k.push(m[C]);const[I,R]=m[C+1],[F,q]=x[C+1];k.push([Us(I,F,c),Us(R,q,c)])}return new sr(k)}};class Ds{constructor(n,c,m,x,k){this.type=n,this.operator=c,this.interpolation=m,this.input=x,this.labels=[],this.outputs=[];for(const[C,I]of k)this.labels.push(C),this.outputs.push(I)}static interpolationFactor(n,c,m,x){let k=0;if(n.name==="exponential")k=Ii(c,n.base,m,x);else if(n.name==="linear")k=Ii(c,1,m,x);else if(n.name==="cubic-bezier"){const C=n.controlPoints;k=new zl(C[0],C[1],C[2],C[3]).solve(Ii(c,1,m,x))}return k}static parse(n,c){let[m,x,k,...C]=n;if(!Array.isArray(x)||x.length===0)return c.error("Expected an interpolation type expression.",1);if(x[0]==="linear")x={name:"linear"};else if(x[0]==="exponential"){const F=x[1];if(typeof F!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);x={name:"exponential",base:F}}else{if(x[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(x[0])}`,1,0);{const F=x.slice(1);if(F.length!==4||F.some((q=>typeof q!="number"||q<0||q>1)))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);x={name:"cubic-bezier",controlPoints:F}}}if(n.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(k=c.parse(k,2,jt),!k)return null;const I=[];let R=null;m==="interpolate-hcl"||m==="interpolate-lab"?R=Wi:c.expectedType&&c.expectedType.kind!=="value"&&(R=c.expectedType);for(let F=0;F<C.length;F+=2){const q=C[F],W=C[F+1],ee=F+3,se=F+4;if(typeof q!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(I.length&&I[I.length-1][0]>=q)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const ue=c.parse(W,se,R);if(!ue)return null;R=R||ue.type,I.push([q,ue])}return Ve(R,jt)||Ve(R,Wi)||Ve(R,Zn)||Ve(R,we)||Ve(R,te(jt))?new Ds(R,m,x,k,I):c.error(`Type ${G(R)} is not interpolatable.`)}evaluate(n){const c=this.labels,m=this.outputs;if(c.length===1)return m[0].evaluate(n);const x=this.input.evaluate(n);if(x<=c[0])return m[0].evaluate(n);const k=c.length;if(x>=c[k-1])return m[k-1].evaluate(n);const C=oo(c,x),I=Ds.interpolationFactor(this.interpolation,x,c[C],c[C+1]),R=m[C].evaluate(n),F=m[C+1].evaluate(n);switch(this.operator){case"interpolate":return Fs[this.type.kind](R,F,I);case"interpolate-hcl":return Fs.color(R,F,I,"hcl");case"interpolate-lab":return Fs.color(R,F,I,"lab")}}eachChild(n){n(this.input);for(const c of this.outputs)n(c)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function Ii(a,n,c,m){const x=m-c,k=a-c;return x===0?0:n===1?k/x:(Math.pow(n,k)-1)/(Math.pow(n,x)-1)}class jr{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expectected at least one argument.");let m=null;const x=c.expectedType;x&&x.kind!=="value"&&(m=x);const k=[];for(const I of n.slice(1)){const R=c.parse(I,1+k.length,m,void 0,{typeAnnotation:"omit"});if(!R)return null;m=m||R.type,k.push(R)}if(!m)throw new Error("No output type");const C=x&&k.some((I=>ve(x,I.type)));return new jr(C?hi:m,k)}evaluate(n){let c,m=null,x=0;for(const k of this.args)if(x++,m=k.evaluate(n),m&&m instanceof vr&&!m.available&&(c||(c=m.name),m=null,x===this.args.length&&(m=c)),m!==null)break;return m}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}function jn(a,n){return a==="=="||a==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function zc(a,n,c,m){return m.compare(n,c)===0}function sa(a,n,c){const m=a!=="=="&&a!=="!=";return class n2{constructor(k,C,I){this.type=Xt,this.lhs=k,this.rhs=C,this.collator=I,this.hasUntypedArgument=k.type.kind==="value"||C.type.kind==="value"}static parse(k,C){if(k.length!==3&&k.length!==4)return C.error("Expected two or three arguments.");const I=k[0];let R=C.parse(k[1],1,hi);if(!R)return null;if(!jn(I,R.type))return C.concat(1).error(`"${I}" comparisons are not supported for type '${G(R.type)}'.`);let F=C.parse(k[2],2,hi);if(!F)return null;if(!jn(I,F.type))return C.concat(2).error(`"${I}" comparisons are not supported for type '${G(F.type)}'.`);if(R.type.kind!==F.type.kind&&R.type.kind!=="value"&&F.type.kind!=="value")return C.error(`Cannot compare types '${G(R.type)}' and '${G(F.type)}'.`);m&&(R.type.kind==="value"&&F.type.kind!=="value"?R=new Fr(F.type,[R]):R.type.kind!=="value"&&F.type.kind==="value"&&(F=new Fr(R.type,[F])));let q=null;if(k.length===4){if(R.type.kind!=="string"&&F.type.kind!=="string"&&R.type.kind!=="value"&&F.type.kind!=="value")return C.error("Cannot use collator to compare non-string types.");if(q=C.parse(k[3],3,xs),!q)return null}return new n2(R,F,q)}evaluate(k){const C=this.lhs.evaluate(k),I=this.rhs.evaluate(k);if(m&&this.hasUntypedArgument){const R=ki(C),F=ki(I);if(R.kind!==F.kind||R.kind!=="string"&&R.kind!=="number")throw new cn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${R.kind}, ${F.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const R=ki(C),F=ki(I);if(R.kind!=="string"||F.kind!=="string")return n(k,C,I)}return this.collator?c(k,C,I,this.collator.evaluate(k)):n(k,C,I)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const wa=sa("==",(function(a,n,c){return n===c}),zc),Rl=sa("!=",(function(a,n,c){return n!==c}),(function(a,n,c,m){return!zc(0,n,c,m)})),ra=sa("<",(function(a,n,c){return n<c}),(function(a,n,c,m){return m.compare(n,c)<0})),Ba=sa(">",(function(a,n,c){return n>c}),(function(a,n,c,m){return m.compare(n,c)>0})),Jo=sa("<=",(function(a,n,c){return n<=c}),(function(a,n,c,m){return m.compare(n,c)<=0})),bs=sa(">=",(function(a,n,c){return n>=c}),(function(a,n,c,m){return m.compare(n,c)>=0}));class aa{constructor(n,c,m){this.type=xs,this.locale=m,this.caseSensitive=n,this.diacriticSensitive=c}static parse(n,c){if(n.length!==2)return c.error("Expected one argument.");const m=n[1];if(typeof m!="object"||Array.isArray(m))return c.error("Collator options argument must be an object.");const x=c.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,Xt);if(!x)return null;const k=c.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,Xt);if(!k)return null;let C=null;return m.locale&&(C=c.parse(m.locale,1,ii),!C)?null:new aa(x,k,C)}evaluate(n){return new mn(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Qo{constructor(n,c,m,x,k){this.type=ii,this.number=n,this.locale=c,this.currency=m,this.minFractionDigits=x,this.maxFractionDigits=k}static parse(n,c){if(n.length!==3)return c.error("Expected two arguments.");const m=c.parse(n[1],1,jt);if(!m)return null;const x=n[2];if(typeof x!="object"||Array.isArray(x))return c.error("NumberFormat options argument must be an object.");let k=null;if(x.locale&&(k=c.parse(x.locale,1,ii),!k))return null;let C=null;if(x.currency&&(C=c.parse(x.currency,1,ii),!C))return null;let I=null;if(x["min-fraction-digits"]&&(I=c.parse(x["min-fraction-digits"],1,jt),!I))return null;let R=null;return x["max-fraction-digits"]&&(R=c.parse(x["max-fraction-digits"],1,jt),!R)?null:new Qo(m,k,C,I,R)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class jo{constructor(n){this.type=Pn,this.sections=n}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");const m=n[1];if(!Array.isArray(m)&&typeof m=="object")return c.error("First argument must be an image or text section.");const x=[];let k=!1;for(let C=1;C<=n.length-1;++C){const I=n[C];if(k&&typeof I=="object"&&!Array.isArray(I)){k=!1;let R=null;if(I["font-scale"]&&(R=c.parse(I["font-scale"],1,jt),!R))return null;let F=null;if(I["text-font"]&&(F=c.parse(I["text-font"],1,te(ii)),!F))return null;let q=null;if(I["text-color"]&&(q=c.parse(I["text-color"],1,Wi),!q))return null;const W=x[x.length-1];W.scale=R,W.font=F,W.textColor=q}else{const R=c.parse(n[C],1,hi);if(!R)return null;const F=R.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,x.push({content:R,scale:null,font:null,textColor:null})}}return new jo(x)}evaluate(n){return new Xs(this.sections.map((c=>{const m=c.content.evaluate(n);return ki(m)===rn?new _r("",m,null,null,null):new _r(In(m),null,c.scale?c.scale.evaluate(n):null,c.font?c.font.evaluate(n).join(","):null,c.textColor?c.textColor.evaluate(n):null)})))}eachChild(n){for(const c of this.sections)n(c.content),c.scale&&n(c.scale),c.font&&n(c.font),c.textColor&&n(c.textColor)}outputDefined(){return!1}}class Rc{constructor(n){this.type=rn,this.input=n}static parse(n,c){if(n.length!==2)return c.error("Expected two arguments.");const m=c.parse(n[1],1,ii);return m?new Rc(m):c.error("No image name provided.")}evaluate(n){const c=this.input.evaluate(n),m=vr.fromString(c);return m&&n.availableImages&&(m.available=n.availableImages.indexOf(c)>-1),m}eachChild(n){n(this.input)}outputDefined(){return!1}}class Ks{constructor(n){this.type=jt,this.input=n}static parse(n,c){if(n.length!==2)return c.error(`Expected 1 argument, but found ${n.length-1} instead.`);const m=c.parse(n[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${G(m.type)} instead.`):new Ks(m):null}evaluate(n){const c=this.input.evaluate(n);if(typeof c=="string")return[...c].length;if(Array.isArray(c))return c.length;throw new cn(`Expected value to be of type string or array, but found ${G(ki(c))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Vs=8192;function Dc(a,n){const c=(180+a[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,x=Math.pow(2,n.z);return[Math.round(c*x*Vs),Math.round(m*x*Vs)]}function Io(a,n){const c=Math.pow(2,n.z);return[(x=(a[0]/Vs+n.x)/c,360*x-180),(m=(a[1]/Vs+n.y)/c,360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90)];var m,x}function Ki(a,n){a[0]=Math.min(a[0],n[0]),a[1]=Math.min(a[1],n[1]),a[2]=Math.max(a[2],n[0]),a[3]=Math.max(a[3],n[1])}function $a(a,n){return!(a[0]<=n[0]||a[2]>=n[2]||a[1]<=n[1]||a[3]>=n[3])}function $i(a,n,c){const m=a[0]-n[0],x=a[1]-n[1],k=a[0]-c[0],C=a[1]-c[1];return m*C-k*x==0&&m*k<=0&&x*C<=0}function oa(a,n,c,m){return(x=[m[0]-c[0],m[1]-c[1]])[0]*(k=[n[0]-a[0],n[1]-a[1]])[1]-x[1]*k[0]!=0&&!(!Oc(a,n,c,m)||!Oc(c,m,a,n));var x,k}function tc(a,n,c){for(const m of c)for(let x=0;x<m.length-1;++x)if(oa(a,n,m[x],m[x+1]))return!0;return!1}function el(a,n,c=!1){let m=!1;for(const I of n)for(let R=0;R<I.length-1;R++){if($i(a,I[R],I[R+1]))return c;(k=I[R])[1]>(x=a)[1]!=(C=I[R+1])[1]>x[1]&&x[0]<(C[0]-k[0])*(x[1]-k[1])/(C[1]-k[1])+k[0]&&(m=!m)}var x,k,C;return m}function _u(a,n){for(const c of n)if(el(a,c))return!0;return!1}function eh(a,n){for(const c of a)if(!el(c,n))return!1;for(let c=0;c<a.length-1;++c)if(tc(a[c],a[c+1],n))return!1;return!0}function th(a,n){for(const c of n)if(eh(a,c))return!0;return!1}function Oc(a,n,c,m){const x=m[0]-c[0],k=m[1]-c[1],C=(a[0]-c[0])*k-x*(a[1]-c[1]),I=(n[0]-c[0])*k-x*(n[1]-c[1]);return C>0&&I<0||C<0&&I>0}function vu(a,n,c){const m=[];for(let x=0;x<a.length;x++){const k=[];for(let C=0;C<a[x].length;C++){const I=Dc(a[x][C],c);Ki(n,I),k.push(I)}m.push(k)}return m}function Nc(a,n,c){const m=[];for(let x=0;x<a.length;x++){const k=vu(a[x],n,c);m.push(k)}return m}function ih(a,n,c,m){if(a[0]<c[0]||a[0]>c[2]){const x=.5*m;let k=a[0]-c[0]>x?-m:c[0]-a[0]>x?m:0;k===0&&(k=a[0]-c[2]>x?-m:c[2]-a[0]>x?m:0),a[0]+=k}Ki(n,a)}function Sa(a,n,c,m){const x=Math.pow(2,m.z)*Vs,k=[m.x*Vs,m.y*Vs],C=[];for(const I of a)for(const R of I){const F=[R.x+k[0],R.y+k[1]];ih(F,n,c,x),C.push(F)}return C}function nh(a,n,c,m){const x=Math.pow(2,m.z)*Vs,k=[m.x*Vs,m.y*Vs],C=[];for(const R of a){const F=[];for(const q of R){const W=[q.x+k[0],q.y+k[1]];Ki(n,W),F.push(W)}C.push(F)}if(n[2]-n[0]<=x/2){(I=n)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const R of C)for(const F of R)ih(F,n,c,x)}var I;return C}class co{constructor(n,c){this.type=Xt,this.geojson=n,this.geometries=c}static parse(n,c){if(n.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(xa(n[1])){const m=n[1];if(m.type==="FeatureCollection"){const x=[];for(const k of m.features){const{type:C,coordinates:I}=k.geometry;C==="Polygon"&&x.push(I),C==="MultiPolygon"&&x.push(...I)}if(x.length)return new co(m,{type:"MultiPolygon",coordinates:x})}else if(m.type==="Feature"){const x=m.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new co(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new co(m,m)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(c,m){const x=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],C=c.canonicalID();if(m.type==="Polygon"){const I=vu(m.coordinates,k,C),R=Sa(c.geometry(),x,k,C);if(!$a(x,k))return!1;for(const F of R)if(!el(F,I))return!1}if(m.type==="MultiPolygon"){const I=Nc(m.coordinates,k,C),R=Sa(c.geometry(),x,k,C);if(!$a(x,k))return!1;for(const F of R)if(!_u(F,I))return!1}return!0})(n,this.geometries);if(n.geometryType()==="LineString")return(function(c,m){const x=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],C=c.canonicalID();if(m.type==="Polygon"){const I=vu(m.coordinates,k,C),R=nh(c.geometry(),x,k,C);if(!$a(x,k))return!1;for(const F of R)if(!eh(F,I))return!1}if(m.type==="MultiPolygon"){const I=Nc(m.coordinates,k,C),R=nh(c.geometry(),x,k,C);if(!$a(x,k))return!1;for(const F of R)if(!th(F,I))return!1}return!0})(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let uo=class{constructor(a=[],n=((c,m)=>c<m?-1:c>m?1:0)){if(this.data=a,this.length=this.data.length,this.compare=n,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:n,compare:c}=this,m=n[a];for(;a>0;){const x=a-1>>1,k=n[x];if(c(m,k)>=0)break;n[a]=k,a=x}n[a]=m}_down(a){const{data:n,compare:c}=this,m=this.length>>1,x=n[a];for(;a<m;){let k=1+(a<<1);const C=k+1;if(C<this.length&&c(n[C],n[k])<0&&(k=C),c(n[k],x)>=0)break;n[a]=n[k],a=k}n[a]=x}};function sh(a,n,c,m,x){xu(a,n,c,m||a.length-1,x||bu)}function xu(a,n,c,m,x){for(;m>c;){if(m-c>600){var k=m-c+1,C=n-c+1,I=Math.log(k),R=.5*Math.exp(2*I/3),F=.5*Math.sqrt(I*R*(k-R)/k)*(C-k/2<0?-1:1);xu(a,n,Math.max(c,Math.floor(n-C*R/k+F)),Math.min(m,Math.floor(n+(k-C)*R/k+F)),x)}var q=a[n],W=c,ee=m;for(tl(a,c,n),x(a[m],q)>0&&tl(a,c,m);W<ee;){for(tl(a,W,ee),W++,ee--;x(a[W],q)<0;)W++;for(;x(a[ee],q)>0;)ee--}x(a[c],q)===0?tl(a,c,ee):tl(a,++ee,m),ee<=n&&(c=ee+1),n<=ee&&(m=ee-1)}}function tl(a,n,c){var m=a[n];a[n]=a[c],a[c]=m}function bu(a,n){return a<n?-1:a>n?1:0}function ic(a,n){if(a.length<=1)return[a];const c=[];let m,x;for(const k of a){const C=Kh(k);C!==0&&(k.area=Math.abs(C),x===void 0&&(x=C<0),x===C<0?(m&&c.push(m),m=[k]):m.push(k))}if(m&&c.push(m),n>1)for(let k=0;k<c.length;k++)c[k].length<=n||(sh(c[k],n,1,c[k].length-1,rh),c[k]=c[k].slice(0,n));return c}function rh(a,n){return n.area-a.area}function Kh(a){let n=0;for(let c,m,x=0,k=a.length,C=k-1;x<k;C=x++)c=a[x],m=a[C],n+=(m.x-c.x)*(c.y+m.y);return n}const wu=1/298.257223563,Bc=wu*(2-wu),ah=Math.PI/180;class $c{constructor(n){const c=6378.137*ah*1e3,m=Math.cos(n*ah),x=1/(1-Bc*(1-m*m)),k=Math.sqrt(x);this.kx=c*k*m,this.ky=c*k*x*(1-Bc)}distance(n,c){const m=this.wrap(n[0]-c[0])*this.kx,x=(n[1]-c[1])*this.ky;return Math.sqrt(m*m+x*x)}pointOnLine(n,c){let m,x,k,C,I=1/0;for(let R=0;R<n.length-1;R++){let F=n[R][0],q=n[R][1],W=this.wrap(n[R+1][0]-F)*this.kx,ee=(n[R+1][1]-q)*this.ky,se=0;W===0&&ee===0||(se=(this.wrap(c[0]-F)*this.kx*W+(c[1]-q)*this.ky*ee)/(W*W+ee*ee),se>1?(F=n[R+1][0],q=n[R+1][1]):se>0&&(F+=W/this.kx*se,q+=ee/this.ky*se)),W=this.wrap(c[0]-F)*this.kx,ee=(c[1]-q)*this.ky;const ue=W*W+ee*ee;ue<I&&(I=ue,m=F,x=q,k=R,C=se)}return{point:[m,x],index:k,t:Math.max(0,Math.min(1,C))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function Su(a,n){return n[0]-a[0]}function il(a){return a[1]-a[0]+1}function xr(a,n){return a[1]>=a[0]&&a[1]<n}function Tu(a,n){if(a[0]>a[1])return[null,null];const c=il(a);if(n){if(c===2)return[a,null];const x=Math.floor(c/2);return[[a[0],a[0]+x],[a[0]+x,a[1]]]}if(c===1)return[a,null];const m=Math.floor(c/2)-1;return[[a[0],a[0]+m],[a[0]+m+1,a[1]]]}function nl(a,n){if(!xr(n,a.length))return[1/0,1/0,-1/0,-1/0];const c=[1/0,1/0,-1/0,-1/0];for(let m=n[0];m<=n[1];++m)Ki(c,a[m]);return c}function Ir(a){const n=[1/0,1/0,-1/0,-1/0];for(const c of a)for(const m of c)Ki(n,m);return n}function sl(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Lo(a,n,c){if(!sl(a)||!sl(n))return NaN;let m=0,x=0;return a[2]<n[0]&&(m=n[0]-a[2]),a[0]>n[2]&&(m=a[0]-n[2]),a[1]>n[3]&&(x=a[1]-n[3]),a[3]<n[1]&&(x=n[1]-a[3]),c.distance([0,0],[m,x])}function rl(a,n,c){const m=c.pointOnLine(n,a);return c.distance(a,m.point)}function Dl(a,n,c,m,x){const k=Math.min(rl(a,[c,m],x),rl(n,[c,m],x)),C=Math.min(rl(c,[a,n],x),rl(m,[a,n],x));return Math.min(k,C)}function Uc(a,n,c,m,x){if(!xr(n,a.length)||!xr(m,c.length))return 1/0;let k=1/0;for(let C=n[0];C<n[1];++C){const I=a[C],R=a[C+1];for(let F=m[0];F<m[1];++F){const q=c[F],W=c[F+1];if(oa(I,R,q,W))return 0;k=Math.min(k,Dl(I,R,q,W,x))}}return k}function fs(a,n,c,m,x){if(!xr(n,a.length)||!xr(m,c.length))return NaN;let k=1/0;for(let C=n[0];C<=n[1];++C)for(let I=m[0];I<=m[1];++I)if(k=Math.min(k,x.distance(a[C],c[I])),k===0)return k;return k}function oh(a,n,c){if(el(a,n,!0))return 0;let m=1/0;for(const x of n){const k=x[0],C=x[x.length-1];if(k!==C&&(m=Math.min(m,rl(a,[C,k],c)),m===0))return m;const I=c.pointOnLine(x,a);if(m=Math.min(m,c.distance(a,I.point)),m===0)return m}return m}function qi(a,n,c,m){if(!xr(n,a.length))return NaN;for(let k=n[0];k<=n[1];++k)if(el(a[k],c,!0))return 0;let x=1/0;for(let k=n[0];k<n[1];++k){const C=a[k],I=a[k+1];for(const R of c)for(let F=0,q=R.length,W=q-1;F<q;W=F++){const ee=R[W],se=R[F];if(oa(C,I,ee,se))return 0;x=Math.min(x,Dl(C,I,ee,se,m))}}return x}function ho(a,n){for(const c of a)for(const m of c)if(el(m,n,!0))return!0;return!1}function hn(a,n,c,m=1/0){const x=Ir(a),k=Ir(n);if(m!==1/0&&Lo(x,k,c)>=m)return m;if($a(x,k)){if(ho(a,n))return 0}else if(ho(n,a))return 0;let C=1/0;for(const I of a)for(let R=0,F=I.length,q=F-1;R<F;q=R++){const W=I[q],ee=I[R];for(const se of n)for(let ue=0,de=se.length,Te=de-1;ue<de;Te=ue++){const Ae=se[Te],Je=se[ue];if(oa(W,ee,Ae,Je))return 0;C=Math.min(C,Dl(W,ee,Ae,Je,c))}}return C}function wn(a,n,c,m,x,k){if(!k)return;const C=Lo(nl(m,k),x,c);C<n&&a.push([C,k,[0,0]])}function al(a,n,c,m,x,k,C){if(!k||!C)return;const I=Lo(nl(m,k),nl(x,C),c);I<n&&a.push([I,k,C])}function Lr(a,n,c,m,x=1/0){let k=Math.min(m.distance(a[0],c[0][0]),x);if(k===0)return k;const C=new uo([[0,[0,a.length-1],[0,0]]],Su),I=Ir(c);for(;C.length>0;){const R=C.pop();if(R[0]>=k)continue;const F=R[1],q=n?50:100;if(il(F)<=q){if(!xr(F,a.length))return NaN;if(n){const W=qi(a,F,c,m);if(isNaN(W)||W===0)return W;k=Math.min(k,W)}else for(let W=F[0];W<=F[1];++W){const ee=oh(a[W],c,m);if(k=Math.min(k,ee),k===0)return 0}}else{const W=Tu(F,n);wn(C,k,m,a,I,W[0]),wn(C,k,m,a,I,W[1])}}return k}function Ol(a,n,c,m,x,k=1/0){let C=Math.min(k,x.distance(a[0],c[0]));if(C===0)return C;const I=new uo([[0,[0,a.length-1],[0,c.length-1]]],Su);for(;I.length>0;){const R=I.pop();if(R[0]>=C)continue;const F=R[1],q=R[2],W=n?50:100,ee=m?50:100;if(il(F)<=W&&il(q)<=ee){if(!xr(F,a.length)&&xr(q,c.length))return NaN;let se;if(n&&m)se=Uc(a,F,c,q,x),C=Math.min(C,se);else if(n&&!m){const ue=a.slice(F[0],F[1]+1);for(let de=q[0];de<=q[1];++de)if(se=rl(c[de],ue,x),C=Math.min(C,se),C===0)return C}else if(!n&&m){const ue=c.slice(q[0],q[1]+1);for(let de=F[0];de<=F[1];++de)if(se=rl(a[de],ue,x),C=Math.min(C,se),C===0)return C}else se=fs(a,F,c,q,x),C=Math.min(C,se)}else{const se=Tu(F,n),ue=Tu(q,m);al(I,C,x,a,c,se[0],ue[0]),al(I,C,x,a,c,se[0],ue[1]),al(I,C,x,a,c,se[1],ue[0]),al(I,C,x,a,c,se[1],ue[1])}}return C}function la(a){return a.type==="MultiPolygon"?a.coordinates.map((n=>({type:"Polygon",coordinates:n}))):a.type==="MultiLineString"?a.coordinates.map((n=>({type:"LineString",coordinates:n}))):a.type==="MultiPoint"?a.coordinates.map((n=>({type:"Point",coordinates:n}))):[a]}class Ta{constructor(n,c){this.type=jt,this.geojson=n,this.geometries=c}static parse(n,c){if(n.length!==2)return c.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(xa(n[1])){const m=n[1];if(m.type==="FeatureCollection")return new Ta(m,m.features.map((x=>la(x.geometry))).flat());if(m.type==="Feature")return new Ta(m,la(m.geometry));if("type"in m&&"coordinates"in m)return new Ta(m,la(m))}return c.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(c,m){const x=c.geometry(),k=x.flat().map((R=>Io([R.x,R.y],c.canonical)));if(x.length===0)return NaN;const C=new $c(k[0][1]);let I=1/0;for(const R of m){switch(R.type){case"Point":I=Math.min(I,Ol(k,!1,[R.coordinates],!1,C,I));break;case"LineString":I=Math.min(I,Ol(k,!1,R.coordinates,!0,C,I));break;case"Polygon":I=Math.min(I,Lr(k,!1,R.coordinates,C,I))}if(I===0)return I}return I})(n,this.geometries);if(n.geometryType()==="LineString")return(function(c,m){const x=c.geometry(),k=x.flat().map((R=>Io([R.x,R.y],c.canonical)));if(x.length===0)return NaN;const C=new $c(k[0][1]);let I=1/0;for(const R of m){switch(R.type){case"Point":I=Math.min(I,Ol(k,!0,[R.coordinates],!1,C,I));break;case"LineString":I=Math.min(I,Ol(k,!0,R.coordinates,!0,C,I));break;case"Polygon":I=Math.min(I,Lr(k,!0,R.coordinates,C,I))}if(I===0)return I}return I})(n,this.geometries);if(n.geometryType()==="Polygon")return(function(c,m){const x=c.geometry();if(x.length===0||x[0].length===0)return NaN;const k=ic(x,0).map((R=>R.map((F=>F.map((q=>Io([q.x,q.y],c.canonical))))))),C=new $c(k[0][0][0][1]);let I=1/0;for(const R of m)for(const F of k){switch(R.type){case"Point":I=Math.min(I,Lr([R.coordinates],!1,F,C,I));break;case"LineString":I=Math.min(I,Lr(R.coordinates,!0,F,C,I));break;case"Polygon":I=Math.min(I,hn(F,R.coordinates,C,I))}if(I===0)return I}return I})(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ua={"==":wa,"!=":Rl,">":Ba,"<":ra,">=":bs,"<=":Jo,array:Fr,at:ba,boolean:Fr,case:qr,coalesce:jr,collator:aa,format:jo,image:Rc,in:Gn,"index-of":Vr,interpolate:Ds,"interpolate-hcl":Ds,"interpolate-lab":Ds,length:Ks,let:Na,literal:gs,match:Mo,number:Fr,"number-format":Qo,object:Fr,slice:Ko,step:lo,string:Fr,"to-boolean":An,"to-color":An,"to-number":An,"to-string":An,var:un,within:co,distance:Ta};class rr{constructor(n,c,m,x){this.name=n,this.type=c,this._evaluate=m,this.args=x}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,c){const m=n[0],x=rr.definitions[m];if(!x)return c.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(x)?x[0]:x.type,C=Array.isArray(x)?[[x[1],x[2]]]:x.overloads,I=C.filter((([F])=>!Array.isArray(F)||F.length===n.length-1));let R=null;for(const[F,q]of I){R=new On(c.registry,Nl,c.path,null,c.scope);const W=[];let ee=!1;for(let se=1;se<n.length;se++){const ue=n[se],de=Array.isArray(F)?F[se-1]:F.type,Te=R.parse(ue,1+W.length,de);if(!Te){ee=!0;break}W.push(Te)}if(!ee)if(Array.isArray(F)&&F.length!==W.length)R.error(`Expected ${F.length} arguments, but found ${W.length} instead.`);else{for(let se=0;se<W.length;se++){const ue=Array.isArray(F)?F[se]:F.type,de=W[se];R.concat(se+1).checkSubtype(ue,de.type)}if(R.errors.length===0)return new rr(m,k,q,W)}}if(I.length===1)c.errors.push(...R.errors);else{const F=(I.length?I:C).map((([W])=>{return ee=W,Array.isArray(ee)?`(${ee.map(G).join(", ")})`:`(${G(ee.type)}...)`;var ee})).join(" | "),q=[];for(let W=1;W<n.length;W++){const ee=c.parse(n[W],1+q.length);if(!ee)return null;q.push(G(ee.type))}c.error(`Expected arguments of type ${F}, but found (${q.join(", ")}) instead.`)}return null}static register(n,c){rr.definitions=c;for(const m in c)n[m]=rr}}function ol(a,[n,c,m,x]){n=n.evaluate(a),c=c.evaluate(a),m=m.evaluate(a);const k=x?x.evaluate(a):1,C=Ao(n,c,m,k);if(C)throw new cn(C);return new vi(n/255,c/255,m/255,k,!1)}function Fc(a,n){return a in n}function ca(a,n){const c=n[a];return c===void 0?null:c}function ua(a){return{type:a}}function Nl(a){if(a instanceof un)return Nl(a.boundExpression);if(a instanceof rr&&a.name==="error"||a instanceof aa||a instanceof co||a instanceof Ta)return!1;const n=a instanceof An||a instanceof Fr;let c=!0;return a.eachChild((m=>{c=n?c&&Nl(m):c&&m instanceof gs})),!!c&&zo(a)&&Hr(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function zo(a){if(a instanceof rr&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof co||a instanceof Ta)return!1;let n=!0;return a.eachChild((c=>{n&&!zo(c)&&(n=!1)})),n}function ll(a){if(a instanceof rr&&a.name==="feature-state")return!1;let n=!0;return a.eachChild((c=>{n&&!ll(c)&&(n=!1)})),n}function Hr(a,n){if(a instanceof rr&&n.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild((m=>{c&&!Hr(m,n)&&(c=!1)})),c}function Vc(a){return{result:"success",value:a}}function Ea(a){return{result:"error",value:a}}function Bl(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Fa(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function qs(a){return!!a.expression&&a.expression.interpolated}function tn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function cl(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function nc(a){return a}function sc(a,n){const c=n.type==="color",m=a.stops&&typeof a.stops[0][0]=="object",x=m||!(m||a.property!==void 0),k=a.type||(qs(n)?"exponential":"interval");if(c||n.type==="padding"){const q=c?vi.parse:Rs.parse;(a=Hn({},a)).stops&&(a.stops=a.stops.map((W=>[W[0],q(W[1])]))),a.default=q(a.default?a.default:n.default)}if(a.colorSpace&&(C=a.colorSpace)!=="rgb"&&C!=="hcl"&&C!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var C;let I,R,F;if(k==="exponential")I=po;else if(k==="interval")I=ul;else if(k==="categorical"){I=fo,R=Object.create(null);for(const q of a.stops)R[q[0]]=q[1];F=typeof a.stops[0][0]}else{if(k!=="identity")throw new Error(`Unknown function type "${k}"`);I=rc}if(m){const q={},W=[];for(let ue=0;ue<a.stops.length;ue++){const de=a.stops[ue],Te=de[0].zoom;q[Te]===void 0&&(q[Te]={zoom:Te,type:a.type,property:a.property,default:a.default,stops:[]},W.push(Te)),q[Te].stops.push([de[0].value,de[1]])}const ee=[];for(const ue of W)ee.push([q[ue].zoom,sc(q[ue],n)]);const se={name:"linear"};return{kind:"composite",interpolationType:se,interpolationFactor:Ds.interpolationFactor.bind(void 0,se),zoomStops:ee.map((ue=>ue[0])),evaluate:({zoom:ue},de)=>po({stops:ee,base:a.base},n,ue).evaluate(ue,de)}}if(x){const q=k==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:q,interpolationFactor:Ds.interpolationFactor.bind(void 0,q),zoomStops:a.stops.map((W=>W[0])),evaluate:({zoom:W})=>I(a,n,W,R,F)}}return{kind:"source",evaluate(q,W){const ee=W&&W.properties?W.properties[a.property]:void 0;return ee===void 0?Va(a.default,n.default):I(a,n,ee,R,F)}}}function Va(a,n,c){return a!==void 0?a:n!==void 0?n:c!==void 0?c:void 0}function fo(a,n,c,m,x){return Va(typeof c===x?m[c]:void 0,a.default,n.default)}function ul(a,n,c){if(tn(c)!=="number")return Va(a.default,n.default);const m=a.stops.length;if(m===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[m-1][0])return a.stops[m-1][1];const x=oo(a.stops.map((k=>k[0])),c);return a.stops[x][1]}function po(a,n,c){const m=a.base!==void 0?a.base:1;if(tn(c)!=="number")return Va(a.default,n.default);const x=a.stops.length;if(x===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[x-1][0])return a.stops[x-1][1];const k=oo(a.stops.map((q=>q[0])),c),C=(function(q,W,ee,se){const ue=se-ee,de=q-ee;return ue===0?0:W===1?de/ue:(Math.pow(W,de)-1)/(Math.pow(W,ue)-1)})(c,m,a.stops[k][0],a.stops[k+1][0]),I=a.stops[k][1],R=a.stops[k+1][1],F=Fs[n.type]||nc;return typeof I.evaluate=="function"?{evaluate(...q){const W=I.evaluate.apply(void 0,q),ee=R.evaluate.apply(void 0,q);if(W!==void 0&&ee!==void 0)return F(W,ee,C,a.colorSpace)}}:F(I,R,C,a.colorSpace)}function rc(a,n,c){switch(n.type){case"color":c=vi.parse(c);break;case"formatted":c=Xs.fromString(c.toString());break;case"resolvedImage":c=vr.fromString(c.toString());break;case"padding":c=Rs.parse(c);break;default:tn(c)===n.type||n.type==="enum"&&n.values[c]||(c=void 0)}return Va(c,a.default,n.default)}rr.register(Ua,{error:[{kind:"error"},[ii],(a,[n])=>{throw new cn(n.evaluate(a))}],typeof:[ii,[hi],(a,[n])=>G(ki(n.evaluate(a)))],"to-rgba":[te(jt,4),[Wi],(a,[n])=>{const[c,m,x,k]=n.evaluate(a).rgb;return[255*c,255*m,255*x,k]}],rgb:[Wi,[jt,jt,jt],ol],rgba:[Wi,[jt,jt,jt,jt],ol],has:{type:Xt,overloads:[[[ii],(a,[n])=>Fc(n.evaluate(a),a.properties())],[[ii,Dn],(a,[n,c])=>Fc(n.evaluate(a),c.evaluate(a))]]},get:{type:hi,overloads:[[[ii],(a,[n])=>ca(n.evaluate(a),a.properties())],[[ii,Dn],(a,[n,c])=>ca(n.evaluate(a),c.evaluate(a))]]},"feature-state":[hi,[ii],(a,[n])=>ca(n.evaluate(a),a.featureState||{})],properties:[Dn,[],a=>a.properties()],"geometry-type":[ii,[],a=>a.geometryType()],id:[hi,[],a=>a.id()],zoom:[jt,[],a=>a.globals.zoom],"heatmap-density":[jt,[],a=>a.globals.heatmapDensity||0],"line-progress":[jt,[],a=>a.globals.lineProgress||0],accumulated:[hi,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[jt,ua(jt),(a,n)=>{let c=0;for(const m of n)c+=m.evaluate(a);return c}],"*":[jt,ua(jt),(a,n)=>{let c=1;for(const m of n)c*=m.evaluate(a);return c}],"-":{type:jt,overloads:[[[jt,jt],(a,[n,c])=>n.evaluate(a)-c.evaluate(a)],[[jt],(a,[n])=>-n.evaluate(a)]]},"/":[jt,[jt,jt],(a,[n,c])=>n.evaluate(a)/c.evaluate(a)],"%":[jt,[jt,jt],(a,[n,c])=>n.evaluate(a)%c.evaluate(a)],ln2:[jt,[],()=>Math.LN2],pi:[jt,[],()=>Math.PI],e:[jt,[],()=>Math.E],"^":[jt,[jt,jt],(a,[n,c])=>Math.pow(n.evaluate(a),c.evaluate(a))],sqrt:[jt,[jt],(a,[n])=>Math.sqrt(n.evaluate(a))],log10:[jt,[jt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN10],ln:[jt,[jt],(a,[n])=>Math.log(n.evaluate(a))],log2:[jt,[jt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN2],sin:[jt,[jt],(a,[n])=>Math.sin(n.evaluate(a))],cos:[jt,[jt],(a,[n])=>Math.cos(n.evaluate(a))],tan:[jt,[jt],(a,[n])=>Math.tan(n.evaluate(a))],asin:[jt,[jt],(a,[n])=>Math.asin(n.evaluate(a))],acos:[jt,[jt],(a,[n])=>Math.acos(n.evaluate(a))],atan:[jt,[jt],(a,[n])=>Math.atan(n.evaluate(a))],min:[jt,ua(jt),(a,n)=>Math.min(...n.map((c=>c.evaluate(a))))],max:[jt,ua(jt),(a,n)=>Math.max(...n.map((c=>c.evaluate(a))))],abs:[jt,[jt],(a,[n])=>Math.abs(n.evaluate(a))],round:[jt,[jt],(a,[n])=>{const c=n.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[jt,[jt],(a,[n])=>Math.floor(n.evaluate(a))],ceil:[jt,[jt],(a,[n])=>Math.ceil(n.evaluate(a))],"filter-==":[Xt,[ii,hi],(a,[n,c])=>a.properties()[n.value]===c.value],"filter-id-==":[Xt,[hi],(a,[n])=>a.id()===n.value],"filter-type-==":[Xt,[ii],(a,[n])=>a.geometryType()===n.value],"filter-<":[Xt,[ii,hi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m<x}],"filter-id-<":[Xt,[hi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c<m}],"filter->":[Xt,[ii,hi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m>x}],"filter-id->":[Xt,[hi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c>m}],"filter-<=":[Xt,[ii,hi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m<=x}],"filter-id-<=":[Xt,[hi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c<=m}],"filter->=":[Xt,[ii,hi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m>=x}],"filter-id->=":[Xt,[hi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c>=m}],"filter-has":[Xt,[hi],(a,[n])=>n.value in a.properties()],"filter-has-id":[Xt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Xt,[te(ii)],(a,[n])=>n.value.indexOf(a.geometryType())>=0],"filter-id-in":[Xt,[te(hi)],(a,[n])=>n.value.indexOf(a.id())>=0],"filter-in-small":[Xt,[ii,te(hi)],(a,[n,c])=>c.value.indexOf(a.properties()[n.value])>=0],"filter-in-large":[Xt,[ii,te(hi)],(a,[n,c])=>(function(m,x,k,C){for(;k<=C;){const I=k+C>>1;if(x[I]===m)return!0;x[I]>m?C=I-1:k=I+1}return!1})(a.properties()[n.value],c.value,0,c.value.length-1)],all:{type:Xt,overloads:[[[Xt,Xt],(a,[n,c])=>n.evaluate(a)&&c.evaluate(a)],[ua(Xt),(a,n)=>{for(const c of n)if(!c.evaluate(a))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],(a,[n,c])=>n.evaluate(a)||c.evaluate(a)],[ua(Xt),(a,n)=>{for(const c of n)if(c.evaluate(a))return!0;return!1}]]},"!":[Xt,[Xt],(a,[n])=>!n.evaluate(a)],"is-supported-script":[Xt,[ii],(a,[n])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(n.evaluate(a))}],upcase:[ii,[ii],(a,[n])=>n.evaluate(a).toUpperCase()],downcase:[ii,[ii],(a,[n])=>n.evaluate(a).toLowerCase()],concat:[ii,ua(hi),(a,n)=>n.map((c=>In(c.evaluate(a)))).join("")],"resolved-locale":[ii,[xs],(a,[n])=>n.evaluate(a).resolvedLocale()]});class Ro{constructor(n,c){var m;this.expression=n,this._warningHistory={},this._evaluator=new Xo,this._defaultValue=c?(m=c).type==="color"&&cl(m.default)?new vi(0,0,0,0):m.type==="color"?vi.parse(m.default)||null:m.type==="padding"?Rs.parse(m.default)||null:m.type==="variableAnchorOffsetCollection"?sr.parse(m.default)||null:m.default===void 0?null:m.default:null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._evaluator.globals=n,this._evaluator.feature=c,this._evaluator.featureState=m,this._evaluator.canonical=x,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)}evaluate(n,c,m,x,k,C){this._evaluator.globals=n,this._evaluator.feature=c||null,this._evaluator.featureState=m||null,this._evaluator.canonical=x,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=C||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new cn(`Expected value to be one of ${Object.keys(this._enumValues).map((R=>JSON.stringify(R))).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function mo(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Ua}function hl(a,n){const c=new On(Ua,Nl,[],n?(function(x){const k={color:Wi,string:ii,number:jt,enum:ii,boolean:Xt,formatted:Pn,padding:Zn,resolvedImage:rn,variableAnchorOffsetCollection:we};return x.type==="array"?te(k[x.value]||hi,x.length):k[x.type]})(n):void 0),m=c.parse(a,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?Vc(new Ro(m,n)):Ea(c.errors)}class Zr{constructor(n,c){this.kind=n,this._styleExpression=c,this.isStateDependent=n!=="constant"&&!ll(c.expression)}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._styleExpression.evaluateWithoutErrorHandling(n,c,m,x,k,C)}evaluate(n,c,m,x,k,C){return this._styleExpression.evaluate(n,c,m,x,k,C)}}class ka{constructor(n,c,m,x){this.kind=n,this.zoomStops=m,this._styleExpression=c,this.isStateDependent=n!=="camera"&&!ll(c.expression),this.interpolationType=x}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._styleExpression.evaluateWithoutErrorHandling(n,c,m,x,k,C)}evaluate(n,c,m,x,k,C){return this._styleExpression.evaluate(n,c,m,x,k,C)}interpolationFactor(n,c,m){return this.interpolationType?Ds.interpolationFactor(this.interpolationType,n,c,m):0}}function $l(a,n){const c=hl(a,n);if(c.result==="error")return c;const m=c.value.expression,x=zo(m);if(!x&&!Bl(n))return Ea([new yn("","data expressions not supported")]);const k=Hr(m,["zoom"]);if(!k&&!Fa(n))return Ea([new yn("","zoom expressions not supported")]);const C=As(m);return C||k?C instanceof yn?Ea([C]):C instanceof Ds&&!qs(n)?Ea([new yn("",'"interpolate" expressions cannot be used with this property')]):Vc(C?new ka(x?"camera":"composite",c.value,C.labels,C instanceof Ds?C.interpolation:void 0):new Zr(x?"constant":"source",c.value)):Ea([new yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class dl{constructor(n,c){this._parameters=n,this._specification=c,Hn(this,sc(this._parameters,this._specification))}static deserialize(n){return new dl(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function As(a){let n=null;if(a instanceof Na)n=As(a.result);else if(a instanceof jr){for(const c of a.args)if(n=As(c),n)break}else(a instanceof lo||a instanceof Ds)&&a.input instanceof rr&&a.input.name==="zoom"&&(n=a);return n instanceof yn||a.eachChild((c=>{const m=As(c);m instanceof yn?n=m:!n&&m?n=new yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&m&&n!==m&&(n=new yn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}function Do(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const n of a.slice(1))if(!Do(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const ac={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function fl(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Do(a)||(a=qc(a));const n=hl(a,ac);if(n.result==="error")throw new Error(n.value.map((c=>`${c.key}: ${c.message}`)).join(", "));return{filter:(c,m,x)=>n.value.evaluate(c,m,{},x),needGeometry:Eu(a)}}function Jh(a,n){return a<n?-1:a>n?1:0}function Eu(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let n=1;n<a.length;n++)if(Eu(a[n]))return!0;return!1}function qc(a){if(!a)return!0;const n=a[0];return a.length<=1?n!=="any":n==="=="?Oo(a[1],a[2],"=="):n==="!="?Wn(Oo(a[1],a[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Oo(a[1],a[2],n):n==="any"?(c=a.slice(1),["any"].concat(c.map(qc))):n==="all"?["all"].concat(a.slice(1).map(qc)):n==="none"?["all"].concat(a.slice(1).map(qc).map(Wn)):n==="in"?Ul(a[1],a.slice(2)):n==="!in"?Wn(Ul(a[1],a.slice(2))):n==="has"?ha(a[1]):n!=="!has"||Wn(ha(a[1]));var c}function Oo(a,n,c){switch(a){case"$type":return[`filter-type-${c}`,n];case"$id":return[`filter-id-${c}`,n];default:return[`filter-${c}`,a,n]}}function Ul(a,n){if(n.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some((c=>typeof c!=typeof n[0]))?["filter-in-large",a,["literal",n.sort(Jh)]]:["filter-in-small",a,["literal",n]]}}function ha(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Wn(a){return["!",a]}function Ca(a){const n=typeof a;if(n==="number"||n==="boolean"||n==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let x="[";for(const k of a)x+=`${Ca(k)},`;return`${x}]`}const c=Object.keys(a).sort();let m="{";for(let x=0;x<c.length;x++)m+=`${JSON.stringify(c[x])}:${Ca(a[c[x]])},`;return`${m}}`}function Gr(a){let n="";for(const c of Cn)n+=`/${Ca(a[c])}`;return n}function br(a){const n=a.value;return n?[new kt(a.key,n,"constants have been deprecated as of v8")]:[]}function ss(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function wr(a){if(Array.isArray(a))return a.map(wr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const n={};for(const c in a)n[c]=wr(a[c]);return n}return ss(a)}function Ms(a){const n=a.key,c=a.value,m=a.valueSpec||{},x=a.objectElementValidators||{},k=a.style,C=a.styleSpec,I=a.validateSpec;let R=[];const F=tn(c);if(F!=="object")return[new kt(n,c,`object expected, ${F} found`)];for(const q in c){const W=q.split(".")[0],ee=m[W]||m["*"];let se;if(x[W])se=x[W];else if(m[W])se=I;else if(x["*"])se=x["*"];else{if(!m["*"]){R.push(new kt(n,c[q],`unknown property "${q}"`));continue}se=I}R=R.concat(se({key:(n&&`${n}.`)+q,value:c[q],valueSpec:ee,style:k,styleSpec:C,object:c,objectKey:q,validateSpec:I},c))}for(const q in m)x[q]||m[q].required&&m[q].default===void 0&&c[q]===void 0&&R.push(new kt(n,c,`missing required property "${q}"`));return R}function pl(a){const n=a.value,c=a.valueSpec,m=a.style,x=a.styleSpec,k=a.key,C=a.arrayElementValidator||a.validateSpec;if(tn(n)!=="array")return[new kt(k,n,`array expected, ${tn(n)} found`)];if(c.length&&n.length!==c.length)return[new kt(k,n,`array length ${c.length} expected, length ${n.length} found`)];if(c["min-length"]&&n.length<c["min-length"])return[new kt(k,n,`array length at least ${c["min-length"]} expected, length ${n.length} found`)];let I={type:c.value,values:c.values};x.$version<7&&(I.function=c.function),tn(c.value)==="object"&&(I=c.value);let R=[];for(let F=0;F<n.length;F++)R=R.concat(C({array:n,arrayIndex:F,value:n[F],valueSpec:I,validateSpec:a.validateSpec,style:m,styleSpec:x,key:`${k}[${F}]`}));return R}function da(a){const n=a.key,c=a.value,m=a.valueSpec;let x=tn(c);return x==="number"&&c!=c&&(x="NaN"),x!=="number"?[new kt(n,c,`number expected, ${x} found`)]:"minimum"in m&&c<m.minimum?[new kt(n,c,`${c} is less than the minimum value ${m.minimum}`)]:"maximum"in m&&c>m.maximum?[new kt(n,c,`${c} is greater than the maximum value ${m.maximum}`)]:[]}function go(a){const n=a.valueSpec,c=ss(a.value.type);let m,x,k,C={};const I=c!=="categorical"&&a.value.property===void 0,R=!I,F=tn(a.value.stops)==="array"&&tn(a.value.stops[0])==="array"&&tn(a.value.stops[0][0])==="object",q=Ms({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(se){if(c==="identity")return[new kt(se.key,se.value,'identity function may not have a "stops" property')];let ue=[];const de=se.value;return ue=ue.concat(pl({key:se.key,value:de,valueSpec:se.valueSpec,validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec,arrayElementValidator:W})),tn(de)==="array"&&de.length===0&&ue.push(new kt(se.key,de,"array must have at least one stop")),ue},default:function(se){return se.validateSpec({key:se.key,value:se.value,valueSpec:n,validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec})}}});return c==="identity"&&I&&q.push(new kt(a.key,a.value,'missing required property "property"')),c==="identity"||a.value.stops||q.push(new kt(a.key,a.value,'missing required property "stops"')),c==="exponential"&&a.valueSpec.expression&&!qs(a.valueSpec)&&q.push(new kt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(R&&!Bl(a.valueSpec)?q.push(new kt(a.key,a.value,"property functions not supported")):I&&!Fa(a.valueSpec)&&q.push(new kt(a.key,a.value,"zoom functions not supported"))),c!=="categorical"&&!F||a.value.property!==void 0||q.push(new kt(a.key,a.value,'"property" property is required')),q;function W(se){let ue=[];const de=se.value,Te=se.key;if(tn(de)!=="array")return[new kt(Te,de,`array expected, ${tn(de)} found`)];if(de.length!==2)return[new kt(Te,de,`array length 2 expected, length ${de.length} found`)];if(F){if(tn(de[0])!=="object")return[new kt(Te,de,`object expected, ${tn(de[0])} found`)];if(de[0].zoom===void 0)return[new kt(Te,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new kt(Te,de,"object stop key must have value")];if(k&&k>ss(de[0].zoom))return[new kt(Te,de[0].zoom,"stop zoom values must appear in ascending order")];ss(de[0].zoom)!==k&&(k=ss(de[0].zoom),x=void 0,C={}),ue=ue.concat(Ms({key:`${Te}[0]`,value:de[0],valueSpec:{zoom:{}},validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec,objectElementValidators:{zoom:da,value:ee}}))}else ue=ue.concat(ee({key:`${Te}[0]`,value:de[0],validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec},de));return mo(wr(de[1]))?ue.concat([new kt(`${Te}[1]`,de[1],"expressions are not allowed in function stops.")]):ue.concat(se.validateSpec({key:`${Te}[1]`,value:de[1],valueSpec:n,validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec}))}function ee(se,ue){const de=tn(se.value),Te=ss(se.value),Ae=se.value!==null?se.value:ue;if(m){if(de!==m)return[new kt(se.key,Ae,`${de} stop domain type must match previous stop domain type ${m}`)]}else m=de;if(de!=="number"&&de!=="string"&&de!=="boolean")return[new kt(se.key,Ae,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&c!=="categorical"){let Je=`number expected, ${de} found`;return Bl(n)&&c===void 0&&(Je+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kt(se.key,Ae,Je)]}return c!=="categorical"||de!=="number"||isFinite(Te)&&Math.floor(Te)===Te?c!=="categorical"&&de==="number"&&x!==void 0&&Te<x?[new kt(se.key,Ae,"stop domain values must appear in ascending order")]:(x=Te,c==="categorical"&&Te in C?[new kt(se.key,Ae,"stop domain values must be unique")]:(C[Te]=!0,[])):[new kt(se.key,Ae,`integer expected, found ${Te}`)]}}function qa(a){const n=(a.expressionContext==="property"?$l:hl)(wr(a.value),a.valueSpec);if(n.result==="error")return n.value.map((m=>new kt(`${a.key}${m.key}`,a.value,m.message)));const c=n.value.expression||n.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!c.outputDefined())return[new kt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!ll(c))return[new kt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!ll(c))return[new kt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Hr(c,["zoom","feature-state"]))return[new kt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!zo(c))return[new kt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Sr(a){const n=a.key,c=a.value,m=a.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(ss(c))===-1&&x.push(new kt(n,c,`expected one of [${m.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(m.values).indexOf(ss(c))===-1&&x.push(new kt(n,c,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(c)} found`)),x}function ku(a){return Do(wr(a.value))?qa(Hn({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Js(a)}function Js(a){const n=a.value,c=a.key;if(tn(n)!=="array")return[new kt(c,n,`array expected, ${tn(n)} found`)];const m=a.styleSpec;let x,k=[];if(n.length<1)return[new kt(c,n,"filter array must have at least 1 element")];switch(k=k.concat(Sr({key:`${c}[0]`,value:n[0],valueSpec:m.filter_operator,style:a.style,styleSpec:a.styleSpec})),ss(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&ss(n[1])==="$type"&&k.push(new kt(c,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&k.push(new kt(c,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(x=tn(n[1]),x!=="string"&&k.push(new kt(`${c}[1]`,n[1],`string expected, ${x} found`)));for(let C=2;C<n.length;C++)x=tn(n[C]),ss(n[1])==="$type"?k=k.concat(Sr({key:`${c}[${C}]`,value:n[C],valueSpec:m.geometry_type,style:a.style,styleSpec:a.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&k.push(new kt(`${c}[${C}]`,n[C],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let C=1;C<n.length;C++)k=k.concat(Js({key:`${c}[${C}]`,value:n[C],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":x=tn(n[1]),n.length!==2?k.push(new kt(c,n,`filter array for "${n[0]}" operator must have 2 elements`)):x!=="string"&&k.push(new kt(`${c}[1]`,n[1],`string expected, ${x} found`))}return k}function Fl(a,n){const c=a.key,m=a.validateSpec,x=a.style,k=a.styleSpec,C=a.value,I=a.objectKey,R=k[`${n}_${a.layerType}`];if(!R)return[];const F=I.match(/^(.*)-transition$/);if(n==="paint"&&F&&R[F[1]]&&R[F[1]].transition)return m({key:c,value:C,valueSpec:k.transition,style:x,styleSpec:k});const q=a.valueSpec||R[I];if(!q)return[new kt(c,C,`unknown property "${I}"`)];let W;if(tn(C)==="string"&&Bl(q)&&!q.tokens&&(W=/^{([^}]+)}$/.exec(C)))return[new kt(c,C,`"${I}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(W[1])} }\`.`)];const ee=[];return a.layerType==="symbol"&&(I==="text-field"&&x&&!x.glyphs&&ee.push(new kt(c,C,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&cl(wr(C))&&ss(C.type)==="identity"&&ee.push(new kt(c,C,'"text-font" does not support identity functions'))),ee.concat(m({key:a.key,value:C,valueSpec:q,style:x,styleSpec:k,expressionContext:"property",propertyType:n,propertyKey:I}))}function Wr(a){return Fl(a,"paint")}function oc(a){return Fl(a,"layout")}function ml(a){let n=[];const c=a.value,m=a.key,x=a.style,k=a.styleSpec;c.type||c.ref||n.push(new kt(m,c,'either "type" or "ref" is required'));let C=ss(c.type);const I=ss(c.ref);if(c.id){const R=ss(c.id);for(let F=0;F<a.arrayIndex;F++){const q=x.layers[F];ss(q.id)===R&&n.push(new kt(m,c.id,`duplicate layer id "${c.id}", previously used at line ${q.id.__line__}`))}}if("ref"in c){let R;["type","source","source-layer","filter","layout"].forEach((F=>{F in c&&n.push(new kt(m,c[F],`"${F}" is prohibited for ref layers`))})),x.layers.forEach((F=>{ss(F.id)===I&&(R=F)})),R?R.ref?n.push(new kt(m,c.ref,"ref cannot reference another ref layer")):C=ss(R.type):n.push(new kt(m,c.ref,`ref layer "${I}" not found`))}else if(C!=="background")if(c.source){const R=x.sources&&x.sources[c.source],F=R&&ss(R.type);R?F==="vector"&&C==="raster"?n.push(new kt(m,c.source,`layer "${c.id}" requires a raster source`)):F!=="raster-dem"&&C==="hillshade"?n.push(new kt(m,c.source,`layer "${c.id}" requires a raster-dem source`)):F==="raster"&&C!=="raster"?n.push(new kt(m,c.source,`layer "${c.id}" requires a vector source`)):F!=="vector"||c["source-layer"]?F==="raster-dem"&&C!=="hillshade"?n.push(new kt(m,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):C!=="line"||!c.paint||!c.paint["line-gradient"]||F==="geojson"&&R.lineMetrics||n.push(new kt(m,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new kt(m,c,`layer "${c.id}" must specify a "source-layer"`)):n.push(new kt(m,c.source,`source "${c.source}" not found`))}else n.push(new kt(m,c,'missing required property "source"'));return n=n.concat(Ms({key:m,value:c,valueSpec:k.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${m}.type`,value:c.type,valueSpec:k.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:c,objectKey:"type"}),filter:ku,layout:R=>Ms({layer:c,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":F=>oc(Hn({layerType:C},F))}}),paint:R=>Ms({layer:c,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":F=>Wr(Hn({layerType:C},F))}})}})),n}function Yr(a){const n=a.value,c=a.key,m=tn(n);return m!=="string"?[new kt(c,n,`string expected, ${m} found`)]:[]}const gl={promoteId:function({key:a,value:n}){if(tn(n)==="string")return Yr({key:a,value:n});{const c=[];for(const m in n)c.push(...Yr({key:`${a}.${m}`,value:n[m]}));return c}}};function yl(a){const n=a.value,c=a.key,m=a.styleSpec,x=a.style,k=a.validateSpec;if(!n.type)return[new kt(c,n,'"type" is required')];const C=ss(n.type);let I;switch(C){case"vector":case"raster":return I=Ms({key:c,value:n,valueSpec:m[`source_${C.replace("-","_")}`],style:a.style,styleSpec:m,objectElementValidators:gl,validateSpec:k}),I;case"raster-dem":return I=(function(R){var F;const q=(F=R.sourceName)!==null&&F!==void 0?F:"",W=R.value,ee=R.styleSpec,se=ee.source_raster_dem,ue=R.style;let de=[];const Te=tn(W);if(W===void 0)return de;if(Te!=="object")return de.push(new kt("source_raster_dem",W,`object expected, ${Te} found`)),de;const Ae=ss(W.encoding)==="custom",Je=["redFactor","greenFactor","blueFactor","baseShift"],Oe=R.value.encoding?`"${R.value.encoding}"`:"Default";for(const We in W)!Ae&&Je.includes(We)?de.push(new kt(We,W[We],`In "${q}": "${We}" is only valid when "encoding" is set to "custom". ${Oe} encoding found`)):se[We]?de=de.concat(R.validateSpec({key:We,value:W[We],valueSpec:se[We],validateSpec:R.validateSpec,style:ue,styleSpec:ee})):de.push(new kt(We,W[We],`unknown property "${We}"`));return de})({sourceName:c,value:n,style:a.style,styleSpec:m,validateSpec:k}),I;case"geojson":if(I=Ms({key:c,value:n,valueSpec:m.source_geojson,style:x,styleSpec:m,validateSpec:k,objectElementValidators:gl}),n.cluster)for(const R in n.clusterProperties){const[F,q]=n.clusterProperties[R],W=typeof F=="string"?[F,["accumulated"],["get",R]]:F;I.push(...qa({key:`${c}.${R}.map`,value:q,expressionContext:"cluster-map"})),I.push(...qa({key:`${c}.${R}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return I;case"video":return Ms({key:c,value:n,valueSpec:m.source_video,style:x,validateSpec:k,styleSpec:m});case"image":return Ms({key:c,value:n,valueSpec:m.source_image,style:x,validateSpec:k,styleSpec:m});case"canvas":return[new kt(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Sr({key:`${c}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function lc(a){const n=a.value,c=a.styleSpec,m=c.light,x=a.style;let k=[];const C=tn(n);if(n===void 0)return k;if(C!=="object")return k=k.concat([new kt("light",n,`object expected, ${C} found`)]),k;for(const I in n){const R=I.match(/^(.*)-transition$/);k=k.concat(R&&m[R[1]]&&m[R[1]].transition?a.validateSpec({key:I,value:n[I],valueSpec:c.transition,validateSpec:a.validateSpec,style:x,styleSpec:c}):m[I]?a.validateSpec({key:I,value:n[I],valueSpec:m[I],validateSpec:a.validateSpec,style:x,styleSpec:c}):[new kt(I,n[I],`unknown property "${I}"`)])}return k}function u(a){const n=a.value,c=a.styleSpec,m=c.sky,x=a.style,k=tn(n);if(n===void 0)return[];if(k!=="object")return[new kt("sky",n,`object expected, ${k} found`)];let C=[];for(const I in n)C=C.concat(m[I]?a.validateSpec({key:I,value:n[I],valueSpec:m[I],style:x,styleSpec:c}):[new kt(I,n[I],`unknown property "${I}"`)]);return C}function b(a){const n=a.value,c=a.styleSpec,m=c.terrain,x=a.style;let k=[];const C=tn(n);if(n===void 0)return k;if(C!=="object")return k=k.concat([new kt("terrain",n,`object expected, ${C} found`)]),k;for(const I in n)k=k.concat(m[I]?a.validateSpec({key:I,value:n[I],valueSpec:m[I],validateSpec:a.validateSpec,style:x,styleSpec:c}):[new kt(I,n[I],`unknown property "${I}"`)]);return k}function M(a){let n=[];const c=a.value,m=a.key;if(Array.isArray(c)){const x=[],k=[];for(const C in c)c[C].id&&x.includes(c[C].id)&&n.push(new kt(m,c,`all the sprites' ids must be unique, but ${c[C].id} is duplicated`)),x.push(c[C].id),c[C].url&&k.includes(c[C].url)&&n.push(new kt(m,c,`all the sprites' URLs must be unique, but ${c[C].url} is duplicated`)),k.push(c[C].url),n=n.concat(Ms({key:`${m}[${C}]`,value:c[C],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return n}return Yr({key:m,value:c})}const $={"*":()=>[],array:pl,boolean:function(a){const n=a.value,c=a.key,m=tn(n);return m!=="boolean"?[new kt(c,n,`boolean expected, ${m} found`)]:[]},number:da,color:function(a){const n=a.key,c=a.value,m=tn(c);return m!=="string"?[new kt(n,c,`color expected, ${m} found`)]:vi.parse(String(c))?[]:[new kt(n,c,`color expected, "${c}" found`)]},constants:br,enum:Sr,filter:ku,function:go,layer:ml,object:Ms,source:yl,light:lc,sky:u,terrain:b,projection:function(a){const n=a.value,c=a.styleSpec,m=c.projection,x=a.style,k=tn(n);if(n===void 0)return[];if(k!=="object")return[new kt("projection",n,`object expected, ${k} found`)];let C=[];for(const I in n)C=C.concat(m[I]?a.validateSpec({key:I,value:n[I],valueSpec:m[I],style:x,styleSpec:c}):[new kt(I,n[I],`unknown property "${I}"`)]);return C},string:Yr,formatted:function(a){return Yr(a).length===0?[]:qa(a)},resolvedImage:function(a){return Yr(a).length===0?[]:qa(a)},padding:function(a){const n=a.key,c=a.value;if(tn(c)==="array"){if(c.length<1||c.length>4)return[new kt(n,c,`padding requires 1 to 4 values; ${c.length} values found`)];const m={type:"number"};let x=[];for(let k=0;k<c.length;k++)x=x.concat(a.validateSpec({key:`${n}[${k}]`,value:c[k],validateSpec:a.validateSpec,valueSpec:m}));return x}return da({key:n,value:c,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const n=a.key,c=a.value,m=tn(c),x=a.styleSpec;if(m!=="array"||c.length<1||c.length%2!=0)return[new kt(n,c,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let C=0;C<c.length;C+=2)k=k.concat(Sr({key:`${n}[${C}]`,value:c[C],valueSpec:x.layout_symbol["text-anchor"]})),k=k.concat(pl({key:`${n}[${C+1}]`,value:c[C+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:x}));return k},sprite:M};function Z(a){const n=a.value,c=a.valueSpec,m=a.styleSpec;return a.validateSpec=Z,c.expression&&cl(ss(n))?go(a):c.expression&&mo(wr(n))?qa(a):c.type&&$[c.type]?$[c.type](a):Ms(Hn({},a,{valueSpec:c.type?m[c.type]:c}))}function ce(a){const n=a.value,c=a.key,m=Yr(a);return m.length||(n.indexOf("{fontstack}")===-1&&m.push(new kt(c,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&m.push(new kt(c,n,'"glyphs" url must include a "{range}" token'))),m}function Ce(a,n=it){let c=[];return c=c.concat(Z({key:"",value:a,valueSpec:n.$root,styleSpec:n,style:a,validateSpec:Z,objectElementValidators:{glyphs:ce,"*":()=>[]}})),a.constants&&(c=c.concat(br({key:"constants",value:a.constants}))),dt(c)}function Xe(a){return function(n){return a({...n,validateSpec:Z})}}function dt(a){return[].concat(a).sort(((n,c)=>n.line-c.line))}function wt(a){return function(...n){return dt(a.apply(this,n))}}Ce.source=wt(Xe(yl)),Ce.sprite=wt(Xe(M)),Ce.glyphs=wt(Xe(ce)),Ce.light=wt(Xe(lc)),Ce.sky=wt(Xe(u)),Ce.terrain=wt(Xe(b)),Ce.layer=wt(Xe(ml)),Ce.filter=wt(Xe(ku)),Ce.paintProperty=wt(Xe(Wr)),Ce.layoutProperty=wt(Xe(oc));const Wt=Ce,xi=Wt.light,nn=Wt.sky,Hs=Wt.paintProperty,ws=Wt.layoutProperty;function Tr(a,n){let c=!1;if(n&&n.length)for(const m of n)a.fire(new ln(new Error(m.message))),c=!0;return c}class _n{constructor(n,c,m){const x=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const C=new Int32Array(this.arrayBuffer);n=C[0],this.d=(c=C[1])+2*(m=C[2]);for(let R=0;R<this.d*this.d;R++){const F=C[3+R],q=C[3+R+1];x.push(F===q?null:C.subarray(F,q))}const I=C[3+x.length+1];this.keys=C.subarray(C[3+x.length],I),this.bboxes=C.subarray(I),this.insert=this._insertReadonly}else{this.d=c+2*m;for(let C=0;C<this.d*this.d;C++)x.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=n,this.padding=m,this.scale=c/n,this.uid=0;const k=m/c*n;this.min=-k,this.max=n+k}insert(n,c,m,x,k){this._forEachCell(c,m,x,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,c,m,x,k,C){this.cells[k].push(C)}query(n,c,m,x,k){const C=this.min,I=this.max;if(n<=C&&c<=C&&I<=m&&I<=x&&!k)return Array.prototype.slice.call(this.keys);{const R=[];return this._forEachCell(n,c,m,x,this._queryCell,R,{},k),R}}_queryCell(n,c,m,x,k,C,I,R){const F=this.cells[k];if(F!==null){const q=this.keys,W=this.bboxes;for(let ee=0;ee<F.length;ee++){const se=F[ee];if(I[se]===void 0){const ue=4*se;(R?R(W[ue+0],W[ue+1],W[ue+2],W[ue+3]):n<=W[ue+2]&&c<=W[ue+3]&&m>=W[ue+0]&&x>=W[ue+1])?(I[se]=!0,C.push(q[se])):I[se]=!1}}}}_forEachCell(n,c,m,x,k,C,I,R){const F=this._convertToCellCoord(n),q=this._convertToCellCoord(c),W=this._convertToCellCoord(m),ee=this._convertToCellCoord(x);for(let se=F;se<=W;se++)for(let ue=q;ue<=ee;ue++){const de=this.d*ue+se;if((!R||R(this._convertFromCellCoord(se),this._convertFromCellCoord(ue),this._convertFromCellCoord(se+1),this._convertFromCellCoord(ue+1)))&&k.call(this,n,c,m,x,de,C,I,R))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,c=3+this.cells.length+1+1;let m=0;for(let C=0;C<this.cells.length;C++)m+=this.cells[C].length;const x=new Int32Array(c+m+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;let k=c;for(let C=0;C<n.length;C++){const I=n[C];x[3+C]=k,x.set(I,k),k+=I.length}return x[3+n.length]=k,x.set(this.keys,k),k+=this.keys.length,x[3+n.length+1]=k,x.set(this.bboxes,k),k+=this.bboxes.length,x.buffer}static serialize(n,c){const m=n.toArrayBuffer();return c&&c.push(m),{buffer:m}}static deserialize(n){return new _n(n.buffer)}}const Yi={};function It(a,n,c={}){if(Yi[a])throw new Error(`${a} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:a,writeable:!1}),Yi[a]={klass:n,omit:c.omit||[],shallow:c.shallow||[]}}It("Object",Object),It("TransferableGridIndex",_n),It("Color",vi),It("Error",Error),It("AJAXError",Ot),It("ResolvedImage",vr),It("StylePropertyFunction",dl),It("StyleExpression",Ro,{omit:["_evaluator"]}),It("ZoomDependentExpression",ka),It("ZoomConstantExpression",Zr),It("CompoundExpression",rr,{omit:["_evaluate"]});for(const a in Ua)Ua[a]._classRegistryKey||It(`Expression_${a}`,Ua[a]);function Aa(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function zr(a){return a.$name||a.constructor._classRegistryKey}function cc(a){return!(function(n){if(n===null||typeof n!="object")return!1;const c=zr(n);return!(!c||c==="Object")})(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Aa(a)||ct(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function Xr(a,n){if(cc(a))return(Aa(a)||ct(a))&&n&&n.push(a),ArrayBuffer.isView(a)&&n&&n.push(a.buffer),a instanceof ImageData&&n&&n.push(a.data.buffer),a;if(Array.isArray(a)){const k=[];for(const C of a)k.push(Xr(C,n));return k}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const c=zr(a);if(!c)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Yi[c])throw new Error(`${c} is not registered.`);const{klass:m}=Yi[c],x=m.serialize?m.serialize(a,n):{};if(m.serialize){if(n&&x===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const k in a){if(!a.hasOwnProperty(k)||Yi[c].omit.indexOf(k)>=0)continue;const C=a[k];x[k]=Yi[c].shallow.indexOf(k)>=0?C:Xr(C,n)}a instanceof Error&&(x.message=a.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(x.$name=c),x}function No(a){if(cc(a))return a;if(Array.isArray(a))return a.map(No);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const n=zr(a)||"Object";if(!Yi[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:c}=Yi[n];if(!c)throw new Error(`can't deserialize unregistered class ${n}`);if(c.deserialize)return c.deserialize(a);const m=Object.create(c.prototype);for(const x of Object.keys(a)){if(x==="$name")continue;const k=a[x];m[x]=Yi[n].shallow.indexOf(x)>=0?k:No(k)}return m}class ps{constructor(){this.first=!0}update(n,c){const m=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=c),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=m,!0))}}const Oi={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function yo(a){for(const n of a)if(Bo(n.charCodeAt(0)))return!0;return!1}function Cu(a){for(const n of a)if(!Kr(n.charCodeAt(0)))return!1;return!0}function _l(a){const n=a.map((c=>{try{return new RegExp(`\\p{sc=${c}}`,"u").source}catch{return null}})).filter((c=>c));return new RegExp(n.join("|"),"u")}const uc=_l(["Arab","Dupl","Mong","Ougr","Syrc"]);function Kr(a){return!uc.test(String.fromCodePoint(a))}const Ha=_l(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Bo(a){return!(a!==746&&a!==747&&(a<4352||!(Oi["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Oi["CJK Compatibility"](a)||Oi["CJK Strokes"](a)||!(!Oi["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Oi["Enclosed CJK Letters and Months"](a)||Oi["Ideographic Description Characters"](a)||Oi.Kanbun(a)||Oi.Katakana(a)&&a!==12540||!(!Oi["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Oi["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Oi["Vertical Forms"](a)||Oi["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Ha.test(String.fromCodePoint(a)))))}function $o(a){return!(Bo(a)||(function(n){return!!(Oi["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Oi["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Oi["Letterlike Symbols"](n)||Oi["Number Forms"](n)||Oi["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Oi["Control Pictures"](n)&&n!==9251||Oi["Optical Character Recognition"](n)||Oi["Enclosed Alphanumerics"](n)||Oi["Geometric Shapes"](n)||Oi["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Oi["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Oi["CJK Symbols and Punctuation"](n)||Oi.Katakana(n)||Oi["Private Use Area"](n)||Oi["CJK Compatibility Forms"](n)||Oi["Small Form Variants"](n)||Oi["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)})(a))}const Qh=_l(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Au(a){return Qh.test(String.fromCodePoint(a))}function Hc(a,n){return!(!n&&Au(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Oi.Khmer(a))}function lh(a){for(const n of a)if(Au(n.charCodeAt(0)))return!0;return!1}const Qs=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Ji{constructor(n,c){this.zoom=n,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ps,this.transition={})}isSupportedScript(n){return(function(c,m){for(const x of c)if(!Hc(x.charCodeAt(0),m))return!1;return!0})(n,Qs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,c=n-Math.floor(n),m=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*c}}}class vl{constructor(n,c){this.property=n,this.value=c,this.expression=(function(m,x){if(cl(m))return new dl(m,x);if(mo(m)){const k=$l(m,x);if(k.result==="error")throw new Error(k.value.map((C=>`${C.key}: ${C.message}`)).join(", "));return k.value}{let k=m;return x.type==="color"&&typeof m=="string"?k=vi.parse(m):x.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(m)&&(k=sr.parse(m)):k=Rs.parse(m),{kind:"constant",evaluate:()=>k}}})(c===void 0?n.specification.default:c,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,c,m){return this.property.possiblyEvaluate(this,n,c,m)}}class Mu{constructor(n){this.property=n,this.value=new vl(n,void 0)}transitioned(n,c){return new rf(this.property,this.value,c,Me({},n.transition,this.transition),n.now)}untransitioned(){return new rf(this.property,this.value,null,{},0)}}class ch{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return lt(this._values[n].value.value)}setValue(n,c){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Mu(this._values[n].property)),this._values[n].value=new vl(this._values[n].property,c===null?void 0:lt(c))}getTransition(n){return lt(this._values[n].transition)}setTransition(n,c){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Mu(this._values[n].property)),this._values[n].transition=lt(c)||void 0}serialize(){const n={};for(const c of Object.keys(this._values)){const m=this.getValue(c);m!==void 0&&(n[c]=m);const x=this.getTransition(c);x!==void 0&&(n[`${c}-transition`]=x)}return n}transitioned(n,c){const m=new Pu(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].transitioned(n,c._values[x]);return m}untransitioned(){const n=new Pu(this._properties);for(const c of Object.keys(this._values))n._values[c]=this._values[c].untransitioned();return n}}class rf{constructor(n,c,m,x,k){this.property=n,this.value=c,this.begin=k+x.delay||0,this.end=this.begin+x.duration||0,n.specification.transition&&(x.delay||x.duration)&&(this.prior=m)}possiblyEvaluate(n,c,m){const x=n.now||0,k=this.value.possiblyEvaluate(n,c,m),C=this.prior;if(C){if(x>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(x<this.begin)return C.possiblyEvaluate(n,c,m);{const I=(x-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(n,c,m),k,(function(R){if(R<=0)return 0;if(R>=1)return 1;const F=R*R,q=F*R;return 4*(R<.5?q:3*(R-F)+q-.75)})(I))}}return k}}class Pu{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,c,m){const x=new xl(this._properties);for(const k of Object.keys(this._values))x._values[k]=this._values[k].possiblyEvaluate(n,c,m);return x}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class ys{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return lt(this._values[n].value)}setValue(n,c){this._values[n]=new vl(this._values[n].property,c===null?void 0:lt(c))}serialize(){const n={};for(const c of Object.keys(this._values)){const m=this.getValue(c);m!==void 0&&(n[c]=m)}return n}possiblyEvaluate(n,c,m){const x=new xl(this._properties);for(const k of Object.keys(this._values))x._values[k]=this._values[k].possiblyEvaluate(n,c,m);return x}}class Za{constructor(n,c,m){this.property=n,this.value=c,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,c,m,x){return this.property.evaluate(this.value,this.parameters,n,c,m,x)}}class xl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class ci{constructor(n){this.specification=n}possiblyEvaluate(n,c){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(c)}interpolate(n,c,m){const x=Fs[this.specification.type];return x?x(n,c,m):n}}class bi{constructor(n,c){this.specification=n,this.overrides=c}possiblyEvaluate(n,c,m,x){return new Za(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(c,null,{},m,x)}:n.expression,c)}interpolate(n,c,m){if(n.value.kind!=="constant"||c.value.kind!=="constant")return n;if(n.value.value===void 0||c.value.value===void 0)return new Za(this,{kind:"constant",value:void 0},n.parameters);const x=Fs[this.specification.type];if(x){const k=x(n.value.value,c.value.value,m);return new Za(this,{kind:"constant",value:k},n.parameters)}return n}evaluate(n,c,m,x,k,C){return n.kind==="constant"?n.value:n.evaluate(c,m,x,k,C)}}class bl extends bi{possiblyEvaluate(n,c,m,x){if(n.value===void 0)return new Za(this,{kind:"constant",value:void 0},c);if(n.expression.kind==="constant"){const k=n.expression.evaluate(c,null,{},m,x),C=n.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,I=this._calculate(C,C,C,c);return new Za(this,{kind:"constant",value:I},c)}if(n.expression.kind==="camera"){const k=this._calculate(n.expression.evaluate({zoom:c.zoom-1}),n.expression.evaluate({zoom:c.zoom}),n.expression.evaluate({zoom:c.zoom+1}),c);return new Za(this,{kind:"constant",value:k},c)}return new Za(this,n.expression,c)}evaluate(n,c,m,x,k,C){if(n.kind==="source"){const I=n.evaluate(c,m,x,k,C);return this._calculate(I,I,I,c)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(c.zoom)-1},m,x),n.evaluate({zoom:Math.floor(c.zoom)},m,x),n.evaluate({zoom:Math.floor(c.zoom)+1},m,x),c):n.value}_calculate(n,c,m,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:n,to:c}:{from:m,to:c}}interpolate(n){return n}}class wl{constructor(n){this.specification=n}possiblyEvaluate(n,c,m,x){if(n.value!==void 0){if(n.expression.kind==="constant"){const k=n.expression.evaluate(c,null,{},m,x);return this._calculate(k,k,k,c)}return this._calculate(n.expression.evaluate(new Ji(Math.floor(c.zoom-1),c)),n.expression.evaluate(new Ji(Math.floor(c.zoom),c)),n.expression.evaluate(new Ji(Math.floor(c.zoom+1),c)),c)}}_calculate(n,c,m,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:n,to:c}:{from:m,to:c}}interpolate(n){return n}}class ed{constructor(n){this.specification=n}possiblyEvaluate(n,c,m,x){return!!n.expression.evaluate(c,null,{},m,x)}interpolate(){return!1}}class E{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in n){const m=n[c];m.specification.overridable&&this.overridableProperties.push(c);const x=this.defaultPropertyValues[c]=new vl(m,void 0),k=this.defaultTransitionablePropertyValues[c]=new Mu(m);this.defaultTransitioningPropertyValues[c]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=x.possiblyEvaluate({})}}}It("DataDrivenProperty",bi),It("DataConstantProperty",ci),It("CrossFadedDataDrivenProperty",bl),It("CrossFadedProperty",wl),It("ColorRampProperty",ed);const i="-transition";class h extends $n{constructor(n,c){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),c.layout&&(this._unevaluatedLayout=new ys(c.layout)),c.paint)){this._transitionablePaint=new ch(c.paint);for(const m in n.paint)this.setPaintProperty(m,n.paint[m],{validate:!1});for(const m in n.layout)this.setLayoutProperty(m,n.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xl(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,c,m={}){c!=null&&this._validate(ws,`layers.${this.id}.layout.${n}`,n,c,m)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,c):this.visibility=c)}getPaintProperty(n){return n.endsWith(i)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,c,m={}){if(c!=null&&this._validate(Hs,`layers.${this.id}.paint.${n}`,n,c,m))return!1;if(n.endsWith(i))return this._transitionablePaint.setTransition(n.slice(0,-11),c||void 0),!1;{const x=this._transitionablePaint._values[n],k=x.property.specification["property-type"]==="cross-faded-data-driven",C=x.value.isDataDriven(),I=x.value;this._transitionablePaint.setValue(n,c),this._handleSpecialPaintPropertyUpdate(n);const R=this._transitionablePaint._values[n].value;return R.isDataDriven()||C||k||this._handleOverridablePaintPropertyUpdate(n,I,R)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,c,m){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,c){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,c)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),He(n,((c,m)=>!(c===void 0||m==="layout"&&!Object.keys(c).length||m==="paint"&&!Object.keys(c).length)))}_validate(n,c,m,x,k={}){return(!k||k.validate!==!1)&&Tr(this,n.call(Wt,{key:c,layerType:this.type,objectKey:m,value:x,styleSpec:it,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const c=this.paint.get(n);if(c instanceof Za&&Bl(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}}const g={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class v{constructor(n,c){this._structArray=n,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class T{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,c){return n._trim(),c&&(n.isTransferred=!0,c.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const c=Object.create(this.prototype);return c.arrayBuffer=n.arrayBuffer,c.length=n.length,c.capacity=n.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function z(a,n=1){let c=0,m=0;return{members:a.map((x=>{const k=g[x.type].BYTES_PER_ELEMENT,C=c=O(c,Math.max(n,k)),I=x.components||1;return m=Math.max(m,k),c+=k*I,{name:x.name,type:x.type,components:I,offset:C}})),size:O(c,Math.max(m,n)),alignment:n}}function O(a,n){return Math.ceil(a/n)*n}class U extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.int16[x+0]=c,this.int16[x+1]=m,n}}U.prototype.bytesPerElement=4,It("StructArrayLayout2i4",U);class H extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.int16[k+0]=c,this.int16[k+1]=m,this.int16[k+2]=x,n}}H.prototype.bytesPerElement=6,It("StructArrayLayout3i6",H);class X extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,n,c,m,x)}emplace(n,c,m,x,k){const C=4*n;return this.int16[C+0]=c,this.int16[C+1]=m,this.int16[C+2]=x,this.int16[C+3]=k,n}}X.prototype.bytesPerElement=8,It("StructArrayLayout4i8",X);class K extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const I=this.length;return this.resize(I+1),this.emplace(I,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,I){const R=6*n;return this.int16[R+0]=c,this.int16[R+1]=m,this.int16[R+2]=x,this.int16[R+3]=k,this.int16[R+4]=C,this.int16[R+5]=I,n}}K.prototype.bytesPerElement=12,It("StructArrayLayout2i4i12",K);class ae extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const I=this.length;return this.resize(I+1),this.emplace(I,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,I){const R=4*n,F=8*n;return this.int16[R+0]=c,this.int16[R+1]=m,this.uint8[F+4]=x,this.uint8[F+5]=k,this.uint8[F+6]=C,this.uint8[F+7]=I,n}}ae.prototype.bytesPerElement=8,It("StructArrayLayout2i4ub8",ae);class fe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.float32[x+0]=c,this.float32[x+1]=m,n}}fe.prototype.bytesPerElement=8,It("StructArrayLayout2f8",fe);class _e extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,I,R,F,q){const W=this.length;return this.resize(W+1),this.emplace(W,n,c,m,x,k,C,I,R,F,q)}emplace(n,c,m,x,k,C,I,R,F,q,W){const ee=10*n;return this.uint16[ee+0]=c,this.uint16[ee+1]=m,this.uint16[ee+2]=x,this.uint16[ee+3]=k,this.uint16[ee+4]=C,this.uint16[ee+5]=I,this.uint16[ee+6]=R,this.uint16[ee+7]=F,this.uint16[ee+8]=q,this.uint16[ee+9]=W,n}}_e.prototype.bytesPerElement=20,It("StructArrayLayout10ui20",_e);class Ee extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,I,R,F,q,W,ee){const se=this.length;return this.resize(se+1),this.emplace(se,n,c,m,x,k,C,I,R,F,q,W,ee)}emplace(n,c,m,x,k,C,I,R,F,q,W,ee,se){const ue=12*n;return this.int16[ue+0]=c,this.int16[ue+1]=m,this.int16[ue+2]=x,this.int16[ue+3]=k,this.uint16[ue+4]=C,this.uint16[ue+5]=I,this.uint16[ue+6]=R,this.uint16[ue+7]=F,this.int16[ue+8]=q,this.int16[ue+9]=W,this.int16[ue+10]=ee,this.int16[ue+11]=se,n}}Ee.prototype.bytesPerElement=24,It("StructArrayLayout4i4ui4i24",Ee);class Pe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.float32[k+0]=c,this.float32[k+1]=m,this.float32[k+2]=x,n}}Pe.prototype.bytesPerElement=12,It("StructArrayLayout3f12",Pe);class Ie extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.uint32[1*n+0]=c,n}}Ie.prototype.bytesPerElement=4,It("StructArrayLayout1ul4",Ie);class Re extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,I,R,F){const q=this.length;return this.resize(q+1),this.emplace(q,n,c,m,x,k,C,I,R,F)}emplace(n,c,m,x,k,C,I,R,F,q){const W=10*n,ee=5*n;return this.int16[W+0]=c,this.int16[W+1]=m,this.int16[W+2]=x,this.int16[W+3]=k,this.int16[W+4]=C,this.int16[W+5]=I,this.uint32[ee+3]=R,this.uint16[W+8]=F,this.uint16[W+9]=q,n}}Re.prototype.bytesPerElement=20,It("StructArrayLayout6i1ul2ui20",Re);class Se extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const I=this.length;return this.resize(I+1),this.emplace(I,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,I){const R=6*n;return this.int16[R+0]=c,this.int16[R+1]=m,this.int16[R+2]=x,this.int16[R+3]=k,this.int16[R+4]=C,this.int16[R+5]=I,n}}Se.prototype.bytesPerElement=12,It("StructArrayLayout2i2i2i12",Se);class $e extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k){const C=this.length;return this.resize(C+1),this.emplace(C,n,c,m,x,k)}emplace(n,c,m,x,k,C){const I=4*n,R=8*n;return this.float32[I+0]=c,this.float32[I+1]=m,this.float32[I+2]=x,this.int16[R+6]=k,this.int16[R+7]=C,n}}$e.prototype.bytesPerElement=16,It("StructArrayLayout2f1f2i16",$e);class Ze extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const I=this.length;return this.resize(I+1),this.emplace(I,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,I){const R=16*n,F=4*n,q=8*n;return this.uint8[R+0]=c,this.uint8[R+1]=m,this.float32[F+1]=x,this.float32[F+2]=k,this.int16[q+6]=C,this.int16[q+7]=I,n}}Ze.prototype.bytesPerElement=16,It("StructArrayLayout2ub2f2i16",Ze);class nt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.uint16[k+0]=c,this.uint16[k+1]=m,this.uint16[k+2]=x,n}}nt.prototype.bytesPerElement=6,It("StructArrayLayout3ui6",nt);class bt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,I,R,F,q,W,ee,se,ue,de,Te,Ae){const Je=this.length;return this.resize(Je+1),this.emplace(Je,n,c,m,x,k,C,I,R,F,q,W,ee,se,ue,de,Te,Ae)}emplace(n,c,m,x,k,C,I,R,F,q,W,ee,se,ue,de,Te,Ae,Je){const Oe=24*n,We=12*n,mt=48*n;return this.int16[Oe+0]=c,this.int16[Oe+1]=m,this.uint16[Oe+2]=x,this.uint16[Oe+3]=k,this.uint32[We+2]=C,this.uint32[We+3]=I,this.uint32[We+4]=R,this.uint16[Oe+10]=F,this.uint16[Oe+11]=q,this.uint16[Oe+12]=W,this.float32[We+7]=ee,this.float32[We+8]=se,this.uint8[mt+36]=ue,this.uint8[mt+37]=de,this.uint8[mt+38]=Te,this.uint32[We+10]=Ae,this.int16[Oe+22]=Je,n}}bt.prototype.bytesPerElement=48,It("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",bt);class $t extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,I,R,F,q,W,ee,se,ue,de,Te,Ae,Je,Oe,We,mt,Dt,Jt,Ti,Ft,Zt,di,li){const ri=this.length;return this.resize(ri+1),this.emplace(ri,n,c,m,x,k,C,I,R,F,q,W,ee,se,ue,de,Te,Ae,Je,Oe,We,mt,Dt,Jt,Ti,Ft,Zt,di,li)}emplace(n,c,m,x,k,C,I,R,F,q,W,ee,se,ue,de,Te,Ae,Je,Oe,We,mt,Dt,Jt,Ti,Ft,Zt,di,li,ri){const vt=32*n,oi=16*n;return this.int16[vt+0]=c,this.int16[vt+1]=m,this.int16[vt+2]=x,this.int16[vt+3]=k,this.int16[vt+4]=C,this.int16[vt+5]=I,this.int16[vt+6]=R,this.int16[vt+7]=F,this.uint16[vt+8]=q,this.uint16[vt+9]=W,this.uint16[vt+10]=ee,this.uint16[vt+11]=se,this.uint16[vt+12]=ue,this.uint16[vt+13]=de,this.uint16[vt+14]=Te,this.uint16[vt+15]=Ae,this.uint16[vt+16]=Je,this.uint16[vt+17]=Oe,this.uint16[vt+18]=We,this.uint16[vt+19]=mt,this.uint16[vt+20]=Dt,this.uint16[vt+21]=Jt,this.uint16[vt+22]=Ti,this.uint32[oi+12]=Ft,this.float32[oi+13]=Zt,this.float32[oi+14]=di,this.uint16[vt+30]=li,this.uint16[vt+31]=ri,n}}$t.prototype.bytesPerElement=64,It("StructArrayLayout8i15ui1ul2f2ui64",$t);class Vt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.float32[1*n+0]=c,n}}Vt.prototype.bytesPerElement=4,It("StructArrayLayout1f4",Vt);class ti extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.uint16[6*n+0]=c,this.float32[k+1]=m,this.float32[k+2]=x,n}}ti.prototype.bytesPerElement=12,It("StructArrayLayout1ui2f12",ti);class qt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=4*n;return this.uint32[2*n+0]=c,this.uint16[k+2]=m,this.uint16[k+3]=x,n}}qt.prototype.bytesPerElement=8,It("StructArrayLayout1ul2ui8",qt);class Ut extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.uint16[x+0]=c,this.uint16[x+1]=m,n}}Ut.prototype.bytesPerElement=4,It("StructArrayLayout2ui4",Ut);class ai extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.uint16[1*n+0]=c,n}}ai.prototype.bytesPerElement=2,It("StructArrayLayout1ui2",ai);class Ai extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,n,c,m,x)}emplace(n,c,m,x,k){const C=4*n;return this.float32[C+0]=c,this.float32[C+1]=m,this.float32[C+2]=x,this.float32[C+3]=k,n}}Ai.prototype.bytesPerElement=16,It("StructArrayLayout4f16",Ai);class Ht extends v{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new N(this.anchorPointX,this.anchorPointY)}}Ht.prototype.size=20;class Yt extends Re{get(n){return new Ht(this,n)}}It("CollisionBoxArray",Yt);class Ci extends v{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ci.prototype.size=48;class Fn extends bt{get(n){return new Ci(this,n)}}It("PlacedSymbolArray",Fn);class Hi extends v{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Hi.prototype.size=64;class an extends $t{get(n){return new Hi(this,n)}}It("SymbolInstanceArray",an);class Nn extends Vt{getoffsetX(n){return this.float32[1*n+0]}}It("GlyphOffsetArray",Nn);class er extends H{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}It("SymbolLineVertexArray",er);class Ga extends v{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ga.prototype.size=12;class Xn extends ti{get(n){return new Ga(this,n)}}It("TextAnchorOffsetArray",Xn);class Rr extends v{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Rr.prototype.size=8;class rs extends qt{get(n){return new Rr(this,n)}}It("FeatureIndexArray",rs);class as extends U{}class Ps extends U{}class Wa extends U{}class hc extends K{}class _o extends ae{}class ar extends fe{}class Ln extends _e{}class dc extends Ee{}class vo extends Pe{}class ji extends Ie{}class dn extends Se{}class os extends Ze{}class fa extends nt{}class js extends Ut{}const Is=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:Dr}=Is;class Qi{constructor(n=[]){this.segments=n}prepareSegment(n,c,m,x){let k=this.segments[this.segments.length-1];return n>Qi.MAX_VERTEX_ARRAY_LENGTH&&Mt(`Max vertices per segment is ${Qi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!k||k.vertexLength+n>Qi.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==x)&&(k={vertexOffset:c.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},x!==void 0&&(k.sortKey=x),this.segments.push(k)),k}get(){return this.segments}destroy(){for(const n of this.segments)for(const c in n.vaos)n.vaos[c].destroy()}static simpleSegment(n,c,m,x){return new Qi([{vertexOffset:n,primitiveOffset:c,vertexLength:m,primitiveLength:x,vaos:{},sortKey:0}])}}function Ya(a,n){return 256*(a=be(Math.floor(a),0,255))+be(Math.floor(n),0,255)}Qi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,It("SegmentVector",Qi);const Zc=z([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ls={exports:{}},uh={exports:{}};uh.exports=function(a,n){var c,m,x,k,C,I,R,F;for(m=a.length-(c=3&a.length),x=n,C=3432918353,I=461845907,F=0;F<m;)R=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,x=27492+(65535&(k=5*(65535&(x=(x^=R=(65535&(R=(R=(65535&R)*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(R=0,c){case 3:R^=(255&a.charCodeAt(F+2))<<16;case 2:R^=(255&a.charCodeAt(F+1))<<8;case 1:x^=R=(65535&(R=(R=(65535&(R^=255&a.charCodeAt(F)))*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295}return x^=a.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0};var td=uh.exports,id={exports:{}};id.exports=function(a,n){for(var c,m=a.length,x=n^m,k=0;m>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(k)|(255&a.charCodeAt(++k))<<8|(255&a.charCodeAt(++k))<<16|(255&a.charCodeAt(++k))<<24))+((1540483477*(c>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),m-=4,++k;switch(m){case 3:x^=(255&a.charCodeAt(k+2))<<16;case 2:x^=(255&a.charCodeAt(k+1))<<8;case 1:x=1540483477*(65535&(x^=255&a.charCodeAt(k)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0};var Sl=td,af=id.exports;ls.exports=Sl,ls.exports.murmur3=Sl,ls.exports.murmur2=af;var Gc=A(ls.exports);class fc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,c,m,x){this.ids.push(Wc(n)),this.positions.push(c,m,x)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Wc(n);let m=0,x=this.ids.length-1;for(;m<x;){const C=m+x>>1;this.ids[C]>=c?x=C:m=C+1}const k=[];for(;this.ids[m]===c;)k.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return k}static serialize(n,c){const m=new Float64Array(n.ids),x=new Uint32Array(n.positions);return or(m,x,0,m.length-1),c&&c.push(m.buffer,x.buffer),{ids:m,positions:x}}static deserialize(n){const c=new fc;return c.ids=n.ids,c.positions=n.positions,c.indexed=!0,c}}function Wc(a){const n=+a;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Gc(String(a))}function or(a,n,c,m){for(;c<m;){const x=a[c+m>>1];let k=c-1,C=m+1;for(;;){do k++;while(a[k]<x);do C--;while(a[C]>x);if(k>=C)break;us(a,k,C),us(n,3*k,3*C),us(n,3*k+1,3*C+1),us(n,3*k+2,3*C+2)}C-c<m-C?(or(a,n,c,C),c=C+1):(or(a,n,C+1,m),m=C)}}function us(a,n,c){const m=a[n];a[n]=a[c],a[c]=m}It("FeaturePositionMap",fc);class Vl{constructor(n,c){this.gl=n.gl,this.location=c}}class Yc extends Vl{constructor(n,c){super(n,c),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class nd extends Vl{constructor(n,c){super(n,c),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class of extends Vl{constructor(n,c){super(n,c),this.current=vi.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const pc=new Float32Array(16);function hh(a){return[Ya(255*a.r,255*a.g),Ya(255*a.b,255*a.a)]}class ju{constructor(n,c,m){this.value=n,this.uniformNames=c.map((x=>`u_${x}`)),this.type=m}setUniform(n,c,m){n.set(m.constantOr(this.value))}getBinding(n,c,m){return this.type==="color"?new of(n,c):new Yc(n,c)}}class Xc{constructor(n,c){this.uniformNames=c.map((m=>`u_${m}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=n.tlbr}setUniform(n,c,m,x){const k=x==="u_pattern_to"?this.patternTo:x==="u_pattern_from"?this.patternFrom:x==="u_pixel_ratio_to"?this.pixelRatioTo:x==="u_pixel_ratio_from"?this.pixelRatioFrom:null;k&&n.set(k)}getBinding(n,c,m){return m.substr(0,9)==="u_pattern"?new nd(n,c):new Yc(n,c)}}class ql{constructor(n,c,m,x){this.expression=n,this.type=m,this.maxValue=0,this.paintVertexAttributes=c.map((k=>({name:`a_${k}`,type:"Float32",components:m==="color"?2:1,offset:0}))),this.paintVertexArray=new x}populatePaintArray(n,c,m,x,k){const C=this.paintVertexArray.length,I=this.expression.evaluate(new Ji(0),c,{},x,[],k);this.paintVertexArray.resize(n),this._setPaintValue(C,n,I)}updatePaintArray(n,c,m,x){const k=this.expression.evaluate({zoom:0},m,x);this._setPaintValue(n,c,k)}_setPaintValue(n,c,m){if(this.type==="color"){const x=hh(m);for(let k=n;k<c;k++)this.paintVertexArray.emplace(k,x[0],x[1])}else{for(let x=n;x<c;x++)this.paintVertexArray.emplace(x,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Uo{constructor(n,c,m,x,k,C){this.expression=n,this.uniformNames=c.map((I=>`u_${I}_t`)),this.type=m,this.useIntegerZoom=x,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=c.map((I=>({name:`a_${I}`,type:"Float32",components:m==="color"?4:2,offset:0}))),this.paintVertexArray=new C}populatePaintArray(n,c,m,x,k){const C=this.expression.evaluate(new Ji(this.zoom),c,{},x,[],k),I=this.expression.evaluate(new Ji(this.zoom+1),c,{},x,[],k),R=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(R,n,C,I)}updatePaintArray(n,c,m,x){const k=this.expression.evaluate({zoom:this.zoom},m,x),C=this.expression.evaluate({zoom:this.zoom+1},m,x);this._setPaintValue(n,c,k,C)}_setPaintValue(n,c,m,x){if(this.type==="color"){const k=hh(m),C=hh(x);for(let I=n;I<c;I++)this.paintVertexArray.emplace(I,k[0],k[1],C[0],C[1])}else{for(let k=n;k<c;k++)this.paintVertexArray.emplace(k,m,x);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(x))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,c){const m=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,x=be(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);n.set(x)}getBinding(n,c,m){return new Yc(n,c)}}class mc{constructor(n,c,m,x,k,C){this.expression=n,this.type=c,this.useIntegerZoom=m,this.zoom=x,this.layerId=C,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(n,c,m){const x=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(x,n,c.patterns&&c.patterns[this.layerId],m)}updatePaintArray(n,c,m,x,k){this._setPaintValues(n,c,m.patterns&&m.patterns[this.layerId],k)}_setPaintValues(n,c,m,x){if(!x||!m)return;const{min:k,mid:C,max:I}=m,R=x[k],F=x[C],q=x[I];if(R&&F&&q)for(let W=n;W<c;W++)this.zoomInPaintVertexArray.emplace(W,F.tl[0],F.tl[1],F.br[0],F.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],F.pixelRatio,R.pixelRatio),this.zoomOutPaintVertexArray.emplace(W,F.tl[0],F.tl[1],F.br[0],F.br[1],q.tl[0],q.tl[1],q.br[0],q.br[1],F.pixelRatio,q.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Zc.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Zc.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class yp{constructor(n,c,m){this.binders={},this._buffers=[];const x=[];for(const k in n.paint._values){if(!m(k))continue;const C=n.paint.get(k);if(!(C instanceof Za&&Bl(C.property.specification)))continue;const I=ng(k,n.type),R=C.value,F=C.property.specification.type,q=C.property.useIntegerZoom,W=C.property.specification["property-type"],ee=W==="cross-faded"||W==="cross-faded-data-driven";if(R.kind==="constant")this.binders[k]=ee?new Xc(R.value,I):new ju(R.value,I,F),x.push(`/u_${k}`);else if(R.kind==="source"||ee){const se=lf(k,F,"source");this.binders[k]=ee?new mc(R,F,q,c,se,n.id):new ql(R,I,F,se),x.push(`/a_${k}`)}else{const se=lf(k,F,"composite");this.binders[k]=new Uo(R,I,F,q,c,se),x.push(`/z_${k}`)}}this.cacheKey=x.sort().join("")}getMaxValue(n){const c=this.binders[n];return c instanceof ql||c instanceof Uo?c.maxValue:0}populatePaintArrays(n,c,m,x,k){for(const C in this.binders){const I=this.binders[C];(I instanceof ql||I instanceof Uo||I instanceof mc)&&I.populatePaintArray(n,c,m,x,k)}}setConstantPatternPositions(n,c){for(const m in this.binders){const x=this.binders[m];x instanceof Xc&&x.setConstantPatternPositions(n,c)}}updatePaintArrays(n,c,m,x,k){let C=!1;for(const I in n){const R=c.getPositions(I);for(const F of R){const q=m.feature(F.index);for(const W in this.binders){const ee=this.binders[W];if((ee instanceof ql||ee instanceof Uo||ee instanceof mc)&&ee.expression.isStateDependent===!0){const se=x.paint.get(W);ee.expression=se.value,ee.updatePaintArray(F.start,F.end,q,n[I],k),C=!0}}}}return C}defines(){const n=[];for(const c in this.binders){const m=this.binders[c];(m instanceof ju||m instanceof Xc)&&n.push(...m.uniformNames.map((x=>`#define HAS_UNIFORM_${x}`)))}return n}getBinderAttributes(){const n=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof ql||m instanceof Uo)for(let x=0;x<m.paintVertexAttributes.length;x++)n.push(m.paintVertexAttributes[x].name);else if(m instanceof mc)for(let x=0;x<Zc.members.length;x++)n.push(Zc.members[x].name)}return n}getBinderUniforms(){const n=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof ju||m instanceof Xc||m instanceof Uo)for(const x of m.uniformNames)n.push(x)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,c){const m=[];for(const x in this.binders){const k=this.binders[x];if(k instanceof ju||k instanceof Xc||k instanceof Uo){for(const C of k.uniformNames)if(c[C]){const I=k.getBinding(n,c[C],C);m.push({name:C,property:x,binding:I})}}}return m}setUniforms(n,c,m,x){for(const{name:k,property:C,binding:I}of c)this.binders[C].setUniform(I,x,m.get(C),k)}updatePaintBuffers(n){this._buffers=[];for(const c in this.binders){const m=this.binders[c];if(n&&m instanceof mc){const x=n.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;x&&this._buffers.push(x)}else(m instanceof ql||m instanceof Uo)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(n){for(const c in this.binders){const m=this.binders[c];(m instanceof ql||m instanceof Uo||m instanceof mc)&&m.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const c=this.binders[n];(c instanceof ql||c instanceof Uo||c instanceof mc)&&c.destroy()}}}class Kc{constructor(n,c,m=(()=>!0)){this.programConfigurations={};for(const x of n)this.programConfigurations[x.id]=new yp(x,c,m);this.needsUpload=!1,this._featureMap=new fc,this._bufferOffset=0}populatePaintArrays(n,c,m,x,k,C){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(n,c,x,k,C);c.id!==void 0&&this._featureMap.add(c.id,m,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,c,m,x){for(const k of m)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(n,this._featureMap,c,k,x)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function ng(a,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${n}-`,"").replace(/-/g,"_")]}function lf(a,n,c){const m={color:{source:fe,composite:Ai},number:{source:Vt,composite:fe}},x=(function(k){return{"line-pattern":{source:Ln,composite:Ln},"fill-pattern":{source:Ln,composite:Ln},"fill-extrusion-pattern":{source:Ln,composite:Ln}}[k]})(a);return x&&x[c]||m[n][c]}It("ConstantBinder",ju),It("CrossFadedConstantBinder",Xc),It("SourceExpressionBinder",ql),It("CrossFadedCompositeBinder",mc),It("CompositeExpressionBinder",Uo),It("ProgramConfiguration",yp,{omit:["_buffers"]}),It("ProgramConfigurationSet",Kc);const Os=8192,_p=Math.pow(2,14)-1,vp=-_p-1;function Jc(a){const n=Os/a.extent,c=a.loadGeometry();for(let m=0;m<c.length;m++){const x=c[m];for(let k=0;k<x.length;k++){const C=x[k],I=Math.round(C.x*n),R=Math.round(C.y*n);C.x=be(I,vp,_p),C.y=be(R,vp,_p),(I<C.x||I>C.x+1||R<C.y||R>C.y+1)&&Mt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Qc(a,n){return{type:a.type,id:a.id,properties:a.properties,geometry:n?Jc(a):[]}}function dh(a,n,c,m,x){a.emplaceBack(2*n+(m+1)/2,2*c+(x+1)/2)}class cf{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Ps,this.indexArray=new fa,this.segments=new Qi,this.programConfigurations=new Kc(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){const x=this.layers[0],k=[];let C=null,I=!1;x.type==="circle"&&(C=x.layout.get("circle-sort-key"),I=!C.isConstant());for(const{feature:R,id:F,index:q,sourceLayerIndex:W}of n){const ee=this.layers[0]._featureFilter.needGeometry,se=Qc(R,ee);if(!this.layers[0]._featureFilter.filter(new Ji(this.zoom),se,m))continue;const ue=I?C.evaluate(se,{},m):void 0,de={id:F,properties:R.properties,type:R.type,sourceLayerIndex:W,index:q,geometry:ee?se.geometry:Jc(R),patterns:{},sortKey:ue};k.push(de)}I&&k.sort(((R,F)=>R.sortKey-F.sortKey));for(const R of k){const{geometry:F,index:q,sourceLayerIndex:W}=R,ee=n[q].feature;this.addFeature(R,F,q,m),c.featureIndex.insert(ee,F,q,W,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Dr),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,c,m,x){for(const k of c)for(const C of k){const I=C.x,R=C.y;if(I<0||I>=Os||R<0||R>=Os)continue;const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),q=F.vertexLength;dh(this.layoutVertexArray,I,R,-1,-1),dh(this.layoutVertexArray,I,R,1,-1),dh(this.layoutVertexArray,I,R,1,1),dh(this.layoutVertexArray,I,R,-1,1),this.indexArray.emplaceBack(q,q+1,q+2),this.indexArray.emplaceBack(q,q+3,q+2),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,{},x)}}function xp(a,n){for(let c=0;c<a.length;c++)if(gc(n,a[c]))return!0;for(let c=0;c<n.length;c++)if(gc(a,n[c]))return!0;return!!wp(a,n)}function sg(a,n,c){return!!gc(a,n)||!!eu(n,a,c)}function bp(a,n){if(a.length===1)return sd(n,a[0]);for(let c=0;c<n.length;c++){const m=n[c];for(let x=0;x<m.length;x++)if(gc(a,m[x]))return!0}for(let c=0;c<a.length;c++)if(sd(n,a[c]))return!0;for(let c=0;c<n.length;c++)if(wp(a,n[c]))return!0;return!1}function rg(a,n,c){if(a.length>1){if(wp(a,n))return!0;for(let m=0;m<n.length;m++)if(eu(n[m],a,c))return!0}for(let m=0;m<a.length;m++)if(eu(a[m],n,c))return!0;return!1}function wp(a,n){if(a.length===0||n.length===0)return!1;for(let c=0;c<a.length-1;c++){const m=a[c],x=a[c+1];for(let k=0;k<n.length-1;k++)if(ag(m,x,n[k],n[k+1]))return!0}return!1}function ag(a,n,c,m){return et(a,c,m)!==et(n,c,m)&&et(a,n,c)!==et(a,n,m)}function eu(a,n,c){const m=c*c;if(n.length===1)return a.distSqr(n[0])<m;for(let x=1;x<n.length;x++)if(Sp(a,n[x-1],n[x])<m)return!0;return!1}function Sp(a,n,c){const m=n.distSqr(c);if(m===0)return a.distSqr(n);const x=((a.x-n.x)*(c.x-n.x)+(a.y-n.y)*(c.y-n.y))/m;return a.distSqr(x<0?n:x>1?c:c.sub(n)._mult(x)._add(n))}function sd(a,n){let c,m,x,k=!1;for(let C=0;C<a.length;C++){c=a[C];for(let I=0,R=c.length-1;I<c.length;R=I++)m=c[I],x=c[R],m.y>n.y!=x.y>n.y&&n.x<(x.x-m.x)*(n.y-m.y)/(x.y-m.y)+m.x&&(k=!k)}return k}function gc(a,n){let c=!1;for(let m=0,x=a.length-1;m<a.length;x=m++){const k=a[m],C=a[x];k.y>n.y!=C.y>n.y&&n.x<(C.x-k.x)*(n.y-k.y)/(C.y-k.y)+k.x&&(c=!c)}return c}function og(a,n,c){const m=c[0],x=c[2];if(a.x<m.x&&n.x<m.x||a.x>x.x&&n.x>x.x||a.y<m.y&&n.y<m.y||a.y>x.y&&n.y>x.y)return!1;const k=et(a,n,c[0]);return k!==et(a,n,c[1])||k!==et(a,n,c[2])||k!==et(a,n,c[3])}function Iu(a,n,c){const m=n.paint.get(a).value;return m.kind==="constant"?m.value:c.programConfigurations.get(n.id).getMaxValue(a)}function uf(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function rd(a,n,c,m,x){if(!n[0]&&!n[1])return a;const k=N.convert(n)._mult(x);c==="viewport"&&k._rotate(-m);const C=[];for(let I=0;I<a.length;I++)C.push(a[I].sub(k));return C}let Tp,Ep;It("CircleBucket",cf,{omit:["layers"]});var lg={get paint(){return Ep=Ep||new E({"circle-radius":new bi(it.paint_circle["circle-radius"]),"circle-color":new bi(it.paint_circle["circle-color"]),"circle-blur":new bi(it.paint_circle["circle-blur"]),"circle-opacity":new bi(it.paint_circle["circle-opacity"]),"circle-translate":new ci(it.paint_circle["circle-translate"]),"circle-translate-anchor":new ci(it.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ci(it.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ci(it.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bi(it.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bi(it.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bi(it.paint_circle["circle-stroke-opacity"])})},get layout(){return Tp=Tp||new E({"circle-sort-key":new bi(it.layout_circle["circle-sort-key"])})}},Jr=1e-6,tu=typeof Float32Array<"u"?Float32Array:Array;function hf(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function kp(a,n,c){var m=n[0],x=n[1],k=n[2],C=n[3],I=n[4],R=n[5],F=n[6],q=n[7],W=n[8],ee=n[9],se=n[10],ue=n[11],de=n[12],Te=n[13],Ae=n[14],Je=n[15],Oe=c[0],We=c[1],mt=c[2],Dt=c[3];return a[0]=Oe*m+We*I+mt*W+Dt*de,a[1]=Oe*x+We*R+mt*ee+Dt*Te,a[2]=Oe*k+We*F+mt*se+Dt*Ae,a[3]=Oe*C+We*q+mt*ue+Dt*Je,a[4]=(Oe=c[4])*m+(We=c[5])*I+(mt=c[6])*W+(Dt=c[7])*de,a[5]=Oe*x+We*R+mt*ee+Dt*Te,a[6]=Oe*k+We*F+mt*se+Dt*Ae,a[7]=Oe*C+We*q+mt*ue+Dt*Je,a[8]=(Oe=c[8])*m+(We=c[9])*I+(mt=c[10])*W+(Dt=c[11])*de,a[9]=Oe*x+We*R+mt*ee+Dt*Te,a[10]=Oe*k+We*F+mt*se+Dt*Ae,a[11]=Oe*C+We*q+mt*ue+Dt*Je,a[12]=(Oe=c[12])*m+(We=c[13])*I+(mt=c[14])*W+(Dt=c[15])*de,a[13]=Oe*x+We*R+mt*ee+Dt*Te,a[14]=Oe*k+We*F+mt*se+Dt*Ae,a[15]=Oe*C+We*q+mt*ue+Dt*Je,a}Math.hypot||(Math.hypot=function(){for(var a=0,n=arguments.length;n--;)a+=arguments[n]*arguments[n];return Math.sqrt(a)});var Lu,cg=kp;function ad(a,n,c){var m=n[0],x=n[1],k=n[2],C=n[3];return a[0]=c[0]*m+c[4]*x+c[8]*k+c[12]*C,a[1]=c[1]*m+c[5]*x+c[9]*k+c[13]*C,a[2]=c[2]*m+c[6]*x+c[10]*k+c[14]*C,a[3]=c[3]*m+c[7]*x+c[11]*k+c[15]*C,a}Lu=new tu(4),tu!=Float32Array&&(Lu[0]=0,Lu[1]=0,Lu[2]=0,Lu[3]=0);class __ extends h{constructor(n){super(n,lg)}createBucket(n){return new cf(n)}queryRadius(n){const c=n;return Iu("circle-radius",this,c)+Iu("circle-stroke-width",this,c)+uf(this.paint.get("circle-translate"))}queryIntersectsFeature(n,c,m,x,k,C,I,R){const F=rd(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),C.angle,I),q=this.paint.get("circle-radius").evaluate(c,m)+this.paint.get("circle-stroke-width").evaluate(c,m),W=this.paint.get("circle-pitch-alignment")==="map",ee=W?F:(function(ue,de){return ue.map((Te=>df(Te,de)))})(F,R),se=W?q*I:q;for(const ue of x)for(const de of ue){const Te=W?de:df(de,R);let Ae=se;const Je=ad([],[de.x,de.y,0,1],R);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ae*=Je[3]/C.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ae*=C.cameraToCenterDistance/Je[3]),sg(ee,Te,Ae))return!0}return!1}}function df(a,n){const c=ad([],[a.x,a.y,0,1],n);return new N(c[0]/c[3],c[1]/c[3])}class Cp extends cf{}let Ap;It("HeatmapBucket",Cp,{omit:["layers"]});var Mp={get paint(){return Ap=Ap||new E({"heatmap-radius":new bi(it.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bi(it.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ci(it.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ed(it.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ci(it.paint_heatmap["heatmap-opacity"])})}};function ff(a,{width:n,height:c},m,x){if(x){if(x instanceof Uint8ClampedArray)x=new Uint8Array(x.buffer);else if(x.length!==n*c*m)throw new RangeError(`mismatched image size. expected: ${x.length} but got: ${n*c*m}`)}else x=new Uint8Array(n*c*m);return a.width=n,a.height=c,a.data=x,a}function Pp(a,{width:n,height:c},m){if(n===a.width&&c===a.height)return;const x=ff({},{width:n,height:c},m);jp(a,x,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,n),height:Math.min(a.height,c)},m),a.width=n,a.height=c,a.data=x.data}function jp(a,n,c,m,x,k){if(x.width===0||x.height===0)return n;if(x.width>a.width||x.height>a.height||c.x>a.width-x.width||c.y>a.height-x.height)throw new RangeError("out of range source coordinates for image copy");if(x.width>n.width||x.height>n.height||m.x>n.width-x.width||m.y>n.height-x.height)throw new RangeError("out of range destination coordinates for image copy");const C=a.data,I=n.data;if(C===I)throw new Error("srcData equals dstData, so image is already copied");for(let R=0;R<x.height;R++){const F=((c.y+R)*a.width+c.x)*k,q=((m.y+R)*n.width+m.x)*k;for(let W=0;W<x.width*k;W++)I[q+W]=C[F+W]}return n}class od{constructor(n,c){ff(this,n,1,c)}resize(n){Pp(this,n,1)}clone(){return new od({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,c,m,x,k){jp(n,c,m,x,k,1)}}class Xa{constructor(n,c){ff(this,n,4,c)}resize(n){Pp(this,n,4)}replace(n,c){c?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Xa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,c,m,x,k){jp(n,c,m,x,k,4)}}function fh(a){const n={},c=a.resolution||256,m=a.clips?a.clips.length:1,x=a.image||new Xa({width:c,height:m});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const k=(C,I,R)=>{n[a.evaluationKey]=R;const F=a.expression.evaluate(n);x.data[C+I+0]=Math.floor(255*F.r/F.a),x.data[C+I+1]=Math.floor(255*F.g/F.a),x.data[C+I+2]=Math.floor(255*F.b/F.a),x.data[C+I+3]=Math.floor(255*F.a)};if(a.clips)for(let C=0,I=0;C<m;++C,I+=4*c)for(let R=0,F=0;R<c;R++,F+=4){const q=R/(c-1),{start:W,end:ee}=a.clips[C];k(I,F,W*(1-q)+ee*q)}else for(let C=0,I=0;C<c;C++,I+=4)k(0,I,C/(c-1));return x}It("AlphaImage",od),It("RGBAImage",Xa);const ld="big-fb";class pf extends h{createBucket(n){return new Cp(n)}constructor(n){super(n,Mp),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=fh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ld)&&this.heatmapFbos.delete(ld)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ip;var ug={get paint(){return Ip=Ip||new E({"hillshade-illumination-direction":new ci(it.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ci(it.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ci(it.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ci(it.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ci(it.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ci(it.paint_hillshade["hillshade-accent-color"])})}};class cd extends h{constructor(n){super(n,ug)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const hg=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:Lp}=hg;function zp(a,n,c=2){const m=n&&n.length,x=m?n[0]*c:a.length;let k=mf(a,0,x,c,!0);const C=[];if(!k||k.next===k.prev)return C;let I,R,F;if(m&&(k=(function(q,W,ee,se){const ue=[];for(let de=0,Te=W.length;de<Te;de++){const Ae=mf(q,W[de]*se,de<Te-1?W[de+1]*se:q.length,se,!1);Ae===Ae.next&&(Ae.steiner=!0),ue.push(yg(Ae))}ue.sort(mg);for(let de=0;de<ue.length;de++)ee=gf(ue[de],ee);return ee})(a,n,k,c)),a.length>80*c){I=1/0,R=1/0;let q=-1/0,W=-1/0;for(let ee=c;ee<x;ee+=c){const se=a[ee],ue=a[ee+1];se<I&&(I=se),ue<R&&(R=ue),se>q&&(q=se),ue>W&&(W=ue)}F=Math.max(q-I,W-R),F=F!==0?32767/F:0}return ph(k,C,c,I,R,F,0),C}function mf(a,n,c,m,x){let k;if(x===(function(C,I,R,F){let q=0;for(let W=I,ee=R-F;W<R;W+=F)q+=(C[ee]-C[W])*(C[W+1]+C[ee+1]),ee=W;return q})(a,n,c,m)>0)for(let C=n;C<c;C+=m)k=gh(C/m|0,a[C],a[C+1],k);else for(let C=c-m;C>=n;C-=m)k=gh(C/m|0,a[C],a[C+1],k);return k&&Ns(k,k.next)&&(yh(k),k=k.next),k}function yc(a,n){if(!a)return a;n||(n=a);let c,m=a;do if(c=!1,m.steiner||!Ns(m,m.next)&&Ss(m.prev,m,m.next)!==0)m=m.next;else{if(yh(m),m=n=m.prev,m===m.next)break;c=!0}while(c||m!==n);return n}function ph(a,n,c,m,x,k,C){if(!a)return;!C&&k&&(function(R,F,q,W){let ee=R;do ee.z===0&&(ee.z=ud(ee.x,ee.y,F,q,W)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==R);ee.prevZ.nextZ=null,ee.prevZ=null,(function(se){let ue,de=1;do{let Te,Ae=se;se=null;let Je=null;for(ue=0;Ae;){ue++;let Oe=Ae,We=0;for(let Dt=0;Dt<de&&(We++,Oe=Oe.nextZ,Oe);Dt++);let mt=de;for(;We>0||mt>0&&Oe;)We!==0&&(mt===0||!Oe||Ae.z<=Oe.z)?(Te=Ae,Ae=Ae.nextZ,We--):(Te=Oe,Oe=Oe.nextZ,mt--),Je?Je.nextZ=Te:se=Te,Te.prevZ=Je,Je=Te;Ae=Oe}Je.nextZ=null,de*=2}while(ue>1)})(ee)})(a,m,x,k);let I=a;for(;a.prev!==a.next;){const R=a.prev,F=a.next;if(k?zu(a,m,x,k):dg(a))n.push(R.i,a.i,F.i),yh(a),a=F.next,I=F.next;else if((a=F)===I){C?C===1?ph(a=fg(yc(a),n),n,c,m,x,k,2):C===2&&pg(a,n,c,m,x,k):ph(yc(a),n,c,m,x,k,1);break}}}function dg(a){const n=a.prev,c=a,m=a.next;if(Ss(n,c,m)>=0)return!1;const x=n.x,k=c.x,C=m.x,I=n.y,R=c.y,F=m.y,q=x<k?x<C?x:C:k<C?k:C,W=I<R?I<F?I:F:R<F?R:F,ee=x>k?x>C?x:C:k>C?k:C,se=I>R?I>F?I:F:R>F?R:F;let ue=m.next;for(;ue!==n;){if(ue.x>=q&&ue.x<=ee&&ue.y>=W&&ue.y<=se&&Ru(x,I,k,R,C,F,ue.x,ue.y)&&Ss(ue.prev,ue,ue.next)>=0)return!1;ue=ue.next}return!0}function zu(a,n,c,m){const x=a.prev,k=a,C=a.next;if(Ss(x,k,C)>=0)return!1;const I=x.x,R=k.x,F=C.x,q=x.y,W=k.y,ee=C.y,se=I<R?I<F?I:F:R<F?R:F,ue=q<W?q<ee?q:ee:W<ee?W:ee,de=I>R?I>F?I:F:R>F?R:F,Te=q>W?q>ee?q:ee:W>ee?W:ee,Ae=ud(se,ue,n,c,m),Je=ud(de,Te,n,c,m);let Oe=a.prevZ,We=a.nextZ;for(;Oe&&Oe.z>=Ae&&We&&We.z<=Je;){if(Oe.x>=se&&Oe.x<=de&&Oe.y>=ue&&Oe.y<=Te&&Oe!==x&&Oe!==C&&Ru(I,q,R,W,F,ee,Oe.x,Oe.y)&&Ss(Oe.prev,Oe,Oe.next)>=0||(Oe=Oe.prevZ,We.x>=se&&We.x<=de&&We.y>=ue&&We.y<=Te&&We!==x&&We!==C&&Ru(I,q,R,W,F,ee,We.x,We.y)&&Ss(We.prev,We,We.next)>=0))return!1;We=We.nextZ}for(;Oe&&Oe.z>=Ae;){if(Oe.x>=se&&Oe.x<=de&&Oe.y>=ue&&Oe.y<=Te&&Oe!==x&&Oe!==C&&Ru(I,q,R,W,F,ee,Oe.x,Oe.y)&&Ss(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.prevZ}for(;We&&We.z<=Je;){if(We.x>=se&&We.x<=de&&We.y>=ue&&We.y<=Te&&We!==x&&We!==C&&Ru(I,q,R,W,F,ee,We.x,We.y)&&Ss(We.prev,We,We.next)>=0)return!1;We=We.nextZ}return!0}function fg(a,n){let c=a;do{const m=c.prev,x=c.next.next;!Ns(m,x)&&Or(m,c,c.next,x)&&mh(m,x)&&mh(x,m)&&(n.push(m.i,c.i,x.i),yh(c),yh(c.next),c=a=x),c=c.next}while(c!==a);return yc(c)}function pg(a,n,c,m,x,k){let C=a;do{let I=C.next.next;for(;I!==C.prev;){if(C.i!==I.i&&v_(C,I)){let R=Rp(C,I);return C=yc(C,C.next),R=yc(R,R.next),ph(C,n,c,m,x,k,0),void ph(R,n,c,m,x,k,0)}I=I.next}C=C.next}while(C!==a)}function mg(a,n){return a.x-n.x}function gf(a,n){const c=(function(x,k){let C=k;const I=x.x,R=x.y;let F,q=-1/0;do{if(R<=C.y&&R>=C.next.y&&C.next.y!==C.y){const de=C.x+(R-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(de<=I&&de>q&&(q=de,F=C.x<C.next.x?C:C.next,de===I))return F}C=C.next}while(C!==k);if(!F)return null;const W=F,ee=F.x,se=F.y;let ue=1/0;C=F;do{if(I>=C.x&&C.x>=ee&&I!==C.x&&Ru(R<se?I:q,R,ee,se,R<se?q:I,R,C.x,C.y)){const de=Math.abs(R-C.y)/(I-C.x);mh(C,x)&&(de<ue||de===ue&&(C.x>F.x||C.x===F.x&&gg(F,C)))&&(F=C,ue=de)}C=C.next}while(C!==W);return F})(a,n);if(!c)return n;const m=Rp(c,a);return yc(m,m.next),yc(c,c.next)}function gg(a,n){return Ss(a.prev,a,n.prev)<0&&Ss(n.next,a,a.next)<0}function ud(a,n,c,m,x){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*x|0)|a<<8))|a<<4))|a<<2))|a<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-m)*x|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function yg(a){let n=a,c=a;do(n.x<c.x||n.x===c.x&&n.y<c.y)&&(c=n),n=n.next;while(n!==a);return c}function Ru(a,n,c,m,x,k,C,I){return(x-C)*(n-I)>=(a-C)*(k-I)&&(a-C)*(m-I)>=(c-C)*(n-I)&&(c-C)*(k-I)>=(x-C)*(m-I)}function v_(a,n){return a.next.i!==n.i&&a.prev.i!==n.i&&!(function(c,m){let x=c;do{if(x.i!==c.i&&x.next.i!==c.i&&x.i!==m.i&&x.next.i!==m.i&&Or(x,x.next,c,m))return!0;x=x.next}while(x!==c);return!1})(a,n)&&(mh(a,n)&&mh(n,a)&&(function(c,m){let x=c,k=!1;const C=(c.x+m.x)/2,I=(c.y+m.y)/2;do x.y>I!=x.next.y>I&&x.next.y!==x.y&&C<(x.next.x-x.x)*(I-x.y)/(x.next.y-x.y)+x.x&&(k=!k),x=x.next;while(x!==c);return k})(a,n)&&(Ss(a.prev,a,n.prev)||Ss(a,n.prev,n))||Ns(a,n)&&Ss(a.prev,a,a.next)>0&&Ss(n.prev,n,n.next)>0)}function Ss(a,n,c){return(n.y-a.y)*(c.x-n.x)-(n.x-a.x)*(c.y-n.y)}function Ns(a,n){return a.x===n.x&&a.y===n.y}function Or(a,n,c,m){const x=dd(Ss(a,n,c)),k=dd(Ss(a,n,m)),C=dd(Ss(c,m,a)),I=dd(Ss(c,m,n));return x!==k&&C!==I||!(x!==0||!hd(a,c,n))||!(k!==0||!hd(a,m,n))||!(C!==0||!hd(c,a,m))||!(I!==0||!hd(c,n,m))}function hd(a,n,c){return n.x<=Math.max(a.x,c.x)&&n.x>=Math.min(a.x,c.x)&&n.y<=Math.max(a.y,c.y)&&n.y>=Math.min(a.y,c.y)}function dd(a){return a>0?1:a<0?-1:0}function mh(a,n){return Ss(a.prev,a,a.next)<0?Ss(a,n,a.next)>=0&&Ss(a,a.prev,n)>=0:Ss(a,n,a.prev)<0||Ss(a,a.next,n)<0}function Rp(a,n){const c=_h(a.i,a.x,a.y),m=_h(n.i,n.x,n.y),x=a.next,k=n.prev;return a.next=n,n.prev=a,c.next=x,x.prev=c,m.next=c,c.prev=m,k.next=m,m.prev=k,m}function gh(a,n,c,m){const x=_h(a,n,c);return m?(x.next=m.next,x.prev=m,m.next.prev=x,m.next=x):(x.prev=x,x.next=x),x}function yh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function _h(a,n,c){return{i:a,x:n,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function yf(a,n,c){const m=c.patternDependencies;let x=!1;for(const k of n){const C=k.paint.get(`${a}-pattern`);C.isConstant()||(x=!0);const I=C.constantOr(null);I&&(x=!0,m[I.to]=!0,m[I.from]=!0)}return x}function Dp(a,n,c,m,x){const k=x.patternDependencies;for(const C of n){const I=C.paint.get(`${a}-pattern`).value;if(I.kind!=="constant"){let R=I.evaluate({zoom:m-1},c,{},x.availableImages),F=I.evaluate({zoom:m},c,{},x.availableImages),q=I.evaluate({zoom:m+1},c,{},x.availableImages);R=R&&R.name?R.name:R,F=F&&F.name?F.name:F,q=q&&q.name?q.name:q,k[R]=!0,k[F]=!0,k[q]=!0,c.patterns[C.id]={min:R,mid:F,max:q}}}return c}class vh{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wa,this.indexArray=new fa,this.indexArray2=new js,this.programConfigurations=new Kc(n.layers,n.zoom),this.segments=new Qi,this.segments2=new Qi,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.hasPattern=yf("fill",this.layers,c);const x=this.layers[0].layout.get("fill-sort-key"),k=!x.isConstant(),C=[];for(const{feature:I,id:R,index:F,sourceLayerIndex:q}of n){const W=this.layers[0]._featureFilter.needGeometry,ee=Qc(I,W);if(!this.layers[0]._featureFilter.filter(new Ji(this.zoom),ee,m))continue;const se=k?x.evaluate(ee,{},m,c.availableImages):void 0,ue={id:R,properties:I.properties,type:I.type,sourceLayerIndex:q,index:F,geometry:W?ee.geometry:Jc(I),patterns:{},sortKey:se};C.push(ue)}k&&C.sort(((I,R)=>I.sortKey-R.sortKey));for(const I of C){const{geometry:R,index:F,sourceLayerIndex:q}=I;if(this.hasPattern){const W=Dp("fill",this.layers,I,this.zoom,c);this.patternFeatures.push(W)}else this.addFeature(I,R,F,m,{});c.featureIndex.insert(n[F].feature,R,F,q,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}addFeatures(n,c,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Lp),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,c,m,x,k){for(const C of ic(c,500)){let I=0;for(const se of C)I+=se.length;const R=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),F=R.vertexLength,q=[],W=[];for(const se of C){if(se.length===0)continue;se!==C[0]&&W.push(q.length/2);const ue=this.segments2.prepareSegment(se.length,this.layoutVertexArray,this.indexArray2),de=ue.vertexLength;this.layoutVertexArray.emplaceBack(se[0].x,se[0].y),this.indexArray2.emplaceBack(de+se.length-1,de),q.push(se[0].x),q.push(se[0].y);for(let Te=1;Te<se.length;Te++)this.layoutVertexArray.emplaceBack(se[Te].x,se[Te].y),this.indexArray2.emplaceBack(de+Te-1,de+Te),q.push(se[Te].x),q.push(se[Te].y);ue.vertexLength+=se.length,ue.primitiveLength+=se.length}const ee=zp(q,W);for(let se=0;se<ee.length;se+=3)this.indexArray.emplaceBack(F+ee[se],F+ee[se+1],F+ee[se+2]);R.vertexLength+=I,R.primitiveLength+=ee.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}}let _f,Op;It("FillBucket",vh,{omit:["layers","patternFeatures"]});var _g={get paint(){return Op=Op||new E({"fill-antialias":new ci(it.paint_fill["fill-antialias"]),"fill-opacity":new bi(it.paint_fill["fill-opacity"]),"fill-color":new bi(it.paint_fill["fill-color"]),"fill-outline-color":new bi(it.paint_fill["fill-outline-color"]),"fill-translate":new ci(it.paint_fill["fill-translate"]),"fill-translate-anchor":new ci(it.paint_fill["fill-translate-anchor"]),"fill-pattern":new bl(it.paint_fill["fill-pattern"])})},get layout(){return _f=_f||new E({"fill-sort-key":new bi(it.layout_fill["fill-sort-key"])})}};class vg extends h{constructor(n){super(n,_g)}recalculate(n,c){super.recalculate(n,c);const m=this.paint._values["fill-outline-color"];m.value.kind==="constant"&&m.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new vh(n)}queryRadius(){return uf(this.paint.get("fill-translate"))}queryIntersectsFeature(n,c,m,x,k,C,I){return bp(rd(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),C.angle,I),x)}isTileClipped(){return!0}}const Np=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Bp=z([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$p}=Np;var _c={},Up=j,fd=iu;function iu(a,n,c,m,x){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=m,this._values=x,a.readFields(xg,this,n)}function xg(a,n,c){a==1?n.id=c.readVarint():a==2?(function(m,x){for(var k=m.readVarint()+m.pos;m.pos<k;){var C=x._keys[m.readVarint()],I=x._values[m.readVarint()];x.properties[C]=I}})(c,n):a==3?n.type=c.readVarint():a==4&&(n._geometry=c.pos)}function Fp(a){for(var n,c,m=0,x=0,k=a.length,C=k-1;x<k;C=x++)m+=((c=a[C]).x-(n=a[x]).x)*(n.y+c.y);return m}iu.types=["Unknown","Point","LineString","Polygon"],iu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var n,c=a.readVarint()+a.pos,m=1,x=0,k=0,C=0,I=[];a.pos<c;){if(x<=0){var R=a.readVarint();m=7&R,x=R>>3}if(x--,m===1||m===2)k+=a.readSVarint(),C+=a.readSVarint(),m===1&&(n&&I.push(n),n=[]),n.push(new Up(k,C));else{if(m!==7)throw new Error("unknown command "+m);n&&n.push(n[0].clone())}}return n&&I.push(n),I},iu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var n=a.readVarint()+a.pos,c=1,m=0,x=0,k=0,C=1/0,I=-1/0,R=1/0,F=-1/0;a.pos<n;){if(m<=0){var q=a.readVarint();c=7&q,m=q>>3}if(m--,c===1||c===2)(x+=a.readSVarint())<C&&(C=x),x>I&&(I=x),(k+=a.readSVarint())<R&&(R=k),k>F&&(F=k);else if(c!==7)throw new Error("unknown command "+c)}return[C,R,I,F]},iu.prototype.toGeoJSON=function(a,n,c){var m,x,k=this.extent*Math.pow(2,c),C=this.extent*a,I=this.extent*n,R=this.loadGeometry(),F=iu.types[this.type];function q(se){for(var ue=0;ue<se.length;ue++){var de=se[ue];se[ue]=[360*(de.x+C)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(de.y+I)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var W=[];for(m=0;m<R.length;m++)W[m]=R[m][0];q(R=W);break;case 2:for(m=0;m<R.length;m++)q(R[m]);break;case 3:for(R=(function(se){var ue=se.length;if(ue<=1)return[se];for(var de,Te,Ae=[],Je=0;Je<ue;Je++){var Oe=Fp(se[Je]);Oe!==0&&(Te===void 0&&(Te=Oe<0),Te===Oe<0?(de&&Ae.push(de),de=[se[Je]]):de.push(se[Je]))}return de&&Ae.push(de),Ae})(R),m=0;m<R.length;m++)for(x=0;x<R[m].length;x++)q(R[m][x])}R.length===1?R=R[0]:F="Multi"+F;var ee={type:"Feature",geometry:{type:F,coordinates:R},properties:this.properties};return"id"in this&&(ee.id=this.id),ee};var bg=fd,Hl=vf;function vf(a,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(x_,this,n),this.length=this._features.length}function x_(a,n,c){a===15?n.version=c.readVarint():a===1?n.name=c.readString():a===5?n.extent=c.readVarint():a===2?n._features.push(c.pos):a===3?n._keys.push(c.readString()):a===4&&n._values.push((function(m){for(var x=null,k=m.readVarint()+m.pos;m.pos<k;){var C=m.readVarint()>>3;x=C===1?m.readString():C===2?m.readFloat():C===3?m.readDouble():C===4?m.readVarint64():C===5?m.readVarint():C===6?m.readSVarint():C===7?m.readBoolean():null}return x})(c))}vf.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var n=this._pbf.readVarint()+this._pbf.pos;return new bg(this._pbf,n,this.extent,this._keys,this._values)};var wg=Hl;function vc(a,n,c){if(a===3){var m=new wg(c,c.readVarint()+c.pos);m.length&&(n[m.name]=m)}}_c.VectorTile=function(a,n){this.layers=a.readFields(vc,{},n)},_c.VectorTileFeature=fd,_c.VectorTileLayer=Hl;const Vp=_c.VectorTileFeature.types,xf=Math.pow(2,13);function nu(a,n,c,m,x,k,C,I){a.emplaceBack(n,c,2*Math.floor(m*xf)+C,x*xf*2,k*xf*2,Math.round(I))}class Du{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new hc,this.centroidVertexArray=new as,this.indexArray=new fa,this.programConfigurations=new Kc(n.layers,n.zoom),this.segments=new Qi,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.features=[],this.hasPattern=yf("fill-extrusion",this.layers,c);for(const{feature:x,id:k,index:C,sourceLayerIndex:I}of n){const R=this.layers[0]._featureFilter.needGeometry,F=Qc(x,R);if(!this.layers[0]._featureFilter.filter(new Ji(this.zoom),F,m))continue;const q={id:k,sourceLayerIndex:I,index:C,geometry:R?F.geometry:Jc(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Dp("fill-extrusion",this.layers,q,this.zoom,c)):this.addFeature(q,q.geometry,C,m,{}),c.featureIndex.insert(x,q.geometry,C,I,this.index,!0)}}addFeatures(n,c,m){for(const x of this.features){const{geometry:k}=x;this.addFeature(x,k,x.index,c,m)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,$p),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,Bp.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,c,m,x,k){for(const C of ic(c,500)){const I={x:0,y:0,vertexCount:0};let R=0;for(const ue of C)R+=ue.length;let F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ue of C){if(ue.length===0||b_(ue))continue;let de=0;for(let Te=0;Te<ue.length;Te++){const Ae=ue[Te];if(Te>=1){const Je=ue[Te-1];if(!Ts(Ae,Je)){F.vertexLength+4>Qi.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Oe=Ae.sub(Je)._perp()._unit(),We=Je.dist(Ae);de+We>32768&&(de=0),nu(this.layoutVertexArray,Ae.x,Ae.y,Oe.x,Oe.y,0,0,de),nu(this.layoutVertexArray,Ae.x,Ae.y,Oe.x,Oe.y,0,1,de),I.x+=2*Ae.x,I.y+=2*Ae.y,I.vertexCount+=2,de+=We,nu(this.layoutVertexArray,Je.x,Je.y,Oe.x,Oe.y,0,0,de),nu(this.layoutVertexArray,Je.x,Je.y,Oe.x,Oe.y,0,1,de),I.x+=2*Je.x,I.y+=2*Je.y,I.vertexCount+=2;const mt=F.vertexLength;this.indexArray.emplaceBack(mt,mt+2,mt+1),this.indexArray.emplaceBack(mt+1,mt+2,mt+3),F.vertexLength+=4,F.primitiveLength+=2}}}}if(F.vertexLength+R>Qi.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray)),Vp[n.type]!=="Polygon")continue;const q=[],W=[],ee=F.vertexLength;for(const ue of C)if(ue.length!==0){ue!==C[0]&&W.push(q.length/2);for(let de=0;de<ue.length;de++){const Te=ue[de];nu(this.layoutVertexArray,Te.x,Te.y,0,0,1,1,0),I.x+=Te.x,I.y+=Te.y,I.vertexCount+=1,q.push(Te.x),q.push(Te.y)}}const se=zp(q,W);for(let ue=0;ue<se.length;ue+=3)this.indexArray.emplaceBack(ee+se[ue],ee+se[ue+2],ee+se[ue+1]);F.primitiveLength+=se.length/3,F.vertexLength+=R;for(let ue=0;ue<I.vertexCount;ue++){const de=Math.floor(I.x/I.vertexCount),Te=Math.floor(I.y/I.vertexCount);this.centroidVertexArray.emplaceBack(de,Te)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}}function Ts(a,n){return a.x===n.x&&(a.x<0||a.x>Os)||a.y===n.y&&(a.y<0||a.y>Os)}function b_(a){return a.every((n=>n.x<0))||a.every((n=>n.x>Os))||a.every((n=>n.y<0))||a.every((n=>n.y>Os))}let Sg;It("FillExtrusionBucket",Du,{omit:["layers","features"]});var Tg={get paint(){return Sg=Sg||new E({"fill-extrusion-opacity":new ci(it["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bi(it["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ci(it["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ci(it["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new bl(it["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new bi(it["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bi(it["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ci(it["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class pd extends h{constructor(n){super(n,Tg)}createBucket(n){return new Du(n)}queryRadius(){return uf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,c,m,x,k,C,I,R){const F=rd(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),C.angle,I),q=this.paint.get("fill-extrusion-height").evaluate(c,m),W=this.paint.get("fill-extrusion-base").evaluate(c,m),ee=(function(ue,de,Te,Ae){const Je=[];for(const Oe of ue){const We=[Oe.x,Oe.y,0,1];ad(We,We,de),Je.push(new N(We[0]/We[3],We[1]/We[3]))}return Je})(F,R),se=(function(ue,de,Te,Ae){const Je=[],Oe=[],We=Ae[8]*de,mt=Ae[9]*de,Dt=Ae[10]*de,Jt=Ae[11]*de,Ti=Ae[8]*Te,Ft=Ae[9]*Te,Zt=Ae[10]*Te,di=Ae[11]*Te;for(const li of ue){const ri=[],vt=[];for(const oi of li){const ui=oi.x,Mi=oi.y,Tn=Ae[0]*ui+Ae[4]*Mi+Ae[12],Yn=Ae[1]*ui+Ae[5]*Mi+Ae[13],hr=Ae[2]*ui+Ae[6]*Mi+Ae[14],ea=Ae[3]*ui+Ae[7]*Mi+Ae[15],Cr=hr+Dt,dr=ea+Jt,ga=Tn+Ti,ya=Yn+Ft,_a=hr+Zt,Ls=ea+di,fr=new N((Tn+We)/dr,(Yn+mt)/dr);fr.z=Cr/dr,ri.push(fr);const ta=new N(ga/Ls,ya/Ls);ta.z=_a/Ls,vt.push(ta)}Je.push(ri),Oe.push(vt)}return[Je,Oe]})(x,W,q,R);return(function(ue,de,Te){let Ae=1/0;bp(Te,de)&&(Ae=qp(Te,de[0]));for(let Je=0;Je<de.length;Je++){const Oe=de[Je],We=ue[Je];for(let mt=0;mt<Oe.length-1;mt++){const Dt=Oe[mt],Jt=[Dt,Oe[mt+1],We[mt+1],We[mt],Dt];xp(Te,Jt)&&(Ae=Math.min(Ae,qp(Te,Jt)))}}return Ae!==1/0&&Ae})(se[0],se[1],ee)}}function Fo(a,n){return a.x*n.x+a.y*n.y}function qp(a,n){if(a.length===1){let c=0;const m=n[c++];let x;for(;!x||m.equals(x);)if(x=n[c++],!x)return 1/0;for(;c<n.length;c++){const k=n[c],C=a[0],I=x.sub(m),R=k.sub(m),F=C.sub(m),q=Fo(I,I),W=Fo(I,R),ee=Fo(R,R),se=Fo(F,I),ue=Fo(F,R),de=q*ee-W*W,Te=(ee*se-W*ue)/de,Ae=(q*ue-W*se)/de,Je=m.z*(1-Te-Ae)+x.z*Te+k.z*Ae;if(isFinite(Je))return Je}return 1/0}{let c=1/0;for(const m of n)c=Math.min(c,m.z);return c}}const Eg=z([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:md}=Eg,Zl=z([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:kg}=Zl,Hp=_c.VectorTileFeature.types,Cg=Math.cos(Math.PI/180*37.5),bf=Math.pow(2,14)/.5;class gd{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((c=>{this.gradients[c.id]={}})),this.layoutVertexArray=new _o,this.layoutVertexArray2=new ar,this.indexArray=new fa,this.programConfigurations=new Kc(n.layers,n.zoom),this.segments=new Qi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.hasPattern=yf("line",this.layers,c);const x=this.layers[0].layout.get("line-sort-key"),k=!x.isConstant(),C=[];for(const{feature:I,id:R,index:F,sourceLayerIndex:q}of n){const W=this.layers[0]._featureFilter.needGeometry,ee=Qc(I,W);if(!this.layers[0]._featureFilter.filter(new Ji(this.zoom),ee,m))continue;const se=k?x.evaluate(ee,{},m):void 0,ue={id:R,properties:I.properties,type:I.type,sourceLayerIndex:q,index:F,geometry:W?ee.geometry:Jc(I),patterns:{},sortKey:se};C.push(ue)}k&&C.sort(((I,R)=>I.sortKey-R.sortKey));for(const I of C){const{geometry:R,index:F,sourceLayerIndex:q}=I;if(this.hasPattern){const W=Dp("line",this.layers,I,this.zoom,c);this.patternFeatures.push(W)}else this.addFeature(I,R,F,m,{});c.featureIndex.insert(n[F].feature,R,F,q,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}addFeatures(n,c,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,kg)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,md),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,c,m,x,k){const C=this.layers[0].layout,I=C.get("line-join").evaluate(n,{}),R=C.get("line-cap"),F=C.get("line-miter-limit"),q=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const W of c)this.addLine(W,n,I,R,F,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}addLine(n,c,m,x,k,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ae=0;Ae<n.length-1;Ae++)this.totalDistance+=n[Ae].dist(n[Ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=Hp[c.type]==="Polygon";let R=n.length;for(;R>=2&&n[R-1].equals(n[R-2]);)R--;let F=0;for(;F<R-1&&n[F].equals(n[F+1]);)F++;if(R<(I?3:2))return;m==="bevel"&&(k=1.05);const q=this.overscaling<=16?15*Os/(512*this.overscaling):0,W=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let ee,se,ue,de,Te;this.e1=this.e2=-1,I&&(ee=n[R-2],Te=n[F].sub(ee)._unit()._perp());for(let Ae=F;Ae<R;Ae++){if(ue=Ae===R-1?I?n[F+1]:void 0:n[Ae+1],ue&&n[Ae].equals(ue))continue;Te&&(de=Te),ee&&(se=ee),ee=n[Ae],Te=ue?ue.sub(ee)._unit()._perp():de,de=de||Te;let Je=de.add(Te);Je.x===0&&Je.y===0||Je._unit();const Oe=de.x*Te.x+de.y*Te.y,We=Je.x*Te.x+Je.y*Te.y,mt=We!==0?1/We:1/0,Dt=2*Math.sqrt(2-2*We),Jt=We<Cg&&se&&ue,Ti=de.x*Te.y-de.y*Te.x>0;if(Jt&&Ae>F){const di=ee.dist(se);if(di>2*q){const li=ee.sub(ee.sub(se)._mult(q/di)._round());this.updateDistance(se,li),this.addCurrentVertex(li,de,0,0,W),se=li}}const Ft=se&&ue;let Zt=Ft?m:I?"butt":x;if(Ft&&Zt==="round"&&(mt<C?Zt="miter":mt<=2&&(Zt="fakeround")),Zt==="miter"&&mt>k&&(Zt="bevel"),Zt==="bevel"&&(mt>2&&(Zt="flipbevel"),mt<k&&(Zt="miter")),se&&this.updateDistance(se,ee),Zt==="miter")Je._mult(mt),this.addCurrentVertex(ee,Je,0,0,W);else if(Zt==="flipbevel"){if(mt>100)Je=Te.mult(-1);else{const di=mt*de.add(Te).mag()/de.sub(Te).mag();Je._perp()._mult(di*(Ti?-1:1))}this.addCurrentVertex(ee,Je,0,0,W),this.addCurrentVertex(ee,Je.mult(-1),0,0,W)}else if(Zt==="bevel"||Zt==="fakeround"){const di=-Math.sqrt(mt*mt-1),li=Ti?di:0,ri=Ti?0:di;if(se&&this.addCurrentVertex(ee,de,li,ri,W),Zt==="fakeround"){const vt=Math.round(180*Dt/Math.PI/20);for(let oi=1;oi<vt;oi++){let ui=oi/vt;if(ui!==.5){const Tn=ui-.5;ui+=ui*Tn*(ui-1)*((1.0904+Oe*(Oe*(3.55645-1.43519*Oe)-3.2452))*Tn*Tn+(.848013+Oe*(.215638*Oe-1.06021)))}const Mi=Te.sub(de)._mult(ui)._add(de)._unit()._mult(Ti?-1:1);this.addHalfVertex(ee,Mi.x,Mi.y,!1,Ti,0,W)}}ue&&this.addCurrentVertex(ee,Te,-li,-ri,W)}else if(Zt==="butt")this.addCurrentVertex(ee,Je,0,0,W);else if(Zt==="square"){const di=se?1:-1;this.addCurrentVertex(ee,Je,di,di,W)}else Zt==="round"&&(se&&(this.addCurrentVertex(ee,de,0,0,W),this.addCurrentVertex(ee,de,1,1,W,!0)),ue&&(this.addCurrentVertex(ee,Te,-1,-1,W,!0),this.addCurrentVertex(ee,Te,0,0,W)));if(Jt&&Ae<R-1){const di=ee.dist(ue);if(di>2*q){const li=ee.add(ue.sub(ee)._mult(q/di)._round());this.updateDistance(ee,li),this.addCurrentVertex(li,Te,0,0,W),ee=li}}}}addCurrentVertex(n,c,m,x,k,C=!1){const I=c.y*x-c.x,R=-c.y-c.x*x;this.addHalfVertex(n,c.x+c.y*m,c.y-c.x*m,C,!1,m,k),this.addHalfVertex(n,I,R,C,!0,-x,k),this.distance>bf/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,c,m,x,k,C))}addHalfVertex({x:n,y:c},m,x,k,C,I,R){const F=.5*(this.lineClips?this.scaledDistance*(bf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(k?1:0),(c<<1)+(C?1:0),Math.round(63*m)+128,Math.round(63*x)+128,1+(I===0?0:I<0?-1:1)|(63&F)<<2,F>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const q=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,q),R.primitiveLength++),C?this.e2=q:this.e1=q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,c){this.distance+=n.dist(c),this.updateScaledDistance()}}let yd,Zp;It("LineBucket",gd,{omit:["layers","patternFeatures"]});var Gl={get paint(){return Zp=Zp||new E({"line-opacity":new bi(it.paint_line["line-opacity"]),"line-color":new bi(it.paint_line["line-color"]),"line-translate":new ci(it.paint_line["line-translate"]),"line-translate-anchor":new ci(it.paint_line["line-translate-anchor"]),"line-width":new bi(it.paint_line["line-width"]),"line-gap-width":new bi(it.paint_line["line-gap-width"]),"line-offset":new bi(it.paint_line["line-offset"]),"line-blur":new bi(it.paint_line["line-blur"]),"line-dasharray":new wl(it.paint_line["line-dasharray"]),"line-pattern":new bl(it.paint_line["line-pattern"]),"line-gradient":new ed(it.paint_line["line-gradient"])})},get layout(){return yd=yd||new E({"line-cap":new ci(it.layout_line["line-cap"]),"line-join":new bi(it.layout_line["line-join"]),"line-miter-limit":new ci(it.layout_line["line-miter-limit"]),"line-round-limit":new ci(it.layout_line["line-round-limit"]),"line-sort-key":new bi(it.layout_line["line-sort-key"])})}};class lr extends bi{possiblyEvaluate(n,c){return c=new Ji(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(n,c)}evaluate(n,c,m,x){return c=Me({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(n,c,m,x)}}let xh;class Ag extends h{constructor(n){super(n,Gl),this.gradientVersion=0,xh||(xh=new lr(Gl.paint.properties["line-width"].specification),xh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const c=this.gradientExpression();this.stepInterpolant=!!(function(m){return m._styleExpression!==void 0})(c)&&c._styleExpression.expression instanceof lo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,c){super.recalculate(n,c),this.paint._values["line-floorwidth"]=xh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new gd(n)}queryRadius(n){const c=n,m=Er(Iu("line-width",this,c),Iu("line-gap-width",this,c)),x=Iu("line-offset",this,c);return m/2+Math.abs(x)+uf(this.paint.get("line-translate"))}queryIntersectsFeature(n,c,m,x,k,C,I){const R=rd(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),C.angle,I),F=I/2*Er(this.paint.get("line-width").evaluate(c,m),this.paint.get("line-gap-width").evaluate(c,m)),q=this.paint.get("line-offset").evaluate(c,m);return q&&(x=(function(W,ee){const se=[];for(let ue=0;ue<W.length;ue++){const de=W[ue],Te=[];for(let Ae=0;Ae<de.length;Ae++){const Je=de[Ae-1],Oe=de[Ae],We=de[Ae+1],mt=Ae===0?new N(0,0):Oe.sub(Je)._unit()._perp(),Dt=Ae===de.length-1?new N(0,0):We.sub(Oe)._unit()._perp(),Jt=mt._add(Dt)._unit(),Ti=Jt.x*Dt.x+Jt.y*Dt.y;Ti!==0&&Jt._mult(1/Ti),Te.push(Jt._mult(ee)._add(Oe))}se.push(Te)}return se})(x,q*I)),(function(W,ee,se){for(let ue=0;ue<ee.length;ue++){const de=ee[ue];if(W.length>=3){for(let Te=0;Te<de.length;Te++)if(gc(W,de[Te]))return!0}if(rg(W,de,se))return!0}return!1})(R,x,F)}isTileClipped(){return!0}}function Er(a,n){return n>0?n+2*a:a}const w_=z([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Mg=z([{name:"a_projected_pos",components:3,type:"Float32"}],4);z([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Pg=z([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);z([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Es=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ka=z([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function xc(a,n,c){return a.sections.forEach((m=>{m.text=(function(x,k,C){const I=k.layout.get("text-transform").evaluate(C,{});return I==="uppercase"?x=x.toLocaleUpperCase():I==="lowercase"&&(x=x.toLocaleLowerCase()),Qs.applyArabicShaping&&(x=Qs.applyArabicShaping(x)),x})(m.text,n,c)})),a}z([{name:"triangle",components:3,type:"Uint16"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),z([{type:"Float32",name:"offsetX"}]),z([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),z([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const bh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Zs=24,Gp=en,jg=function(a,n,c,m,x){var k,C,I=8*x-m-1,R=(1<<I)-1,F=R>>1,q=-7,W=x-1,ee=-1,se=a[n+W];for(W+=ee,k=se&(1<<-q)-1,se>>=-q,q+=I;q>0;k=256*k+a[n+W],W+=ee,q-=8);for(C=k&(1<<-q)-1,k>>=-q,q+=m;q>0;C=256*C+a[n+W],W+=ee,q-=8);if(k===0)k=1-F;else{if(k===R)return C?NaN:1/0*(se?-1:1);C+=Math.pow(2,m),k-=F}return(se?-1:1)*C*Math.pow(2,k-m)},_d=function(a,n,c,m,x,k){var C,I,R,F=8*k-x-1,q=(1<<F)-1,W=q>>1,ee=x===23?Math.pow(2,-24)-Math.pow(2,-77):0,se=0,ue=1,de=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(I=isNaN(n)?1:0,C=q):(C=Math.floor(Math.log(n)/Math.LN2),n*(R=Math.pow(2,-C))<1&&(C--,R*=2),(n+=C+W>=1?ee/R:ee*Math.pow(2,1-W))*R>=2&&(C++,R/=2),C+W>=q?(I=0,C=q):C+W>=1?(I=(n*R-1)*Math.pow(2,x),C+=W):(I=n*Math.pow(2,W-1)*Math.pow(2,x),C=0));x>=8;a[c+se]=255&I,se+=ue,I/=256,x-=8);for(C=C<<x|I,F+=x;F>0;a[c+se]=255&C,se+=ue,C/=256,F-=8);a[c+se-ue]|=128*de};function en(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}en.Varint=0,en.Fixed64=1,en.Bytes=2,en.Fixed32=5;var xo=4294967296,Wp=1/xo,Ma=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Wl(a){return a.type===en.Bytes?a.readVarint()+a.pos:a.pos+1}function Ja(a,n,c){return c?4294967296*n+(a>>>0):4294967296*(n>>>0)+(a>>>0)}function su(a,n,c){var m=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));c.realloc(m);for(var x=c.pos-1;x>=a;x--)c.buf[x+m]=c.buf[x]}function bc(a,n){for(var c=0;c<a.length;c++)n.writeVarint(a[c])}function Yp(a,n){for(var c=0;c<a.length;c++)n.writeSVarint(a[c])}function Xp(a,n){for(var c=0;c<a.length;c++)n.writeFloat(a[c])}function Tl(a,n){for(var c=0;c<a.length;c++)n.writeDouble(a[c])}function Ig(a,n){for(var c=0;c<a.length;c++)n.writeBoolean(a[c])}function wh(a,n){for(var c=0;c<a.length;c++)n.writeFixed32(a[c])}function vd(a,n){for(var c=0;c<a.length;c++)n.writeSFixed32(a[c])}function xd(a,n){for(var c=0;c<a.length;c++)n.writeFixed64(a[c])}function Sh(a,n){for(var c=0;c<a.length;c++)n.writeSFixed64(a[c])}function bd(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+16777216*a[n+3]}function Ou(a,n,c){a[c]=n,a[c+1]=n>>>8,a[c+2]=n>>>16,a[c+3]=n>>>24}function Th(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+(a[n+3]<<24)}en.prototype={destroy:function(){this.buf=null},readFields:function(a,n,c){for(c=c||this.length;this.pos<c;){var m=this.readVarint(),x=m>>3,k=this.pos;this.type=7&m,a(x,n,this),this.pos===k&&this.skip(m)}return n},readMessage:function(a,n){return this.readFields(a,n,this.readVarint()+this.pos)},readFixed32:function(){var a=bd(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Th(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=bd(this.buf,this.pos)+bd(this.buf,this.pos+4)*xo;return this.pos+=8,a},readSFixed64:function(){var a=bd(this.buf,this.pos)+Th(this.buf,this.pos+4)*xo;return this.pos+=8,a},readFloat:function(){var a=jg(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=jg(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var n,c,m=this.buf;return n=127&(c=m[this.pos++]),c<128?n:(n|=(127&(c=m[this.pos++]))<<7,c<128?n:(n|=(127&(c=m[this.pos++]))<<14,c<128?n:(n|=(127&(c=m[this.pos++]))<<21,c<128?n:(function(x,k,C){var I,R,F=C.buf;if(I=(112&(R=F[C.pos++]))>>4,R<128||(I|=(127&(R=F[C.pos++]))<<3,R<128)||(I|=(127&(R=F[C.pos++]))<<10,R<128)||(I|=(127&(R=F[C.pos++]))<<17,R<128)||(I|=(127&(R=F[C.pos++]))<<24,R<128)||(I|=(1&(R=F[C.pos++]))<<31,R<128))return Ja(x,I,k);throw new Error("Expected varint not more than 10 bytes")})(n|=(15&(c=m[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,n=this.pos;return this.pos=a,a-n>=12&&Ma?(function(c,m,x){return Ma.decode(c.subarray(m,x))})(this.buf,n,a):(function(c,m,x){for(var k="",C=m;C<x;){var I,R,F,q=c[C],W=null,ee=q>239?4:q>223?3:q>191?2:1;if(C+ee>x)break;ee===1?q<128&&(W=q):ee===2?(192&(I=c[C+1]))==128&&(W=(31&q)<<6|63&I)<=127&&(W=null):ee===3?(R=c[C+2],(192&(I=c[C+1]))==128&&(192&R)==128&&((W=(15&q)<<12|(63&I)<<6|63&R)<=2047||W>=55296&&W<=57343)&&(W=null)):ee===4&&(R=c[C+2],F=c[C+3],(192&(I=c[C+1]))==128&&(192&R)==128&&(192&F)==128&&((W=(15&q)<<18|(63&I)<<12|(63&R)<<6|63&F)<=65535||W>=1114112)&&(W=null)),W===null?(W=65533,ee=1):W>65535&&(W-=65536,k+=String.fromCharCode(W>>>10&1023|55296),W=56320|1023&W),k+=String.fromCharCode(W),C+=ee}return k})(this.buf,n,a)},readBytes:function(){var a=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,a);return this.pos=a,n},readPackedVarint:function(a,n){if(this.type!==en.Bytes)return a.push(this.readVarint(n));var c=Wl(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(n));return a},readPackedSVarint:function(a){if(this.type!==en.Bytes)return a.push(this.readSVarint());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==en.Bytes)return a.push(this.readBoolean());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==en.Bytes)return a.push(this.readFloat());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==en.Bytes)return a.push(this.readDouble());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==en.Bytes)return a.push(this.readFixed32());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==en.Bytes)return a.push(this.readSFixed32());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==en.Bytes)return a.push(this.readFixed64());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==en.Bytes)return a.push(this.readSFixed64());var n=Wl(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed64());return a},skip:function(a){var n=7&a;if(n===en.Varint)for(;this.buf[this.pos++]>127;);else if(n===en.Bytes)this.pos=this.readVarint()+this.pos;else if(n===en.Fixed32)this.pos+=4;else{if(n!==en.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(a,n){this.writeVarint(a<<3|n)},realloc:function(a){for(var n=this.length||16;n<this.pos+a;)n*=2;if(n!==this.length){var c=new Uint8Array(n);c.set(this.buf),this.buf=c,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Ou(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Ou(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Ou(this.buf,-1&a,this.pos),Ou(this.buf,Math.floor(a*Wp),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Ou(this.buf,-1&a,this.pos),Ou(this.buf,Math.floor(a*Wp),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?(function(n,c){var m,x;if(n>=0?(m=n%4294967296|0,x=n/4294967296|0):(x=~(-n/4294967296),4294967295^(m=~(-n%4294967296))?m=m+1|0:(m=0,x=x+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),(function(k,C,I){I.buf[I.pos++]=127&k|128,k>>>=7,I.buf[I.pos++]=127&k|128,k>>>=7,I.buf[I.pos++]=127&k|128,k>>>=7,I.buf[I.pos++]=127&k|128,I.buf[I.pos]=127&(k>>>=7)})(m,0,c),(function(k,C){var I=(7&k)<<4;C.buf[C.pos++]|=I|((k>>>=3)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k)))))})(x,c)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var n=this.pos;this.pos=(function(m,x,k){for(var C,I,R=0;R<x.length;R++){if((C=x.charCodeAt(R))>55295&&C<57344){if(!I){C>56319||R+1===x.length?(m[k++]=239,m[k++]=191,m[k++]=189):I=C;continue}if(C<56320){m[k++]=239,m[k++]=191,m[k++]=189,I=C;continue}C=I-55296<<10|C-56320|65536,I=null}else I&&(m[k++]=239,m[k++]=191,m[k++]=189,I=null);C<128?m[k++]=C:(C<2048?m[k++]=C>>6|192:(C<65536?m[k++]=C>>12|224:(m[k++]=C>>18|240,m[k++]=C>>12&63|128),m[k++]=C>>6&63|128),m[k++]=63&C|128)}return k})(this.buf,a,this.pos);var c=this.pos-n;c>=128&&su(n,c,this),this.pos=n-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),_d(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),_d(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var n=a.length;this.writeVarint(n),this.realloc(n);for(var c=0;c<n;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,n){this.pos++;var c=this.pos;a(n,this);var m=this.pos-c;m>=128&&su(c,m,this),this.pos=c-1,this.writeVarint(m),this.pos+=m},writeMessage:function(a,n,c){this.writeTag(a,en.Bytes),this.writeRawMessage(n,c)},writePackedVarint:function(a,n){n.length&&this.writeMessage(a,bc,n)},writePackedSVarint:function(a,n){n.length&&this.writeMessage(a,Yp,n)},writePackedBoolean:function(a,n){n.length&&this.writeMessage(a,Ig,n)},writePackedFloat:function(a,n){n.length&&this.writeMessage(a,Xp,n)},writePackedDouble:function(a,n){n.length&&this.writeMessage(a,Tl,n)},writePackedFixed32:function(a,n){n.length&&this.writeMessage(a,wh,n)},writePackedSFixed32:function(a,n){n.length&&this.writeMessage(a,vd,n)},writePackedFixed64:function(a,n){n.length&&this.writeMessage(a,xd,n)},writePackedSFixed64:function(a,n){n.length&&this.writeMessage(a,Sh,n)},writeBytesField:function(a,n){this.writeTag(a,en.Bytes),this.writeBytes(n)},writeFixed32Field:function(a,n){this.writeTag(a,en.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(a,n){this.writeTag(a,en.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(a,n){this.writeTag(a,en.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(a,n){this.writeTag(a,en.Fixed64),this.writeSFixed64(n)},writeVarintField:function(a,n){this.writeTag(a,en.Varint),this.writeVarint(n)},writeSVarintField:function(a,n){this.writeTag(a,en.Varint),this.writeSVarint(n)},writeStringField:function(a,n){this.writeTag(a,en.Bytes),this.writeString(n)},writeFloatField:function(a,n){this.writeTag(a,en.Fixed32),this.writeFloat(n)},writeDoubleField:function(a,n){this.writeTag(a,en.Fixed64),this.writeDouble(n)},writeBooleanField:function(a,n){this.writeVarintField(a,!!n)}};var wf=A(Gp);const Eh=3;function Lg(a,n,c){a===1&&c.readMessage(S_,n)}function S_(a,n,c){if(a===3){const{id:m,bitmap:x,width:k,height:C,left:I,top:R,advance:F}=c.readMessage(T_,{});n.push({id:m,bitmap:new od({width:k+2*Eh,height:C+2*Eh},x),metrics:{width:k,height:C,left:I,top:R,advance:F}})}}function T_(a,n,c){a===1?n.id=c.readVarint():a===2?n.bitmap=c.readBytes():a===3?n.width=c.readVarint():a===4?n.height=c.readVarint():a===5?n.left=c.readSVarint():a===6?n.top=c.readSVarint():a===7&&(n.advance=c.readVarint())}const Vn=Eh;function hs(a){let n=0,c=0;for(const C of a)n+=C.w*C.h,c=Math.max(c,C.w);a.sort(((C,I)=>I.h-C.h));const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),c),h:1/0}];let x=0,k=0;for(const C of a)for(let I=m.length-1;I>=0;I--){const R=m[I];if(!(C.w>R.w||C.h>R.h)){if(C.x=R.x,C.y=R.y,k=Math.max(k,C.y+C.h),x=Math.max(x,C.x+C.w),C.w===R.w&&C.h===R.h){const F=m.pop();I<m.length&&(m[I]=F)}else C.h===R.h?(R.x+=C.w,R.w-=C.w):C.w===R.w?(R.y+=C.h,R.h-=C.h):(m.push({x:R.x+C.w,y:R.y,w:R.w-C.w,h:C.h}),R.y+=C.h,R.h-=C.h);break}}return{w:x,h:k,fill:n/(x*k)||0}}const Di=1;class Sn{constructor(n,{pixelRatio:c,version:m,stretchX:x,stretchY:k,content:C,textFitWidth:I,textFitHeight:R}){this.paddedRect=n,this.pixelRatio=c,this.stretchX=x,this.stretchY=k,this.content=C,this.version=m,this.textFitWidth=I,this.textFitHeight=R}get tl(){return[this.paddedRect.x+Di,this.paddedRect.y+Di]}get br(){return[this.paddedRect.x+this.paddedRect.w-Di,this.paddedRect.y+this.paddedRect.h-Di]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Di)/this.pixelRatio,(this.paddedRect.h-2*Di)/this.pixelRatio]}}class Kn{constructor(n,c){const m={},x={};this.haveRenderCallbacks=[];const k=[];this.addImages(n,m,k),this.addImages(c,x,k);const{w:C,h:I}=hs(k),R=new Xa({width:C||1,height:I||1});for(const F in n){const q=n[F],W=m[F].paddedRect;Xa.copy(q.data,R,{x:0,y:0},{x:W.x+Di,y:W.y+Di},q.data)}for(const F in c){const q=c[F],W=x[F].paddedRect,ee=W.x+Di,se=W.y+Di,ue=q.data.width,de=q.data.height;Xa.copy(q.data,R,{x:0,y:0},{x:ee,y:se},q.data),Xa.copy(q.data,R,{x:0,y:de-1},{x:ee,y:se-1},{width:ue,height:1}),Xa.copy(q.data,R,{x:0,y:0},{x:ee,y:se+de},{width:ue,height:1}),Xa.copy(q.data,R,{x:ue-1,y:0},{x:ee-1,y:se},{width:1,height:de}),Xa.copy(q.data,R,{x:0,y:0},{x:ee+ue,y:se},{width:1,height:de})}this.image=R,this.iconPositions=m,this.patternPositions=x}addImages(n,c,m){for(const x in n){const k=n[x],C={x:0,y:0,w:k.data.width+2*Di,h:k.data.height+2*Di};m.push(C),c[x]=new Sn(C,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(n,c){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in n.updatedImages)this.patchUpdatedImage(this.iconPositions[m],n.getImage(m),c),this.patchUpdatedImage(this.patternPositions[m],n.getImage(m),c)}patchUpdatedImage(n,c,m){if(!n||!c||n.version===c.version)return;n.version=c.version;const[x,k]=n.tl;m.update(c.data,void 0,{x,y:k})}}var cr;It("ImagePosition",Sn),It("ImageAtlas",Kn),y.ah=void 0,(cr=y.ah||(y.ah={}))[cr.none=0]="none",cr[cr.horizontal=1]="horizontal",cr[cr.vertical=2]="vertical",cr[cr.horizontalOnly=3]="horizontalOnly";const Vo=-17;class Yl{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,c){const m=new Yl;return m.scale=n||1,m.fontStack=c,m}static forImage(n){const c=new Yl;return c.imageName=n,c}}class ru{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,c){const m=new ru;for(let x=0;x<n.sections.length;x++){const k=n.sections[x];k.image?m.addImageSection(k):m.addTextSection(k,c)}return m}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=(function(n){let c="";for(let m=0;m<n.length;m++){const x=n.charCodeAt(m+1)||null,k=n.charCodeAt(m-1)||null;c+=x&&$o(x)&&!bh[n[m+1]]||k&&$o(k)&&!bh[n[m-1]]||!bh[n[m]]?n[m]:bh[n[m]]}return c})(this.text)}trim(){let n=0;for(let m=0;m<this.text.length&&ks[this.text.charCodeAt(m)];m++)n++;let c=this.text.length;for(let m=this.text.length-1;m>=0&&m>=n&&ks[this.text.charCodeAt(m)];m--)c--;this.text=this.text.substring(n,c),this.sectionIndex=this.sectionIndex.slice(n,c)}substring(n,c){const m=new ru;return m.text=this.text.substring(n,c),m.sectionIndex=this.sectionIndex.slice(n,c),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((n,c)=>Math.max(n,this.sections[c].scale)),0)}addTextSection(n,c){this.text+=n.text,this.sections.push(Yl.forText(n.scale,n.fontStack||c));const m=this.sections.length-1;for(let x=0;x<n.text.length;++x)this.sectionIndex.push(m)}addImageSection(n){const c=n.image?n.image.name:"";if(c.length===0)return void Mt("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(Yl.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Mt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function qo(a,n,c,m,x,k,C,I,R,F,q,W,ee,se,ue){const de=ru.fromFeature(a,x);let Te;W===y.ah.vertical&&de.verticalizePunctuation();const{processBidirectionalText:Ae,processStyledBidirectionalText:Je}=Qs;if(Ae&&de.sections.length===1){Te=[];const mt=Ae(de.toString(),wd(de,F,k,n,m,se));for(const Dt of mt){const Jt=new ru;Jt.text=Dt,Jt.sections=de.sections;for(let Ti=0;Ti<Dt.length;Ti++)Jt.sectionIndex.push(0);Te.push(Jt)}}else if(Je){Te=[];const mt=Je(de.text,de.sectionIndex,wd(de,F,k,n,m,se));for(const Dt of mt){const Jt=new ru;Jt.text=Dt[0],Jt.sectionIndex=Dt[1],Jt.sections=de.sections,Te.push(Jt)}}else Te=(function(mt,Dt){const Jt=[],Ti=mt.text;let Ft=0;for(const Zt of Dt)Jt.push(mt.substring(Ft,Zt)),Ft=Zt;return Ft<Ti.length&&Jt.push(mt.substring(Ft,Ti.length)),Jt})(de,wd(de,F,k,n,m,se));const Oe=[],We={positionedLines:Oe,text:de.toString(),top:q[1],bottom:q[1],left:q[0],right:q[0],writingMode:W,iconsInText:!1,verticalizable:!1};return(function(mt,Dt,Jt,Ti,Ft,Zt,di,li,ri,vt,oi,ui){let Mi=0,Tn=Vo,Yn=0,hr=0;const ea=li==="right"?1:li==="left"?0:.5;let Cr=0;for(const Ls of Ft){Ls.trim();const fr=Ls.getMaxScale(),ta=(fr-1)*Zs,Ar={positionedGlyphs:[],lineOffset:0};mt.positionedLines[Cr]=Ar;const tr=Ar.positionedGlyphs;let Gs=0;if(!Ls.length()){Tn+=Zt,++Cr;continue}for(let ja=0;ja<Ls.length();ja++){const fn=Ls.getSection(ja),Bn=Ls.getSectionIndex(ja),cs=Ls.getCharCode(ja);let ia=0,ms=null,du=null,So=null,kl=Zs;const To=!(ri===y.ah.horizontal||!oi&&!Bo(cs)||oi&&(ks[cs]||(dr=cs,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(dr)))));if(fn.imageName){const Eo=Ti[fn.imageName];if(!Eo)continue;So=fn.imageName,mt.iconsInText=mt.iconsInText||!0,du=Eo.paddedRect;const pr=Eo.displaySize;fn.scale=fn.scale*Zs/ui,ms={width:pr[0],height:pr[1],left:Di,top:-Vn,advance:To?pr[1]:pr[0]},ia=ta+(Zs-pr[1]*fn.scale),kl=ms.advance;const Sc=To?pr[0]*fn.scale-Zs*fr:pr[1]*fn.scale-Zs*fr;Sc>0&&Sc>Gs&&(Gs=Sc)}else{const Eo=Jt[fn.fontStack],pr=Eo&&Eo[cs];if(pr&&pr.rect)du=pr.rect,ms=pr.metrics;else{const Sc=Dt[fn.fontStack],qu=Sc&&Sc[cs];if(!qu)continue;ms=qu.metrics}ia=(fr-fn.scale)*Zs}To?(mt.verticalizable=!0,tr.push({glyph:cs,imageName:So,x:Mi,y:Tn+ia,vertical:To,scale:fn.scale,fontStack:fn.fontStack,sectionIndex:Bn,metrics:ms,rect:du}),Mi+=kl*fn.scale+vt):(tr.push({glyph:cs,imageName:So,x:Mi,y:Tn+ia,vertical:To,scale:fn.scale,fontStack:fn.fontStack,sectionIndex:Bn,metrics:ms,rect:du}),Mi+=ms.advance*fn.scale+vt)}tr.length!==0&&(Yn=Math.max(Mi-vt,Yn),zg(tr,0,tr.length-1,ea,Gs)),Mi=0;const eo=Zt*fr+Gs;Ar.lineOffset=Math.max(Gs,ta),Tn+=eo,hr=Math.max(eo,hr),++Cr}var dr;const ga=Tn-Vo,{horizontalAlign:ya,verticalAlign:_a}=Ah(di);(function(Ls,fr,ta,Ar,tr,Gs,eo,ja,fn){const Bn=(fr-ta)*tr;let cs=0;cs=Gs!==eo?-ja*Ar-Vo:(-Ar*fn+.5)*eo;for(const ia of Ls)for(const ms of ia.positionedGlyphs)ms.x+=Bn,ms.y+=cs})(mt.positionedLines,ea,ya,_a,Yn,hr,Zt,ga,Ft.length),mt.top+=-_a*ga,mt.bottom=mt.top+ga,mt.left+=-ya*Yn,mt.right=mt.left+Yn})(We,n,c,m,Te,C,I,R,W,F,ee,ue),!(function(mt){for(const Dt of mt)if(Dt.positionedGlyphs.length!==0)return!1;return!0})(Oe)&&We}const ks={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},au={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Nu={40:!0};function Sf(a,n,c,m,x,k){if(n.imageName){const C=m[n.imageName];return C?C.displaySize[0]*n.scale*Zs/k+x:0}{const C=c[n.fontStack],I=C&&C[a];return I?I.metrics.advance*n.scale+x:0}}function Qa(a,n,c,m){const x=Math.pow(a-n,2);return m?a<n?x/2:2*x:x+Math.abs(c)*c}function kh(a,n,c){let m=0;return a===10&&(m-=1e4),c&&(m+=150),a!==40&&a!==65288||(m+=50),n!==41&&n!==65289||(m+=50),m}function Ch(a,n,c,m,x,k){let C=null,I=Qa(n,c,x,k);for(const R of m){const F=Qa(n-R.x,c,x,k)+R.badness;F<=I&&(C=R,I=F)}return{index:a,x:n,priorBreak:C,badness:I}}function Pa(a){return a?Pa(a.priorBreak).concat(a.index):[]}function wd(a,n,c,m,x,k){if(!a)return[];const C=[],I=(function(W,ee,se,ue,de,Te){let Ae=0;for(let Je=0;Je<W.length();Je++){const Oe=W.getSection(Je);Ae+=Sf(W.getCharCode(Je),Oe,ue,de,ee,Te)}return Ae/Math.max(1,Math.ceil(Ae/se))})(a,n,c,m,x,k),R=a.text.indexOf("")>=0;let F=0;for(let W=0;W<a.length();W++){const ee=a.getSection(W),se=a.getCharCode(W);if(ks[se]||(F+=Sf(se,ee,m,x,n,k)),W<a.length()-1){const ue=!((q=se)<11904)&&(!!Oi["CJK Compatibility Forms"](q)||!!Oi["CJK Compatibility"](q)||!!Oi["CJK Strokes"](q)||!!Oi["CJK Symbols and Punctuation"](q)||!!Oi["Enclosed CJK Letters and Months"](q)||!!Oi["Halfwidth and Fullwidth Forms"](q)||!!Oi["Ideographic Description Characters"](q)||!!Oi["Vertical Forms"](q)||Ha.test(String.fromCodePoint(q)));(au[se]||ue||ee.imageName||W!==a.length()-2&&Nu[a.getCharCode(W+1)])&&C.push(Ch(W+1,F,I,C,kh(se,a.getCharCode(W+1),ue&&R),!1))}}var q;return Pa(Ch(a.length(),F,I,C,0,!0))}function Ah(a){let n=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:n,verticalAlign:c}}function zg(a,n,c,m,x){if(!m&&!x)return;const k=a[c],C=(a[c].x+k.metrics.advance*k.scale)*m;for(let I=n;I<=c;I++)a[I].x-=C,a[I].y+=x}function Tf(a,n,c){const{horizontalAlign:m,verticalAlign:x}=Ah(c),k=n[0]-a.displaySize[0]*m,C=n[1]-a.displaySize[1]*x;return{image:a,top:C,bottom:C+a.displaySize[1],left:k,right:k+a.displaySize[0]}}function Sd(a){var n,c;let m=a.left,x=a.top,k=a.right-m,C=a.bottom-x;const I=(n=a.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",R=(c=a.image.textFitHeight)!==null&&c!==void 0?c:"stretchOrShrink",F=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(R==="proportional"){if(I==="stretchOnly"&&k/C<F||I==="proportional"){const q=Math.ceil(C*F);m*=q/k,k=q}}else if(I==="proportional"&&R==="stretchOnly"&&F!==0&&k/C>F){const q=Math.ceil(k/F);x*=q/C,C=q}return{x1:m,y1:x,x2:m+k,y2:x+C}}function wc(a,n,c,m,x,k){const C=a.image;let I;if(C.content){const Te=C.content,Ae=C.pixelRatio||1;I=[Te[0]/Ae,Te[1]/Ae,C.displaySize[0]-Te[2]/Ae,C.displaySize[1]-Te[3]/Ae]}const R=n.left*k,F=n.right*k;let q,W,ee,se;c==="width"||c==="both"?(se=x[0]+R-m[3],W=x[0]+F+m[1]):(se=x[0]+(R+F-C.displaySize[0])/2,W=se+C.displaySize[0]);const ue=n.top*k,de=n.bottom*k;return c==="height"||c==="both"?(q=x[1]+ue-m[0],ee=x[1]+de+m[2]):(q=x[1]+(ue+de-C.displaySize[1])/2,ee=q+C.displaySize[1]),{image:C,top:q,right:W,bottom:ee,left:se,collisionPadding:I}}const Bs=255,Qr=128,bo=Bs*Qr;function Xl(a,n){const{expression:c}=n;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new Ji(a+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:x}=c;let k=0;for(;k<m.length&&m[k]<=a;)k++;k=Math.max(0,k-1);let C=k;for(;C<m.length&&m[C]<a+1;)C++;C=Math.min(m.length-1,C);const I=m[k],R=m[C];return c.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:R,interpolationType:x}:{kind:"camera",minZoom:I,maxZoom:R,minSize:c.evaluate(new Ji(I)),maxSize:c.evaluate(new Ji(R)),interpolationType:x}}}function Td(a,n,c){let m="never";const x=a.get(n);return x?m=x:a.get(c)&&(m="always"),m}const Kp=_c.VectorTileFeature.types,Rg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ou(a,n,c,m,x,k,C,I,R,F,q,W,ee){const se=I?Math.min(bo,Math.round(I[0])):0,ue=I?Math.min(bo,Math.round(I[1])):0;a.emplaceBack(n,c,Math.round(32*m),Math.round(32*x),k,C,(se<<1)+(R?1:0),ue,16*F,16*q,256*W,256*ee)}function Ed(a,n,c){a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c)}function wo(a){for(const n of a.sections)if(lh(n.text))return!0;return!1}class Ef{constructor(n){this.layoutVertexArray=new dc,this.indexArray=new fa,this.programConfigurations=n,this.segments=new Qi,this.dynamicLayoutVertexArray=new vo,this.opacityVertexArray=new ji,this.hasVisibleVertices=!1,this.placedSymbolArray=new Fn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,c,m,x){this.isEmpty()||(m&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,w_.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Mg.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,Rg,!0),this.opacityVertexBuffer.itemSize=1),(m||x)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}It("SymbolBuffers",Ef);class pa{constructor(n,c,m){this.layoutVertexArray=new n,this.layoutAttributes=c,this.indexArray=new m,this.segments=new Qi,this.collisionVertexArray=new os}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Pg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}It("CollisionBuffers",pa);class Bu{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((C=>C.id)),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=hf([]),this.placementViewportMatrix=hf([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Xl(this.zoom,c["text-size"]),this.iconSizeData=Xl(this.zoom,c["icon-size"]);const m=this.layers[0].layout,x=m.get("symbol-sort-key"),k=m.get("symbol-z-order");this.canOverlap=Td(m,"text-overlap","text-allow-overlap")!=="never"||Td(m,"icon-overlap","icon-allow-overlap")!=="never"||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!x.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map((C=>y.ah[C]))),this.stateDependentLayerIds=this.layers.filter((C=>C.isStateDependent())).map((C=>C.id)),this.sourceID=n.sourceID}createArrays(){this.text=new Ef(new Kc(this.layers,this.zoom,(n=>/^text/.test(n)))),this.icon=new Ef(new Kc(this.layers,this.zoom,(n=>/^icon/.test(n)))),this.glyphOffsetArray=new Nn,this.lineVertexArray=new er,this.symbolInstances=new an,this.textAnchorOffsets=new Xn}calculateGlyphDependencies(n,c,m,x,k){for(let C=0;C<n.length;C++)if(c[n.charCodeAt(C)]=!0,(m||x)&&k){const I=bh[n.charAt(C)];I&&(c[I.charCodeAt(0)]=!0)}}populate(n,c,m){const x=this.layers[0],k=x.layout,C=k.get("text-font"),I=k.get("text-field"),R=k.get("icon-image"),F=(I.value.kind!=="constant"||I.value.value instanceof Xs&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),q=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,W=k.get("symbol-sort-key");if(this.features=[],!F&&!q)return;const ee=c.iconDependencies,se=c.glyphDependencies,ue=c.availableImages,de=new Ji(this.zoom);for(const{feature:Te,id:Ae,index:Je,sourceLayerIndex:Oe}of n){const We=x._featureFilter.needGeometry,mt=Qc(Te,We);if(!x._featureFilter.filter(de,mt,m))continue;let Dt,Jt;if(We||(mt.geometry=Jc(Te)),F){const Ft=x.getValueAndResolveTokens("text-field",mt,m,ue),Zt=Xs.factory(Ft),di=this.hasRTLText=this.hasRTLText||wo(Zt);(!di||Qs.getRTLTextPluginStatus()==="unavailable"||di&&Qs.isParsed())&&(Dt=xc(Zt,x,mt))}if(q){const Ft=x.getValueAndResolveTokens("icon-image",mt,m,ue);Jt=Ft instanceof vr?Ft:vr.fromString(Ft)}if(!Dt&&!Jt)continue;const Ti=this.sortFeaturesByKey?W.evaluate(mt,{},m):void 0;if(this.features.push({id:Ae,text:Dt,icon:Jt,index:Je,sourceLayerIndex:Oe,geometry:mt.geometry,properties:Te.properties,type:Kp[Te.type],sortKey:Ti}),Jt&&(ee[Jt.name]=!0),Dt){const Ft=C.evaluate(mt,{},m).join(","),Zt=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ah.vertical)>=0;for(const di of Dt.sections)if(di.image)ee[di.image.name]=!0;else{const li=yo(Dt.toString()),ri=di.fontStack||Ft,vt=se[ri]=se[ri]||{};this.calculateGlyphDependencies(di.text,vt,Zt,this.allowVerticalPlacement,li)}}}k.get("symbol-placement")==="line"&&(this.features=(function(Te){const Ae={},Je={},Oe=[];let We=0;function mt(Ft){Oe.push(Te[Ft]),We++}function Dt(Ft,Zt,di){const li=Je[Ft];return delete Je[Ft],Je[Zt]=li,Oe[li].geometry[0].pop(),Oe[li].geometry[0]=Oe[li].geometry[0].concat(di[0]),li}function Jt(Ft,Zt,di){const li=Ae[Zt];return delete Ae[Zt],Ae[Ft]=li,Oe[li].geometry[0].shift(),Oe[li].geometry[0]=di[0].concat(Oe[li].geometry[0]),li}function Ti(Ft,Zt,di){const li=di?Zt[0][Zt[0].length-1]:Zt[0][0];return`${Ft}:${li.x}:${li.y}`}for(let Ft=0;Ft<Te.length;Ft++){const Zt=Te[Ft],di=Zt.geometry,li=Zt.text?Zt.text.toString():null;if(!li){mt(Ft);continue}const ri=Ti(li,di),vt=Ti(li,di,!0);if(ri in Je&&vt in Ae&&Je[ri]!==Ae[vt]){const oi=Jt(ri,vt,di),ui=Dt(ri,vt,Oe[oi].geometry);delete Ae[ri],delete Je[vt],Je[Ti(li,Oe[ui].geometry,!0)]=ui,Oe[oi].geometry=null}else ri in Je?Dt(ri,vt,di):vt in Ae?Jt(ri,vt,di):(mt(Ft),Ae[ri]=We-1,Je[vt]=We-1)}return Oe.filter((Ft=>Ft.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Te,Ae)=>Te.sortKey-Ae.sortKey))}update(n,c,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,c,this.layers,m),this.icon.programConfigurations.updatePaintArrays(n,c,this.layers,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,c){const m=this.lineVertexArray.length;if(n.segment!==void 0){let x=n.dist(c[n.segment+1]),k=n.dist(c[n.segment]);const C={};for(let I=n.segment+1;I<c.length;I++)C[I]={x:c[I].x,y:c[I].y,tileUnitDistanceFromAnchor:x},I<c.length-1&&(x+=c[I+1].dist(c[I]));for(let I=n.segment||0;I>=0;I--)C[I]={x:c[I].x,y:c[I].y,tileUnitDistanceFromAnchor:k},I>0&&(k+=c[I-1].dist(c[I]));for(let I=0;I<c.length;I++){const R=C[I];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(n,c,m,x,k,C,I,R,F,q,W,ee){const se=n.indexArray,ue=n.layoutVertexArray,de=n.segments.prepareSegment(4*c.length,ue,se,this.canOverlap?C.sortKey:void 0),Te=this.glyphOffsetArray.length,Ae=de.vertexLength,Je=this.allowVerticalPlacement&&I===y.ah.vertical?Math.PI/2:0,Oe=C.text&&C.text.sections;for(let We=0;We<c.length;We++){const{tl:mt,tr:Dt,bl:Jt,br:Ti,tex:Ft,pixelOffsetTL:Zt,pixelOffsetBR:di,minFontScaleX:li,minFontScaleY:ri,glyphOffset:vt,isSDF:oi,sectionIndex:ui}=c[We],Mi=de.vertexLength,Tn=vt[1];ou(ue,R.x,R.y,mt.x,Tn+mt.y,Ft.x,Ft.y,m,oi,Zt.x,Zt.y,li,ri),ou(ue,R.x,R.y,Dt.x,Tn+Dt.y,Ft.x+Ft.w,Ft.y,m,oi,di.x,Zt.y,li,ri),ou(ue,R.x,R.y,Jt.x,Tn+Jt.y,Ft.x,Ft.y+Ft.h,m,oi,Zt.x,di.y,li,ri),ou(ue,R.x,R.y,Ti.x,Tn+Ti.y,Ft.x+Ft.w,Ft.y+Ft.h,m,oi,di.x,di.y,li,ri),Ed(n.dynamicLayoutVertexArray,R,Je),se.emplaceBack(Mi,Mi+1,Mi+2),se.emplaceBack(Mi+1,Mi+2,Mi+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vt[0]),We!==c.length-1&&ui===c[We+1].sectionIndex||n.programConfigurations.populatePaintArrays(ue.length,C,C.index,{},ee,Oe&&Oe[ui])}n.placedSymbolArray.emplaceBack(R.x,R.y,Te,this.glyphOffsetArray.length-Te,Ae,F,q,R.segment,m?m[0]:0,m?m[1]:0,x[0],x[1],I,0,!1,0,W)}_addCollisionDebugVertex(n,c,m,x,k,C){return c.emplaceBack(0,0),n.emplaceBack(m.x,m.y,x,k,Math.round(C.x),Math.round(C.y))}addCollisionDebugVertices(n,c,m,x,k,C,I){const R=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),F=R.vertexLength,q=k.layoutVertexArray,W=k.collisionVertexArray,ee=I.anchorX,se=I.anchorY;this._addCollisionDebugVertex(q,W,C,ee,se,new N(n,c)),this._addCollisionDebugVertex(q,W,C,ee,se,new N(m,c)),this._addCollisionDebugVertex(q,W,C,ee,se,new N(m,x)),this._addCollisionDebugVertex(q,W,C,ee,se,new N(n,x)),R.vertexLength+=4;const ue=k.indexArray;ue.emplaceBack(F,F+1),ue.emplaceBack(F+1,F+2),ue.emplaceBack(F+2,F+3),ue.emplaceBack(F+3,F),R.primitiveLength+=4}addDebugCollisionBoxes(n,c,m,x){for(let k=n;k<c;k++){const C=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,x?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,m)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pa(dn,Es.members,js),this.iconCollisionBox=new pa(dn,Es.members,js);for(let n=0;n<this.symbolInstances.length;n++){const c=this.symbolInstances.get(n);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(n,c,m,x,k,C,I,R,F){const q={};for(let W=c;W<m;W++){const ee=n.get(W);q.textBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},q.textFeatureIndex=ee.featureIndex;break}for(let W=x;W<k;W++){const ee=n.get(W);q.verticalTextBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},q.verticalTextFeatureIndex=ee.featureIndex;break}for(let W=C;W<I;W++){const ee=n.get(W);q.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},q.iconFeatureIndex=ee.featureIndex;break}for(let W=R;W<F;W++){const ee=n.get(W);q.verticalIconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},q.verticalIconFeatureIndex=ee.featureIndex;break}return q}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const m=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,c){const m=n.placedSymbolArray.get(c),x=m.vertexStartIndex+4*m.numGlyphs;for(let k=m.vertexStartIndex;k<x;k+=4)n.indexArray.emplaceBack(k,k+1,k+2),n.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(n),m=Math.cos(n),x=[],k=[],C=[];for(let I=0;I<this.symbolInstances.length;++I){C.push(I);const R=this.symbolInstances.get(I);x.push(0|Math.round(c*R.anchorX+m*R.anchorY)),k.push(R.featureIndex)}return C.sort(((I,R)=>x[I]-x[R]||k[R]-k[I])),C}addToSortKeyRanges(n,c){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===c?m.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const m=this.symbolInstances.get(c);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach(((x,k,C)=>{x>=0&&C.indexOf(x)===k&&this.addIndicesForPlacedSymbol(this.text,x)})),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Jp,Dg;It("SymbolBucket",Bu,{omit:["layers","collisionBoxArray","features","compareText"]}),Bu.MAX_GLYPHS=65535,Bu.addDynamicAttributes=Ed;var Kl={get paint(){return Dg=Dg||new E({"icon-opacity":new bi(it.paint_symbol["icon-opacity"]),"icon-color":new bi(it.paint_symbol["icon-color"]),"icon-halo-color":new bi(it.paint_symbol["icon-halo-color"]),"icon-halo-width":new bi(it.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bi(it.paint_symbol["icon-halo-blur"]),"icon-translate":new ci(it.paint_symbol["icon-translate"]),"icon-translate-anchor":new ci(it.paint_symbol["icon-translate-anchor"]),"text-opacity":new bi(it.paint_symbol["text-opacity"]),"text-color":new bi(it.paint_symbol["text-color"],{runtimeType:Wi,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new bi(it.paint_symbol["text-halo-color"]),"text-halo-width":new bi(it.paint_symbol["text-halo-width"]),"text-halo-blur":new bi(it.paint_symbol["text-halo-blur"]),"text-translate":new ci(it.paint_symbol["text-translate"]),"text-translate-anchor":new ci(it.paint_symbol["text-translate-anchor"])})},get layout(){return Jp=Jp||new E({"symbol-placement":new ci(it.layout_symbol["symbol-placement"]),"symbol-spacing":new ci(it.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ci(it.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bi(it.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ci(it.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ci(it.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ci(it.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ci(it.layout_symbol["icon-ignore-placement"]),"icon-optional":new ci(it.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ci(it.layout_symbol["icon-rotation-alignment"]),"icon-size":new bi(it.layout_symbol["icon-size"]),"icon-text-fit":new ci(it.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ci(it.layout_symbol["icon-text-fit-padding"]),"icon-image":new bi(it.layout_symbol["icon-image"]),"icon-rotate":new bi(it.layout_symbol["icon-rotate"]),"icon-padding":new bi(it.layout_symbol["icon-padding"]),"icon-keep-upright":new ci(it.layout_symbol["icon-keep-upright"]),"icon-offset":new bi(it.layout_symbol["icon-offset"]),"icon-anchor":new bi(it.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ci(it.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ci(it.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ci(it.layout_symbol["text-rotation-alignment"]),"text-field":new bi(it.layout_symbol["text-field"]),"text-font":new bi(it.layout_symbol["text-font"]),"text-size":new bi(it.layout_symbol["text-size"]),"text-max-width":new bi(it.layout_symbol["text-max-width"]),"text-line-height":new ci(it.layout_symbol["text-line-height"]),"text-letter-spacing":new bi(it.layout_symbol["text-letter-spacing"]),"text-justify":new bi(it.layout_symbol["text-justify"]),"text-radial-offset":new bi(it.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ci(it.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new bi(it.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new bi(it.layout_symbol["text-anchor"]),"text-max-angle":new ci(it.layout_symbol["text-max-angle"]),"text-writing-mode":new ci(it.layout_symbol["text-writing-mode"]),"text-rotate":new bi(it.layout_symbol["text-rotate"]),"text-padding":new ci(it.layout_symbol["text-padding"]),"text-keep-upright":new ci(it.layout_symbol["text-keep-upright"]),"text-transform":new bi(it.layout_symbol["text-transform"]),"text-offset":new bi(it.layout_symbol["text-offset"]),"text-allow-overlap":new ci(it.layout_symbol["text-allow-overlap"]),"text-overlap":new ci(it.layout_symbol["text-overlap"]),"text-ignore-placement":new ci(it.layout_symbol["text-ignore-placement"]),"text-optional":new ci(it.layout_symbol["text-optional"])})}};class kd{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Un,this.defaultValue=n}evaluate(n){if(n.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(n.formattedSection))return c.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}It("FormatSectionOverride",kd,{omit:["defaultValue"]});class Mh extends h{constructor(n){super(n,Kl)}recalculate(n,c){if(super.recalculate(n,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const m=this.layout.get("text-writing-mode");if(m){const x=[];for(const k of m)x.indexOf(k)<0&&x.push(k);this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,c,m,x){const k=this.layout.get(n).evaluate(c,{},m,x),C=this._unevaluatedLayout._values[n];return C.isDataDriven()||mo(C.value)||!k?k:(function(I,R){return R.replace(/{([^{}]+)}/g,((F,q)=>I&&q in I?String(I[q]):""))})(c.properties,k)}createBucket(n){return new Bu(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Kl.paint.overridableProperties){if(!Mh.hasPaintOverride(this.layout,n))continue;const c=this.paint.get(n),m=new kd(c),x=new Ro(m,c.property.specification);let k=null;k=c.value.kind==="constant"||c.value.kind==="source"?new Zr("source",x):new ka("composite",x,c.value.zoomStops),this.paint._values[n]=new Za(c.property,k,c.parameters)}}_handleOverridablePaintPropertyUpdate(n,c,m){return!(!this.layout||c.isDataDriven()||m.isDataDriven())&&Mh.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,c){const m=n.get("text-field"),x=Kl.paint.properties[c];let k=!1;const C=I=>{for(const R of I)if(x.overrides&&x.overrides.hasOverride(R))return void(k=!0)};if(m.value.kind==="constant"&&m.value.value instanceof Xs)C(m.value.value.sections);else if(m.value.kind==="source"){const I=F=>{k||(F instanceof gs&&ki(F.value)===Pn?C(F.value.sections):F instanceof jo?C(F.sections):F.eachChild(I))},R=m.value;R._styleExpression&&I(R._styleExpression.expression)}return k}}let $u;var Og={get paint(){return $u=$u||new E({"background-color":new ci(it.paint_background["background-color"]),"background-pattern":new wl(it.paint_background["background-pattern"]),"background-opacity":new ci(it.paint_background["background-opacity"])})}};class Ng extends h{constructor(n){super(n,Og)}}let Qp;var Bg={get paint(){return Qp=Qp||new E({"raster-opacity":new ci(it.paint_raster["raster-opacity"]),"raster-hue-rotate":new ci(it.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ci(it.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ci(it.paint_raster["raster-brightness-max"]),"raster-saturation":new ci(it.paint_raster["raster-saturation"]),"raster-contrast":new ci(it.paint_raster["raster-contrast"]),"raster-resampling":new ci(it.paint_raster["raster-resampling"]),"raster-fade-duration":new ci(it.paint_raster["raster-fade-duration"])})}};class kf extends h{constructor(n){super(n,Bg)}}class em extends h{constructor(n){super(n,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class E_{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const tm=63710088e-1;class lu{constructor(n,c){if(isNaN(n)||isNaN(c))throw new Error(`Invalid LngLat object: (${n}, ${c})`);if(this.lng=+n,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new lu(ke(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const c=Math.PI/180,m=this.lat*c,x=n.lat*c,k=Math.sin(m)*Math.sin(x)+Math.cos(m)*Math.cos(x)*Math.cos((n.lng-this.lng)*c);return tm*Math.acos(Math.min(k,1))}static convert(n){if(n instanceof lu)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new lu(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new lu(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const im=2*Math.PI*tm;function nm(a){return im*Math.cos(a*Math.PI/180)}function Uu(a){return(180+a)/360}function Cd(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function sm(a,n){return a/nm(n)}function Cf(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class Ph{constructor(n,c,m=0){this.x=+n,this.y=+c,this.z=+m}static fromLngLat(n,c=0){const m=lu.convert(n);return new Ph(Uu(m.lng),Cd(m.lat),sm(c,m.lat))}toLngLat(){return new lu(360*this.x-180,Cf(this.y))}toAltitude(){return this.z*nm(Cf(this.y))}meterInMercatorCoordinateUnits(){return 1/im*(n=Cf(this.y),1/Math.cos(n*Math.PI/180));var n}}function rm(a,n,c){var m=2*Math.PI*6378137/256/Math.pow(2,c);return[a*m-2*Math.PI*6378137/2,n*m-2*Math.PI*6378137/2]}class Af{constructor(n,c,m){if(!(function(x,k,C){return!(x<0||x>25||C<0||C>=Math.pow(2,x)||k<0||k>=Math.pow(2,x))})(n,c,m))throw new Error(`x=${c}, y=${m}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=c,this.y=m,this.key=jh(0,n,n,c,m)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,c,m){const x=(C=this.y,I=this.z,R=rm(256*(k=this.x),256*(C=Math.pow(2,I)-C-1),I),F=rm(256*(k+1),256*(C+1),I),R[0]+","+R[1]+","+F[0]+","+F[1]);var k,C,I,R,F;const q=(function(W,ee,se){let ue,de="";for(let Te=W;Te>0;Te--)ue=1<<Te-1,de+=(ee&ue?1:0)+(se&ue?2:0);return de})(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(m==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,q).replace(/{bbox-epsg-3857}/g,x)}isChildOf(n){const c=this.z-n.z;return c>0&&n.x===this.x>>c&&n.y===this.y>>c}getTilePoint(n){const c=Math.pow(2,this.z);return new N((n.x*c-this.x)*Os,(n.y*c-this.y)*Os)}toString(){return`${this.z}/${this.x}/${this.y}`}}class am{constructor(n,c){this.wrap=n,this.canonical=c,this.key=jh(n,c.z,c.z,c.x,c.y)}}class ma{constructor(n,c,m,x,k){if(n<m)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${m}`);this.overscaledZ=n,this.wrap=c,this.canonical=new Af(m,+x,+k),this.key=jh(c,n,m,x,k)}clone(){return new ma(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-n;return n>this.canonical.z?new ma(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ma(n,this.wrap,n,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(n,c){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const m=this.canonical.z-n;return n>this.canonical.z?jh(this.wrap*+c,n,this.canonical.z,this.canonical.x,this.canonical.y):jh(this.wrap*+c,n,n,this.canonical.x>>m,this.canonical.y>>m)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const c=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>c&&n.canonical.y===this.canonical.y>>c}children(n){if(this.overscaledZ>=n)return[new ma(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,m=2*this.canonical.x,x=2*this.canonical.y;return[new ma(c,this.wrap,c,m,x),new ma(c,this.wrap,c,m+1,x),new ma(c,this.wrap,c,m,x+1),new ma(c,this.wrap,c,m+1,x+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new ma(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new ma(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new am(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Ph(n.x-this.wrap,n.y))}}function jh(a,n,c,m,x){(a*=2)<0&&(a=-1*a-1);const k=1<<c;return(k*k*a+k*x+m).toString(36)+c.toString(36)+n.toString(36)}It("CanonicalTileID",Af),It("OverscaledTileID",ma,{omit:["posMatrix"]});class om{constructor(n,c,m,x=1,k=1,C=1,I=0){if(this.uid=n,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(m&&!["mapbox","terrarium","custom"].includes(m))return void Mt(`"${m}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=c.height;const R=this.dim=c.height-2;switch(this.data=new Uint32Array(c.data.buffer),m){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=x,this.greenFactor=k,this.blueFactor=C,this.baseShift=I;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let F=0;F<R;F++)this.data[this._idx(-1,F)]=this.data[this._idx(0,F)],this.data[this._idx(R,F)]=this.data[this._idx(R-1,F)],this.data[this._idx(F,-1)]=this.data[this._idx(F,0)],this.data[this._idx(F,R)]=this.data[this._idx(F,R-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(R,-1)]=this.data[this._idx(R-1,0)],this.data[this._idx(-1,R)]=this.data[this._idx(0,R-1)],this.data[this._idx(R,R)]=this.data[this._idx(R-1,R-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let F=0;F<R;F++)for(let q=0;q<R;q++){const W=this.get(F,q);W>this.max&&(this.max=W),W<this.min&&(this.min=W)}}get(n,c){const m=new Uint8Array(this.data.buffer),x=4*this._idx(n,c);return this.unpack(m[x],m[x+1],m[x+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,c){if(n<-1||n>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(n+1)}unpack(n,c,m){return n*this.redFactor+c*this.greenFactor+m*this.blueFactor-this.baseShift}getPixels(){return new Xa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,c,m){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let x=c*this.dim,k=c*this.dim+this.dim,C=m*this.dim,I=m*this.dim+this.dim;switch(c){case-1:x=k-1;break;case 1:k=x+1}switch(m){case-1:C=I-1;break;case 1:I=C+1}const R=-c*this.dim,F=-m*this.dim;for(let q=C;q<I;q++)for(let W=x;W<k;W++)this.data[this._idx(W,q)]=n.data[this._idx(W+R,q+F)]}}It("DEMData",om);class Jn{constructor(n){this._stringToNumber={},this._numberToString=[];for(let c=0;c<n.length;c++){const m=n[c];this._stringToNumber[m]=c,this._numberToString[c]=m}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class Mf{constructor(n,c,m,x,k){this.type="Feature",this._vectorTileFeature=n,n._z=c,n._x=m,n._y=x,this.properties=n.properties,this.id=k}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const c in this)c!=="_geometry"&&c!=="_vectorTileFeature"&&(n[c]=this[c]);return n}}class $g{constructor(n,c){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new _n(Os,16,0),this.grid3D=new _n(Os,16,0),this.featureIndexArray=new rs,this.promoteId=c}insert(n,c,m,x,k,C){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,x,k);const R=C?this.grid3D:this.grid;for(let F=0;F<c.length;F++){const q=c[F],W=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<q.length;ee++){const se=q[ee];W[0]=Math.min(W[0],se.x),W[1]=Math.min(W[1],se.y),W[2]=Math.max(W[2],se.x),W[3]=Math.max(W[3],se.y)}W[0]<Os&&W[1]<Os&&W[2]>=0&&W[3]>=0&&R.insert(I,W[0],W[1],W[2],W[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new _c.VectorTile(new wf(this.rawTileData)).layers,this.sourceLayerCoder=new Jn(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,c,m,x){this.loadVTLayers();const k=n.params||{},C=Os/n.tileSize/n.scale,I=fl(k.filter),R=n.queryGeometry,F=n.queryPadding*C,q=Ug(R),W=this.grid.query(q.minX-F,q.minY-F,q.maxX+F,q.maxY+F),ee=Ug(n.cameraQueryGeometry),se=this.grid3D.query(ee.minX-F,ee.minY-F,ee.maxX+F,ee.maxY+F,((Te,Ae,Je,Oe)=>(function(We,mt,Dt,Jt,Ti){for(const Zt of We)if(mt<=Zt.x&&Dt<=Zt.y&&Jt>=Zt.x&&Ti>=Zt.y)return!0;const Ft=[new N(mt,Dt),new N(mt,Ti),new N(Jt,Ti),new N(Jt,Dt)];if(We.length>2){for(const Zt of Ft)if(gc(We,Zt))return!0}for(let Zt=0;Zt<We.length-1;Zt++)if(og(We[Zt],We[Zt+1],Ft))return!0;return!1})(n.cameraQueryGeometry,Te-F,Ae-F,Je+F,Oe+F)));for(const Te of se)W.push(Te);W.sort(k_);const ue={};let de;for(let Te=0;Te<W.length;Te++){const Ae=W[Te];if(Ae===de)continue;de=Ae;const Je=this.featureIndexArray.get(Ae);let Oe=null;this.loadMatchingFeature(ue,Je.bucketIndex,Je.sourceLayerIndex,Je.featureIndex,I,k.layers,k.availableImages,c,m,x,((We,mt,Dt)=>(Oe||(Oe=Jc(We)),mt.queryIntersectsFeature(R,We,Dt,Oe,this.z,n.transform,C,n.pixelPosMatrix))))}return ue}loadMatchingFeature(n,c,m,x,k,C,I,R,F,q,W){const ee=this.bucketLayerIDs[c];if(C&&!(function(Te,Ae){for(let Je=0;Je<Te.length;Je++)if(Ae.indexOf(Te[Je])>=0)return!0;return!1})(C,ee))return;const se=this.sourceLayerCoder.decode(m),ue=this.vtLayers[se].feature(x);if(k.needGeometry){const Te=Qc(ue,!0);if(!k.filter(new Ji(this.tileID.overscaledZ),Te,this.tileID.canonical))return}else if(!k.filter(new Ji(this.tileID.overscaledZ),ue))return;const de=this.getId(ue,se);for(let Te=0;Te<ee.length;Te++){const Ae=ee[Te];if(C&&C.indexOf(Ae)<0)continue;const Je=R[Ae];if(!Je)continue;let Oe={};de&&q&&(Oe=q.getState(Je.sourceLayer||"_geojsonTileLayer",de));const We=Me({},F[Ae]);We.paint=lm(We.paint,Je.paint,ue,Oe,I),We.layout=lm(We.layout,Je.layout,ue,Oe,I);const mt=!W||W(ue,Je,Oe);if(!mt)continue;const Dt=new Mf(ue,this.z,this.x,this.y,de);Dt.layer=We;let Jt=n[Ae];Jt===void 0&&(Jt=n[Ae]=[]),Jt.push({featureIndex:x,feature:Dt,intersectionZ:mt})}}lookupSymbolFeatures(n,c,m,x,k,C,I,R){const F={};this.loadVTLayers();const q=fl(k);for(const W of n)this.loadMatchingFeature(F,m,x,W,q,C,I,R,c);return F}hasLayer(n){for(const c of this.bucketLayerIDs)for(const m of c)if(n===m)return!0;return!1}getId(n,c){let m=n.id;return this.promoteId&&(m=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[c]],typeof m=="boolean"&&(m=Number(m))),m}}function lm(a,n,c,m,x){return Fe(a,((k,C)=>{const I=n instanceof xl?n.get(C):null;return I&&I.evaluate?I.evaluate(c,m,x):I}))}function Ug(a){let n=1/0,c=1/0,m=-1/0,x=-1/0;for(const k of a)n=Math.min(n,k.x),c=Math.min(c,k.y),m=Math.max(m,k.x),x=Math.max(x,k.y);return{minX:n,minY:c,maxX:m,maxY:x}}function k_(a,n){return n-a}function Fg(a,n,c,m,x){const k=[];for(let C=0;C<a.length;C++){const I=a[C];let R;for(let F=0;F<I.length-1;F++){let q=I[F],W=I[F+1];q.x<n&&W.x<n||(q.x<n?q=new N(n,q.y+(n-q.x)/(W.x-q.x)*(W.y-q.y))._round():W.x<n&&(W=new N(n,q.y+(n-q.x)/(W.x-q.x)*(W.y-q.y))._round()),q.y<c&&W.y<c||(q.y<c?q=new N(q.x+(c-q.y)/(W.y-q.y)*(W.x-q.x),c)._round():W.y<c&&(W=new N(q.x+(c-q.y)/(W.y-q.y)*(W.x-q.x),c)._round()),q.x>=m&&W.x>=m||(q.x>=m?q=new N(m,q.y+(m-q.x)/(W.x-q.x)*(W.y-q.y))._round():W.x>=m&&(W=new N(m,q.y+(m-q.x)/(W.x-q.x)*(W.y-q.y))._round()),q.y>=x&&W.y>=x||(q.y>=x?q=new N(q.x+(x-q.y)/(W.y-q.y)*(W.x-q.x),x)._round():W.y>=x&&(W=new N(q.x+(x-q.y)/(W.y-q.y)*(W.x-q.x),x)._round()),R&&q.equals(R[R.length-1])||(R=[q],k.push(R)),R.push(W)))))}}return k}It("FeatureIndex",$g,{omit:["rawTileData","sourceLayerCoder"]});class El extends N{constructor(n,c,m,x){super(n,c),this.angle=m,x!==void 0&&(this.segment=x)}clone(){return new El(this.x,this.y,this.angle,this.segment)}}function Fu(a,n,c,m,x){if(n.segment===void 0||c===0)return!0;let k=n,C=n.segment+1,I=0;for(;I>-c/2;){if(C--,C<0)return!1;I-=a[C].dist(k),k=a[C]}I+=a[C].dist(a[C+1]),C++;const R=[];let F=0;for(;I<c/2;){const q=a[C],W=a[C+1];if(!W)return!1;let ee=a[C-1].angleTo(q)-q.angleTo(W);for(ee=Math.abs((ee+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:I,angleDelta:ee}),F+=ee;I-R[0].distance>m;)F-=R.shift().angleDelta;if(F>x)return!1;C++,I+=q.dist(W)}return!0}function Pf(a){let n=0;for(let c=0;c<a.length-1;c++)n+=a[c].dist(a[c+1]);return n}function Ad(a,n,c){return a?.6*n*c:0}function jf(a,n){return Math.max(a?a.right-a.left:0,n?n.right-n.left:0)}function cu(a,n,c,m,x,k){const C=Ad(c,x,k),I=jf(c,m)*k;let R=0;const F=Pf(a)/2;for(let q=0;q<a.length-1;q++){const W=a[q],ee=a[q+1],se=W.dist(ee);if(R+se>F){const ue=(F-R)/se,de=Fs.number(W.x,ee.x,ue),Te=Fs.number(W.y,ee.y,ue),Ae=new El(de,Te,ee.angleTo(W),q);return Ae._round(),!C||Fu(a,Ae,I,C,n)?Ae:void 0}R+=se}}function Jl(a,n,c,m,x,k,C,I,R){const F=Ad(m,k,C),q=jf(m,x),W=q*C,ee=a[0].x===0||a[0].x===R||a[0].y===0||a[0].y===R;return n-W<n/4&&(n=W+n/4),Ih(a,ee?n/2*I%n:(q/2+2*k)*C*I%n,n,F,c,W,ee,!1,R)}function Ih(a,n,c,m,x,k,C,I,R){const F=k/2,q=Pf(a);let W=0,ee=n-c,se=[];for(let ue=0;ue<a.length-1;ue++){const de=a[ue],Te=a[ue+1],Ae=de.dist(Te),Je=Te.angleTo(de);for(;ee+c<W+Ae;){ee+=c;const Oe=(ee-W)/Ae,We=Fs.number(de.x,Te.x,Oe),mt=Fs.number(de.y,Te.y,Oe);if(We>=0&&We<R&&mt>=0&&mt<R&&ee-F>=0&&ee+F<=q){const Dt=new El(We,mt,Je,ue);Dt._round(),m&&!Fu(a,Dt,k,m,x)||se.push(Dt)}}W+=Ae}return I||se.length||C||(se=Ih(a,W/2,c,m,x,k,C,!0,R)),se}It("Anchor",El);const Lh=Di;function cm(a,n,c,m){const x=[],k=a.image,C=k.pixelRatio,I=k.paddedRect.w-2*Lh,R=k.paddedRect.h-2*Lh;let F={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const q=k.stretchX||[[0,I]],W=k.stretchY||[[0,R]],ee=(vt,oi)=>vt+oi[1]-oi[0],se=q.reduce(ee,0),ue=W.reduce(ee,0),de=I-se,Te=R-ue;let Ae=0,Je=se,Oe=0,We=ue,mt=0,Dt=de,Jt=0,Ti=Te;if(k.content&&m){const vt=k.content,oi=vt[2]-vt[0],ui=vt[3]-vt[1];(k.textFitWidth||k.textFitHeight)&&(F=Sd(a)),Ae=Md(q,0,vt[0]),Oe=Md(W,0,vt[1]),Je=Md(q,vt[0],vt[2]),We=Md(W,vt[1],vt[3]),mt=vt[0]-Ae,Jt=vt[1]-Oe,Dt=oi-Je,Ti=ui-We}const Ft=F.x1,Zt=F.y1,di=F.x2-Ft,li=F.y2-Zt,ri=(vt,oi,ui,Mi)=>{const Tn=Pd(vt.stretch-Ae,Je,di,Ft),Yn=If(vt.fixed-mt,Dt,vt.stretch,se),hr=Pd(oi.stretch-Oe,We,li,Zt),ea=If(oi.fixed-Jt,Ti,oi.stretch,ue),Cr=Pd(ui.stretch-Ae,Je,di,Ft),dr=If(ui.fixed-mt,Dt,ui.stretch,se),ga=Pd(Mi.stretch-Oe,We,li,Zt),ya=If(Mi.fixed-Jt,Ti,Mi.stretch,ue),_a=new N(Tn,hr),Ls=new N(Cr,hr),fr=new N(Cr,ga),ta=new N(Tn,ga),Ar=new N(Yn/C,ea/C),tr=new N(dr/C,ya/C),Gs=n*Math.PI/180;if(Gs){const fn=Math.sin(Gs),Bn=Math.cos(Gs),cs=[Bn,-fn,fn,Bn];_a._matMult(cs),Ls._matMult(cs),ta._matMult(cs),fr._matMult(cs)}const eo=vt.stretch+vt.fixed,ja=oi.stretch+oi.fixed;return{tl:_a,tr:Ls,bl:ta,br:fr,tex:{x:k.paddedRect.x+Lh+eo,y:k.paddedRect.y+Lh+ja,w:ui.stretch+ui.fixed-eo,h:Mi.stretch+Mi.fixed-ja},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ar,pixelOffsetBR:tr,minFontScaleX:Dt/C/di,minFontScaleY:Ti/C/li,isSDF:c}};if(m&&(k.stretchX||k.stretchY)){const vt=um(q,de,se),oi=um(W,Te,ue);for(let ui=0;ui<vt.length-1;ui++){const Mi=vt[ui],Tn=vt[ui+1];for(let Yn=0;Yn<oi.length-1;Yn++)x.push(ri(Mi,oi[Yn],Tn,oi[Yn+1]))}}else x.push(ri({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:R+1}));return x}function Md(a,n,c){let m=0;for(const x of a)m+=Math.max(n,Math.min(c,x[1]))-Math.max(n,Math.min(c,x[0]));return m}function um(a,n,c){const m=[{fixed:-Lh,stretch:0}];for(const[x,k]of a){const C=m[m.length-1];m.push({fixed:x-C.stretch,stretch:C.stretch}),m.push({fixed:x-C.stretch,stretch:C.stretch+(k-x)})}return m.push({fixed:n+Lh,stretch:c}),m}function Pd(a,n,c,m){return a/n*c+m}function If(a,n,c,m){return a-n*c/m}class zh{constructor(n,c,m,x,k,C,I,R,F,q){var W;if(this.boxStartIndex=n.length,F){let ee=C.top,se=C.bottom;const ue=C.collisionPadding;ue&&(ee-=ue[1],se+=ue[3]);let de=se-ee;de>0&&(de=Math.max(10,de),this.circleDiameter=de)}else{const ee=!((W=C.image)===null||W===void 0)&&W.content&&(C.image.textFitWidth||C.image.textFitHeight)?Sd(C):{x1:C.left,y1:C.top,x2:C.right,y2:C.bottom};ee.y1=ee.y1*I-R[0],ee.y2=ee.y2*I+R[2],ee.x1=ee.x1*I-R[3],ee.x2=ee.x2*I+R[1];const se=C.collisionPadding;if(se&&(ee.x1-=se[0]*I,ee.y1-=se[1]*I,ee.x2+=se[2]*I,ee.y2+=se[3]*I),q){const ue=new N(ee.x1,ee.y1),de=new N(ee.x2,ee.y1),Te=new N(ee.x1,ee.y2),Ae=new N(ee.x2,ee.y2),Je=q*Math.PI/180;ue._rotate(Je),de._rotate(Je),Te._rotate(Je),Ae._rotate(Je),ee.x1=Math.min(ue.x,de.x,Te.x,Ae.x),ee.x2=Math.max(ue.x,de.x,Te.x,Ae.x),ee.y1=Math.min(ue.y,de.y,Te.y,Ae.y),ee.y2=Math.max(ue.y,de.y,Te.y,Ae.y)}n.emplaceBack(c.x,c.y,ee.x1,ee.y1,ee.x2,ee.y2,m,x,k)}this.boxEndIndex=n.length}}class Vg{constructor(n=[],c=((m,x)=>m<x?-1:m>x?1:0)){if(this.data=n,this.length=this.data.length,this.compare=c,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:c,compare:m}=this,x=c[n];for(;n>0;){const k=n-1>>1,C=c[k];if(m(x,C)>=0)break;c[n]=C,n=k}c[n]=x}_down(n){const{data:c,compare:m}=this,x=this.length>>1,k=c[n];for(;n<x;){let C=1+(n<<1);const I=C+1;if(I<this.length&&m(c[I],c[C])<0&&(C=I),m(c[C],k)>=0)break;c[n]=c[C],n=C}c[n]=k}}function qg(a,n=1,c=!1){let m=1/0,x=1/0,k=-1/0,C=-1/0;const I=a[0];for(let se=0;se<I.length;se++){const ue=I[se];(!se||ue.x<m)&&(m=ue.x),(!se||ue.y<x)&&(x=ue.y),(!se||ue.x>k)&&(k=ue.x),(!se||ue.y>C)&&(C=ue.y)}const R=Math.min(k-m,C-x);let F=R/2;const q=new Vg([],C_);if(R===0)return new N(m,x);for(let se=m;se<k;se+=R)for(let ue=x;ue<C;ue+=R)q.push(new uu(se+F,ue+F,F,a));let W=(function(se){let ue=0,de=0,Te=0;const Ae=se[0];for(let Je=0,Oe=Ae.length,We=Oe-1;Je<Oe;We=Je++){const mt=Ae[Je],Dt=Ae[We],Jt=mt.x*Dt.y-Dt.x*mt.y;de+=(mt.x+Dt.x)*Jt,Te+=(mt.y+Dt.y)*Jt,ue+=3*Jt}return new uu(de/ue,Te/ue,0,se)})(a),ee=q.length;for(;q.length;){const se=q.pop();(se.d>W.d||!W.d)&&(W=se,c&&console.log("found best %d after %d probes",Math.round(1e4*se.d)/1e4,ee)),se.max-W.d<=n||(F=se.h/2,q.push(new uu(se.p.x-F,se.p.y-F,F,a)),q.push(new uu(se.p.x+F,se.p.y-F,F,a)),q.push(new uu(se.p.x-F,se.p.y+F,F,a)),q.push(new uu(se.p.x+F,se.p.y+F,F,a)),ee+=4)}return c&&(console.log(`num probes: ${ee}`),console.log(`best distance: ${W.d}`)),W.p}function C_(a,n){return n.max-a.max}function uu(a,n,c,m){this.p=new N(a,n),this.h=c,this.d=(function(x,k){let C=!1,I=1/0;for(let R=0;R<k.length;R++){const F=k[R];for(let q=0,W=F.length,ee=W-1;q<W;ee=q++){const se=F[q],ue=F[ee];se.y>x.y!=ue.y>x.y&&x.x<(ue.x-se.x)*(x.y-se.y)/(ue.y-se.y)+se.x&&(C=!C),I=Math.min(I,Sp(x,se,ue))}}return(C?1:-1)*Math.sqrt(I)})(this.p,m),this.max=this.d+this.h*Math.SQRT2}var ur;y.aq=void 0,(ur=y.aq||(y.aq={}))[ur.center=1]="center",ur[ur.left=2]="left",ur[ur.right=3]="right",ur[ur.top=4]="top",ur[ur.bottom=5]="bottom",ur[ur["top-left"]=6]="top-left",ur[ur["top-right"]=7]="top-right",ur[ur["bottom-left"]=8]="bottom-left",ur[ur["bottom-right"]=9]="bottom-right";const hu=7,hm=Number.POSITIVE_INFINITY;function Rh(a,n){return n[1]!==hm?(function(c,m,x){let k=0,C=0;switch(m=Math.abs(m),x=Math.abs(x),c){case"top-right":case"top-left":case"top":C=x-hu;break;case"bottom-right":case"bottom-left":case"bottom":C=-x+hu}switch(c){case"top-right":case"bottom-right":case"right":k=-m;break;case"top-left":case"bottom-left":case"left":k=m}return[k,C]})(a,n[0],n[1]):(function(c,m){let x=0,k=0;m<0&&(m=0);const C=m/Math.SQRT2;switch(c){case"top-right":case"top-left":k=C-hu;break;case"bottom-right":case"bottom-left":k=-C+hu;break;case"bottom":k=-m+hu;break;case"top":k=m-hu}switch(c){case"top-right":case"bottom-right":x=-C;break;case"top-left":case"bottom-left":x=C;break;case"left":x=m;break;case"right":x=-m}return[x,k]})(a,n[0])}function Hg(a,n,c){var m;const x=a.layout,k=(m=x.get("text-variable-anchor-offset"))===null||m===void 0?void 0:m.evaluate(n,{},c);if(k){const I=k.values,R=[];for(let F=0;F<I.length;F+=2){const q=R[F]=I[F],W=I[F+1].map((ee=>ee*Zs));q.startsWith("top")?W[1]-=hu:q.startsWith("bottom")&&(W[1]+=hu),R[F+1]=W}return new sr(R)}const C=x.get("text-variable-anchor");if(C){let I;I=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[x.get("text-radial-offset").evaluate(n,{},c)*Zs,hm]:x.get("text-offset").evaluate(n,{},c).map((F=>F*Zs));const R=[];for(const F of C)R.push(F,Rh(F,I));return new sr(R)}return null}function Lf(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function kn(a,n,c,m,x,k,C,I,R,F,q){let W=k.textMaxSize.evaluate(n,{});W===void 0&&(W=C);const ee=a.layers[0].layout,se=ee.get("icon-offset").evaluate(n,{},q),ue=jd(c.horizontal),de=C/24,Te=a.tilePixelRatio*de,Ae=a.tilePixelRatio*W/24,Je=a.tilePixelRatio*I,Oe=a.tilePixelRatio*ee.get("symbol-spacing"),We=ee.get("text-padding")*a.tilePixelRatio,mt=(function(vt,oi,ui,Mi=1){const Tn=vt.get("icon-padding").evaluate(oi,{},ui),Yn=Tn&&Tn.values;return[Yn[0]*Mi,Yn[1]*Mi,Yn[2]*Mi,Yn[3]*Mi]})(ee,n,q,a.tilePixelRatio),Dt=ee.get("text-max-angle")/180*Math.PI,Jt=ee.get("text-rotation-alignment")!=="viewport"&&ee.get("symbol-placement")!=="point",Ti=ee.get("icon-rotation-alignment")==="map"&&ee.get("symbol-placement")!=="point",Ft=ee.get("symbol-placement"),Zt=Oe/2,di=ee.get("icon-text-fit");let li;m&&di!=="none"&&(a.allowVerticalPlacement&&c.vertical&&(li=wc(m,c.vertical,di,ee.get("icon-text-fit-padding"),se,de)),ue&&(m=wc(m,ue,di,ee.get("icon-text-fit-padding"),se,de)));const ri=(vt,oi)=>{oi.x<0||oi.x>=Os||oi.y<0||oi.y>=Os||(function(ui,Mi,Tn,Yn,hr,ea,Cr,dr,ga,ya,_a,Ls,fr,ta,Ar,tr,Gs,eo,ja,fn,Bn,cs,ia,ms,du){const So=ui.addToLineVertexArray(Mi,Tn);let kl,To,Eo,pr,Sc=0,qu=0,Gg=0,Od=0,Oh=-1,Nh=-1;const Tc={};let Bh=Gc("");if(ui.allowVerticalPlacement&&Yn.vertical){const Nr=dr.layout.get("text-rotate").evaluate(Bn,{},ms)+90;Eo=new zh(ga,Mi,ya,_a,Ls,Yn.vertical,fr,ta,Ar,Nr),Cr&&(pr=new zh(ga,Mi,ya,_a,Ls,Cr,Gs,eo,Ar,Nr))}if(hr){const Nr=dr.layout.get("icon-rotate").evaluate(Bn,{}),Ia=dr.layout.get("icon-text-fit")!=="none",to=cm(hr,Nr,ia,Ia),Br=Cr?cm(Cr,Nr,ia,Ia):void 0;To=new zh(ga,Mi,ya,_a,Ls,hr,Gs,eo,!1,Nr),Sc=4*to.length;const io=ui.iconSizeData;let no=null;io.kind==="source"?(no=[Qr*dr.layout.get("icon-size").evaluate(Bn,{})],no[0]>bo&&Mt(`${ui.layerIds[0]}: Value for "icon-size" is >= ${Bs}. Reduce your "icon-size".`)):io.kind==="composite"&&(no=[Qr*cs.compositeIconSizes[0].evaluate(Bn,{},ms),Qr*cs.compositeIconSizes[1].evaluate(Bn,{},ms)],(no[0]>bo||no[1]>bo)&&Mt(`${ui.layerIds[0]}: Value for "icon-size" is >= ${Bs}. Reduce your "icon-size".`)),ui.addSymbols(ui.icon,to,no,fn,ja,Bn,y.ah.none,Mi,So.lineStartIndex,So.lineLength,-1,ms),Oh=ui.icon.placedSymbolArray.length-1,Br&&(qu=4*Br.length,ui.addSymbols(ui.icon,Br,no,fn,ja,Bn,y.ah.vertical,Mi,So.lineStartIndex,So.lineLength,-1,ms),Nh=ui.icon.placedSymbolArray.length-1)}const Wg=Object.keys(Yn.horizontal);for(const Nr of Wg){const Ia=Yn.horizontal[Nr];if(!kl){Bh=Gc(Ia.text);const Br=dr.layout.get("text-rotate").evaluate(Bn,{},ms);kl=new zh(ga,Mi,ya,_a,Ls,Ia,fr,ta,Ar,Br)}const to=Ia.positionedLines.length===1;if(Gg+=zf(ui,Mi,Ia,ea,dr,Ar,Bn,tr,So,Yn.vertical?y.ah.horizontal:y.ah.horizontalOnly,to?Wg:[Nr],Tc,Oh,cs,ms),to)break}Yn.vertical&&(Od+=zf(ui,Mi,Yn.vertical,ea,dr,Ar,Bn,tr,So,y.ah.vertical,["vertical"],Tc,Nh,cs,ms));const Yg=kl?kl.boxStartIndex:ui.collisionBoxArray.length,Xg=kl?kl.boxEndIndex:ui.collisionBoxArray.length,Kg=Eo?Eo.boxStartIndex:ui.collisionBoxArray.length,Jg=Eo?Eo.boxEndIndex:ui.collisionBoxArray.length,mm=To?To.boxStartIndex:ui.collisionBoxArray.length,Qg=To?To.boxEndIndex:ui.collisionBoxArray.length,ey=pr?pr.boxStartIndex:ui.collisionBoxArray.length,Df=pr?pr.boxEndIndex:ui.collisionBoxArray.length;let Cl=-1;const Of=(Nr,Ia)=>Nr&&Nr.circleDiameter?Math.max(Nr.circleDiameter,Ia):Ia;Cl=Of(kl,Cl),Cl=Of(Eo,Cl),Cl=Of(To,Cl),Cl=Of(pr,Cl);const Nf=Cl>-1?1:0;Nf&&(Cl*=du/Zs),ui.glyphOffsetArray.length>=Bu.MAX_GLYPHS&&Mt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bn.sortKey!==void 0&&ui.addToSortKeyRanges(ui.symbolInstances.length,Bn.sortKey);const gm=Hg(dr,Bn,ms),[Bf,ym]=(function(Nr,Ia){const to=Nr.length,Br=Ia?.values;if(Br?.length>0)for(let io=0;io<Br.length;io+=2){const no=Br[io+1];Nr.emplaceBack(y.aq[Br[io]],no[0],no[1])}return[to,Nr.length]})(ui.textAnchorOffsets,gm);ui.symbolInstances.emplaceBack(Mi.x,Mi.y,Tc.right>=0?Tc.right:-1,Tc.center>=0?Tc.center:-1,Tc.left>=0?Tc.left:-1,Tc.vertical||-1,Oh,Nh,Bh,Yg,Xg,Kg,Jg,mm,Qg,ey,Df,ya,Gg,Od,Sc,qu,Nf,0,fr,Cl,Bf,ym)})(a,oi,vt,c,m,x,li,a.layers[0],a.collisionBoxArray,n.index,n.sourceLayerIndex,a.index,Te,[We,We,We,We],Jt,R,Je,mt,Ti,se,n,k,F,q,C)};if(Ft==="line")for(const vt of Fg(n.geometry,0,0,Os,Os)){const oi=Jl(vt,Oe,Dt,c.vertical||ue,m,24,Ae,a.overscaling,Os);for(const ui of oi)ue&&dm(a,ue.text,Zt,ui)||ri(vt,ui)}else if(Ft==="line-center"){for(const vt of n.geometry)if(vt.length>1){const oi=cu(vt,Dt,c.vertical||ue,m,24,Ae);oi&&ri(vt,oi)}}else if(n.type==="Polygon")for(const vt of ic(n.geometry,0)){const oi=qg(vt,16);ri(vt[0],new El(oi.x,oi.y,0))}else if(n.type==="LineString")for(const vt of n.geometry)ri(vt,new El(vt[0].x,vt[0].y,0));else if(n.type==="Point")for(const vt of n.geometry)for(const oi of vt)ri([oi],new El(oi.x,oi.y,0))}function zf(a,n,c,m,x,k,C,I,R,F,q,W,ee,se,ue){const de=(function(Je,Oe,We,mt,Dt,Jt,Ti,Ft){const Zt=mt.layout.get("text-rotate").evaluate(Jt,{})*Math.PI/180,di=[];for(const li of Oe.positionedLines)for(const ri of li.positionedGlyphs){if(!ri.rect)continue;const vt=ri.rect||{};let oi=Vn+1,ui=!0,Mi=1,Tn=0;const Yn=(Dt||Ft)&&ri.vertical,hr=ri.metrics.advance*ri.scale/2;if(Ft&&Oe.verticalizable&&(Tn=li.lineOffset/2-(ri.imageName?-(Zs-ri.metrics.width*ri.scale)/2:(ri.scale-1)*Zs)),ri.imageName){const fn=Ti[ri.imageName];ui=fn.sdf,Mi=fn.pixelRatio,oi=Di/Mi}const ea=Dt?[ri.x+hr,ri.y]:[0,0];let Cr=Dt?[0,0]:[ri.x+hr+We[0],ri.y+We[1]-Tn],dr=[0,0];Yn&&(dr=Cr,Cr=[0,0]);const ga=ri.metrics.isDoubleResolution?2:1,ya=(ri.metrics.left-oi)*ri.scale-hr+Cr[0],_a=(-ri.metrics.top-oi)*ri.scale+Cr[1],Ls=ya+vt.w/ga*ri.scale/Mi,fr=_a+vt.h/ga*ri.scale/Mi,ta=new N(ya,_a),Ar=new N(Ls,_a),tr=new N(ya,fr),Gs=new N(Ls,fr);if(Yn){const fn=new N(-hr,hr-Vo),Bn=-Math.PI/2,cs=Zs/2-hr,ia=new N(5-Vo-cs,-(ri.imageName?cs:0)),ms=new N(...dr);ta._rotateAround(Bn,fn)._add(ia)._add(ms),Ar._rotateAround(Bn,fn)._add(ia)._add(ms),tr._rotateAround(Bn,fn)._add(ia)._add(ms),Gs._rotateAround(Bn,fn)._add(ia)._add(ms)}if(Zt){const fn=Math.sin(Zt),Bn=Math.cos(Zt),cs=[Bn,-fn,fn,Bn];ta._matMult(cs),Ar._matMult(cs),tr._matMult(cs),Gs._matMult(cs)}const eo=new N(0,0),ja=new N(0,0);di.push({tl:ta,tr:Ar,bl:tr,br:Gs,tex:vt,writingMode:Oe.writingMode,glyphOffset:ea,sectionIndex:ri.sectionIndex,isSDF:ui,pixelOffsetTL:eo,pixelOffsetBR:ja,minFontScaleX:0,minFontScaleY:0})}return di})(0,c,I,x,k,C,m,a.allowVerticalPlacement),Te=a.textSizeData;let Ae=null;Te.kind==="source"?(Ae=[Qr*x.layout.get("text-size").evaluate(C,{})],Ae[0]>bo&&Mt(`${a.layerIds[0]}: Value for "text-size" is >= ${Bs}. Reduce your "text-size".`)):Te.kind==="composite"&&(Ae=[Qr*se.compositeTextSizes[0].evaluate(C,{},ue),Qr*se.compositeTextSizes[1].evaluate(C,{},ue)],(Ae[0]>bo||Ae[1]>bo)&&Mt(`${a.layerIds[0]}: Value for "text-size" is >= ${Bs}. Reduce your "text-size".`)),a.addSymbols(a.text,de,Ae,I,k,C,F,n,R.lineStartIndex,R.lineLength,ee,ue);for(const Je of q)W[Je]=a.text.placedSymbolArray.length-1;return 4*de.length}function jd(a){for(const n in a)return a[n];return null}function dm(a,n,c,m){const x=a.compareText;if(n in x){const k=x[n];for(let C=k.length-1;C>=0;C--)if(m.dist(k[C])<c)return!0}else x[n]=[];return x[n].push(m),!1}const fm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Id{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,m]=new Uint8Array(n,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const x=m>>4;if(x!==1)throw new Error(`Got v${x} data when expected v1.`);const k=fm[15&m];if(!k)throw new Error("Unrecognized array type.");const[C]=new Uint16Array(n,2,1),[I]=new Uint32Array(n,4,1);return new Id(I,C,k,n)}constructor(n,c=64,m=Float64Array,x){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=m,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const k=fm.indexOf(this.ArrayType),C=2*n*this.ArrayType.BYTES_PER_ELEMENT,I=n*this.IndexArrayType.BYTES_PER_ELEMENT,R=(8-I%8)%8;if(k<0)throw new Error(`Unexpected typed array class: ${m}.`);x&&x instanceof ArrayBuffer?(this.data=x,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+I+R,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+C+I+R),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+I+R,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+k]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=n)}add(n,c){const m=this._pos>>1;return this.ids[m]=m,this.coords[this._pos++]=n,this.coords[this._pos++]=c,m}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Vu(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,c,m,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:k,coords:C,nodeSize:I}=this,R=[0,k.length-1,0],F=[];for(;R.length;){const q=R.pop()||0,W=R.pop()||0,ee=R.pop()||0;if(W-ee<=I){for(let Te=ee;Te<=W;Te++){const Ae=C[2*Te],Je=C[2*Te+1];Ae>=n&&Ae<=m&&Je>=c&&Je<=x&&F.push(k[Te])}continue}const se=ee+W>>1,ue=C[2*se],de=C[2*se+1];ue>=n&&ue<=m&&de>=c&&de<=x&&F.push(k[se]),(q===0?n<=ue:c<=de)&&(R.push(ee),R.push(se-1),R.push(1-q)),(q===0?m>=ue:x>=de)&&(R.push(se+1),R.push(W),R.push(1-q))}return F}within(n,c,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:k,nodeSize:C}=this,I=[0,x.length-1,0],R=[],F=m*m;for(;I.length;){const q=I.pop()||0,W=I.pop()||0,ee=I.pop()||0;if(W-ee<=C){for(let Te=ee;Te<=W;Te++)Zg(k[2*Te],k[2*Te+1],n,c)<=F&&R.push(x[Te]);continue}const se=ee+W>>1,ue=k[2*se],de=k[2*se+1];Zg(ue,de,n,c)<=F&&R.push(x[se]),(q===0?n-m<=ue:c-m<=de)&&(I.push(ee),I.push(se-1),I.push(1-q)),(q===0?n+m>=ue:c+m>=de)&&(I.push(se+1),I.push(W),I.push(1-q))}return R}}function Vu(a,n,c,m,x,k){if(x-m<=c)return;const C=m+x>>1;Ld(a,n,C,m,x,k),Vu(a,n,c,m,C-1,1-k),Vu(a,n,c,C+1,x,1-k)}function Ld(a,n,c,m,x,k){for(;x>m;){if(x-m>600){const F=x-m+1,q=c-m+1,W=Math.log(F),ee=.5*Math.exp(2*W/3),se=.5*Math.sqrt(W*ee*(F-ee)/F)*(q-F/2<0?-1:1);Ld(a,n,c,Math.max(m,Math.floor(c-q*ee/F+se)),Math.min(x,Math.floor(c+(F-q)*ee/F+se)),k)}const C=n[2*c+k];let I=m,R=x;for(zd(a,n,m,c),n[2*x+k]>C&&zd(a,n,m,x);I<R;){for(zd(a,n,I,R),I++,R--;n[2*I+k]<C;)I++;for(;n[2*R+k]>C;)R--}n[2*m+k]===C?zd(a,n,m,R):(R++,zd(a,n,R,x)),R<=c&&(m=R+1),c<=R&&(x=R-1)}}function zd(a,n,c,m){Rf(a,c,m),Rf(n,2*c,2*m),Rf(n,2*c+1,2*m+1)}function Rf(a,n,c){const m=a[n];a[n]=a[c],a[c]=m}function Zg(a,n,c,m){const x=a-c,k=n-m;return x*x+k*k}var pm;y.bg=void 0,(pm=y.bg||(y.bg={})).create="create",pm.load="load",pm.fullLoad="fullLoad";let Rd=null,Dh=[];const Qn=1e3/60,Dd="loadTime",kr="fullLoadTime",A_={mark(a){performance.mark(a)},frame(a){const n=a;Rd!=null&&Dh.push(n-Rd),Rd=n},clearMetrics(){Rd=null,Dh=[],performance.clearMeasures(Dd),performance.clearMeasures(kr);for(const a in y.bg)performance.clearMarks(y.bg[a])},getPerformanceMetrics(){performance.measure(Dd,y.bg.create,y.bg.load),performance.measure(kr,y.bg.create,y.bg.fullLoad);const a=performance.getEntriesByName(Dd)[0].duration,n=performance.getEntriesByName(kr)[0].duration,c=Dh.length,m=1/(Dh.reduce(((k,C)=>k+C),0)/c/1e3),x=Dh.filter((k=>k>Qn)).reduce(((k,C)=>k+(C-Qn)/Qn),0);return{loadTime:a,fullLoadTime:n,fps:m,percentDroppedFrames:x/(c+x)*100,totalFrames:c}}};y.$=class extends X{},y.A=tu,y.B=nn,y.C=function(a){if(Be==null){const n=a.navigator?a.navigator.userAgent:null;Be=!!a.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Be},y.D=ci,y.E=$n,y.F=class{constructor(a,n){this.target=a,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new E_((()=>this.process())),this.subscription=(function(c,m,x,k){return c.addEventListener(m,x,!1),{unsubscribe:()=>{c.removeEventListener(m,x,!1)}}})(this.target,"message",(c=>this.receive(c))),this.globalScope=Tt(self)?a:window}registerMessageHandler(a,n){this.messageHandlers[a]=n}sendAsync(a,n){return new Promise(((c,m)=>{const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[x]={resolve:c,reject:m},n&&n.signal.addEventListener("abort",(()=>{delete this.resolveRejects[x];const I={id:x,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(I)}),{once:!0});const k=[],C=Object.assign(Object.assign({},a),{id:x,sourceMapId:this.mapId,origin:location.origin,data:Xr(a.data,k)});this.target.postMessage(C,{transfer:k})}))}receive(a){const n=a.data,c=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[c];const m=this.abortControllers[c];return delete this.abortControllers[c],void(m&&m.abort())}if(Tt(self)||n.mustQueue)return this.tasks[c]=n,this.taskQueue.push(c),void this.invoker.trigger();this.processTask(c,n)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),n=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(a,n)}processTask(a,n){return d(this,void 0,void 0,(function*(){if(n.type==="<response>"){const x=this.resolveRejects[a];return delete this.resolveRejects[a],x?void(n.error?x.reject(No(n.error)):x.resolve(No(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const c=No(n.data),m=new AbortController;this.abortControllers[a]=m;try{const x=yield this.messageHandlers[n.type](n.sourceMapId,c,m);this.completeTask(a,null,x)}catch(x){this.completeTask(a,x)}}))}completeTask(a,n,c){const m=[];delete this.abortControllers[a];const x={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?Xr(n):null,data:Xr(c,m)};this.target.postMessage(x,{transfer:m})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.G=Pt,y.H=function(){var a=new tu(16);return tu!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},y.I=Sn,y.J=function(a,n,c){var m,x,k,C,I,R,F,q,W,ee,se,ue,de=c[0],Te=c[1],Ae=c[2];return n===a?(a[12]=n[0]*de+n[4]*Te+n[8]*Ae+n[12],a[13]=n[1]*de+n[5]*Te+n[9]*Ae+n[13],a[14]=n[2]*de+n[6]*Te+n[10]*Ae+n[14],a[15]=n[3]*de+n[7]*Te+n[11]*Ae+n[15]):(x=n[1],k=n[2],C=n[3],I=n[4],R=n[5],F=n[6],q=n[7],W=n[8],ee=n[9],se=n[10],ue=n[11],a[0]=m=n[0],a[1]=x,a[2]=k,a[3]=C,a[4]=I,a[5]=R,a[6]=F,a[7]=q,a[8]=W,a[9]=ee,a[10]=se,a[11]=ue,a[12]=m*de+I*Te+W*Ae+n[12],a[13]=x*de+R*Te+ee*Ae+n[13],a[14]=k*de+F*Te+se*Ae+n[14],a[15]=C*de+q*Te+ue*Ae+n[15]),a},y.K=function(a,n,c){var m=c[0],x=c[1],k=c[2];return a[0]=n[0]*m,a[1]=n[1]*m,a[2]=n[2]*m,a[3]=n[3]*m,a[4]=n[4]*x,a[5]=n[5]*x,a[6]=n[6]*x,a[7]=n[7]*x,a[8]=n[8]*k,a[9]=n[9]*k,a[10]=n[10]*k,a[11]=n[11]*k,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},y.L=kp,y.M=function(a,n){const c={};for(let m=0;m<n.length;m++){const x=n[m];x in a&&(c[x]=a[x])}return c},y.N=lu,y.O=Uu,y.P=N,y.Q=Cd,y.R=Xa,y.S=ma,y.T=ch,y.U=re,y.V=ge,y.W=Et,y.X=Os,y.Y=z,y.Z=Ph,y._=d,y.a=rt,y.a$=function(a,n){var c=a[0],m=a[1],x=a[2],k=a[3],C=a[4],I=a[5],R=a[6],F=a[7],q=a[8],W=a[9],ee=a[10],se=a[11],ue=a[12],de=a[13],Te=a[14],Ae=a[15],Je=n[0],Oe=n[1],We=n[2],mt=n[3],Dt=n[4],Jt=n[5],Ti=n[6],Ft=n[7],Zt=n[8],di=n[9],li=n[10],ri=n[11],vt=n[12],oi=n[13],ui=n[14],Mi=n[15];return Math.abs(c-Je)<=Jr*Math.max(1,Math.abs(c),Math.abs(Je))&&Math.abs(m-Oe)<=Jr*Math.max(1,Math.abs(m),Math.abs(Oe))&&Math.abs(x-We)<=Jr*Math.max(1,Math.abs(x),Math.abs(We))&&Math.abs(k-mt)<=Jr*Math.max(1,Math.abs(k),Math.abs(mt))&&Math.abs(C-Dt)<=Jr*Math.max(1,Math.abs(C),Math.abs(Dt))&&Math.abs(I-Jt)<=Jr*Math.max(1,Math.abs(I),Math.abs(Jt))&&Math.abs(R-Ti)<=Jr*Math.max(1,Math.abs(R),Math.abs(Ti))&&Math.abs(F-Ft)<=Jr*Math.max(1,Math.abs(F),Math.abs(Ft))&&Math.abs(q-Zt)<=Jr*Math.max(1,Math.abs(q),Math.abs(Zt))&&Math.abs(W-di)<=Jr*Math.max(1,Math.abs(W),Math.abs(di))&&Math.abs(ee-li)<=Jr*Math.max(1,Math.abs(ee),Math.abs(li))&&Math.abs(se-ri)<=Jr*Math.max(1,Math.abs(se),Math.abs(ri))&&Math.abs(ue-vt)<=Jr*Math.max(1,Math.abs(ue),Math.abs(vt))&&Math.abs(de-oi)<=Jr*Math.max(1,Math.abs(de),Math.abs(oi))&&Math.abs(Te-ui)<=Jr*Math.max(1,Math.abs(Te),Math.abs(ui))&&Math.abs(Ae-Mi)<=Jr*Math.max(1,Math.abs(Ae),Math.abs(Mi))},y.a0=Qi,y.a1=Af,y.a2=kt,y.a3=a=>{const n=window.document.createElement("video");return n.muted=!0,new Promise((c=>{n.onloadstart=()=>{c(n)};for(const m of a){const x=window.document.createElement("source");Vi(m)||(n.crossOrigin="Anonymous"),x.src=m,n.appendChild(x)}}))},y.a4=function(){return Ue++},y.a5=Yt,y.a6=Bu,y.a7=fl,y.a8=Qc,y.a9=Mf,y.aA=function(a){if(a.type==="custom")return new em(a);switch(a.type){case"background":return new Ng(a);case"circle":return new __(a);case"fill":return new vg(a);case"fill-extrusion":return new pd(a);case"heatmap":return new pf(a);case"hillshade":return new cd(a);case"line":return new Ag(a);case"raster":return new kf(a);case"symbol":return new Mh(a)}},y.aB=lt,y.aC=function(a,n){if(!a)return[{command:"setStyle",args:[n]}];let c=[];try{if(!Si(a.version,n.version))return[{command:"setStyle",args:[n]}];Si(a.center,n.center)||c.push({command:"setCenter",args:[n.center]}),Si(a.zoom,n.zoom)||c.push({command:"setZoom",args:[n.zoom]}),Si(a.bearing,n.bearing)||c.push({command:"setBearing",args:[n.bearing]}),Si(a.pitch,n.pitch)||c.push({command:"setPitch",args:[n.pitch]}),Si(a.sprite,n.sprite)||c.push({command:"setSprite",args:[n.sprite]}),Si(a.glyphs,n.glyphs)||c.push({command:"setGlyphs",args:[n.glyphs]}),Si(a.transition,n.transition)||c.push({command:"setTransition",args:[n.transition]}),Si(a.light,n.light)||c.push({command:"setLight",args:[n.light]}),Si(a.terrain,n.terrain)||c.push({command:"setTerrain",args:[n.terrain]}),Si(a.sky,n.sky)||c.push({command:"setSky",args:[n.sky]}),Si(a.projection,n.projection)||c.push({command:"setProjection",args:[n.projection]});const m={},x=[];(function(C,I,R,F){let q;for(q in I=I||{},C=C||{})Object.prototype.hasOwnProperty.call(C,q)&&(Object.prototype.hasOwnProperty.call(I,q)||Rn(q,R,F));for(q in I)Object.prototype.hasOwnProperty.call(I,q)&&(Object.prototype.hasOwnProperty.call(C,q)?Si(C[q],I[q])||(C[q].type==="geojson"&&I[q].type==="geojson"&&sn(C,I,q)?mi(R,{command:"setGeoJSONSourceData",args:[q,I[q].data]}):is(q,I,R,F)):En(q,I,R))})(a.sources,n.sources,x,m);const k=[];a.layers&&a.layers.forEach((C=>{"source"in C&&m[C.source]?c.push({command:"removeLayer",args:[C.id]}):k.push(C)})),c=c.concat(x),(function(C,I,R){I=I||[];const F=(C=C||[]).map(Gi),q=I.map(Gi),W=C.reduce(ns,{}),ee=I.reduce(ns,{}),se=F.slice(),ue=Object.create(null);let de,Te,Ae,Je,Oe;for(let We=0,mt=0;We<F.length;We++)de=F[We],Object.prototype.hasOwnProperty.call(ee,de)?mt++:(mi(R,{command:"removeLayer",args:[de]}),se.splice(se.indexOf(de,mt),1));for(let We=0,mt=0;We<q.length;We++)de=q[q.length-1-We],se[se.length-1-We]!==de&&(Object.prototype.hasOwnProperty.call(W,de)?(mi(R,{command:"removeLayer",args:[de]}),se.splice(se.lastIndexOf(de,se.length-mt),1)):mt++,Je=se[se.length-We],mi(R,{command:"addLayer",args:[ee[de],Je]}),se.splice(se.length-We,0,de),ue[de]=!0);for(let We=0;We<q.length;We++)if(de=q[We],Te=W[de],Ae=ee[de],!ue[de]&&!Si(Te,Ae))if(Si(Te.source,Ae.source)&&Si(Te["source-layer"],Ae["source-layer"])&&Si(Te.type,Ae.type)){for(Oe in Xi(Te.layout,Ae.layout,R,de,null,"setLayoutProperty"),Xi(Te.paint,Ae.paint,R,de,null,"setPaintProperty"),Si(Te.filter,Ae.filter)||mi(R,{command:"setFilter",args:[de,Ae.filter]}),Si(Te.minzoom,Ae.minzoom)&&Si(Te.maxzoom,Ae.maxzoom)||mi(R,{command:"setLayerZoomRange",args:[de,Ae.minzoom,Ae.maxzoom]}),Te)Object.prototype.hasOwnProperty.call(Te,Oe)&&Oe!=="layout"&&Oe!=="paint"&&Oe!=="filter"&&Oe!=="metadata"&&Oe!=="minzoom"&&Oe!=="maxzoom"&&(Oe.indexOf("paint.")===0?Xi(Te[Oe],Ae[Oe],R,de,Oe.slice(6),"setPaintProperty"):Si(Te[Oe],Ae[Oe])||mi(R,{command:"setLayerProperty",args:[de,Oe,Ae[Oe]]}));for(Oe in Ae)Object.prototype.hasOwnProperty.call(Ae,Oe)&&!Object.prototype.hasOwnProperty.call(Te,Oe)&&Oe!=="layout"&&Oe!=="paint"&&Oe!=="filter"&&Oe!=="metadata"&&Oe!=="minzoom"&&Oe!=="maxzoom"&&(Oe.indexOf("paint.")===0?Xi(Te[Oe],Ae[Oe],R,de,Oe.slice(6),"setPaintProperty"):Si(Te[Oe],Ae[Oe])||mi(R,{command:"setLayerProperty",args:[de,Oe,Ae[Oe]]}))}else mi(R,{command:"removeLayer",args:[de]}),Je=se[se.lastIndexOf(de)+1],mi(R,{command:"addLayer",args:[Ae,Je]})})(k,n.layers,c)}catch(m){console.warn("Unable to compute style diff:",m),c=[{command:"setStyle",args:[n]}]}return c},y.aD=function(a){const n=[],c=a.id;return c===void 0&&n.push({message:`layers.${c}: missing required property "id"`}),a.render===void 0&&n.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&n.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),n},y.aE=function a(n,c){if(Array.isArray(n)){if(!Array.isArray(c)||n.length!==c.length)return!1;for(let m=0;m<n.length;m++)if(!a(n[m],c[m]))return!1;return!0}if(typeof n=="object"&&n!==null&&c!==null){if(typeof c!="object"||Object.keys(n).length!==Object.keys(c).length)return!1;for(const m in n)if(!a(n[m],c[m]))return!1;return!0}return n===c},y.aF=Fe,y.aG=He,y.aH=class extends Vl{constructor(a,n){super(a,n),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},y.aI=Yc,y.aJ=class extends Vl{constructor(a,n){super(a,n),this.current=pc}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let n=1;n<16;n++)if(a[n]!==this.current[n]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},y.aK=nd,y.aL=of,y.aM=vi,y.aN=class extends Vl{constructor(a,n){super(a,n),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},y.aO=class extends Vl{constructor(a,n){super(a,n),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},y.aP=function(a,n,c,m,x,k,C){var I=1/(n-c),R=1/(m-x),F=1/(k-C);return a[0]=-2*I,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*R,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*F,a[11]=0,a[12]=(n+c)*I,a[13]=(x+m)*R,a[14]=(C+k)*F,a[15]=1,a},y.aQ=cg,y.aR=class extends $e{},y.aS=Ka,y.aT=class extends nt{},y.aU=ld,y.aV=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},y.aW=fh,y.aX=as,y.aY=fa,y.aZ=class extends ai{},y.a_=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]&&a[4]===n[4]&&a[5]===n[5]&&a[6]===n[6]&&a[7]===n[7]&&a[8]===n[8]&&a[9]===n[9]&&a[10]===n[10]&&a[11]===n[11]&&a[12]===n[12]&&a[13]===n[13]&&a[14]===n[14]&&a[15]===n[15]},y.aa=function(a){const n={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((c,m,x,k)=>{const C=x||k;return n[m]=!C||C.toLowerCase(),""})),n["max-age"]){const c=parseInt(n["max-age"],10);isNaN(c)?delete n["max-age"]:n["max-age"]=c}return n},y.ab=function(a,n){const c=[];for(const m in a)m in n||c.push(m);return c},y.ac=be,y.ad=function(a,n,c){var m=Math.sin(c),x=Math.cos(c),k=n[0],C=n[1],I=n[2],R=n[3],F=n[4],q=n[5],W=n[6],ee=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=k*x+F*m,a[1]=C*x+q*m,a[2]=I*x+W*m,a[3]=R*x+ee*m,a[4]=F*x-k*m,a[5]=q*x-C*m,a[6]=W*x-I*m,a[7]=ee*x-R*m,a},y.ae=function(a){var n=new tu(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n},y.af=ad,y.ag=function(a,n){let c=0,m=0;if(a.kind==="constant")m=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:x,minZoom:k,maxZoom:C}=a,I=x?be(Ds.interpolationFactor(x,n,k,C),0,1):0;a.kind==="camera"?m=Fs.number(a.minSize,a.maxSize,I):c=I}return{uSizeT:c,uSize:m}},y.ai=function(a,{uSize:n,uSizeT:c},{lowerSize:m,upperSize:x}){return a.kind==="source"?m/Qr:a.kind==="composite"?Fs.number(m/Qr,x/Qr,c):n},y.aj=Ed,y.ak=function(a,n,c,m){const x=n.y-a.y,k=n.x-a.x,C=m.y-c.y,I=m.x-c.x,R=C*k-I*x;if(R===0)return null;const F=(I*(a.y-c.y)-C*(a.x-c.x))/R;return new N(a.x+F*k,a.y+F*x)},y.al=Fg,y.am=xp,y.an=hf,y.ao=function(a){let n=1/0,c=1/0,m=-1/0,x=-1/0;for(const k of a)n=Math.min(n,k.x),c=Math.min(c,k.y),m=Math.max(m,k.x),x=Math.max(x,k.y);return[n,c,m,x]},y.ap=Zs,y.ar=Td,y.as=function(a,n){var c=n[0],m=n[1],x=n[2],k=n[3],C=n[4],I=n[5],R=n[6],F=n[7],q=n[8],W=n[9],ee=n[10],se=n[11],ue=n[12],de=n[13],Te=n[14],Ae=n[15],Je=c*I-m*C,Oe=c*R-x*C,We=c*F-k*C,mt=m*R-x*I,Dt=m*F-k*I,Jt=x*F-k*R,Ti=q*de-W*ue,Ft=q*Te-ee*ue,Zt=q*Ae-se*ue,di=W*Te-ee*de,li=W*Ae-se*de,ri=ee*Ae-se*Te,vt=Je*ri-Oe*li+We*di+mt*Zt-Dt*Ft+Jt*Ti;return vt?(a[0]=(I*ri-R*li+F*di)*(vt=1/vt),a[1]=(x*li-m*ri-k*di)*vt,a[2]=(de*Jt-Te*Dt+Ae*mt)*vt,a[3]=(ee*Dt-W*Jt-se*mt)*vt,a[4]=(R*Zt-C*ri-F*Ft)*vt,a[5]=(c*ri-x*Zt+k*Ft)*vt,a[6]=(Te*We-ue*Jt-Ae*Oe)*vt,a[7]=(q*Jt-ee*We+se*Oe)*vt,a[8]=(C*li-I*Zt+F*Ti)*vt,a[9]=(m*Zt-c*li-k*Ti)*vt,a[10]=(ue*Dt-de*We+Ae*Je)*vt,a[11]=(W*We-q*Dt-se*Je)*vt,a[12]=(I*Ft-C*di-R*Ti)*vt,a[13]=(c*di-m*Ft+x*Ti)*vt,a[14]=(de*Oe-ue*mt-Te*Je)*vt,a[15]=(q*mt-W*Oe+ee*Je)*vt,a):null},y.at=Lf,y.au=Ah,y.av=Id,y.aw=function(){const a={},n=it.$version;for(const c in it.$root){const m=it.$root[c];if(m.required){let x=null;x=c==="version"?n:m.type==="array"?[]:{},x!=null&&(a[c]=x)}}return a},y.ax=ps,y.ay=ei,y.az=function(a){a=a.slice();const n=Object.create(null);for(let c=0;c<a.length;c++)n[a[c].id]=a[c];for(let c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=Mn(a[c],n[a[c].ref]));return a},y.b=ct,y.b0=function(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},y.b1=function(a,n,c){return a[0]=n[0]*c[0],a[1]=n[1]*c[1],a[2]=n[2]*c[2],a[3]=n[3]*c[3],a},y.b2=function(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]},y.b3=ke,y.b4=am,y.b5=sm,y.b6=function(a,n,c,m,x){var k,C=1/Math.tan(n/2);return a[0]=C/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=C,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,x!=null&&x!==1/0?(a[10]=(x+m)*(k=1/(m-x)),a[14]=2*x*m*k):(a[10]=-1,a[14]=-2*m),a},y.b7=function(a,n,c){var m=Math.sin(c),x=Math.cos(c),k=n[4],C=n[5],I=n[6],R=n[7],F=n[8],q=n[9],W=n[10],ee=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=k*x+F*m,a[5]=C*x+q*m,a[6]=I*x+W*m,a[7]=R*x+ee*m,a[8]=F*x-k*m,a[9]=q*x-C*m,a[10]=W*x-I*m,a[11]=ee*x-R*m,a},y.b8=le,y.b9=me,y.bA=Gp,y.bB=function(a){return a.message===Le},y.bC=hl,y.bD=Qs,y.ba=function(a){return a*Math.PI/180},y.bb=function(a,n){const{x:c,y:m}=Ph.fromLngLat(n);return!(a<0||a>25||m<0||m>=1||c<0||c>=1)},y.bc=function(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},y.bd=class extends H{},y.be=tm,y.bf=A_,y.bh=Ot,y.bi=function(a,n){rt.REGISTERED_PROTOCOLS[a]=n},y.bj=function(a){delete rt.REGISTERED_PROTOCOLS[a]},y.bk=function(a,n){const c={};for(let x=0;x<a.length;x++){const k=n&&n[a[x].id]||Gr(a[x]);n&&(n[a[x].id]=k);let C=c[k];C||(C=c[k]=[]),C.push(a[x])}const m=[];for(const x in c)m.push(c[x]);return m},y.bl=It,y.bm=Jn,y.bn=$g,y.bo=Kn,y.bp=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Os/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const n=a.bucket.layers[0],c=n.layout,m=n._unevaluatedLayout._values,x={layoutIconSize:m["icon-size"].possiblyEvaluate(new Ji(a.bucket.zoom+1),a.canonical),layoutTextSize:m["text-size"].possiblyEvaluate(new Ji(a.bucket.zoom+1),a.canonical),textMaxSize:m["text-size"].possiblyEvaluate(new Ji(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=a.bucket.textSizeData;x.compositeTextSizes=[m["text-size"].possiblyEvaluate(new Ji(F),a.canonical),m["text-size"].possiblyEvaluate(new Ji(q),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=a.bucket.iconSizeData;x.compositeIconSizes=[m["icon-size"].possiblyEvaluate(new Ji(F),a.canonical),m["icon-size"].possiblyEvaluate(new Ji(q),a.canonical)]}const k=c.get("text-line-height")*Zs,C=c.get("text-rotation-alignment")!=="viewport"&&c.get("symbol-placement")!=="point",I=c.get("text-keep-upright"),R=c.get("text-size");for(const F of a.bucket.features){const q=c.get("text-font").evaluate(F,{},a.canonical).join(","),W=R.evaluate(F,{},a.canonical),ee=x.layoutTextSize.evaluate(F,{},a.canonical),se=x.layoutIconSize.evaluate(F,{},a.canonical),ue={horizontal:{},vertical:void 0},de=F.text;let Te,Ae=[0,0];if(de){const We=de.toString(),mt=c.get("text-letter-spacing").evaluate(F,{},a.canonical)*Zs,Dt=Cu(We)?mt:0,Jt=c.get("text-anchor").evaluate(F,{},a.canonical),Ti=Hg(n,F,a.canonical);if(!Ti){const li=c.get("text-radial-offset").evaluate(F,{},a.canonical);Ae=li?Rh(Jt,[li*Zs,hm]):c.get("text-offset").evaluate(F,{},a.canonical).map((ri=>ri*Zs))}let Ft=C?"center":c.get("text-justify").evaluate(F,{},a.canonical);const Zt=c.get("symbol-placement")==="point"?c.get("text-max-width").evaluate(F,{},a.canonical)*Zs:1/0,di=()=>{a.bucket.allowVerticalPlacement&&yo(We)&&(ue.vertical=qo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Zt,k,Jt,"left",Dt,Ae,y.ah.vertical,!0,ee,W))};if(!C&&Ti){const li=new Set;if(Ft==="auto")for(let vt=0;vt<Ti.values.length;vt+=2)li.add(Lf(Ti.values[vt]));else li.add(Ft);let ri=!1;for(const vt of li)if(!ue.horizontal[vt])if(ri)ue.horizontal[vt]=ue.horizontal[0];else{const oi=qo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Zt,k,"center",vt,Dt,Ae,y.ah.horizontal,!1,ee,W);oi&&(ue.horizontal[vt]=oi,ri=oi.positionedLines.length===1)}di()}else{Ft==="auto"&&(Ft=Lf(Jt));const li=qo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Zt,k,Jt,Ft,Dt,Ae,y.ah.horizontal,!1,ee,W);li&&(ue.horizontal[Ft]=li),di(),yo(We)&&C&&I&&(ue.vertical=qo(de,a.glyphMap,a.glyphPositions,a.imagePositions,q,Zt,k,Jt,Ft,Dt,Ae,y.ah.vertical,!1,ee,W))}}let Je=!1;if(F.icon&&F.icon.name){const We=a.imageMap[F.icon.name];We&&(Te=Tf(a.imagePositions[F.icon.name],c.get("icon-offset").evaluate(F,{},a.canonical),c.get("icon-anchor").evaluate(F,{},a.canonical)),Je=!!We.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=Je:a.bucket.sdfIcons!==Je&&Mt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(We.pixelRatio!==a.bucket.pixelRatio||c.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const Oe=jd(ue.horizontal)||ue.vertical;a.bucket.iconsInText=!!Oe&&Oe.iconsInText,(Oe||Te)&&kn(a.bucket,F,ue,Te,a.imageMap,x,ee,se,Ae,Je,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},y.bq=gd,y.br=vh,y.bs=Du,y.bt=_c,y.bu=wf,y.bv=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},y.bw=function(a,n,c,m,x){return d(this,void 0,void 0,(function*(){if(ge())try{return yield Et(a,n,c,m,x)}catch{}return(function(k,C,I,R,F){const q=k.width,W=k.height;ot&&xe||(ot=new OffscreenCanvas(q,W),xe=ot.getContext("2d",{willReadFrequently:!0})),ot.width=q,ot.height=W,xe.drawImage(k,0,0,q,W);const ee=xe.getImageData(C,I,R,F);return xe.clearRect(0,0,q,W),ee.data})(a,n,c,m,x)}))},y.bx=om,y.by=A,y.bz=j,y.c=tt,y.d=a=>d(void 0,void 0,void 0,(function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(n)}catch(c){throw new Error(`Could not load image because of ${c.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),y.e=Me,y.f=a=>new Promise(((n,c)=>{const m=new Image;m.onload=()=>{n(m),URL.revokeObjectURL(m.src),m.onload=null,window.requestAnimationFrame((()=>{m.src=ut}))},m.onerror=()=>c(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const x=new Blob([new Uint8Array(a)],{type:"image/png"});m.src=a.byteLength?URL.createObjectURL(x):ut})),y.g=gt,y.h=(a,n)=>gi(Me(a,{type:"json"}),n),y.i=Tt,y.j=ln,y.k=gn,y.l=(a,n)=>gi(Me(a,{type:"arrayBuffer"}),n),y.m=gi,y.n=function(a){return new wf(a).readFields(Lg,[])},y.o=od,y.p=hs,y.q=E,y.r=xi,y.s=Vi,y.t=Tr,y.u=Wt,y.v=it,y.w=Mt,y.x=function([a,n,c]){return n+=90,n*=Math.PI/180,c*=Math.PI/180,{x:a*Math.cos(n)*Math.sin(c),y:a*Math.sin(n)*Math.sin(c),z:a*Math.cos(c)}},y.y=Fs,y.z=Ji})),f("worker",["./shared"],(function(y){class d{constructor(te){this.keyCache={},te&&this.replace(te)}replace(te){this._layerConfigs={},this._layers={},this.update(te,[])}update(te,G){for(const ve of te){this._layerConfigs[ve.id]=ve;const je=this._layers[ve.id]=y.aA(ve);je._featureFilter=y.a7(je.filter),this.keyCache[ve.id]&&delete this.keyCache[ve.id]}for(const ve of G)delete this.keyCache[ve],delete this._layerConfigs[ve],delete this._layers[ve];this.familiesBySource={};const oe=y.bk(Object.values(this._layerConfigs),this.keyCache);for(const ve of oe){const je=ve.map((Ke=>this._layers[Ke.id])),ze=je[0];if(ze.visibility==="none")continue;const Ve=ze.source||"";let he=this.familiesBySource[Ve];he||(he=this.familiesBySource[Ve]={});const Ge=ze.sourceLayer||"_geojsonTileLayer";let at=he[Ge];at||(at=he[Ge]=[]),at.push(je)}}}class A{constructor(te){const G={},oe=[];for(const Ve in te){const he=te[Ve],Ge=G[Ve]={};for(const at in he){const Ke=he[+at];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const st={x:0,y:0,w:Ke.bitmap.width+2,h:Ke.bitmap.height+2};oe.push(st),Ge[at]={rect:st,metrics:Ke.metrics}}}const{w:ve,h:je}=y.p(oe),ze=new y.o({width:ve||1,height:je||1});for(const Ve in te){const he=te[Ve];for(const Ge in he){const at=he[+Ge];if(!at||at.bitmap.width===0||at.bitmap.height===0)continue;const Ke=G[Ve][Ge].rect;y.o.copy(at.bitmap,ze,{x:0,y:0},{x:Ke.x+1,y:Ke.y+1},at.bitmap)}}this.image=ze,this.positions=G}}y.bl("GlyphAtlas",A);class j{constructor(te){this.tileID=new y.S(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId,this.inFlightDependencies=[]}parse(te,G,oe,ve){return y._(this,void 0,void 0,(function*(){this.status="parsing",this.data=te,this.collisionBoxArray=new y.a5;const je=new y.bm(Object.keys(te.layers).sort()),ze=new y.bn(this.tileID,this.promoteId);ze.bucketLayerIDs=[];const Ve={},he={featureIndex:ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:oe},Ge=G.familiesBySource[this.source];for(const xt in Ge){const Gt=te.layers[xt];if(!Gt)continue;Gt.version===1&&y.w(`Vector tile source "${this.source}" layer "${xt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const fi=je.encode(xt),Ne=[];for(let zt=0;zt<Gt.length;zt++){const Kt=Gt.feature(zt),Zi=ze.getId(Kt,xt);Ne.push({feature:Kt,id:Zi,index:zt,sourceLayerIndex:fi})}for(const zt of Ge[xt]){const Kt=zt[0];Kt.source!==this.source&&y.w(`layer.source = ${Kt.source} does not equal this.source = ${this.source}`),Kt.minzoom&&this.zoom<Math.floor(Kt.minzoom)||Kt.maxzoom&&this.zoom>=Kt.maxzoom||Kt.visibility!=="none"&&(B(zt,this.zoom,oe),(Ve[Kt.id]=Kt.createBucket({index:ze.bucketLayerIDs.length,layers:zt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fi,sourceID:this.source})).populate(Ne,he,this.tileID.canonical),ze.bucketLayerIDs.push(zt.map((Zi=>Zi.id))))}}const at=y.aF(he.glyphDependencies,(xt=>Object.keys(xt).map(Number)));this.inFlightDependencies.forEach((xt=>xt?.abort())),this.inFlightDependencies=[];let Ke=Promise.resolve({});if(Object.keys(at).length){const xt=new AbortController;this.inFlightDependencies.push(xt),Ke=ve.sendAsync({type:"GG",data:{stacks:at,source:this.source,tileID:this.tileID,type:"glyphs"}},xt)}const st=Object.keys(he.iconDependencies);let Qt=Promise.resolve({});if(st.length){const xt=new AbortController;this.inFlightDependencies.push(xt),Qt=ve.sendAsync({type:"GI",data:{icons:st,source:this.source,tileID:this.tileID,type:"icons"}},xt)}const si=Object.keys(he.patternDependencies);let Bt=Promise.resolve({});if(si.length){const xt=new AbortController;this.inFlightDependencies.push(xt),Bt=ve.sendAsync({type:"GI",data:{icons:si,source:this.source,tileID:this.tileID,type:"patterns"}},xt)}const[Ct,ni,yi]=yield Promise.all([Ke,Qt,Bt]),Ri=new A(Ct),_t=new y.bo(ni,yi);for(const xt in Ve){const Gt=Ve[xt];Gt instanceof y.a6?(B(Gt.layers,this.zoom,oe),y.bp({bucket:Gt,glyphMap:Ct,glyphPositions:Ri.positions,imageMap:ni,imagePositions:_t.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Gt.hasPattern&&(Gt instanceof y.bq||Gt instanceof y.br||Gt instanceof y.bs)&&(B(Gt.layers,this.zoom,oe),Gt.addFeatures(he,this.tileID.canonical,_t.patternPositions))}return this.status="done",{buckets:Object.values(Ve).filter((xt=>!xt.isEmpty())),featureIndex:ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ri.image,imageAtlas:_t,glyphMap:this.returnDependencies?Ct:null,iconMap:this.returnDependencies?ni:null,glyphPositions:this.returnDependencies?Ri.positions:null}}))}}function B(we,te,G){const oe=new y.z(te);for(const ve of we)ve.recalculate(oe,G)}class N{constructor(te,G,oe){this.actor=te,this.layerIndex=G,this.availableImages=oe,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(te,G){return y._(this,void 0,void 0,(function*(){const oe=yield y.l(te.request,G);try{return{vectorTile:new y.bt.VectorTile(new y.bu(oe.data)),rawData:oe.data,cacheControl:oe.cacheControl,expires:oe.expires}}catch(ve){const je=new Uint8Array(oe.data);let ze=`Unable to parse the tile at ${te.request.url}, `;throw ze+=je[0]===31&&je[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ve.message}`,new Error(ze)}}))}loadTile(te){return y._(this,void 0,void 0,(function*(){const G=te.uid,oe=!!(te&&te.request&&te.request.collectResourceTiming)&&new y.bv(te.request),ve=new j(te);this.loading[G]=ve;const je=new AbortController;ve.abort=je;try{const ze=yield this.loadVectorTile(te,je);if(delete this.loading[G],!ze)return null;const Ve=ze.rawData,he={};ze.expires&&(he.expires=ze.expires),ze.cacheControl&&(he.cacheControl=ze.cacheControl);const Ge={};if(oe){const Ke=oe.finish();Ke&&(Ge.resourceTiming=JSON.parse(JSON.stringify(Ke)))}ve.vectorTile=ze.vectorTile;const at=ve.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[G]=ve,this.fetching[G]={rawTileData:Ve,cacheControl:he,resourceTiming:Ge};try{const Ke=yield at;return y.e({rawTileData:Ve.slice(0)},Ke,he,Ge)}finally{delete this.fetching[G]}}catch(ze){throw delete this.loading[G],ve.status="done",this.loaded[G]=ve,ze}}))}reloadTile(te){return y._(this,void 0,void 0,(function*(){const G=te.uid;if(!this.loaded||!this.loaded[G])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const oe=this.loaded[G];if(oe.showCollisionBoxes=te.showCollisionBoxes,oe.status==="parsing"){const ve=yield oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor);let je;if(this.fetching[G]){const{rawTileData:ze,cacheControl:Ve,resourceTiming:he}=this.fetching[G];delete this.fetching[G],je=y.e({rawTileData:ze.slice(0)},ve,Ve,he)}else je=ve;return je}if(oe.status==="done"&&oe.vectorTile)return oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(te){return y._(this,void 0,void 0,(function*(){const G=this.loading,oe=te.uid;G&&G[oe]&&G[oe].abort&&(G[oe].abort.abort(),delete G[oe])}))}removeTile(te){return y._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[te.uid]&&delete this.loaded[te.uid]}))}}class V{constructor(){this.loaded={}}loadTile(te){return y._(this,void 0,void 0,(function*(){const{uid:G,encoding:oe,rawImageData:ve,redFactor:je,greenFactor:ze,blueFactor:Ve,baseShift:he}=te,Ge=ve.width+2,at=ve.height+2,Ke=y.b(ve)?new y.R({width:Ge,height:at},yield y.bw(ve,-1,-1,Ge,at)):ve,st=new y.bx(G,Ke,oe,je,ze,Ve,he);return this.loaded=this.loaded||{},this.loaded[G]=st,st}))}removeTile(te){const G=this.loaded,oe=te.uid;G&&G[oe]&&delete G[oe]}}function Q(we,te){if(we.length!==0){ne(we[0],te);for(var G=1;G<we.length;G++)ne(we[G],!te)}}function ne(we,te){for(var G=0,oe=0,ve=0,je=we.length,ze=je-1;ve<je;ze=ve++){var Ve=(we[ve][0]-we[ze][0])*(we[ze][1]+we[ve][1]),he=G+Ve;oe+=Math.abs(G)>=Math.abs(Ve)?G-he+Ve:Ve-he+G,G=he}G+oe>=0!=!!te&&we.reverse()}var J=y.by((function we(te,G){var oe,ve=te&&te.type;if(ve==="FeatureCollection")for(oe=0;oe<te.features.length;oe++)we(te.features[oe],G);else if(ve==="GeometryCollection")for(oe=0;oe<te.geometries.length;oe++)we(te.geometries[oe],G);else if(ve==="Feature")we(te.geometry,G);else if(ve==="Polygon")Q(te.coordinates,G);else if(ve==="MultiPolygon")for(oe=0;oe<te.coordinates.length;oe++)Q(te.coordinates[oe],G);return te}));const ye=y.bt.VectorTileFeature.prototype.toGeoJSON;var re={exports:{}},ge=y.bz,le=y.bt.VectorTileFeature,me=be;function be(we,te){this.options=te||{},this.features=we,this.length=we.length}function ke(we,te){this.id=typeof we.id=="number"?we.id:void 0,this.type=we.type,this.rawGeometry=we.type===1?[we.geometry]:we.geometry,this.properties=we.tags,this.extent=te||4096}be.prototype.feature=function(we){return new ke(this.features[we],this.options.extent)},ke.prototype.loadGeometry=function(){var we=this.rawGeometry;this.geometry=[];for(var te=0;te<we.length;te++){for(var G=we[te],oe=[],ve=0;ve<G.length;ve++)oe.push(new ge(G[ve][0],G[ve][1]));this.geometry.push(oe)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var we=this.geometry,te=1/0,G=-1/0,oe=1/0,ve=-1/0,je=0;je<we.length;je++)for(var ze=we[je],Ve=0;Ve<ze.length;Ve++){var he=ze[Ve];te=Math.min(te,he.x),G=Math.max(G,he.x),oe=Math.min(oe,he.y),ve=Math.max(ve,he.y)}return[te,oe,G,ve]},ke.prototype.toGeoJSON=le.prototype.toGeoJSON;var Me=y.bA,Ue=me;function Fe(we){var te=new Me;return(function(G,oe){for(var ve in G.layers)oe.writeMessage(3,He,G.layers[ve])})(we,te),te.finish()}function He(we,te){var G;te.writeVarintField(15,we.version||1),te.writeStringField(1,we.name||""),te.writeVarintField(5,we.extent||4096);var oe={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<we.length;G++)oe.feature=we.feature(G),te.writeMessage(2,lt,oe);var ve=oe.keys;for(G=0;G<ve.length;G++)te.writeStringField(3,ve[G]);var je=oe.values;for(G=0;G<je.length;G++)te.writeMessage(4,Be,je[G])}function lt(we,te){var G=we.feature;G.id!==void 0&&te.writeVarintField(1,G.id),te.writeMessage(2,Ye,we),te.writeVarintField(3,G.type),te.writeMessage(4,Tt,G)}function Ye(we,te){var G=we.feature,oe=we.keys,ve=we.values,je=we.keycache,ze=we.valuecache;for(var Ve in G.properties){var he=G.properties[Ve],Ge=je[Ve];if(he!==null){Ge===void 0&&(oe.push(Ve),je[Ve]=Ge=oe.length-1),te.writeVarint(Ge);var at=typeof he;at!=="string"&&at!=="boolean"&&at!=="number"&&(he=JSON.stringify(he));var Ke=at+":"+he,st=ze[Ke];st===void 0&&(ve.push(he),ze[Ke]=st=ve.length-1),te.writeVarint(st)}}}function Mt(we,te){return(te<<3)+(7&we)}function et(we){return we<<1^we>>31}function Tt(we,te){for(var G=we.loadGeometry(),oe=we.type,ve=0,je=0,ze=G.length,Ve=0;Ve<ze;Ve++){var he=G[Ve],Ge=1;oe===1&&(Ge=he.length),te.writeVarint(Mt(1,Ge));for(var at=oe===3?he.length-1:he.length,Ke=0;Ke<at;Ke++){Ke===1&&oe!==1&&te.writeVarint(Mt(2,at-1));var st=he[Ke].x-ve,Qt=he[Ke].y-je;te.writeVarint(et(st)),te.writeVarint(et(Qt)),ve+=st,je+=Qt}oe===3&&te.writeVarint(Mt(7,1))}}function Be(we,te){var G=typeof we;G==="string"?te.writeStringField(1,we):G==="boolean"?te.writeBooleanField(7,we):G==="number"&&(we%1!=0?te.writeDoubleField(3,we):we<0?te.writeSVarintField(6,we):te.writeVarintField(5,we))}re.exports=Fe,re.exports.fromVectorTileJs=Fe,re.exports.fromGeojsonVt=function(we,te){te=te||{};var G={};for(var oe in we)G[oe]=new Ue(we[oe].features,te),G[oe].name=oe,G[oe].version=te.version,G[oe].extent=te.extent;return Fe({layers:G})},re.exports.GeoJSONWrapper=Ue;var ct=y.by(re.exports);const ut={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:we=>we},Et=Math.fround||(ot=new Float32Array(1),we=>(ot[0]=+we,ot[0]));var ot;const xe=3,Le=5,tt=6;class rt{constructor(te){this.options=Object.assign(Object.create(ut),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:G,minZoom:oe,maxZoom:ve}=this.options;G&&console.time("total time");const je=`prepare ${te.length} points`;G&&console.time(je),this.points=te;const ze=[];for(let he=0;he<te.length;he++){const Ge=te[he];if(!Ge.geometry)continue;const[at,Ke]=Ge.geometry.coordinates,st=Et(Ot(at)),Qt=Et(ei(Ke));ze.push(st,Qt,1/0,he,-1,1),this.options.reduce&&ze.push(0)}let Ve=this.trees[ve+1]=this._createTree(ze);G&&console.timeEnd(je);for(let he=ve;he>=oe;he--){const Ge=+Date.now();Ve=this.trees[he]=this._createTree(this._cluster(Ve,he)),G&&console.log("z%d: %d clusters in %dms",he,Ve.numItems,+Date.now()-Ge)}return G&&console.timeEnd("total time"),this}getClusters(te,G){let oe=((te[0]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,te[1]));let je=te[2]===180?180:((te[2]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)oe=-180,je=180;else if(oe>je){const Ke=this.getClusters([oe,ve,180,ze],G),st=this.getClusters([-180,ve,je,ze],G);return Ke.concat(st)}const Ve=this.trees[this._limitZoom(G)],he=Ve.range(Ot(oe),ei(ze),Ot(je),ei(ve)),Ge=Ve.data,at=[];for(const Ke of he){const st=this.stride*Ke;at.push(Ge[st+Le]>1?gt(Ge,st,this.clusterProps):this.points[Ge[st+xe]])}return at}getChildren(te){const G=this._getOriginId(te),oe=this._getOriginZoom(te),ve="No cluster with the specified id.",je=this.trees[oe];if(!je)throw new Error(ve);const ze=je.data;if(G*this.stride>=ze.length)throw new Error(ve);const Ve=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),he=je.within(ze[G*this.stride],ze[G*this.stride+1],Ve),Ge=[];for(const at of he){const Ke=at*this.stride;ze[Ke+4]===te&&Ge.push(ze[Ke+Le]>1?gt(ze,Ke,this.clusterProps):this.points[ze[Ke+xe]])}if(Ge.length===0)throw new Error(ve);return Ge}getLeaves(te,G,oe){const ve=[];return this._appendLeaves(ve,te,G=G||10,oe=oe||0,0),ve}getTile(te,G,oe){const ve=this.trees[this._limitZoom(te)],je=Math.pow(2,te),{extent:ze,radius:Ve}=this.options,he=Ve/ze,Ge=(oe-he)/je,at=(oe+1+he)/je,Ke={features:[]};return this._addTileFeatures(ve.range((G-he)/je,Ge,(G+1+he)/je,at),ve.data,G,oe,je,Ke),G===0&&this._addTileFeatures(ve.range(1-he/je,Ge,1,at),ve.data,je,oe,je,Ke),G===je-1&&this._addTileFeatures(ve.range(0,Ge,he/je,at),ve.data,-1,oe,je,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(te){let G=this._getOriginZoom(te)-1;for(;G<=this.options.maxZoom;){const oe=this.getChildren(te);if(G++,oe.length!==1)break;te=oe[0].properties.cluster_id}return G}_appendLeaves(te,G,oe,ve,je){const ze=this.getChildren(G);for(const Ve of ze){const he=Ve.properties;if(he&&he.cluster?je+he.point_count<=ve?je+=he.point_count:je=this._appendLeaves(te,he.cluster_id,oe,ve,je):je<ve?je++:te.push(Ve),te.length===oe)break}return je}_createTree(te){const G=new y.av(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let oe=0;oe<te.length;oe+=this.stride)G.add(te[oe],te[oe+1]);return G.finish(),G.data=te,G}_addTileFeatures(te,G,oe,ve,je,ze){for(const Ve of te){const he=Ve*this.stride,Ge=G[he+Le]>1;let at,Ke,st;if(Ge)at=Pt(G,he,this.clusterProps),Ke=G[he],st=G[he+1];else{const Bt=this.points[G[he+xe]];at=Bt.properties;const[Ct,ni]=Bt.geometry.coordinates;Ke=Ot(Ct),st=ei(ni)}const Qt={type:1,geometry:[[Math.round(this.options.extent*(Ke*je-oe)),Math.round(this.options.extent*(st*je-ve))]],tags:at};let si;si=Ge||this.options.generateId?G[he+xe]:this.points[G[he+xe]].id,si!==void 0&&(Qt.id=si),ze.features.push(Qt)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,G){const{radius:oe,extent:ve,reduce:je,minPoints:ze}=this.options,Ve=oe/(ve*Math.pow(2,G)),he=te.data,Ge=[],at=this.stride;for(let Ke=0;Ke<he.length;Ke+=at){if(he[Ke+2]<=G)continue;he[Ke+2]=G;const st=he[Ke],Qt=he[Ke+1],si=te.within(he[Ke],he[Ke+1],Ve),Bt=he[Ke+Le];let Ct=Bt;for(const ni of si){const yi=ni*at;he[yi+2]>G&&(Ct+=he[yi+Le])}if(Ct>Bt&&Ct>=ze){let ni,yi=st*Bt,Ri=Qt*Bt,_t=-1;const xt=((Ke/at|0)<<5)+(G+1)+this.points.length;for(const Gt of si){const fi=Gt*at;if(he[fi+2]<=G)continue;he[fi+2]=G;const Ne=he[fi+Le];yi+=he[fi]*Ne,Ri+=he[fi+1]*Ne,he[fi+4]=xt,je&&(ni||(ni=this._map(he,Ke,!0),_t=this.clusterProps.length,this.clusterProps.push(ni)),je(ni,this._map(he,fi)))}he[Ke+4]=xt,Ge.push(yi/Ct,Ri/Ct,1/0,xt,-1,Ct),je&&Ge.push(_t)}else{for(let ni=0;ni<at;ni++)Ge.push(he[Ke+ni]);if(Ct>1)for(const ni of si){const yi=ni*at;if(!(he[yi+2]<=G)){he[yi+2]=G;for(let Ri=0;Ri<at;Ri++)Ge.push(he[yi+Ri])}}}}return Ge}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,G,oe){if(te[G+Le]>1){const ze=this.clusterProps[te[G+tt]];return oe?Object.assign({},ze):ze}const ve=this.points[te[G+xe]].properties,je=this.options.map(ve);return oe&&je===ve?Object.assign({},je):je}}function gt(we,te,G){return{type:"Feature",id:we[te+xe],properties:Pt(we,te,G),geometry:{type:"Point",coordinates:[(oe=we[te],360*(oe-.5)),gi(we[te+1])]}};var oe}function Pt(we,te,G){const oe=we[te+Le],ve=oe>=1e4?`${Math.round(oe/1e3)}k`:oe>=1e3?Math.round(oe/100)/10+"k":oe,je=we[te+tt],ze=je===-1?{}:Object.assign({},G[je]);return Object.assign(ze,{cluster:!0,cluster_id:we[te+xe],point_count:oe,point_count_abbreviated:ve})}function Ot(we){return we/360+.5}function ei(we){const te=Math.sin(we*Math.PI/180),G=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return G<0?0:G>1?1:G}function gi(we){const te=(180-360*we)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function Vi(we,te,G,oe){let ve=oe;const je=te+(G-te>>1);let ze,Ve=G-te;const he=we[te],Ge=we[te+1],at=we[G],Ke=we[G+1];for(let st=te+3;st<G;st+=3){const Qt=pi(we[st],we[st+1],he,Ge,at,Ke);if(Qt>ve)ze=st,ve=Qt;else if(Qt===ve){const si=Math.abs(st-je);si<Ve&&(ze=st,Ve=si)}}ve>oe&&(ze-te>3&&Vi(we,te,ze,oe),we[ze+2]=ve,G-ze>3&&Vi(we,ze,G,oe))}function pi(we,te,G,oe,ve,je){let ze=ve-G,Ve=je-oe;if(ze!==0||Ve!==0){const he=((we-G)*ze+(te-oe)*Ve)/(ze*ze+Ve*Ve);he>1?(G=ve,oe=je):he>0&&(G+=ze*he,oe+=Ve*he)}return ze=we-G,Ve=te-oe,ze*ze+Ve*Ve}function zi(we,te,G,oe){const ve={id:we??null,type:te,geometry:G,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")gn(ve,G);else if(te==="Polygon")gn(ve,G[0]);else if(te==="MultiLineString")for(const je of G)gn(ve,je);else if(te==="MultiPolygon")for(const je of G)gn(ve,je[0]);return ve}function gn(we,te){for(let G=0;G<te.length;G+=3)we.minX=Math.min(we.minX,te[G]),we.minY=Math.min(we.minY,te[G+1]),we.maxX=Math.max(we.maxX,te[G]),we.maxY=Math.max(we.maxY,te[G+1])}function ln(we,te,G,oe){if(!te.geometry)return;const ve=te.geometry.coordinates;if(ve&&ve.length===0)return;const je=te.geometry.type,ze=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2);let Ve=[],he=te.id;if(G.promoteId?he=te.properties[G.promoteId]:G.generateId&&(he=oe||0),je==="Point")$n(ve,Ve);else if(je==="MultiPoint")for(const Ge of ve)$n(Ge,Ve);else if(je==="LineString")it(ve,Ve,ze,!1);else if(je==="MultiLineString"){if(G.lineMetrics){for(const Ge of ve)Ve=[],it(Ge,Ve,ze,!1),we.push(zi(he,"LineString",Ve,te.properties));return}Cn(ve,Ve,ze,!1)}else if(je==="Polygon")Cn(ve,Ve,ze,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const Ge of te.geometry.geometries)ln(we,{id:he,geometry:Ge,properties:te.properties},G,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ge of ve){const at=[];Cn(Ge,at,ze,!0),Ve.push(at)}}we.push(zi(he,je,Ve,te.properties))}function $n(we,te){te.push(Mn(we[0]),Si(we[1]),0)}function it(we,te,G,oe){let ve,je,ze=0;for(let he=0;he<we.length;he++){const Ge=Mn(we[he][0]),at=Si(we[he][1]);te.push(Ge,at,0),he>0&&(ze+=oe?(ve*at-Ge*je)/2:Math.sqrt(Math.pow(Ge-ve,2)+Math.pow(at-je,2))),ve=Ge,je=at}const Ve=te.length-3;te[2]=1,Vi(te,0,Ve,G),te[Ve+2]=1,te.size=Math.abs(ze),te.start=0,te.end=te.size}function Cn(we,te,G,oe){for(let ve=0;ve<we.length;ve++){const je=[];it(we[ve],je,G,oe),te.push(je)}}function Mn(we){return we/360+.5}function Si(we){const te=Math.sin(we*Math.PI/180),G=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return G<0?0:G>1?1:G}function mi(we,te,G,oe,ve,je,ze,Ve){if(oe/=te,je>=(G/=te)&&ze<oe)return we;if(ze<G||je>=oe)return null;const he=[];for(const Ge of we){const at=Ge.geometry;let Ke=Ge.type;const st=ve===0?Ge.minX:Ge.minY,Qt=ve===0?Ge.maxX:Ge.maxY;if(st>=G&&Qt<oe){he.push(Ge);continue}if(Qt<G||st>=oe)continue;let si=[];if(Ke==="Point"||Ke==="MultiPoint")En(at,si,G,oe,ve);else if(Ke==="LineString")Rn(at,si,G,oe,ve,!1,Ve.lineMetrics);else if(Ke==="MultiLineString")sn(at,si,G,oe,ve,!1);else if(Ke==="Polygon")sn(at,si,G,oe,ve,!0);else if(Ke==="MultiPolygon")for(const Bt of at){const Ct=[];sn(Bt,Ct,G,oe,ve,!0),Ct.length&&si.push(Ct)}if(si.length){if(Ve.lineMetrics&&Ke==="LineString"){for(const Bt of si)he.push(zi(Ge.id,Ke,Bt,Ge.tags));continue}Ke!=="LineString"&&Ke!=="MultiLineString"||(si.length===1?(Ke="LineString",si=si[0]):Ke="MultiLineString"),Ke!=="Point"&&Ke!=="MultiPoint"||(Ke=si.length===3?"Point":"MultiPoint"),he.push(zi(Ge.id,Ke,si,Ge.tags))}}return he.length?he:null}function En(we,te,G,oe,ve){for(let je=0;je<we.length;je+=3){const ze=we[je+ve];ze>=G&&ze<=oe&&Xi(te,we[je],we[je+1],we[je+2])}}function Rn(we,te,G,oe,ve,je,ze){let Ve=is(we);const he=ve===0?Gi:ns;let Ge,at,Ke=we.start;for(let Ct=0;Ct<we.length-3;Ct+=3){const ni=we[Ct],yi=we[Ct+1],Ri=we[Ct+2],_t=we[Ct+3],xt=we[Ct+4],Gt=ve===0?ni:yi,fi=ve===0?_t:xt;let Ne=!1;ze&&(Ge=Math.sqrt(Math.pow(ni-_t,2)+Math.pow(yi-xt,2))),Gt<G?fi>G&&(at=he(Ve,ni,yi,_t,xt,G),ze&&(Ve.start=Ke+Ge*at)):Gt>oe?fi<oe&&(at=he(Ve,ni,yi,_t,xt,oe),ze&&(Ve.start=Ke+Ge*at)):Xi(Ve,ni,yi,Ri),fi<G&&Gt>=G&&(at=he(Ve,ni,yi,_t,xt,G),Ne=!0),fi>oe&&Gt<=oe&&(at=he(Ve,ni,yi,_t,xt,oe),Ne=!0),!je&&Ne&&(ze&&(Ve.end=Ke+Ge*at),te.push(Ve),Ve=is(we)),ze&&(Ke+=Ge)}let st=we.length-3;const Qt=we[st],si=we[st+1],Bt=ve===0?Qt:si;Bt>=G&&Bt<=oe&&Xi(Ve,Qt,si,we[st+2]),st=Ve.length-3,je&&st>=3&&(Ve[st]!==Ve[0]||Ve[st+1]!==Ve[1])&&Xi(Ve,Ve[0],Ve[1],Ve[2]),Ve.length&&te.push(Ve)}function is(we){const te=[];return te.size=we.size,te.start=we.start,te.end=we.end,te}function sn(we,te,G,oe,ve,je){for(const ze of we)Rn(ze,te,G,oe,ve,je,!1)}function Xi(we,te,G,oe){we.push(te,G,oe)}function Gi(we,te,G,oe,ve,je){const ze=(je-te)/(oe-te);return Xi(we,je,G+(ve-G)*ze,1),ze}function ns(we,te,G,oe,ve,je){const ze=(je-G)/(ve-G);return Xi(we,te+(oe-te)*ze,je,1),ze}function kt(we,te){const G=[];for(let oe=0;oe<we.length;oe++){const ve=we[oe],je=ve.type;let ze;if(je==="Point"||je==="MultiPoint"||je==="LineString")ze=Hn(ve.geometry,te);else if(je==="MultiLineString"||je==="Polygon"){ze=[];for(const Ve of ve.geometry)ze.push(Hn(Ve,te))}else if(je==="MultiPolygon"){ze=[];for(const Ve of ve.geometry){const he=[];for(const Ge of Ve)he.push(Hn(Ge,te));ze.push(he)}}G.push(zi(ve.id,je,ze,ve.tags))}return G}function Hn(we,te){const G=[];G.size=we.size,we.start!==void 0&&(G.start=we.start,G.end=we.end);for(let oe=0;oe<we.length;oe+=3)G.push(we[oe]+te,we[oe+1],we[oe+2]);return G}function yn(we,te){if(we.transformed)return we;const G=1<<we.z,oe=we.x,ve=we.y;for(const je of we.features){const ze=je.geometry,Ve=je.type;if(je.geometry=[],Ve===1)for(let he=0;he<ze.length;he+=2)je.geometry.push(bn(ze[he],ze[he+1],te,G,oe,ve));else for(let he=0;he<ze.length;he++){const Ge=[];for(let at=0;at<ze[he].length;at+=2)Ge.push(bn(ze[he][at],ze[he][at+1],te,G,oe,ve));je.geometry.push(Ge)}}return we.transformed=!0,we}function bn(we,te,G,oe,ve,je){return[Math.round(G*(we*oe-ve)),Math.round(G*(te*oe-je))]}function Un(we,te,G,oe,ve){const je=te===ve.maxZoom?0:ve.tolerance/((1<<te)*ve.extent),ze={features:[],numPoints:0,numSimplified:0,numFeatures:we.length,source:null,x:G,y:oe,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ve of we)jt(ze,Ve,je,ve);return ze}function jt(we,te,G,oe){const ve=te.geometry,je=te.type,ze=[];if(we.minX=Math.min(we.minX,te.minX),we.minY=Math.min(we.minY,te.minY),we.maxX=Math.max(we.maxX,te.maxX),we.maxY=Math.max(we.maxY,te.maxY),je==="Point"||je==="MultiPoint")for(let Ve=0;Ve<ve.length;Ve+=3)ze.push(ve[Ve],ve[Ve+1]),we.numPoints++,we.numSimplified++;else if(je==="LineString")ii(ze,ve,we,G,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let Ve=0;Ve<ve.length;Ve++)ii(ze,ve[Ve],we,G,je==="Polygon",Ve===0);else if(je==="MultiPolygon")for(let Ve=0;Ve<ve.length;Ve++){const he=ve[Ve];for(let Ge=0;Ge<he.length;Ge++)ii(ze,he[Ge],we,G,!0,Ge===0)}if(ze.length){let Ve=te.tags||null;if(je==="LineString"&&oe.lineMetrics){Ve={};for(const Ge in te.tags)Ve[Ge]=te.tags[Ge];Ve.mapbox_clip_start=ve.start/ve.size,Ve.mapbox_clip_end=ve.end/ve.size}const he={geometry:ze,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:Ve};te.id!==null&&(he.id=te.id),we.features.push(he)}}function ii(we,te,G,oe,ve,je){const ze=oe*oe;if(oe>0&&te.size<(ve?ze:oe))return void(G.numPoints+=te.length/3);const Ve=[];for(let he=0;he<te.length;he+=3)(oe===0||te[he+2]>ze)&&(G.numSimplified++,Ve.push(te[he],te[he+1])),G.numPoints++;ve&&(function(he,Ge){let at=0;for(let Ke=0,st=he.length,Qt=st-2;Ke<st;Qt=Ke,Ke+=2)at+=(he[Ke]-he[Qt])*(he[Ke+1]+he[Qt+1]);if(at>0===Ge)for(let Ke=0,st=he.length;Ke<st/2;Ke+=2){const Qt=he[Ke],si=he[Ke+1];he[Ke]=he[st-2-Ke],he[Ke+1]=he[st-1-Ke],he[st-2-Ke]=Qt,he[st-1-Ke]=si}})(Ve,je),we.push(Ve)}const Xt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Wi{constructor(te,G){const oe=(G=this.options=(function(je,ze){for(const Ve in ze)je[Ve]=ze[Ve];return je})(Object.create(Xt),G)).debug;if(oe&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");let ve=(function(je,ze){const Ve=[];if(je.type==="FeatureCollection")for(let he=0;he<je.features.length;he++)ln(Ve,je.features[he],ze,he);else ln(Ve,je.type==="Feature"?je:{geometry:je},ze);return Ve})(te,G);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ve=(function(je,ze){const Ve=ze.buffer/ze.extent;let he=je;const Ge=mi(je,1,-1-Ve,Ve,0,-1,2,ze),at=mi(je,1,1-Ve,2+Ve,0,-1,2,ze);return(Ge||at)&&(he=mi(je,1,-Ve,1+Ve,0,-1,2,ze)||[],Ge&&(he=kt(Ge,1).concat(he)),at&&(he=he.concat(kt(at,-1)))),he})(ve,G),ve.length&&this.splitTile(ve,0,0,0),oe&&(ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,G,oe,ve,je,ze,Ve){const he=[te,G,oe,ve],Ge=this.options,at=Ge.debug;for(;he.length;){ve=he.pop(),oe=he.pop(),G=he.pop(),te=he.pop();const Ke=1<<G,st=Dn(G,oe,ve);let Qt=this.tiles[st];if(!Qt&&(at>1&&console.time("creation"),Qt=this.tiles[st]=Un(te,G,oe,ve,Ge),this.tileCoords.push({z:G,x:oe,y:ve}),at)){at>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,oe,ve,Qt.numFeatures,Qt.numPoints,Qt.numSimplified),console.timeEnd("creation"));const Ne=`z${G}`;this.stats[Ne]=(this.stats[Ne]||0)+1,this.total++}if(Qt.source=te,je==null){if(G===Ge.indexMaxZoom||Qt.numPoints<=Ge.indexMaxPoints)continue}else{if(G===Ge.maxZoom||G===je)continue;if(je!=null){const Ne=je-G;if(oe!==ze>>Ne||ve!==Ve>>Ne)continue}}if(Qt.source=null,te.length===0)continue;at>1&&console.time("clipping");const si=.5*Ge.buffer/Ge.extent,Bt=.5-si,Ct=.5+si,ni=1+si;let yi=null,Ri=null,_t=null,xt=null,Gt=mi(te,Ke,oe-si,oe+Ct,0,Qt.minX,Qt.maxX,Ge),fi=mi(te,Ke,oe+Bt,oe+ni,0,Qt.minX,Qt.maxX,Ge);te=null,Gt&&(yi=mi(Gt,Ke,ve-si,ve+Ct,1,Qt.minY,Qt.maxY,Ge),Ri=mi(Gt,Ke,ve+Bt,ve+ni,1,Qt.minY,Qt.maxY,Ge),Gt=null),fi&&(_t=mi(fi,Ke,ve-si,ve+Ct,1,Qt.minY,Qt.maxY,Ge),xt=mi(fi,Ke,ve+Bt,ve+ni,1,Qt.minY,Qt.maxY,Ge),fi=null),at>1&&console.timeEnd("clipping"),he.push(yi||[],G+1,2*oe,2*ve),he.push(Ri||[],G+1,2*oe,2*ve+1),he.push(_t||[],G+1,2*oe+1,2*ve),he.push(xt||[],G+1,2*oe+1,2*ve+1)}}getTile(te,G,oe){te=+te,G=+G,oe=+oe;const ve=this.options,{extent:je,debug:ze}=ve;if(te<0||te>24)return null;const Ve=1<<te,he=Dn(te,G=G+Ve&Ve-1,oe);if(this.tiles[he])return yn(this.tiles[he],je);ze>1&&console.log("drilling down to z%d-%d-%d",te,G,oe);let Ge,at=te,Ke=G,st=oe;for(;!Ge&&at>0;)at--,Ke>>=1,st>>=1,Ge=this.tiles[Dn(at,Ke,st)];return Ge&&Ge.source?(ze>1&&(console.log("found parent tile z%d-%d-%d",at,Ke,st),console.time("drilling down")),this.splitTile(Ge.source,at,Ke,st,te,G,oe),ze>1&&console.timeEnd("drilling down"),this.tiles[he]?yn(this.tiles[he],je):null):null}}function Dn(we,te,G){return 32*((1<<we)*G+te)+we}function hi(we,te){return te?we.properties[te]:we.id}function xs(we,te){if(we==null)return!0;if(we.type==="Feature")return hi(we,te)!=null;if(we.type==="FeatureCollection"){const G=new Set;for(const oe of we.features){const ve=hi(oe,te);if(ve==null||G.has(ve))return!1;G.add(ve)}return!0}return!1}function Pn(we,te){const G=new Map;if(we!=null)if(we.type==="Feature")G.set(hi(we,te),we);else for(const oe of we.features)G.set(hi(oe,te),oe);return G}class Zn extends N{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(te,G){return y._(this,void 0,void 0,(function*(){const oe=te.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ve=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!ve)return null;const je=new class{constructor(Ve){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.X,this.length=Ve.length,this._features=Ve}feature(Ve){return new class{constructor(he){this._feature=he,this.extent=y.X,this.type=he.type,this.properties=he.tags,"id"in he&&!isNaN(he.id)&&(this.id=parseInt(he.id,10))}loadGeometry(){if(this._feature.type===1){const he=[];for(const Ge of this._feature.geometry)he.push([new y.P(Ge[0],Ge[1])]);return he}{const he=[];for(const Ge of this._feature.geometry){const at=[];for(const Ke of Ge)at.push(new y.P(Ke[0],Ke[1]));he.push(at)}return he}}toGeoJSON(he,Ge,at){return ye.call(this,he,Ge,at)}}(this._features[Ve])}}(ve.features);let ze=ct(je);return ze.byteOffset===0&&ze.byteLength===ze.buffer.byteLength||(ze=new Uint8Array(ze)),{vectorTile:je,rawData:ze.buffer}}))}loadData(te){return y._(this,void 0,void 0,(function*(){var G;(G=this._pendingRequest)===null||G===void 0||G.abort();const oe=!!(te&&te.request&&te.request.collectResourceTiming)&&new y.bv(te.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(te,this._pendingRequest),this._geoJSONIndex=te.cluster?new rt((function({superclusterOptions:ze,clusterProperties:Ve}){if(!Ve||!ze)return ze;const he={},Ge={},at={accumulated:null,zoom:0},Ke={properties:null},st=Object.keys(Ve);for(const Qt of st){const[si,Bt]=Ve[Qt],Ct=y.bC(Bt),ni=y.bC(typeof si=="string"?[si,["accumulated"],["get",Qt]]:si);he[Qt]=Ct.value,Ge[Qt]=ni.value}return ze.map=Qt=>{Ke.properties=Qt;const si={};for(const Bt of st)si[Bt]=he[Bt].evaluate(at,Ke);return si},ze.reduce=(Qt,si)=>{Ke.properties=si;for(const Bt of st)at.accumulated=Qt[Bt],Qt[Bt]=Ge[Bt].evaluate(at,Ke)},ze})(te)).load((yield this._pendingData).features):(ve=yield this._pendingData,new Wi(ve,te.geojsonVtOptions)),this.loaded={};const je={};if(oe){const ze=oe.finish();ze&&(je.resourceTiming={},je.resourceTiming[te.source]=JSON.parse(JSON.stringify(ze)))}return je}catch(je){if(delete this._pendingRequest,y.bB(je))return{abandoned:!0};throw je}var ve}))}getData(){return y._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(te){const G=this.loaded;return G&&G[te.uid]?super.reloadTile(te):this.loadTile(te)}loadAndProcessGeoJSON(te,G){return y._(this,void 0,void 0,(function*(){let oe=yield this.loadGeoJSON(te,G);if(delete this._pendingRequest,typeof oe!="object")throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(J(oe,!0),te.filter){const ve=y.bC(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ve.result==="error")throw new Error(ve.value.map((ze=>`${ze.key}: ${ze.message}`)).join(", "));oe={type:"FeatureCollection",features:oe.features.filter((ze=>ve.value.evaluate({zoom:0},ze)))}}return oe}))}loadGeoJSON(te,G){return y._(this,void 0,void 0,(function*(){const{promoteId:oe}=te;if(te.request){const ve=yield y.h(te.request,G);return this._dataUpdateable=xs(ve.data,oe)?Pn(ve.data,oe):void 0,ve.data}if(typeof te.data=="string")try{const ve=JSON.parse(te.data);return this._dataUpdateable=xs(ve,oe)?Pn(ve,oe):void 0,ve}catch{throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`)}if(!te.dataDiff)throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${te.source}`);return(function(ve,je,ze){var Ve,he,Ge,at;if(je.removeAll&&ve.clear(),je.remove)for(const Ke of je.remove)ve.delete(Ke);if(je.add)for(const Ke of je.add){const st=hi(Ke,ze);st!=null&&ve.set(st,Ke)}if(je.update)for(const Ke of je.update){let st=ve.get(Ke.id);if(st==null)continue;const Qt=!Ke.removeAllProperties&&(((Ve=Ke.removeProperties)===null||Ve===void 0?void 0:Ve.length)>0||((he=Ke.addOrUpdateProperties)===null||he===void 0?void 0:he.length)>0);if((Ke.newGeometry||Ke.removeAllProperties||Qt)&&(st=Object.assign({},st),ve.set(Ke.id,st),Qt&&(st.properties=Object.assign({},st.properties))),Ke.newGeometry&&(st.geometry=Ke.newGeometry),Ke.removeAllProperties)st.properties={};else if(((Ge=Ke.removeProperties)===null||Ge===void 0?void 0:Ge.length)>0)for(const si of Ke.removeProperties)Object.prototype.hasOwnProperty.call(st.properties,si)&&delete st.properties[si];if(((at=Ke.addOrUpdateProperties)===null||at===void 0?void 0:at.length)>0)for(const{key:si,value:Bt}of Ke.addOrUpdateProperties)st.properties[si]=Bt}})(this._dataUpdateable,te.dataDiff,oe),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(te){return y._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(te){return this._geoJSONIndex.getClusterExpansionZoom(te.clusterId)}getClusterChildren(te){return this._geoJSONIndex.getChildren(te.clusterId)}getClusterLeaves(te){return this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset)}}class rn{constructor(te){this.self=te,this.actor=new y.F(te),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(G,oe)=>{if(this.externalWorkerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.externalWorkerSourceTypes[G]=oe},this.self.addProtocol=y.bi,this.self.removeProtocol=y.bj,this.self.registerRTLTextPlugin=G=>{if(y.bD.isParsed())throw new Error("RTL text plugin already registered.");y.bD.setMethods(G)},this.actor.registerMessageHandler("LDT",((G,oe)=>this._getDEMWorkerSource(G,oe.source).loadTile(oe))),this.actor.registerMessageHandler("RDT",((G,oe)=>y._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(G,oe.source).removeTile(oe)})))),this.actor.registerMessageHandler("GCEZ",((G,oe)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(G,oe.type,oe.source).getClusterExpansionZoom(oe)})))),this.actor.registerMessageHandler("GCC",((G,oe)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(G,oe.type,oe.source).getClusterChildren(oe)})))),this.actor.registerMessageHandler("GCL",((G,oe)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(G,oe.type,oe.source).getClusterLeaves(oe)})))),this.actor.registerMessageHandler("LD",((G,oe)=>this._getWorkerSource(G,oe.type,oe.source).loadData(oe))),this.actor.registerMessageHandler("GD",((G,oe)=>this._getWorkerSource(G,oe.type,oe.source).getData())),this.actor.registerMessageHandler("LT",((G,oe)=>this._getWorkerSource(G,oe.type,oe.source).loadTile(oe))),this.actor.registerMessageHandler("RT",((G,oe)=>this._getWorkerSource(G,oe.type,oe.source).reloadTile(oe))),this.actor.registerMessageHandler("AT",((G,oe)=>this._getWorkerSource(G,oe.type,oe.source).abortTile(oe))),this.actor.registerMessageHandler("RMT",((G,oe)=>this._getWorkerSource(G,oe.type,oe.source).removeTile(oe))),this.actor.registerMessageHandler("RS",((G,oe)=>y._(this,void 0,void 0,(function*(){if(!this.workerSources[G]||!this.workerSources[G][oe.type]||!this.workerSources[G][oe.type][oe.source])return;const ve=this.workerSources[G][oe.type][oe.source];delete this.workerSources[G][oe.type][oe.source],ve.removeSource!==void 0&&ve.removeSource(oe)})))),this.actor.registerMessageHandler("RM",(G=>y._(this,void 0,void 0,(function*(){delete this.layerIndexes[G],delete this.availableImages[G],delete this.workerSources[G],delete this.demWorkerSources[G]})))),this.actor.registerMessageHandler("SR",((G,oe)=>y._(this,void 0,void 0,(function*(){this.referrer=oe})))),this.actor.registerMessageHandler("SRPS",((G,oe)=>this._syncRTLPluginState(G,oe))),this.actor.registerMessageHandler("IS",((G,oe)=>y._(this,void 0,void 0,(function*(){this.self.importScripts(oe)})))),this.actor.registerMessageHandler("SI",((G,oe)=>this._setImages(G,oe))),this.actor.registerMessageHandler("UL",((G,oe)=>y._(this,void 0,void 0,(function*(){this._getLayerIndex(G).update(oe.layers,oe.removedIds)})))),this.actor.registerMessageHandler("SL",((G,oe)=>y._(this,void 0,void 0,(function*(){this._getLayerIndex(G).replace(oe)}))))}_setImages(te,G){return y._(this,void 0,void 0,(function*(){this.availableImages[te]=G;for(const oe in this.workerSources[te]){const ve=this.workerSources[te][oe];for(const je in ve)ve[je].availableImages=G}}))}_syncRTLPluginState(te,G){return y._(this,void 0,void 0,(function*(){if(y.bD.isParsed())return y.bD.getState();if(G.pluginStatus!=="loading")return y.bD.setState(G),G;const oe=G.pluginURL;if(this.self.importScripts(oe),y.bD.isParsed()){const ve={pluginStatus:"loaded",pluginURL:oe};return y.bD.setState(ve),ve}throw y.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${oe}`)}))}_getAvailableImages(te){let G=this.availableImages[te];return G||(G=[]),G}_getLayerIndex(te){let G=this.layerIndexes[te];return G||(G=this.layerIndexes[te]=new d),G}_getWorkerSource(te,G,oe){if(this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][G]||(this.workerSources[te][G]={}),!this.workerSources[te][G][oe]){const ve={sendAsync:(je,ze)=>(je.targetMapId=te,this.actor.sendAsync(je,ze))};switch(G){case"vector":this.workerSources[te][G][oe]=new N(ve,this._getLayerIndex(te),this._getAvailableImages(te));break;case"geojson":this.workerSources[te][G][oe]=new Zn(ve,this._getLayerIndex(te),this._getAvailableImages(te));break;default:this.workerSources[te][G][oe]=new this.externalWorkerSourceTypes[G](ve,this._getLayerIndex(te),this._getAvailableImages(te))}}return this.workerSources[te][G][oe]}_getDEMWorkerSource(te,G){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][G]||(this.demWorkerSources[te][G]=new V),this.demWorkerSources[te][G]}}return y.i(self)&&(self.worker=new rn(self)),rn})),f("index",["exports","./shared"],(function(y,d){var A="4.7.1";let j,B;const N={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:E=>new Promise(((i,h)=>{const g=requestAnimationFrame(i);E.signal.addEventListener("abort",(()=>{cancelAnimationFrame(g),h(d.c())}))})),getImageData(E,i=0){return this.getImageCanvasContext(E).getImageData(-i,-i,E.width+2*i,E.height+2*i)},getImageCanvasContext(E){const i=window.document.createElement("canvas"),h=i.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return i.width=E.width,i.height=E.height,h.drawImage(E,0,0,E.width,E.height),h},resolveURL:E=>(j||(j=document.createElement("a")),j.href=E,j.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class V{static testProp(i){if(!V.docStyle)return i[0];for(let h=0;h<i.length;h++)if(i[h]in V.docStyle)return i[h];return i[0]}static create(i,h,g){const v=window.document.createElement(i);return h!==void 0&&(v.className=h),g&&g.appendChild(v),v}static createNS(i,h){return window.document.createElementNS(i,h)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(i,h){i.style[V.transformProp]=h}static addEventListener(i,h,g,v={}){i.addEventListener(h,g,"passive"in v?v:v.capture)}static removeEventListener(i,h,g,v={}){i.removeEventListener(h,g,"passive"in v?v:v.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",V.suppressClickInternal,!0)}),0)}static getScale(i){const h=i.getBoundingClientRect();return{x:h.width/i.offsetWidth||1,y:h.height/i.offsetHeight||1,boundingClientRect:h}}static getPoint(i,h,g){const v=h.boundingClientRect;return new d.P((g.clientX-v.left)/h.x-i.clientLeft,(g.clientY-v.top)/h.y-i.clientTop)}static mousePos(i,h){const g=V.getScale(i);return V.getPoint(i,g,h)}static touchPos(i,h){const g=[],v=V.getScale(i);for(let T=0;T<h.length;T++)g.push(V.getPoint(i,v,h[T]));return g}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);const Q={supported:!1,testSupport:function(E){!ye&&J&&(re?ge(E):ne=E)}};let ne,J,ye=!1,re=!1;function ge(E){const i=E.createTexture();E.bindTexture(E.TEXTURE_2D,i);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,J),E.isContextLost())return;Q.supported=!0}catch{}E.deleteTexture(i),ye=!0}var le;typeof document<"u"&&(J=document.createElement("img"),J.onload=()=>{ne&&ge(ne),ne=null,re=!0},J.onerror=()=>{ye=!0,ne=null},J.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(E){let i,h,g,v;E.resetRequestQueue=()=>{i=[],h=0,g=0,v={}},E.addThrottleControl=U=>{const H=g++;return v[H]=U,H},E.removeThrottleControl=U=>{delete v[U],z()},E.getImage=(U,H,X=!0)=>new Promise(((K,ae)=>{Q.supported&&(U.headers||(U.headers={}),U.headers.accept="image/webp,*/*"),d.e(U,{type:"image"}),i.push({abortController:H,requestParameters:U,supportImageRefresh:X,state:"queued",onError:fe=>{ae(fe)},onSuccess:fe=>{K(fe)}}),z()}));const T=U=>d._(this,void 0,void 0,(function*(){U.state="running";const{requestParameters:H,supportImageRefresh:X,onError:K,onSuccess:ae,abortController:fe}=U,_e=X===!1&&!d.i(self)&&!d.g(H.url)&&(!H.headers||Object.keys(H.headers).reduce(((Ie,Re)=>Ie&&Re==="accept"),!0));h++;const Ee=_e?O(H,fe):d.m(H,fe);try{const Ie=yield Ee;delete U.abortController,U.state="completed",Ie.data instanceof HTMLImageElement||d.b(Ie.data)?ae(Ie):Ie.data&&ae({data:yield(Pe=Ie.data,typeof createImageBitmap=="function"?d.d(Pe):d.f(Pe)),cacheControl:Ie.cacheControl,expires:Ie.expires})}catch(Ie){delete U.abortController,K(Ie)}finally{h--,z()}var Pe})),z=()=>{const U=(()=>{for(const H of Object.keys(v))if(v[H]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let H=h;H<U&&i.length>0;H++){const X=i.shift();X.abortController.signal.aborted?H--:T(X)}},O=(U,H)=>new Promise(((X,K)=>{const ae=new Image,fe=U.url,_e=U.credentials;_e&&_e==="include"?ae.crossOrigin="use-credentials":(_e&&_e==="same-origin"||!d.s(fe))&&(ae.crossOrigin="anonymous"),H.signal.addEventListener("abort",(()=>{ae.src="",K(d.c())})),ae.fetchPriority="high",ae.onload=()=>{ae.onerror=ae.onload=null,X({data:ae})},ae.onerror=()=>{ae.onerror=ae.onload=null,H.signal.aborted||K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ae.src=fe}))})(le||(le={})),le.resetRequestQueue();class me{constructor(i){this._transformRequestFn=i}transformRequest(i,h){return this._transformRequestFn&&this._transformRequestFn(i,h)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function be(E){var i=new d.A(3);return i[0]=E[0],i[1]=E[1],i[2]=E[2],i}var ke,Me=function(E,i,h){return E[0]=i[0]-h[0],E[1]=i[1]-h[1],E[2]=i[2]-h[2],E};ke=new d.A(3),d.A!=Float32Array&&(ke[0]=0,ke[1]=0,ke[2]=0);var Ue=function(E){var i=E[0],h=E[1];return i*i+h*h};function Fe(E){const i=[];if(typeof E=="string")i.push({id:"default",url:E});else if(E&&E.length>0){const h=[];for(const{id:g,url:v}of E){const T=`${g}${v}`;h.indexOf(T)===-1&&(h.push(T),i.push({id:g,url:v}))}}return i}function He(E,i,h){const g=E.split("?");return g[0]+=`${i}${h}`,g.join("?")}(function(){var E=new d.A(2);d.A!=Float32Array&&(E[0]=0,E[1]=0)})();class lt{constructor(i,h,g,v){this.context=i,this.format=g,this.texture=i.gl.createTexture(),this.update(h,v)}update(i,h,g){const{width:v,height:T}=i,z=!(this.size&&this.size[0]===v&&this.size[1]===T||g),{context:O}=this,{gl:U}=O;if(this.useMipmap=!!(h&&h.useMipmap),U.bindTexture(U.TEXTURE_2D,this.texture),O.pixelStoreUnpackFlipY.set(!1),O.pixelStoreUnpack.set(1),O.pixelStoreUnpackPremultiplyAlpha.set(this.format===U.RGBA&&(!h||h.premultiply!==!1)),z)this.size=[v,T],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||d.b(i)?U.texImage2D(U.TEXTURE_2D,0,this.format,this.format,U.UNSIGNED_BYTE,i):U.texImage2D(U.TEXTURE_2D,0,this.format,v,T,0,this.format,U.UNSIGNED_BYTE,i.data);else{const{x:H,y:X}=g||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||d.b(i)?U.texSubImage2D(U.TEXTURE_2D,0,H,X,U.RGBA,U.UNSIGNED_BYTE,i):U.texSubImage2D(U.TEXTURE_2D,0,H,X,v,T,U.RGBA,U.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&U.generateMipmap(U.TEXTURE_2D)}bind(i,h,g){const{context:v}=this,{gl:T}=v;T.bindTexture(T.TEXTURE_2D,this.texture),g!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=T.LINEAR),i!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,i),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,g||i),this.filter=i),h!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,h),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function Ye(E){const{userImage:i}=E;return!!(i&&i.render&&i.render())&&(E.data.replace(new Uint8Array(i.data.buffer)),!0)}class Mt extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:h,promiseResolve:g}of this.requestors)g(this._getImagesForIds(h));this.requestors=[]}}getImage(i){const h=this.images[i];if(h&&!h.data&&h.spriteData){const g=h.spriteData;h.data=new d.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),h.spriteData=null}return h}addImage(i,h){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,h)&&(this.images[i]=h)}_validate(i,h){let g=!0;const v=h.data||h.spriteData;return this._validateStretch(h.stretchX,v&&v.width)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,v&&v.height)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "content" value`))),g=!1),g}_validateStretch(i,h){if(!i)return!0;let g=0;for(const v of i){if(v[0]<g||v[1]<v[0]||h<v[1])return!1;g=v[1]}return!0}_validateContent(i,h){if(!i)return!0;if(i.length!==4)return!1;const g=h.spriteData,v=g&&g.width||h.data.width,T=g&&g.height||h.data.height;return!(i[0]<0||v<i[0]||i[1]<0||T<i[1]||i[2]<0||v<i[2]||i[3]<0||T<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,h,g=!0){const v=this.getImage(i);if(g&&(v.data.width!==h.data.width||v.data.height!==h.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${h.data.width}x${h.data.height}).`);h.version=v.version+1,this.images[i]=h,this.updatedImages[i]=!0}removeImage(i){const h=this.images[i];delete this.images[i],delete this.patterns[i],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise(((h,g)=>{let v=!0;if(!this.isLoaded())for(const T of i)this.images[T]||(v=!1);this.isLoaded()||v?h(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:h})}))}_getImagesForIds(i){const h={};for(const g of i){let v=this.getImage(g);v||(this.fire(new d.k("styleimagemissing",{id:g})),v=this.getImage(g)),v?h[g]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:d.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return h}getPixelSize(){const{width:i,height:h}=this.atlasImage;return{width:i,height:h}}getPattern(i){const h=this.patterns[i],g=this.getImage(i);if(!g)return null;if(h&&h.position.version===g.version)return h.position;if(h)h.position.version=g.version;else{const v={w:g.data.width+2,h:g.data.height+2,x:0,y:0},T=new d.I(v,g);this.patterns[i]={bin:v,position:T}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const h=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new lt(i,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const T in this.patterns)i.push(this.patterns[T].bin);const{w:h,h:g}=d.p(i),v=this.atlasImage;v.resize({width:h||1,height:g||1});for(const T in this.patterns){const{bin:z}=this.patterns[T],O=z.x+1,U=z.y+1,H=this.getImage(T).data,X=H.width,K=H.height;d.R.copy(H,v,{x:0,y:0},{x:O,y:U},{width:X,height:K}),d.R.copy(H,v,{x:0,y:K-1},{x:O,y:U-1},{width:X,height:1}),d.R.copy(H,v,{x:0,y:0},{x:O,y:U+K},{width:X,height:1}),d.R.copy(H,v,{x:X-1,y:0},{x:O-1,y:U},{width:1,height:K}),d.R.copy(H,v,{x:0,y:0},{x:O+X,y:U},{width:1,height:K})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const h of i){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const g=this.getImage(h);g||d.w(`Image with ID: "${h}" was not found`),Ye(g)&&this.updateImage(h,g)}}}const et=1e20;function Tt(E,i,h,g,v,T,z,O,U){for(let H=i;H<i+g;H++)Be(E,h*T+H,T,v,z,O,U);for(let H=h;H<h+v;H++)Be(E,H*T+i,1,g,z,O,U)}function Be(E,i,h,g,v,T,z){T[0]=0,z[0]=-et,z[1]=et,v[0]=E[i];for(let O=1,U=0,H=0;O<g;O++){v[O]=E[i+O*h];const X=O*O;do{const K=T[U];H=(v[O]-v[K]+X-K*K)/(O-K)/2}while(H<=z[U]&&--U>-1);U++,T[U]=O,z[U]=H,z[U+1]=et}for(let O=0,U=0;O<g;O++){for(;z[U+1]<O;)U++;const H=T[U],X=O-H;E[i+O*h]=v[H]+X*X}}class ct{constructor(i,h){this.requestManager=i,this.localIdeographFontFamily=h,this.entries={}}setURL(i){this.url=i}getGlyphs(i){return d._(this,void 0,void 0,(function*(){const h=[];for(const T in i)for(const z of i[T])h.push(this._getAndCacheGlyphsPromise(T,z));const g=yield Promise.all(h),v={};for(const{stack:T,id:z,glyph:O}of g)v[T]||(v[T]={}),v[T][z]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};return v}))}_getAndCacheGlyphsPromise(i,h){return d._(this,void 0,void 0,(function*(){let g=this.entries[i];g||(g=this.entries[i]={glyphs:{},requests:{},ranges:{}});let v=g.glyphs[h];if(v!==void 0)return{stack:i,id:h,glyph:v};if(v=this._tinySDF(g,i,h),v)return g.glyphs[h]=v,{stack:i,id:h,glyph:v};const T=Math.floor(h/256);if(256*T>65535)throw new Error("glyphs > 65535 not supported");if(g.ranges[T])return{stack:i,id:h,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!g.requests[T]){const O=ct.loadGlyphRange(i,T,this.url,this.requestManager);g.requests[T]=O}const z=yield g.requests[T];for(const O in z)this._doesCharSupportLocalGlyph(+O)||(g.glyphs[+O]=z[+O]);return g.ranges[T]=!0,{stack:i,id:h,glyph:z[h]||null}}))}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(i))}_tinySDF(i,h,g){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(g))return;let T=i.tinySDF;if(!T){let O="400";/bold/i.test(h)?O="900":/medium/i.test(h)?O="500":/light/i.test(h)&&(O="200"),T=i.tinySDF=new ct.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:v,fontWeight:O})}const z=T.draw(String.fromCharCode(g));return{id:g,bitmap:new d.o({width:z.width||60,height:z.height||60},z.data),metrics:{width:z.glyphWidth/2||24,height:z.glyphHeight/2||24,left:z.glyphLeft/2+.5||0,top:z.glyphTop/2-27.5||-8,advance:z.glyphAdvance/2||24,isDoubleResolution:!0}}}}ct.loadGlyphRange=function(E,i,h,g){return d._(this,void 0,void 0,(function*(){const v=256*i,T=v+255,z=g.transformRequest(h.replace("{fontstack}",E).replace("{range}",`${v}-${T}`),"Glyphs"),O=yield d.l(z,new AbortController);if(!O||!O.data)throw new Error(`Could not load glyph range. range: ${i}, ${v}-${T}`);const U={};for(const H of d.n(O.data))U[H.id]=H;return U}))},ct.TinySDF=class{constructor({fontSize:E=24,buffer:i=3,radius:h=8,cutoff:g=.25,fontFamily:v="sans-serif",fontWeight:T="normal",fontStyle:z="normal"}={}){this.buffer=i,this.cutoff=g,this.radius=h;const O=this.size=E+4*i,U=this._createCanvas(O),H=this.ctx=U.getContext("2d",{willReadFrequently:!0});H.font=`${z} ${T} ${E}px ${v}`,H.textBaseline="alphabetic",H.textAlign="left",H.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Uint16Array(O)}_createCanvas(E){const i=document.createElement("canvas");return i.width=i.height=E,i}draw(E){const{width:i,actualBoundingBoxAscent:h,actualBoundingBoxDescent:g,actualBoundingBoxLeft:v,actualBoundingBoxRight:T}=this.ctx.measureText(E),z=Math.ceil(h),O=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(T-v))),U=Math.min(this.size-this.buffer,z+Math.ceil(g)),H=O+2*this.buffer,X=U+2*this.buffer,K=Math.max(H*X,0),ae=new Uint8ClampedArray(K),fe={data:ae,width:H,height:X,glyphWidth:O,glyphHeight:U,glyphTop:z,glyphLeft:0,glyphAdvance:i};if(O===0||U===0)return fe;const{ctx:_e,buffer:Ee,gridInner:Pe,gridOuter:Ie}=this;_e.clearRect(Ee,Ee,O,U),_e.fillText(E,Ee,Ee+z);const Re=_e.getImageData(Ee,Ee,O,U);Ie.fill(et,0,K),Pe.fill(0,0,K);for(let Se=0;Se<U;Se++)for(let $e=0;$e<O;$e++){const Ze=Re.data[4*(Se*O+$e)+3]/255;if(Ze===0)continue;const nt=(Se+Ee)*H+$e+Ee;if(Ze===1)Ie[nt]=0,Pe[nt]=et;else{const bt=.5-Ze;Ie[nt]=bt>0?bt*bt:0,Pe[nt]=bt<0?bt*bt:0}}Tt(Ie,0,0,H,X,H,this.f,this.v,this.z),Tt(Pe,Ee,Ee,O,U,H,this.f,this.v,this.z);for(let Se=0;Se<K;Se++){const $e=Math.sqrt(Ie[Se])-Math.sqrt(Pe[Se]);ae[Se]=Math.round(255-255*($e/this.radius+this.cutoff))}return fe}};class ut{constructor(){this.specification=d.v.light.position}possiblyEvaluate(i,h){return d.x(i.expression.evaluate(h))}interpolate(i,h,g){return{x:d.y.number(i.x,h.x,g),y:d.y.number(i.y,h.y,g),z:d.y.number(i.z,h.z,g)}}}let Et;class ot extends d.E{constructor(i){super(),Et=Et||new d.q({anchor:new d.D(d.v.light.anchor),position:new ut,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(Et),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,h={}){if(!this._validate(d.r,i,h))for(const g in i){const v=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,g){return(!g||g.validate!==!1)&&d.t(this,i.call(d.u,{value:h,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const xe=new d.q({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class Le extends d.E{constructor(i){super(),this._transitionable=new d.T(xe),this.setSky(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.z(0))}setSky(i,h={}){if(!this._validate(d.B,i,h)){i||(i={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in i){const v=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,g={}){return g?.validate!==!1&&d.t(this,i.call(d.u,d.e({value:h,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(i){return i<60?0:i<70?(i-60)/10:1}}class tt{constructor(i,h){this.width=i,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,h){const g=i.join(",")+String(h);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(i,h)),this.dashEntry[g]}getDashRanges(i,h,g){const v=[];let T=i.length%2==1?-i[i.length-1]*g:0,z=i[0]*g,O=!0;v.push({left:T,right:z,isDash:O,zeroLength:i[0]===0});let U=i[0];for(let H=1;H<i.length;H++){O=!O;const X=i[H];T=U*g,U+=X,z=U*g,v.push({left:T,right:z,isDash:O,zeroLength:X===0})}return v}addRoundDash(i,h,g){const v=h/2;for(let T=-g;T<=g;T++){const z=this.width*(this.nextRow+g+T);let O=0,U=i[O];for(let H=0;H<this.width;H++){H/U.right>1&&(U=i[++O]);const X=Math.abs(H-U.left),K=Math.abs(H-U.right),ae=Math.min(X,K);let fe;const _e=T/g*(v+1);if(U.isDash){const Ee=v-Math.abs(_e);fe=Math.sqrt(ae*ae+Ee*Ee)}else fe=v-Math.sqrt(ae*ae+_e*_e);this.data[z+H]=Math.max(0,Math.min(255,fe+128))}}}addRegularDash(i){for(let O=i.length-1;O>=0;--O){const U=i[O],H=i[O+1];U.zeroLength?i.splice(O,1):H&&H.isDash===U.isDash&&(H.left=U.left,i.splice(O,1))}const h=i[0],g=i[i.length-1];h.isDash===g.isDash&&(h.left=g.left-this.width,g.right=h.right+this.width);const v=this.width*this.nextRow;let T=0,z=i[T];for(let O=0;O<this.width;O++){O/z.right>1&&(z=i[++T]);const U=Math.abs(O-z.left),H=Math.abs(O-z.right),X=Math.min(U,H);this.data[v+O]=Math.max(0,Math.min(255,(z.isDash?X:-X)+128))}}addDash(i,h){const g=h?7:0,v=2*g+1;if(this.nextRow+v>this.height)return d.w("LineAtlas out of space"),null;let T=0;for(let O=0;O<i.length;O++)T+=i[O];if(T!==0){const O=this.width/T,U=this.getDashRanges(i,this.width,O);h?this.addRoundDash(U,O,g):this.addRegularDash(U)}const z={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:T};return this.nextRow+=v,this.dirty=!0,z}bind(i){const h=i.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}const rt="maplibre_preloaded_worker_pool";class gt{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<gt.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach((h=>{h.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[rt]}numActive(){return Object.keys(this.active).length}}const Pt=Math.floor(N.hardwareConcurrency/2);let Ot,ei;function gi(){return Ot||(Ot=new gt),Ot}gt.workerCount=d.C(globalThis)?Math.max(Math.min(Pt,3),1):1;class Vi{constructor(i,h){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=h;const g=this.workerPool.acquire(h);for(let v=0;v<g.length;v++){const T=new d.F(g[v],h);T.name=`Worker ${v}`,this.actors.push(T)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,h){const g=[];for(const v of this.actors)g.push(v.sendAsync({type:i,data:h}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach((h=>{h.remove()})),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,h){for(const g of this.actors)g.registerMessageHandler(i,h)}}function pi(){return ei||(ei=new Vi(gi(),d.G),ei.registerMessageHandler("GR",((E,i,h)=>d.m(i,h)))),ei}function zi(E,i){const h=d.H();return d.J(h,h,[1,1,0]),d.K(h,h,[.5*E.width,.5*E.height,1]),d.L(h,h,E.calculatePosMatrix(i.toUnwrapped()))}function gn(E,i,h,g,v,T){const z=(function(K,ae,fe){if(K)for(const _e of K){const Ee=ae[_e];if(Ee&&Ee.source===fe&&Ee.type==="fill-extrusion")return!0}else for(const _e in ae){const Ee=ae[_e];if(Ee.source===fe&&Ee.type==="fill-extrusion")return!0}return!1})(v&&v.layers,i,E.id),O=T.maxPitchScaleFactor(),U=E.tilesIn(g,O,z);U.sort(ln);const H=[];for(const K of U)H.push({wrappedTileID:K.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(i,h,E._state,K.queryGeometry,K.cameraQueryGeometry,K.scale,v,T,O,zi(E.transform,K.tileID))});const X=(function(K){const ae={},fe={};for(const _e of K){const Ee=_e.queryResults,Pe=_e.wrappedTileID,Ie=fe[Pe]=fe[Pe]||{};for(const Re in Ee){const Se=Ee[Re],$e=Ie[Re]=Ie[Re]||{},Ze=ae[Re]=ae[Re]||[];for(const nt of Se)$e[nt.featureIndex]||($e[nt.featureIndex]=!0,Ze.push(nt))}}return ae})(H);for(const K in X)X[K].forEach((ae=>{const fe=ae.feature,_e=E.getFeatureState(fe.layer["source-layer"],fe.id);fe.source=fe.layer.source,fe.layer["source-layer"]&&(fe.sourceLayer=fe.layer["source-layer"]),fe.state=_e}));return X}function ln(E,i){const h=E.tileID,g=i.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}function $n(E,i,h){return d._(this,void 0,void 0,(function*(){let g=E;if(E.url?g=(yield d.h(i.transformRequest(E.url,"Source"),h)).data:yield N.frameAsync(h),!g)return null;const v=d.M(d.e(g,E),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(v.vectorLayerIds=g.vector_layers.map((T=>T.id))),v}))}class it{constructor(i,h){i&&(h?this.setSouthWest(i).setNorthEast(h):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof d.N?new d.N(i.lng,i.lat):d.N.convert(i),this}setSouthWest(i){return this._sw=i instanceof d.N?new d.N(i.lng,i.lat):d.N.convert(i),this}extend(i){const h=this._sw,g=this._ne;let v,T;if(i instanceof d.N)v=i,T=i;else{if(!(i instanceof it))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(it.convert(i)):this.extend(d.N.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(d.N.convert(i)):this;if(v=i._sw,T=i._ne,!v||!T)return this}return h||g?(h.lng=Math.min(v.lng,h.lng),h.lat=Math.min(v.lat,h.lat),g.lng=Math.max(T.lng,g.lng),g.lat=Math.max(T.lat,g.lat)):(this._sw=new d.N(v.lng,v.lat),this._ne=new d.N(T.lng,T.lat)),this}getCenter(){return new d.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.N(this.getWest(),this.getNorth())}getSouthEast(){return new d.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:h,lat:g}=d.N.convert(i);let v=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&v}static convert(i){return i instanceof it?i:i&&new it(i)}static fromLngLat(i,h=0){const g=360*h/40075017,v=g/Math.cos(Math.PI/180*i.lat);return new it(new d.N(i.lng-v,i.lat-g),new d.N(i.lng+v,i.lat+g))}adjustAntiMeridian(){const i=new d.N(this._sw.lng,this._sw.lat),h=new d.N(this._ne.lng,this._ne.lat);return new it(i,i.lng>h.lng?new d.N(h.lng+360,h.lat):h)}}class Cn{constructor(i,h,g){this.bounds=it.convert(this.validateBounds(i)),this.minzoom=h||0,this.maxzoom=g||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const h=Math.pow(2,i.z),g=Math.floor(d.O(this.bounds.getWest())*h),v=Math.floor(d.Q(this.bounds.getNorth())*h),T=Math.ceil(d.O(this.bounds.getEast())*h),z=Math.ceil(d.Q(this.bounds.getSouth())*h);return i.x>=g&&i.x<T&&i.y>=v&&i.y<z}}class Mn extends d.E{constructor(i,h,g,v){if(super(),this.id=i,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.M(h,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield $n(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(d.e(this,i),i.bounds&&(this.tileBounds=new Cn(i.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new d.j(i))}}))}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}setUrl(i){return this.setSourceProperty((()=>{this.url=i,this._options.url=i})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(h,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};g.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise(((T,z)=>{i.reloadPromise={resolve:T,reject:z}}))}else i.actor=this.dispatcher.getActor(),v="LT";i.abortController=new AbortController;try{const T=yield i.actor.sendAsync({type:v,data:g},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,T)}catch(T){if(delete i.abortController,i.aborted)return;if(T&&T.status!==404)throw T;this._afterTileLoadWorkerResponse(i,null)}}))}_afterTileLoadWorkerResponse(i,h){if(h&&h.resourceTiming&&(i.resourceTiming=h.resourceTiming),h&&this.map._refreshExpiredTiles&&i.setExpiryData(h),i.loadVectorData(h,this.map.painter),i.reloadPromise){const g=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(g.resolve).catch(g.reject)}}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Si extends d.E{constructor(i,h,g,v){super(),this.id=i,this.dispatcher=g,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},h),d.e(this,d.M(h,["url","scheme","tileSize"]))}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield $n(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(d.e(this,i),i.bounds&&(this.tileBounds=new Cn(i.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new d.j(i))}}))}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}setUrl(i){return this.setSourceProperty((()=>{this.url=i,this._options.url=i})),this}serialize(){return d.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const g=yield le.getImage(this.map._requestManager.transformRequest(h,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&i.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const v=this.map.painter.context,T=v.gl,z=g.data;i.texture=this.map.painter.getTileTexture(z.width),i.texture?i.texture.update(z,{useMipmap:!0}):(i.texture=new lt(v,z,T.RGBA,{useMipmap:!0}),i.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST)),i.state="loaded"}}catch(g){if(delete i.abortController,i.aborted)i.state="unloaded";else if(g)throw i.state="errored",g}}))}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)}))}hasTransition(){return!1}}class mi extends Si{constructor(i,h,g,v){super(i,h,g,v),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox",this.redFactor=h.redFactor,this.greenFactor=h.greenFactor,this.blueFactor=h.blueFactor,this.baseShift=h.baseShift}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(h,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const v=yield le.getImage(g,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(v&&v.data){const T=v.data;this.map._refreshExpiredTiles&&v.cacheControl&&v.expires&&i.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const z=d.b(T)&&d.U()?T:yield this.readImageNow(T),O={type:this.type,uid:i.uid,source:this.id,rawImageData:z,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const U=yield i.actor.sendAsync({type:"LDT",data:O});i.dem=U,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(v){if(delete i.abortController,i.aborted)i.state="unloaded";else if(v)throw i.state="errored",v}}))}readImageNow(i){return d._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&d.V()){const h=i.width+2,g=i.height+2;try{return new d.R({width:h,height:g},yield d.W(i,-1,-1,h,g))}catch{}}return N.getImageData(i,1)}))}_getNeighboringTiles(i){const h=i.canonical,g=Math.pow(2,h.z),v=(h.x-1+g)%g,T=h.x===0?i.wrap-1:i.wrap,z=(h.x+1+g)%g,O=h.x+1===g?i.wrap+1:i.wrap,U={};return U[new d.S(i.overscaledZ,T,h.z,v,h.y).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,z,h.y).key]={backfilled:!1},h.y>0&&(U[new d.S(i.overscaledZ,T,h.z,v,h.y-1).key]={backfilled:!1},U[new d.S(i.overscaledZ,i.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,z,h.y-1).key]={backfilled:!1}),h.y+1<g&&(U[new d.S(i.overscaledZ,T,h.z,v,h.y+1).key]={backfilled:!1},U[new d.S(i.overscaledZ,i.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,z,h.y+1).key]={backfilled:!1}),U}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))}))}}class En extends d.E{constructor(i,h,g,v){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(v),this._data=h.data,this._options=d.e({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const T=d.X/this.tileSize;h.clusterMaxZoom!==void 0&&this.maxzoom<=h.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${h.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*T,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*T,extent:d.X,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:d.X,radius:(h.clusterRadius||50)*T,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return d._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}getData(){return d._(this,void 0,void 0,(function*(){const i=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})}))}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,h,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:h,offset:g}})}_updateWorkerData(i){return d._(this,void 0,void 0,(function*(){const h=d.e({type:this.type},this.workerOptions);i?h.dataDiff=i:typeof this._data=="string"?(h.request=this.map._requestManager.transformRequest(N.resolveURL(this._data),"Source"),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.k("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:h});if(this._pendingLoads--,this._removed||g.abandoned)return void this.fire(new d.k("dataabort",{dataType:"source"}));let v=null;g.resourceTiming&&g.resourceTiming[this.id]&&(v=g.resourceTiming[this.id].slice(0));const T={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&d.e(T,{resourceTiming:v}),this.fire(new d.k("data",Object.assign(Object.assign({},T),{sourceDataType:"metadata"}))),this.fire(new d.k("data",Object.assign(Object.assign({},T),{sourceDataType:"content"})))}catch(g){if(this._pendingLoads--,this._removed)return void this.fire(new d.k("dataabort",{dataType:"source"}));this.fire(new d.j(g))}}))}loaded(){return this._pendingLoads===0}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.actor?"RT":"LT";i.actor=this.actor;const g={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.abortController=new AbortController;const v=yield this.actor.sendAsync({type:h,data:g},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(v,this.map.painter,h==="RT")}))}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Rn=d.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class is extends d.E{constructor(i,h,g,v){super(),this.id=i,this.dispatcher=g,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h}load(i){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const h=yield le.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,h&&h.data&&(this.image=h.data,i&&(this.coordinates=i),this._finishLoading())}catch(h){this._request=null,this._loaded=!0,this.fire(new d.j(h))}}))}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const h=i.map(d.Z.fromLngLat);this.tileID=(function(v){let T=1/0,z=1/0,O=-1/0,U=-1/0;for(const ae of v)T=Math.min(T,ae.x),z=Math.min(z,ae.y),O=Math.max(O,ae.x),U=Math.max(U,ae.y);const H=Math.max(O-T,U-z),X=Math.max(0,Math.floor(-Math.log(H)/Math.LN2)),K=Math.pow(2,X);return new d.a1(X,Math.floor((T+O)/2*K),Math.floor((z+U)/2*K))})(h),this.minzoom=this.maxzoom=this.tileID.z;const g=h.map((v=>this.tileID.getTilePoint(v)._round()));return this._boundsArray=new d.$,this._boundsArray.emplaceBack(g[0].x,g[0].y,0,0),this._boundsArray.emplaceBack(g[1].x,g[1].y,d.X,0),this._boundsArray.emplaceBack(g[3].x,g[3].y,0,d.X),this._boundsArray.emplaceBack(g[2].x,g[2].y,d.X,d.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,h=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Rn.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new lt(i,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));let g=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return d._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class sn extends is{constructor(i,h,g,v){super(i,h,g,v),this.roundZoom=!0,this.type="video",this.options=h}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const h of i.urls)this.urls.push(this.map._requestManager.transformRequest(h,"Source").url);try{const h=yield d.a3(this.urls);if(this._loaded=!0,!h)return;this.video=h,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(h){this.fire(new d.j(h))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const h=this.video.seekable;i<h.start(0)||i>h.end(0)?this.fire(new d.j(new d.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,h=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Rn.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new lt(i,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));let g=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Xi extends is{constructor(i,h,g,v){super(i,h,g,v),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some((T=>!Array.isArray(T)||T.length!==2||T.some((z=>typeof z!="number"))))||this.fire(new d.j(new d.a2(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.j(new d.a2(`sources.${i}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new d.j(new d.a2(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new d.j(new d.a2(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.j(new d.a2(`sources.${i}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context,g=h.gl;this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Rn.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new lt(h,this.canvas,g.RGBA,{premultiply:!0});let v=!1;for(const T in this.tiles){const z=this.tiles[T];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture,v=!0)}v&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const Gi={},ns=E=>{switch(E){case"geojson":return En;case"image":return is;case"raster":return Si;case"raster-dem":return mi;case"vector":return Mn;case"video":return sn;case"canvas":return Xi}return Gi[E]},kt="RTLPluginLoaded";class Hn extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=pi()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch((h=>{throw this.status="error",h}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return d._(this,arguments,void 0,(function*(h,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=N.resolveURL(h),!this.url)throw new Error(`requested url ${h} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return d._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.k(kt))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let yn=null;function bn(){return yn||(yn=new Hn),yn}class Un{constructor(i,h){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=d.a4(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const h=i+this.timeAdded;h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,h,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=(function(v,T){const z={};if(!T)return z;for(const O of v){const U=O.layerIds.map((H=>T.getLayer(H))).filter(Boolean);if(U.length!==0){O.layers=U,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map((H=>U.filter((X=>X.id===H))[0])));for(const H of U)z[H.id]=O}}return z})(i.buckets,h.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const T=this.buckets[v];if(T instanceof d.a6){if(this.hasSymbolBuckets=!0,!g)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const T=this.buckets[v];if(T instanceof d.a6&&T.hasRTLText){this.hasRTLText=!0,bn().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(v).queryRadius(T))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new d.a5}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const g in this.buckets){const v=this.buckets[g];v.uploadPending()&&v.upload(i)}const h=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new lt(i,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new lt(i,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,h,g,v,T,z,O,U,H,X){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:T,scale:z,tileSize:this.tileSize,pixelPosMatrix:X,transform:U,params:O,queryPadding:this.queryPadding*H},i,h,g):{}}querySourceFeatures(i,h){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const v=g.loadVTLayers(),T=h&&h.sourceLayer?h.sourceLayer:"",z=v._geojsonTileLayer||v[T];if(!z)return;const O=d.a7(h&&h.filter),{z:U,x:H,y:X}=this.tileID.canonical,K={z:U,x:H,y:X};for(let ae=0;ae<z.length;ae++){const fe=z.feature(ae);if(O.needGeometry){const Pe=d.a8(fe,!0);if(!O.filter(new d.z(this.tileID.overscaledZ),Pe,this.tileID.canonical))continue}else if(!O.filter(new d.z(this.tileID.overscaledZ),fe))continue;const _e=g.getId(fe,T),Ee=new d.a9(fe,U,H,X,_e);Ee.tile=K,i.push(Ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const h=this.expirationTime;if(i.cacheControl){const g=d.aa(i.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const g=Date.now();let v=!1;if(this.expirationTime>g)v=!1;else if(h)if(this.expirationTime<h)v=!0;else{const T=this.expirationTime-h;T?this.expirationTime=g+Math.max(T,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!h.style.hasLayer(v))continue;const T=this.buckets[v],z=T.layers[0].sourceLayer||"_geojsonTileLayer",O=g[z],U=i[z];if(!O||!U||Object.keys(U).length===0)continue;T.update(U,O,this.imageAtlas&&this.imageAtlas.patternPositions||{});const H=h&&h.style&&h.style.getLayer(v);H&&(this.queryPadding=Math.max(this.queryPadding,H.queryRadius(T)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=N.now()+i}setDependencies(i,h){const g={};for(const v of h)g[v]=!0;this.dependencies[i]=g}hasDependency(i,h){for(const g of i){const v=this.dependencies[g];if(v){for(const T of h)if(v[T])return!0}}return!1}}class jt{constructor(i,h){this.max=i,this.onRemove=h,this.reset()}reset(){for(const i in this.data)for(const h of this.data[i])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(i,h,g){const v=i.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const T={value:h,timeout:void 0};if(g!==void 0&&(T.timeout=setTimeout((()=>{this.remove(i,T)}),g)),this.data[v].push(T),this.order.push(v),this.order.length>this.max){const z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const h=this.data[i].shift();return h.timeout&&clearTimeout(h.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),h.value}getByKey(i){const h=this.data[i];return h?h[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,h){if(!this.has(i))return this;const g=i.wrapped().key,v=h===void 0?0:this.data[g].indexOf(h),T=this.data[g][v];return this.data[g].splice(v,1),T.timeout&&clearTimeout(T.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(T.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(i){const h=[];for(const g in this.data)for(const v of this.data[g])i(v.value)||h.push(v);for(const g of h)this.remove(g.value.tileID,g)}}class ii{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,h,g){const v=String(h);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][v]=this.stateChanges[i][v]||{},d.e(this.stateChanges[i][v],g),this.deletedStates[i]===null){this.deletedStates[i]={};for(const T in this.state[i])T!==v&&(this.deletedStates[i][T]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][v]===null){this.deletedStates[i][v]={};for(const T in this.state[i][v])g[T]||(this.deletedStates[i][v][T]=null)}else for(const T in g)this.deletedStates[i]&&this.deletedStates[i][v]&&this.deletedStates[i][v][T]===null&&delete this.deletedStates[i][v][T]}removeFeatureState(i,h,g){if(this.deletedStates[i]===null)return;const v=String(h);if(this.deletedStates[i]=this.deletedStates[i]||{},g&&h!==void 0)this.deletedStates[i][v]!==null&&(this.deletedStates[i][v]=this.deletedStates[i][v]||{},this.deletedStates[i][v][g]=null);else if(h!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][v])for(g in this.deletedStates[i][v]={},this.stateChanges[i][v])this.deletedStates[i][v][g]=null;else this.deletedStates[i][v]=null;else this.deletedStates[i]=null}getState(i,h){const g=String(h),v=d.e({},(this.state[i]||{})[g],(this.stateChanges[i]||{})[g]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const T=this.deletedStates[i][h];if(T===null)return{};for(const z in T)delete v[z]}return v}initializeTileState(i,h){i.setFeatureState(this.state,h)}coalesceChanges(i,h){const g={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const T={};for(const z in this.stateChanges[v])this.state[v][z]||(this.state[v][z]={}),d.e(this.state[v][z],this.stateChanges[v][z]),T[z]=this.state[v][z];g[v]=T}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const T={};if(this.deletedStates[v]===null)for(const z in this.state[v])T[z]={},this.state[v][z]={};else for(const z in this.deletedStates[v]){if(this.deletedStates[v][z]===null)this.state[v][z]={};else for(const O of Object.keys(this.deletedStates[v][z]))delete this.state[v][z][O];T[z]=this.state[v][z]}g[v]=g[v]||{},d.e(g[v],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const v in i)i[v].setFeatureState(g,h)}}class Xt extends d.E{constructor(i,h,g){super(),this.id=i,this.dispatcher=g,this.on("data",(v=>this._dataHandler(v))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((v,T,z,O)=>{const U=new(ns(T.type))(v,T,z,O);if(U.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${U.id}`);return U})(i,h,g,this),this._tiles={},this._cache=new jt(0,(v=>this._unloadTile(v))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ii,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const h=this._tiles[i];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,h,g){return d._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,h,g)}catch(v){i.state="errored",v.status!==404?this._source.fire(new d.j(v,{tile:i})):this.update(this.transform,this.terrain)}}))}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new d.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const g=this._tiles[h];g.upload(i),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((i=>i.tileID)).sort(Wi).map((i=>i.key))}getRenderableIds(i){const h=[];for(const g in this._tiles)this._isIdRenderable(g,i)&&h.push(this._tiles[g]);return i?h.sort(((g,v)=>{const T=g.tileID,z=v.tileID,O=new d.P(T.canonical.x,T.canonical.y)._rotate(this.transform.angle),U=new d.P(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return T.overscaledZ-z.overscaledZ||U.y-O.y||U.x-O.x})).map((g=>g.tileID.key)):h.map((g=>g.tileID)).sort(Wi).map((g=>g.key))}hasRenderableParent(i){const h=this.findLoadedParent(i,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(i,h){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(h||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,h){return d._(this,void 0,void 0,(function*(){const g=this._tiles[i];g&&(g.state!=="loading"&&(g.state=h),yield this._loadTile(g,i,h))}))}_tileLoaded(i,h,g){i.timeAdded=N.now(),g==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(h,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new d.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const h=this.getRenderableIds();for(let v=0;v<h.length;v++){const T=h[v];if(i.neighboringTiles&&i.neighboringTiles[T]){const z=this.getTileByID(T);g(i,z),g(z,i)}}function g(v,T){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let z=T.tileID.canonical.x-v.tileID.canonical.x;const O=T.tileID.canonical.y-v.tileID.canonical.y,U=Math.pow(2,v.tileID.canonical.z),H=T.tileID.key;z===0&&O===0||Math.abs(O)>1||(Math.abs(z)>1&&(Math.abs(z+U)===1?z+=U:Math.abs(z-U)===1&&(z-=U)),T.dem&&v.dem&&(v.dem.backfillBorder(T.dem,z,O),v.neighboringTiles&&v.neighboringTiles[H]&&(v.neighboringTiles[H].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,h,g,v){for(const T in this._tiles){let z=this._tiles[T];if(v[T]||!z.hasData()||z.tileID.overscaledZ<=h||z.tileID.overscaledZ>g)continue;let O=z.tileID;for(;z&&z.tileID.overscaledZ>h+1;){const H=z.tileID.scaledTo(z.tileID.overscaledZ-1);z=this._tiles[H.key],z&&z.hasData()&&(O=H)}let U=O;for(;U.overscaledZ>h;)if(U=U.scaledTo(U.overscaledZ-1),i[U.key]){v[O.key]=O;break}}}findLoadedParent(i,h){if(i.key in this._loadedParentTiles){const g=this._loadedParentTiles[i.key];return g&&g.tileID.overscaledZ>=h?g:null}for(let g=i.overscaledZ-1;g>=h;g--){const v=i.scaledTo(g),T=this._getLoadedTile(v);if(T)return T}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){const h=this._tiles[i.key];return h&&h.hasData()?h:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const h=Math.ceil(i.width/this._source.tileSize)+1,g=Math.ceil(i.height/this._source.tileSize)+1,v=Math.floor(h*g*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(T)}handleWrapJump(i){const h=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,h){const g={};for(const v in this._tiles){const T=this._tiles[v];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+h),g[T.tileID.key]=T}this._tiles=g;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}_updateCoveredAndRetainedTiles(i,h,g,v,T,z){const O={},U={},H=Object.keys(i),X=N.now();for(const K of H){const ae=i[K],fe=this._tiles[K];if(!fe||fe.fadeEndTime!==0&&fe.fadeEndTime<=X)continue;const _e=this.findLoadedParent(ae,h),Ee=this.findLoadedSibling(ae),Pe=_e||Ee||null;Pe&&(this._addTile(Pe.tileID),O[Pe.tileID.key]=Pe.tileID),U[K]=ae}this._retainLoadedChildren(U,v,g,i);for(const K in O)i[K]||(this._coveredTiles[K]=!0,i[K]=O[K]);if(z){const K={},ae={};for(const fe of T)this._tiles[fe.key].hasData()?K[fe.key]=fe:ae[fe.key]=fe;for(const fe in ae){const _e=ae[fe].children(this._source.maxzoom);this._tiles[_e[0].key]&&this._tiles[_e[1].key]&&this._tiles[_e[2].key]&&this._tiles[_e[3].key]&&(K[_e[0].key]=i[_e[0].key]=_e[0],K[_e[1].key]=i[_e[1].key]=_e[1],K[_e[2].key]=i[_e[2].key]=_e[2],K[_e[3].key]=i[_e[3].key]=_e[3],delete ae[fe])}for(const fe in ae){const _e=ae[fe],Ee=this.findLoadedParent(_e,this._source.minzoom),Pe=this.findLoadedSibling(_e),Ie=Ee||Pe||null;if(Ie){K[Ie.tileID.key]=i[Ie.tileID.key]=Ie.tileID;for(const Re in K)K[Re].isChildOf(Ie.tileID)&&delete K[Re]}}for(const fe in this._tiles)K[fe]||(this._coveredTiles[fe]=!0)}}update(i,h){if(!this._sourceLoaded||this._paused)return;let g;this.transform=i,this.terrain=h,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=i.getVisibleUnwrappedCoordinates(this._source.tileID).map((X=>new d.S(X.canonical.z,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y))):(g=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:h}),this._source.hasTile&&(g=g.filter((X=>this._source.hasTile(X))))):g=[];const v=i.coveringZoomLevel(this._source),T=Math.max(v-Xt.maxOverzooming,this._source.minzoom),z=Math.max(v+Xt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const X={};for(const K of g)if(K.canonical.z>this._source.minzoom){const ae=K.scaledTo(K.canonical.z-1);X[ae.key]=ae;const fe=K.scaledTo(Math.max(this._source.minzoom,Math.min(K.canonical.z,5)));X[fe.key]=fe}g=g.concat(Object.values(X))}const O=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,O&&this.fire(new d.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const U=this._updateRetainedTiles(g,v);Dn(this._source.type)&&this._updateCoveredAndRetainedTiles(U,T,z,v,g,h);for(const X in U)this._tiles[X].clearFadeHold();const H=d.ab(this._tiles,U);for(const X of H){const K=this._tiles[X];K.hasSymbolBuckets&&!K.holdingForFade()?K.setHoldDuration(this.map._fadeDuration):K.hasSymbolBuckets&&!K.symbolFadeFinished()||this._removeTile(X)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,h){var g;const v={},T={},z=Math.max(h-Xt.maxOverzooming,this._source.minzoom),O=Math.max(h+Xt.maxUnderzooming,this._source.minzoom),U={};for(const H of i){const X=this._addTile(H);v[H.key]=H,X.hasData()||h<this._source.maxzoom&&(U[H.key]=H)}this._retainLoadedChildren(U,h,O,v);for(const H of i){let X=this._tiles[H.key];if(X.hasData())continue;if(h+1>this._source.maxzoom){const ae=H.children(this._source.maxzoom)[0],fe=this.getTile(ae);if(fe&&fe.hasData()){v[ae.key]=ae;continue}}else{const ae=H.children(this._source.maxzoom);if(v[ae[0].key]&&v[ae[1].key]&&v[ae[2].key]&&v[ae[3].key])continue}let K=X.wasRequested();for(let ae=H.overscaledZ-1;ae>=z;--ae){const fe=H.scaledTo(ae);if(T[fe.key])break;if(T[fe.key]=!0,X=this.getTile(fe),!X&&K&&(X=this._addTile(fe)),X){const _e=X.hasData();if((_e||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||K)&&(v[fe.key]=fe),K=X.wasRequested(),_e)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const h=[];let g,v=this._tiles[i].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){g=this._loadedParentTiles[v.key];break}h.push(v.key);const T=v.scaledTo(v.overscaledZ-1);if(g=this._getLoadedTile(T),g)break;v=T}for(const T of h)this._loadedParentTiles[T]=g}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const i in this._tiles){const h=this._tiles[i].tileID,g=this._getLoadedTile(h);this._loadedSiblingTiles[h.key]=g}}_addTile(i){let h=this._tiles[i.key];if(h)return h;h=this._cache.getAndRemove(i),h&&(this._setTileReloadTimer(i.key,h),h.tileID=i,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,h)));const g=h;return h||(h=new Un(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(h,i.key,h.state)),h.uses++,this._tiles[i.key]=h,g||this._source.fire(new d.k("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(i,h){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const g=h.getExpiryTimeout();g&&(this._timers[i]=setTimeout((()=>{this._reloadTile(i,"expired"),delete this._timers[i]}),g))}_removeTile(i){const h=this._tiles[i];h&&(h.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}_dataHandler(i){const h=i.sourceDataType;i.dataType==="source"&&h==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&h==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,h,g){const v=[],T=this.transform;if(!T)return v;const z=g?T.getCameraQueryGeometry(i):i,O=i.map((_e=>T.pointCoordinate(_e,this.terrain))),U=z.map((_e=>T.pointCoordinate(_e,this.terrain))),H=this.getIds();let X=1/0,K=1/0,ae=-1/0,fe=-1/0;for(const _e of U)X=Math.min(X,_e.x),K=Math.min(K,_e.y),ae=Math.max(ae,_e.x),fe=Math.max(fe,_e.y);for(let _e=0;_e<H.length;_e++){const Ee=this._tiles[H[_e]];if(Ee.holdingForFade())continue;const Pe=Ee.tileID,Ie=Math.pow(2,T.zoom-Ee.tileID.overscaledZ),Re=h*Ee.queryPadding*d.X/Ee.tileSize/Ie,Se=[Pe.getTilePoint(new d.Z(X,K)),Pe.getTilePoint(new d.Z(ae,fe))];if(Se[0].x-Re<d.X&&Se[0].y-Re<d.X&&Se[1].x+Re>=0&&Se[1].y+Re>=0){const $e=O.map((nt=>Pe.getTilePoint(nt))),Ze=U.map((nt=>Pe.getTilePoint(nt)));v.push({tile:Ee,tileID:Pe,queryGeometry:$e,cameraQueryGeometry:Ze,scale:Ie})}}return v}getVisibleCoordinates(i){const h=this.getRenderableIds(i).map((g=>this._tiles[g].tileID));for(const g of h)g.posMatrix=this.transform.calculatePosMatrix(g.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(Dn(this._source.type)){const i=N.now();for(const h in this._tiles)if(this._tiles[h].fadeEndTime>=i)return!0}return!1}setFeatureState(i,h,g){this._state.updateState(i=i||"_geojsonTileLayer",h,g)}removeFeatureState(i,h,g){this._state.removeFeatureState(i=i||"_geojsonTileLayer",h,g)}getFeatureState(i,h){return this._state.getState(i=i||"_geojsonTileLayer",h)}setDependencies(i,h,g){const v=this._tiles[i];v&&v.setDependencies(h,g)}reloadTilesForDependencies(i,h){for(const g in this._tiles)this._tiles[g].hasDependency(i,h)&&this._reloadTile(g,"reloading");this._cache.filter((g=>!g.hasDependency(i,h)))}}function Wi(E,i){const h=Math.abs(2*E.wrap)-+(E.wrap<0),g=Math.abs(2*i.wrap)-+(i.wrap<0);return E.overscaledZ-i.overscaledZ||g-h||i.canonical.y-E.canonical.y||i.canonical.x-E.canonical.x}function Dn(E){return E==="raster"||E==="image"||E==="video"}Xt.maxOverzooming=10,Xt.maxUnderzooming=3;class hi{constructor(i,h){this.reset(i,h)}reset(i,h){this.points=i||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=d.ac(i,0,1);let h=1,g=this._distances[h];const v=i*this.paddedLength+this.padding;for(;g<v&&h<this._distances.length;)g=this._distances[++h];const T=h-1,z=this._distances[T],O=g-z,U=O>0?(v-z)/O:0;return this.points[T].mult(1-U).add(this.points[h].mult(U))}}function xs(E,i){let h=!0;return E==="always"||E!=="never"&&i!=="never"||(h=!1),h}class Pn{constructor(i,h,g){const v=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(i/g),this.yCellCount=Math.ceil(h/g);for(let z=0;z<this.xCellCount*this.yCellCount;z++)v.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=h,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,h,g,v,T){this._forEachCell(h,g,v,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(v),this.bboxes.push(T)}insertCircle(i,h,g,v){this._forEachCell(h-v,g-v,h+v,g+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(h),this.circles.push(g),this.circles.push(v)}_insertBoxCell(i,h,g,v,T,z){this.boxCells[T].push(z)}_insertCircleCell(i,h,g,v,T,z){this.circleCells[T].push(z)}_query(i,h,g,v,T,z,O){if(g<0||i>this.width||v<0||h>this.height)return[];const U=[];if(i<=0&&h<=0&&this.width<=g&&this.height<=v){if(T)return[{key:null,x1:i,y1:h,x2:g,y2:v}];for(let H=0;H<this.boxKeys.length;H++)U.push({key:this.boxKeys[H],x1:this.bboxes[4*H],y1:this.bboxes[4*H+1],x2:this.bboxes[4*H+2],y2:this.bboxes[4*H+3]});for(let H=0;H<this.circleKeys.length;H++){const X=this.circles[3*H],K=this.circles[3*H+1],ae=this.circles[3*H+2];U.push({key:this.circleKeys[H],x1:X-ae,y1:K-ae,x2:X+ae,y2:K+ae})}}else this._forEachCell(i,h,g,v,this._queryCell,U,{hitTest:T,overlapMode:z,seenUids:{box:{},circle:{}}},O);return U}query(i,h,g,v){return this._query(i,h,g,v,!1,null)}hitTest(i,h,g,v,T,z){return this._query(i,h,g,v,!0,T,z).length>0}hitTestCircle(i,h,g,v,T){const z=i-g,O=i+g,U=h-g,H=h+g;if(O<0||z>this.width||H<0||U>this.height)return!1;const X=[];return this._forEachCell(z,U,O,H,this._queryCellCircle,X,{hitTest:!0,overlapMode:v,circle:{x:i,y:h,radius:g},seenUids:{box:{},circle:{}}},T),X.length>0}_queryCell(i,h,g,v,T,z,O,U){const{seenUids:H,hitTest:X,overlapMode:K}=O,ae=this.boxCells[T];if(ae!==null){const _e=this.bboxes;for(const Ee of ae)if(!H.box[Ee]){H.box[Ee]=!0;const Pe=4*Ee,Ie=this.boxKeys[Ee];if(i<=_e[Pe+2]&&h<=_e[Pe+3]&&g>=_e[Pe+0]&&v>=_e[Pe+1]&&(!U||U(Ie))&&(!X||!xs(K,Ie.overlapMode))&&(z.push({key:Ie,x1:_e[Pe],y1:_e[Pe+1],x2:_e[Pe+2],y2:_e[Pe+3]}),X))return!0}}const fe=this.circleCells[T];if(fe!==null){const _e=this.circles;for(const Ee of fe)if(!H.circle[Ee]){H.circle[Ee]=!0;const Pe=3*Ee,Ie=this.circleKeys[Ee];if(this._circleAndRectCollide(_e[Pe],_e[Pe+1],_e[Pe+2],i,h,g,v)&&(!U||U(Ie))&&(!X||!xs(K,Ie.overlapMode))){const Re=_e[Pe],Se=_e[Pe+1],$e=_e[Pe+2];if(z.push({key:Ie,x1:Re-$e,y1:Se-$e,x2:Re+$e,y2:Se+$e}),X)return!0}}}return!1}_queryCellCircle(i,h,g,v,T,z,O,U){const{circle:H,seenUids:X,overlapMode:K}=O,ae=this.boxCells[T];if(ae!==null){const _e=this.bboxes;for(const Ee of ae)if(!X.box[Ee]){X.box[Ee]=!0;const Pe=4*Ee,Ie=this.boxKeys[Ee];if(this._circleAndRectCollide(H.x,H.y,H.radius,_e[Pe+0],_e[Pe+1],_e[Pe+2],_e[Pe+3])&&(!U||U(Ie))&&!xs(K,Ie.overlapMode))return z.push(!0),!0}}const fe=this.circleCells[T];if(fe!==null){const _e=this.circles;for(const Ee of fe)if(!X.circle[Ee]){X.circle[Ee]=!0;const Pe=3*Ee,Ie=this.circleKeys[Ee];if(this._circlesCollide(_e[Pe],_e[Pe+1],_e[Pe+2],H.x,H.y,H.radius)&&(!U||U(Ie))&&!xs(K,Ie.overlapMode))return z.push(!0),!0}}}_forEachCell(i,h,g,v,T,z,O,U){const H=this._convertToXCellCoord(i),X=this._convertToYCellCoord(h),K=this._convertToXCellCoord(g),ae=this._convertToYCellCoord(v);for(let fe=H;fe<=K;fe++)for(let _e=X;_e<=ae;_e++)if(T.call(this,i,h,g,v,this.xCellCount*_e+fe,z,O,U))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,h,g,v,T,z){const O=v-i,U=T-h,H=g+z;return H*H>O*O+U*U}_circleAndRectCollide(i,h,g,v,T,z,O){const U=(z-v)/2,H=Math.abs(i-(v+U));if(H>U+g)return!1;const X=(O-T)/2,K=Math.abs(h-(T+X));if(K>X+g)return!1;if(H<=U||K<=X)return!0;const ae=H-U,fe=K-X;return ae*ae+fe*fe<=g*g}}function Zn(E,i,h,g,v){const T=d.H();return i?(d.K(T,T,[1/v,1/v,1]),h||d.ad(T,T,g.angle)):d.L(T,g.labelPlaneMatrix,E),T}function rn(E,i,h,g,v){if(i){const T=d.ae(E);return d.K(T,T,[v,v,1]),h||d.ad(T,T,-g.angle),T}return g.glCoordMatrix}function we(E,i,h,g){let v;g?(v=[E,i,g(E,i),1],d.af(v,v,h)):(v=[E,i,0,1],Bt(v,v,h));const T=v[3];return{point:new d.P(v[0]/T,v[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}function te(E,i){return .5+E/i*.5}function G(E,i){return E.x>=-i[0]&&E.x<=i[0]&&E.y>=-i[1]&&E.y<=i[1]}function oe(E,i,h,g,v,T,z,O,U,H,X,K,ae,fe,_e){const Ee=g?E.textSizeData:E.iconSizeData,Pe=d.ag(Ee,h.transform.zoom),Ie=[256/h.width*2+1,256/h.height*2+1],Re=g?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;Re.clear();const Se=E.lineVertexArray,$e=g?E.text.placedSymbolArray:E.icon.placedSymbolArray,Ze=h.transform.width/h.transform.height;let nt=!1;for(let bt=0;bt<$e.length;bt++){const $t=$e.get(bt);if($t.hidden||$t.writingMode===d.ah.vertical&&!nt){si($t.numGlyphs,Re);continue}nt=!1;const Vt=we($t.anchorX,$t.anchorY,i,_e);if(!G(Vt.point,Ie)){si($t.numGlyphs,Re);continue}const ti=te(h.transform.cameraToCenterDistance,Vt.signedDistanceFromCamera),qt=d.ai(Ee,Pe,$t),Ut=z?qt/ti:qt*ti,ai={getElevation:_e,labelPlaneMatrix:v,lineVertexArray:Se,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:H,tileAnchorPoint:new d.P($t.anchorX,$t.anchorY),unwrappedTileID:X,width:K,height:ae,translation:fe},Ai=ze(ai,$t,Ut,!1,O,i,T,E.glyphOffsetArray,Re,Ze,U);nt=Ai.useVertical,(Ai.notEnoughRoom||nt||Ai.needsFlipping&&ze(ai,$t,Ut,!0,O,i,T,E.glyphOffsetArray,Re,Ze,U).notEnoughRoom)&&si($t.numGlyphs,Re)}g?E.text.dynamicLayoutVertexBuffer.updateData(Re):E.icon.dynamicLayoutVertexBuffer.updateData(Re)}function ve(E,i,h,g,v,T,z,O){const U=T.glyphStartIndex+T.numGlyphs,H=T.lineStartIndex,X=T.lineStartIndex+T.lineLength,K=i.getoffsetX(T.glyphStartIndex),ae=i.getoffsetX(U-1),fe=st(E*K,h,g,v,T.segment,H,X,O,z);if(!fe)return null;const _e=st(E*ae,h,g,v,T.segment,H,X,O,z);return _e?O.projectionCache.anyProjectionOccluded?null:{first:fe,last:_e}:null}function je(E,i,h,g){return E===d.ah.horizontal&&Math.abs(h.y-i.y)>Math.abs(h.x-i.x)*g?{useVertical:!0}:(E===d.ah.vertical?i.y<h.y:i.x>h.x)?{needsFlipping:!0}:null}function ze(E,i,h,g,v,T,z,O,U,H,X){const K=h/24,ae=i.lineOffsetX*K,fe=i.lineOffsetY*K;let _e;if(i.numGlyphs>1){const Ee=i.glyphStartIndex+i.numGlyphs,Pe=i.lineStartIndex,Ie=i.lineStartIndex+i.lineLength,Re=ve(K,O,ae,fe,g,i,X,E);if(!Re)return{notEnoughRoom:!0};const Se=we(Re.first.point.x,Re.first.point.y,z,E.getElevation).point,$e=we(Re.last.point.x,Re.last.point.y,z,E.getElevation).point;if(v&&!g){const Ze=je(i.writingMode,Se,$e,H);if(Ze)return Ze}_e=[Re.first];for(let Ze=i.glyphStartIndex+1;Ze<Ee-1;Ze++)_e.push(st(K*O.getoffsetX(Ze),ae,fe,g,i.segment,Pe,Ie,E,X));_e.push(Re.last)}else{if(v&&!g){const Pe=we(E.tileAnchorPoint.x,E.tileAnchorPoint.y,T,E.getElevation).point,Ie=i.lineStartIndex+i.segment+1,Re=new d.P(E.lineVertexArray.getx(Ie),E.lineVertexArray.gety(Ie)),Se=we(Re.x,Re.y,T,E.getElevation),$e=Se.signedDistanceFromCamera>0?Se.point:(function(nt,bt,$t,Vt,ti,qt){return Ve(nt,bt,$t,1,ti,qt)})(E.tileAnchorPoint,Re,Pe,0,T,E),Ze=je(i.writingMode,Pe,$e,H);if(Ze)return Ze}const Ee=st(K*O.getoffsetX(i.glyphStartIndex),ae,fe,g,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,E,X);if(!Ee||E.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};_e=[Ee]}for(const Ee of _e)d.aj(U,Ee.point,Ee.angle);return{}}function Ve(E,i,h,g,v,T){const z=E.add(E.sub(i)._unit()),O=v!==void 0?we(z.x,z.y,v,T.getElevation).point:Ge(z.x,z.y,T).point,U=h.sub(O);return h.add(U._mult(g/U.mag()))}function he(E,i,h){const g=i.projectionCache;if(g.projections[E])return g.projections[E];const v=new d.P(i.lineVertexArray.getx(E),i.lineVertexArray.gety(E)),T=Ge(v.x,v.y,i);if(T.signedDistanceFromCamera>0)return g.projections[E]=T.point,g.anyProjectionOccluded=g.anyProjectionOccluded||T.isOccluded,T.point;const z=E-h.direction;return(function(O,U,H,X,K){return Ve(O,U,H,X,void 0,K)})(h.distanceFromAnchor===0?i.tileAnchorPoint:new d.P(i.lineVertexArray.getx(z),i.lineVertexArray.gety(z)),v,h.previousVertex,h.absOffsetX-h.distanceFromAnchor+1,i)}function Ge(E,i,h){const g=E+h.translation[0],v=i+h.translation[1];let T;return!h.pitchWithMap&&h.projection.useSpecialProjectionForSymbols?(T=h.projection.projectTileCoordinates(g,v,h.unwrappedTileID,h.getElevation),T.point.x=(.5*T.point.x+.5)*h.width,T.point.y=(.5*-T.point.y+.5)*h.height):(T=we(g,v,h.labelPlaneMatrix,h.getElevation),T.isOccluded=!1),T}function at(E,i,h){return E._unit()._perp()._mult(i*h)}function Ke(E,i,h,g,v,T,z,O,U){if(O.projectionCache.offsets[E])return O.projectionCache.offsets[E];const H=h.add(i);if(E+U.direction<g||E+U.direction>=v)return O.projectionCache.offsets[E]=H,H;const X=he(E+U.direction,O,U),K=at(X.sub(h),z,U.direction),ae=h.add(K),fe=X.add(K);return O.projectionCache.offsets[E]=d.ak(T,H,ae,fe)||H,O.projectionCache.offsets[E]}function st(E,i,h,g,v,T,z,O,U){const H=g?E-i:E+i;let X=H>0?1:-1,K=0;g&&(X*=-1,K=Math.PI),X<0&&(K+=Math.PI);let ae,fe=X>0?T+v:T+v+1;O.projectionCache.cachedAnchorPoint?ae=O.projectionCache.cachedAnchorPoint:(ae=Ge(O.tileAnchorPoint.x,O.tileAnchorPoint.y,O).point,O.projectionCache.cachedAnchorPoint=ae);let _e,Ee,Pe=ae,Ie=ae,Re=0,Se=0;const $e=Math.abs(H),Ze=[];let nt;for(;Re+Se<=$e;){if(fe+=X,fe<T||fe>=z)return null;Re+=Se,Ie=Pe,Ee=_e;const Vt={absOffsetX:$e,direction:X,distanceFromAnchor:Re,previousVertex:Ie};if(Pe=he(fe,O,Vt),h===0)Ze.push(Ie),nt=Pe.sub(Ie);else{let ti;const qt=Pe.sub(Ie);ti=qt.mag()===0?at(he(fe+X,O,Vt).sub(Pe),h,X):at(qt,h,X),Ee||(Ee=Ie.add(ti)),_e=Ke(fe,ti,Pe,T,z,Ee,h,O,Vt),Ze.push(Ee),nt=_e.sub(Ee)}Se=nt.mag()}const bt=nt._mult(($e-Re)/Se)._add(Ee||Ie),$t=K+Math.atan2(Pe.y-Ie.y,Pe.x-Ie.x);return Ze.push(bt),{point:bt,angle:U?$t:0,path:Ze}}const Qt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function si(E,i){for(let h=0;h<E;h++){const g=i.length;i.resize(g+4),i.float32.set(Qt,3*g)}}function Bt(E,i,h){const g=i[0],v=i[1];return E[0]=h[0]*g+h[4]*v+h[12],E[1]=h[1]*g+h[5]*v+h[13],E[3]=h[3]*g+h[7]*v+h[15],E}const Ct=100;class ni{constructor(i,h,g=new Pn(i.width+200,i.height+200,25),v=new Pn(i.width+200,i.height+200,25)){this.transform=i,this.mapProjection=h,this.grid=g,this.ignoredGrid=v,this.pitchFactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Ct,this.screenBottomBoundary=i.height+Ct,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,h,g,v,T,z,O,U,H,X,K){const ae=i.anchorPointX+U[0],fe=i.anchorPointY+U[1],_e=this.projectAndGetPerspectiveRatio(v,ae,fe,T,X),Ee=g*_e.perspectiveRatio;let Pe;if(z||O)Pe=this._projectCollisionBox(i,Ee,v,T,z,O,U,_e,X,K);else{const Ze=_e.point.x+(K?K.x*Ee:0),nt=_e.point.y+(K?K.y*Ee:0);Pe={allPointsOccluded:!1,box:[Ze+i.x1*Ee,nt+i.y1*Ee,Ze+i.x2*Ee,nt+i.y2*Ee]}}const[Ie,Re,Se,$e]=Pe.box;return this.mapProjection.useSpecialProjectionForSymbols&&(z?Pe.allPointsOccluded:this.mapProjection.isOccluded(ae,fe,T))||_e.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Ie,Re,Se,$e)||h!=="always"&&this.grid.hitTest(Ie,Re,Se,$e,h,H)?{box:[Ie,Re,Se,$e],placeable:!1,offscreen:!1}:{box:[Ie,Re,Se,$e],placeable:!0,offscreen:this.isOffscreen(Ie,Re,Se,$e)}}placeCollisionCircles(i,h,g,v,T,z,O,U,H,X,K,ae,fe,_e,Ee,Pe){const Ie=[],Re=new d.P(h.anchorX,h.anchorY),Se=this.getPerspectiveRatio(z,Re.x,Re.y,O,Pe),$e=(K?T/Se:T*Se)/d.ap,Ze={getElevation:Pe,labelPlaneMatrix:U,lineVertexArray:g,pitchWithMap:K,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:Re,unwrappedTileID:O,width:this.transform.width,height:this.transform.height,translation:Ee},nt=ve($e,v,h.lineOffsetX*$e,h.lineOffsetY*$e,!1,h,!1,Ze);let bt=!1,$t=!1,Vt=!0;if(nt){const ti=.5*fe*Se+_e,qt=new d.P(-100,-100),Ut=new d.P(this.screenRightBoundary,this.screenBottomBoundary),ai=new hi,Ai=nt.first,Ht=nt.last;let Yt=[];for(let Hi=Ai.path.length-1;Hi>=1;Hi--)Yt.push(Ai.path[Hi]);for(let Hi=1;Hi<Ht.path.length;Hi++)Yt.push(Ht.path[Hi]);const Ci=2.5*ti;if(H){const Hi=this.projectPathToScreenSpace(Yt,Ze,H);Yt=Hi.some((an=>an.signedDistanceFromCamera<=0))?[]:Hi.map((an=>an.point))}let Fn=[];if(Yt.length>0){const Hi=Yt[0].clone(),an=Yt[0].clone();for(let Nn=1;Nn<Yt.length;Nn++)Hi.x=Math.min(Hi.x,Yt[Nn].x),Hi.y=Math.min(Hi.y,Yt[Nn].y),an.x=Math.max(an.x,Yt[Nn].x),an.y=Math.max(an.y,Yt[Nn].y);Fn=Hi.x>=qt.x&&an.x<=Ut.x&&Hi.y>=qt.y&&an.y<=Ut.y?[Yt]:an.x<qt.x||Hi.x>Ut.x||an.y<qt.y||Hi.y>Ut.y?[]:d.al([Yt],qt.x,qt.y,Ut.x,Ut.y)}for(const Hi of Fn){ai.reset(Hi,.25*ti);let an=0;an=ai.length<=.5*ti?1:Math.ceil(ai.paddedLength/Ci)+1;for(let Nn=0;Nn<an;Nn++){const er=Nn/Math.max(an-1,1),Ga=ai.lerp(er),Xn=Ga.x+Ct,Rr=Ga.y+Ct;Ie.push(Xn,Rr,ti,0);const rs=Xn-ti,as=Rr-ti,Ps=Xn+ti,Wa=Rr+ti;if(Vt=Vt&&this.isOffscreen(rs,as,Ps,Wa),$t=$t||this.isInsideGrid(rs,as,Ps,Wa),i!=="always"&&this.grid.hitTestCircle(Xn,Rr,ti,i,ae)&&(bt=!0,!X))return{circles:[],offscreen:!1,collisionDetected:bt}}}}return{circles:!X&&bt||!$t||Se<this.perspectiveRatioCutoff?[]:Ie,offscreen:Vt,collisionDetected:bt}}projectPathToScreenSpace(i,h,g){return i.map((v=>we(v.x,v.y,g,h.getElevation)))}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let g=1/0,v=1/0,T=-1/0,z=-1/0;for(const X of i){const K=new d.P(X.x+Ct,X.y+Ct);g=Math.min(g,K.x),v=Math.min(v,K.y),T=Math.max(T,K.x),z=Math.max(z,K.y),h.push(K)}const O=this.grid.query(g,v,T,z).concat(this.ignoredGrid.query(g,v,T,z)),U={},H={};for(const X of O){const K=X.key;if(U[K.bucketInstanceId]===void 0&&(U[K.bucketInstanceId]={}),U[K.bucketInstanceId][K.featureIndex])continue;const ae=[new d.P(X.x1,X.y1),new d.P(X.x2,X.y1),new d.P(X.x2,X.y2),new d.P(X.x1,X.y2)];d.am(h,ae)&&(U[K.bucketInstanceId][K.featureIndex]=!0,H[K.bucketInstanceId]===void 0&&(H[K.bucketInstanceId]=[]),H[K.bucketInstanceId].push(K.featureIndex))}return H}insertCollisionBox(i,h,g,v,T,z){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:T,collisionGroupID:z,overlapMode:h},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,h,g,v,T,z){const O=g?this.ignoredGrid:this.grid,U={bucketInstanceId:v,featureIndex:T,collisionGroupID:z,overlapMode:h};for(let H=0;H<i.length;H+=4)O.insertCircle(U,i[H],i[H+1],i[H+2])}projectAndGetPerspectiveRatio(i,h,g,v,T){let z;T?(z=[h,g,T(h,g),1],d.af(z,z,i)):(z=[h,g,0,1],Bt(z,z,i));const O=z[3];return{point:new d.P((z[0]/O+1)/2*this.transform.width+Ct,(-z[1]/O+1)/2*this.transform.height+Ct),perspectiveRatio:.5+this.transform.cameraToCenterDistance/O*.5,isOccluded:!1,signedDistanceFromCamera:O}}getPerspectiveRatio(i,h,g,v,T){const z=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(h,g,v,T):we(h,g,i,T);return .5+this.transform.cameraToCenterDistance/z.signedDistanceFromCamera*.5}isOffscreen(i,h,g,v){return g<Ct||i>=this.screenRightBoundary||v<Ct||h>this.screenBottomBoundary}isInsideGrid(i,h,g,v){return g>=0&&i<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const i=d.an([]);return d.J(i,i,[-100,-100,0]),i}_projectCollisionBox(i,h,g,v,T,z,O,U,H,X){let K=new d.P(1,0),ae=new d.P(0,1);const fe=new d.P(i.anchorPointX+O[0],i.anchorPointY+O[1]);if(z&&!T){const Vt=this.projectAndGetPerspectiveRatio(g,fe.x+1,fe.y,v,H).point.sub(U.point).unit(),ti=Math.atan(Vt.y/Vt.x)+(Vt.x<0?Math.PI:0),qt=Math.sin(ti),Ut=Math.cos(ti);K=new d.P(Ut,qt),ae=new d.P(-qt,Ut)}else if(!z&&T){const Vt=-this.transform.angle,ti=Math.sin(Vt),qt=Math.cos(Vt);K=new d.P(qt,ti),ae=new d.P(-ti,qt)}let _e=U.point,Ee=h;if(T){_e=fe;const Vt=this.transform.zoom-Math.floor(this.transform.zoom);Ee=Math.pow(2,-Vt),Ee*=this.mapProjection.getPitchedTextCorrection(this.transform,fe,v),X||(Ee*=d.ac(.5+U.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}X&&(_e=_e.add(K.mult(X.x*Ee)).add(ae.mult(X.y*Ee)));const Pe=i.x1*Ee,Ie=i.x2*Ee,Re=(Pe+Ie)/2,Se=i.y1*Ee,$e=i.y2*Ee,Ze=(Se+$e)/2,nt=[{offsetX:Pe,offsetY:Se},{offsetX:Re,offsetY:Se},{offsetX:Ie,offsetY:Se},{offsetX:Ie,offsetY:Ze},{offsetX:Ie,offsetY:$e},{offsetX:Re,offsetY:$e},{offsetX:Pe,offsetY:$e},{offsetX:Pe,offsetY:Ze}];let bt=[];for(const{offsetX:Vt,offsetY:ti}of nt)bt.push(new d.P(_e.x+K.x*Vt+ae.x*ti,_e.y+K.y*Vt+ae.y*ti));let $t=!1;if(T){const Vt=bt.map((ti=>this.projectAndGetPerspectiveRatio(g,ti.x,ti.y,v,H)));$t=Vt.some((ti=>!ti.isOccluded)),bt=Vt.map((ti=>ti.point))}else $t=!0;return{box:d.ao(bt),allPointsOccluded:!$t}}}function yi(E,i,h){return i*(d.X/(E.tileSize*Math.pow(2,h-E.tileID.overscaledZ)))}class Ri{constructor(i,h,g,v){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?h:-h))):v&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class _t{constructor(i,h,g,v,T){this.text=new Ri(i?i.text:null,h,g,T),this.icon=new Ri(i?i.icon:null,h,v,T)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class xt{constructor(i,h,g){this.text=i,this.icon=h,this.skipFade=g}}class Gt{constructor(){this.invProjMatrix=d.H(),this.viewportMatrix=d.H(),this.circles=[]}}class fi{constructor(i,h,g,v,T){this.bucketInstanceId=i,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=v,this.tileID=T}}class Ne{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const h=++this.maxGroupID;this.collisionGroups[i]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[i]}}function zt(E,i,h,g,v){const{horizontalAlign:T,verticalAlign:z}=d.au(E);return new d.P(-(T-.5)*i+g[0]*v,-(z-.5)*h+g[1]*v)}class Kt{constructor(i,h,g,v,T,z){this.transform=i.clone(),this.terrain=g,this.collisionIndex=new ni(this.transform,h),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new Ne(T),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=z,z&&(z.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const h=this.terrain;return h?(g,v)=>h.getElevation(i,g,v):null}getBucketParts(i,h,g,v){const T=g.getBucket(h),z=g.latestFeatureIndex;if(!T||!z||h.id!==T.layerIds[0])return;const O=g.collisionBoxArray,U=T.layers[0].layout,H=T.layers[0].paint,X=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),K=g.tileSize/d.X,ae=g.tileID.toUnwrapped(),fe=this.transform.calculatePosMatrix(ae),_e=U.get("text-pitch-alignment")==="map",Ee=U.get("text-rotation-alignment")==="map",Pe=yi(g,1,this.transform.zoom),Ie=this.collisionIndex.mapProjection.translatePosition(this.transform,g,H.get("text-translate"),H.get("text-translate-anchor")),Re=this.collisionIndex.mapProjection.translatePosition(this.transform,g,H.get("icon-translate"),H.get("icon-translate-anchor")),Se=Zn(fe,_e,Ee,this.transform,Pe);let $e=null;if(_e){const nt=rn(fe,_e,Ee,this.transform,Pe);$e=d.L([],this.transform.labelPlaneMatrix,nt)}this.retainedQueryData[T.bucketInstanceId]=new fi(T.bucketInstanceId,z,T.sourceLayerIndex,T.index,g.tileID);const Ze={bucket:T,layout:U,translationText:Ie,translationIcon:Re,posMatrix:fe,unwrappedTileID:ae,textLabelPlaneMatrix:Se,labelToScreenMatrix:$e,scale:X,textPixelRatio:K,holdingForFade:g.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:d.ag(T.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(v)for(const nt of T.sortKeyRanges){const{sortKey:bt,symbolInstanceStart:$t,symbolInstanceEnd:Vt}=nt;i.push({sortKey:bt,symbolInstanceStart:$t,symbolInstanceEnd:Vt,parameters:Ze})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:Ze})}attemptAnchorPlacement(i,h,g,v,T,z,O,U,H,X,K,ae,fe,_e,Ee,Pe,Ie,Re,Se){const $e=d.aq[i.textAnchor],Ze=[i.textOffset0,i.textOffset1],nt=zt($e,g,v,Ze,T),bt=this.collisionIndex.placeCollisionBox(h,ae,U,H,X,O,z,Pe,K.predicate,Se,nt);if((!Re||this.collisionIndex.placeCollisionBox(Re,ae,U,H,X,O,z,Ie,K.predicate,Se,nt).placeable)&&bt.placeable){let $t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID].text&&($t=this.prevPlacement.variableOffsets[fe.crossTileID].anchor),fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[fe.crossTileID]={textOffset:Ze,width:g,height:v,anchor:$e,textBoxScale:T,prevAnchor:$t},this.markUsedJustification(_e,$e,fe,Ee),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,Ee,fe),this.placedOrientations[fe.crossTileID]=Ee),{shift:nt,placedGlyphBoxes:bt}}}placeLayerBucketPart(i,h,g){const{bucket:v,layout:T,translationText:z,translationIcon:O,posMatrix:U,unwrappedTileID:H,textLabelPlaneMatrix:X,labelToScreenMatrix:K,textPixelRatio:ae,holdingForFade:fe,collisionBoxArray:_e,partiallyEvaluatedTextSize:Ee,collisionGroup:Pe}=i.parameters,Ie=T.get("text-optional"),Re=T.get("icon-optional"),Se=d.ar(T,"text-overlap","text-allow-overlap"),$e=Se==="always",Ze=d.ar(T,"icon-overlap","icon-allow-overlap"),nt=Ze==="always",bt=T.get("text-rotation-alignment")==="map",$t=T.get("text-pitch-alignment")==="map",Vt=T.get("icon-text-fit")!=="none",ti=T.get("symbol-z-order")==="viewport-y",qt=$e&&(nt||!v.hasIconData()||Re),Ut=nt&&($e||!v.hasTextData()||Ie);!v.collisionArrays&&_e&&v.deserializeCollisionBoxes(_e);const ai=this._getTerrainElevationFunc(this.retainedQueryData[v.bucketInstanceId].tileID),Ai=(Ht,Yt,Ci)=>{var Fn,Hi;if(h[Ht.crossTileID])return;if(fe)return void(this.placements[Ht.crossTileID]=new xt(!1,!1,!1));let an=!1,Nn=!1,er=!0,Ga=null,Xn={box:null,placeable:!1,offscreen:null},Rr={placeable:!1},rs=null,as=null,Ps=null,Wa=0,hc=0,_o=0;Yt.textFeatureIndex?Wa=Yt.textFeatureIndex:Ht.useRuntimeCollisionCircles&&(Wa=Ht.featureIndex),Yt.verticalTextFeatureIndex&&(hc=Yt.verticalTextFeatureIndex);const ar=Yt.textBox;if(ar){const ji=js=>{let Is=d.ah.horizontal;if(v.allowVerticalPlacement&&!js&&this.prevPlacement){const Dr=this.prevPlacement.placedOrientations[Ht.crossTileID];Dr&&(this.placedOrientations[Ht.crossTileID]=Dr,Is=Dr,this.markUsedOrientation(v,Is,Ht))}return Is},dn=(js,Is)=>{if(v.allowVerticalPlacement&&Ht.numVerticalGlyphVertices>0&&Yt.verticalTextBox){for(const Dr of v.writingModes)if(Dr===d.ah.vertical?(Xn=Is(),Rr=Xn):Xn=js(),Xn&&Xn.placeable)break}else Xn=js()},os=Ht.textAnchorOffsetStartIndex,fa=Ht.textAnchorOffsetEndIndex;if(fa===os){const js=(Is,Dr)=>{const Qi=this.collisionIndex.placeCollisionBox(Is,Se,ae,U,H,$t,bt,z,Pe.predicate,ai);return Qi&&Qi.placeable&&(this.markUsedOrientation(v,Dr,Ht),this.placedOrientations[Ht.crossTileID]=Dr),Qi};dn((()=>js(ar,d.ah.horizontal)),(()=>{const Is=Yt.verticalTextBox;return v.allowVerticalPlacement&&Ht.numVerticalGlyphVertices>0&&Is?js(Is,d.ah.vertical):{box:null,offscreen:null}})),ji(Xn&&Xn.placeable)}else{let js=d.aq[(Hi=(Fn=this.prevPlacement)===null||Fn===void 0?void 0:Fn.variableOffsets[Ht.crossTileID])===null||Hi===void 0?void 0:Hi.anchor];const Is=(Qi,Ya,Zc)=>{const ls=Qi.x2-Qi.x1,uh=Qi.y2-Qi.y1,td=Ht.textBoxScale,id=Vt&&Ze==="never"?Ya:null;let Sl=null,af=Se==="never"?1:2,Gc="never";js&&af++;for(let fc=0;fc<af;fc++){for(let Wc=os;Wc<fa;Wc++){const or=v.textAnchorOffsets.get(Wc);if(js&&or.textAnchor!==js)continue;const us=this.attemptAnchorPlacement(or,Qi,ls,uh,td,bt,$t,ae,U,H,Pe,Gc,Ht,v,Zc,z,O,id,ai);if(us&&(Sl=us.placedGlyphBoxes,Sl&&Sl.placeable))return an=!0,Ga=us.shift,Sl}js?js=null:Gc=Se}return g&&!Sl&&(Sl={box:this.collisionIndex.placeCollisionBox(ar,"always",ae,U,H,$t,bt,z,Pe.predicate,ai,new d.P(0,0)).box,offscreen:!1,placeable:!1}),Sl};dn((()=>Is(ar,Yt.iconBox,d.ah.horizontal)),(()=>{const Qi=Yt.verticalTextBox;return v.allowVerticalPlacement&&(!Xn||!Xn.placeable)&&Ht.numVerticalGlyphVertices>0&&Qi?Is(Qi,Yt.verticalIconBox,d.ah.vertical):{box:null,occluded:!0,offscreen:null}})),Xn&&(an=Xn.placeable,er=Xn.offscreen);const Dr=ji(Xn&&Xn.placeable);if(!an&&this.prevPlacement){const Qi=this.prevPlacement.variableOffsets[Ht.crossTileID];Qi&&(this.variableOffsets[Ht.crossTileID]=Qi,this.markUsedJustification(v,Qi.anchor,Ht,Dr))}}}if(rs=Xn,an=rs&&rs.placeable,er=rs&&rs.offscreen,Ht.useRuntimeCollisionCircles){const ji=v.text.placedSymbolArray.get(Ht.centerJustifiedTextSymbolIndex),dn=d.ai(v.textSizeData,Ee,ji),os=T.get("text-padding");as=this.collisionIndex.placeCollisionCircles(Se,ji,v.lineVertexArray,v.glyphOffsetArray,dn,U,H,X,K,g,$t,Pe.predicate,Ht.collisionCircleDiameter,os,z,ai),as.circles.length&&as.collisionDetected&&!g&&d.w("Collisions detected, but collision boxes are not shown"),an=$e||as.circles.length>0&&!as.collisionDetected,er=er&&as.offscreen}if(Yt.iconFeatureIndex&&(_o=Yt.iconFeatureIndex),Yt.iconBox){const ji=dn=>this.collisionIndex.placeCollisionBox(dn,Ze,ae,U,H,$t,bt,O,Pe.predicate,ai,Vt&&Ga?Ga:void 0);Rr&&Rr.placeable&&Yt.verticalIconBox?(Ps=ji(Yt.verticalIconBox),Nn=Ps.placeable):(Ps=ji(Yt.iconBox),Nn=Ps.placeable),er=er&&Ps.offscreen}const Ln=Ie||Ht.numHorizontalGlyphVertices===0&&Ht.numVerticalGlyphVertices===0,dc=Re||Ht.numIconVertices===0;Ln||dc?dc?Ln||(Nn=Nn&&an):an=Nn&&an:Nn=an=Nn&&an;const vo=Nn&&Ps.placeable;if(an&&rs.placeable&&this.collisionIndex.insertCollisionBox(rs.box,Se,T.get("text-ignore-placement"),v.bucketInstanceId,Rr&&Rr.placeable&&hc?hc:Wa,Pe.ID),vo&&this.collisionIndex.insertCollisionBox(Ps.box,Ze,T.get("icon-ignore-placement"),v.bucketInstanceId,_o,Pe.ID),as&&an&&this.collisionIndex.insertCollisionCircles(as.circles,Se,T.get("text-ignore-placement"),v.bucketInstanceId,Wa,Pe.ID),g&&this.storeCollisionData(v.bucketInstanceId,Ci,Yt,rs,Ps,as),Ht.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ht.crossTileID]=new xt(an||qt,Nn||Ut,er||v.justReloaded),h[Ht.crossTileID]=!0};if(ti){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ht=v.getSortedSymbolIndexes(this.transform.angle);for(let Yt=Ht.length-1;Yt>=0;--Yt){const Ci=Ht[Yt];Ai(v.symbolInstances.get(Ci),v.collisionArrays[Ci],Ci)}}else for(let Ht=i.symbolInstanceStart;Ht<i.symbolInstanceEnd;Ht++)Ai(v.symbolInstances.get(Ht),v.collisionArrays[Ht],Ht);if(g&&v.bucketInstanceId in this.collisionCircleArrays){const Ht=this.collisionCircleArrays[v.bucketInstanceId];d.as(Ht.invProjMatrix,U),Ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}storeCollisionData(i,h,g,v,T,z){if(g.textBox||g.iconBox){let O,U;this.collisionBoxArrays.has(i)?O=this.collisionBoxArrays.get(i):(O=new Map,this.collisionBoxArrays.set(i,O)),O.has(h)?U=O.get(h):(U={text:null,icon:null},O.set(h,U)),g.textBox&&(U.text=v.box),g.iconBox&&(U.icon=T.box)}if(z){let O=this.collisionCircleArrays[i];O===void 0&&(O=this.collisionCircleArrays[i]=new Gt);for(let U=0;U<z.circles.length;U+=4)O.circles.push(z.circles[U+0]),O.circles.push(z.circles[U+1]),O.circles.push(z.circles[U+2]),O.circles.push(z.collisionDetected?1:0)}}markUsedJustification(i,h,g,v){let T;T=v===d.ah.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[d.at(h)];const z=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const O of z)O>=0&&(i.text.placedSymbolArray.get(O).crossTileID=T>=0&&O!==T?0:g.crossTileID)}markUsedOrientation(i,h,g){const v=h===d.ah.horizontal||h===d.ah.horizontalOnly?h:0,T=h===d.ah.vertical?h:0,z=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const O of z)i.text.placedSymbolArray.get(O).placedOrientation=v;g.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(i):1,T=h?h.opacities:{},z=h?h.variableOffsets:{},O=h?h.placedOrientations:{};for(const U in this.placements){const H=this.placements[U],X=T[U];X?(this.opacities[U]=new _t(X,v,H.text,H.icon),g=g||H.text!==X.text.placed||H.icon!==X.icon.placed):(this.opacities[U]=new _t(null,v,H.text,H.icon,H.skipFade),g=g||H.text||H.icon)}for(const U in T){const H=T[U];if(!this.opacities[U]){const X=new _t(H,v,!1,!1);X.isHidden()||(this.opacities[U]=X,g=g||H.text.placed||H.icon.placed)}}for(const U in z)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=z[U]);for(const U in O)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=O[U]);if(h&&h.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:i)}updateLayerOpacities(i,h){const g={};for(const v of h){const T=v.getBucket(i);T&&v.latestFeatureIndex&&i.id===T.layerIds[0]&&this.updateBucketOpacities(T,v.tileID,g,v.collisionBoxArray)}}updateBucketOpacities(i,h,g,v){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const T=i.layers[0],z=T.layout,O=new _t(null,0,!1,!1,!0),U=z.get("text-allow-overlap"),H=z.get("icon-allow-overlap"),X=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),K=z.get("text-rotation-alignment")==="map",ae=z.get("text-pitch-alignment")==="map",fe=z.get("icon-text-fit")!=="none",_e=new _t(null,0,U&&(H||!i.hasIconData()||z.get("icon-optional")),H&&(U||!i.hasTextData()||z.get("text-optional")),!0);!i.collisionArrays&&v&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(v);const Ee=(Ie,Re,Se)=>{for(let $e=0;$e<Re/4;$e++)Ie.opacityVertexArray.emplaceBack(Se);Ie.hasVisibleVertices=Ie.hasVisibleVertices||Se!==Ao},Pe=this.collisionBoxArrays.get(i.bucketInstanceId);for(let Ie=0;Ie<i.symbolInstances.length;Ie++){const Re=i.symbolInstances.get(Ie),{numHorizontalGlyphVertices:Se,numVerticalGlyphVertices:$e,crossTileID:Ze}=Re;let nt=this.opacities[Ze];g[Ze]?nt=O:nt||(nt=_e,this.opacities[Ze]=nt),g[Ze]=!0;const bt=Re.numIconVertices>0,$t=this.placedOrientations[Re.crossTileID],Vt=$t===d.ah.vertical,ti=$t===d.ah.horizontal||$t===d.ah.horizontalOnly;if(Se>0||$e>0){const Ut=vr(nt.text);Ee(i.text,Se,Vt?Ao:Ut),Ee(i.text,$e,ti?Ao:Ut);const ai=nt.text.isHidden();[Re.rightJustifiedTextSymbolIndex,Re.centerJustifiedTextSymbolIndex,Re.leftJustifiedTextSymbolIndex].forEach((Yt=>{Yt>=0&&(i.text.placedSymbolArray.get(Yt).hidden=ai||Vt?1:0)})),Re.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(Re.verticalPlacedTextSymbolIndex).hidden=ai||ti?1:0);const Ai=this.variableOffsets[Re.crossTileID];Ai&&this.markUsedJustification(i,Ai.anchor,Re,$t);const Ht=this.placedOrientations[Re.crossTileID];Ht&&(this.markUsedJustification(i,"left",Re,Ht),this.markUsedOrientation(i,Ht,Re))}if(bt){const Ut=vr(nt.icon),ai=!(fe&&Re.verticalPlacedIconSymbolIndex&&Vt);Re.placedIconSymbolIndex>=0&&(Ee(i.icon,Re.numIconVertices,ai?Ut:Ao),i.icon.placedSymbolArray.get(Re.placedIconSymbolIndex).hidden=nt.icon.isHidden()),Re.verticalPlacedIconSymbolIndex>=0&&(Ee(i.icon,Re.numVerticalIconVertices,ai?Ao:Ut),i.icon.placedSymbolArray.get(Re.verticalPlacedIconSymbolIndex).hidden=nt.icon.isHidden())}const qt=Pe&&Pe.has(Ie)?Pe.get(Ie):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Ut=i.collisionArrays[Ie];if(Ut){let ai=new d.P(0,0);if(Ut.textBox||Ut.verticalTextBox){let Ai=!0;if(X){const Ht=this.variableOffsets[Ze];Ht?(ai=zt(Ht.anchor,Ht.width,Ht.height,Ht.textOffset,Ht.textBoxScale),K&&ai._rotate(ae?this.transform.angle:-this.transform.angle)):Ai=!1}if(Ut.textBox||Ut.verticalTextBox){let Ht;Ut.textBox&&(Ht=Vt),Ut.verticalTextBox&&(Ht=ti),Zi(i.textCollisionBox.collisionVertexArray,nt.text.placed,!Ai||Ht,qt.text,ai.x,ai.y)}}if(Ut.iconBox||Ut.verticalIconBox){const Ai=!!(!ti&&Ut.verticalIconBox);let Ht;Ut.iconBox&&(Ht=Ai),Ut.verticalIconBox&&(Ht=!Ai),Zi(i.iconCollisionBox.collisionVertexArray,nt.icon.placed,Ht,qt.icon,fe?ai.x:0,fe?ai.y:0)}}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const Ie=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Ie.invProjMatrix,i.placementViewportMatrix=Ie.viewportMatrix,i.collisionCircleArray=Ie.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,h){const g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>i}setStale(){this.stale=!0}}function Zi(E,i,h,g,v,T){g&&g.length!==0||(g=[0,0,0,0]);const z=g[0]-Ct,O=g[1]-Ct,U=g[2]-Ct,H=g[3]-Ct;E.emplaceBack(i?1:0,h?1:0,v||0,T||0,z,O),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,U,O),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,U,H),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,z,H)}const vi=Math.pow(2,25),mn=Math.pow(2,24),_r=Math.pow(2,17),Xs=Math.pow(2,16),Rs=Math.pow(2,9),Co=Math.pow(2,8),sr=Math.pow(2,1);function vr(E){if(E.opacity===0&&!E.placed)return 0;if(E.opacity===1&&E.placed)return 4294967295;const i=E.placed?1:0,h=Math.floor(127*E.opacity);return h*vi+i*mn+h*_r+i*Xs+h*Rs+i*Co+h*sr+i}const Ao=0;function xa(){return{isOccluded:(E,i,h)=>!1,getPitchedTextCorrection:(E,i,h)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(E,i,h,g){throw new Error("Not implemented.")},translatePosition:(E,i,h,g)=>(function(v,T,z,O,U=!1){if(!z[0]&&!z[1])return[0,0];const H=U?O==="map"?v.angle:0:O==="viewport"?-v.angle:0;if(H){const X=Math.sin(H),K=Math.cos(H);z=[z[0]*K-z[1]*X,z[0]*X+z[1]*K]}return[U?z[0]:yi(T,z[0],v.zoom),U?z[1]:yi(T,z[1],v.zoom)]})(E,i,h,g),getCircleRadiusCorrection:E=>1}}class ki{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,h,g,v,T){const z=this._bucketParts;for(;this._currentTileIndex<i.length;)if(h.getBucketParts(z,v,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort(((O,U)=>O.sortKey-U.sortKey)));this._currentPartIndex<z.length;)if(h.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,T())return!0;return!1}}class In{constructor(i,h,g,v,T,z,O,U){this.placement=new Kt(i,xa(),h,z,O,U),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(i,h,g){const v=N.now(),T=()=>!this._forceFullPlacement&&N.now()-v>2;for(;this._currentPlacementIndex>=0;){const z=h[i[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=O)&&(!z.maxzoom||z.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new ki(z)),this._inProgressLayer.continuePlacement(g[z.source],this.placement,this._showCollisionBoxes,z,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const gs=512/d.X/2;class cn{constructor(i,h,g){this.tileID=i,this.bucketInstanceId=g,this._symbolsByKey={};const v=new Map;for(let T=0;T<h.length;T++){const z=h.get(T),O=z.key,U=v.get(O);U?U.push(z):v.set(O,[z])}for(const[T,z]of v){const O={positions:z.map((U=>({x:Math.floor(U.anchorX*gs),y:Math.floor(U.anchorY*gs)}))),crossTileIDs:z.map((U=>U.crossTileID))};if(O.positions.length>128){const U=new d.av(O.positions.length,16,Uint16Array);for(const{x:H,y:X}of O.positions)U.add(H,X);U.finish(),delete O.positions,O.index=U}this._symbolsByKey[T]=O}}getScaledCoordinates(i,h){const{x:g,y:v,z:T}=this.tileID.canonical,{x:z,y:O,z:U}=h.canonical,H=gs/Math.pow(2,U-T),X=(O*d.X+i.anchorY)*H,K=v*d.X*gs;return{x:Math.floor((z*d.X+i.anchorX)*H-g*d.X*gs),y:Math.floor(X-K)}}findMatches(i,h,g){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let T=0;T<i.length;T++){const z=i.get(T);if(z.crossTileID)continue;const O=this._symbolsByKey[z.key];if(!O)continue;const U=this.getScaledCoordinates(z,h);if(O.index){const H=O.index.range(U.x-v,U.y-v,U.x+v,U.y+v).sort();for(const X of H){const K=O.crossTileIDs[X];if(!g[K]){g[K]=!0,z.crossTileID=K;break}}}else if(O.positions)for(let H=0;H<O.positions.length;H++){const X=O.positions[H],K=O.crossTileIDs[H];if(Math.abs(X.x-U.x)<=v&&Math.abs(X.y-U.y)<=v&&!g[K]){g[K]=!0,z.crossTileID=K;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:i})=>i))}}class Oa{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Fr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const h=Math.round((i-this.lng)/360);if(h!==0)for(const g in this.indexes){const v=this.indexes[g],T={};for(const z in v){const O=v[z];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+h),T[O.tileID.key]=O}this.indexes[g]=T}this.lng=i}addBucket(i,h,g){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let T=0;T<h.symbolInstances.length;T++)h.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const v=this.usedCrossTileIDs[i.overscaledZ];for(const T in this.indexes){const z=this.indexes[T];if(Number(T)>i.overscaledZ)for(const O in z){const U=z[O];U.tileID.isChildOf(i)&&U.findMatches(h.symbolInstances,i,v)}else{const O=z[i.scaledTo(Number(T)).key];O&&O.findMatches(h.symbolInstances,i,v)}}for(let T=0;T<h.symbolInstances.length;T++){const z=h.symbolInstances.get(T);z.crossTileID||(z.crossTileID=g.generate(),v[z.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new cn(i,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(i,h){for(const g of h.getCrossTileIDsLists())for(const v of g)delete this.usedCrossTileIDs[i][v]}removeStaleBuckets(i){let h=!1;for(const g in this.indexes){const v=this.indexes[g];for(const T in v)i[v[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,v[T]),delete v[T],h=!0)}return h}}class Bi{constructor(){this.layerIndexes={},this.crossTileIDs=new Oa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,h,g){let v=this.layerIndexes[i.id];v===void 0&&(v=this.layerIndexes[i.id]=new Fr);let T=!1;const z={};v.handleWrapJump(g);for(const O of h){const U=O.getBucket(i);U&&i.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(O.tileID,U,this.crossTileIDs)&&(T=!0),z[U.bucketInstanceId]=!0)}return v.removeStaleBuckets(z)&&(T=!0),T}pruneUnusedLayers(i){const h={};i.forEach((g=>{h[g]=!0}));for(const g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}const An=(E,i)=>d.t(E,i&&i.filter((h=>h.identifier!=="source.canvas"))),Il=d.aw();class Xo extends d.E{constructor(i,h={}){super(),this._rtlPluginLoaded=()=>{for(const g in this.sourceCaches){const v=this.sourceCaches[g].getSource().type;v!=="vector"&&v!=="geojson"||this.sourceCaches[g].reload()}},this.map=i,this.dispatcher=new Vi(gi(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",((g,v)=>this.getGlyphs(g,v))),this.dispatcher.registerMessageHandler("GI",((g,v)=>this.getImages(g,v))),this.imageManager=new Mt,this.imageManager.setEventedParent(this),this.glyphManager=new ct(i._requestManager,h.localIdeographFontFamily),this.lineAtlas=new tt(256,512),this.crossTileSymbolIndex=new Bi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.ay()),bn().on(kt,this._rtlPluginLoaded),this.on("data",(g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const v=this.sourceCaches[g.sourceId];if(!v)return;const T=v.getSource();if(T&&T.vectorLayerIds)for(const z in this._layers){const O=this._layers[z];O.source===T.id&&this._validateLayer(O)}}))}loadURL(i,h={},g){this.fire(new d.k("dataloading",{dataType:"style"})),h.validate=typeof h.validate!="boolean"||h.validate;const v=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController;const T=this._loadStyleRequest;d.h(v,this._loadStyleRequest).then((z=>{this._loadStyleRequest=null,this._load(z.data,h,g)})).catch((z=>{this._loadStyleRequest=null,z&&!T.signal.aborted&&this.fire(new d.j(z))}))}loadJSON(i,h={},g){this.fire(new d.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,h.validate=h.validate!==!1,this._load(i,h,g)})).catch((()=>{}))}loadEmpty(){this.fire(new d.k("dataloading",{dataType:"style"})),this._load(Il,{validate:!1})}_load(i,h,g){var v;const T=h.transformStyle?h.transformStyle(g,i):i;if(!h.validate||!An(this,d.u(T))){this._loaded=!0,this.stylesheet=T;for(const z in T.sources)this.addSource(z,T.sources[z],{validate:!1});T.sprite?this._loadSprite(T.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(T.glyphs),this._createLayers(),this.light=new ot(this.stylesheet.light),this.sky=new Le(this.stylesheet.sky),this.map.setTerrain((v=this.stylesheet.terrain)!==null&&v!==void 0?v:null),this.fire(new d.k("data",{dataType:"style"})),this.fire(new d.k("style.load"))}}_createLayers(){const i=d.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map((h=>h.id)),this._layers={},this._serializedLayers=null;for(const h of i){const g=d.aA(h);g.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=g}}_loadSprite(i,h=!1,g=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(T,z,O,U){return d._(this,void 0,void 0,(function*(){const H=Fe(T),X=O>1?"@2x":"",K={},ae={};for(const{id:fe,url:_e}of H){const Ee=z.transformRequest(He(_e,X,".json"),"SpriteJSON");K[fe]=d.h(Ee,U);const Pe=z.transformRequest(He(_e,X,".png"),"SpriteImage");ae[fe]=le.getImage(Pe,U)}return yield Promise.all([...Object.values(K),...Object.values(ae)]),(function(fe,_e){return d._(this,void 0,void 0,(function*(){const Ee={};for(const Pe in fe){Ee[Pe]={};const Ie=N.getImageCanvasContext((yield _e[Pe]).data),Re=(yield fe[Pe]).data;for(const Se in Re){const{width:$e,height:Ze,x:nt,y:bt,sdf:$t,pixelRatio:Vt,stretchX:ti,stretchY:qt,content:Ut,textFitWidth:ai,textFitHeight:Ai}=Re[Se];Ee[Pe][Se]={data:null,pixelRatio:Vt,sdf:$t,stretchX:ti,stretchY:qt,content:Ut,textFitWidth:ai,textFitHeight:Ai,spriteData:{width:$e,height:Ze,x:nt,y:bt,context:Ie}}}}return Ee}))})(K,ae)}))})(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((T=>{if(this._spriteRequest=null,T)for(const z in T){this._spritesImagesIds[z]=[];const O=this._spritesImagesIds[z]?this._spritesImagesIds[z].filter((U=>!(U in T))):[];for(const U of O)this.imageManager.removeImage(U),this._changedImages[U]=!0;for(const U in T[z]){const H=z==="default"?U:`${z}:${U}`;this._spritesImagesIds[z].push(H),H in this.imageManager.images?this.imageManager.updateImage(H,T[z][U],!1):this.imageManager.addImage(H,T[z][U]),h&&(this._changedImages[H]=!0)}}})).catch((T=>{this._spriteRequest=null,v=T,this.fire(new d.j(v))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),h&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"})),g&&g(v)}))}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}_validateLayer(i){const h=this.sourceCaches[i.source];if(!h)return;const g=i.sourceLayer;if(!g)return;const v=h.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(g)===-1)&&this.fire(new d.j(new Error(`Source layer "${g}" does not exist on source "${v.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i,h=!1){const g=this._serializedAllLayers();if(!i||i.length===0)return Object.values(h?d.aB(g):g);const v=[];for(const T of i)if(g[T]){const z=h?d.aB(g[T]):g[T];v.push(z)}return v}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const h=Object.keys(this._layers);for(const g of h){const v=this._layers[g];v.type!=="custom"&&(i[g]=v.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const h=this._changed;if(h){const v=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(v.length||T.length)&&this._updateWorkerLayers(v,T);for(const z in this._updatedSources){const O=this._updatedSources[z];if(O==="reload")this._reloadSource(z);else{if(O!=="clear")throw new Error(`Invalid action ${O}`);this._clearSource(z)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(i);this.light.updateTransitions(i),this.sky.updateTransitions(i),this._resetUpdates()}const g={};for(const v in this.sourceCaches){const T=this.sourceCaches[v];g[v]=T.used,T.used=!1}for(const v of this._order){const T=this._layers[v];T.recalculate(i,this._availableImages),!T.isHidden(i.zoom)&&T.source&&(this.sourceCaches[T.source].used=!0)}for(const v in g){const T=this.sourceCaches[v];!!g[v]!=!!T.used&&T.fire(new d.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(i),this.sky.recalculate(i),this.z=i.zoom,h&&this.fire(new d.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,h){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i,!1),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,h={}){var g;this._checkLoaded();const v=this.serialize();if(i=h.transformStyle?h.transformStyle(v,i):i,((g=h.validate)===null||g===void 0||g)&&An(this,d.u(i)))return!1;(i=d.aB(i)).layers=d.az(i.layers);const T=d.aC(v,i),z=this._getOperationsToPerform(T);if(z.unimplemented.length>0)throw new Error(`Unimplemented: ${z.unimplemented.join(", ")}.`);if(z.operations.length===0)return!1;for(const O of z.operations)O();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const h=[],g=[];for(const v of i)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":h.push((()=>this.addLayer.apply(this,v.args)));break;case"removeLayer":h.push((()=>this.removeLayer.apply(this,v.args)));break;case"setPaintProperty":h.push((()=>this.setPaintProperty.apply(this,v.args)));break;case"setLayoutProperty":h.push((()=>this.setLayoutProperty.apply(this,v.args)));break;case"setFilter":h.push((()=>this.setFilter.apply(this,v.args)));break;case"addSource":h.push((()=>this.addSource.apply(this,v.args)));break;case"removeSource":h.push((()=>this.removeSource.apply(this,v.args)));break;case"setLayerZoomRange":h.push((()=>this.setLayerZoomRange.apply(this,v.args)));break;case"setLight":h.push((()=>this.setLight.apply(this,v.args)));break;case"setGeoJSONSourceData":h.push((()=>this.setGeoJSONSourceData.apply(this,v.args)));break;case"setGlyphs":h.push((()=>this.setGlyphs.apply(this,v.args)));break;case"setSprite":h.push((()=>this.setSprite.apply(this,v.args)));break;case"setSky":h.push((()=>this.setSky.apply(this,v.args)));break;case"setTerrain":h.push((()=>this.map.setTerrain.apply(this,v.args)));break;case"setTransition":h.push((()=>{}));break;default:g.push(v.command)}return{operations:h,unimplemented:g}}addImage(i,h){if(this.getImage(i))return this.fire(new d.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,h),this._afterImageUpdated(i)}updateImage(i,h){this.imageManager.updateImage(i,h)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new d.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,h,g={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(d.u.source,`sources.${i}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=this.sourceCaches[i]=new Xt(i,h,this.dispatcher);v.style=this,v.setEventedParent(this,(()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:i}))),v.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===i)return this.fire(new d.j(new Error(`Source "${i}" cannot be removed while layer "${g}" is using it.`)));const h=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],h.fire(new d.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,h){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const g=this.sourceCaches[i].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(h),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,h,g={}){this._checkLoaded();const v=i.id;if(this.getLayer(v))return void this.fire(new d.j(new Error(`Layer "${v}" already exists on this map.`)));let T;if(i.type==="custom"){if(An(this,d.aD(i)))return;T=d.aA(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(v,i.source),i=d.aB(i),i=d.e(i,{source:v})),this._validate(d.u.layer,`layers.${v}`,i,{arrayIndex:-1},g))return;T=d.aA(i),this._validateLayer(T),T.setEventedParent(this,{layer:{id:v}})}const z=h?this._order.indexOf(h):this._order.length;if(h&&z===-1)this.fire(new d.j(new Error(`Cannot add layer "${v}" before non-existing layer "${h}".`)));else{if(this._order.splice(z,0,v),this._layerOrderChanged=!0,this._layers[v]=T,this._removedLayers[v]&&T.source&&T.type!=="custom"){const O=this._removedLayers[v];delete this._removedLayers[v],O.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}moveLayer(i,h){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new d.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===h)return;const g=this._order.indexOf(i);this._order.splice(g,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new d.j(new Error(`Cannot move layer "${i}" before non-existing layer "${h}".`))):(this._order.splice(v,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const h=this._layers[i];if(!h)return void this.fire(new d.j(new Error(`Cannot remove non-existing layer "${i}".`)));h.setEventedParent(null);const g=this._order.indexOf(i);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=h,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],h.onRemove&&h.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,h,g){this._checkLoaded();const v=this.getLayer(i);v?v.minzoom===h&&v.maxzoom===g||(h!=null&&(v.minzoom=h),g!=null&&(v.maxzoom=g),this._updateLayer(v)):this.fire(new d.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,h,g={}){this._checkLoaded();const v=this.getLayer(i);if(v){if(!d.aE(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(d.u.filter,`layers.${v.id}.filter`,h,null,g)||(v.filter=d.aB(h),this._updateLayer(v)))}else this.fire(new d.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return d.aB(this.getLayer(i).filter)}setLayoutProperty(i,h,g,v={}){this._checkLoaded();const T=this.getLayer(i);T?d.aE(T.getLayoutProperty(h),g)||(T.setLayoutProperty(h,g,v),this._updateLayer(T)):this.fire(new d.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,h){const g=this.getLayer(i);if(g)return g.getLayoutProperty(h);this.fire(new d.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,h,g,v={}){this._checkLoaded();const T=this.getLayer(i);T?d.aE(T.getPaintProperty(h),g)||(T.setPaintProperty(h,g,v)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[i]=!0,this._serializedLayers=null):this.fire(new d.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,h){return this.getLayer(i).getPaintProperty(h)}setFeatureState(i,h){this._checkLoaded();const g=i.source,v=i.sourceLayer,T=this.sourceCaches[g];if(T===void 0)return void this.fire(new d.j(new Error(`The source '${g}' does not exist in the map's style.`)));const z=T.getSource().type;z==="geojson"&&v?this.fire(new d.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||v?(i.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),T.setFeatureState(v,i.id,h)):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,h){this._checkLoaded();const g=i.source,v=this.sourceCaches[g];if(v===void 0)return void this.fire(new d.j(new Error(`The source '${g}' does not exist in the map's style.`)));const T=v.getSource().type,z=T==="vector"?i.sourceLayer:void 0;T!=="vector"||z?h&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new d.j(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(z,i.id,h):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const h=i.source,g=i.sourceLayer,v=this.sourceCaches[h];if(v!==void 0)return v.getSource().type!=="vector"||g?(i.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),v.getFeatureState(g,i.id)):void this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.j(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=d.aF(this.sourceCaches,(T=>T.serialize())),h=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,v=this.stylesheet;return d.aG({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,sources:i,layers:h,terrain:g},(T=>T!==void 0))}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const h=z=>this._layers[z].type==="fill-extrusion",g={},v=[];for(let z=this._order.length-1;z>=0;z--){const O=this._order[z];if(h(O)){g[O]=z;for(const U of i){const H=U[O];if(H)for(const X of H)v.push(X)}}}v.sort(((z,O)=>O.intersectionZ-z.intersectionZ));const T=[];for(let z=this._order.length-1;z>=0;z--){const O=this._order[z];if(h(O))for(let U=v.length-1;U>=0;U--){const H=v[U].feature;if(g[H.layer.id]<z)break;T.push(H),v.pop()}else for(const U of i){const H=U[O];if(H)for(const X of H)T.push(X.feature)}}return T}queryRenderedFeatures(i,h,g){h&&h.filter&&this._validate(d.u.filter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new d.j(new Error("parameters.layers must be an Array."))),[];for(const O of h.layers){const U=this._layers[O];if(!U)return this.fire(new d.j(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];v[U.source]=!0}}const T=[];h.availableImages=this._availableImages;const z=this._serializedAllLayers();for(const O in this.sourceCaches)h.layers&&!v[O]||T.push(gn(this.sourceCaches[O],this._layers,z,i,h,g));return this.placement&&T.push((function(O,U,H,X,K,ae,fe){const _e={},Ee=ae.queryRenderedSymbols(X),Pe=[];for(const Ie of Object.keys(Ee).map(Number))Pe.push(fe[Ie]);Pe.sort(ln);for(const Ie of Pe){const Re=Ie.featureIndex.lookupSymbolFeatures(Ee[Ie.bucketInstanceId],U,Ie.bucketIndex,Ie.sourceLayerIndex,K.filter,K.layers,K.availableImages,O);for(const Se in Re){const $e=_e[Se]=_e[Se]||[],Ze=Re[Se];Ze.sort(((nt,bt)=>{const $t=Ie.featureSortOrder;if($t){const Vt=$t.indexOf(nt.featureIndex);return $t.indexOf(bt.featureIndex)-Vt}return bt.featureIndex-nt.featureIndex}));for(const nt of Ze)$e.push(nt)}}for(const Ie in _e)_e[Ie].forEach((Re=>{const Se=Re.feature,$e=H[O[Ie].source].getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=$e}));return _e})(this._layers,z,this.sourceCaches,i,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(i,h){h&&h.filter&&this._validate(d.u.filter,"querySourceFeatures.filter",h.filter,null,h);const g=this.sourceCaches[i];return g?(function(v,T){const z=v.getRenderableIds().map((H=>v.getTileByID(H))),O=[],U={};for(let H=0;H<z.length;H++){const X=z[H],K=X.tileID.canonical.key;U[K]||(U[K]=!0,X.querySourceFeatures(O,T))}return O})(g,h):[]}getLight(){return this.light.getLight()}setLight(i,h={}){this._checkLoaded();const g=this.light.getLight();let v=!1;for(const z in i)if(!d.aE(i[z],g[z])){v=!0;break}if(!v)return;const T={now:N.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,h),this.light.updateTransitions(T)}getSky(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.sky}setSky(i,h={}){const g=this.getSky();let v=!1;if(!i&&!g)return;if(i&&!g)v=!0;else if(!i&&g)v=!0;else for(const z in i)if(!d.aE(i[z],g[z])){v=!0;break}if(!v)return;const T={now:N.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=i,this.sky.setSky(i,h),this.sky.updateTransitions(T)}_validate(i,h,g,v,T={}){return(!T||T.validate!==!1)&&An(this,i.call(d.u,d.e({key:h,style:this.serialize(),value:g,styleSpec:d.v},v)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),bn().off(kt,this._rtlPluginLoaded);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this.sourceCaches){const g=this.sourceCaches[h];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const h in this.sourceCaches)this.sourceCaches[h].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,h,g,v,T=!1){let z=!1,O=!1;const U={};for(const H of this._order){const X=this._layers[H];if(X.type!=="symbol")continue;if(!U[X.source]){const ae=this.sourceCaches[X.source];U[X.source]=ae.getRenderableIds(!0).map((fe=>ae.getTileByID(fe))).sort(((fe,_e)=>_e.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(_e.tileID)?-1:1)))}const K=this.crossTileSymbolIndex.addLayer(X,U[X.source],i.center.lng);z=z||K}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(N.now(),i.zoom))&&(this.pauseablePlacement=new In(i,this.map.terrain,this._order,T,h,g,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(N.now()),O=!0),z&&this.pauseablePlacement.placement.setStale()),O||z)for(const H of this._order){const X=this._layers[H];X.type==="symbol"&&this.placement.updateLayerOpacities(X,U[X.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(N.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,h){return d._(this,void 0,void 0,(function*(){const g=yield this.imageManager.getImages(h.icons);this._updateTilesForChangedImages();const v=this.sourceCaches[h.source];return v&&v.setDependencies(h.tileID.key,h.type,h.icons),g}))}getGlyphs(i,h){return d._(this,void 0,void 0,(function*(){const g=yield this.glyphManager.getGlyphs(h.stacks),v=this.sourceCaches[h.source];return v&&v.setDependencies(h.tileID.key,h.type,[""]),g}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,h={}){this._checkLoaded(),i&&this._validate(d.u.glyphs,"glyphs",i,null,h)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,h,g={},v){this._checkLoaded();const T=[{id:i,url:h}],z=[...Fe(this.stylesheet.sprite),...T];this._validate(d.u.sprite,"sprite",z,null,g)||(this.stylesheet.sprite=z,this._loadSprite(T,!0,v))}removeSprite(i){this._checkLoaded();const h=Fe(this.stylesheet.sprite);if(h.find((g=>g.id===i))){if(this._spritesImagesIds[i])for(const g of this._spritesImagesIds[i])this.imageManager.removeImage(g),this._changedImages[g]=!0;h.splice(h.findIndex((g=>g.id===i)),1),this.stylesheet.sprite=h.length>0?h:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}else this.fire(new d.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return Fe(this.stylesheet.sprite)}setSprite(i,h={},g){this._checkLoaded(),i&&this._validate(d.u.sprite,"sprite",i,null,h)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,g):(this._unloadSprite(),g&&g(null)))}}var On=d.Y([{name:"a_pos",type:"Int16",components:2}]);const Na={prelude:un(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:un(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:un(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:un(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:un("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:un(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:un(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:un("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:un("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:un("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:un(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:un(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:un(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:un(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:un(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:un(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:un(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:un(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:un(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:un(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:un(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:un("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:un("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:un("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:un("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function un(E,i){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=i.match(/attribute ([\w]+) ([\w]+)/g),v=E.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=T?T.concat(v):v,O={};return{fragmentSource:E=E.replace(h,((U,H,X,K,ae)=>(O[ae]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
varying ${X} ${K} ${ae};
#else
uniform ${X} ${K} u_${ae};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ae}
    ${X} ${K} ${ae} = u_${ae};
#endif
`))),vertexSource:i=i.replace(h,((U,H,X,K,ae)=>{const fe=K==="float"?"vec2":"vec4",_e=ae.match(/color/)?"color":fe;return O[ae]?H==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
attribute ${X} ${fe} a_${ae};
varying ${X} ${K} ${ae};
#else
uniform ${X} ${K} u_${ae};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${X} ${K} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${_e}(a_${ae}, u_${ae}_t);
#else
    ${X} ${K} ${ae} = u_${ae};
#endif
`:H==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
attribute ${X} ${fe} a_${ae};
#else
uniform ${X} ${K} u_${ae};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${K} ${ae} = a_${ae};
#else
    ${X} ${K} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${K} ${ae} = unpack_mix_${_e}(a_${ae}, u_${ae}_t);
#else
    ${X} ${K} ${ae} = u_${ae};
#endif
`})),staticAttributes:g,staticUniforms:z}}class ba{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,h,g,v,T,z,O,U,H){this.context=i;let X=this.boundPaintVertexBuffers.length!==v.length;for(let K=0;!X&&K<v.length;K++)this.boundPaintVertexBuffers[K]!==v[K]&&(X=!0);!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==g||X||this.boundIndexBuffer!==T||this.boundVertexOffset!==z||this.boundDynamicVertexBuffer!==O||this.boundDynamicVertexBuffer2!==U||this.boundDynamicVertexBuffer3!==H?this.freshBind(h,g,v,T,z,O,U,H):(i.bindVertexArray.set(this.vao),O&&O.bind(),T&&T.dynamicDraw&&T.bind(),U&&U.bind(),H&&H.bind())}freshBind(i,h,g,v,T,z,O,U){const H=i.numAttributes,X=this.context,K=X.gl;this.vao&&this.destroy(),this.vao=X.createVertexArray(),X.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=v,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=O,this.boundDynamicVertexBuffer3=U,h.enableAttributes(K,i);for(const ae of g)ae.enableAttributes(K,i);z&&z.enableAttributes(K,i),O&&O.enableAttributes(K,i),U&&U.enableAttributes(K,i),h.bind(),h.setVertexAttribPointers(K,i,T);for(const ae of g)ae.bind(),ae.setVertexAttribPointers(K,i,T);z&&(z.bind(),z.setVertexAttribPointers(K,i,T)),v&&v.bind(),O&&(O.bind(),O.setVertexAttribPointers(K,i,T)),U&&(U.bind(),U.setVertexAttribPointers(K,i,T)),X.currentNumAttributes=H}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Gn=(E,i,h,g,v)=>({u_matrix:E,u_texture:0,u_ele_delta:i,u_fog_matrix:h,u_fog_color:g?g.properties.get("fog-color"):d.aM.white,u_fog_ground_blend:g?g.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?g.calculateFogBlendOpacity(v):0,u_horizon_color:g?g.properties.get("horizon-color"):d.aM.white,u_horizon_fog_blend:g?g.properties.get("horizon-fog-blend"):1});function Vr(E){const i=[];for(let h=0;h<E.length;h++){if(E[h]===null)continue;const g=E[h].split(" ");i.push(g.pop())}return i}class Mo{constructor(i,h,g,v,T,z){const O=i.gl;this.program=O.createProgram();const U=Vr(h.staticAttributes),H=g?g.getBinderAttributes():[],X=U.concat(H),K=Na.prelude.staticUniforms?Vr(Na.prelude.staticUniforms):[],ae=h.staticUniforms?Vr(h.staticUniforms):[],fe=g?g.getBinderUniforms():[],_e=K.concat(ae).concat(fe),Ee=[];for(const nt of _e)Ee.indexOf(nt)<0&&Ee.push(nt);const Pe=g?g.defines():[];T&&Pe.push("#define OVERDRAW_INSPECTOR;"),z&&Pe.push("#define TERRAIN3D;");const Ie=Pe.concat(Na.prelude.fragmentSource,h.fragmentSource).join(`
`),Re=Pe.concat(Na.prelude.vertexSource,h.vertexSource).join(`
`),Se=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(Se,Ie),O.compileShader(Se),!O.getShaderParameter(Se,O.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${O.getShaderInfoLog(Se)}`);O.attachShader(this.program,Se);const $e=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource($e,Re),O.compileShader($e),!O.getShaderParameter($e,O.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${O.getShaderInfoLog($e)}`);O.attachShader(this.program,$e),this.attributes={};const Ze={};this.numAttributes=X.length;for(let nt=0;nt<this.numAttributes;nt++)X[nt]&&(O.bindAttribLocation(this.program,nt,X[nt]),this.attributes[X[nt]]=nt);if(O.linkProgram(this.program),!O.getProgramParameter(this.program,O.LINK_STATUS))throw new Error(`Program failed to link: ${O.getProgramInfoLog(this.program)}`);O.deleteShader($e),O.deleteShader(Se);for(let nt=0;nt<Ee.length;nt++){const bt=Ee[nt];if(bt&&!Ze[bt]){const $t=O.getUniformLocation(this.program,bt);$t&&(Ze[bt]=$t)}}this.fixedUniforms=v(i,Ze),this.terrainUniforms=((nt,bt)=>({u_depth:new d.aH(nt,bt.u_depth),u_terrain:new d.aH(nt,bt.u_terrain),u_terrain_dim:new d.aI(nt,bt.u_terrain_dim),u_terrain_matrix:new d.aJ(nt,bt.u_terrain_matrix),u_terrain_unpack:new d.aK(nt,bt.u_terrain_unpack),u_terrain_exaggeration:new d.aI(nt,bt.u_terrain_exaggeration)}))(i,Ze),this.binderUniforms=g?g.getUniforms(i,Ze):[]}draw(i,h,g,v,T,z,O,U,H,X,K,ae,fe,_e,Ee,Pe,Ie,Re){const Se=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(g),i.setStencilMode(v),i.setColorMode(T),i.setCullFace(z),U){i.activeTexture.set(Se.TEXTURE2),Se.bindTexture(Se.TEXTURE_2D,U.depthTexture),i.activeTexture.set(Se.TEXTURE3),Se.bindTexture(Se.TEXTURE_2D,U.texture);for(const Ze in this.terrainUniforms)this.terrainUniforms[Ze].set(U[Ze])}for(const Ze in this.fixedUniforms)this.fixedUniforms[Ze].set(O[Ze]);Ee&&Ee.setUniforms(i,this.binderUniforms,fe,{zoom:_e});let $e=0;switch(h){case Se.LINES:$e=2;break;case Se.TRIANGLES:$e=3;break;case Se.LINE_STRIP:$e=1}for(const Ze of ae.get()){const nt=Ze.vaos||(Ze.vaos={});(nt[H]||(nt[H]=new ba)).bind(i,this,X,Ee?Ee.getPaintVertexBuffers():[],K,Ze.vertexOffset,Pe,Ie,Re),Se.drawElements(h,Ze.primitiveLength*$e,Se.UNSIGNED_SHORT,Ze.primitiveOffset*$e*2)}}}function qr(E,i,h){const g=1/yi(h,1,i.transform.tileZoom),v=Math.pow(2,h.tileID.overscaledZ),T=h.tileSize*Math.pow(2,i.transform.tileZoom)/v,z=T*(h.tileID.canonical.x+h.tileID.wrap*v),O=T*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[z>>16,O>>16],u_pixel_coord_lower:[65535&z,65535&O]}}const Ko=(E,i,h,g)=>{const v=i.style.light,T=v.properties.get("position"),z=[T.x,T.y,T.z],O=(function(){var H=new d.A(9);return d.A!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[5]=0,H[6]=0,H[7]=0),H[0]=1,H[4]=1,H[8]=1,H})();v.properties.get("anchor")==="viewport"&&(function(H,X){var K=Math.sin(X),ae=Math.cos(X);H[0]=ae,H[1]=K,H[2]=0,H[3]=-K,H[4]=ae,H[5]=0,H[6]=0,H[7]=0,H[8]=1})(O,-i.transform.angle),(function(H,X,K){var ae=X[0],fe=X[1],_e=X[2];H[0]=ae*K[0]+fe*K[3]+_e*K[6],H[1]=ae*K[1]+fe*K[4]+_e*K[7],H[2]=ae*K[2]+fe*K[5]+_e*K[8]})(z,z,O);const U=v.properties.get("color");return{u_matrix:E,u_lightpos:z,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+h,u_opacity:g}},oo=(E,i,h,g,v,T,z)=>d.e(Ko(E,i,h,g),qr(T,i,z),{u_height_factor:-Math.pow(2,v.overscaledZ)/z.tileSize/8}),lo=E=>({u_matrix:E}),Ll=(E,i,h,g)=>d.e(lo(E),qr(h,i,g)),Ic=(E,i)=>({u_matrix:E,u_world:i}),Lc=(E,i,h,g,v)=>d.e(Ll(E,i,h,g),{u_world:v}),zl=(E,i,h,g)=>{const v=E.transform;let T,z;if(g.paint.get("circle-pitch-alignment")==="map"){const O=yi(h,1,v.zoom);T=!0,z=[O,O]}else T=!1,z=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:E.translatePosMatrix(i.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+T,u_device_pixel_ratio:E.pixelRatio,u_extrude_scale:z}},Us=(E,i,h)=>({u_matrix:E,u_inv_matrix:i,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}),Po=(E,i,h=1)=>({u_matrix:E,u_color:i,u_overlay:0,u_overlay_scale:h}),Fs=E=>({u_matrix:E}),Ds=(E,i,h,g)=>({u_matrix:E,u_extrude_scale:yi(i,1,h),u_intensity:g}),Ii=(E,i,h,g)=>{const v=d.H();d.aP(v,0,E.width,E.height,0,0,1);const T=E.context.gl;return{u_matrix:v,u_world:[T.drawingBufferWidth,T.drawingBufferHeight],u_image:h,u_color_ramp:g,u_opacity:i.paint.get("heatmap-opacity")}};function jr(E,i){const h=Math.pow(2,i.canonical.z),g=i.canonical.y;return[new d.Z(0,g/h).toLngLat().lat,new d.Z(0,(g+1)/h).toLngLat().lat]}const jn=(E,i,h,g)=>{const v=E.transform;return{u_matrix:ra(E,i,h,g),u_ratio:1/yi(i,1,v.zoom),u_device_pixel_ratio:E.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},zc=(E,i,h,g,v)=>d.e(jn(E,i,h,v),{u_image:0,u_image_height:g}),sa=(E,i,h,g,v)=>{const T=E.transform,z=Rl(i,T);return{u_matrix:ra(E,i,h,v),u_texsize:i.imageAtlasTexture.size,u_ratio:1/yi(i,1,T.zoom),u_device_pixel_ratio:E.pixelRatio,u_image:0,u_scale:[z,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},wa=(E,i,h,g,v,T)=>{const z=E.lineAtlas,O=Rl(i,E.transform),U=h.layout.get("line-cap")==="round",H=z.getDash(g.from,U),X=z.getDash(g.to,U),K=H.width*v.fromScale,ae=X.width*v.toScale;return d.e(jn(E,i,h,T),{u_patternscale_a:[O/K,-H.height/2],u_patternscale_b:[O/ae,-X.height/2],u_sdfgamma:z.width/(256*Math.min(K,ae)*E.pixelRatio)/2,u_image:0,u_tex_y_a:H.y,u_tex_y_b:X.y,u_mix:v.t})};function Rl(E,i){return 1/yi(E,1,i.tileZoom)}function ra(E,i,h,g){return E.translatePosMatrix(g?g.posMatrix:i.tileID.posMatrix,i,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const Ba=(E,i,h,g,v)=>{return{u_matrix:E,u_tl_parent:i,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(z=v.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(T=v.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Jo(v.paint.get("raster-hue-rotate"))};var T,z};function Jo(E){E*=Math.PI/180;const i=Math.sin(E),h=Math.cos(E);return[(2*h+1)/3,(-Math.sqrt(3)*i-h+1)/3,(Math.sqrt(3)*i-h+1)/3]}const bs=(E,i,h,g,v,T,z,O,U,H,X,K,ae,fe)=>{const _e=z.transform;return{u_is_size_zoom_constant:+(E==="constant"||E==="source"),u_is_size_feature_constant:+(E==="constant"||E==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_pitch:_e.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:_e.width/_e.height,u_fade_change:z.options.fadeDuration?z.symbolFadeChange:1,u_matrix:O,u_label_plane_matrix:U,u_coord_matrix:H,u_is_text:+K,u_pitch_with_map:+g,u_is_along_line:v,u_is_variable_anchor:T,u_texsize:ae,u_texture:0,u_translation:X,u_pitched_scale:fe}},aa=(E,i,h,g,v,T,z,O,U,H,X,K,ae,fe,_e)=>{const Ee=z.transform;return d.e(bs(E,i,h,g,v,T,z,O,U,H,X,K,ae,_e),{u_gamma_scale:g?Math.cos(Ee._pitch)*Ee.cameraToCenterDistance:1,u_device_pixel_ratio:z.pixelRatio,u_is_halo:1})},Qo=(E,i,h,g,v,T,z,O,U,H,X,K,ae,fe)=>d.e(aa(E,i,h,g,v,T,z,O,U,H,X,!0,K,!0,fe),{u_texsize_icon:ae,u_texture_icon:1}),jo=(E,i,h)=>({u_matrix:E,u_opacity:i,u_color:h}),Rc=(E,i,h,g,v,T)=>d.e((function(z,O,U,H){const X=U.imageManager.getPattern(z.from.toString()),K=U.imageManager.getPattern(z.to.toString()),{width:ae,height:fe}=U.imageManager.getPixelSize(),_e=Math.pow(2,H.tileID.overscaledZ),Ee=H.tileSize*Math.pow(2,U.transform.tileZoom)/_e,Pe=Ee*(H.tileID.canonical.x+H.tileID.wrap*_e),Ie=Ee*H.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:X.tl,u_pattern_br_a:X.br,u_pattern_tl_b:K.tl,u_pattern_br_b:K.br,u_texsize:[ae,fe],u_mix:O.t,u_pattern_size_a:X.displaySize,u_pattern_size_b:K.displaySize,u_scale_a:O.fromScale,u_scale_b:O.toScale,u_tile_units_to_pixels:1/yi(H,1,U.transform.tileZoom),u_pixel_coord_upper:[Pe>>16,Ie>>16],u_pixel_coord_lower:[65535&Pe,65535&Ie]}})(g,T,h,v),{u_matrix:E,u_opacity:i}),Ks={fillExtrusion:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_lightpos:new d.aN(E,i.u_lightpos),u_lightintensity:new d.aI(E,i.u_lightintensity),u_lightcolor:new d.aN(E,i.u_lightcolor),u_vertical_gradient:new d.aI(E,i.u_vertical_gradient),u_opacity:new d.aI(E,i.u_opacity)}),fillExtrusionPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_lightpos:new d.aN(E,i.u_lightpos),u_lightintensity:new d.aI(E,i.u_lightintensity),u_lightcolor:new d.aN(E,i.u_lightcolor),u_vertical_gradient:new d.aI(E,i.u_vertical_gradient),u_height_factor:new d.aI(E,i.u_height_factor),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade),u_opacity:new d.aI(E,i.u_opacity)}),fill:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix)}),fillPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),fillOutline:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world)}),fillOutlinePattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),circle:(E,i)=>({u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_scale_with_map:new d.aH(E,i.u_scale_with_map),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_extrude_scale:new d.aO(E,i.u_extrude_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_matrix:new d.aJ(E,i.u_matrix)}),collisionBox:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_pixel_extrude_scale:new d.aO(E,i.u_pixel_extrude_scale)}),collisionCircle:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_inv_matrix:new d.aJ(E,i.u_inv_matrix),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_viewport_size:new d.aO(E,i.u_viewport_size)}),debug:(E,i)=>({u_color:new d.aL(E,i.u_color),u_matrix:new d.aJ(E,i.u_matrix),u_overlay:new d.aH(E,i.u_overlay),u_overlay_scale:new d.aI(E,i.u_overlay_scale)}),clippingMask:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix)}),heatmap:(E,i)=>({u_extrude_scale:new d.aI(E,i.u_extrude_scale),u_intensity:new d.aI(E,i.u_intensity),u_matrix:new d.aJ(E,i.u_matrix)}),heatmapTexture:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world),u_image:new d.aH(E,i.u_image),u_color_ramp:new d.aH(E,i.u_color_ramp),u_opacity:new d.aI(E,i.u_opacity)}),hillshade:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_latrange:new d.aO(E,i.u_latrange),u_light:new d.aO(E,i.u_light),u_shadow:new d.aL(E,i.u_shadow),u_highlight:new d.aL(E,i.u_highlight),u_accent:new d.aL(E,i.u_accent)}),hillshadePrepare:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_dimension:new d.aO(E,i.u_dimension),u_zoom:new d.aI(E,i.u_zoom),u_unpack:new d.aK(E,i.u_unpack)}),line:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels)}),lineGradient:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_image:new d.aH(E,i.u_image),u_image_height:new d.aI(E,i.u_image_height)}),linePattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texsize:new d.aO(E,i.u_texsize),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_image:new d.aH(E,i.u_image),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),lineSDF:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_patternscale_a:new d.aO(E,i.u_patternscale_a),u_patternscale_b:new d.aO(E,i.u_patternscale_b),u_sdfgamma:new d.aI(E,i.u_sdfgamma),u_image:new d.aH(E,i.u_image),u_tex_y_a:new d.aI(E,i.u_tex_y_a),u_tex_y_b:new d.aI(E,i.u_tex_y_b),u_mix:new d.aI(E,i.u_mix)}),raster:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_tl_parent:new d.aO(E,i.u_tl_parent),u_scale_parent:new d.aI(E,i.u_scale_parent),u_buffer_scale:new d.aI(E,i.u_buffer_scale),u_fade_t:new d.aI(E,i.u_fade_t),u_opacity:new d.aI(E,i.u_opacity),u_image0:new d.aH(E,i.u_image0),u_image1:new d.aH(E,i.u_image1),u_brightness_low:new d.aI(E,i.u_brightness_low),u_brightness_high:new d.aI(E,i.u_brightness_high),u_saturation_factor:new d.aI(E,i.u_saturation_factor),u_contrast_factor:new d.aI(E,i.u_contrast_factor),u_spin_weights:new d.aN(E,i.u_spin_weights)}),symbolIcon:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texture:new d.aH(E,i.u_texture),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),symbolSDF:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texture:new d.aH(E,i.u_texture),u_gamma_scale:new d.aI(E,i.u_gamma_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_is_halo:new d.aH(E,i.u_is_halo),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),symbolTextAndIcon:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texsize_icon:new d.aO(E,i.u_texsize_icon),u_texture:new d.aH(E,i.u_texture),u_texture_icon:new d.aH(E,i.u_texture_icon),u_gamma_scale:new d.aI(E,i.u_gamma_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_is_halo:new d.aH(E,i.u_is_halo),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),background:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_opacity:new d.aI(E,i.u_opacity),u_color:new d.aL(E,i.u_color)}),backgroundPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_opacity:new d.aI(E,i.u_opacity),u_image:new d.aH(E,i.u_image),u_pattern_tl_a:new d.aO(E,i.u_pattern_tl_a),u_pattern_br_a:new d.aO(E,i.u_pattern_br_a),u_pattern_tl_b:new d.aO(E,i.u_pattern_tl_b),u_pattern_br_b:new d.aO(E,i.u_pattern_br_b),u_texsize:new d.aO(E,i.u_texsize),u_mix:new d.aI(E,i.u_mix),u_pattern_size_a:new d.aO(E,i.u_pattern_size_a),u_pattern_size_b:new d.aO(E,i.u_pattern_size_b),u_scale_a:new d.aI(E,i.u_scale_a),u_scale_b:new d.aI(E,i.u_scale_b),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_tile_units_to_pixels:new d.aI(E,i.u_tile_units_to_pixels)}),terrain:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texture:new d.aH(E,i.u_texture),u_ele_delta:new d.aI(E,i.u_ele_delta),u_fog_matrix:new d.aJ(E,i.u_fog_matrix),u_fog_color:new d.aL(E,i.u_fog_color),u_fog_ground_blend:new d.aI(E,i.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.aI(E,i.u_fog_ground_blend_opacity),u_horizon_color:new d.aL(E,i.u_horizon_color),u_horizon_fog_blend:new d.aI(E,i.u_horizon_fog_blend)}),terrainDepth:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ele_delta:new d.aI(E,i.u_ele_delta)}),terrainCoords:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texture:new d.aH(E,i.u_texture),u_terrain_coords_id:new d.aI(E,i.u_terrain_coords_id),u_ele_delta:new d.aI(E,i.u_ele_delta)}),sky:(E,i)=>({u_sky_color:new d.aL(E,i.u_sky_color),u_horizon_color:new d.aL(E,i.u_horizon_color),u_horizon:new d.aI(E,i.u_horizon),u_sky_horizon_blend:new d.aI(E,i.u_sky_horizon_blend)})};class Vs{constructor(i,h,g){this.context=i;const v=i.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const h=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Dc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Io{constructor(i,h,g,v){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=i;const T=i.gl;this.buffer=T.createBuffer(),i.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,h){for(let g=0;g<this.attributes.length;g++){const v=h.attributes[this.attributes[g].name];v!==void 0&&i.enableVertexAttribArray(v)}}setVertexAttribPointers(i,h,g){for(let v=0;v<this.attributes.length;v++){const T=this.attributes[v],z=h.attributes[T.name];z!==void 0&&i.vertexAttribPointer(z,T.components,i[Dc[T.type]],!1,this.itemSize,T.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ki=new WeakMap;function $a(E){var i;if(Ki.has(E))return Ki.get(E);{const h=(i=E.getParameter(E.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return Ki.set(E,h),h}}class $i{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class oa extends $i{getDefault(){return d.aM.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class tc extends $i{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class el extends $i{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class _u extends $i{getDefault(){return[!0,!0,!0,!0]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class eh extends $i{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class th extends $i{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Oc extends $i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const h=this.current;(i.func!==h.func||i.ref!==h.ref||i.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class vu extends $i{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Nc extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=i,this.dirty=!1}}class ih extends $i{getDefault(){return[0,1]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Sa extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=i,this.dirty=!1}}class nh extends $i{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class co extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.BLEND):h.disable(h.BLEND),this.current=i,this.dirty=!1}}class uo extends $i{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class sh extends $i{getDefault(){return d.aM.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class xu extends $i{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class tl extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=i,this.dirty=!1}}class bu extends $i{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class ic extends $i{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class rh extends $i{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Kh extends $i{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class wu extends $i{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Bc extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class ah extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class $c extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Su extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class il extends $i{getDefault(){return null}set(i){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class xr extends $i{getDefault(){return null}set(i){var h;if(i===this.current&&!this.dirty)return;const g=this.gl;$a(g)?g.bindVertexArray(i):(h=g.getExtension("OES_vertex_array_object"))===null||h===void 0||h.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Tu extends $i{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class nl extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Ir extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class sl extends $i{constructor(i,h){super(i),this.context=i,this.parent=h}getDefault(){return null}}class Lo extends sl{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class rl extends sl{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Dl extends sl{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Uc{constructor(i,h,g,v,T){this.context=i,this.width=h,this.height=g;const z=i.gl,O=this.framebuffer=z.createFramebuffer();if(this.colorAttachment=new Lo(i,O),v)this.depthAttachment=T?new Dl(i,O):new rl(i,O);else if(T)throw new Error("Stencil cannot be set without depth");if(z.checkFramebufferStatus(z.FRAMEBUFFER)!==z.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,h=this.colorAttachment.get();if(h&&i.deleteTexture(h),this.depthAttachment){const g=this.depthAttachment.get();g&&i.deleteRenderbuffer(g)}i.deleteFramebuffer(this.framebuffer)}}class fs{constructor(i,h,g){this.blendFunction=i,this.blendColor=h,this.mask=g}}fs.Replace=[1,0],fs.disabled=new fs(fs.Replace,d.aM.transparent,[!1,!1,!1,!1]),fs.unblended=new fs(fs.Replace,d.aM.transparent,[!0,!0,!0,!0]),fs.alphaBlended=new fs([1,771],d.aM.transparent,[!0,!0,!0,!0]);class oh{constructor(i){var h,g;if(this.gl=i,this.clearColor=new oa(this),this.clearDepth=new tc(this),this.clearStencil=new el(this),this.colorMask=new _u(this),this.depthMask=new eh(this),this.stencilMask=new th(this),this.stencilFunc=new Oc(this),this.stencilOp=new vu(this),this.stencilTest=new Nc(this),this.depthRange=new ih(this),this.depthTest=new Sa(this),this.depthFunc=new nh(this),this.blend=new co(this),this.blendFunc=new uo(this),this.blendColor=new sh(this),this.blendEquation=new xu(this),this.cullFace=new tl(this),this.cullFaceSide=new bu(this),this.frontFace=new ic(this),this.program=new rh(this),this.activeTexture=new Kh(this),this.viewport=new wu(this),this.bindFramebuffer=new Bc(this),this.bindRenderbuffer=new ah(this),this.bindTexture=new $c(this),this.bindVertexBuffer=new Su(this),this.bindElementBuffer=new il(this),this.bindVertexArray=new xr(this),this.pixelStoreUnpack=new Tu(this),this.pixelStoreUnpackPremultiplyAlpha=new nl(this),this.pixelStoreUnpackFlipY=new Ir(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),$a(i)){this.HALF_FLOAT=i.HALF_FLOAT;const v=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(h=i.RGBA16F)!==null&&h!==void 0?h:v?.RGBA16F_EXT,this.RGB16F=(g=i.RGB16F)!==null&&g!==void 0?g:v?.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const v=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,h){return new Vs(this,i,h)}createVertexBuffer(i,h,g){return new Io(this,i,h,g)}createRenderbuffer(i,h,g){const v=this.gl,T=v.createRenderbuffer();return this.bindRenderbuffer.set(T),v.renderbufferStorage(v.RENDERBUFFER,i,h,g),this.bindRenderbuffer.set(null),T}createFramebuffer(i,h,g,v){return new Uc(this,i,h,g,v)}clear({color:i,depth:h,stencil:g}){const v=this.gl;let T=0;i&&(T|=v.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(T|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g!==void 0&&(T|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),v.clear(T)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){d.aE(i.blendFunction,fs.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return $a(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var h;return $a(this.gl)?this.gl.deleteVertexArray(i):(h=this.gl.getExtension("OES_vertex_array_object"))===null||h===void 0?void 0:h.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class qi{constructor(i,h,g){this.func=i,this.mask=h,this.range=g}}qi.ReadOnly=!1,qi.ReadWrite=!0,qi.disabled=new qi(519,qi.ReadOnly,[0,1]);const ho=7680;class hn{constructor(i,h,g,v,T,z){this.test=i,this.ref=h,this.mask=g,this.fail=v,this.depthFail=T,this.pass=z}}hn.disabled=new hn({func:519,mask:0},0,0,ho,ho,ho);class wn{constructor(i,h,g){this.enable=i,this.mode=h,this.frontFace=g}}let al;function Lr(E,i,h,g,v){const T=E.context,z=T.gl,O=E.useProgram("collisionBox"),U=[];let H=0,X=0;for(let Ie=0;Ie<g.length;Ie++){const Re=g[Ie],Se=i.getTile(Re).getBucket(h);if(!Se)continue;const $e=v?Se.textCollisionBox:Se.iconCollisionBox,Ze=Se.collisionCircleArray;if(Ze.length>0){const nt=d.H();d.aQ(nt,Se.placementInvProjMatrix,E.transform.glCoordMatrix),d.aQ(nt,nt,Se.placementViewportMatrix),U.push({circleArray:Ze,circleOffset:X,transform:Re.posMatrix,invTransform:nt,coord:Re}),H+=Ze.length/4,X=H}$e&&O.draw(T,z.LINES,qi.disabled,hn.disabled,E.colorModeForRenderPass(),wn.disabled,{u_matrix:Re.posMatrix,u_pixel_extrude_scale:[1/(K=E.transform).width,1/K.height]},E.style.map.terrain&&E.style.map.terrain.getTerrainData(Re),h.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,null,E.transform.zoom,null,null,$e.collisionVertexBuffer)}var K;if(!v||!U.length)return;const ae=E.useProgram("collisionCircle"),fe=new d.aR;fe.resize(4*H),fe._trim();let _e=0;for(const Ie of U)for(let Re=0;Re<Ie.circleArray.length/4;Re++){const Se=4*Re,$e=Ie.circleArray[Se+0],Ze=Ie.circleArray[Se+1],nt=Ie.circleArray[Se+2],bt=Ie.circleArray[Se+3];fe.emplace(_e++,$e,Ze,nt,bt,0),fe.emplace(_e++,$e,Ze,nt,bt,1),fe.emplace(_e++,$e,Ze,nt,bt,2),fe.emplace(_e++,$e,Ze,nt,bt,3)}(!al||al.length<2*H)&&(al=(function(Ie){const Re=2*Ie,Se=new d.aT;Se.resize(Re),Se._trim();for(let $e=0;$e<Re;$e++){const Ze=6*$e;Se.uint16[Ze+0]=4*$e+0,Se.uint16[Ze+1]=4*$e+1,Se.uint16[Ze+2]=4*$e+2,Se.uint16[Ze+3]=4*$e+2,Se.uint16[Ze+4]=4*$e+3,Se.uint16[Ze+5]=4*$e+0}return Se})(H));const Ee=T.createIndexBuffer(al,!0),Pe=T.createVertexBuffer(fe,d.aS.members,!0);for(const Ie of U){const Re=Us(Ie.transform,Ie.invTransform,E.transform);ae.draw(T,z.TRIANGLES,qi.disabled,hn.disabled,E.colorModeForRenderPass(),wn.disabled,Re,E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ie.coord),h.id,Pe,Ee,d.a0.simpleSegment(0,2*Ie.circleOffset,Ie.circleArray.length,Ie.circleArray.length/2),null,E.transform.zoom,null,null,null)}Pe.destroy(),Ee.destroy()}wn.disabled=new wn(!1,1029,2305),wn.backCCW=new wn(!0,1029,2305);const Ol=d.an(new Float32Array(16));function la(E,i,h,g,v,T){const{horizontalAlign:z,verticalAlign:O}=d.au(E);return new d.P((-(z-.5)*i/v+g[0])*T,(-(O-.5)*h/v+g[1])*T)}function Ta(E,i,h,g,v,T){const z=i.tileAnchorPoint.add(new d.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let O=g.mult(T);h||(O=O.rotate(-v));const U=z.add(O);return we(U.x,U.y,i.labelPlaneMatrix,i.getElevation).point}if(h){const O=Ge(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(E),U=Math.atan(O.y/O.x)+(O.x<0?Math.PI:0);return E.add(g.rotate(U))}return E.add(g)}function Ua(E,i,h,g,v,T,z,O,U,H,X,K,ae,fe){const _e=E.text.placedSymbolArray,Ee=E.text.dynamicLayoutVertexArray,Pe=E.icon.dynamicLayoutVertexArray,Ie={};Ee.clear();for(let Re=0;Re<_e.length;Re++){const Se=_e.get(Re),$e=Se.hidden||!Se.crossTileID||E.allowVerticalPlacement&&!Se.placedOrientation?null:g[Se.crossTileID];if($e){const Ze=new d.P(Se.anchorX,Se.anchorY),nt={getElevation:fe,width:v.width,height:v.height,labelPlaneMatrix:T,pitchWithMap:h,projection:X,tileAnchorPoint:Ze,translation:K,unwrappedTileID:ae},bt=h?we(Ze.x,Ze.y,z,fe):Ge(Ze.x,Ze.y,nt),$t=te(v.cameraToCenterDistance,bt.signedDistanceFromCamera);let Vt=d.ai(E.textSizeData,U,Se)*$t/d.ap;h&&(Vt*=E.tilePixelRatio/O);const{width:ti,height:qt,anchor:Ut,textOffset:ai,textBoxScale:Ai}=$e,Ht=la(Ut,ti,qt,ai,Ai,Vt),Yt=X.getPitchedTextCorrection(v,Ze.add(new d.P(K[0],K[1])),ae),Ci=Ta(bt.point,nt,i,Ht,v.angle,Yt),Fn=E.allowVerticalPlacement&&Se.placedOrientation===d.ah.vertical?Math.PI/2:0;for(let Hi=0;Hi<Se.numGlyphs;Hi++)d.aj(Ee,Ci,Fn);H&&Se.associatedIconIndex>=0&&(Ie[Se.associatedIconIndex]={shiftedAnchor:Ci,angle:Fn})}else si(Se.numGlyphs,Ee)}if(H){Pe.clear();const Re=E.icon.placedSymbolArray;for(let Se=0;Se<Re.length;Se++){const $e=Re.get(Se);if($e.hidden)si($e.numGlyphs,Pe);else{const Ze=Ie[Se];if(Ze)for(let nt=0;nt<$e.numGlyphs;nt++)d.aj(Pe,Ze.shiftedAnchor,Ze.angle);else si($e.numGlyphs,Pe)}}E.icon.dynamicLayoutVertexBuffer.updateData(Pe)}E.text.dynamicLayoutVertexBuffer.updateData(Ee)}function rr(E,i,h){return h.iconsInText&&i?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function ol(E,i,h,g,v,T,z,O,U,H,X,K){const ae=E.context,fe=ae.gl,_e=E.transform,Ee=xa(),Pe=O==="map",Ie=U==="map",Re=O!=="viewport"&&h.layout.get("symbol-placement")!=="point",Se=Pe&&!Ie&&!Re,$e=!Ie&&Re,Ze=!h.layout.get("symbol-sort-key").isConstant();let nt=!1;const bt=E.depthModeForSublayer(0,qi.ReadOnly),$t=h._unevaluatedLayout.hasValue("text-variable-anchor")||h._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Vt=[],ti=Ee.getCircleRadiusCorrection(_e);for(const qt of g){const Ut=i.getTile(qt),ai=Ut.getBucket(h);if(!ai)continue;const Ai=v?ai.text:ai.icon;if(!Ai||!Ai.segments.get().length||!Ai.hasVisibleVertices)continue;const Ht=Ai.programConfigurations.get(h.id),Yt=v||ai.sdfIcons,Ci=v?ai.textSizeData:ai.iconSizeData,Fn=Ie||_e.pitch!==0,Hi=E.useProgram(rr(Yt,v,ai),Ht),an=d.ag(Ci,_e.zoom),Nn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(qt);let er,Ga,Xn,Rr,rs=[0,0],as=null;if(v)Ga=Ut.glyphAtlasTexture,Xn=fe.LINEAR,er=Ut.glyphAtlasTexture.size,ai.iconsInText&&(rs=Ut.imageAtlasTexture.size,as=Ut.imageAtlasTexture,Rr=Fn||E.options.rotating||E.options.zooming||Ci.kind==="composite"||Ci.kind==="camera"?fe.LINEAR:fe.NEAREST);else{const Qi=h.layout.get("icon-size").constantOr(0)!==1||ai.iconsNeedLinear;Ga=Ut.imageAtlasTexture,Xn=Yt||E.options.rotating||E.options.zooming||Qi||Fn?fe.LINEAR:fe.NEAREST,er=Ut.imageAtlasTexture.size}const Ps=yi(Ut,1,E.transform.zoom),Wa=$e?qt.posMatrix:Ol,hc=Zn(Wa,Ie,Pe,E.transform,Ps),_o=rn(Wa,Ie,Pe,E.transform,Ps),ar=rn(qt.posMatrix,Ie,Pe,E.transform,Ps),Ln=Ee.translatePosition(E.transform,Ut,T,z),dc=$t&&ai.hasTextData(),vo=h.layout.get("icon-text-fit")!=="none"&&dc&&ai.hasIconData();if(Re){const Qi=E.style.map.terrain?(Zc,ls)=>E.style.map.terrain.getElevation(qt,Zc,ls):null,Ya=h.layout.get("text-rotation-alignment")==="map";oe(ai,qt.posMatrix,E,v,hc,ar,Ie,H,Ya,Ee,qt.toUnwrapped(),_e.width,_e.height,Ln,Qi)}const ji=qt.posMatrix,dn=v&&$t||vo,os=Re||dn?Ol:hc,fa=_o,js=Yt&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Is;Is=Yt?ai.iconsInText?Qo(Ci.kind,an,Se,Ie,Re,dn,E,ji,os,fa,Ln,er,rs,ti):aa(Ci.kind,an,Se,Ie,Re,dn,E,ji,os,fa,Ln,v,er,!0,ti):bs(Ci.kind,an,Se,Ie,Re,dn,E,ji,os,fa,Ln,v,er,ti);const Dr={program:Hi,buffers:Ai,uniformValues:Is,atlasTexture:Ga,atlasTextureIcon:as,atlasInterpolation:Xn,atlasInterpolationIcon:Rr,isSDF:Yt,hasHalo:js};if(Ze&&ai.canOverlap){nt=!0;const Qi=Ai.segments.get();for(const Ya of Qi)Vt.push({segments:new d.a0([Ya]),sortKey:Ya.sortKey,state:Dr,terrainData:Nn})}else Vt.push({segments:Ai.segments,sortKey:0,state:Dr,terrainData:Nn})}nt&&Vt.sort(((qt,Ut)=>qt.sortKey-Ut.sortKey));for(const qt of Vt){const Ut=qt.state;if(ae.activeTexture.set(fe.TEXTURE0),Ut.atlasTexture.bind(Ut.atlasInterpolation,fe.CLAMP_TO_EDGE),Ut.atlasTextureIcon&&(ae.activeTexture.set(fe.TEXTURE1),Ut.atlasTextureIcon&&Ut.atlasTextureIcon.bind(Ut.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),Ut.isSDF){const ai=Ut.uniformValues;Ut.hasHalo&&(ai.u_is_halo=1,Fc(Ut.buffers,qt.segments,h,E,Ut.program,bt,X,K,ai,qt.terrainData)),ai.u_is_halo=0}Fc(Ut.buffers,qt.segments,h,E,Ut.program,bt,X,K,Ut.uniformValues,qt.terrainData)}}function Fc(E,i,h,g,v,T,z,O,U,H){const X=g.context;v.draw(X,X.gl.TRIANGLES,T,z,O,wn.disabled,U,H,h.id,E.layoutVertexBuffer,E.indexBuffer,i,h.paint,g.transform.zoom,E.programConfigurations.get(h.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function ca(E,i,h,g){const v=E.context,T=v.gl,z=hn.disabled,O=new fs([T.ONE,T.ONE],d.aM.transparent,[!0,!0,!0,!0]),U=i.getBucket(h);if(!U)return;const H=g.key;let X=h.heatmapFbos.get(H);X||(X=Nl(v,i.tileSize,i.tileSize),h.heatmapFbos.set(H,X)),v.bindFramebuffer.set(X.framebuffer),v.viewport.set([0,0,i.tileSize,i.tileSize]),v.clear({color:d.aM.transparent});const K=U.programConfigurations.get(h.id),ae=E.useProgram("heatmap",K),fe=E.style.map.terrain.getTerrainData(g);ae.draw(v,T.TRIANGLES,qi.disabled,z,O,wn.disabled,Ds(g.posMatrix,i,E.transform.zoom,h.paint.get("heatmap-intensity")),fe,h.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,h.paint,E.transform.zoom,K)}function ua(E,i,h){const g=E.context,v=g.gl;g.setColorMode(E.colorModeForRenderPass());const T=zo(g,i),z=h.key,O=i.heatmapFbos.get(z);O&&(g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,O.colorAttachment.get()),g.activeTexture.set(v.TEXTURE1),T.bind(v.LINEAR,v.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(g,v.TRIANGLES,qi.disabled,hn.disabled,E.colorModeForRenderPass(),wn.disabled,Ii(E,i,0,1),null,i.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments,i.paint,E.transform.zoom),O.destroy(),i.heatmapFbos.delete(z))}function Nl(E,i,h){var g,v;const T=E.gl,z=T.createTexture();T.bindTexture(T.TEXTURE_2D,z),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR);const O=(g=E.HALF_FLOAT)!==null&&g!==void 0?g:T.UNSIGNED_BYTE,U=(v=E.RGBA16F)!==null&&v!==void 0?v:T.RGBA;T.texImage2D(T.TEXTURE_2D,0,U,i,h,0,T.RGBA,O,null);const H=E.createFramebuffer(i,h,!1,!1);return H.colorAttachment.set(z),H}function zo(E,i){return i.colorRampTexture||(i.colorRampTexture=new lt(E,i.colorRamp,E.gl.RGBA)),i.colorRampTexture}function ll(E,i,h,g,v){if(!h||!g||!g.imageAtlas)return;const T=g.imageAtlas.patternPositions;let z=T[h.to.toString()],O=T[h.from.toString()];if(!z&&O&&(z=O),!O&&z&&(O=z),!z||!O){const U=v.getPaintProperty(i);z=T[U],O=T[U]}z&&O&&E.setConstantPatternPositions(z,O)}function Hr(E,i,h,g,v,T,z){const O=E.context.gl,U="fill-pattern",H=h.paint.get(U),X=H&&H.constantOr(1),K=h.getCrossfadeParameters();let ae,fe,_e,Ee,Pe;z?(fe=X&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ae=O.LINES):(fe=X?"fillPattern":"fill",ae=O.TRIANGLES);const Ie=H.constantOr(null);for(const Re of g){const Se=i.getTile(Re);if(X&&!Se.patternsLoaded())continue;const $e=Se.getBucket(h);if(!$e)continue;const Ze=$e.programConfigurations.get(h.id),nt=E.useProgram(fe,Ze),bt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Re);X&&(E.context.activeTexture.set(O.TEXTURE0),Se.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ze.updatePaintBuffers(K)),ll(Ze,U,Ie,Se,h);const $t=bt?Re:null,Vt=E.translatePosMatrix($t?$t.posMatrix:Re.posMatrix,Se,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(z){Ee=$e.indexBuffer2,Pe=$e.segments2;const ti=[O.drawingBufferWidth,O.drawingBufferHeight];_e=fe==="fillOutlinePattern"&&X?Lc(Vt,E,K,Se,ti):Ic(Vt,ti)}else Ee=$e.indexBuffer,Pe=$e.segments,_e=X?Ll(Vt,E,K,Se):lo(Vt);nt.draw(E.context,ae,v,E.stencilModeForClipping(Re),T,wn.disabled,_e,bt,h.id,$e.layoutVertexBuffer,Ee,Pe,h.paint,E.transform.zoom,Ze)}}function Vc(E,i,h,g,v,T,z){const O=E.context,U=O.gl,H="fill-extrusion-pattern",X=h.paint.get(H),K=X.constantOr(1),ae=h.getCrossfadeParameters(),fe=h.paint.get("fill-extrusion-opacity"),_e=X.constantOr(null);for(const Ee of g){const Pe=i.getTile(Ee),Ie=Pe.getBucket(h);if(!Ie)continue;const Re=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ee),Se=Ie.programConfigurations.get(h.id),$e=E.useProgram(K?"fillExtrusionPattern":"fillExtrusion",Se);K&&(E.context.activeTexture.set(U.TEXTURE0),Pe.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Se.updatePaintBuffers(ae)),ll(Se,H,_e,Pe,h);const Ze=E.translatePosMatrix(Ee.posMatrix,Pe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),nt=h.paint.get("fill-extrusion-vertical-gradient"),bt=K?oo(Ze,E,nt,fe,Ee,ae,Pe):Ko(Ze,E,nt,fe);$e.draw(O,O.gl.TRIANGLES,v,T,z,wn.backCCW,bt,Re,h.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,h.paint,E.transform.zoom,Se,E.style.map.terrain&&Ie.centroidVertexBuffer)}}function Ea(E,i,h,g,v,T,z){const O=E.context,U=O.gl,H=h.fbo;if(!H)return;const X=E.useProgram("hillshade"),K=E.style.map.terrain&&E.style.map.terrain.getTerrainData(i);O.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,H.colorAttachment.get()),X.draw(O,U.TRIANGLES,v,T,z,wn.disabled,((ae,fe,_e,Ee)=>{const Pe=_e.paint.get("hillshade-shadow-color"),Ie=_e.paint.get("hillshade-highlight-color"),Re=_e.paint.get("hillshade-accent-color");let Se=_e.paint.get("hillshade-illumination-direction")*(Math.PI/180);_e.paint.get("hillshade-illumination-anchor")==="viewport"&&(Se-=ae.transform.angle);const $e=!ae.options.moving;return{u_matrix:Ee?Ee.posMatrix:ae.transform.calculatePosMatrix(fe.tileID.toUnwrapped(),$e),u_image:0,u_latrange:jr(0,fe.tileID),u_light:[_e.paint.get("hillshade-exaggeration"),Se],u_shadow:Pe,u_highlight:Ie,u_accent:Re}})(E,h,g,K?i:null),K,g.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}function Bl(E,i,h,g,v,T){const z=E.context,O=z.gl,U=i.dem;if(U&&U.data){const H=U.dim,X=U.stride,K=U.getPixels();if(z.activeTexture.set(O.TEXTURE1),z.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||E.getTileTexture(X),i.demTexture){const fe=i.demTexture;fe.update(K,{premultiply:!1}),fe.bind(O.NEAREST,O.CLAMP_TO_EDGE)}else i.demTexture=new lt(z,K,O.RGBA,{premultiply:!1}),i.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);z.activeTexture.set(O.TEXTURE0);let ae=i.fbo;if(!ae){const fe=new lt(z,{width:H,height:H,data:null},O.RGBA);fe.bind(O.LINEAR,O.CLAMP_TO_EDGE),ae=i.fbo=z.createFramebuffer(H,H,!0,!1),ae.colorAttachment.set(fe.texture)}z.bindFramebuffer.set(ae.framebuffer),z.viewport.set([0,0,H,H]),E.useProgram("hillshadePrepare").draw(z,O.TRIANGLES,g,v,T,wn.disabled,((fe,_e)=>{const Ee=_e.stride,Pe=d.H();return d.aP(Pe,0,d.X,-d.X,0,0,1),d.J(Pe,Pe,[0,-d.X,0]),{u_matrix:Pe,u_image:1,u_dimension:[Ee,Ee],u_zoom:fe.overscaledZ,u_unpack:_e.getUnpackVector()}})(i.tileID,U),null,h.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function Fa(E,i,h,g,v,T){const z=g.paint.get("raster-fade-duration");if(!T&&z>0){const O=N.now(),U=(O-E.timeAdded)/z,H=i?(O-i.timeAdded)/z:-1,X=h.getSource(),K=v.coveringZoomLevel({tileSize:X.tileSize,roundZoom:X.roundZoom}),ae=!i||Math.abs(i.tileID.overscaledZ-K)>Math.abs(E.tileID.overscaledZ-K),fe=ae&&E.refreshedUponExpiration?1:d.ac(ae?U:1-H,0,1);return E.refreshedUponExpiration&&U>=1&&(E.refreshedUponExpiration=!1),i?{opacity:1,mix:1-fe}:{opacity:fe,mix:0}}return{opacity:1,mix:0}}const qs=new d.aM(1,0,0,1),tn=new d.aM(0,1,0,1),cl=new d.aM(0,0,1,1),nc=new d.aM(1,0,1,1),sc=new d.aM(0,1,1,1);function Va(E,i,h,g){ul(E,0,i+h/2,E.transform.width,h,g)}function fo(E,i,h,g){ul(E,i-h/2,0,h,E.transform.height,g)}function ul(E,i,h,g,v,T){const z=E.context,O=z.gl;O.enable(O.SCISSOR_TEST),O.scissor(i*E.pixelRatio,h*E.pixelRatio,g*E.pixelRatio,v*E.pixelRatio),z.clear({color:T}),O.disable(O.SCISSOR_TEST)}function po(E,i,h){const g=E.context,v=g.gl,T=h.posMatrix,z=E.useProgram("debug"),O=qi.disabled,U=hn.disabled,H=E.colorModeForRenderPass(),X="$debug",K=E.style.map.terrain&&E.style.map.terrain.getTerrainData(h);g.activeTexture.set(v.TEXTURE0);const ae=i.getTileByID(h.key).latestRawTileData,fe=Math.floor((ae&&ae.byteLength||0)/1024),_e=i.getTile(h).tileSize,Ee=512/Math.min(_e,512)*(h.overscaledZ/E.transform.zoom)*.5;let Pe=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Pe+=` => ${h.overscaledZ}`),(function(Ie,Re){Ie.initDebugOverlayCanvas();const Se=Ie.debugOverlayCanvas,$e=Ie.context.gl,Ze=Ie.debugOverlayCanvas.getContext("2d");Ze.clearRect(0,0,Se.width,Se.height),Ze.shadowColor="white",Ze.shadowBlur=2,Ze.lineWidth=1.5,Ze.strokeStyle="white",Ze.textBaseline="top",Ze.font="bold 36px Open Sans, sans-serif",Ze.fillText(Re,5,5),Ze.strokeText(Re,5,5),Ie.debugOverlayTexture.update(Se),Ie.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)})(E,`${Pe} ${fe}kB`),z.draw(g,v.TRIANGLES,O,U,fs.alphaBlended,wn.disabled,Po(T,d.aM.transparent,Ee),null,X,E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments),z.draw(g,v.LINE_STRIP,O,U,H,wn.disabled,Po(T,d.aM.red),K,X,E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments)}function rc(E,i,h){const g=E.context,v=g.gl,T=E.colorModeForRenderPass(),z=new qi(v.LEQUAL,qi.ReadWrite,E.depthRangeFor3D),O=E.useProgram("terrain"),U=i.getTerrainMesh();g.bindFramebuffer.set(null),g.viewport.set([0,0,E.width,E.height]);for(const H of h){const X=E.renderToTexture.getTexture(H),K=i.getTerrainData(H.tileID);g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,X.texture);const ae=E.transform.calculatePosMatrix(H.tileID.toUnwrapped()),fe=i.getMeshFrameDelta(E.transform.zoom),_e=E.transform.calculateFogMatrix(H.tileID.toUnwrapped()),Ee=Gn(ae,fe,_e,E.style.sky,E.transform.pitch);O.draw(g,v.TRIANGLES,z,hn.disabled,T,wn.backCCW,Ee,K,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}class Ro{constructor(i,h,g){this.vertexBuffer=i,this.indexBuffer=h,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class mo{constructor(i,h){this.context=new oh(i),this.transform=h,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Xt.maxUnderzooming+Xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Bi}resize(i,h,g){if(this.width=Math.floor(i*g),this.height=Math.floor(h*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const i=this.context,h=new d.aX;h.emplaceBack(0,0),h.emplaceBack(d.X,0),h.emplaceBack(0,d.X),h.emplaceBack(d.X,d.X),this.tileExtentBuffer=i.createVertexBuffer(h,On.members),this.tileExtentSegments=d.a0.simpleSegment(0,0,4,2);const g=new d.aX;g.emplaceBack(0,0),g.emplaceBack(d.X,0),g.emplaceBack(0,d.X),g.emplaceBack(d.X,d.X),this.debugBuffer=i.createVertexBuffer(g,On.members),this.debugSegments=d.a0.simpleSegment(0,0,4,5);const v=new d.$;v.emplaceBack(0,0,0,0),v.emplaceBack(d.X,0,d.X,0),v.emplaceBack(0,d.X,0,d.X),v.emplaceBack(d.X,d.X,d.X,d.X),this.rasterBoundsBuffer=i.createVertexBuffer(v,Rn.members),this.rasterBoundsSegments=d.a0.simpleSegment(0,0,4,2);const T=new d.aX;T.emplaceBack(0,0),T.emplaceBack(1,0),T.emplaceBack(0,1),T.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(T,On.members),this.viewportSegments=d.a0.simpleSegment(0,0,4,2);const z=new d.aZ;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(z);const O=new d.aY;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(O);const U=this.context.gl;this.stencilClearMode=new hn({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO)}clearStencil(){const i=this.context,h=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=d.H();d.aP(g,0,this.width,this.height,0,0,1),d.K(g,g,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,h.TRIANGLES,qi.disabled,this.stencilClearMode,fs.disabled,wn.disabled,Fs(g),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,h){if(this.currentStencilSource===i.source||!i.isTileClipped()||!h||!h.length)return;this.currentStencilSource=i.source;const g=this.context,v=g.gl;this.nextStencilID+h.length>256&&this.clearStencil(),g.setColorMode(fs.disabled),g.setDepthMode(qi.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of h){const O=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z);T.draw(g,v.TRIANGLES,qi.disabled,new hn({func:v.ALWAYS,mask:0},O,255,v.KEEP,v.KEEP,v.REPLACE),fs.disabled,wn.disabled,Fs(z.posMatrix),U,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,h=this.context.gl;return new hn({func:h.NOTEQUAL,mask:255},i,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(i){const h=this.context.gl;return new hn({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(i){const h=this.context.gl,g=i.sort(((z,O)=>O.overscaledZ-z.overscaledZ)),v=g[g.length-1].overscaledZ,T=g[0].overscaledZ-v+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const z={};for(let O=0;O<T;O++)z[O+v]=new hn({func:h.GEQUAL,mask:255},O+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=T,[z,g]}return[{[v]:hn.disabled},g]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new fs([i.CONSTANT_COLOR,i.ONE],new d.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fs.unblended:fs.alphaBlended}depthModeForSublayer(i,h,g){if(!this.opaquePassEnabledForLayer())return qi.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new qi(g||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,h){this.style=i,this.options=h,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(N.now()),this.imageManager.beginFrame();const g=this.style._order,v=this.style.sourceCaches,T={},z={},O={};for(const U in v){const H=v[U];H.used&&H.prepare(this.context),T[U]=H.getVisibleCoordinates(),z[U]=T[U].slice().reverse(),O[U]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<g.length;U++)if(this.style._layers[g[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of g){const H=this.style._layers[U];if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const X=z[H.source];(H.type==="custom"||X.length)&&this.renderLayer(this,v[H.source],H,X)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?d.aM.black:d.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(U,H){const X=U.context,K=X.gl,ae=((Ie,Re,Se)=>({u_sky_color:Ie.properties.get("sky-color"),u_horizon_color:Ie.properties.get("horizon-color"),u_horizon:(Re.height/2+Re.getHorizon())*Se,u_sky_horizon_blend:Ie.properties.get("sky-horizon-blend")*Re.height/2*Se}))(H,U.style.map.transform,U.pixelRatio),fe=new qi(K.LEQUAL,qi.ReadWrite,[0,1]),_e=hn.disabled,Ee=U.colorModeForRenderPass(),Pe=U.useProgram("sky");if(!H.mesh){const Ie=new d.aX;Ie.emplaceBack(-1,-1),Ie.emplaceBack(1,-1),Ie.emplaceBack(1,1),Ie.emplaceBack(-1,1);const Re=new d.aY;Re.emplaceBack(0,1,2),Re.emplaceBack(0,2,3),H.mesh=new Ro(X.createVertexBuffer(Ie,On.members),X.createIndexBuffer(Re),d.a0.simpleSegment(0,0,Ie.length,Re.length))}Pe.draw(X,K.TRIANGLES,fe,_e,Ee,wn.disabled,ae,void 0,"sky",H.mesh.vertexBuffer,H.mesh.indexBuffer,H.mesh.segments)})(this,this.style.sky),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[g[this.currentLayer]],H=v[U.source],X=T[U.source];this._renderTileClippingMasks(U,X),this.renderLayer(this,H,U,X)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const U=this.style._layers[g[this.currentLayer]],H=v[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U))continue;const X=(U.type==="symbol"?O:z)[U.source];this._renderTileClippingMasks(U,T[U.source]),this.renderLayer(this,H,U,X)}if(this.options.showTileBoundaries){const U=(function(H,X){let K=null;const ae=Object.values(H._layers).flatMap((Pe=>Pe.source&&!Pe.isHidden(X)?[H.sourceCaches[Pe.source]]:[])),fe=ae.filter((Pe=>Pe.getSource().type==="vector")),_e=ae.filter((Pe=>Pe.getSource().type!=="vector")),Ee=Pe=>{(!K||K.getSource().maxzoom<Pe.getSource().maxzoom)&&(K=Pe)};return fe.forEach((Pe=>Ee(Pe))),K||_e.forEach((Pe=>Ee(Pe))),K})(this.style,this.transform.zoom);U&&(function(H,X,K){for(let ae=0;ae<K.length;ae++)po(H,X,K[ae])})(this,U,U.getVisibleCoordinates())}this.options.showPadding&&(function(U){const H=U.transform.padding;Va(U,U.transform.height-(H.top||0),3,qs),Va(U,H.bottom||0,3,tn),fo(U,H.left||0,3,cl),fo(U,U.transform.width-(H.right||0),3,nc);const X=U.transform.centerPoint;(function(K,ae,fe,_e){ul(K,ae-1,fe-10,2,20,_e),ul(K,ae-10,fe-1,20,2,_e)})(U,X.x,U.transform.height-X.y,sc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const h=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=i?!d.a_(h,g):!d.a$(h,g)),v||(v=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),v&&(d.b0(h,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(T,z){const O=T.context,U=O.gl,H=fs.unblended,X=new qi(U.LEQUAL,qi.ReadWrite,[0,1]),K=z.getTerrainMesh(),ae=z.sourceCache.getRenderableTiles(),fe=T.useProgram("terrainDepth");O.bindFramebuffer.set(z.getFramebuffer("depth").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:d.aM.transparent,depth:1});for(const _e of ae){const Ee=z.getTerrainData(_e.tileID),Pe={u_matrix:T.transform.calculatePosMatrix(_e.tileID.toUnwrapped()),u_ele_delta:z.getMeshFrameDelta(T.transform.zoom)};fe.draw(O,U.TRIANGLES,X,hn.disabled,H,wn.backCCW,Pe,Ee,"terrain",K.vertexBuffer,K.indexBuffer,K.segments)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain),(function(T,z){const O=T.context,U=O.gl,H=fs.unblended,X=new qi(U.LEQUAL,qi.ReadWrite,[0,1]),K=z.getTerrainMesh(),ae=z.getCoordsTexture(),fe=z.sourceCache.getRenderableTiles(),_e=T.useProgram("terrainCoords");O.bindFramebuffer.set(z.getFramebuffer("coords").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:d.aM.transparent,depth:1}),z.coordsIndex=[];for(const Ee of fe){const Pe=z.getTerrainData(Ee.tileID);O.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,ae.texture);const Ie={u_matrix:T.transform.calculatePosMatrix(Ee.tileID.toUnwrapped()),u_terrain_coords_id:(255-z.coordsIndex.length)/255,u_texture:0,u_ele_delta:z.getMeshFrameDelta(T.transform.zoom)};_e.draw(O,U.TRIANGLES,X,hn.disabled,H,wn.backCCW,Ie,Pe,"terrain",K.vertexBuffer,K.indexBuffer,K.segments),z.coordsIndex.push(Ee.tileID.key)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain))}renderLayer(i,h,g,v){if(!g.isHidden(this.transform.zoom)&&(g.type==="background"||g.type==="custom"||(v||[]).length))switch(this.id=g.id,g.type){case"symbol":(function(T,z,O,U,H){if(T.renderPass!=="translucent")return;const X=hn.disabled,K=T.colorModeForRenderPass();(O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ae,fe,_e,Ee,Pe,Ie,Re,Se,$e){const Ze=fe.transform,nt=xa(),bt=Pe==="map",$t=Ie==="map";for(const Vt of ae){const ti=Ee.getTile(Vt),qt=ti.getBucket(_e);if(!qt||!qt.text||!qt.text.segments.get().length)continue;const Ut=d.ag(qt.textSizeData,Ze.zoom),ai=yi(ti,1,fe.transform.zoom),Ai=Zn(Vt.posMatrix,$t,bt,fe.transform,ai),Ht=_e.layout.get("icon-text-fit")!=="none"&&qt.hasIconData();if(Ut){const Yt=Math.pow(2,Ze.zoom-ti.tileID.overscaledZ),Ci=fe.style.map.terrain?(Hi,an)=>fe.style.map.terrain.getElevation(Vt,Hi,an):null,Fn=nt.translatePosition(Ze,ti,Re,Se);Ua(qt,bt,$t,$e,Ze,Ai,Vt.posMatrix,Yt,Ut,Ht,nt,Fn,Vt.toUnwrapped(),Ci)}}})(U,T,O,z,O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),H),O.paint.get("icon-opacity").constantOr(1)!==0&&ol(T,z,O,U,!1,O.paint.get("icon-translate"),O.paint.get("icon-translate-anchor"),O.layout.get("icon-rotation-alignment"),O.layout.get("icon-pitch-alignment"),O.layout.get("icon-keep-upright"),X,K),O.paint.get("text-opacity").constantOr(1)!==0&&ol(T,z,O,U,!0,O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.layout.get("text-keep-upright"),X,K),z.map.showCollisionBoxes&&(Lr(T,z,O,U,!0),Lr(T,z,O,U,!1))})(i,h,g,v,this.style.placement.variableOffsets);break;case"circle":(function(T,z,O,U){if(T.renderPass!=="translucent")return;const H=O.paint.get("circle-opacity"),X=O.paint.get("circle-stroke-width"),K=O.paint.get("circle-stroke-opacity"),ae=!O.layout.get("circle-sort-key").isConstant();if(H.constantOr(1)===0&&(X.constantOr(1)===0||K.constantOr(1)===0))return;const fe=T.context,_e=fe.gl,Ee=T.depthModeForSublayer(0,qi.ReadOnly),Pe=hn.disabled,Ie=T.colorModeForRenderPass(),Re=[];for(let Se=0;Se<U.length;Se++){const $e=U[Se],Ze=z.getTile($e),nt=Ze.getBucket(O);if(!nt)continue;const bt=nt.programConfigurations.get(O.id),$t=T.useProgram("circle",bt),Vt=nt.layoutVertexBuffer,ti=nt.indexBuffer,qt=T.style.map.terrain&&T.style.map.terrain.getTerrainData($e),Ut={programConfiguration:bt,program:$t,layoutVertexBuffer:Vt,indexBuffer:ti,uniformValues:zl(T,$e,Ze,O),terrainData:qt};if(ae){const ai=nt.segments.get();for(const Ai of ai)Re.push({segments:new d.a0([Ai]),sortKey:Ai.sortKey,state:Ut})}else Re.push({segments:nt.segments,sortKey:0,state:Ut})}ae&&Re.sort(((Se,$e)=>Se.sortKey-$e.sortKey));for(const Se of Re){const{programConfiguration:$e,program:Ze,layoutVertexBuffer:nt,indexBuffer:bt,uniformValues:$t,terrainData:Vt}=Se.state;Ze.draw(fe,_e.TRIANGLES,Ee,Pe,Ie,wn.disabled,$t,Vt,O.id,nt,bt,Se.segments,O.paint,T.transform.zoom,$e)}})(i,h,g,v);break;case"heatmap":(function(T,z,O,U){if(O.paint.get("heatmap-opacity")===0)return;const H=T.context;if(T.style.map.terrain){for(const X of U){const K=z.getTile(X);z.hasRenderableParent(X)||(T.renderPass==="offscreen"?ca(T,K,O,X):T.renderPass==="translucent"&&ua(T,O,X))}H.viewport.set([0,0,T.width,T.height])}else T.renderPass==="offscreen"?(function(X,K,ae,fe){const _e=X.context,Ee=_e.gl,Pe=hn.disabled,Ie=new fs([Ee.ONE,Ee.ONE],d.aM.transparent,[!0,!0,!0,!0]);(function(Re,Se,$e){const Ze=Re.gl;Re.activeTexture.set(Ze.TEXTURE1),Re.viewport.set([0,0,Se.width/4,Se.height/4]);let nt=$e.heatmapFbos.get(d.aU);nt?(Ze.bindTexture(Ze.TEXTURE_2D,nt.colorAttachment.get()),Re.bindFramebuffer.set(nt.framebuffer)):(nt=Nl(Re,Se.width/4,Se.height/4),$e.heatmapFbos.set(d.aU,nt))})(_e,X,ae),_e.clear({color:d.aM.transparent});for(let Re=0;Re<fe.length;Re++){const Se=fe[Re];if(K.hasRenderableParent(Se))continue;const $e=K.getTile(Se),Ze=$e.getBucket(ae);if(!Ze)continue;const nt=Ze.programConfigurations.get(ae.id),bt=X.useProgram("heatmap",nt),{zoom:$t}=X.transform;bt.draw(_e,Ee.TRIANGLES,qi.disabled,Pe,Ie,wn.disabled,Ds(Se.posMatrix,$e,$t,ae.paint.get("heatmap-intensity")),null,ae.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,ae.paint,X.transform.zoom,nt)}_e.viewport.set([0,0,X.width,X.height])})(T,z,O,U):T.renderPass==="translucent"&&(function(X,K){const ae=X.context,fe=ae.gl;ae.setColorMode(X.colorModeForRenderPass());const _e=K.heatmapFbos.get(d.aU);_e&&(ae.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,_e.colorAttachment.get()),ae.activeTexture.set(fe.TEXTURE1),zo(ae,K).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),X.useProgram("heatmapTexture").draw(ae,fe.TRIANGLES,qi.disabled,hn.disabled,X.colorModeForRenderPass(),wn.disabled,Ii(X,K,0,1),null,K.id,X.viewportBuffer,X.quadTriangleIndexBuffer,X.viewportSegments,K.paint,X.transform.zoom))})(T,O)})(i,h,g,v);break;case"line":(function(T,z,O,U){if(T.renderPass!=="translucent")return;const H=O.paint.get("line-opacity"),X=O.paint.get("line-width");if(H.constantOr(1)===0||X.constantOr(1)===0)return;const K=T.depthModeForSublayer(0,qi.ReadOnly),ae=T.colorModeForRenderPass(),fe=O.paint.get("line-dasharray"),_e=O.paint.get("line-pattern"),Ee=_e.constantOr(1),Pe=O.paint.get("line-gradient"),Ie=O.getCrossfadeParameters(),Re=Ee?"linePattern":fe?"lineSDF":Pe?"lineGradient":"line",Se=T.context,$e=Se.gl;let Ze=!0;for(const nt of U){const bt=z.getTile(nt);if(Ee&&!bt.patternsLoaded())continue;const $t=bt.getBucket(O);if(!$t)continue;const Vt=$t.programConfigurations.get(O.id),ti=T.context.program.get(),qt=T.useProgram(Re,Vt),Ut=Ze||qt.program!==ti,ai=T.style.map.terrain&&T.style.map.terrain.getTerrainData(nt),Ai=_e.constantOr(null);if(Ai&&bt.imageAtlas){const Ci=bt.imageAtlas,Fn=Ci.patternPositions[Ai.to.toString()],Hi=Ci.patternPositions[Ai.from.toString()];Fn&&Hi&&Vt.setConstantPatternPositions(Fn,Hi)}const Ht=ai?nt:null,Yt=Ee?sa(T,bt,O,Ie,Ht):fe?wa(T,bt,O,fe,Ie,Ht):Pe?zc(T,bt,O,$t.lineClipsArray.length,Ht):jn(T,bt,O,Ht);if(Ee)Se.activeTexture.set($e.TEXTURE0),bt.imageAtlasTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),Vt.updatePaintBuffers(Ie);else if(fe&&(Ut||T.lineAtlas.dirty))Se.activeTexture.set($e.TEXTURE0),T.lineAtlas.bind(Se);else if(Pe){const Ci=$t.gradients[O.id];let Fn=Ci.texture;if(O.gradientVersion!==Ci.version){let Hi=256;if(O.stepInterpolant){const an=z.getSource().maxzoom,Nn=nt.canonical.z===an?Math.ceil(1<<T.transform.maxZoom-nt.canonical.z):1;Hi=d.ac(d.aV($t.maxLineLength/d.X*1024*Nn),256,Se.maxTextureSize)}Ci.gradient=d.aW({expression:O.gradientExpression(),evaluationKey:"lineProgress",resolution:Hi,image:Ci.gradient||void 0,clips:$t.lineClipsArray}),Ci.texture?Ci.texture.update(Ci.gradient):Ci.texture=new lt(Se,Ci.gradient,$e.RGBA),Ci.version=O.gradientVersion,Fn=Ci.texture}Se.activeTexture.set($e.TEXTURE0),Fn.bind(O.stepInterpolant?$e.NEAREST:$e.LINEAR,$e.CLAMP_TO_EDGE)}qt.draw(Se,$e.TRIANGLES,K,T.stencilModeForClipping(nt),ae,wn.disabled,Yt,ai,O.id,$t.layoutVertexBuffer,$t.indexBuffer,$t.segments,O.paint,T.transform.zoom,Vt,$t.layoutVertexBuffer2),Ze=!1}})(i,h,g,v);break;case"fill":(function(T,z,O,U){const H=O.paint.get("fill-color"),X=O.paint.get("fill-opacity");if(X.constantOr(1)===0)return;const K=T.colorModeForRenderPass(),ae=O.paint.get("fill-pattern"),fe=T.opaquePassEnabledForLayer()&&!ae.constantOr(1)&&H.constantOr(d.aM.transparent).a===1&&X.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===fe){const _e=T.depthModeForSublayer(1,T.renderPass==="opaque"?qi.ReadWrite:qi.ReadOnly);Hr(T,z,O,U,_e,K,!1)}if(T.renderPass==="translucent"&&O.paint.get("fill-antialias")){const _e=T.depthModeForSublayer(O.getPaintProperty("fill-outline-color")?2:0,qi.ReadOnly);Hr(T,z,O,U,_e,K,!0)}})(i,h,g,v);break;case"fill-extrusion":(function(T,z,O,U){const H=O.paint.get("fill-extrusion-opacity");if(H!==0&&T.renderPass==="translucent"){const X=new qi(T.context.gl.LEQUAL,qi.ReadWrite,T.depthRangeFor3D);if(H!==1||O.paint.get("fill-extrusion-pattern").constantOr(1))Vc(T,z,O,U,X,hn.disabled,fs.disabled),Vc(T,z,O,U,X,T.stencilModeFor3D(),T.colorModeForRenderPass());else{const K=T.colorModeForRenderPass();Vc(T,z,O,U,X,hn.disabled,K)}}})(i,h,g,v);break;case"hillshade":(function(T,z,O,U){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const H=T.context,X=T.depthModeForSublayer(0,qi.ReadOnly),K=T.colorModeForRenderPass(),[ae,fe]=T.renderPass==="translucent"?T.stencilConfigForOverlap(U):[{},U];for(const _e of fe){const Ee=z.getTile(_e);Ee.needsHillshadePrepare!==void 0&&Ee.needsHillshadePrepare&&T.renderPass==="offscreen"?Bl(T,Ee,O,X,hn.disabled,K):T.renderPass==="translucent"&&Ea(T,_e,Ee,O,X,ae[_e.overscaledZ],K)}H.viewport.set([0,0,T.width,T.height])})(i,h,g,v);break;case"raster":(function(T,z,O,U){if(T.renderPass!=="translucent"||O.paint.get("raster-opacity")===0||!U.length)return;const H=T.context,X=H.gl,K=z.getSource(),ae=T.useProgram("raster"),fe=T.colorModeForRenderPass(),[_e,Ee]=K instanceof is?[{},U]:T.stencilConfigForOverlap(U),Pe=Ee[Ee.length-1].overscaledZ,Ie=!T.options.moving;for(const Re of Ee){const Se=T.depthModeForSublayer(Re.overscaledZ-Pe,O.paint.get("raster-opacity")===1?qi.ReadWrite:qi.ReadOnly,X.LESS),$e=z.getTile(Re);$e.registerFadeDuration(O.paint.get("raster-fade-duration"));const Ze=z.findLoadedParent(Re,0),nt=z.findLoadedSibling(Re),bt=Fa($e,Ze||nt||null,z,O,T.transform,T.style.map.terrain);let $t,Vt;const ti=O.paint.get("raster-resampling")==="nearest"?X.NEAREST:X.LINEAR;H.activeTexture.set(X.TEXTURE0),$e.texture.bind(ti,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST),H.activeTexture.set(X.TEXTURE1),Ze?(Ze.texture.bind(ti,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST),$t=Math.pow(2,Ze.tileID.overscaledZ-$e.tileID.overscaledZ),Vt=[$e.tileID.canonical.x*$t%1,$e.tileID.canonical.y*$t%1]):$e.texture.bind(ti,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST),$e.texture.useMipmap&&H.extTextureFilterAnisotropic&&T.transform.pitch>20&&X.texParameterf(X.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const qt=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Re),Ut=qt?Re:null,ai=Ut?Ut.posMatrix:T.transform.calculatePosMatrix(Re.toUnwrapped(),Ie),Ai=Ba(ai,Vt||[0,0],$t||1,bt,O);K instanceof is?ae.draw(H,X.TRIANGLES,Se,hn.disabled,fe,wn.disabled,Ai,qt,O.id,K.boundsBuffer,T.quadTriangleIndexBuffer,K.boundsSegments):ae.draw(H,X.TRIANGLES,Se,_e[Re.overscaledZ],fe,wn.disabled,Ai,qt,O.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}})(i,h,g,v);break;case"background":(function(T,z,O,U){const H=O.paint.get("background-color"),X=O.paint.get("background-opacity");if(X===0)return;const K=T.context,ae=K.gl,fe=T.transform,_e=fe.tileSize,Ee=O.paint.get("background-pattern");if(T.isPatternMissing(Ee))return;const Pe=!Ee&&H.a===1&&X===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==Pe)return;const Ie=hn.disabled,Re=T.depthModeForSublayer(0,Pe==="opaque"?qi.ReadWrite:qi.ReadOnly),Se=T.colorModeForRenderPass(),$e=T.useProgram(Ee?"backgroundPattern":"background"),Ze=U||fe.coveringTiles({tileSize:_e,terrain:T.style.map.terrain});Ee&&(K.activeTexture.set(ae.TEXTURE0),T.imageManager.bind(T.context));const nt=O.getCrossfadeParameters();for(const bt of Ze){const $t=U?bt.posMatrix:T.transform.calculatePosMatrix(bt.toUnwrapped()),Vt=Ee?Rc($t,X,T,Ee,{tileID:bt,tileSize:_e},nt):jo($t,X,H),ti=T.style.map.terrain&&T.style.map.terrain.getTerrainData(bt);$e.draw(K,ae.TRIANGLES,Re,Ie,Se,wn.disabled,Vt,ti,O.id,T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}})(i,0,g,v);break;case"custom":(function(T,z,O){const U=T.context,H=O.implementation;if(T.renderPass==="offscreen"){const X=H.prerender;X&&(T.setCustomLayerDefaults(),U.setColorMode(T.colorModeForRenderPass()),X.call(H,U.gl,T.transform.customLayerMatrix()),U.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),U.setColorMode(T.colorModeForRenderPass()),U.setStencilMode(hn.disabled);const X=H.renderingMode==="3d"?new qi(T.context.gl.LEQUAL,qi.ReadWrite,T.depthRangeFor3D):T.depthModeForSublayer(0,qi.ReadOnly);U.setDepthMode(X),H.render(U.gl,T.transform.customLayerMatrix(),{farZ:T.transform.farZ,nearZ:T.transform.nearZ,fov:T.transform._fov,modelViewProjectionMatrix:T.transform.modelViewProjectionMatrix,projectionMatrix:T.transform.projectionMatrix}),U.setDirty(),T.setBaseState(),U.bindFramebuffer.set(null)}})(i,0,g)}}translatePosMatrix(i,h,g,v,T){if(!g[0]&&!g[1])return i;const z=T?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(z){const H=Math.sin(z),X=Math.cos(z);g=[g[0]*X-g[1]*H,g[0]*H+g[1]*X]}const O=[T?g[0]:yi(h,g[0],this.transform.zoom),T?g[1]:yi(h,g[1],this.transform.zoom),0],U=new Float32Array(16);return d.J(U,i,O),U}saveTileTexture(i){const h=this._tileTextures[i.size[0]];h?h.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const h=this._tileTextures[i];return h&&h.length>0?h.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const h=this.imageManager.getPattern(i.from.toString()),g=this.imageManager.getPattern(i.to.toString());return!h||!g}useProgram(i,h){this.cache=this.cache||{};const g=i+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[g]||(this.cache[g]=new Mo(this.context,Na[i],h,Ks[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new lt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:h}=this.context.gl;return this.width!==i||this.height!==h}}class hl{constructor(i,h){this.points=i,this.planes=h}static fromInvProjectionMatrix(i,h,g){const v=Math.pow(2,g),T=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((O=>{const U=1/(O=d.af([],O,i))[3]/h*v;return d.b1(O,O,[U,U,1/O[3],U])})),z=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((O=>{const U=(function(ae,fe){var _e=fe[0],Ee=fe[1],Pe=fe[2],Ie=_e*_e+Ee*Ee+Pe*Pe;return Ie>0&&(Ie=1/Math.sqrt(Ie)),ae[0]=fe[0]*Ie,ae[1]=fe[1]*Ie,ae[2]=fe[2]*Ie,ae})([],(function(ae,fe,_e){var Ee=fe[0],Pe=fe[1],Ie=fe[2],Re=_e[0],Se=_e[1],$e=_e[2];return ae[0]=Pe*$e-Ie*Se,ae[1]=Ie*Re-Ee*$e,ae[2]=Ee*Se-Pe*Re,ae})([],Me([],T[O[0]],T[O[1]]),Me([],T[O[2]],T[O[1]]))),H=-((X=U)[0]*(K=T[O[1]])[0]+X[1]*K[1]+X[2]*K[2]);var X,K;return U.concat(H)}));return new hl(T,z)}}class Zr{constructor(i,h){this.min=i,this.max=h,this.center=(function(g,v,T){return g[0]=.5*v[0],g[1]=.5*v[1],g[2]=.5*v[2],g})([],(function(g,v,T){return g[0]=v[0]+T[0],g[1]=v[1]+T[1],g[2]=v[2]+T[2],g})([],this.min,this.max))}quadrant(i){const h=[i%2==0,i<2],g=be(this.min),v=be(this.max);for(let T=0;T<h.length;T++)g[T]=h[T]?this.min[T]:this.center[T],v[T]=h[T]?this.center[T]:this.max[T];return v[2]=this.max[2],new Zr(g,v)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let g=!0;for(let v=0;v<i.planes.length;v++){const T=i.planes[v];let z=0;for(let O=0;O<h.length;O++)d.b2(T,h[O])>=0&&z++;if(z===0)return 0;z!==h.length&&(g=!1)}if(g)return 2;for(let v=0;v<3;v++){let T=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(let O=0;O<i.points.length;O++){const U=i.points[O][v]-this.min[v];T=Math.min(T,U),z=Math.max(z,U)}if(z<0||T>this.max[v]-this.min[v])return 0}return 1}}class ka{constructor(i=0,h=0,g=0,v=0){if(isNaN(i)||i<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=h,this.left=g,this.right=v}interpolate(i,h,g){return h.top!=null&&i.top!=null&&(this.top=d.y.number(i.top,h.top,g)),h.bottom!=null&&i.bottom!=null&&(this.bottom=d.y.number(i.bottom,h.bottom,g)),h.left!=null&&i.left!=null&&(this.left=d.y.number(i.left,h.left,g)),h.right!=null&&i.right!=null&&(this.right=d.y.number(i.right,h.right,g)),this}getCenter(i,h){const g=d.ac((this.left+i-this.right)/2,0,i),v=d.ac((this.top+h-this.bottom)/2,0,h);return new d.P(g,v)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new ka(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const $l=85.051129;class dl{constructor(i,h,g,v,T){this.tileSize=512,this._renderWorldCopies=T===void 0||!!T,this._minZoom=i||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=v??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ka,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const i=new dl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.lngRange=i.lngRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this.minElevationForCurrentTile=i.minElevationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const h=-d.b3(i,-180,180)*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(function(){var g=new d.A(4);return d.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g})(),(function(g,v,T){var z=v[0],O=v[1],U=v[2],H=v[3],X=Math.sin(T),K=Math.cos(T);g[0]=z*K+U*X,g[1]=O*K+H*X,g[2]=z*-X+U*K,g[3]=O*-X+H*K})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const h=d.ac(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const h=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.tileZoom=Math.max(0,Math.floor(h)),this.scale=this.zoomScale(h),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,h,g){this._unmodified=!1,this._edgeInsets.interpolate(i,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const h=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(i){const h=[new d.b4(0,i)];if(this._renderWorldCopies){const g=this.pointCoordinate(new d.P(0,0)),v=this.pointCoordinate(new d.P(this.width,0)),T=this.pointCoordinate(new d.P(this.width,this.height)),z=this.pointCoordinate(new d.P(0,this.height)),O=Math.floor(Math.min(g.x,v.x,T.x,z.x)),U=Math.floor(Math.max(g.x,v.x,T.x,z.x)),H=1;for(let X=O-H;X<=U+H;X++)X!==0&&h.push(new d.b4(X,i))}return h}coveringTiles(i){var h,g;let v=this.coveringZoomLevel(i);const T=v;if(i.minzoom!==void 0&&v<i.minzoom)return[];i.maxzoom!==void 0&&v>i.maxzoom&&(v=i.maxzoom);const z=this.pointCoordinate(this.getCameraPoint()),O=d.Z.fromLngLat(this.center),U=Math.pow(2,v),H=[U*z.x,U*z.y,0],X=[U*O.x,U*O.y,0],K=hl.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,v);let ae=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ae=v);const fe=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,_e=Se=>({aabb:new Zr([Se*U,0,0],[(Se+1)*U,U,0]),zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),Ee=[],Pe=[],Ie=v,Re=i.reparseOverscaled?T:v;if(this._renderWorldCopies)for(let Se=1;Se<=3;Se++)Ee.push(_e(-Se)),Ee.push(_e(Se));for(Ee.push(_e(0));Ee.length>0;){const Se=Ee.pop(),$e=Se.x,Ze=Se.y;let nt=Se.fullyVisible;if(!nt){const qt=Se.aabb.intersects(K);if(qt===0)continue;nt=qt===2}const bt=i.terrain?H:X,$t=Se.aabb.distanceX(bt),Vt=Se.aabb.distanceY(bt),ti=Math.max(Math.abs($t),Math.abs(Vt));if(Se.zoom===Ie||ti>fe+(1<<Ie-Se.zoom)-2&&Se.zoom>=ae){const qt=Ie-Se.zoom,Ut=H[0]-.5-($e<<qt),ai=H[1]-.5-(Ze<<qt);Pe.push({tileID:new d.S(Se.zoom===Ie?Re:Se.zoom,Se.wrap,Se.zoom,$e,Ze),distanceSq:Ue([X[0]-.5-$e,X[1]-.5-Ze]),tileDistanceToCamera:Math.sqrt(Ut*Ut+ai*ai)})}else for(let qt=0;qt<4;qt++){const Ut=($e<<1)+qt%2,ai=(Ze<<1)+(qt>>1),Ai=Se.zoom+1;let Ht=Se.aabb.quadrant(qt);if(i.terrain){const Yt=new d.S(Ai,Se.wrap,Ai,Ut,ai),Ci=i.terrain.getMinMaxElevation(Yt),Fn=(h=Ci.minElevation)!==null&&h!==void 0?h:this.elevation,Hi=(g=Ci.maxElevation)!==null&&g!==void 0?g:this.elevation;Ht=new Zr([Ht.min[0],Ht.min[1],Fn],[Ht.max[0],Ht.max[1],Hi])}Ee.push({aabb:Ht,zoom:Ai,x:Ut,y:ai,wrap:Se.wrap,fullyVisible:nt})}}return Pe.sort(((Se,$e)=>Se.distanceSq-$e.distanceSq)).map((Se=>Se.tileID))}resize(i,h){this.width=i,this.height=h,this.pixelsToGLUnits=[2/i,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const h=d.ac(i.lat,-85.051129,$l);return new d.P(d.O(i.lng)*this.worldSize,d.Q(h)*this.worldSize)}unproject(i){return new d.Z(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const h=this.elevation,g=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,v=this.pointLocation(this.centerPoint,i),T=i.getElevationForLngLatZoom(v,this.tileZoom);if(!(this.elevation-T))return;const z=g+h-T,O=Math.cos(this._pitch)*this.cameraToCenterDistance/z/d.b5(1,v.lat),U=this.scaleZoom(O/this.tileSize);this._elevation=T,this._center=v,this.zoom=U}setLocationAtPoint(i,h){const g=this.pointCoordinate(h),v=this.pointCoordinate(this.centerPoint),T=this.locationCoordinate(i),z=new d.Z(T.x-(g.x-v.x),T.y-(g.y-v.y));this.center=this.coordinateLocation(z),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,h){return h?this.coordinatePoint(this.locationCoordinate(i),h.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,h){return this.coordinateLocation(this.pointCoordinate(i,h))}locationCoordinate(i){return d.Z.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,h){if(h){const ae=h.pointCoordinate(i);if(ae!=null)return ae}const g=[i.x,i.y,0,1],v=[i.x,i.y,1,1];d.af(g,g,this.pixelMatrixInverse),d.af(v,v,this.pixelMatrixInverse);const T=g[3],z=v[3],O=g[1]/T,U=v[1]/z,H=g[2]/T,X=v[2]/z,K=H===X?0:(0-H)/(X-H);return new d.Z(d.y.number(g[0]/T,v[0]/z,K)/this.worldSize,d.y.number(O,U,K)/this.worldSize)}coordinatePoint(i,h=0,g=this.pixelMatrix){const v=[i.x*this.worldSize,i.y*this.worldSize,h,1];return d.af(v,v,g),new d.P(v[0]/v[3],v[1]/v[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new it().extend(this.pointLocation(new d.P(0,i))).extend(this.pointLocation(new d.P(this.width,i))).extend(this.pointLocation(new d.P(this.width,this.height))).extend(this.pointLocation(new d.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new it([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,$l])}calculateTileMatrix(i){const h=i.canonical,g=this.worldSize/this.zoomScale(h.z),v=h.x+Math.pow(2,h.z)*i.wrap,T=d.an(new Float64Array(16));return d.J(T,T,[v*g,h.y*g,0]),d.K(T,T,[g/d.X,g/d.X,1]),T}calculatePosMatrix(i,h=!1){const g=i.key,v=h?this._alignedPosMatrixCache:this._posMatrixCache;if(v[g])return v[g];const T=this.calculateTileMatrix(i);return d.L(T,h?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,T),v[g]=new Float32Array(T),v[g]}calculateFogMatrix(i){const h=i.key,g=this._fogMatrixCache;if(g[h])return g[h];const v=this.calculateTileMatrix(i);return d.L(v,this.fogMatrix,v),g[h]=new Float32Array(v),g[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(i,h){h=d.ac(+h,this.minZoom,this.maxZoom);const g={center:new d.N(i.lng,i.lat),zoom:h};let v=this.lngRange;if(!this._renderWorldCopies&&v===null){const Se=179.9999999999;v=[-Se,Se]}const T=this.tileSize*this.zoomScale(g.zoom);let z=0,O=T,U=0,H=T,X=0,K=0;const{x:ae,y:fe}=this.size;if(this.latRange){const Se=this.latRange;z=d.Q(Se[1])*T,O=d.Q(Se[0])*T,O-z<fe&&(X=fe/(O-z))}v&&(U=d.b3(d.O(v[0])*T,0,T),H=d.b3(d.O(v[1])*T,0,T),H<U&&(H+=T),H-U<ae&&(K=ae/(H-U)));const{x:_e,y:Ee}=this.project.call({worldSize:T},i);let Pe,Ie;const Re=Math.max(K||0,X||0);if(Re){const Se=new d.P(K?(H+U)/2:_e,X?(O+z)/2:Ee);return g.center=this.unproject.call({worldSize:T},Se).wrap(),g.zoom+=this.scaleZoom(Re),g}if(this.latRange){const Se=fe/2;Ee-Se<z&&(Ie=z+Se),Ee+Se>O&&(Ie=O-Se)}if(v){const Se=(U+H)/2;let $e=_e;this._renderWorldCopies&&($e=d.b3(_e,Se-T/2,Se+T/2));const Ze=ae/2;$e-Ze<U&&(Pe=U+Ze),$e+Ze>H&&(Pe=H-Ze)}if(Pe!==void 0||Ie!==void 0){const Se=new d.P(Pe??_e,Ie??Ee);g.center=this.unproject.call({worldSize:T},Se).wrap()}return g}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:h,zoom:g}=this.getConstrained(this.center,this.zoom);this.center=h,this.zoom=g,this._unmodified=i,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,h=this.point.x,g=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=d.b5(1,this.center.lat)*this.worldSize;let v=d.an(new Float64Array(16));d.K(v,v,[this.width/2,-this.height/2,1]),d.J(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=d.an(new Float64Array(16)),d.K(v,v,[1,-1,1]),d.J(v,v,[-1,-1,0]),d.K(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v;const T=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),z=Math.min(this.elevation,this.minElevationForCurrentTile),O=T-z*this._pixelPerMeter/Math.cos(this._pitch),U=z<0?O:T,H=Math.PI/2+this._pitch,X=this._fov*(.5+i.y/this.height),K=Math.sin(X)*U/Math.sin(d.ac(Math.PI-H-X,.01,Math.PI-.01)),ae=this.getHorizon(),fe=2*Math.atan(ae/this.cameraToCenterDistance)*(.5+i.y/(2*ae)),_e=Math.sin(fe)*U/Math.sin(d.ac(Math.PI-H-fe,.01,Math.PI-.01)),Ee=Math.min(K,_e);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Ee+U),this.nearZ=this.height/50,v=new Float64Array(16),d.b6(v,this._fov,this.width/this.height,this.nearZ,this.farZ),v[8]=2*-i.x/this.width,v[9]=2*i.y/this.height,this.projectionMatrix=d.ae(v),d.K(v,v,[1,-1,1]),d.J(v,v,[0,0,-this.cameraToCenterDistance]),d.b7(v,v,this._pitch),d.ad(v,v,this.angle),d.J(v,v,[-h,-g,0]),this.mercatorMatrix=d.K([],v,[this.worldSize,this.worldSize,this.worldSize]),d.K(v,v,[1,1,this._pixelPerMeter]),this.pixelMatrix=d.L(new Float64Array(16),this.labelPlaneMatrix,v),d.J(v,v,[0,0,-this.elevation]),this.modelViewProjectionMatrix=v,this.invModelViewProjectionMatrix=d.as([],v),this.fogMatrix=new Float64Array(16),d.b6(this.fogMatrix,this._fov,this.width/this.height,T,this.farZ),this.fogMatrix[8]=2*-i.x/this.width,this.fogMatrix[9]=2*i.y/this.height,d.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),d.b7(this.fogMatrix,this.fogMatrix,this._pitch),d.ad(this.fogMatrix,this.fogMatrix,this.angle),d.J(this.fogMatrix,this.fogMatrix,[-h,-g,0]),d.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=d.L(new Float64Array(16),this.labelPlaneMatrix,v);const Pe=this.width%2/2,Ie=this.height%2/2,Re=Math.cos(this.angle),Se=Math.sin(this.angle),$e=h-Math.round(h)+Re*Pe+Se*Ie,Ze=g-Math.round(g)+Re*Ie+Se*Pe,nt=new Float64Array(v);if(d.J(nt,nt,[$e>.5?$e-1:$e,Ze>.5?Ze-1:Ze,0]),this.alignedModelViewProjectionMatrix=nt,v=d.as(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new d.P(0,0)),h=[i.x*this.worldSize,i.y*this.worldSize,0,1];return d.af(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(0,i))}getCameraQueryGeometry(i){const h=this.getCameraPoint();if(i.length===1)return[i[0],h];{let g=h.x,v=h.y,T=h.x,z=h.y;for(const O of i)g=Math.min(g,O.x),v=Math.min(v,O.y),T=Math.max(T,O.x),z=Math.max(z,O.y);return[new d.P(g,v),new d.P(T,v),new d.P(T,z),new d.P(g,z),new d.P(g,v)]}}lngLatToCameraDepth(i,h){const g=this.locationCoordinate(i),v=[g.x*this.worldSize,g.y*this.worldSize,h,1];return d.af(v,v,this.modelViewProjectionMatrix),v[2]/v[3]}}function As(E,i){let h,g=!1,v=null,T=null;const z=()=>{v=null,g&&(E.apply(T,h),v=setTimeout(z,i),g=!1)};return(...O)=>(g=!0,T=this,h=O,v||z(),v)}class Do{constructor(i){this._getCurrentHash=()=>{const h=window.location.hash.replace("#","");if(this._hashName){let g;return h.split("&").map((v=>v.split("="))).forEach((v=>{v[0]===this._hashName&&(g=v)})),(g&&g[1]||"").split("/")}return h.split("/")},this._onHashChange=()=>{const h=this._getCurrentHash();if(h.length>=3&&!h.some((g=>isNaN(g)))){const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(h[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const h=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,h)},this._removeHash=()=>{const h=this._getCurrentHash();if(h.length===0)return;const g=h.join("/");let v=g;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${g}`);let T=window.location.hash.replace(v,"");T.startsWith("#&")?T=T.slice(0,1)+T.slice(2):T==="#"&&(T="");let z=window.location.href.replace(/(#.+)?$/,T);z=z.replace("&&","&"),window.history.replaceState(window.history.state,null,z)},this._updateHash=As(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(i){const h=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,v=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,v),z=Math.round(h.lng*T)/T,O=Math.round(h.lat*T)/T,U=this._map.getBearing(),H=this._map.getPitch();let X="";if(X+=i?`/${z}/${O}/${g}`:`${g}/${O}/${z}`,(U||H)&&(X+="/"+Math.round(10*U)/10),H&&(X+=`/${Math.round(H)}`),this._hashName){const K=this._hashName;let ae=!1;const fe=window.location.hash.slice(1).split("&").map((_e=>{const Ee=_e.split("=")[0];return Ee===K?(ae=!0,`${Ee}=${X}`):_e})).filter((_e=>_e));return ae||fe.push(`${K}=${X}`),`#${fe.join("&")}`}return`#${X}`}}const ac={linearity:.3,easing:d.b8(0,0,.3,1)},fl=d.e({deceleration:2500,maxSpeed:1400},ac),Jh=d.e({deceleration:20,maxSpeed:1400},ac),Eu=d.e({deceleration:1e3,maxSpeed:360},ac),qc=d.e({deceleration:1e3,maxSpeed:90},ac);class Oo{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:N.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,h=N.now();for(;i.length>0&&h-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)h.zoom+=T.zoomDelta||0,h.bearing+=T.bearingDelta||0,h.pitch+=T.pitchDelta||0,T.panDelta&&h.pan._add(T.panDelta),T.around&&(h.around=T.around),T.pinchAround&&(h.pinchAround=T.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const T=ha(h.pan.mag(),g,d.e({},fl,i||{}));v.offset=h.pan.mult(T.amount/h.pan.mag()),v.center=this._map.transform.center,Ul(v,T)}if(h.zoom){const T=ha(h.zoom,g,Jh);v.zoom=this._map.transform.zoom+T.amount,Ul(v,T)}if(h.bearing){const T=ha(h.bearing,g,Eu);v.bearing=this._map.transform.bearing+d.ac(T.amount,-179,179),Ul(v,T)}if(h.pitch){const T=ha(h.pitch,g,qc);v.pitch=this._map.transform.pitch+T.amount,Ul(v,T)}if(v.zoom||v.bearing){const T=h.pinchAround===void 0?h.around:h.pinchAround;v.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),d.e(v,{noMoveStart:!0})}}function Ul(E,i){(!E.duration||E.duration<i.duration)&&(E.duration=i.duration,E.easing=i.easing)}function ha(E,i,h){const{maxSpeed:g,linearity:v,deceleration:T}=h,z=d.ac(E*v/(i/1e3),-g,g),O=Math.abs(z)/(T*v);return{easing:h.easing,duration:1e3*O,amount:z*(O/2)}}class Wn extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g,v={}){const T=V.mousePos(h.getCanvas(),g),z=h.unproject(T);super(i,d.e({point:T,lngLat:z,originalEvent:g},v)),this._defaultPrevented=!1,this.target=h}}class Ca extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g){const v=i==="touchend"?g.changedTouches:g.touches,T=V.touchPos(h.getCanvasContainer(),v),z=T.map((U=>h.unproject(U))),O=T.reduce(((U,H,X,K)=>U.add(H.div(K.length))),new d.P(0,0));super(i,{points:T,point:O,lngLats:z,lngLat:h.unproject(O),originalEvent:g}),this._defaultPrevented=!1}}class Gr extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g){super(i,{originalEvent:g}),this._defaultPrevented=!1}}class br{constructor(i,h){this._map=i,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new Gr(i.type,this._map,i))}mousedown(i,h){return this._mousedownPos=h,this._firePreventable(new Wn(i.type,this._map,i))}mouseup(i){this._map.fire(new Wn(i.type,this._map,i))}click(i,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new Wn(i.type,this._map,i))}dblclick(i){return this._firePreventable(new Wn(i.type,this._map,i))}mouseover(i){this._map.fire(new Wn(i.type,this._map,i))}mouseout(i){this._map.fire(new Wn(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Ca(i.type,this._map,i))}touchmove(i){this._map.fire(new Ca(i.type,this._map,i))}touchend(i){this._map.fire(new Ca(i.type,this._map,i))}touchcancel(i){this._map.fire(new Ca(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ss{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new Wn(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Wn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new Wn(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wr{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(d.P.convert(i),this._map.terrain)}}class Ms{constructor(i,h){this._map=i,this._tr=new wr(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,h){this.isEnabled()&&i.shiftKey&&i.button===0&&(V.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(i,h){if(!this._active)return;const g=h;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=g,this._box||(this._box=V.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const T=Math.min(v.x,g.x),z=Math.max(v.x,g.x),O=Math.min(v.y,g.y),U=Math.max(v.y,g.y);V.setTransform(this._box,`translate(${T}px,${O}px)`),this._box.style.width=z-T+"px",this._box.style.height=U-O+"px"}mouseupWindow(i,h){if(!this._active||i.button!==0)return;const g=this._startPos,v=h;if(this.reset(),V.suppressClick(),g.x!==v.x||g.y!==v.y)return this._map.fire(new d.k("boxzoomend",{originalEvent:i})),{cameraAnimation:T=>T.fitScreenCoordinates(g,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,h){return this._map.fire(new d.k(i,{originalEvent:h}))}}function pl(E,i){if(E.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${E.length}, points ${i.length}`);const h={};for(let g=0;g<E.length;g++)h[E[g].identifier]=i[g];return h}class da{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),g.length===this.numTouches&&(this.centroid=(function(v){const T=new d.P(0,0);for(const z of v)T._add(z);return T.div(v.length)})(h),this.touches=pl(g,h)))}touchmove(i,h,g){if(this.aborted||!this.centroid)return;const v=pl(g,h);for(const T in this.touches){const z=v[T];(!z||z.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(i,h,g){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class go{constructor(i){this.singleTap=new da(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,h,g){this.singleTap.touchstart(i,h,g)}touchmove(i,h,g){this.singleTap.touchmove(i,h,g)}touchend(i,h,g){const v=this.singleTap.touchend(i,h,g);if(v){const T=i.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(v)<30;if(T&&z||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class qa{constructor(i){this._tr=new wr(i),this._zoomIn=new go({numTouches:1,numTaps:2}),this._zoomOut=new go({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,h,g){this._zoomIn.touchstart(i,h,g),this._zoomOut.touchstart(i,h,g)}touchmove(i,h,g){this._zoomIn.touchmove(i,h,g),this._zoomOut.touchmove(i,h,g)}touchend(i,h,g){const v=this._zoomIn.touchend(i,h,g),T=this._zoomOut.touchend(i,h,g),z=this._tr;return v?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:z.zoom+1,around:z.unproject(v)},{originalEvent:i})}):T?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:z.zoom-1,around:z.unproject(T)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sr{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const h=this._moveFunction(...i);if(h.bearingDelta||h.pitchDelta||h.around||h.panDelta)return this._active=!0,h}dragStart(i,h){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=h.length?h[0]:h,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,h){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const v=h.length?h[0]:h;return!this._moved&&v.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(g,v))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&V.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ku={0:1,2:2};class Js{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const h=V.mouseButton(i);this._eventButton=h}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!(function(h,g){const v=ku[g];return h.buttons===void 0||(h.buttons&v)!==v})(i,this._eventButton)}isValidEndEvent(i){return V.mouseButton(i)===this._eventButton}}class Fl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const Wr=E=>{E.mousedown=E.dragStart,E.mousemoveWindow=E.dragMove,E.mouseup=E.dragEnd,E.contextmenu=i=>{i.preventDefault()}},oc=({enable:E,clickTolerance:i,bearingDegreesPerPixelMoved:h=.8})=>{const g=new Js({checkCorrectEvent:v=>V.mouseButton(v)===0&&v.ctrlKey||V.mouseButton(v)===2});return new Sr({clickTolerance:i,move:(v,T)=>({bearingDelta:(T.x-v.x)*h}),moveStateManager:g,enable:E,assignEvents:Wr})},ml=({enable:E,clickTolerance:i,pitchDegreesPerPixelMoved:h=-.5})=>{const g=new Js({checkCorrectEvent:v=>V.mouseButton(v)===0&&v.ctrlKey||V.mouseButton(v)===2});return new Sr({clickTolerance:i,move:(v,T)=>({pitchDelta:(T.y-v.y)*h}),moveStateManager:g,enable:E,assignEvents:Wr})};class Yr{constructor(i,h){this._clickTolerance=i.clickTolerance||1,this._map=h,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(i){return i<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(i,h,g){return this._calculateTransform(i,h,g)}touchmove(i,h,g){if(this._active){if(!this._shouldBePrevented(g.length))return i.preventDefault(),this._calculateTransform(i,h,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",i)}}touchend(i,h,g){this._calculateTransform(i,h,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,h,g){g.length>0&&(this._active=!0);const v=pl(g,h),T=new d.P(0,0),z=new d.P(0,0);let O=0;for(const H in v){const X=v[H],K=this._touches[H];K&&(T._add(X),z._add(X.sub(K)),O++,v[H]=X)}if(this._touches=v,this._shouldBePrevented(O)||!z.mag())return;const U=z.div(O);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(O),panDelta:U}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(i,h,g){if(!this._firstTwoTouches)return;i.preventDefault();const[v,T]=this._firstTwoTouches,z=yl(g,h,v),O=yl(g,h,T);if(!z||!O)return;const U=this._aroundCenter?null:z.add(O).div(2);return this._move([z,O],U,i)}touchend(i,h,g){if(!this._firstTwoTouches)return;const[v,T]=this._firstTwoTouches,z=yl(g,h,v),O=yl(g,h,T);z&&O||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function yl(E,i,h){for(let g=0;g<E.length;g++)if(E[g].identifier===h)return i[g]}function lc(E,i){return Math.log(E/i)/Math.LN2}class u extends gl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,h){const g=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(lc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:lc(this._distance,g),pinchAround:h}}}function b(E,i){return 180*E.angleWith(i)/Math.PI}class M extends gl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,h,g){const v=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:b(this._vector,v),pinchAround:h}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const h=25/(Math.PI*this._minDiameter)*360,g=b(i,this._startVector);return Math.abs(g)<h}}function $(E){return Math.abs(E.y)>Math.abs(E.x)}class Z extends gl{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,h,g){super.touchstart(i,h,g),this._currentTouchCount=g.length}_start(i){this._lastPoints=i,$(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,h,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=i[0].sub(this._lastPoints[0]),T=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,T,g.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5}):void 0}gestureBeginsVertically(i,h,g){if(this._valid!==void 0)return this._valid;const v=i.mag()>=2,T=h.mag()>=2;if(!v&&!T)return;if(!v||!T)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const z=i.y>0==h.y>0;return $(i)&&$(h)&&z}}const ce={panStep:100,bearingStep:15,pitchStep:10};class Ce{constructor(i){this._tr=new wr(i);const h=ce;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let h=0,g=0,v=0,T=0,z=0;switch(i.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:i.shiftKey?g=-1:(i.preventDefault(),T=-1);break;case 39:i.shiftKey?g=1:(i.preventDefault(),T=1);break;case 38:i.shiftKey?v=1:(i.preventDefault(),z=-1);break;case 40:i.shiftKey?v=-1:(i.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(g=0,v=0),{cameraAnimation:O=>{const U=this._tr;O.easeTo({duration:300,easeId:"keyboardHandler",easing:Xe,zoom:h?Math.round(U.zoom)+h*(i.shiftKey?2:1):U.zoom,bearing:U.bearing+g*this._bearingStep,pitch:U.pitch+v*this._pitchStep,offset:[-T*this._panStep,-z*this._panStep],center:U.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xe(E){return E*(2-E)}const dt=4.000244140625;class wt{constructor(i,h){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=i,this._tr=new wr(i),this._triggerRenderFrame=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(i){return!!this._map.cooperativeGestures.isEnabled()&&!(i.ctrlKey||this._map.cooperativeGestures.isBypassed(i))}wheel(i){if(!this.isEnabled())return;if(this._shouldBePrevented(i))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",i);let h=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const g=N.now(),v=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%dt==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),i.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=i,this._delta-=h,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=V.mousePos(this._map.getCanvas(),i),g=this._tr;this._around=h.y>g.transform.height/2-g.transform.getHorizon()?d.N.convert(this._aroundCenter?g.center:g.unproject(h)):d.N.convert(g.center),this._aroundPoint=g.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>dt?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&H!==0&&(H=1/H);const X=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(X*H))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,g=this._startZoom,v=this._easing;let T,z=!1;const O=N.now()-this._lastWheelEventTime;if(this._type==="wheel"&&g&&v&&O){const U=Math.min(O/200,1),H=v(U);T=d.y.number(g,h,H),U<1?this._frameId||(this._frameId=!0):z=!0}else T=h,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:T-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let h=d.b9;if(this._prevEase){const g=this._prevEase,v=(N.now()-g.start)/g.duration,T=g.easing(v+.01)-g.easing(v),z=.27/Math.sqrt(T*T+1e-4)*.01,O=Math.sqrt(.0729-z*z);h=d.b8(z,O,.25,1)}return this._prevEase={start:N.now(),duration:i,easing:h},h}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Wt{constructor(i,h){this._clickZoom=i,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xi{constructor(i){this._tr=new wr(i),this.reset()}reset(){this._active=!1}dblclick(i,h){return i.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(h)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nn{constructor(){this._tap=new go({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,h,g){if(!this._swipePoint)if(this._tapTime){const v=h[0],T=i.timeStamp-this._tapTime<500,z=this._tapPoint.dist(v)<30;T&&z?g.length>0&&(this._swipePoint=v,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(i,h,g)}touchmove(i,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const v=h[0],T=v.y-this._swipePoint.y;return this._swipePoint=v,i.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(i,h,g)}touchend(i,h,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const v=this._tap.touchend(i,h,g);v&&(this._tapTime=i.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hs{constructor(i,h,g){this._el=i,this._mousePan=h,this._touchPan=g}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ws{constructor(i,h,g){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Tr{constructor(i,h,g,v){this._el=i,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class _n{constructor(i,h){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=h,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=V.create("div","maplibregl-cooperative-gesture-screen",i);let h=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(h=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=h,this._container.appendChild(v);const T=document.createElement("div");T.className="maplibregl-mobile-message",T.textContent=g,this._container.appendChild(T),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(i){return i[this._bypassKey]}notifyGestureBlocked(i,h){this._enabled&&(this._map.fire(new d.k("cooperativegestureprevented",{gestureType:i,originalEvent:h})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Yi=E=>E.zoom||E.drag||E.pitch||E.rotate;class It extends d.k{}function Aa(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta}class zr{constructor(i,h){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,T)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const z=v.type==="renderFrame"?void 0:v,O={needsRenderFrame:!1},U={},H={},X=v.touches,K=X?this._getMapTouches(X):void 0,ae=K?V.touchPos(this._map.getCanvas(),K):V.mousePos(this._map.getCanvas(),v);for(const{handlerName:Ee,handler:Pe,allowed:Ie}of this._handlers){if(!Pe.isEnabled())continue;let Re;this._blockedByActive(H,Ie,Ee)?Pe.reset():Pe[T||v.type]&&(Re=Pe[T||v.type](v,ae,K),this.mergeHandlerResult(O,U,Re,Ee,z),Re&&Re.needsRenderFrame&&this._triggerRenderFrame()),(Re||Pe.isActive())&&(H[Ee]=Pe)}const fe={};for(const Ee in this._previousActiveHandlers)H[Ee]||(fe[Ee]=z);this._previousActiveHandlers=H,(Object.keys(fe).length||Aa(O))&&(this._changes.push([O,U,fe]),this._triggerRenderFrame()),(Object.keys(H).length||Aa(O))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:_e}=O;_e&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],_e(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Oo(i),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,T,z]of this._listeners)V.addEventListener(v,T,v===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[i,h,g]of this._listeners)V.removeEventListener(i,h,i===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(i){const h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new br(h,i));const v=h.boxZoom=new Ms(h,i);this._add("boxZoom",v),i.interactive&&i.boxZoom&&v.enable();const T=h.cooperativeGestures=new _n(h,i.cooperativeGestures);this._add("cooperativeGestures",T),i.cooperativeGestures&&T.enable();const z=new qa(h),O=new xi(h);h.doubleClickZoom=new Wt(O,z),this._add("tapZoom",z),this._add("clickZoom",O),i.interactive&&i.doubleClickZoom&&h.doubleClickZoom.enable();const U=new nn;this._add("tapDragZoom",U);const H=h.touchPitch=new Z(h);this._add("touchPitch",H),i.interactive&&i.touchPitch&&h.touchPitch.enable(i.touchPitch);const X=oc(i),K=ml(i);h.dragRotate=new ws(i,X,K),this._add("mouseRotate",X,["mousePitch"]),this._add("mousePitch",K,["mouseRotate"]),i.interactive&&i.dragRotate&&h.dragRotate.enable();const ae=(({enable:Re,clickTolerance:Se})=>{const $e=new Js({checkCorrectEvent:Ze=>V.mouseButton(Ze)===0&&!Ze.ctrlKey});return new Sr({clickTolerance:Se,move:(Ze,nt)=>({around:nt,panDelta:nt.sub(Ze)}),activateOnStart:!0,moveStateManager:$e,enable:Re,assignEvents:Wr})})(i),fe=new Yr(i,h);h.dragPan=new Hs(g,ae,fe),this._add("mousePan",ae),this._add("touchPan",fe,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&h.dragPan.enable(i.dragPan);const _e=new M,Ee=new u;h.touchZoomRotate=new Tr(g,Ee,_e,U),this._add("touchRotate",_e,["touchPan","touchZoom"]),this._add("touchZoom",Ee,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&h.touchZoomRotate.enable(i.touchZoomRotate);const Pe=h.scrollZoom=new wt(h,(()=>this._triggerRenderFrame()));this._add("scrollZoom",Pe,["mousePan"]),i.interactive&&i.scrollZoom&&h.scrollZoom.enable(i.scrollZoom);const Ie=h.keyboard=new Ce(h);this._add("keyboard",Ie),i.interactive&&i.keyboard&&h.keyboard.enable(),this._add("blockableMapEvent",new ss(h))}_add(i,h,g){this._handlers.push({handlerName:i,handler:h,allowed:g}),this._handlersById[i]=h}stop(i){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Yi(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,h,g){for(const v in i)if(v!==g&&(!h||h.indexOf(v)<0))return!0;return!1}_getMapTouches(i){const h=[];for(const g of i)this._el.contains(g.target)&&h.push(g);return h}mergeHandlerResult(i,h,g,v,T){if(!g)return;d.e(i,g);const z={handlerName:v,originalEvent:g.originalEvent||T};g.zoomDelta!==void 0&&(h.zoom=z),g.panDelta!==void 0&&(h.drag=z),g.pitchDelta!==void 0&&(h.pitch=z),g.bearingDelta!==void 0&&(h.rotate=z)}_applyChanges(){const i={},h={},g={};for(const[v,T,z]of this._changes)v.panDelta&&(i.panDelta=(i.panDelta||new d.P(0,0))._add(v.panDelta)),v.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(i.around=v.around),v.pinchAround!==void 0&&(i.pinchAround=v.pinchAround),v.noInertia&&(i.noInertia=v.noInertia),d.e(h,T),d.e(g,z);this._updateMapTransform(i,h,g),this._changes=[]}_updateMapTransform(i,h,g){const v=this._map,T=v._getTransformForUpdate(),z=v.terrain;if(!(Aa(i)||z&&this._terrainMovement))return this._fireEvents(h,g,!0);let{panDelta:O,zoomDelta:U,bearingDelta:H,pitchDelta:X,around:K,pinchAround:ae}=i;ae!==void 0&&(K=ae),v._stop(!0),K=K||v.transform.centerPoint;const fe=T.pointLocation(O?K.sub(O):K);H&&(T.bearing+=H),X&&(T.pitch+=X),U&&(T.zoom+=U),z?this._terrainMovement||!h.drag&&!h.zoom?h.drag&&this._terrainMovement?T.center=T.pointLocation(T.centerPoint.sub(O)):T.setLocationAtPoint(fe,K):(this._terrainMovement=!0,this._map._elevationFreeze=!0,T.setLocationAtPoint(fe,K)):T.setLocationAtPoint(fe,K),v._applyUpdatedTransform(T),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(h,g,!0)}_fireEvents(i,h,g){const v=Yi(this._eventsInProgress),T=Yi(i),z={};for(const K in i){const{originalEvent:ae}=i[K];this._eventsInProgress[K]||(z[`${K}start`]=ae),this._eventsInProgress[K]=i[K]}!v&&T&&this._fireEvent("movestart",T.originalEvent);for(const K in z)this._fireEvent(K,z[K]);T&&this._fireEvent("move",T.originalEvent);for(const K in i){const{originalEvent:ae}=i[K];this._fireEvent(K,ae)}const O={};let U;for(const K in this._eventsInProgress){const{handlerName:ae,originalEvent:fe}=this._eventsInProgress[K];this._handlersById[ae].isActive()||(delete this._eventsInProgress[K],U=h[ae]||fe,O[`${K}end`]=U)}for(const K in O)this._fireEvent(K,O[K]);const H=Yi(this._eventsInProgress),X=(v||T)&&!H;if(X&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const K=this._map._getTransformForUpdate();K.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(K)}if(g&&X){this._updatingCamera=!0;const K=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ae=fe=>fe!==0&&-this._bearingSnap<fe&&fe<this._bearingSnap;!K||!K.essential&&N.prefersReducedMotion?(this._map.fire(new d.k("moveend",{originalEvent:U})),ae(this._map.getBearing())&&this._map.resetNorth()):(ae(K.bearing||this._map.getBearing())&&(K.bearing=0),K.freezeElevation=!0,this._map.easeTo(K,{originalEvent:U})),this._updatingCamera=!1}}_fireEvent(i,h){this._map.fire(new d.k(i,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((i=>{delete this._frameId,this.handleEvent(new It("renderFrame",{timeStamp:i})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class cc extends d.E{constructor(i,h){super(),this._renderFrameCallback=()=>{const g=Math.min((N.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=h.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new d.N(this.transform.center.lng,this.transform.center.lat)}setCenter(i,h){return this.jumpTo({center:i},h)}panBy(i,h,g){return i=d.P.convert(i).mult(-1),this.panTo(this.transform.center,d.e({offset:i},h),g)}panTo(i,h,g){return this.easeTo(d.e({center:i},h),g)}getZoom(){return this.transform.zoom}setZoom(i,h){return this.jumpTo({zoom:i},h),this}zoomTo(i,h,g){return this.easeTo(d.e({zoom:i},h),g)}zoomIn(i,h){return this.zoomTo(this.getZoom()+1,i,h),this}zoomOut(i,h){return this.zoomTo(this.getZoom()-1,i,h),this}getBearing(){return this.transform.bearing}setBearing(i,h){return this.jumpTo({bearing:i},h),this}getPadding(){return this.transform.padding}setPadding(i,h){return this.jumpTo({padding:i},h),this}rotateTo(i,h,g){return this.easeTo(d.e({bearing:i},h),g)}resetNorth(i,h){return this.rotateTo(0,d.e({duration:1e3},i),h),this}resetNorthPitch(i,h){return this.easeTo(d.e({bearing:0,pitch:0,duration:1e3},i),h),this}snapToNorth(i,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,h):this}getPitch(){return this.transform.pitch}setPitch(i,h){return this.jumpTo({pitch:i},h),this}cameraForBounds(i,h){i=it.convert(i).adjustAntiMeridian();const g=h&&h.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),g,h)}_cameraForBoxAndBearing(i,h,g,v){const T={top:0,bottom:0,right:0,left:0};if(typeof(v=d.e({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const qt=v.padding;v.padding={top:qt,bottom:qt,right:qt,left:qt}}v.padding=d.e(T,v.padding);const z=this.transform,O=z.padding,U=new it(i,h),H=z.project(U.getNorthWest()),X=z.project(U.getNorthEast()),K=z.project(U.getSouthEast()),ae=z.project(U.getSouthWest()),fe=d.ba(-g),_e=H.rotate(fe),Ee=X.rotate(fe),Pe=K.rotate(fe),Ie=ae.rotate(fe),Re=new d.P(Math.max(_e.x,Ee.x,Ie.x,Pe.x),Math.max(_e.y,Ee.y,Ie.y,Pe.y)),Se=new d.P(Math.min(_e.x,Ee.x,Ie.x,Pe.x),Math.min(_e.y,Ee.y,Ie.y,Pe.y)),$e=Re.sub(Se),Ze=(z.width-(O.left+O.right+v.padding.left+v.padding.right))/$e.x,nt=(z.height-(O.top+O.bottom+v.padding.top+v.padding.bottom))/$e.y;if(nt<0||Ze<0)return void d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const bt=Math.min(z.scaleZoom(z.scale*Math.min(Ze,nt)),v.maxZoom),$t=d.P.convert(v.offset),Vt=new d.P((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(d.ba(g)),ti=$t.add(Vt).mult(z.scale/z.zoomScale(bt));return{center:z.unproject(H.add(K).div(2).sub(ti)),zoom:bt,bearing:g}}fitBounds(i,h,g){return this._fitInternal(this.cameraForBounds(i,h),h,g)}fitScreenCoordinates(i,h,g,v,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.P.convert(i)),this.transform.pointLocation(d.P.convert(h)),g,v),v,T)}_fitInternal(i,h,g){return i?(delete(h=d.e(i,h)).padding,h.linear?this.easeTo(h,g):this.flyTo(h,g)):this}jumpTo(i,h){this.stop();const g=this._getTransformForUpdate();let v=!1,T=!1,z=!1;return"zoom"in i&&g.zoom!==+i.zoom&&(v=!0,g.zoom=+i.zoom),i.center!==void 0&&(g.center=d.N.convert(i.center)),"bearing"in i&&g.bearing!==+i.bearing&&(T=!0,g.bearing=+i.bearing),"pitch"in i&&g.pitch!==+i.pitch&&(z=!0,g.pitch=+i.pitch),i.padding==null||g.isPaddingEqual(i.padding)||(g.padding=i.padding),this._applyUpdatedTransform(g),this.fire(new d.k("movestart",h)).fire(new d.k("move",h)),v&&this.fire(new d.k("zoomstart",h)).fire(new d.k("zoom",h)).fire(new d.k("zoomend",h)),T&&this.fire(new d.k("rotatestart",h)).fire(new d.k("rotate",h)).fire(new d.k("rotateend",h)),z&&this.fire(new d.k("pitchstart",h)).fire(new d.k("pitch",h)).fire(new d.k("pitchend",h)),this.fire(new d.k("moveend",h))}calculateCameraOptionsFromTo(i,h,g,v=0){const T=d.Z.fromLngLat(i,h),z=d.Z.fromLngLat(g,v),O=z.x-T.x,U=z.y-T.y,H=z.z-T.z,X=Math.hypot(O,U,H);if(X===0)throw new Error("Can't calculate camera options with same From and To");const K=Math.hypot(O,U),ae=this.transform.scaleZoom(this.transform.cameraToCenterDistance/X/this.transform.tileSize),fe=180*Math.atan2(O,-U)/Math.PI;let _e=180*Math.acos(K/X)/Math.PI;return _e=H<0?90-_e:90+_e,{center:z.toLngLat(),zoom:ae,pitch:_e,bearing:fe}}easeTo(i,h){var g;this._stop(!1,i.easeId),((i=d.e({offset:[0,0],duration:500,easing:d.b9},i)).animate===!1||!i.essential&&N.prefersReducedMotion)&&(i.duration=0);const v=this._getTransformForUpdate(),T=v.zoom,z=v.bearing,O=v.pitch,U=v.padding,H="bearing"in i?this._normalizeBearing(i.bearing,z):z,X="pitch"in i?+i.pitch:O,K="padding"in i?i.padding:v.padding,ae=d.P.convert(i.offset);let fe=v.centerPoint.add(ae);const _e=v.pointLocation(fe),{center:Ee,zoom:Pe}=v.getConstrained(d.N.convert(i.center||_e),(g=i.zoom)!==null&&g!==void 0?g:T);this._normalizeCenter(Ee,v);const Ie=v.project(_e),Re=v.project(Ee).sub(Ie),Se=v.zoomScale(Pe-T);let $e,Ze;i.around&&($e=d.N.convert(i.around),Ze=v.locationPoint($e));const nt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Pe!==T,this._rotating=this._rotating||z!==H,this._pitching=this._pitching||X!==O,this._padding=!v.isPaddingEqual(K),this._easeId=i.easeId,this._prepareEase(h,i.noMoveStart,nt),this.terrain&&this._prepareElevation(Ee),this._ease((bt=>{if(this._zooming&&(v.zoom=d.y.number(T,Pe,bt)),this._rotating&&(v.bearing=d.y.number(z,H,bt)),this._pitching&&(v.pitch=d.y.number(O,X,bt)),this._padding&&(v.interpolatePadding(U,K,bt),fe=v.centerPoint.add(ae)),this.terrain&&!i.freezeElevation&&this._updateElevation(bt),$e)v.setLocationAtPoint($e,Ze);else{const $t=v.zoomScale(v.zoom-T),Vt=Pe>T?Math.min(2,Se):Math.max(.5,Se),ti=Math.pow(Vt,1-bt),qt=v.unproject(Ie.add(Re.mult(bt*ti)).mult($t));v.setLocationAtPoint(v.renderWorldCopies?qt.wrap():qt,fe)}this._applyUpdatedTransform(v),this._fireMoveEvents(h)}),(bt=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(h,bt)}),i),this}_prepareEase(i,h,g={}){this._moving=!0,h||g.moving||this.fire(new d.k("movestart",i)),this._zooming&&!g.zooming&&this.fire(new d.k("zoomstart",i)),this._rotating&&!g.rotating&&this.fire(new d.k("rotatestart",i)),this._pitching&&!g.pitching&&this.fire(new d.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const h=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&h!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(g-(h-(g*i+this._elevationStart))/(1-i)),this._elevationTarget=h}this.transform.elevation=d.y.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(i){const h=i.getCameraPosition(),g=this.terrain.getElevationForLngLatZoom(h.lngLat,i.zoom);if(h.altitude<g){const v=this.calculateCameraOptionsFromTo(h.lngLat,g,i.center,i.elevation);return{pitch:v.pitch,zoom:v.zoom}}return{}}_applyUpdatedTransform(i){const h=[];if(this.terrain&&h.push((v=>this._elevateCameraIfInsideTerrain(v))),this.transformCameraUpdate&&h.push((v=>this.transformCameraUpdate(v))),!h.length)return;const g=i.clone();for(const v of h){const T=g.clone(),{center:z,zoom:O,pitch:U,bearing:H,elevation:X}=v(T);z&&(T.center=z),O!==void 0&&(T.zoom=O),U!==void 0&&(T.pitch=U),H!==void 0&&(T.bearing=H),X!==void 0&&(T.elevation=X),g.apply(T)}this.transform.apply(g)}_fireMoveEvents(i){this.fire(new d.k("move",i)),this._zooming&&this.fire(new d.k("zoom",i)),this._rotating&&this.fire(new d.k("rotate",i)),this._pitching&&this.fire(new d.k("pitch",i))}_afterEase(i,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId;const g=this._zooming,v=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new d.k("zoomend",i)),v&&this.fire(new d.k("rotateend",i)),T&&this.fire(new d.k("pitchend",i)),this.fire(new d.k("moveend",i))}flyTo(i,h){var g;if(!i.essential&&N.prefersReducedMotion){const Yt=d.M(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Yt,h)}this.stop(),i=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.b9},i);const v=this._getTransformForUpdate(),T=v.zoom,z=v.bearing,O=v.pitch,U=v.padding,H="bearing"in i?this._normalizeBearing(i.bearing,z):z,X="pitch"in i?+i.pitch:O,K="padding"in i?i.padding:v.padding,ae=d.P.convert(i.offset);let fe=v.centerPoint.add(ae);const _e=v.pointLocation(fe),{center:Ee,zoom:Pe}=v.getConstrained(d.N.convert(i.center||_e),(g=i.zoom)!==null&&g!==void 0?g:T);this._normalizeCenter(Ee,v);const Ie=v.zoomScale(Pe-T),Re=v.project(_e),Se=v.project(Ee).sub(Re);let $e=i.curve;const Ze=Math.max(v.width,v.height),nt=Ze/Ie,bt=Se.mag();if("minZoom"in i){const Yt=d.ac(Math.min(i.minZoom,T,Pe),v.minZoom,v.maxZoom),Ci=Ze/v.zoomScale(Yt-T);$e=Math.sqrt(Ci/bt*2)}const $t=$e*$e;function Vt(Yt){const Ci=(nt*nt-Ze*Ze+(Yt?-1:1)*$t*$t*bt*bt)/(2*(Yt?nt:Ze)*$t*bt);return Math.log(Math.sqrt(Ci*Ci+1)-Ci)}function ti(Yt){return(Math.exp(Yt)-Math.exp(-Yt))/2}function qt(Yt){return(Math.exp(Yt)+Math.exp(-Yt))/2}const Ut=Vt(!1);let ai=function(Yt){return qt(Ut)/qt(Ut+$e*Yt)},Ai=function(Yt){return Ze*((qt(Ut)*(ti(Ci=Ut+$e*Yt)/qt(Ci))-ti(Ut))/$t)/bt;var Ci},Ht=(Vt(!0)-Ut)/$e;if(Math.abs(bt)<1e-6||!isFinite(Ht)){if(Math.abs(Ze-nt)<1e-6)return this.easeTo(i,h);const Yt=nt<Ze?-1:1;Ht=Math.abs(Math.log(nt/Ze))/$e,Ai=()=>0,ai=Ci=>Math.exp(Yt*$e*Ci)}return i.duration="duration"in i?+i.duration:1e3*Ht/("screenSpeed"in i?+i.screenSpeed/$e:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=z!==H,this._pitching=X!==O,this._padding=!v.isPaddingEqual(K),this._prepareEase(h,!1),this.terrain&&this._prepareElevation(Ee),this._ease((Yt=>{const Ci=Yt*Ht,Fn=1/ai(Ci);v.zoom=Yt===1?Pe:T+v.scaleZoom(Fn),this._rotating&&(v.bearing=d.y.number(z,H,Yt)),this._pitching&&(v.pitch=d.y.number(O,X,Yt)),this._padding&&(v.interpolatePadding(U,K,Yt),fe=v.centerPoint.add(ae)),this.terrain&&!i.freezeElevation&&this._updateElevation(Yt);const Hi=Yt===1?Ee:v.unproject(Re.add(Se.mult(Ai(Ci))).mult(Fn));v.setLocationAtPoint(v.renderWorldCopies?Hi.wrap():Hi,fe),this._applyUpdatedTransform(v),this._fireMoveEvents(h)}),(()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(h)}),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,h){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,h)}return i||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(i,h,g){g.animate===!1||g.duration===0?(i(1),h()):(this._easeStart=N.now(),this._easeOptions=g,this._onEaseFrame=i,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,h){i=d.b3(i,-180,180);const g=Math.abs(i-h);return Math.abs(i-360-h)<g&&(i-=360),Math.abs(i+360-h)<g&&(i+=360),i}_normalizeCenter(i,h){if(!h.renderWorldCopies||h.lngRange)return;const g=i.lng-h.center.lng;i.lng+=g>180?-360:g<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(d.N.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}const Xr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class No{constructor(i=Xr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=h=>{!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"&&h.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,h){const g=this._map._getUIString(`AttributionControl.${h}`);i.title=g,i.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map((v=>typeof v!="string"?"":v))):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style.sourceCaches;for(const v in h){const T=h[v];if(T.used||T.usedForTerrain){const z=T.getSource();z.attribution&&i.indexOf(z.attribution)<0&&i.push(z.attribution)}}i=i.filter((v=>String(v).trim())),i.sort(((v,T)=>v.length-T.length)),i=i.filter(((v,T)=>{for(let z=T+1;z<i.length;z++)if(i[z].indexOf(v)>=0)return!1;return!0}));const g=i.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,i.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ps{constructor(i={}){this._updateCompact=()=>{const h=this._container.children;if(h.length){const g=h[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl");const h=V.create("a","maplibregl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Oi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const h=++this._id;return this._queue.push({callback:i,id:h,cancelled:!1}),h}remove(i){const h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(const v of g)if(v.id===i)return void(v.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const h=this._currentlyRunning=this._queue;this._queue=[];for(const g of h)if(!g.cancelled&&(g.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var yo=d.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Cu extends d.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,h){this.sourceCache.update(i,h),this._renderableTilesKeys=[];const g={};for(const v of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:h}))g[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.posMatrix=new Float64Array(16),d.aP(v.posMatrix,0,d.X,0,d.X,0,1),this._tiles[v.key]=new Un(v,this.tileSize));for(const v in this._tiles)g[v]||delete this._tiles[v]}freeRtt(i){for(const h in this._tiles){const g=this._tiles[h];(!i||g.tileID.equals(i)||g.tileID.isChildOf(i)||i.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((i=>this.getTileByID(i)))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const h={};for(const g of this._renderableTilesKeys){const v=this._tiles[g].tileID;if(v.canonical.equals(i.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16),d.aP(T.posMatrix,0,d.X,0,d.X,0,1),h[g]=T}else if(v.canonical.isChildOf(i.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16);const z=v.canonical.z-i.canonical.z,O=v.canonical.x-(v.canonical.x>>z<<z),U=v.canonical.y-(v.canonical.y>>z<<z),H=d.X>>z;d.aP(T.posMatrix,0,H,0,H,0,1),d.J(T.posMatrix,T.posMatrix,[-O*H,-U*H,0]),h[g]=T}else if(i.canonical.isChildOf(v.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16);const z=i.canonical.z-v.canonical.z,O=i.canonical.x-(i.canonical.x>>z<<z),U=i.canonical.y-(i.canonical.y>>z<<z),H=d.X>>z;d.aP(T.posMatrix,0,d.X,0,d.X,0,1),d.J(T.posMatrix,T.posMatrix,[O*H,U*H,0]),d.K(T.posMatrix,T.posMatrix,[1/2**z,1/2**z,0]),h[g]=T}}return h}getSourceTile(i,h){const g=this.sourceCache._source;let v=i.overscaledZ-this.deltaZoom;if(v>g.maxzoom&&(v=g.maxzoom),v<g.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(v).key);let T=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!T||!T.dem)&&h)for(;v>=g.minzoom&&(!T||!T.dem);)T=this.sourceCache.getTileByID(i.scaledTo(v--).key);return T}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter((h=>h.timeAdded>=i))}}class _l{constructor(i,h,g){this.painter=i,this.sourceCache=new Cu(h),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,h,g,v=d.X){var T;if(!(h>=0&&h<v&&g>=0&&g<v))return 0;const z=this.getTerrainData(i),O=(T=z.tile)===null||T===void 0?void 0:T.dem;if(!O)return 0;const U=(function(_e,Ee,Pe){var Ie=Ee[0],Re=Ee[1];return _e[0]=Pe[0]*Ie+Pe[4]*Re+Pe[12],_e[1]=Pe[1]*Ie+Pe[5]*Re+Pe[13],_e})([],[h/v*d.X,g/v*d.X],z.u_terrain_matrix),H=[U[0]*O.dim,U[1]*O.dim],X=Math.floor(H[0]),K=Math.floor(H[1]),ae=H[0]-X,fe=H[1]-K;return O.get(X,K)*(1-ae)*(1-fe)+O.get(X+1,K)*ae*(1-fe)+O.get(X,K+1)*(1-ae)*fe+O.get(X+1,K+1)*ae*fe}getElevationForLngLatZoom(i,h){if(!d.bb(h,i.wrap()))return 0;const{tileID:g,mercatorX:v,mercatorY:T}=this._getOverscaledTileIDFromLngLatZoom(i,h);return this.getElevation(g,v%d.X,T%d.X,d.X)}getElevation(i,h,g,v=d.X){return this.getDEMElevation(i,h,g,v)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const v=this.painter.context,T=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new lt(v,T,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new lt(v,new d.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.an([])}const h=this.sourceCache.getSourceTile(i,!0);if(h&&h.dem&&(!h.demTexture||h.needsTerrainPrepare)){const v=this.painter.context;h.demTexture=this.painter.getTileTexture(h.dem.stride),h.demTexture?h.demTexture.update(h.dem.getPixels(),{premultiply:!1}):h.demTexture=new lt(v,h.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),h.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),h.needsTerrainPrepare=!1}const g=h&&h+h.tileID.key+i.key;if(g&&!this._demMatrixCache[g]){const v=this.sourceCache.sourceCache._source.maxzoom;let T=i.canonical.z-h.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=v?T=i.canonical.z-v:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=i.canonical.x-(i.canonical.x>>T<<T),O=i.canonical.y-(i.canonical.y>>T<<T),U=d.bc(new Float64Array(16),[1/(d.X<<T),1/(d.X<<T),0]);d.J(U,U,[z*d.X,O*d.X,0]),this._demMatrixCache[i.key]={matrix:U,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:h&&h.dem&&h.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:h&&h.dem&&h.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(h&&h.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:h}}getFramebuffer(i){const h=this.painter,g=h.width/devicePixelRatio,v=h.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new lt(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new lt(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=h.context.createFramebuffer(g,v,!0,!1),this._fbo.depthAttachment.set(h.context.createRenderbuffer(h.context.gl.DEPTH_COMPONENT16,g,v))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const h=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let T=0,z=0;T<this._coordsTextureSize;T++)for(let O=0;O<this._coordsTextureSize;O++,z+=4)h[z+0]=255&O,h[z+1]=255&T,h[z+2]=O>>8<<4|T>>8,h[z+3]=0;const g=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(h.buffer)),v=new lt(i,g,i.gl.RGBA,{premultiply:!1});return v.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const h=new Uint8Array(4),g=this.painter.context,v=g.gl,T=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),z=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),O=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(T,O-z-1,1,1,v.RGBA,v.UNSIGNED_BYTE,h),g.bindFramebuffer.set(null);const U=h[0]+(h[2]>>4<<8),H=h[1]+((15&h[2])<<8),X=this.coordsIndex[255-h[3]],K=X&&this.sourceCache.getTileByID(X);if(!K)return null;const ae=this._coordsTextureSize,fe=(1<<K.tileID.canonical.z)*ae;return new d.Z((K.tileID.canonical.x*ae+U)/fe+K.tileID.wrap,(K.tileID.canonical.y*ae+H)/fe,this.getElevation(K.tileID,U,H,ae))}depthAtPoint(i){const h=new Uint8Array(4),g=this.painter.context,v=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,h),g.bindFramebuffer.set(null),(h[0]/16777216+h[1]/65536+h[2]/256+h[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.painter.context,h=new d.bd,g=new d.aY,v=this.meshSize,T=d.X/v,z=v*v;for(let K=0;K<=v;K++)for(let ae=0;ae<=v;ae++)h.emplaceBack(ae*T,K*T,0);for(let K=0;K<z;K+=v+1)for(let ae=0;ae<v;ae++)g.emplaceBack(ae+K,v+ae+K+1,v+ae+K+2),g.emplaceBack(ae+K,v+ae+K+2,ae+K+1);const O=h.length,U=O+2*(v+1);for(const K of[0,1])for(let ae=0;ae<=v;ae++)for(const fe of[0,1])h.emplaceBack(ae*T,K*d.X,fe);for(let K=0;K<2*v;K+=2)g.emplaceBack(U+K,U+K+1,U+K+3),g.emplaceBack(U+K,U+K+3,U+K+2),g.emplaceBack(O+K,O+K+3,O+K+1),g.emplaceBack(O+K,O+K+2,O+K+3);const H=h.length,X=H+2*(v+1);for(const K of[0,1])for(let ae=0;ae<=v;ae++)for(const fe of[0,1])h.emplaceBack(K*d.X,ae*T,fe);for(let K=0;K<2*v;K+=2)g.emplaceBack(H+K,H+K+1,H+K+3),g.emplaceBack(H+K,H+K+3,H+K+2),g.emplaceBack(X+K,X+K+3,X+K+1),g.emplaceBack(X+K,X+K+2,X+K+3);return this._mesh=new Ro(i.createVertexBuffer(h,yo.members),i.createIndexBuffer(g),d.a0.simpleSegment(0,0,h.length,g.length)),this._mesh}getMeshFrameDelta(i){return 2*Math.PI*d.be/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,h){var g;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(i,h);return(g=this.getMinMaxElevation(v).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(i){const h=this.getTerrainData(i).tile,g={minElevation:null,maxElevation:null};return h&&h.dem&&(g.minElevation=h.dem.min*this.exaggeration,g.maxElevation=h.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(i,h){const g=d.Z.fromLngLat(i.wrap()),v=(1<<h)*d.X,T=g.x*v,z=g.y*v,O=Math.floor(T/d.X),U=Math.floor(z/d.X);return{tileID:new d.S(h,0,h,O,U),mercatorX:T,mercatorY:z}}}class uc{constructor(i,h,g){this._context=i,this._size=h,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const h=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new lt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),h.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),h.colorAttachment.set(g.texture),{id:i,fbo:h,texture:g,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((h=>i.id!==h)),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const h of this._recentlyUsed)if(!this._objects[h].inUse)return this._objects[h];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((i=>!i.inUse))===!1}}const Kr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ha{constructor(i,h){this.painter=i,this.terrain=h,this.pool=new uc(i.context,30,h.sourceCache.tileSize*h.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,h){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter((g=>!i._layers[g].isHidden(h))),this._coordsDescendingInv={};for(const g in i.sourceCaches){this._coordsDescendingInv[g]={};const v=i.sourceCaches[g].getVisibleCoordinates();for(const T of v){const z=this.terrain.sourceCache.getTerrainCoords(T);for(const O in z)this._coordsDescendingInv[g][O]||(this._coordsDescendingInv[g][O]=[]),this._coordsDescendingInv[g][O].push(z[O])}}this._coordsDescendingInvStr={};for(const g of i._order){const v=i._layers[g],T=v.source;if(Kr[v.type]&&!this._coordsDescendingInvStr[T]){this._coordsDescendingInvStr[T]={};for(const z in this._coordsDescendingInv[T])this._coordsDescendingInvStr[T][z]=this._coordsDescendingInv[T][z].map((O=>O.key)).sort().join()}}for(const g of this._renderableTiles)for(const v in this._coordsDescendingInvStr){const T=this._coordsDescendingInvStr[v][g.tileID.key];T&&T!==g.rttCoords[v]&&(g.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;const h=i.type,g=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(Kr[h]&&(this._prevType&&Kr[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(i.id),!v))return!0;if(Kr[this._prevType]||Kr[h]&&v){this._prevType=h;const T=this._stacks.length-1,z=this._stacks[T]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(rc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[T]){const H=this.pool.getObjectForId(O.rtt[T].id);if(H.stamp===O.rtt[T].stamp){this.pool.useObject(H);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),O.rtt[T]={id:U.id,stamp:U.stamp},g.context.bindFramebuffer.set(U.fbo.framebuffer),g.context.clear({color:d.aM.transparent,stencil:0}),g.currentStencilSource=void 0;for(let H=0;H<z.length;H++){const X=g.style._layers[z[H]],K=X.source?this._coordsDescendingInv[X.source][O.tileID.key]:[O.tileID];g.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),g._renderTileClippingMasks(X,K),g.renderLayer(g,g.style.sourceCaches[X.source],X,K),X.source&&(O.rttCoords[X.source]=this._coordsDescendingInvStr[X.source][O.tileID.key])}}return rc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Kr[h]}return!1}}const Bo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},$o=A,Qh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Xr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Au=E=>{E.touchstart=E.dragStart,E.touchmoveWindow=E.dragMove,E.touchend=E.dragEnd},Hc={showCompass:!0,showZoom:!0,visualizePitch:!1};class lh{constructor(i,h,g=!1){this.mousedown=z=>{this.startMouse(d.e({},z,{ctrlKey:!0,preventDefault:()=>z.preventDefault()}),V.mousePos(this.element,z)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=z=>{this.moveMouse(z,V.mousePos(this.element,z))},this.mouseup=z=>{this.mouseRotate.dragEnd(z),this.mousePitch&&this.mousePitch.dragEnd(z),this.offTemp()},this.touchstart=z=>{z.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,z.targetTouches)[0],this.startTouch(z,this._startPos),V.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.addEventListener(window,"touchend",this.touchend))},this.touchmove=z=>{z.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,z.targetTouches)[0],this.moveTouch(z,this._lastPos))},this.touchend=z=>{z.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const v=i.dragRotate._mouseRotate.getClickTolerance(),T=i.dragRotate._mousePitch.getClickTolerance();this.element=h,this.mouseRotate=oc({clickTolerance:v,enable:!0}),this.touchRotate=(({enable:z,clickTolerance:O,bearingDegreesPerPixelMoved:U=.8})=>{const H=new Fl;return new Sr({clickTolerance:O,move:(X,K)=>({bearingDelta:(K.x-X.x)*U}),moveStateManager:H,enable:z,assignEvents:Au})})({clickTolerance:v,enable:!0}),this.map=i,g&&(this.mousePitch=ml({clickTolerance:T,enable:!0}),this.touchPitch=(({enable:z,clickTolerance:O,pitchDegreesPerPixelMoved:U=-.5})=>{const H=new Fl;return new Sr({clickTolerance:O,move:(X,K)=>({pitchDelta:(K.y-X.y)*U}),moveStateManager:H,enable:z,assignEvents:Au})})({clickTolerance:T,enable:!0})),V.addEventListener(h,"mousedown",this.mousedown),V.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(h,"touchcancel",this.reset)}startMouse(i,h){this.mouseRotate.dragStart(i,h),this.mousePitch&&this.mousePitch.dragStart(i,h),V.disableDrag()}startTouch(i,h){this.touchRotate.dragStart(i,h),this.touchPitch&&this.touchPitch.dragStart(i,h),V.disableDrag()}moveMouse(i,h){const g=this.map,{bearingDelta:v}=this.mouseRotate.dragMove(i,h)||{};if(v&&g.setBearing(g.getBearing()+v),this.mousePitch){const{pitchDelta:T}=this.mousePitch.dragMove(i,h)||{};T&&g.setPitch(g.getPitch()+T)}}moveTouch(i,h){const g=this.map,{bearingDelta:v}=this.touchRotate.dragMove(i,h)||{};if(v&&g.setBearing(g.getBearing()+v),this.touchPitch){const{pitchDelta:T}=this.touchPitch.dragMove(i,h)||{};T&&g.setPitch(g.getPitch()+T)}}off(){const i=this.element;V.removeEventListener(i,"mousedown",this.mousedown),V.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend),V.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend)}}let Qs;function Ji(E,i,h){const g=new d.N(E.lng,E.lat);if(E=new d.N(E.lng,E.lat),i){const v=new d.N(E.lng-360,E.lat),T=new d.N(E.lng+360,E.lat),z=h.locationPoint(E).distSqr(i);h.locationPoint(v).distSqr(i)<z?E=v:h.locationPoint(T).distSqr(i)<z&&(E=T)}for(;Math.abs(E.lng-h.center.lng)>180;){const v=h.locationPoint(E);if(v.x>=0&&v.y>=0&&v.x<=h.width&&v.y<=h.height)break;E.lng>h.center.lng?E.lng-=360:E.lng+=360}return E.lng!==g.lng&&h.locationPoint(E).y>h.height/2-h.getHorizon()?E:g}const vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mu(E,i,h){const g=E.classList;for(const v in vl)g.remove(`maplibregl-${h}-anchor-${v}`);g.add(`maplibregl-${h}-anchor-${i}`)}class ch extends d.E{constructor(i){if(super(),this._onKeyPress=h=>{const g=h.code,v=h.charCode||h.keyCode;g!=="Space"&&g!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=h=>{const g=h.originalEvent.target,v=this._element;this._popup&&(g===v||v.contains(g))&&this.togglePopup()},this._update=h=>{var g;if(!this._map)return;const v=this._map.loaded()&&!this._map.isMoving();(h?.type==="terrain"||h?.type==="render"&&!v)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Ji(this._lngLat,this._flatPos,this._map.transform):(g=this._lngLat)===null||g===void 0?void 0:g.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let T="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?T=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(T=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let z="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?z="rotateX(0deg)":this._pitchAlignment==="map"&&(z=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||h&&h.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${vl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${z} ${T}`),N.frameAsync(new AbortController).then((()=>{this._updateOpacity(h&&h.type==="moveend")})).catch((()=>{}))},this._onMove=h=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.k("dragstart"))),this.fire(new d.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.k("dragend")),this._state="inactive"},this._addDragHandler=h=>{this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._subpixelPositioning=i&&i.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(i?.opacity,i?.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=d.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div");const h=V.createNS("http://www.w3.org/2000/svg","svg"),g=41,v=27;h.setAttributeNS(null,"display","block"),h.setAttributeNS(null,"height",`${g}px`),h.setAttributeNS(null,"width",`${v}px`),h.setAttributeNS(null,"viewBox",`0 0 ${v} ${g}`);const T=V.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const z=V.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill-rule","nonzero");const O=V.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"transform","translate(3.0, 29.0)"),O.setAttributeNS(null,"fill","#000000");const U=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ie of U){const Re=V.createNS("http://www.w3.org/2000/svg","ellipse");Re.setAttributeNS(null,"opacity","0.04"),Re.setAttributeNS(null,"cx","10.5"),Re.setAttributeNS(null,"cy","5.80029008"),Re.setAttributeNS(null,"rx",Ie.rx),Re.setAttributeNS(null,"ry",Ie.ry),O.appendChild(Re)}const H=V.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);const X=V.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(X);const K=V.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"opacity","0.25"),K.setAttributeNS(null,"fill","#000000");const ae=V.createNS("http://www.w3.org/2000/svg","path");ae.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),K.appendChild(ae);const fe=V.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),fe.setAttributeNS(null,"fill","#FFFFFF");const _e=V.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ee=V.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#000000"),Ee.setAttributeNS(null,"opacity","0.25"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962");const Pe=V.createNS("http://www.w3.org/2000/svg","circle");Pe.setAttributeNS(null,"fill","#FFFFFF"),Pe.setAttributeNS(null,"cx","5.5"),Pe.setAttributeNS(null,"cy","5.5"),Pe.setAttributeNS(null,"r","5.4999962"),_e.appendChild(Ee),_e.appendChild(Pe),z.appendChild(O),z.appendChild(H),z.appendChild(K),z.appendChild(fe),z.appendChild(_e),h.appendChild(z),h.setAttributeNS(null,"height",g*this._scale+"px"),h.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(h),this._offset=d.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(h=>{h.preventDefault()})),this._element.addEventListener("mousedown",(h=>{h.preventDefault()})),Mu(this._element,this._anchor,"marker"),i&&i.className)for(const h of i.className.split(" "))this._element.classList.add(h);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=d.N.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const v=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(i){return this._subpixelPositioning=i,this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var h,g;if(!(!((h=this._map)===null||h===void 0)&&h.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const v=this._map,T=v.terrain.depthAtPoint(this._pos),z=v.terrain.getElevationForLngLatZoom(this._lngLat,v.transform.tileZoom);if(v.transform.lngLatToCameraDepth(this._lngLat,z)-T<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/v.transform._pixelPerMeter,U=Math.sin(v.getPitch()*Math.PI/180)*O,H=v.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),X=v.transform.lngLatToCameraDepth(this._lngLat,z+U)-H>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&X&&this._popup.remove(),this._element.style.opacity=X?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=d.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,h){return i===void 0&&h===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),h!==void 0&&(this._opacityWhenCovered=h),this._map&&this._updateOpacity(!0),this}}const rf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Pu=0,ys=!1;const Za={maxWidth:100,unit:"metric"};function xl(E,i,h){const g=h&&h.maxWidth||100,v=E._container.clientHeight/2,T=E.unproject([0,v]),z=E.unproject([g,v]),O=T.distanceTo(z);if(h&&h.unit==="imperial"){const U=3.2808*O;U>5280?ci(i,g,U/5280,E._getUIString("ScaleControl.Miles")):ci(i,g,U,E._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?ci(i,g,O/1852,E._getUIString("ScaleControl.NauticalMiles")):O>=1e3?ci(i,g,O/1e3,E._getUIString("ScaleControl.Kilometers")):ci(i,g,O,E._getUIString("ScaleControl.Meters"))}function ci(E,i,h,g){const v=(function(T){const z=Math.pow(10,`${Math.floor(T)}`.length-1);let O=T/z;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:(function(U){const H=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*H)/H})(O),z*O})(h);E.style.width=i*(v/h)+"px",E.innerHTML=`${v}&nbsp;${g}`}const bi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},bl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wl(E){if(E){if(typeof E=="number"){const i=Math.round(Math.abs(E)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,E),"top-left":new d.P(i,i),"top-right":new d.P(-i,i),bottom:new d.P(0,-E),"bottom-left":new d.P(i,-i),"bottom-right":new d.P(-i,-i),left:new d.P(E,0),right:new d.P(-E,0)}}if(E instanceof d.P||Array.isArray(E)){const i=d.P.convert(E);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:d.P.convert(E.center||[0,0]),top:d.P.convert(E.top||[0,0]),"top-left":d.P.convert(E["top-left"]||[0,0]),"top-right":d.P.convert(E["top-right"]||[0,0]),bottom:d.P.convert(E.bottom||[0,0]),"bottom-left":d.P.convert(E["bottom-left"]||[0,0]),"bottom-right":d.P.convert(E["bottom-right"]||[0,0]),left:d.P.convert(E.left||[0,0]),right:d.P.convert(E.right||[0,0])}}return wl(new d.P(0,0))}const ed=A;y.AJAXError=d.bh,y.Evented=d.E,y.LngLat=d.N,y.MercatorCoordinate=d.Z,y.Point=d.P,y.addProtocol=d.bi,y.config=d.a,y.removeProtocol=d.bj,y.AttributionControl=No,y.BoxZoomHandler=Ms,y.CanvasSource=Xi,y.CooperativeGesturesHandler=_n,y.DoubleClickZoomHandler=Wt,y.DragPanHandler=Hs,y.DragRotateHandler=ws,y.EdgeInsets=ka,y.FullscreenControl=class extends d.E{constructor(E={}){super(),this._onFullscreenChange=()=>{var i;let h=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=h?.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)h=h.shadowRoot.fullscreenElement;h===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,E&&E.container&&(E.container instanceof HTMLElement?this._container=E.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const E=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon",E).setAttribute("aria-hidden","true"),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=En,y.GeolocateControl=class extends d.E{constructor(E){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new d.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{const h=new d.N(i.coords.longitude,i.coords.latitude),g=i.coords.accuracy,v=this._map.getBearing(),T=d.e({bearing:v},this.options.fitBoundsOptions),z=it.fromLngLat(h,g);this._map.fitBounds(z,T,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const h=new d.N(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&ys)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=i=>{if(this._map){if(i===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ch({element:this._dotElement}),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ch({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.k("trackuserlocationend")),this.fire(new d.k("userlocationlostfocus")))}))}},this.options=d.e({},rf,E)}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return d._(this,arguments,void 0,(function*(i=!1){if(Qs!==void 0&&!i)return Qs;if(window.navigator.permissions===void 0)return Qs=!!window.navigator.geolocation,Qs;try{Qs=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Qs=!!window.navigator.geolocation}return Qs}))})().then((i=>this._finishSetupUI(i))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Pu=0,ys=!1}_isOutOfMapMaxBounds(E){const i=this._map.getMaxBounds(),h=E.coords;return i&&(h.longitude<i.getWest()||h.longitude>i.getEast()||h.latitude<i.getSouth()||h.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const E=this._map.getBounds(),i=E.getSouthEast(),h=E.getNorthEast(),g=i.distanceTo(h),v=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Pu--,ys=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.k("trackuserlocationstart")),this.fire(new d.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let E;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Pu++,Pu>1?(E={maximumAge:6e5,timeout:0},ys=!0):(E=this.options.positionOptions,ys=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,E)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.Hash=Do,y.ImageSource=is,y.KeyboardHandler=Ce,y.LngLatBounds=it,y.LogoControl=ps,y.Map=class extends cc{constructor(E){d.bf.mark(d.bg.create);const i=Object.assign(Object.assign({},Qh),E);if(i.minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new dl(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Oi,this._controls=[],this._mapId=d.a4(),this._contextLost=h=>{h.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.k("webglcontextlost",{originalEvent:h}))},this._contextRestored=h=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.k("webglcontextrestored",{originalEvent:h}))},this._onMapScroll=h=>{if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=i.preserveDrawingBuffer===!0,this._antialias=i.antialias===!0,this._trackResize=i.trackResize===!0,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles===!0,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=i.crossSourceCollisions===!0,this._collectResourceTiming=i.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Bo),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=i.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=le.addThrottleControl((()=>this.isMoving())),this._requestManager=new me(i.transformRequest),typeof i.container=="string"){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let h=!1;const g=As((v=>{this._trackResize&&!this._removed&&(this.resize(v),this.redraw())}),50);this._resizeObserver=new ResizeObserver((v=>{h?g(v):h=!0})),this._resizeObserver.observe(this._container)}this.handlers=new zr(this,i),this._hash=i.hash&&new Do(typeof i.hash=="string"&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,d.e({},i.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new No(typeof i.attributionControl=="boolean"?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new ps,i.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(h=>{this._update(h.dataType==="style"),this.fire(new d.k(`${h.dataType}data`,h))})),this.on("dataloading",(h=>{this.fire(new d.k(`${h.dataType}dataloading`,h))})),this.on("dataabort",(h=>{this.fire(new d.k("sourcedataabort",h))}))}_getMapId(){return this._mapId}addControl(E,i){if(i===void 0&&(i=E.getDefaultPosition?E.getDefaultPosition():"top-right"),!E||!E.onAdd)return this.fire(new d.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=E.onAdd(this);this._controls.push(E);const g=this._controlPositions[i];return i.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(E){if(!E||!E.onRemove)return this.fire(new d.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(E);return i>-1&&this._controls.splice(i,1),E.onRemove(this),this}hasControl(E){return this._controls.indexOf(E)>-1}calculateCameraOptionsFromTo(E,i,h,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(h,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(E,i,h,g)}resize(E){var i;const h=this._containerDimensions(),g=h[0],v=h[1],T=this._getClampedPixelRatio(g,v);if(this._resizeCanvas(g,v,T),this.painter.resize(g,v,T),this.painter.overLimit()){const O=this.painter.context.gl;this._maxCanvasSize=[O.drawingBufferWidth,O.drawingBufferHeight];const U=this._getClampedPixelRatio(g,v);this._resizeCanvas(g,v,U),this.painter.resize(g,v,U)}this.transform.resize(g,v),(i=this._requestedCameraState)===null||i===void 0||i.resize(g,v);const z=!this._moving;return z&&(this.stop(),this.fire(new d.k("movestart",E)).fire(new d.k("move",E))),this.fire(new d.k("resize",E)),z&&this.fire(new d.k("moveend",E)),this}_getClampedPixelRatio(E,i){const{0:h,1:g}=this._maxCanvasSize,v=this.getPixelRatio(),T=E*v,z=i*v;return Math.min(T>h?h/T:1,z>g?g/z:1)*v}getPixelRatio(){var E;return(E=this._overridePixelRatio)!==null&&E!==void 0?E:devicePixelRatio}setPixelRatio(E){this._overridePixelRatio=E,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(E){return this.transform.setMaxBounds(it.convert(E)),this._update()}setMinZoom(E){if((E=E??-2)>=-2&&E<=this.transform.maxZoom)return this.transform.minZoom=E,this._update(),this.getZoom()<E&&this.setZoom(E),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(E){if((E=E??22)>=this.transform.minZoom)return this.transform.maxZoom=E,this._update(),this.getZoom()>E&&this.setZoom(E),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(E){if((E=E??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(E>=0&&E<=this.transform.maxPitch)return this.transform.minPitch=E,this._update(),this.getPitch()<E&&this.setPitch(E),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(E){if((E=E??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(E>=this.transform.minPitch)return this.transform.maxPitch=E,this._update(),this.getPitch()>E&&this.setPitch(E),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(E){return this.transform.renderWorldCopies=E,this._update()}project(E){return this.transform.locationPoint(d.N.convert(E),this.style&&this.terrain)}unproject(E){return this.transform.pointLocation(d.P.convert(E),this.terrain)}isMoving(){var E;return this._moving||((E=this.handlers)===null||E===void 0?void 0:E.isMoving())}isZooming(){var E;return this._zooming||((E=this.handlers)===null||E===void 0?void 0:E.isZooming())}isRotating(){var E;return this._rotating||((E=this.handlers)===null||E===void 0?void 0:E.isRotating())}_createDelegatedListener(E,i,h){if(E==="mouseenter"||E==="mouseover"){let g=!1;return{layers:i,listener:h,delegates:{mousemove:T=>{const z=i.filter((U=>this.getLayer(U))),O=z.length!==0?this.queryRenderedFeatures(T.point,{layers:z}):[];O.length?g||(g=!0,h.call(this,new Wn(E,this,T.originalEvent,{features:O}))):g=!1},mouseout:()=>{g=!1}}}}if(E==="mouseleave"||E==="mouseout"){let g=!1;return{layers:i,listener:h,delegates:{mousemove:z=>{const O=i.filter((U=>this.getLayer(U)));(O.length!==0?this.queryRenderedFeatures(z.point,{layers:O}):[]).length?g=!0:g&&(g=!1,h.call(this,new Wn(E,this,z.originalEvent)))},mouseout:z=>{g&&(g=!1,h.call(this,new Wn(E,this,z.originalEvent)))}}}}{const g=v=>{const T=i.filter((O=>this.getLayer(O))),z=T.length!==0?this.queryRenderedFeatures(v.point,{layers:T}):[];z.length&&(v.features=z,h.call(this,v),delete v.features)};return{layers:i,listener:h,delegates:{[E]:g}}}}_saveDelegatedListener(E,i){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[E]=this._delegatedListeners[E]||[],this._delegatedListeners[E].push(i)}_removeDelegatedListener(E,i,h){if(!this._delegatedListeners||!this._delegatedListeners[E])return;const g=this._delegatedListeners[E];for(let v=0;v<g.length;v++){const T=g[v];if(T.listener===h&&T.layers.length===i.length&&T.layers.every((z=>i.includes(z)))){for(const z in T.delegates)this.off(z,T.delegates[z]);return void g.splice(v,1)}}}on(E,i,h){if(h===void 0)return super.on(E,i);const g=this._createDelegatedListener(E,typeof i=="string"?[i]:i,h);this._saveDelegatedListener(E,g);for(const v in g.delegates)this.on(v,g.delegates[v]);return this}once(E,i,h){if(h===void 0)return super.once(E,i);const g=typeof i=="string"?[i]:i,v=this._createDelegatedListener(E,g,h);for(const T in v.delegates){const z=v.delegates[T];v.delegates[T]=(...O)=>{this._removeDelegatedListener(E,g,h),z(...O)}}this._saveDelegatedListener(E,v);for(const T in v.delegates)this.once(T,v.delegates[T]);return this}off(E,i,h){return h===void 0?super.off(E,i):(this._removeDelegatedListener(E,typeof i=="string"?[i]:i,h),this)}queryRenderedFeatures(E,i){if(!this.style)return[];let h;const g=E instanceof d.P||Array.isArray(E),v=g?E:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(g?{}:E)||{},v instanceof d.P||typeof v[0]=="number")h=[d.P.convert(v)];else{const T=d.P.convert(v[0]),z=d.P.convert(v[1]);h=[T,new d.P(z.x,T.y),z,new d.P(T.x,z.y),T]}return this.style.queryRenderedFeatures(h,i,this.transform)}querySourceFeatures(E,i){return this.style.querySourceFeatures(E,i)}setStyle(E,i){return(i=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&E?(this._diffStyle(E,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(E,i))}setTransformRequest(E){return this._requestManager.setTransformRequest(E),this}_getUIString(E){const i=this._locale[E];if(i==null)throw new Error(`Missing UI string '${E}'`);return i}_updateStyle(E,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(E,i)));const h=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!E)),E?(this.style=new Xo(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof E=="string"?this.style.loadURL(E,i,h):this.style.loadJSON(E,i,h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Xo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(E,i){if(typeof E=="string"){const h=this._requestManager.transformRequest(E,"Style");d.h(h,new AbortController).then((g=>{this._updateDiff(g.data,i)})).catch((g=>{g&&this.fire(new d.j(g))}))}else typeof E=="object"&&this._updateDiff(E,i)}_updateDiff(E,i){try{this.style.setState(E,i)&&this._update(!0)}catch(h){d.w(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(E,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(E,i){return this._lazyInitEmptyStyle(),this.style.addSource(E,i),this._update(!0)}isSourceLoaded(E){const i=this.style&&this.style.sourceCaches[E];if(i!==void 0)return i.loaded();this.fire(new d.j(new Error(`There is no source with ID '${E}'`)))}setTerrain(E){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),E){const i=this.style.sourceCaches[E.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${E.source}`);this.terrain===null&&i.reload();for(const h in this.style._layers){const g=this.style._layers[h];g.type==="hillshade"&&g.source===E.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new _l(this.painter,i,E),this.painter.renderToTexture=new Ha(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=h=>{h.dataType==="style"?this.terrain.sourceCache.freeRtt():h.dataType==="source"&&h.tile&&(h.sourceId!==E.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(h.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new d.k("terrain",{terrain:E})),this}getTerrain(){var E,i;return(i=(E=this.terrain)===null||E===void 0?void 0:E.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const E=this.style&&this.style.sourceCaches;for(const i in E){const h=E[i]._tiles;for(const g in h){const v=h[g];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(E){return this.style.removeSource(E),this._update(!0)}getSource(E){return this.style.getSource(E)}addImage(E,i,h={}){const{pixelRatio:g=1,sdf:v=!1,stretchX:T,stretchY:z,content:O,textFitWidth:U,textFitHeight:H}=h;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||d.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:X,height:K,data:ae}=i,fe=i;return this.style.addImage(E,{data:new d.R({width:X,height:K},new Uint8Array(ae)),pixelRatio:g,stretchX:T,stretchY:z,content:O,textFitWidth:U,textFitHeight:H,sdf:v,version:0,userImage:fe}),fe.onAdd&&fe.onAdd(this,E),this}}{const{width:X,height:K,data:ae}=N.getImageData(i);this.style.addImage(E,{data:new d.R({width:X,height:K},ae),pixelRatio:g,stretchX:T,stretchY:z,content:O,textFitWidth:U,textFitHeight:H,sdf:v,version:0})}}updateImage(E,i){const h=this.style.getImage(E);if(!h)return this.fire(new d.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=i instanceof HTMLImageElement||d.b(i)?N.getImageData(i):i,{width:v,height:T,data:z}=g;if(v===void 0||T===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==h.data.width||T!==h.data.height)return this.fire(new d.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const O=!(i instanceof HTMLImageElement||d.b(i));return h.data.replace(z,O),this.style.updateImage(E,h),this}getImage(E){return this.style.getImage(E)}hasImage(E){return E?!!this.style.getImage(E):(this.fire(new d.j(new Error("Missing required image id"))),!1)}removeImage(E){this.style.removeImage(E)}loadImage(E){return le.getImage(this._requestManager.transformRequest(E,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(E,i){return this._lazyInitEmptyStyle(),this.style.addLayer(E,i),this._update(!0)}moveLayer(E,i){return this.style.moveLayer(E,i),this._update(!0)}removeLayer(E){return this.style.removeLayer(E),this._update(!0)}getLayer(E){return this.style.getLayer(E)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(E,i,h){return this.style.setLayerZoomRange(E,i,h),this._update(!0)}setFilter(E,i,h={}){return this.style.setFilter(E,i,h),this._update(!0)}getFilter(E){return this.style.getFilter(E)}setPaintProperty(E,i,h,g={}){return this.style.setPaintProperty(E,i,h,g),this._update(!0)}getPaintProperty(E,i){return this.style.getPaintProperty(E,i)}setLayoutProperty(E,i,h,g={}){return this.style.setLayoutProperty(E,i,h,g),this._update(!0)}getLayoutProperty(E,i){return this.style.getLayoutProperty(E,i)}setGlyphs(E,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(E,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(E,i,h={}){return this._lazyInitEmptyStyle(),this.style.addSprite(E,i,h,(g=>{g||this._update(!0)})),this}removeSprite(E){return this._lazyInitEmptyStyle(),this.style.removeSprite(E),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(E,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(E,i,(h=>{h||this._update(!0)})),this}setLight(E,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(E,i),this._update(!0)}getLight(){return this.style.getLight()}setSky(E){return this._lazyInitEmptyStyle(),this.style.setSky(E),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(E,i){return this.style.setFeatureState(E,i),this._update()}removeFeatureState(E,i){return this.style.removeFeatureState(E,i),this._update()}getFeatureState(E){return this.style.getFeatureState(E)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let E=0,i=0;return this._container&&(E=this._container.clientWidth||400,i=this._container.clientHeight||300),[E,i]}_setupContainer(){const E=this._container;E.classList.add("maplibregl-map");const i=this._canvasContainer=V.create("div","maplibregl-canvas-container",E);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const h=this._containerDimensions(),g=this._getClampedPixelRatio(h[0],h[1]);this._resizeCanvas(h[0],h[1],g);const v=this._controlContainer=V.create("div","maplibregl-control-container",E),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((z=>{T[z]=V.create("div",`maplibregl-ctrl-${z} `,v)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(E,i,h){this._canvas.width=Math.floor(h*E),this._canvas.height=Math.floor(h*i),this._canvas.style.width=`${E}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const E={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let i=null;this._canvas.addEventListener("webglcontextcreationerror",(g=>{i={requestedAttributes:E},g&&(i.statusMessage=g.statusMessage,i.type=g.type)}),{once:!0});const h=this._canvas.getContext("webgl2",E)||this._canvas.getContext("webgl",E);if(!h){const g="Failed to initialize WebGL";throw i?(i.message=g,new Error(JSON.stringify(i))):new Error(g)}this.painter=new mo(h,this.transform),Q.testSupport(h)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(E){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||E,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(E){return this._update(),this._renderTaskQueue.add(E)}_cancelRenderFrame(E){this._renderTaskQueue.remove(E)}_render(E){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(E),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,T=N.now();this.style.zoomHistory.update(v,T);const z=new d.z(v,{now:T,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),O=z.crossFadingFactor();O===1&&O===this._crossFadingFactor||(h=!0,this._crossFadingFactor=O),this.style.update(z)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new d.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.bf.mark(d.bg.load),this.fire(new d.k("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.k("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,d.bf.mark(d.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var E;this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),le.removeThrottleControl(this._imageQueueHandle),(E=this._resizeObserver)===null||E===void 0||E.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i?.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),d.bf.clearMetrics(),this._removed=!0,this.fire(new d.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then((E=>{d.bf.frame(E),this._frameRequest=null,this._render(E)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(E){this._showTileBoundaries!==E&&(this._showTileBoundaries=E,this._update())}get showPadding(){return!!this._showPadding}set showPadding(E){this._showPadding!==E&&(this._showPadding=E,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(E){this._showCollisionBoxes!==E&&(this._showCollisionBoxes=E,E?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(E){this._showOverdrawInspector!==E&&(this._showOverdrawInspector=E,this._update())}get repaint(){return!!this._repaint}set repaint(E){this._repaint!==E&&(this._repaint=E,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(E){this._vertices=E,this._update()}get version(){return $o}getCameraTargetElevation(){return this.transform.elevation}},y.MapMouseEvent=Wn,y.MapTouchEvent=Ca,y.MapWheelEvent=Gr,y.Marker=ch,y.NavigationControl=class{constructor(E){this._updateZoomButtons=()=>{const i=this._map.getZoom(),h=i===this._map.getMaxZoom(),g=i===this._map.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,h)=>{const g=this._map._getUIString(`NavigationControl.${h}`);i.title=g,i.setAttribute("aria-label",g)},this.options=d.e({},Hc,E),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(i=>this._map.zoomIn({},{originalEvent:i}))),V.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(i=>this._map.zoomOut({},{originalEvent:i}))),V.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})})),this._compassIcon=V.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(E,i){const h=V.create("button",E,this._container);return h.type="button",h.addEventListener("click",i),h}},y.Popup=class extends d.E{constructor(E){super(),this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.k("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{var h;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create("div","maplibregl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const O of this.options.className.split(" "))this._container.classList.add(O);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Ji(this._lngLat,this._flatPos,this._map.transform):(h=this._lngLat)===null||h===void 0?void 0:h.wrap(),this._trackPointer&&!i)return;const g=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationPoint(this._lngLat));let v=this.options.anchor;const T=wl(this.options.offset);if(!v){const O=this._container.offsetWidth,U=this._container.offsetHeight;let H;H=g.y+T.bottom.y<U?["top"]:g.y>this._map.transform.height-U?["bottom"]:[],g.x<O/2?H.push("left"):g.x>this._map.transform.width-O/2&&H.push("right"),v=H.length===0?"bottom":H.join("-")}let z=g.add(T[v]);this.options.subpixelPositioning||(z=z.round()),V.setTransform(this._container,`${vl[v]} translate(${z.x}px,${z.y}px)`),Mu(this._container,v,"popup")},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(bi),E)}addTo(E){return this._map&&this.remove(),this._map=E,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(E){return this._lngLat=d.N.convert(E),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(E){return this.setDOMContent(document.createTextNode(E))}setHTML(E){const i=document.createDocumentFragment(),h=document.createElement("body");let g;for(h.innerHTML=E;g=h.firstChild,g;)i.appendChild(g);return this.setDOMContent(i)}getMaxWidth(){var E;return(E=this._container)===null||E===void 0?void 0:E.style.maxWidth}setMaxWidth(E){return this.options.maxWidth=E,this._update(),this}setDOMContent(E){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(E),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(E){return this._container&&this._container.classList.add(E),this}removeClassName(E){return this._container&&this._container.classList.remove(E),this}setOffset(E){return this.options.offset=E,this._update(),this}toggleClassName(E){if(this._container)return this._container.classList.toggle(E)}setSubpixelPositioning(E){this.options.subpixelPositioning=E}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const E=this._container.querySelector(bl);E&&E.focus()}},y.RasterDEMTileSource=mi,y.RasterTileSource=Si,y.ScaleControl=class{constructor(E){this._onMove=()=>{xl(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,xl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Za),E)}getDefaultPosition(){return"bottom-left"}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=wt,y.Style=Xo,y.TerrainControl=class{constructor(E){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=E}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=Z,y.TwoFingersTouchRotateHandler=M,y.TwoFingersTouchZoomHandler=u,y.TwoFingersTouchZoomRotateHandler=Tr,y.VectorTileSource=Mn,y.VideoSource=sn,y.addSourceType=(E,i)=>d._(void 0,void 0,void 0,(function*(){if(ns(E))throw new Error(`A source type called "${E}" already exists.`);((h,g)=>{Gi[h]=g})(E,i)})),y.clearPrewarmedResources=function(){const E=Ot;E&&(E.isPreloaded()&&E.numActive()===1?(E.release(rt),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return bn().getRTLTextPluginStatus()},y.getVersion=function(){return ed},y.getWorkerCount=function(){return gt.workerCount},y.getWorkerUrl=function(){return d.a.WORKER_URL},y.importScriptInWorkers=function(E){return pi().broadcast("IS",E)},y.prewarm=function(){gi().acquire(rt)},y.setMaxParallelImageRequests=function(E){d.a.MAX_PARALLEL_IMAGE_REQUESTS=E},y.setRTLTextPlugin=function(E,i){return bn().setRTLTextPlugin(E,i)},y.setWorkerCount=function(E){gt.workerCount=E},y.setWorkerUrl=function(E){d.a.WORKER_URL=E}}));var _=r;return _}))})(Py)),Py.exports}var Fz=s2();const uw=Xh(Fz);var jy={exports:{}},Vz=jy.exports,hw;function qz(){return hw||(hw=1,(function(t,e){(function(r,l){t.exports=l(JS(),s2())})(typeof globalThis<"u"?globalThis:Vz||self,function(r,l){r.MaplibreGL=r.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(f){r.setOptions(this,f),this._throttledUpdate=r.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(f){this._container||this._initContainer();var _=this.getPaneName();f.getPane(_).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),f.options.zoomAnimation&&r.DomEvent.on(f._proxy,r.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(f){this._map._proxy&&this._map.options.zoomAnimation&&r.DomEvent.off(this._map._proxy,r.DomUtil.TRANSITION_END,this._transitionEnd,this);var _=this.getPaneName();f.getPane(_).removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getAttribution:function(){if(this.options.attributionControl)return this.options.attributionControl.customAttribution;var f=this._glMap;if(f&&this.options.attributionControl!==!1){var _=f.getStyle();if(_&&_.sources)return Object.keys(_.sources).map(function(y){var d=f.getSource(y);return d&&typeof d.attribution=="string"?d.attribution.trim():null}).filter(Boolean).join(", ")}return""},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){var f=this.getSize().multiplyBy(.5),_=this._map.latLngToContainerPoint(this._map.getCenter());return r.latLngBounds(this._map.containerPointToLatLng(_.subtract(f)),this._map.containerPointToLatLng(_.add(f)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_roundPoint:function(f){return{x:Math.round(f.x),y:Math.round(f.y)}},_initContainer:function(){var f=this._container=r.DomUtil.create("div","leaflet-gl-layer");this._resizeContainer();var _=this._map.getSize().multiplyBy(this.options.padding),y=this._map.containerPointToLayerPoint([0,0]).subtract(_);r.DomUtil.setPosition(f,this._roundPoint(y))},_resizeContainer:function(){var f=this.getSize();this._container.style.width=f.x+"px",this._container.style.height=f.y+"px"},_initGL:function(){var f=this._map.getCenter(),_=r.extend({},this.options,{container:this._container,center:[f.lng,f.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new l.Map(_);var y=this._map,d=this.getAttribution(),A=this.getAttribution.bind(this);this._glMap.on("load",function(){y&&y.attributionControl&&(y.attributionControl.removeAttribution(d),y.attributionControl.addAttribution(A()))});var j=Object.getPrototypeOf(this._glMap.transform),B=Object.getOwnPropertyDescriptor(j,"latRange");(!B||B.set||B.writable)&&(this._glMap.transform.latRange=null);var N=Object.getOwnPropertyDescriptor(j,"maxValidLatitude");(!N||N.set||N.writable)&&(this._glMap.transform.maxValidLatitude=1/0),this._glMap.transform._helper&&this._glMap.transform._helper._latRange&&(this._glMap.transform._helper._latRange=[-1/0,1/0]),this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;var V=this._glMap._actualCanvas;r.DomUtil.addClass(V,"leaflet-image-layer"),r.DomUtil.addClass(V,"leaflet-zoom-animated"),this.options.interactive&&r.DomUtil.addClass(V,"leaflet-interactive"),this.options.className&&r.DomUtil.addClass(V,this.options.className)},_update:function(f){if(this._map&&(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming)){var _=this._container,y=this._glMap,d=this._map.getSize().multiplyBy(this.options.padding),A=this._map.containerPointToLayerPoint([0,0]).subtract(d);r.DomUtil.setPosition(_,this._roundPoint(A)),this._transformGL(y)}},_transformGL:function(f){var _=this._map.getCenter(),y=f._getTransformForUpdate();y.setCenter?(y.setCenter(l.LngLat.convert([_.lng,_.lat])),y.setZoom(this._map.getZoom()-1),f.transform.apply(y)):(y=f.transform,y.center=l.LngLat.convert([_.lng,_.lat]),y.zoom=this._map.getZoom()-1),f._fireMoveEvents()},_pinchZoom:function(f){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(f){var _=this._map.getZoomScale(f.zoom),y=this._map.getSize().multiplyBy(this.options.padding*_),d=this.getSize()._divideBy(2),A=this._map.project(f.center,f.zoom)._subtract(d)._add(this._map._getMapPanePos().add(y))._round(),j=this._map.project(this._map.getBounds().getNorthWest(),f.zoom)._subtract(A);r.DomUtil.setTransform(this._glMap._actualCanvas,j.subtract(this._offset),_)},_zoomStart:function(f){this._zooming=!0},_zoomEnd:function(){var f=this._map.getZoomScale(this._map.getZoom());r.DomUtil.setTransform(this._glMap._actualCanvas,null,f),this._zooming=!1,this._update()},_transitionEnd:function(f){r.Util.requestAnimFrame(function(){var _=this._map.getZoom(),y=this._map.getCenter(),d=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());this._resizeContainer(),r.DomUtil.setTransform(this._glMap._actualCanvas,d,1),this._glMap.once("moveend",r.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:y,zoom:_-1})},this)},_resize:function(f){this._transitionEnd(f)}}),r.maplibreGL=function(f){return new r.MaplibreGL(f)}})})(jy)),jy.exports}qz();const Hz={},Zz=Hz?.VITE_MAP_STYLE_URL||"https://tiles.openfreemap.org/styles/liberty/style.json",Gz="Leaflet | OpenFreeMap  OpenMapTiles Data from OpenStreetMap",Wz="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",Yz="&copy; OpenStreetMap contributors",r2=({styleUrl:t,attribution:e})=>{const r=gp();return ie.useEffect(()=>{const l=tf.maplibreGL;window.maplibregl=uw;let f=null,_=null,y=null;const d=()=>{_&&(r.removeLayer(_),_=null),!f&&(f=tf.tileLayer(Wz,{attribution:Yz}),f.addTo(r))};if(!l){console.warn("MapLibre GL Leaflet plugin is not available."),d();return}let A=null;try{_=l({style:t||Zz,attribution:e||Gz,maplibreGL:uw}),_.addTo(r),y=_.getMapboxMap?.()||_.getMaplibreMap?.(),y&&(r._maplibreMap=y),A=()=>y?.resize?.(),y?.on&&(y.on("error",d),y.on("load",A))}catch(j){console.warn("MapLibre GL failed, falling back to raster.",j),d()}return()=>{y?.off&&(y.off("error",d),A&&y.off("load",A)),_&&r.removeLayer(_),f&&r.removeLayer(f)}},[r,t,e]),null},Xz=({showUpcoming:t,showPast:e,filterToday:r,filterTomorrow:l,filterDate:f,filterNow:_,filterFree:y,showEvents:d,showVenues:A,onToggleUpcoming:j,onTogglePast:B,onToggleToday:N,onToggleTomorrow:V,onDateChange:Q,onToggleNow:ne,onToggleFree:J,onToggleEvents:ye,onToggleVenues:re,onOpenArtistSearch:ge,onOpenFilters:le})=>{const me="inline-flex items-center justify-center whitespace-nowrap rounded-xl bg-white/15 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] transition-colors hover:bg-white/20",be="text-white/85",ke="bg-white/20 text-app-accent";return S.jsxs("div",{className:"flex flex-wrap gap-2 overflow-x-auto pb-1",children:[S.jsx("button",{type:"button",className:`${me} ${d?ke:be}`,onClick:ye,children:"Events"}),S.jsx("button",{type:"button",className:`${me} ${A?ke:be}`,onClick:re,children:"Venues"}),S.jsx("button",{type:"button",className:`${me} ${t?ke:be}`,onClick:j,children:"Upcoming"}),S.jsx("button",{type:"button",className:`${me} ${e?ke:be}`,onClick:B,children:"Past"}),S.jsx("button",{type:"button",className:`${me} ${r?ke:be}`,onClick:N,children:"Today"}),S.jsx("button",{type:"button",className:`${me} ${l?ke:be}`,onClick:V,children:"Tomorrow"}),S.jsx("label",{className:"flex items-center",children:S.jsx("input",{type:"date",value:f,onChange:Me=>Q(Me.target.value),className:"rounded-xl bg-white/15 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/85 [color-scheme:dark]"})}),S.jsx("button",{type:"button",className:`${me} ${_?ke:be}`,onClick:ne,children:"Now"}),S.jsx("button",{type:"button",className:`${me} ${y?ke:be}`,onClick:J,children:"Free"}),S.jsx("button",{type:"button",className:`${me} ${be}`,onClick:ge,children:"Artist"}),S.jsx("button",{type:"button",className:`${me} ${be}`,onClick:le,children:"Filters"})]})},Kz=({isOpen:t,onDismiss:e,filterGenres:r,onGenresChange:l,priceMin:f,priceMax:_,onPriceMinChange:y,onPriceMaxChange:d,filterDayPart:A,onDayPartChange:j,filterBandOnly:B,onToggleBand:N,selectedArtists:V,onAddArtist:Q,onRemoveArtist:ne,autoFocusArtist:J=!1,filterGoing:ye,filterAttended:re,onToggleGoing:ge,onToggleAttended:le,onClear:me,disableAttendance:be})=>{const[ke,Me]=Nt.useState(""),[Ue,Fe]=Nt.useState([]),[He,lt]=Nt.useState(!1),Ye=Nt.useRef(null);Nt.useEffect(()=>{t&&J&&Ye.current&&Ye.current.focus()},[t,J]);const Mt=async()=>{const et=ke.trim();if(!et){Fe([]);return}try{lt(!0);const{data:Tt}=await Rt.from("artists").select("id, name, avatar_url, artist_type").ilike("name",`%${et}%`).order("name",{ascending:!0}).limit(6);Fe((Tt||[]).map(Be=>({id:Be.id,name:Be.name,avatar_url:Be.avatar_url??null})))}finally{lt(!1)}};return Nt.useEffect(()=>{if(!ke.trim()){Fe([]);return}const et=window.setTimeout(()=>Mt(),350);return()=>window.clearTimeout(et)},[ke]),S.jsx($m,{isOpen:t,onDidDismiss:e,children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Filters"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:e,children:"Close"})]}),S.jsxs("div",{className:"mt-6 space-y-6",children:[S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"When"}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsx("button",{type:"button",className:`bg-white/10 px-3 py-2 text-sm font-semibold ${A==="day"?"text-app-accent":"text-white/75"}`,onClick:()=>j(A==="day"?"":"day"),children:"Day"}),S.jsx("button",{type:"button",className:`bg-white/10 px-3 py-2 text-sm font-semibold ${A==="night"?"text-app-accent":"text-white/75"}`,onClick:()=>j(A==="night"?"":"night"),children:"Night"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsxs("label",{className:"flex items-center gap-2 text-sm text-white/80",children:[S.jsx("input",{type:"checkbox",checked:ye,onChange:et=>ge(et.target.checked),disabled:be,className:"accent-[#ff6b4a]"}),S.jsx("span",{children:"Going"})]}),S.jsxs("label",{className:"flex items-center gap-2 text-sm text-white/80",children:[S.jsx("input",{type:"checkbox",checked:re,onChange:et=>le(et.target.checked),disabled:be,className:"accent-[#ff6b4a]"}),S.jsx("span",{children:"Attended"})]})]})]}),S.jsxs("div",{className:"space-y-4 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Lineup"}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Genres (comma)"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:r,onChange:et=>l(et.target.value),placeholder:"Jazz, Rock"})]}),S.jsxs("label",{className:"flex items-center justify-between gap-3 text-sm text-white/80",children:[S.jsx("span",{className:"flex items-center gap-2",children:"Band only"}),S.jsxs("span",{className:"relative inline-flex h-6 w-11 items-center",children:[S.jsx("input",{type:"checkbox",className:"peer sr-only",checked:B,onChange:et=>N(et.target.checked)}),S.jsx("span",{className:"h-full w-full rounded-full bg-white/10 transition peer-checked:bg-[#ff6b4a]/80"}),S.jsx("span",{className:"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("input",{className:"flex-1 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/40 focus:outline-none",value:ke,onChange:et=>Me(et.target.value),ref:Ye,placeholder:"Search artist",onKeyDown:et=>{et.key==="Enter"&&(et.preventDefault(),Mt())}}),S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] text-white",onClick:Mt,disabled:He,children:He?"Searching":"Search"})]}),Ue.length>0&&S.jsxs("div",{className:"bg-white/5 p-3 text-sm text-white",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Results"}),S.jsx("div",{className:"mt-2 space-y-2",children:Ue.map(et=>S.jsxs("button",{type:"button",className:"flex w-full items-center gap-3 bg-white/5 px-3 py-2 text-left hover:bg-white/10",onClick:()=>{Q(et),Me(""),Fe([])},children:[S.jsx("div",{className:"h-8 w-8 overflow-hidden rounded-full bg-white/10",children:et.avatar_url?S.jsx("img",{src:et.avatar_url,alt:et.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-full w-full items-center justify-center text-[10px] text-white/60",children:"A"})}),S.jsx("span",{children:et.name})]},et.id))})]}),V.length>0&&S.jsxs("div",{className:"bg-white/5 p-3 text-sm text-white",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Active"}),S.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:V.map(et=>S.jsxs("span",{className:"inline-flex items-center gap-2 bg-white/10 px-3 py-1 text-xs",children:[et.name,S.jsx("button",{type:"button",className:"text-white/70 hover:text-white",onClick:()=>ne(et.id),children:""})]},et.id))})]})]})]}),S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Price"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Min"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:f,onChange:et=>y(et.target.value),placeholder:"0"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Max"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:_,onChange:et=>d(et.target.value),placeholder:"50"})]})]})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:me,children:"Clear filters"})]})]})})})},xy=t=>{if(typeof t=="string"){const e=Number(t);return Number.isNaN(e)?null:e}return t},dw=(t,e,r,l=!1)=>{const f=r?encodeURI(r).replace(/'/g,"%27"):"",_=r?`<div class="map-pin-avatar" style="background-image:url('${f}')"></div>`:'<div class="map-pin-avatar map-pin-avatar--empty"></div>',y=`
    <div class="map-pin map-pin--${t} ${l?"map-pin--active":""}" style="pointer-events:auto;">
      ${_}
      <span class="map-pin-label">${e}</span>
    </div>
  `;return tf.divIcon({className:"leaflet-div-icon leaflet-interactive map-pin-wrapper",html:y,iconSize:l?[56,64]:[52,60],iconAnchor:[26,60],popupAnchor:[0,-54],interactive:!0})},Jz=t=>t.event_artists?.find(e=>e.artist?.avatar_url)?.artist?.avatar_url||null,Qz=({events:t,venues:e,showVenues:r,onSelectEvent:l,onSelectVenue:f,activeSelection:_})=>S.jsxs(S.Fragment,{children:[t.map(y=>{const d=xy(y.latitude??y.venue_place?.latitude??null),A=xy(y.longitude??y.venue_place?.longitude??null);if(d===null||A===null)return null;const j=Jz(y),B=y.is_free!==!1,N=B?"GRATIS":"PAGO",V=_?.type==="event"&&_.id===y.id,Q=dw(B?"free":"paid",N,j,V);return S.jsx(i_,{position:[d,A],icon:Q,pane:"markerPane",interactive:!0,bubblingMouseEvents:!1,zIndexOffset:V?200:0,eventHandlers:{click:()=>l(y.id)}},y.id)}),r&&e.map(y=>{const d=xy(y.latitude??null),A=xy(y.longitude??null);if(d===null||A===null)return null;const j=y.photos?.[0]||null,B=_?.type==="venue"&&_.id===y.id,N=dw("venue","SALA",j,B);return S.jsx(i_,{position:[d,A],icon:N,pane:"markerPane",interactive:!0,bubblingMouseEvents:!1,zIndexOffset:B?200:0,eventHandlers:{click:()=>f(y.id)}},y.id)})]}),eR=({activeItem:t,events:e,venues:r,onClose:l,onPrev:f,onNext:_,onTouchStart:y,onTouchEnd:d})=>{if(!t)return null;const A=()=>{if(t.type==="event"){const B=e.find(V=>V.id===t.id);if(!B)return null;const N=(B.event_artists||[]).map(V=>V.artist?.name).filter(Boolean).join(", ");return S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Event"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:B.name}),S.jsx("p",{className:"text-sm text-white/70",children:B.venue_place?.city||B.city}),N&&S.jsx("p",{className:"mt-1 text-sm text-white/55",children:N}),S.jsx("p",{className:"mt-2 text-sm text-white/55",children:new Date(B.starts_at).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})}const j=r.find(B=>B.id===t.id);return j?S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venue"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:j.name}),S.jsx("p",{className:"text-sm text-white/70",children:j.city})]}):null};return S.jsxs("div",{className:"fixed inset-x-0 bottom-0 z-[1100] max-h-[60vh] bg-black/92 p-4",onTouchStart:y,onTouchEnd:d,children:[S.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[S.jsx("div",{className:"h-1 w-12 rounded-full bg-white/20"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:l,children:"Close"})]}),A(),S.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white",onClick:f,children:"Prev"}),S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white",onClick:_,children:"Next"})]})]})},tR=({events:t,venues:e,userId:r})=>{const[l,f]=ie.useState(""),[_,y]=ie.useState(!0),[d,A]=ie.useState(!0),[j,B]=ie.useState(!0),[N,V]=ie.useState(!0),[Q,ne]=ie.useState(!1),[J,ye]=ie.useState(!1),[re,ge]=ie.useState(""),[le,me]=ie.useState(!1),[be,ke]=ie.useState(!1),[Me,Ue]=ie.useState(""),[Fe,He]=ie.useState(""),[lt,Ye]=ie.useState(""),[Mt,et]=ie.useState(""),[Tt,Be]=ie.useState(!1),[ct,ut]=ie.useState([]),[Et,ot]=ie.useState(!1),[xe,Le]=ie.useState(!1),[tt,rt]=ie.useState({});ie.useEffect(()=>{if(!r||!Et&&!xe){rt({});return}(async()=>{const{data:zi}=await Rt.from("event_attendance").select("event_id, status").eq("user_id",r),gn={};(zi||[]).forEach(ln=>{ln?.event_id&&ln?.status&&(gn[ln.event_id]=ln.status)}),rt(gn)})()},[r,Et,xe]);const gt=ie.useMemo(()=>{if(!_)return[];const pi=l.trim().toLowerCase(),zi=new Date,gn=new Date(zi);gn.setHours(0,0,0,0);const ln=new Date(zi);ln.setHours(23,59,59,999);const $n=new Date(gn);$n.setDate($n.getDate()+1);const it=new Date($n);it.setHours(23,59,59,999);const Cn=Me.split(",").map(mi=>mi.trim().toLowerCase()).filter(Boolean),Mn=Fe.trim()?Number(Fe):null,Si=lt.trim()?Number(lt):null;return t.filter(mi=>{if(pi&&!(mi.name.toLowerCase().includes(pi)||mi.city.toLowerCase().includes(pi)||mi.venue_place?.name?.toLowerCase().includes(pi)||mi.venue_place?.city?.toLowerCase().includes(pi)||mi.address?.toLowerCase().includes(pi)))return!1;const En=new Date(mi.starts_at),Rn=mi.ends_at?new Date(mi.ends_at):null,sn=(Rn??En)<zi;if(!j&&!N||j!==N&&(N&&!sn||j&&sn)||Q&&(En<gn||En>ln)||J&&(En<$n||En>it))return!1;if(re){const Xi=new Date(`${re}T00:00:00`),Gi=new Date(Xi);if(Gi.setHours(23,59,59,999),En<Xi||En>Gi)return!1}if(le&&(En>zi||Rn&&Rn<zi)||be&&mi.is_free===!1)return!1;if(Mt){const Xi=En.getHours(),Gi=Xi>=6&&Xi<18;if(Mt==="day"&&!Gi||Mt==="night"&&Gi)return!1}if(Tt&&!(Array.isArray(mi.event_artists)&&mi.event_artists.some(Gi=>Gi?.artist?.artist_type==="band"))||ct.length>0&&!(Array.isArray(mi.event_artists)&&mi.event_artists.some(Gi=>Gi?.artist?.id&&ct.includes(Gi.artist.id))))return!1;if(Cn.length>0){const Xi=(mi.genres||[]).map(Gi=>Gi.toLowerCase());if(!Cn.some(Gi=>Xi.includes(Gi)))return!1}if(Mn!==null||Si!==null){const Gi=(mi.price_tiers||[]).map(yn=>Number(yn.price)).filter(yn=>Number.isFinite(yn)),ns=mi.is_free!==!1,kt=ns?0:Gi.length>0?Math.min(...Gi):null,Hn=ns?0:Gi.length>0?Math.max(...Gi):null;if(kt===null||Hn===null||Mn!==null&&Hn<Mn||Si!==null&&kt>Si)return!1}if(Et||xe){const Xi=tt[mi.id];return!!(Et&&Xi==="going"||xe&&Xi==="attended")}return!0})},[t,l,j,N,Q,J,re,le,be,Me,Fe,lt,Mt,Tt,ct,Et,xe,tt,_]),Pt=ie.useMemo(()=>{const pi=l.trim().toLowerCase();return pi?e.filter(zi=>zi.name.toLowerCase().includes(pi)||zi.city.toLowerCase().includes(pi)||zi.address?.toLowerCase().includes(pi)):e},[e,l]);return{search:l,setSearch:f,showEvents:_,setShowEvents:y,showVenues:d,setShowVenues:A,showUpcoming:j,setShowUpcoming:B,showPast:N,setShowPast:V,filterToday:Q,filterTomorrow:J,filterDate:re,filterNow:le,filterFree:be,filterGenres:Me,priceMin:Fe,priceMax:lt,filterDayPart:Mt,setFilterDayPart:et,filterBandOnly:Tt,setFilterBandOnly:Be,selectedArtistIds:ct,setSelectedArtistIds:ut,filterGoing:Et,filterAttended:xe,toggleToday:()=>{ne(pi=>{const zi=!pi;return zi&&(ye(!1),ge("")),zi})},toggleTomorrow:()=>{ye(pi=>{const zi=!pi;return zi&&(ne(!1),ge("")),zi})},setFilterDate:pi=>{ge(pi),pi&&(ne(!1),ye(!1))},setFilterNow:me,setFilterFree:ke,setFilterGenres:Ue,setPriceMin:He,setPriceMax:Ye,setFilterGoing:ot,setFilterAttended:Le,clearExtraFilters:()=>{Ue(""),He(""),Ye(""),et(""),Be(!1),ut([]),ot(!1),Le(!1)},filteredEvents:gt,filteredVenues:Pt}},fw=[37.3891,-5.9845],pw=12,a2="live_space.map.view",iR=()=>{if(typeof window>"u")return null;try{const t=window.localStorage.getItem(a2);if(!t)return null;const e=JSON.parse(t);if(!e?.center||typeof e.zoom!="number")return null;const[r,l]=e.center;return!Number.isFinite(r)||!Number.isFinite(l)?null:{center:e.center,zoom:e.zoom}}catch{return null}},nR=(t,e)=>{if(!(typeof window>"u"))try{window.localStorage.setItem(a2,JSON.stringify({center:t,zoom:e}))}catch{}},sR=()=>{Ur();const t=mp(),{user:e}=va(),[r,l]=ie.useState([]),[f,_]=ie.useState([]),[y,d]=ie.useState([]),[A,j]=ie.useState(!1),[B,N]=ie.useState(null),[V,Q]=ie.useState([]),ne=B!==null?V[B]:null,[J,ye]=ie.useState(fw),[re,ge]=ie.useState(pw),[le,me]=ie.useState(!1),[be,ke]=ie.useState(!1),[Me,Ue]=ie.useState(null),Fe=ie.useRef(null),[He,lt]=ie.useState(!1),[Ye,Mt]=ie.useState(null),{search:et,setSearch:Tt,showEvents:Be,setShowEvents:ct,showVenues:ut,setShowVenues:Et,showUpcoming:ot,setShowUpcoming:xe,showPast:Le,setShowPast:tt,filterToday:rt,filterTomorrow:gt,filterDate:Pt,filterNow:Ot,filterFree:ei,filterGenres:gi,priceMin:Vi,priceMax:pi,filterDayPart:zi,setFilterDayPart:gn,filterBandOnly:ln,setFilterBandOnly:$n,selectedArtistIds:it,setSelectedArtistIds:Cn,filterGoing:Mn,filterAttended:Si,toggleToday:mi,toggleTomorrow:En,setFilterDate:Rn,setFilterNow:is,setFilterFree:sn,setFilterGenres:Xi,setPriceMin:Gi,setPriceMax:ns,setFilterGoing:kt,setFilterAttended:Hn,clearExtraFilters:yn,filteredEvents:bn,filteredVenues:Un}=tR({events:r,venues:f,userId:e?.id});ie.useEffect(()=>{tf.Icon.Default.mergeOptions({iconRetinaUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",import.meta.url).toString(),iconUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",import.meta.url).toString(),shadowUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",import.meta.url).toString()})},[]),ie.useEffect(()=>{const G=iR();if(G){ye(G.center),ge(G.zoom),me(!0);return}ye(fw),ge(pw),me(!0)},[]);const jt=ie.useCallback(async()=>{const{data:G}=await Rt.from("events").select(`
        *,
        venue_place:venue_places!events_venue_place_id_fkey (
          id,
          name,
          city,
          address,
          latitude,
          longitude,
          photos
        ),
        event_artists (
          artist:artists!event_artists_artist_entity_fk (
            id,
            name,
            avatar_url,
            artist_type
          )
        )
        `);l(G||[])},[]),ii=ie.useCallback(async()=>{const{data:G}=await Rt.from("venue_places").select("id, name, city, address, latitude, longitude, photos, venue_type, capacity");_(G||[])},[]);ie.useEffect(()=>{jt(),ii()},[jt,ii]),ie.useEffect(()=>{r.length===0&&jt()},[r.length,jt]),ie.useEffect(()=>{f.length===0&&ii()},[f.length,ii]),ie.useEffect(()=>{!navigator.geolocation||be||!le||(ke(!0),navigator.geolocation.getCurrentPosition(G=>{ye([G.coords.latitude,G.coords.longitude])},()=>{},{enableHighAccuracy:!0,timeout:5e3}))},[le,be]),ie.useEffect(()=>{const G=t.state?.artistFilter;G?.id&&Ye!==G.id&&(d([G]),Cn([G.id]),ct(!0),Et(!1),Mt(G.id))},[t.state,Ye,Cn,ct,Et]);const Xt=G=>{if(G.type==="event"){const ze=bn.find(Ge=>Ge.id===G.id);if(!ze)return null;const Ve=Number(ze.latitude??ze.venue_place?.latitude??null),he=Number(ze.longitude??ze.venue_place?.longitude??null);return!Number.isFinite(Ve)||!Number.isFinite(he)?null:[Ve,he]}const oe=Un.find(ze=>ze.id===G.id);if(!oe)return null;const ve=Number(oe.latitude??null),je=Number(oe.longitude??null);return!Number.isFinite(ve)||!Number.isFinite(je)?null:[ve,je]};ie.useEffect(()=>{if(!Me)return;Me.invalidateSize();const G=()=>{const oe=Me.getCenter(),ve=Me.getZoom(),je=[oe.lat,oe.lng];ye(je),ge(ve),nR(je,ve)};return Me.on("moveend",G),Me.on("zoomend",G),()=>{Me.off("moveend",G),Me.off("zoomend",G)}},[Me]),ie.useEffect(()=>{if(!Me)return;const G=Me.getCenter(),oe=Me.getZoom(),[ve,je]=J,ze=Math.abs(G.lat-ve),Ve=Math.abs(G.lng-je);oe===re&&ze<1e-7&&Ve<1e-7||Me.setView(J,re,{animate:!0})},[J,re,Me]),vM(()=>{Me&&window.setTimeout(()=>{Me.invalidateSize()},150)});const Wi=G=>{if(!Me)return;const oe=Xt(G);oe&&Me.setView(oe,Me.getZoom(),{animate:!0})},Dn=G=>{if(!Me)return;const oe=Xt(G);if(!oe)return;const ve=Me.getBounds();if(!ve.contains(oe))return;const je=[];Be&&bn.forEach(Ge=>{const at=Xt({type:"event",id:Ge.id});at&&ve.contains(at)&&je.push({type:"event",id:Ge.id})}),ut&&Un.forEach(Ge=>{const at=Xt({type:"venue",id:Ge.id});at&&ve.contains(at)&&je.push({type:"venue",id:Ge.id})});const ze=je.findIndex(Ge=>Ge.type===G.type&&Ge.id===G.id),Ve=ze===-1?[...je,G]:je,he=ze===-1?Ve.length-1:ze;Q(Ve),N(he),Wi(G)},hi=G=>{if(B===null||V.length===0)return;let oe=B+G;oe<0&&(oe=V.length-1),oe>=V.length&&(oe=0),N(oe),Wi(V[oe])},[xs,Pn]=ie.useState(null),Zn=G=>Pn(G.touches[0].clientX),rn=G=>{if(xs===null)return;const oe=G.changedTouches[0].clientX-xs;Math.abs(oe)>50&&hi(oe<0?1:-1),Pn(null)},we=()=>{d([]),Cn([]),Et(!0)},te=G=>{d(oe=>oe.filter(ve=>ve.id!==G)),Cn(oe=>{const ve=oe.filter(je=>je!==G);return ve.length===0&&Et(!0),ve})};return S.jsx(nr,{children:S.jsxs(vs,{fullscreen:!0,children:[S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsxs("div",{className:"relative flex min-h-full flex-col p-0",children:[S.jsx("div",{className:"pointer-events-auto absolute left-4 right-4 top-4 z-[1000]",children:S.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl bg-black/85 p-3",children:[S.jsx("input",{type:"search",placeholder:"Search shows",value:et,onChange:G=>Tt(G.target.value),className:"w-full rounded-xl bg-white/15 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"}),S.jsx(Xz,{showUpcoming:ot,showPast:Le,filterToday:rt,filterTomorrow:gt,filterDate:Pt,filterNow:Ot,filterFree:ei,showEvents:Be,showVenues:ut,onToggleUpcoming:()=>xe(G=>!G),onTogglePast:()=>tt(G=>!G),onToggleToday:mi,onToggleTomorrow:En,onDateChange:G=>{Rn(G),G&&is(!1)},onToggleNow:()=>is(G=>!G),onToggleFree:()=>sn(G=>!G),onToggleEvents:()=>ct(G=>!G),onToggleVenues:()=>Et(G=>!G),onOpenArtistSearch:()=>{j(!0),lt(!0)},onOpenFilters:()=>lt(!0)}),y.length>0&&S.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-xl bg-white/10 px-3 py-2 text-xs text-white",children:[S.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.22em] text-white/60",children:"Artist"}),y.map(G=>S.jsxs("button",{type:"button",onClick:()=>te(G.id),className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-3 py-1 text-xs font-semibold transition hover:bg-white/15",children:[S.jsx("span",{className:"h-6 w-6 overflow-hidden rounded-full bg-white/10",children:G.avatar_url?S.jsx("img",{src:G.avatar_url,alt:G.name,className:"h-full w-full object-cover"}):S.jsx("span",{className:"flex h-full w-full items-center justify-center text-[10px] text-white/70",children:G.name.charAt(0).toUpperCase()})}),G.name,S.jsx("span",{className:"text-white/60",children:""})]},G.id)),S.jsx("button",{type:"button",onClick:we,className:"ml-auto text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 transition hover:text-white",children:"Clear"})]})]})}),S.jsxs("div",{className:"relative",children:[it.length>0&&bn.length===0&&S.jsxs("div",{className:"pointer-events-auto absolute left-4 right-4 top-24 z-[1100] bg-black/80 px-4 py-3 text-center text-white",children:[S.jsx("p",{className:"text-sm font-semibold",children:"No shows to display for this artist"}),S.jsx("p",{className:"text-xs text-white/60",children:"Remove the artist filter to see all events on the map."}),S.jsx("div",{className:"mt-2 flex justify-center",children:S.jsx("button",{type:"button",onClick:we,className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white",children:"Clear artist filter"})})]}),S.jsxs(Xx,{center:J,zoom:re,style:{height:"calc(100vh - 60px)",width:"100%"},className:"rounded-none [&_.leaflet-container]:rounded-none [&_.leaflet-pane]:z-0 [&_.leaflet-marker-pane]:z-[500] [&_.leaflet-overlay-pane]:z-[400] [&_.leaflet-popup-pane]:z-[600]",zoomControl:!1,ref:Fe,whenReady:G=>Ue(G.target),preferCanvas:!1,children:[S.jsx(r2,{}),S.jsx(Kx,{}),S.jsx(Qz,{events:Be?bn:[],venues:Un,showVenues:ut,onSelectEvent:G=>Dn({type:"event",id:G}),onSelectVenue:G=>Dn({type:"venue",id:G}),activeSelection:B!==null?V[B]:null})]})]})]})]}),S.jsx(eR,{activeItem:ne,events:bn,venues:Un,onClose:()=>N(null),onPrev:()=>hi(-1),onNext:()=>hi(1),onTouchStart:Zn,onTouchEnd:rn}),S.jsx(Kz,{isOpen:He,onDismiss:()=>{lt(!1),j(!1)},filterGenres:gi,onGenresChange:Xi,priceMin:Vi,priceMax:pi,onPriceMinChange:Gi,onPriceMaxChange:ns,filterDayPart:zi,onDayPartChange:gn,filterBandOnly:ln,onToggleBand:$n,selectedArtists:y,onAddArtist:G=>{it.includes(G.id)||(d(oe=>[...oe,G]),Cn(oe=>[...oe,G.id]),$n(!1))},onRemoveArtist:G=>{d(oe=>oe.filter(ve=>ve.id!==G)),Cn(oe=>oe.filter(ve=>ve!==G))},autoFocusArtist:A,filterGoing:Mn,filterAttended:Si,onToggleGoing:kt,onToggleAttended:Hn,onClear:()=>{yn(),d([]),Cn([]),Et(!0)},disableAttendance:!e})]})})},rR=({value:t,placeholder:e,onChange:r,onClear:l})=>S.jsx("div",{className:"sticky top-0 z-20 -mx-4 bg-app-bg px-4 pb-3 pt-2",children:S.jsx("div",{className:"bg-white/5",children:S.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[S.jsx("input",{type:"search",value:t,placeholder:e||"Search artists or venues",onChange:f=>r(f.target.value),className:"w-full bg-transparent text-sm text-white placeholder:text-white/40 focus:outline-none"}),t.trim().length>0&&S.jsx("button",{type:"button",onClick:l,className:"shrink-0 px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",children:"Clear"})]})})}),aR=({value:t,onChange:e})=>S.jsxs("div",{className:"flex items-center gap-6",children:[S.jsx("button",{type:"button",onClick:()=>e("artists"),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t==="artists"?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:"Artists"}),S.jsx("button",{type:"button",onClick:()=>e("venues"),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t==="venues"?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:"Venues"})]}),by=({title:t,description:e,actionLabel:r,onAction:l})=>S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:t}),e&&S.jsx("p",{className:"mt-1 text-xs text-white/55",children:e}),r&&l&&S.jsx("button",{type:"button",className:"mt-4 bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:l,children:r})]}),oR=({rows:t=6})=>S.jsx("div",{className:"space-y-3",children:Array.from({length:t}).map((e,r)=>S.jsx("div",{className:"h-[74px] animate-pulse bg-white/5"},r))}),mw=({sections:t,renderItem:e})=>{const[r,l]=ie.useState(!1),f=ie.useMemo(()=>r?t:t.slice(0,2),[r,t]),_=Math.max(0,t.length-f.length);return S.jsxs("div",{className:"space-y-8",children:[f.map(y=>S.jsxs("section",{className:"space-y-3",children:[S.jsx("div",{className:"flex items-baseline justify-between gap-4",children:S.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:y.title})}),S.jsx("div",{className:"space-y-2",children:y.items.map(e)})]},y.key)),_>0&&S.jsxs("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",onClick:()=>l(!0),children:["Show ",_," more"]}),r&&t.length>2&&S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",onClick:()=>l(!1),children:"Show less"})]})},gw=({artist:t,isFollowing:e,followLoading:r,canFollow:l,onToggleFollow:f,onOpenProfile:_})=>S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:_,children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:t.avatar_url?S.jsx("img",{src:t.avatar_url,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:t.name}),S.jsx("p",{className:"mt-0.5 text-xs text-white/55 line-clamp-1",children:t.city||(t.genres?.length?t.genres.slice(0,2).join("  "):"Artist")})]})]}),S.jsx("button",{type:"button",disabled:!l||r,onClick:y=>{y.stopPropagation(),f()},className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${e?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:r?"Loading":e?"Following":"Follow"})]}),yw=({venue:t,isFollowing:e,followLoading:r,canFollow:l,onToggleFollow:f,onOpenProfile:_})=>{const y=t.photos?.[0]||null;return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:_,children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:y?S.jsx("img",{src:y,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:t.name}),S.jsx("p",{className:"mt-0.5 text-xs text-white/55 line-clamp-1",children:t.city})]})]}),S.jsx("button",{type:"button",disabled:!l||r,onClick:d=>{d.stopPropagation(),f()},className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${e?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:r?"Loading":e?"Following":"Follow"})]})},lR=(t,e)=>{const[r,l]=ie.useState(t);return ie.useEffect(()=>{const f=window.setTimeout(()=>l(t),e);return()=>window.clearTimeout(f)},[e,t]),r},cR=async(t,e=20)=>{const r=t.trim();return r?yr(`discover:artists:search:${r}:${e}`,async()=>{const{data:l,error:f}=await Rt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres").or(`name.ilike.%${r}%,city.ilike.%${r}%`).limit(e);if(f)throw f;return(l||[]).map(_=>({id:_.artist_id,subject_id:_.subject_id,name:_.name,avatar_url:_.avatar_url,city:_.city,genres:_.genres||[]}))},{ttlMs:1e4}):[]},uR=async(t,e=20)=>{const r=t.trim();return r?yr(`discover:venues:search:${r}:${e}`,async()=>{const{data:l,error:f}=await Rt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity").or(`name.ilike.%${r}%,city.ilike.%${r}%`).limit(e);if(f)throw f;return(l||[]).map(_=>({id:_.venue_place_id,subject_id:_.subject_id,name:_.name,city:_.city,address:_.address,photos:_.photos||[],venue_type:_.venue_type??null,capacity:_.capacity??null}))},{ttlMs:1e4}):[]},o2=async(t,e)=>yr(`events:list:${t}:${e}`,async()=>{const{data:r,error:l}=await Rt.from("events").select(`
          id,
          name,
          city,
          address,
          latitude,
          longitude,
          starts_at,
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url,
              city,
              genres
            )
          )
        `).gte("starts_at",t).lte("starts_at",e).order("starts_at",{ascending:!0});if(l)throw l;return r||[]},{ttlMs:1e4}),l2=10,hR=50,dR=()=>{const t=new Date,e=new Date(t);e.setHours(0,0,0,0);const r=new Date(e);r.setDate(r.getDate()+14),r.setHours(23,59,59,999);const l=new Date(e);return l.setDate(l.getDate()+7),l.setHours(23,59,59,999),{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}},c2=t=>({id:t.artist_id,subject_id:t.subject_id,name:t.name,avatar_url:t.avatar_url,city:t.city,genres:t.genres||[]}),_w=async t=>{if(t.length===0)return[];const e=Array.from(new Set(t)).sort(),r=e.join(","),l=await yr(`artists:by_ids:${r}`,async()=>{const{data:_,error:y}=await Rt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres").in("artist_id",e);if(y)throw y;return _||[]},{ttlMs:6e4}),f=new Map;for(const _ of l)f.set(_.artist_id,_);return t.map(_=>f.get(_)).filter(Boolean).map(c2)},vw=t=>{const e=new Map;for(const r of t)for(const l of r.event_artists||[]){const f=l.artist?.id;f&&e.set(f,(e.get(f)||0)+1)}return Array.from(e.entries()).sort((r,l)=>l[1]-r[1]).slice(0,l2).map(([r])=>r)},fR=async t=>{const{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}=dR(),f=await o2(e.toISOString(),r.toISOString()),_=[];if(t?.location){const N=[];for(const ne of f){const J=Hh(ne.latitude??ne.venue_place?.latitude??null),ye=Hh(ne.longitude??ne.venue_place?.longitude??null);J===null||ye===null||qx(t.location.lat,t.location.lng,J,ye)>hR||N.push(ne)}const V=vw(N),Q=await _w(V);Q.length>0&&_.push({key:"trending_near_you",title:"Trending near you",items:Q})}const y=f.filter(N=>{const V=new Date(N.starts_at);return V>=e&&V<=l}),d=vw(y),A=await _w(d);A.length>0&&_.push({key:"popular_this_week",title:"Popular this week",items:A});const j=await yr("discover:artists:recent",async()=>{const{data:N,error:V}=await Rt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres,updated_at").order("updated_at",{ascending:!1}).limit(l2);if(V)throw V;return(N||[]).map(c2)},{ttlMs:6e4});j.length>0&&_.push({key:"recently_active",title:"Recently active",items:j});const B=new Set;return _.map(N=>({...N,items:N.items.filter(V=>B.has(V.id)?!1:(B.add(V.id),!0))}))},u2=10,pR=50,mR=()=>{const t=new Date,e=new Date(t);e.setHours(0,0,0,0);const r=new Date(e);r.setDate(r.getDate()+14),r.setHours(23,59,59,999);const l=new Date(e);return l.setDate(l.getDate()+7),l.setHours(23,59,59,999),{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}},h2=t=>({id:t.venue_place_id,subject_id:t.subject_id,name:t.name,city:t.city,address:t.address,photos:t.photos||[],venue_type:t.venue_type??null,capacity:t.capacity??null}),xw=async t=>{if(t.length===0)return[];const e=Array.from(new Set(t)).sort(),r=e.join(","),l=await yr(`venues:by_place_ids:${r}`,async()=>{const{data:_,error:y}=await Rt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity").in("venue_place_id",e);if(y)throw y;return _||[]},{ttlMs:6e4}),f=new Map;for(const _ of l)f.set(_.venue_place_id,_);return t.map(_=>f.get(_)).filter(Boolean).map(h2)},bw=t=>{const e=new Map;for(const r of t){const l=r.venue_place?.id;l&&e.set(l,(e.get(l)||0)+1)}return Array.from(e.entries()).sort((r,l)=>l[1]-r[1]).slice(0,u2).map(([r])=>r)},gR=async t=>{const{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}=mR(),f=await o2(e.toISOString(),r.toISOString()),_=[];if(t?.location){const N=[];for(const ne of f){const J=Hh(ne.latitude??ne.venue_place?.latitude??null),ye=Hh(ne.longitude??ne.venue_place?.longitude??null);J===null||ye===null||qx(t.location.lat,t.location.lng,J,ye)>pR||N.push(ne)}const V=bw(N),Q=await xw(V);Q.length>0&&_.push({key:"venues_near_you",title:"Venues near you",items:Q})}const y=f.filter(N=>{const V=new Date(N.starts_at);return V>=e&&V<=l}),d=bw(y),A=await xw(d);A.length>0&&_.push({key:"popular_venues_this_week",title:"Popular venues this week",items:A});const j=await yr("discover:venues:recent",async()=>{const{data:N,error:V}=await Rt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity,created_at").order("created_at",{ascending:!1}).limit(u2);if(V)throw V;return(N||[]).map(h2)},{ttlMs:6e4});j.length>0&&_.push({key:"recently_added",title:"Recently added venues",items:j});const B=new Set;return _.map(N=>({...N,items:N.items.filter(V=>B.has(V.id)?!1:(B.add(V.id),!0))}))},wy={searchArtists:cR,searchVenues:uR,getSuggestedArtists:fR,getSuggestedVenues:gR},yR=()=>{const t=Ur(),e=mp().state,r=GS(),[l]=JM(),[f,_]=ie.useState("artists"),[y,d]=ie.useState(""),A=lR(y,350),{canFollow:j,isFollowing:B,isToggling:N,toggleFollowSubject:V}=WS(),[Q,ne]=ie.useState(!1),[J,ye]=ie.useState([]),[re,ge]=ie.useState([]),[le,me]=ie.useState([]),[be,ke]=ie.useState([]),Me=A.trim().length>0;ie.useEffect(()=>{e?.initialTab&&_(e.initialTab)},[]),ie.useEffect(()=>{let He=!1;return(async()=>{ne(!0);try{if(f==="artists")if(Me){const Ye=await wy.searchArtists(A);if(He)return;ye(Ye)}else{const Ye=await wy.getSuggestedArtists({location:r});if(He)return;me(Ye)}else if(Me){const Ye=await wy.searchVenues(A);if(He)return;ge(Ye)}else{const Ye=await wy.getSuggestedVenues({location:r});if(He)return;ke(Ye)}}catch{if(He)return;f==="artists"?(ye([]),me([])):(ge([]),ke([]))}finally{He||ne(!1)}})(),()=>{He=!0}},[A,Me,r,f]);const Ue=async He=>{const lt=await V(He);!lt.ok&&lt.reason==="network"&&l({message:"Couldn't follow. Try again.",duration:2e3,position:"top"})},Fe=ie.useMemo(()=>f==="artists"?"Follow the ones youve seen live.":"Follow the rooms you return to.",[f]);return S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("header",{className:"space-y-2",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Discover"}),S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:f==="artists"?"Artists":"Venues"}),S.jsx("p",{className:"text-sm text-white/55",children:Fe})]}),S.jsx(rR,{value:y,placeholder:"Search artists or venues",onChange:d,onClear:()=>d("")}),S.jsx(aR,{value:f,onChange:_}),Q&&S.jsx(oR,{rows:6}),!Q&&f==="artists"&&S.jsx(S.Fragment,{children:Me?J.length===0?S.jsx(by,{title:`No results for "${A.trim()}"`,description:"Try a different spelling or search by city.",actionLabel:"Clear search",onAction:()=>d("")}):S.jsx("div",{className:"space-y-3",children:J.map(He=>S.jsx(gw,{artist:He,canFollow:j,isFollowing:B(He.subject_id),followLoading:N(He.subject_id),onToggleFollow:()=>Ue(He.subject_id),onOpenProfile:()=>t.push(`/artist/${He.id}`)},He.id))}):le.length===0?S.jsx(by,{title:"No artist suggestions yet",description:"Search by name to find an artist."}):S.jsx(mw,{sections:le,renderItem:He=>S.jsx(gw,{artist:He,canFollow:j,isFollowing:B(He.subject_id),followLoading:N(He.subject_id),onToggleFollow:()=>Ue(He.subject_id),onOpenProfile:()=>t.push(`/artist/${He.id}`)},He.id)})}),!Q&&f==="venues"&&S.jsx(S.Fragment,{children:Me?re.length===0?S.jsx(by,{title:`No results for "${A.trim()}"`,description:"Try a different spelling or search by city.",actionLabel:"Clear search",onAction:()=>d("")}):S.jsx("div",{className:"space-y-3",children:re.map(He=>S.jsx(yw,{venue:He,canFollow:j,isFollowing:B(He.subject_id),followLoading:N(He.subject_id),onToggleFollow:()=>Ue(He.subject_id),onOpenProfile:()=>t.push(`/venue/${He.id}`)},He.id))}):be.length===0?S.jsx(by,{title:"No venue suggestions yet",description:"Search by name to find a venue."}):S.jsx(mw,{sections:be,renderItem:He=>S.jsx(yw,{venue:He,canFollow:j,isFollowing:B(He.subject_id),followLoading:N(He.subject_id),onToggleFollow:()=>Ue(He.subject_id),onOpenProfile:()=>t.push(`/venue/${He.id}`)},He.id)})})]})},_R=()=>S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsx(yR,{})]})})}),d2=(t,e,r)=>{const l=r?encodeURI(r).replace(/'/g,"%27"):"",f=r?`<div class="map-pin-avatar" style="background-image:url('${l}')"></div>`:'<div class="map-pin-avatar map-pin-avatar--empty"></div>',_=`
    <div class="map-pin map-pin--${t}">
      ${f}
      <span class="map-pin-label">${e}</span>
    </div>
  `;return tf.divIcon({className:"map-pin-wrapper",html:_,iconSize:[52,60],iconAnchor:[26,60],popupAnchor:[0,-54]})},vR=({center:t})=>{const e=gp();return ie.useEffect(()=>{t&&e.setView(t)},[t,e]),null},xR=({onChange:t})=>{const e=gp();return ie.useEffect(()=>{t(e.getBounds())},[e,t]),t2({moveend:()=>t(e.getBounds()),zoomend:()=>t(e.getBounds())}),null},bR=({enabled:t,onSelect:e})=>(t2({click:r=>{t&&e(r.latlng.lat,r.latlng.lng)}}),null),ww=[41.3874,2.1686],mv="createEvent:lastMapCenter",Sw=t=>{const e=t.getTimezoneOffset();return new Date(t.getTime()-e*6e4).toISOString().slice(0,16)},fu=t=>{if(t==null)return null;if(typeof t=="number")return Number.isNaN(t)?null:t;const e=Number(t);return Number.isNaN(e)?null:e},wR=t=>t.replace(/[^a-zA-Z0-9._-]/g,"-"),Em=async(t,e,r)=>{let l=null;const f=new Promise((_,y)=>{l=window.setTimeout(()=>{y(new Error(`${r} timed out. Please try again.`))},e)});try{return await Promise.race([t,f])}finally{l!==null&&window.clearTimeout(l)}},SR=({userId:t,profileRole:e,profileCity:r,defaultArtistId:l=null,defaultArtistName:f=null,initialCenter:_=null})=>{const[y,d]=ie.useState([]),[A,j]=ie.useState([]),[B,N]=ie.useState(!1),[V,Q]=ie.useState(!1),[ne,J]=ie.useState(!1),[ye,re]=ie.useState(""),[ge,le]=ie.useState(""),[me,be]=ie.useState(null),[ke,Me]=ie.useState("existing"),[Ue,Fe]=ie.useState(""),[He,lt]=ie.useState(r||""),[Ye,Mt]=ie.useState(""),[et,Tt]=ie.useState(""),[Be,ct]=ie.useState(""),[ut,Et]=ie.useState(""),[ot,xe]=ie.useState(Sw(new Date)),[Le,tt]=ie.useState(""),[rt,gt]=ie.useState(""),[Pt,Ot]=ie.useState(""),[ei,gi]=ie.useState(""),[Vi,pi]=ie.useState(null),[zi,gn]=ie.useState(null),[ln,$n]=ie.useState(""),[it,Cn]=ie.useState(!0),[Mn,Si]=ie.useState([]),[mi,En]=ie.useState(""),[Rn,is]=ie.useState(""),[sn,Xi]=ie.useState(l?[l]:[]),[Gi,ns]=ie.useState("existing"),[kt,Hn]=ie.useState(""),[yn,bn]=ie.useState(""),[Un,jt]=ie.useState(""),[ii,Xt]=ie.useState(null),Wi=()=>{if(typeof window>"u")return null;try{const Bt=window.localStorage.getItem(mv);if(!Bt)return null;const Ct=JSON.parse(Bt);if(Array.isArray(Ct)&&Ct.length===2&&Number.isFinite(Number(Ct[0]))&&Number.isFinite(Number(Ct[1])))return[Number(Ct[0]),Number(Ct[1])]}catch{return null}return null},Dn=ie.useMemo(()=>Wi(),[_]),hi=Dn||_||null,[xs,Pn]=ie.useState(hi||ww),[Zn,rn]=ie.useState(null);ie.useEffect(()=>{re(""),le(""),be(null),Me("existing"),Fe(""),lt(r||""),Mt(""),Tt(""),ct(""),Et(""),xe(Sw(new Date)),tt(""),gt(""),Ot(""),gi(""),pi(null),gn(null),$n(""),Cn(!0),Si([]),En(""),is(""),Xi(l?[l]:[]),jt(""),Xt(null),Pn(hi||ww)},[r,l,hi]),ie.useEffect(()=>{(async()=>{N(!0);const{data:Ct,error:ni}=await Rt.from("venue_places").select("id, name, city, address, latitude, longitude, website_url, photos").order("name",{ascending:!0});ni?(re("Unable to load venues."),d([])):d(Ct||[]),N(!1)})()},[]),ie.useEffect(()=>{const Bt=Un.trim();if(Xt(null),!Bt){j(l?[{id:l,display_name:f||"Your artist profile",username:null,role:"artist"}]:[]),Q(!1);return}let Ct=!1;const ni=window.setTimeout(async()=>{Q(!0);const yi=Rt.from("artists").select("id, name, avatar_url").order("name",{ascending:!0}),{data:Ri,error:_t}=await yi.ilike("name",`%${Bt}%`);if(!Ct){if(_t)re("Unable to load artists."),j([]),Xt(0);else{const xt=(Ri||[]).map(Ne=>({id:Ne.id,display_name:Ne.name,username:null,role:"artist",avatar_url:Ne.avatar_url??null}));Xt(xt.length);const Gt=l?xt.some(Ne=>Ne.id===l):!1,fi=l&&!Gt?[{id:l,display_name:f||"Your artist profile",username:null,role:"artist"},...xt]:xt;j(fi)}Q(!1)}},700);return()=>{Ct=!0,window.clearTimeout(ni)}},[Un,l,f]),ie.useEffect(()=>{l&&sn.length===0&&Xi([l])},[l,sn.length]);const we=ie.useCallback(Bt=>{Pn(Bt),typeof window<"u"&&window.localStorage.setItem(mv,JSON.stringify(Bt))},[]),te=ie.useCallback(Bt=>{typeof window<"u"&&window.localStorage.setItem(mv,JSON.stringify(Bt))},[]);ie.useEffect(()=>{_&&!Dn&&we(_)},[_,Dn,we]),ie.useEffect(()=>{hi||navigator.geolocation&&navigator.geolocation.getCurrentPosition(Bt=>{we([Bt.coords.latitude,Bt.coords.longitude])},()=>{},{enableHighAccuracy:!0,timeout:5e3})},[hi,we]),ie.useEffect(()=>{if(!Vi){gn(null);return}const Bt=URL.createObjectURL(Vi);return gn(Bt),()=>URL.revokeObjectURL(Bt)},[Vi]);const G=ie.useMemo(()=>{const Bt=ge.trim().toLowerCase();return Bt?y.filter(Ct=>Ct.name.toLowerCase().includes(Bt)||Ct.city.toLowerCase().includes(Bt)||Ct.address?.toLowerCase().includes(Bt)):y},[y,ge]),oe=ie.useMemo(()=>Zn?G.filter(Bt=>{const Ct=fu(Bt.latitude),ni=fu(Bt.longitude);return Ct===null||ni===null?!1:Zn.contains(tf.latLng(Ct,ni))}):G,[G,Zn]),ve=ie.useMemo(()=>oe.map(Bt=>{const Ct=fu(Bt.latitude),ni=fu(Bt.longitude);return Ct===null||ni===null?null:{venue:Bt,position:[Ct,ni],icon:d2("venue","SALA",Bt.photos?.[0]||null)}}).filter(Boolean),[oe]),je=ie.useCallback(Bt=>{rn(Bt);const Ct=Bt.getCenter();Ct&&Number.isFinite(Ct.lat)&&Number.isFinite(Ct.lng)&&te([Ct.lat,Ct.lng])},[te]),ze=ie.useCallback(Bt=>{be(Bt),Me("existing");const Ct=fu(Bt.latitude),ni=fu(Bt.longitude);Ct!==null&&ni!==null&&we([Ct,ni])},[we]),Ve=ie.useCallback((Bt,Ct)=>{Me("new"),be(null),Tt(Bt.toFixed(6)),ct(Ct.toFixed(6)),we([Bt,Ct])},[we]),he=ke==="existing"?me?.city||"":He.trim(),Ge=ke==="existing"?me?.address||"":Ye.trim(),at=fu(ke==="existing"?me?.latitude:et),Ke=fu(ke==="existing"?me?.longitude:Be);return{artists:A,artistsLoading:V,venuesLoading:B,error:ye,saving:ne,venueSearch:ge,venueMode:ke,selectedVenue:me,newVenueName:Ue,newVenueCity:He,newVenueAddress:Ye,newVenueLat:et,newVenueLng:Be,eventName:ut,eventStart:ot,eventEnd:Le,eventDescription:rt,eventUrl:Pt,eventCoverUrl:ei,posterFile:Vi,posterPreview:zi,eventGenres:ln,isFree:it,priceTiers:Mn,tierLabel:mi,tierPrice:Rn,selectedArtistIds:sn,artistMode:Gi,newArtistName:kt,newArtistUsername:yn,artistSearch:Un,artistSearchCount:ii,mapCenter:xs,mapBounds:Zn,visibleVenues:oe,venueMarkers:ve,venueLat:at,venueLng:Ke,setVenueSearch:le,setVenueMode:Me,setSelectedVenue:be,setNewVenueName:Fe,setNewVenueCity:lt,setNewVenueAddress:Mt,setNewVenueLat:Tt,setNewVenueLng:ct,setEventName:Et,setEventStart:xe,setEventEnd:tt,setEventDescription:gt,setEventUrl:Ot,setEventCoverUrl:gi,setPosterFile:pi,setEventGenres:$n,setIsFree:Cn,setTierLabel:En,setTierPrice:is,setSelectedArtistIds:Xi,setArtistMode:ns,setNewArtistName:Hn,setNewArtistUsername:bn,setArtistSearch:jt,setError:re,handleBoundsChange:je,addPriceTier:()=>{re("");const Bt=mi.trim(),Ct=Number(Rn);if(!Bt){re("Price tier name is required.");return}if(!Number.isFinite(Ct)||Ct<0){re("Enter a valid price.");return}Si(ni=>[...ni,{label:Bt,price:Ct}]),En(""),is("")},removePriceTier:Bt=>{Si(Ct=>Ct.filter((ni,yi)=>yi!==Bt))},selectVenue:ze,handleMapSelect:Ve,handleCreate:async()=>{if(!t)return re("Sign in to create events."),null;if(!ut.trim())return re("Event name is required."),null;if(!ot)return re("Start time is required."),null;if(!it&&Mn.length===0)return re("Add at least one price tier."),null;if(ke==="existing"&&!me)return re("Select a venue place."),null;if(ke==="new"){if(!Ue.trim())return re("Venue name is required."),null;if(!He.trim())return re("Venue city is required."),null;if(at===null||Ke===null)return re("Select a location on the map."),null}const Bt=l&&e==="artist"?[l]:[],Ct=sn.length>0?sn:Bt;if(Ct.length===0)return re("Select at least one artist."),null;const ni=new Date(ot);if(Number.isNaN(ni.getTime()))return re("Invalid start time."),null;let yi=null;if(Le){const Ri=new Date(Le);if(Number.isNaN(Ri.getTime()))return re("Invalid end time."),null;if(Ri<ni)return re("End time must be after the start time."),null;yi=Ri.toISOString()}J(!0),re("");try{let Ri=ei.trim()||null,_t=me?.id||null;if(Vi){const Ne=wR(Vi.name||"poster"),zt=`event-posters/${t}/${Date.now()}-${Ne}`,{error:Kt}=await Em(Rt.storage.from("media").upload(zt,Vi,{cacheControl:"3600",upsert:!1,contentType:Vi.type||"image/*"}),45e3,"Poster upload");if(Kt)throw Kt;const{data:Zi}=Rt.storage.from("media").getPublicUrl(zt);Ri=Zi.publicUrl}if(ke==="new"){const{data:Ne,error:zt}=await Em(Rt.from("venue_places").insert({name:Ue.trim(),city:He.trim(),address:Ye.trim()||null,latitude:at,longitude:Ke,created_by:t}).select("id, name, city, address, latitude, longitude").single(),2e4,"Venue create");if(zt)throw zt;_t=Ne.id}if(!_t)throw new Error("Venue is required.");const xt=ln.split(",").map(Ne=>Ne.trim()).filter(Boolean),{data:Gt,error:fi}=await Em(Rt.from("events").insert({organizer_id:t,venue_place_id:_t,name:ut.trim(),description:rt.trim()||null,event_url:Pt.trim()||null,city:he||r||"",address:Ge||null,latitude:at,longitude:Ke,genres:xt,cover_image_url:Ri,is_free:it,price_tiers:it?[]:Mn,starts_at:ni.toISOString(),ends_at:yi,is_public:!0}).select("id").single(),2e4,"Event create");if(fi||!Gt)throw fi||new Error("Event creation failed.");for(const Ne of Ct){const{error:zt}=await Em(Rt.from("event_artists").insert({event_id:Gt.id,artist_entity_id:Ne}),2e4,"Lineup create");if(zt)throw await Em(Rt.from("events").delete().eq("id",Gt.id),2e4,"Rollback"),zt}return Gt.id}catch(Ri){const _t=Ri instanceof Error?Ri.message:"Unknown error occurred";return re(_t),null}finally{J(!1)}}}},TR=({venueMode:t,onToggleVenueMode:e,venueSearch:r,onVenueSearchChange:l,mapCenter:f,venueMarkers:_,newVenueIcon:y,visibleVenues:d,venuesLoading:A,selectedVenue:j,onSelectVenue:B,onClearVenue:N,onBoundsChange:V,onMapSelect:Q,venueLat:ne,venueLng:J,newVenueName:ye,newVenueCity:re,newVenueAddress:ge,newVenueLat:le,newVenueLng:me,onNewVenueNameChange:be,onNewVenueCityChange:ke,onNewVenueAddressChange:Me,onNewVenueLatChange:Ue,onNewVenueLngChange:Fe})=>S.jsxs("section",{className:"h-full space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsx("div",{children:S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue"})}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center text-sm font-semibold text-white/70 transition hover:text-white",onClick:e,children:t==="existing"?"New venue":"Use existing"})]}),S.jsx("input",{type:"search",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Search venues",value:r,onChange:He=>l(He.target.value)}),S.jsx("div",{className:"h-[220px] overflow-hidden rounded-2xl bg-black/30",children:S.jsxs(Xx,{center:f,zoom:12,className:"h-full w-full",zoomControl:!1,style:{height:"100%",width:"100%"},children:[S.jsx(r2,{}),S.jsx(Kx,{}),t==="existing"&&_.map(He=>S.jsx(i_,{position:He.position,icon:He.icon,eventHandlers:{click:()=>B(He.venue)}},He.venue.id)),t==="new"&&ne!==null&&J!==null&&S.jsx(i_,{position:[ne,J],icon:y}),S.jsx(vR,{center:f}),S.jsx(xR,{onChange:V}),S.jsx(bR,{enabled:t==="new",onSelect:Q})]})}),t==="existing"&&S.jsx(S.Fragment,{children:A?S.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/70",children:[S.jsx(Ys,{name:"crescent"}),"Loading venues..."]}):d.length===0?S.jsx("p",{className:"h-[250px] text-sm text-white/60",children:'No venues found. Switch to "New venue" to add one.'}):S.jsx("div",{className:"max-h-[250px] overflow-auto pr-1",children:S.jsx("div",{className:"space-y-3",children:d.map(He=>S.jsxs("div",{className:`flex cursor-pointer items-center gap-4 rounded-2xl p-4 text-left transition ${j?.id===He.id?"bg-white/10":"bg-white/5 hover:bg-white/10"}`,onClick:()=>B(He),children:[S.jsx("div",{className:"flex h-16 w-16 flex-shrink-0 items-center justify-center overflow-hidden rounded-xl bg-white/10",children:He.photos&&He.photos.length>0?S.jsx("img",{src:He.photos[0],alt:He.name,className:"h-full w-full object-cover"}):S.jsx("svg",{className:"h-8 w-8 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsx("h3",{className:"mb-1 text-sm font-semibold text-white",children:He.name}),S.jsxs("p",{className:"mb-1 text-xs text-white/60",children:[He.city,He.address?`  ${He.address}`:""]}),He.venue_type&&S.jsxs("p",{className:"text-xs text-white/50",children:[He.venue_type,He.capacity?`  Capacity: ${He.capacity}`:""]})]}),j?.id===He.id&&S.jsx("div",{className:"h-2.5 w-2.5 flex-shrink-0 rounded-full bg-app-accent"})]},He.id))})})}),t==="new"&&S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:ye,onChange:He=>be(He.target.value),placeholder:"Venue name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:re,onChange:He=>ke(He.target.value),placeholder:"City"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Address"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:ge,onChange:He=>Me(He.target.value),placeholder:"Street address"})]})]})]}),ER=({name:t})=>t==="spotify"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M7.5 10.5c3.2-1 6.8-.6 9.3.9M8.5 13.5c2.3-.6 5-.4 6.9.6M9.5 16.1c1.6-.3 3.3-.1 4.6.5"})]}):t==="apple_music"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[S.jsx("path",{d:"M16.5 3.5c-.9.6-1.9 1-2.7.9-.1-1 .5-2 1.3-2.6.9-.6 2.2-1 3.2-1-.2 1-1 2-1.8 2.7z"}),S.jsx("path",{d:"M19 13.5c-.2 2-1.7 5.5-3.4 5.5-.8 0-1.2-.5-2-.5-.8 0-1.4.5-2 .5-1.7 0-3.6-3.3-3.6-6.1 0-2.7 1.8-4.1 3.4-4.1.8 0 1.6.5 2.1.5s1.3-.6 2.3-.6c.6 0 2.1.2 2.8 1.6-.1.1-1.7 1-1.6 3.2 0 2.6 2 3.4 2 3.4z"})]}):t==="instagram"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"4"}),S.jsx("circle",{cx:"12",cy:"12",r:"3.2"}),S.jsx("circle",{cx:"17",cy:"7",r:"1",fill:"currentColor"})]}):t==="youtube"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[S.jsx("path",{d:"M21 8.5s0-2-2-2.1C17.2 6.2 12 6.2 12 6.2s-5.2 0-7 .2C3 6.4 3 8.5 3 8.5S3 10.6 3 12v1.5s0 2 2 2.2c1.8.2 7 .2 7 .2s5.2 0 7-.2c2-.2 2-2.2 2-2.2V12s0-1.5 0-3.5z"}),S.jsx("path",{d:"M10 15l4-3-4-3v6z",fill:"#0b0b0d"})]}):S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("path",{d:"M10 14l-4 4m0 0h4m-4 0v-4"}),S.jsx("path",{d:"M14 10l4-4m0 0h-4m4 0v4"}),S.jsx("path",{d:"M8 16h8a4 4 0 0 0 4-4V8"}),S.jsx("path",{d:"M16 8H8a4 4 0 0 0-4 4v4"})]}),kR=({artist:t,isManager:e,playedCount:r,externalLinks:l,heroStyle:f,onEdit:_})=>{const y=t?.is_verified;return S.jsxs("section",{className:"relative min-h-[420px] overflow-hidden bg-black",style:f,children:[e&&S.jsx("button",{type:"button",onClick:_,className:"absolute right-4 top-4 z-10 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",children:S.jsxs("span",{className:"inline-flex items-center gap-2",children:[S.jsx(ej,{size:14}),"Edit"]})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-6",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:t.avatar_url?S.jsx("img",{src:t.avatar_url,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0 flex-1",children:[S.jsx("h1",{className:"font-display text-2xl font-bold text-white line-clamp-1",children:t.name}),S.jsxs("p",{className:"mt-1 text-sm text-white/55 line-clamp-1",children:[t.city?t.city:t.artist_type==="band"?"Band":"Solo",y?"  Verified":"",r>0?`  ${r} shows`:""]})]})]}),t.bio&&S.jsx("p",{className:"mt-4 text-sm text-white/80",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.bio}),l.length>0&&S.jsx("div",{className:"mt-4 flex flex-wrap gap-x-4 gap-y-2",children:l.map(d=>{const A=d.key,j={spotify:"Spotify",apple_music:"Apple Music",instagram:"Instagram",youtube:"YouTube",website:"Website"};return S.jsxs("a",{href:d.value,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(ER,{name:A}),j[A]]},A)})})]})]})},CR=({activeTab:t,onSelect:e})=>S.jsx("div",{className:"flex flex-wrap items-center gap-6",children:["shows","moments","media","about"].map(r=>S.jsx("button",{type:"button",onClick:()=>e(r),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t===r?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:r==="shows"?"Shows":r==="media"?"Media":r==="moments"?"Moments":"About"},r))}),AR=({events:t,isManager:e,onViewEvent:r,onCreateShow:l,onOpenMap:f})=>S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Upcoming"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Upcoming shows"})]}),S.jsxs("button",{type:"button",onClick:f,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(h_,{size:16}),"Artist map"]})]}),t.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"font-semibold text-white",children:"No upcoming shows"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"When new dates are announced they will show up here first."}),e?S.jsx("button",{type:"button",onClick:l,className:"mt-3 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create your first show"}):null]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:t.map(_=>{const d=new Date(_.starts_at).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),A=_.venue_place?.name||_.address||"Venue TBA",j=_.venue_place?.city||_.city||"City";return S.jsx(ec,{event:_,className:"w-[220px] shrink-0",kicker:d,title:A,subtitle:j,onSelect:B=>r(B.id)},_.id)})})]}),MR=({hasEvents:t,artistName:e,isManager:r,onOpenMap:l,onCreateShow:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Map"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Artist map"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Filtered to ",e," by default."]})]}),S.jsxs("button",{type:"button",onClick:l,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(h_,{size:16}),"Open map"]})]}),S.jsx("div",{className:"overflow-hidden bg-white/5 p-5",children:t?S.jsxs("div",{className:"space-y-2",children:[S.jsx("p",{className:"text-sm font-semibold text-white",children:"Map preview"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Open the live map to explore where ",e," is playing. The map starts filtered to this artist."]}),S.jsx("div",{className:"mt-3 h-40 bg-black/60"})]}):S.jsxs("div",{className:"flex flex-col items-start gap-2 text-white",children:[S.jsx("p",{className:"text-lg font-semibold",children:"No shows to display for this artist"}),S.jsx("p",{className:"text-sm text-white/55",children:"New events will appear on the map as soon as they are published."}),r?S.jsx("button",{type:"button",onClick:f,className:"mt-2 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create show"}):null]})})]}),PR=({gallery:t,onSelect:e,onViewGallery:r})=>t.length===0?null:S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Media"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Gallery"}),S.jsx("p",{className:"text-sm text-white/55",children:"Live photos, posters, backstage."})]}),S.jsx("button",{type:"button",onClick:r,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:"View gallery"})]}),S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:t.map(l=>S.jsx("button",{type:"button",onClick:()=>e(l.id),className:"group relative aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:S.jsx("img",{src:l.media_url,alt:l.caption||"Gallery item",className:"h-full w-full object-cover"})},l.id))})]}),jR=({events:t,playedCount:e,isManager:r,onViewEvent:l,onCreateShow:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Archive"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Past shows"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Last ",t.length||3," performances."]})]}),e>0&&S.jsxs("span",{className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white/80",children:["Played ",e]})]}),t.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"font-semibold text-white",children:"No past shows yet"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"We will start showing the archive as soon as the first show finishes."}),r?S.jsx("button",{type:"button",onClick:f,className:"mt-3 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create show"}):null]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:t.map(_=>{const y=new Date(_.starts_at).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),d=_.venue_place?.name||_.address||"Venue TBA",A=_.venue_place?.city||_.city||"City";return S.jsx(ec,{event:_,className:"w-[220px] shrink-0",kicker:y,title:d,subtitle:A,onSelect:j=>l(j.id)},_.id)})})]}),IR=({moments:t,isManager:e,onSelect:r})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"Moments"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Relive it"}),S.jsx("p",{className:"text-sm text-white/70",children:"Clips and snapshots from the crowd."})]}),e&&t.length===0&&S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.18em] text-white/60",children:"Empty  add the first one"})]}),t.length===0?e?S.jsxs("div",{className:"rounded-2xl bg-white/5 p-5 text-white/80",children:[S.jsx("p",{className:"font-semibold text-white",children:"No moments yet  share your first live moment"}),S.jsx("p",{className:"mt-1 text-sm text-white/70",children:"Upload a clip or photo from a recent performance."})]}):null:S.jsx("div",{className:"grid grid-cols-3 gap-2",children:t.slice(0,12).map(l=>S.jsx("button",{type:"button",onClick:()=>r(l.id),className:"relative aspect-square overflow-hidden bg-black/30",children:l.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:l.media_url})}):S.jsx("img",{src:l.media_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"})},l.id))})]}),LR=({artist:t,isManager:e,playedCount:r,onCreateShow:l,onOpenMap:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"About"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Details"})]}),S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-5",children:[S.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.city||""})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Type"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.artist_type==="band"?"Band":"Solo artist"})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Genres"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.genres&&t.genres.length>0?t.genres.join(", "):""})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Shows"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:r>0?`Played ${r}`:"Coming soon"})]})]}),e&&S.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[S.jsx("button",{type:"button",onClick:l,className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.14em] text-white transition hover:bg-white/15",children:"Create show"}),S.jsxs("button",{type:"button",onClick:f,className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.14em] text-white transition hover:bg-white/15",children:[S.jsx(h_,{size:14}),"View on map"]})]})]})]}),f2=({artistId:t,embedded:e})=>{const{id:r}=eg(),l=t||r,f=Ur(),{managedEntities:_,activeWorkspace:y}=sf(),{user:d}=va(),[A,j]=ie.useState(null),[B,N]=ie.useState([]),[V,Q]=ie.useState([]),[ne,J]=ie.useState([]),[ye,re]=ie.useState([]),[ge,le]=ie.useState(!0),[me,be]=ie.useState(""),[ke,Me]=ie.useState("shows");ie.useEffect(()=>{(async()=>{le(!0),be("");try{const{data:ut,error:Et}=await Rt.from("v_subject_artists").select("*").eq("artist_id",l).maybeSingle();if(Et||!ut)throw Et||new Error("Artist not found");const ot={id:ut.artist_id||ut.id||l,name:ut.name,artist_type:ut.artist_type,city:ut.city,bio:ut.bio,avatar_url:ut.avatar_url,genres:ut.genres||[],external_links:ut.external_links||{},created_at:ut.created_at,updated_at:ut.updated_at,subject_id:ut.subject_id},{data:xe}=await Rt.from("event_artists").select("event_id").eq("artist_entity_id",ot.id),Le=(xe||[]).map(Ot=>Ot.event_id).filter(Boolean);let tt=[];if(Le.length>0){const{data:Ot}=await Rt.from("events").select(`
                *,
                venue_place:venue_places!events_venue_place_id_fkey (
                  id,
                  name,
                  city,
                  address,
                  latitude,
                  longitude
                ),
                event_artists (
                  artist:artists!event_artists_artist_entity_fk (
                    id,
                    name,
                    avatar_url
                  )
                )
              `).in("id",Le).order("starts_at",{ascending:!0});tt=Ot||[]}const rt=new Date,gt=tt.filter(Ot=>new Date(Ot.starts_at)>=rt),Pt=tt.filter(Ot=>new Date(Ot.starts_at)<rt);if(j(ot),N(gt),Q(Pt.reverse()),Le.length>0){const{data:Ot}=await Rt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",Le).order("created_at",{ascending:!1}).limit(24),ei=Ot||[];J(ei),re(ei.filter(gi=>gi.media_type==="image").slice(0,6))}else J([]),re([])}catch(ut){console.error("Failed to load artist profile",ut),be("Artist not found."),j(null),N([]),Q([]),J([]),re([])}finally{le(!1)}})()},[l]);const Ue=ie.useMemo(()=>A?y?.type==="artist"&&y.artist?.id===A.id||_.some(ct=>ct.type==="artist"&&ct.artist?.id===A.id):!1,[y,A,_]),Fe=ie.useMemo(()=>{const ct=A?.external_links||{},ut={spotify:ct.spotify,apple_music:ct.apple_music||ct.appleMusic,instagram:ct.instagram,youtube:ct.youtube,website:ct.website};return Object.entries(ut).map(([Et,ot])=>({key:Et,value:ot})).filter(Et=>!!Et.value)},[A]),He=B.slice(0,5),lt=V.slice(0,5),Ye=A?.avatar_url?{backgroundColor:"#0b0b0d",backgroundImage:`linear-gradient(180deg, rgba(0,0,0,0.12) 0%, rgba(0,0,0,0.68) 70%, #0b0b0d 100%), url(${A.avatar_url})`,backgroundSize:"cover",backgroundPosition:"center"}:{backgroundColor:"#0b0b0d"},Mt=()=>{A&&f.push("/tabs/map",{artistFilter:{id:A.id,name:A.name,avatar_url:A.avatar_url}})},et=V.length+B.length,Tt=()=>{switch(ke){case"shows":return S.jsxs("div",{className:"space-y-6",children:[S.jsx(AR,{events:He,isManager:Ue,onViewEvent:ct=>f.push(`/event/${ct}`),onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`}),onOpenMap:Mt}),S.jsx(jR,{events:lt,playedCount:et,isManager:Ue,onViewEvent:ct=>f.push(`/event/${ct}`),onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`})})]});case"media":return S.jsxs("div",{className:"space-y-6",children:[S.jsx(MR,{hasEvents:B.length>0||V.length>0,artistName:A?.name||"",isManager:Ue,onOpenMap:Mt,onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`})}),S.jsx(PR,{gallery:ye,onSelect:ct=>f.push(`/post/${ct}`),onViewGallery:()=>Me("moments")})]});case"moments":return S.jsx(IR,{moments:ne,isManager:Ue,onSelect:ct=>f.push(`/post/${ct}`)});default:return S.jsx(LR,{artist:A,isManager:Ue,playedCount:et,onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`}),onOpenMap:Mt})}},Be=S.jsxs(S.Fragment,{children:[ge&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})}),!ge&&me&&S.jsx("p",{className:"text-sm text-rose-400",children:me}),!ge&&A&&S.jsxs("div",{className:"space-y-8",children:[S.jsx(kR,{artist:A,isManager:Ue,playedCount:et,externalLinks:Fe,heroStyle:Ye,onEdit:()=>f.push("/tabs/profile")}),S.jsx("div",{className:"sticky top-[72px] z-10 -mx-4 bg-app-bg px-4 py-3",children:S.jsx(CR,{activeTab:ke,onSelect:ct=>Me(ct)})}),S.jsx("div",{children:Tt()})]})]});return e?S.jsx("div",{className:"p-4",children:Be}):S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsx("div",{className:"p-4",children:Be})]})})})},zR=({profileRole:t,profileName:e,artists:r,selectedArtistIds:l,artistsLoading:f,artistSearch:_,artistSearchCount:y,onArtistSearchChange:d,onSelectArtists:A})=>{const[j,B]=ie.useState("existing"),[N,V]=ie.useState(""),[Q,ne]=ie.useState(""),[J,ye]=ie.useState(null),re=me=>{l.includes(me)?A(l.filter(be=>be!==me)):A([...l,me])},ge=r.filter(me=>l.includes(me.id));Nt.useEffect(()=>{if(t==="artist"&&l.length===0){const me=r.find(be=>be.display_name===e||be.username===e);me&&A([me.id])}},[t,e,r,l.length,A]);const le=()=>{B(me=>me==="existing"?"new":"existing")};return S.jsxs("section",{className:"h-full space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artists"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:t==="artist"?"Add yourself and other artists to your event.":"Add multiple artists to your event."})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center text-sm font-semibold text-white/70 transition hover:text-white",onClick:le,children:j==="existing"?"New artist":"Use existing"})]}),j==="existing"?S.jsxs(S.Fragment,{children:[S.jsxs("label",{className:"flex items-center gap-2 rounded-2xl bg-white/10 px-3 py-2 text-sm text-white",children:[S.jsx("svg",{className:"h-4 w-4 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"})}),S.jsx("input",{className:"w-full bg-transparent text-sm text-white placeholder:text-white/40 focus:outline-none",placeholder:"Search artists",value:_,onChange:me=>d(me.target.value)})]}),f&&S.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/70",children:[S.jsx(Ys,{name:"crescent"}),"Searching artists..."]}),!f&&_.trim()!==""&&y===0&&S.jsxs("p",{className:"text-sm text-white/60",children:['No artists found for "',_.trim(),'". The band does not exist yet.']}),!f&&r.length===0&&_.trim()===""&&S.jsx("p",{className:"h-[250px] text-sm text-white/60",children:'No artists found. Switch to "New artist" to add one.'}),r.length>0&&S.jsxs(S.Fragment,{children:[ge.length>0&&S.jsxs("div",{className:"space-y-2 flex-shrink-0",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:["Selected Artists (",ge.length,")"]}),S.jsx("div",{className:"space-y-2",children:ge.map(me=>S.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl bg-white/10 p-3",children:[S.jsxs("div",{children:[S.jsxs("p",{className:"text-sm font-semibold text-white",children:[me.display_name||me.username||"Artist",t==="artist"&&(me.display_name===e||me.username===e)&&S.jsx("span",{className:"ml-2 text-xs text-white/60",children:"(You)"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Artist"})]}),me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-10 w-10 rounded-full object-cover"}):null,S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg bg-white/10 px-2 py-1 text-xs font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>re(me.id),children:"Remove"})]},me.id))})]}),S.jsx("div",{className:"overflow-auto max-h-[250px] pr-1",children:S.jsx("div",{className:"space-y-3",children:r.filter(me=>!l.includes(me.id)).map(me=>S.jsxs("div",{className:"flex cursor-pointer items-center gap-4 rounded-2xl bg-white/5 p-4 text-left transition hover:bg-white/10",onClick:()=>re(me.id),children:[S.jsx("div",{className:"flex h-16 w-16 flex-shrink-0 items-center justify-center overflow-hidden rounded-xl bg-white/10",children:me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-white/10",children:S.jsx("span",{className:"text-sm font-semibold text-white/80",children:(me.display_name||me.username||"A")[0]?.toUpperCase()})})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsxs("h3",{className:"mb-1 text-sm font-semibold text-white",children:[me.display_name||me.username||"Artist",t==="artist"&&(me.display_name===e||me.username===e)&&S.jsx("span",{className:"ml-2 text-xs text-white/60",children:"(You)"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Artist"}),S.jsx("button",{type:"button",className:"mt-1 inline-flex text-xs font-semibold text-white/70 hover:text-white",onClick:be=>{be.stopPropagation(),ye(me)},children:"View profile"})]}),S.jsx("div",{className:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-white/10",children:S.jsx("svg",{className:"h-4 w-4 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]},me.id))})}),ge.length===0&&S.jsx("div",{className:"flex flex-shrink-0 items-center justify-between gap-3 rounded-2xl bg-white/5 p-3",children:S.jsx("p",{className:"text-sm text-white",children:r.length===0?"No matching artists. Try a different search or add a new artist.":"Select artists to continue"})})]})]}):S.jsxs("div",{className:"space-y-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Artist name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:N,onChange:me=>V(me.target.value),placeholder:"Artist name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:Q,onChange:me=>ne(me.target.value),placeholder:"Username"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Note: You can assign a user to this artist later."})]}),S.jsx($m,{isOpen:!!J,onDidDismiss:()=>ye(null),children:S.jsxs(vs,{fullscreen:!0,children:[S.jsxs("div",{className:"flex items-center justify-between gap-4 bg-app-bg px-5 py-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Artist profile"}),S.jsx("button",{type:"button",className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-3 py-1.5 text-xs font-semibold text-white transition hover:bg-white/15",onClick:()=>ye(null),children:"Close"})]}),J&&S.jsx(f2,{artistId:J.id,embedded:!0})]})})]})},RR=({eventName:t,eventStart:e,eventUrl:r,isFree:l,tierLabel:f,tierPrice:_,priceTiers:y,onEventNameChange:d,onEventStartChange:A,onEventUrlChange:j,onToggleFree:B,onTierLabelChange:N,onTierPriceChange:V,onAddTier:Q,onRemoveTier:ne})=>S.jsxs("section",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Tickets"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Essentials only. Everything else can wait."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Event name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:t,onChange:J=>d(J.target.value),placeholder:"Night Session"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Starts at"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",type:"datetime-local",value:e,onChange:J=>A(J.target.value)})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Event link"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:r,onChange:J=>j(J.target.value),placeholder:"https://..."})]}),S.jsxs("label",{className:"flex items-center gap-3 text-sm text-white",children:[S.jsxs("span",{className:"relative inline-flex items-center",children:[S.jsx("input",{type:"checkbox",className:"peer h-5 w-10 appearance-none rounded-full bg-white/10 transition checked:border-app-accent checked:bg-app-accent",checked:l,onChange:J=>B(J.target.checked)}),S.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]}),S.jsx("span",{className:"text-white/80",children:l?"Free event":"Paid event"})]}),!l&&S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Tier name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:f,onChange:J=>N(J.target.value),placeholder:"Presale"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Price"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:_,onChange:J=>V(J.target.value),placeholder:"12"})]})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:Q,children:"Add tier"}),y.length>0&&S.jsx("div",{className:"space-y-2",children:y.map((J,ye)=>S.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl bg-white/5 px-3 py-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold text-white",children:J.label}),S.jsxs("p",{className:"text-[10px] text-white/60",children:["$",J.price.toFixed(2)]})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>ne(ye),children:"Remove"})]},`${J.label}-${ye}`))})]})]}),DR=({eventEnd:t,eventGenres:e,eventCoverUrl:r,eventDescription:l,posterPreview:f,posterFile:_,onEventEndChange:y,onEventGenresChange:d,onEventCoverUrlChange:A,onEventDescriptionChange:j,onPosterFileChange:B,onPosterRemove:N})=>{const V=ie.useRef(null),[Q,ne]=ie.useState(0),J=!!(f||_),ye=ie.useMemo(()=>_?_.name:r.trim()?"Using poster URL":"Upload a poster or paste a URL (optional).",[r,_]);return S.jsxs("section",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"More info"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Optional details (poster, genres, description)."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Ends at"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",type:"datetime-local",value:t,onChange:re=>y(re.target.value)})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Genres"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:e,onChange:re=>d(re.target.value),placeholder:"Jazz, Experimental"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-start justify-between gap-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Poster"}),S.jsx("p",{className:"mt-1 text-xs text-white/60",children:ye})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:()=>V.current?.click(),children:"Upload"}),J&&S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>{ne(re=>re+1),N()},children:"Remove"})]})]}),S.jsx("input",{ref:V,type:"file",accept:"image/*",className:"hidden",onChange:re=>B(re.target.files?.[0]||null)},Q),f&&S.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-black/30",children:S.jsx("img",{src:f,alt:"Event poster preview",className:"h-52 w-full object-cover"})}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Poster URL (optional)"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:r,onChange:re=>A(re.target.value),placeholder:"https://..."})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Description"}),S.jsx("textarea",{className:"min-h-[110px] w-full resize-none rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:l,onChange:re=>j(re.target.value),placeholder:"Optional details..."})]})]})},Gf=["Sala","Artista","Entrada","Ms info"],OR=({onDismiss:t,onCreated:e,userId:r,profileRole:l,profileCity:f,profileName:_,defaultArtistId:y,initialMapCenter:d})=>{const[A,j]=ie.useState(0),B=!!(l&&["artist","venue","label"].includes(l)),N=SR({userId:r,profileRole:l,profileCity:f,defaultArtistId:y,defaultArtistName:_||void 0,initialCenter:d||void 0}),V=ie.useMemo(()=>d2("venue","SALA"),[]),Q=()=>j(ge=>Math.max(ge-1,0)),ne=()=>j(ge=>Math.min(ge+1,Gf.length-1)),J=async()=>{if(A<Gf.length-1){ne();return}const ge=await N.handleCreate();ge&&(e?.(ge),t())},ye=()=>N.setVenueMode(ge=>ge==="existing"?"new":"existing"),re=(()=>{switch(A){case 0:return S.jsx(TR,{venueMode:N.venueMode,onToggleVenueMode:ye,venueSearch:N.venueSearch,onVenueSearchChange:N.setVenueSearch,mapCenter:N.mapCenter,venueMarkers:N.venueMarkers,newVenueIcon:V,visibleVenues:N.visibleVenues,venuesLoading:N.venuesLoading,selectedVenue:N.selectedVenue,onSelectVenue:N.selectVenue,onClearVenue:()=>N.setSelectedVenue(null),onBoundsChange:N.handleBoundsChange,onMapSelect:N.handleMapSelect,venueLat:N.venueLat,venueLng:N.venueLng,newVenueName:N.newVenueName,newVenueCity:N.newVenueCity,newVenueAddress:N.newVenueAddress,newVenueLat:N.newVenueLat,newVenueLng:N.newVenueLng,onNewVenueNameChange:N.setNewVenueName,onNewVenueCityChange:N.setNewVenueCity,onNewVenueAddressChange:N.setNewVenueAddress,onNewVenueLatChange:N.setNewVenueLat,onNewVenueLngChange:N.setNewVenueLng});case 1:return S.jsx(zR,{profileRole:l,profileName:_,artists:N.artists,selectedArtistIds:N.selectedArtistIds,artistsLoading:N.artistsLoading,artistSearch:N.artistSearch,artistSearchCount:N.artistSearchCount,onArtistSearchChange:N.setArtistSearch,onSelectArtists:N.setSelectedArtistIds});case 2:return S.jsx(RR,{eventName:N.eventName,eventStart:N.eventStart,eventUrl:N.eventUrl,isFree:N.isFree,tierLabel:N.tierLabel,tierPrice:N.tierPrice,priceTiers:N.priceTiers,onEventNameChange:N.setEventName,onEventStartChange:N.setEventStart,onEventUrlChange:N.setEventUrl,onToggleFree:ge=>{N.setIsFree(ge),N.setError("")},onTierLabelChange:N.setTierLabel,onTierPriceChange:N.setTierPrice,onAddTier:N.addPriceTier,onRemoveTier:N.removePriceTier});default:return S.jsx(DR,{eventEnd:N.eventEnd,eventGenres:N.eventGenres,eventCoverUrl:N.eventCoverUrl,eventDescription:N.eventDescription,posterPreview:N.posterPreview,posterFile:N.posterFile,onEventEndChange:N.setEventEnd,onEventGenresChange:N.setEventGenres,onEventCoverUrlChange:N.setEventCoverUrl,onEventDescriptionChange:N.setEventDescription,onPosterFileChange:N.setPosterFile,onPosterRemove:()=>N.setPosterFile(null)})}})();return S.jsxs("div",{className:"flex h-full max-h-[100vh] flex-col overflow-hidden rounded-3xl bg-app-bg",children:[S.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-4 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",children:"Create"}),S.jsx("h2",{className:"mt-1 font-display text-lg font-bold text-white",children:"Event"})]}),S.jsx("div",{className:"flex flex-1 justify-end",children:S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:t,children:"Close"})})]}),S.jsx("div",{className:"flex-shrink-0 px-4",children:S.jsx("div",{className:"flex items-center gap-3 overflow-x-auto pb-2",children:Gf.map((ge,le)=>{const me=le===A,be=le<A;return S.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[S.jsx("span",{className:`text-[10px] font-semibold uppercase tracking-[0.22em] ${me?"text-app-accent":be?"text-white/70":"text-white/45"}`,children:ge}),le<Gf.length-1&&S.jsx("span",{className:"text-white/20",children:""})]},ge)})})}),N.error&&S.jsx("div",{className:"flex-shrink-0 px-4 pt-3",children:S.jsx("p",{className:"text-sm text-rose-400",children:N.error})}),S.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-4 py-4",children:re}),S.jsx("div",{className:"flex-shrink-0 p-4 pt-0",children:S.jsxs("div",{className:"tw flex flex-col gap-2 sm:flex-row",children:[A>0&&S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 rounded-2xl bg-white/10 px-6 py-3 text-sm font-semibold text-white transition hover:bg-white/15 sm:w-auto",onClick:Q,children:"Back"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 rounded-2xl bg-white/10 px-6 py-3 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:J,disabled:N.saving||A===Gf.length-1&&!B,children:A===Gf.length-1?N.saving?"Creating...":"Create event":"Next"})]})})]})},NR=()=>{const t=Ur(),e=mp(),{user:r,profile:l,loading:f}=va(),{canCreateEvent:_,activeWorkspace:y,loading:d,ready:A}=sf(),j=ie.useRef(null),B=ie.useRef(null),N=ie.useRef(null),V=e.state?.from||"/tabs/events";ie.useEffect(()=>{A&&(j.current=_)},[A,_]),ie.useEffect(()=>{r||(j.current=null,B.current=null,N.current=null)},[r]),ie.useEffect(()=>{y&&(B.current=y)},[y]),ie.useEffect(()=>{l&&(N.current=l)},[l]);const Q=A?_:j.current??!1,ne=y??B.current,J=l??N.current,ye=ne?.type==="artist"&&(ne.artist?.id||ne.artist?.artist_id)||null,re=ne?.type==="venue"?Number(ne.venue?.latitude??ne.venue?.lat??null):null,ge=ne?.type==="venue"?Number(ne.venue?.longitude??ne.venue?.lng??null):null,le=ne?.type==="venue"&&Number.isFinite(re)&&Number.isFinite(ge)?[re,ge]:null;return f&&!r?S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})})})}):r?(!A||d)&&!Q?S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})})})}):A&&!Q?S.jsx(kc,{to:"/tabs/events"}):S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsx(OR,{onDismiss:()=>t.push(V),onCreated:me=>{me?t.push(`/event/${me}`):t.push(V)},userId:r?.id,profileRole:ne?.type||J?.role||null,profileCity:ne?.venue?.city||J?.primary_city||null,profileName:ne?.artist?.name||ne?.venue?.name||J?.display_name||J?.username||null,defaultArtistId:ye,initialMapCenter:le})})}):S.jsx(kc,{to:"/welcome"})},BR=()=>{const t=Ur(),{updatePassword:e}=va(),[r,l]=ie.useState(""),[f,_]=ie.useState(""),[y,d]=ie.useState(!1),[A,j]=ie.useState(""),[B,N]=ie.useState("");ie.useEffect(()=>{(async()=>{const J=new URLSearchParams(window.location.search).get("code");J&&await Rt.auth.exchangeCodeForSession(J);const{data:ye}=await Rt.auth.getSession();d(!!ye.session)})()},[]);const V=async()=>{if(N(""),j(""),!r||r.length<6){N("Password must be at least 6 characters.");return}if(r!==f){N("Passwords do not match.");return}const{error:Q}=await e(r);if(Q){N(Q.message);return}j("Password updated. You can sign in now.")};return S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[!y&&S.jsx("p",{className:"text-sm text-white/70",children:"Open the reset link from your email to continue."}),y&&S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"New password"}),S.jsx("input",{type:"password",value:r,onChange:Q=>l(Q.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Confirm password"}),S.jsx("input",{type:"password",value:f,onChange:Q=>_(Q.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:V,children:"Update password"})]}),B&&S.jsx("p",{className:"text-sm text-rose-400",children:B}),A&&S.jsx("p",{className:"text-sm text-emerald-400",children:A}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>t.replace("/welcome"),children:"Back to sign in"})]})]})})})},$R={async getEventPosts(t){const{data:e,error:r}=await Rt.from("v_posts_with_setlist").select("*").eq("event_id",t).order("event_offset_ms",{ascending:!0,nullsFirst:!1}).order("captured_at",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0});if(r)throw r;return e||[]},async getEventSetlist(t){const{data:e,error:r}=await Rt.from("event_setlist").select("*").eq("event_id",t).order("ordinal",{ascending:!0});if(r)throw r;return e||[]},async getSetlistEntryForOffset(t,e){const{data:r,error:l}=await Rt.rpc("get_setlist_entry_for_offset",{p_event_id:t,p_offset_ms:e});if(l)throw l;return r?.[0]||null}},Tw=2082844800,Sy=t=>t.toString().padStart(2,"0"),UR=t=>`${t.getFullYear()}-${Sy(t.getMonth()+1)}-${Sy(t.getDate())}T${Sy(t.getHours())}:${Sy(t.getMinutes())}`,FR=t=>{if(!t)return null;const e=new Date(t);return Number.isNaN(e.getTime())?null:e},VR=(t,e)=>e+4>t.byteLength?"":String.fromCharCode(t.getUint8(e),t.getUint8(e+1),t.getUint8(e+2),t.getUint8(e+3)),p2=(t,e)=>{const r=t.getUint32(e),l=t.getUint32(e+4);return r*2**32+l},Ew=(t,e,r)=>{if(e+8>r)return null;let l=t.getUint32(e);const f=VR(t,e+4);let _=8;if(l===1){if(e+16>r)return null;l=p2(t,e+8),_=16}else l===0&&(l=r-e);return l<_?null:{size:l,type:f,headerSize:_}},qR=(t,e,r)=>e+4>r?null:t.getUint8(e)===1?e+12>r?null:p2(t,e+4):e+8>r?null:t.getUint32(e+4),HR=t=>{const e=new DataView(t),r=e.byteLength;let l=0;for(;l+8<=r;){const f=Ew(e,l,r);if(!f)break;const _=Math.min(l+f.size,r);if(f.type==="moov"){let y=l+f.headerSize;for(;y+8<=_;){const d=Ew(e,y,_);if(!d)break;if(d.type==="mvhd"){const A=qR(e,y+d.headerSize,_);if(A!==null)return A}if(d.size<=0)break;y+=d.size}}if(f.size<=0)break;l+=f.size}return null},ZR=async t=>{const r=[t.slice(0,2097152)];t.size>2097152&&r.push(t.slice(Math.max(t.size-2097152,0),t.size));for(const l of r)try{const f=await l.arrayBuffer(),_=HR(f);if(_&&_>Tw){const y=new Date((_-Tw)*1e3);if(!Number.isNaN(y.getTime()))return y}}catch{}return null},GR=async t=>{const e=t.type.startsWith("image/"),r=t.type.startsWith("video/");if(e)try{const l=await Mc(()=>import("./full.esm-DoFl4RTa.js"),[]),_=await(l.default??l).parse(t,["DateTimeOriginal","CreateDate","ModifyDate"]),y=_?.DateTimeOriginal||_?.CreateDate||_?.ModifyDate,d=y instanceof Date?y:typeof y=="string"?new Date(y):null;if(d&&!Number.isNaN(d.getTime()))return{capturedAt:d,source:"exif"}}catch{}if(r){const l=await ZR(t);if(l)return{capturedAt:l,source:"video.metadata"}}return Number.isFinite(t.lastModified)&&t.lastModified>0?{capturedAt:new Date(t.lastModified),source:"file.lastModified"}:{capturedAt:null,source:null}},WR=async t=>{const e=new Date;return await Promise.all(t.map(async l=>{const{capturedAt:f,source:_}=await GR(l),y=l.type.startsWith("video")?"video":"image",d=f??e,A=f?_:"manual";return{id:typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`,file:l,previewUrl:URL.createObjectURL(l),mediaType:y,captureAt:f??d,captureSource:A??null,manualValue:UR(d)}}))},YR=t=>t==="artist"||t==="artist_entity"?"Artist":t==="venue"?"Venue":t==="label"?"Label":"User",XR=({title:t,meta:e,entities:r,onSelectEntity:l,coverImageUrl:f,actions:_})=>S.jsxs("section",{children:[S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[f?S.jsx("img",{src:f,alt:t,className:"absolute inset-0 h-full w-full object-cover"}):null,_?S.jsx("div",{className:"absolute right-4 top-4 z-10 flex items-center gap-3",children:_}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("h1",{className:"font-display text-3xl font-bold text-white",children:t}),e?S.jsx("div",{className:"mt-2 text-sm text-white/75",children:e}):null]})]}),r.length>0&&S.jsx("div",{className:"mt-4 flex flex-wrap gap-x-4 gap-y-2 px-4",children:r.map(y=>S.jsxs("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65 hover:text-white",onClick:()=>l(y.id,y.role),children:[y.name,"  ",YR(y.role)]},y.id))})]}),KR=(t,e,r)=>Math.min(r,Math.max(e,t)),gv=t=>{const e=Math.max(0,Math.round(t)),r=Math.floor(e/3600),l=Math.floor(e%3600/60),f=e%60;return r>0?`+${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`+${l.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},JR=({buckets:t,selectedIndex:e,onSelectIndex:r,eventStart:l,gapThresholdSeconds:f=120})=>{const _=ie.useRef(null),y=ie.useRef({offsets:[],maxOffset:1}),[d,A]=ie.useState(!1),j=ie.useMemo(()=>l||(t[0]?new Date(t[0].bucket_time):null),[l,t]),B=ie.useMemo(()=>j?t.map(le=>{const me=Math.round((new Date(le.bucket_time).getTime()-j.getTime())/1e3);return me<0?0:me}):[],[t,j]),N=ie.useMemo(()=>B.length===0?1:Math.max(...B,1),[B]),V=ie.useMemo(()=>{if(B.length<2||N<=0)return[];const le=[];for(let me=0;me<B.length-1;me+=1){const be=B[me],ke=B[me+1];if(ke<=be)continue;const Me=ke-be>f;le.push({key:`${be}-${ke}`,left:be/N*100,width:(ke-be)/N*100,isGap:Me})}return le},[B,N,f]);ie.useEffect(()=>{y.current={offsets:B,maxOffset:N}},[B,N]);const Q=ie.useCallback(le=>{const me=_.current;if(!me||t.length===0)return;const be=me.getBoundingClientRect();if(be.width===0)return;const ke=KR((le-be.left)/be.width,0,1),{offsets:Me,maxOffset:Ue}=y.current,Fe=ke*Ue;let He=0,lt=Number.POSITIVE_INFINITY;Me.forEach((Ye,Mt)=>{const et=Math.abs(Ye-Fe);et<lt&&(lt=et,He=Mt)}),r(He)},[t.length,r]),ne=le=>{_.current&&(_.current.setPointerCapture(le.pointerId),A(!0),Q(le.clientX))},J=le=>{d&&Q(le.clientX)},ye=le=>{_.current&&(_.current.hasPointerCapture(le.pointerId)&&_.current.releasePointerCapture(le.pointerId),A(!1))};if(t.length===0)return null;const re=B[e]??0,ge=N?re/N:0;return S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsxs("div",{className:"relative h-8 cursor-pointer touch-none",ref:_,onPointerDown:ne,onPointerMove:J,onPointerUp:ye,onPointerCancel:ye,onPointerLeave:ye,children:[S.jsx("div",{className:"absolute inset-x-0 top-1/2 h-0.5 -translate-y-1/2 bg-white/10"}),V.map(le=>S.jsx("div",{className:`absolute top-1/2 h-0.5 -translate-y-1/2 rounded-full ${le.isGap?"bg-[repeating-linear-gradient(90deg,rgba(255,255,255,0.08),rgba(255,255,255,0.08)_6px,transparent_6px,transparent_12px)]":"bg-white/30"}`,style:{left:`${le.left}%`,width:`${le.width}%`}},le.key)),t.map((le,me)=>{const be=N?(B[me]??0)/N:0,ke=le.moment_count>=5?3:le.moment_count>=3?2:1,Me=ke===3?"h-3 w-3":ke===2?"h-2.5 w-2.5":"h-2 w-2";return S.jsx("button",{type:"button",className:`absolute top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full ${Me} ${me===e?"bg-[#ff6b4a]":"bg-white/40"}`,style:{left:`${be*100}%`},onClick:()=>r(me),children:S.jsx("span",{className:"sr-only",children:gv(B[me]??0)})},le.bucket_time)}),S.jsx("div",{className:"pointer-events-none absolute top-1/2 h-4 w-4 -translate-x-1/2 -translate-y-1/2 rounded-full border-2 border-[#ff6b4a] bg-[#ff6b4a]/20",style:{left:`${ge*100}%`}})]}),S.jsxs("div",{className:"flex justify-between text-[11px] text-white/55",children:[S.jsx("span",{children:gv(0)}),S.jsx("span",{children:gv(N)})]})]})},QR=({moments:t,selectedIndex:e,onSelect:r})=>t.length<=1?null:S.jsx("div",{className:"flex gap-2.5 overflow-x-auto pb-1",children:t.map((l,f)=>S.jsxs("button",{type:"button",className:"relative h-14 w-14 flex-shrink-0 overflow-hidden bg-white/5 transition-opacity hover:opacity-90",onClick:()=>r(f),children:[f===e&&S.jsx("span",{className:"absolute left-2 top-2 h-2 w-2 bg-[#ff6b4a]"}),l.media_type==="video"?l.thumbnail_url?S.jsx("img",{src:l.thumbnail_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"}):S.jsx("video",{muted:!0,preload:"metadata",className:"h-full w-full object-cover",children:S.jsx("source",{src:l.media_url})}):S.jsx("img",{src:l.media_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"}),S.jsxs("span",{className:"sr-only",children:["Moment ",f+1]})]},l.id))}),m2=t=>{const e=Math.max(0,Math.round(t)),r=Math.floor(e/3600),l=Math.floor(e%3600/60),f=e%60;return r>0?`+${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`+${l.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},eD=(t,e)=>{if(!t)return"";const r=new Date(t);if(e){const l=(r.getTime()-e.getTime())/1e3;return m2(l)}return r.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})},tD=(t,e)=>{if(!t)return"";const r=t.captured_at||t.created_at,l=new Date(r);if(e){const f=(l.getTime()-e.getTime())/1e3;return m2(f)}return l.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})},iD=({buckets:t,selectedBucketIndex:e,selectedMomentIndex:r,moments:l,loading:f,totalMoments:_,eventStart:y,mediaFilter:d,onSelectBucket:A,onSelectMoment:j,onAddMoments:B,onFilterChange:N,autoAdvance:V,onRequestNext:Q})=>{const ne=t[e]??null,J=l[r]??null,ye=ie.useRef(null);ie.useEffect(()=>{if(!J||J.media_type!=="video")return;const le=ye.current;if(!le)return;const me=le.play();me&&typeof me.catch=="function"&&me.catch(()=>{})},[J?.id]);const re=ie.useMemo(()=>eD(ne?.bucket_time??null,y),[ne?.bucket_time,y]),ge=ie.useMemo(()=>tD(J,y),[J,y]);return S.jsxs("section",{className:"flex flex-col gap-4",children:[S.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Timeline"}),S.jsx("p",{className:"mt-1.5 font-display text-lg font-bold text-white",children:re||"+00:00"})]}),S.jsxs("div",{className:"inline-flex items-center gap-3",children:[_>0&&S.jsxs("span",{className:"text-xs text-white/55",children:[_," moments"]}),S.jsx("div",{className:"inline-flex gap-4 bg-white/10 px-3 py-2",children:["all","video","image"].map(le=>S.jsx("button",{type:"button",className:`text-[10px] font-semibold uppercase tracking-[0.22em] transition-colors ${d===le?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>N(le),children:le==="all"?"All":le==="video"?"Video":"Photos"},le))})]})]}),S.jsx("div",{className:"-mx-4",children:S.jsx("div",{className:`relative aspect-video overflow-hidden bg-black ${f?"opacity-90":""}`,children:f?S.jsx("div",{className:"flex h-full items-center justify-center",children:S.jsx(Ys,{name:"crescent"})}):J?S.jsxs("div",{className:"relative h-full w-full animate-[timeline-fade_0.35s_ease]",onClick:()=>{const le=ye.current;le&&(le.paused?le.play().catch(()=>{}):le.pause())},children:[J.media_type==="video"?S.jsx("video",{ref:ye,playsInline:!0,muted:!0,autoPlay:!0,className:"h-full w-full object-cover",onEnded:()=>{V&&Q&&Q()},poster:J.thumbnail_url||void 0,children:S.jsx("source",{src:J.media_url})}):S.jsx("img",{src:J.media_url,alt:J.caption||"Moment",className:"h-full w-full object-cover"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4",children:[J.resolved_song_title&&S.jsx("div",{className:"mb-2 inline-flex items-center gap-1.5 bg-black/60 px-2.5 py-1",children:S.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.22em] text-white/80",children:J.resolved_song_title})}),S.jsx("p",{className:"text-xs text-white/65",children:ge}),S.jsx("h4",{className:"mt-1.5 font-display text-lg font-bold text-white",children:J.actor_name||J.profiles?.display_name||J.profiles?.username||"Anonymous"})]})]},J.id):S.jsxs("div",{className:"flex min-h-full flex-col items-center justify-center gap-2 px-6 text-center",children:[S.jsx("p",{className:"text-lg font-semibold text-white",children:"No moments yet."}),S.jsx("span",{className:"text-xs text-white/55",children:"Relive the show by adding the first clip."}),B&&S.jsx("button",{type:"button",className:"mt-1.5 text-xs font-semibold uppercase tracking-[0.22em] text-app-accent",onClick:B,children:"Add the first moment"})]})})}),S.jsx(JR,{buckets:t,selectedIndex:e,onSelectIndex:A,eventStart:y,gapThresholdSeconds:120}),S.jsx(QR,{moments:l,selectedIndex:r,onSelect:j})]})},nD=({isOpen:t,onClose:e,link:r})=>{const[l,f]=ie.useState("");ie.useEffect(()=>{t||f("")},[t]);const _=async()=>{if(r)try{await navigator.clipboard.writeText(r),f("Link copied.")}catch{f("Copy failed. Long-press to copy.")}},y=async()=>{if(r){if(navigator.share)try{await navigator.share({url:r,title:"Live Space event"});return}catch{}_()}};return S.jsx($m,{isOpen:t,onDidDismiss:e,initialBreakpoint:.5,breakpoints:[0,.5,.9],className:"share-sheet",children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Share"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:e,children:"Close"})]}),S.jsx("div",{className:"mt-6 flex items-center justify-center bg-white/5 p-5",children:r&&S.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${encodeURIComponent(r)}`,alt:"Event QR",className:"h-40 w-40 bg-white"})}),S.jsxs("div",{className:"mt-6 space-y-2",children:[S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:_,children:[S.jsx(ij,{className:"h-4 w-4"}),"Copy link"]}),S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:y,children:[S.jsx(ES,{className:"h-4 w-4"}),"Share"]})]}),l&&S.jsx("p",{className:"mt-4 text-sm text-white/55",children:l})]})})})},sD=()=>{const t=Ur(),e=mp(),{id:r}=eg(),{user:l,profile:f,isManagementMode:_,activeEntity:y}=va(),[d,A]=ie.useState(null),[j,B]=ie.useState(!0),[N,V]=ie.useState(""),[Q,ne]=ie.useState([]),[J,ye]=ie.useState(!1),[re,ge]=ie.useState(""),[le,me]=ie.useState([]),[be,ke]=ie.useState([]),[Me,Ue]=ie.useState(!1),[Fe,He]=ie.useState(0),[lt,Ye]=ie.useState(0),[Mt,et]=ie.useState(!1),[Tt,Be]=ie.useState([]),[ct,ut]=ie.useState(!1),[Et,ot]=ie.useState({current:0,total:0}),[xe,Le]=ie.useState(""),[tt,rt]=ie.useState(""),[gt,Pt]=ie.useState(!1),[Ot,ei]=ie.useState(!1),[gi,Vi]=ie.useState(!1),[pi,zi]=ie.useState("video"),[gn,ln]=ie.useState({all:0,video:0,image:0}),[$n,it]=ie.useState(!1),[Cn,Mn]=ie.useState(null),[Si,mi]=ie.useState(!1),[En,Rn]=ie.useState(""),[is,sn]=ie.useState(!1),Xi=ie.useRef(null),Gi=ie.useRef([]),ns=ie.useRef({}),kt=ie.useRef({});ie.useEffect(()=>{e.state?.openAddMoments&&(sn(!0),t.replace({pathname:e.pathname,search:e.search,hash:e.hash,state:{}}))},[t,e.hash,e.pathname,e.search,e.state?.openAddMoments]);const Hn=ie.useMemo(()=>!!new URLSearchParams(e.search).get("token"),[e.search]);ie.useEffect(()=>{Gi.current=Tt},[Tt]),ie.useEffect(()=>()=>{Gi.current.forEach(_t=>URL.revokeObjectURL(_t.previewUrl))},[]);const yn=async()=>{B(!0),V("");try{const{data:_t,error:xt}=await Rt.from("events").select(`
          *,
          organizer:profiles!events_organizer_id_fkey (
            id,
            username,
            display_name,
            avatar_url,
            role
          ),
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude,
            website_url,
            photos
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `).eq("id",r).single();if(xt||!_t){V("Event not found."),A(null);return}A(_t);const Gt=await $R.getEventSetlist(r);ke(Gt)}catch{V("Could not load this event. Check your Supabase connection."),A(null)}finally{B(!1)}},bn=async _t=>{ye(!0),ge(""),ns.current={},kt.current={};try{let xt=null;if(_t==="all")xt=await Rt.rpc("event_moment_buckets",{p_event_id:r});else{const Ne=await Rt.rpc("event_moment_buckets_filtered",{p_event_id:r,p_media_type:_t});Ne.error?xt=await Rt.rpc("event_moment_buckets",{p_event_id:r}):xt=Ne}if(xt?.error)throw xt.error;const Gt=xt?.data||[],fi=Gt.length>0?Gt.length-1:0;ne(Gt),He(fi),Ye(0)}catch(xt){ne([]),ge(xt?.message||"Could not load the timeline.")}finally{ye(!1)}},Un=async()=>{try{const _t=Rt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",r),xt=Rt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",r).eq("media_type","video"),Gt=Rt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",r).eq("media_type","image"),[{count:fi},{count:Ne},{count:zt}]=await Promise.all([_t,xt,Gt]),Kt={all:fi??0,video:Ne??0,image:zt??0};ln(Kt),pi==="video"&&Kt.video===0&&Kt.image>0&&zi("image"),pi==="image"&&Kt.image===0&&Kt.video>0&&zi("video"),pi!=="all"&&Kt.video===0&&Kt.image===0&&zi("all")}catch{ln({all:0,video:0,image:0})}},jt=async(_t,xt,Gt)=>{if(!_t)return;const fi=`${Gt}:${_t}`;if(ns.current[fi]){xt&&(me(ns.current[fi]),Ye(0));return}if(!kt.current[fi]){kt.current[fi]=!0,xt&&Ue(!0);try{const Ne=new Date(_t),zt=new Date(Ne.getTime()+1e3),Kt=Ne.toISOString(),Zi=zt.toISOString();let vi=Rt.from("v_event_posts_with_setlist").select(`
          *,
          profiles:profiles!posts_user_id_fkey (
            id,
            username,
            display_name,
            avatar_url
          )
        `).eq("event_id",r).or(`and(captured_at.gte.${Kt},captured_at.lt.${Zi}),and(captured_at.is.null,created_at.gte.${Kt},created_at.lt.${Zi})`).order("event_offset_ms",{ascending:!0,nullsFirst:!1}).order("captured_at",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0});Gt!=="all"&&(vi=vi.eq("media_type",Gt));const{data:mn,error:_r}=await vi;if(_r)throw _r;const Xs=mn||[];ns.current[fi]=Xs,xt&&(me(Xs),Ye(0))}catch{xt&&me([])}finally{kt.current[fi]=!1,xt&&Ue(!1)}}},ii=(_t,xt)=>{if(_t<0||_t>=Q.length)return;const Gt=Q[_t];jt(Gt.bucket_time,!1,xt)};ie.useEffect(()=>{ns.current={},kt.current={},ne([]),me([]),He(0),Ye(0),Be([]),et(!1),ei(!1),yn(),Un()},[r]),ie.useEffect(()=>{bn(pi)},[r,pi]),ie.useEffect(()=>{Fe>=Q.length&&Q.length>0&&He(0)},[Q,Fe]);const Xt=Q[Fe]??null,Wi=ie.useMemo(()=>{const _t=Q.reduce((xt,Gt)=>xt+Gt.moment_count,0);return pi==="video"?gn.video||_t:pi==="image"?gn.image||_t:gn.all||_t},[Q,gn,pi]);ie.useEffect(()=>{if(!Xt){me([]);return}jt(Xt.bucket_time,!0,pi),ii(Fe-1,pi),ii(Fe+1,pi)},[Xt?.bucket_time,pi]),ie.useEffect(()=>{(async()=>{if(!l||!r){Vi(!1),Mn(null);return}try{const xt=_&&y?y.subject_id:f?.subject_id,[{data:Gt},{data:fi}]=await Promise.all([Rt.from("event_saves").select("event_id").eq("event_id",r).eq(xt?"subject_id":"user_id",xt||l.id).limit(1),Rt.from("event_attendance").select("status").eq("event_id",r).eq(xt?"subject_id":"user_id",xt||l.id).limit(1)]);Vi(!!(Gt&&Gt.length>0)),Mn(fi?.[0]?.status??null)}catch{Vi(!1),Mn(null)}})()},[l,r]);const Dn=ie.useMemo(()=>{if(!d)return[];const _t=[],xt=new Set,Gt=Ne=>{!Ne||xt.has(Ne.id)||(_t.push({id:Ne.id,name:Ne.display_name||Ne.username||"Unknown",role:Ne.role}),xt.add(Ne.id))},fi=Ne=>{!Ne||xt.has(Ne.id)||(_t.push({id:Ne.id,name:Ne.name||"Unknown Artist",role:"artist_entity"}),xt.add(Ne.id))};return Gt(d.organizer),Gt(d.venue),d.event_artists?.forEach(Ne=>fi(Ne.artist)),_t},[d]),hi=ie.useMemo(()=>{if(!d)return"Event";const _t=d.event_artists?.find(Gt=>Gt.artist)?.artist;return _t?_t.name:(d.organizer&&d.organizer.role!=="venue"?d.organizer.display_name||d.organizer.username:null)||d.name},[d]),xs=ie.useMemo(()=>{if(!d)return null;const _t=d.venue_place?.name||d.venue?.display_name||d.venue?.username||d.address||"Venue TBA",xt=new Date(d.starts_at).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return S.jsxs("span",{className:"flex flex-wrap items-center gap-2",children:[d.venue_place?S.jsx("button",{type:"button",className:"font-semibold text-white",onClick:()=>t.push(`/tabs/venue/${d.venue_place?.id}`),children:_t}):S.jsx("span",{className:"font-semibold text-white",children:_t}),S.jsx("span",{className:"text-white/50",children:""}),S.jsx("span",{className:"text-white/80",children:xt})]})},[d,t]),Pn=ie.useMemo(()=>d?new Date(d.starts_at):null,[d]),Zn=ie.useMemo(()=>d?.ends_at?new Date(d.ends_at):null,[d]),rn=(_t,xt)=>{xt==="artist_entity"?t.push(`/tabs/artist/${_t}`):t.push(`/profile/${_t}`)},we=!!(l&&(Hn||Cn)),te=()=>{Xi.current?.click()},G=()=>{if(Le(""),rt(""),!l){t.push("/welcome");return}if(!d){Le("Event not found.");return}if(!we){ei(!0);return}te()},oe=async _t=>{const xt=Array.from(_t.target.files||[]);if(!xt.length)return;const Gt=await WR(xt);Be(fi=>[...fi,...Gt]),et(!0),_t.target.value=""},ve=(_t,xt)=>{const Gt=FR(xt);Be(fi=>fi.map(Ne=>Ne.id===_t?{...Ne,manualValue:xt,captureAt:Gt,captureSource:xt?"manual":null}:Ne))},je=_t=>{Be(xt=>xt.map(Gt=>Gt.id===_t?{...Gt,manualValue:"",captureAt:null,captureSource:null}:Gt))},ze=_t=>{Be(xt=>{const Gt=xt.find(fi=>fi.id===_t);return Gt&&URL.revokeObjectURL(Gt.previewUrl),xt.filter(fi=>fi.id!==_t)})},Ve=async()=>{if(Le(""),rt(""),!l){Le("Sign in to upload moments.");return}if(!d){Le("Event not found.");return}if(Tt.length===0){Le("Select at least one photo or video.");return}ut(!0),ot({current:0,total:Tt.length});try{for(let _t=0;_t<Tt.length;_t+=1){const xt=Tt[_t];ot({current:_t+1,total:Tt.length});const Gt=xt.mediaType==="video",fi=xt.file.name.split(".").pop()||(Gt?"mp4":"jpg"),zt=`${Gt?"videos":"images"}/${l.id}/${d.id}/${Date.now()}-${xt.id}.${fi}`,{error:Kt}=await Rt.storage.from("media").upload(zt,xt.file,{cacheControl:"3600",upsert:!1});if(Kt)throw Kt;const{data:Zi}=Rt.storage.from("media").getPublicUrl(zt),vi=_&&y?y.subject_id:f?.subject_id,{error:mn}=await Rt.from("posts").insert({user_id:l.id,actor_subject_id:vi,event_id:d.id,media_url:Zi.publicUrl,media_type:xt.mediaType,captured_at:xt.captureAt?xt.captureAt.toISOString():null,capture_source:xt.captureSource});if(mn)throw mn}rt("Moments uploaded!"),VS(`posts:count:user:${l.id}:event:${d.id}`),Be(_t=>(_t.forEach(xt=>URL.revokeObjectURL(xt.previewUrl)),[])),et(!1),Un(),bn(pi)}catch(_t){Le(_t?.message||"Upload failed. Try again.")}finally{ut(!1)}},he=async()=>{if(!(!l||!d)){Rn(""),it(!0);try{const _t=_&&y?y.subject_id:f?.subject_id;if(gi){const{error:xt}=await Rt.from("event_saves").delete().eq("event_id",d.id).eq(_t?"subject_id":"user_id",_t||l.id);if(xt)throw xt;Vi(!1)}else{const{error:xt}=await Rt.from("event_saves").insert({event_id:d.id,user_id:l.id,subject_id:_t||null});if(xt)throw xt;Vi(!0)}}catch(_t){Rn(_t?.message||"Could not update follow state.")}finally{it(!1)}}},Ge=async(_t,xt)=>{if(!l||!d)return!1;Rn(""),mi(!0);try{const Gt=_&&y?y.subject_id:f?.subject_id;if(!xt?.force&&Cn===_t){const{error:Ne}=await Rt.from("event_attendance").delete().eq("event_id",d.id).eq(Gt?"subject_id":"user_id",Gt||l.id);if(Ne)throw Ne;return Mn(null),!0}const{error:fi}=await Rt.from("event_attendance").upsert({event_id:d.id,user_id:l.id,subject_id:Gt||null,status:_t},{onConflict:"event_id,user_id"});if(fi)throw fi;return Mn(_t),!0}catch(Gt){return Rn(Gt?.message||"Could not update attendance."),!1}finally{mi(!1)}},at=async()=>{if(!l){t.push("/welcome");return}await Ge("attended",{force:!0})&&(ei(!1),te())},Ke=d?`${window.location.origin}/event/${d.id}${d.qr_token?`?token=${d.qr_token}`:""}`:"",st=new Date,Qt=Pn?Zn?st>Zn:st.getTime()>Pn.getTime()+360*60*1e3:!1,si=Qt?"attended":"going",Bt=Qt?"I went":"I'm here",Ct=Cn===si,ni=()=>{if(!l){t.push("/welcome");return}he()},yi=()=>{if(!l){t.push("/welcome");return}Ge(si)},Ri=()=>{if(le.length>lt+1){Ye(_t=>_t+1);return}Fe+1<Q.length&&(He(_t=>_t+1),Ye(0))};return S.jsx(nr,{children:S.jsxs(vs,{fullscreen:!0,children:[S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),j&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})}),!j&&N&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:N})}),!j&&d&&S.jsxs(S.Fragment,{children:[is&&S.jsx("div",{className:"px-4 pt-4",children:S.jsxs("div",{className:"bg-black/70 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Relive last night"}),S.jsx("p",{className:"mt-2 font-display text-lg font-bold text-white",children:"Add your moments"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Share what you lived before the memory fades."}),S.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center bg-[#ff6b4a] px-4 py-2 text-sm font-semibold text-white",onClick:G,children:"Add your moments"}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>sn(!1),children:"Not now"})]})]})}),S.jsx(XR,{title:hi,meta:xs,entities:Dn,onSelectEntity:rn,coverImageUrl:d.cover_image_url??void 0,actions:S.jsxs(S.Fragment,{children:[S.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.22em] transition-colors ${gi?"text-app-accent":"text-white/70 hover:text-white"}`,onClick:ni,disabled:$n,"aria-pressed":gi,children:[gi?S.jsx(JP,{className:"h-4 w-4"}):S.jsx(Nx,{className:"h-4 w-4"}),S.jsx("span",{children:"Like"})]}),S.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.22em] transition-colors ${Ct?"text-app-accent":"text-white/70 hover:text-white"}`,onClick:yi,disabled:Si,"aria-pressed":Ct,children:[S.jsx(QP,{className:"h-4 w-4"}),S.jsx("span",{children:Bt})]})]})}),S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white",onClick:G,children:"Add your moments"}),l&&!we&&S.jsx("p",{className:"text-xs text-white/55",children:"Mark I went to unlock uploads."})]}),En&&S.jsx("p",{className:"text-sm text-rose-400",children:En}),re&&S.jsx("p",{className:"text-sm text-rose-400",children:re}),be.length>0&&S.jsxs("div",{className:"bg-white/5 p-4",children:[S.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Official setlist"}),S.jsx("div",{className:"mt-3 flex flex-col gap-2",children:be.map(_t=>S.jsx("div",{className:"flex items-center justify-between text-xs",children:S.jsxs("span",{className:"text-white/80",children:[S.jsxs("span",{className:"mr-2 text-white/45",children:[_t.ordinal,"."]}),_t.song_title||"Unknown Song"]})},_t.ordinal))})]}),S.jsx(iD,{buckets:Q,selectedBucketIndex:Fe,selectedMomentIndex:lt,moments:le,loading:Me||J&&le.length===0,totalMoments:Wi,eventStart:Pn,mediaFilter:pi,onSelectBucket:_t=>{He(_t),Ye(0)},onSelectMoment:_t=>Ye(_t),onAddMoments:G,onFilterChange:zi,autoAdvance:pi==="video",onRequestNext:Ri})]})]})]}),S.jsx($m,{isOpen:Mt,onDidDismiss:()=>et(!1),children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Add moments"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>et(!1),disabled:ct,children:"Close"})]}),Tt.length===0&&S.jsx("p",{className:"text-sm text-white/55",children:"Select photos or videos to add moments."}),Tt.map(_t=>S.jsxs("div",{className:"mt-4 space-y-3 bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx("div",{className:"h-20 w-20 overflow-hidden bg-black",children:_t.mediaType==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:_t.previewUrl})}):S.jsx("img",{src:_t.previewUrl,alt:_t.file.name,className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"flex-1 space-y-1",children:[S.jsx("p",{className:"text-sm font-semibold text-white",children:_t.file.name}),S.jsx("p",{className:"text-xs text-white/55",children:_t.captureAt?_t.captureAt.toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Upload time"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>ze(_t.id),children:"Remove"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Captured time"}),S.jsx("input",{type:"datetime-local",className:"w-full bg-white/10 px-4 py-3 text-sm text-white/85 focus:outline-none",value:_t.manualValue,onChange:xt=>ve(_t.id,xt.target.value)})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>je(_t.id),children:"Use upload time"})]},_t.id)),xe&&S.jsx("p",{className:"text-sm text-rose-400",children:xe}),tt&&S.jsx("p",{className:"text-sm text-emerald-400",children:tt}),ct&&S.jsxs("p",{className:"text-xs text-white/55",children:["Uploading ",Et.current,"/",Et.total]}),S.jsx("button",{type:"button",className:"mt-4 inline-flex w-full items-center justify-center bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:Ve,disabled:ct||Tt.length===0,children:ct?"Uploading...":"Upload moments"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:te,disabled:ct,children:"Add more"})]})})}),S.jsx($m,{isOpen:Ot,onDidDismiss:()=>ei(!1),initialBreakpoint:.45,breakpoints:[0,.45,.7],className:"gate-sheet",children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Unlock moments"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>ei(!1),disabled:Si,children:"Close"})]}),S.jsx("p",{className:"text-sm text-white/55",children:'Mark "I went" to add moments for this event.'}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:at,disabled:Si,children:Si?"Marking...":"Mark I went"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-3 text-sm font-semibold text-white/70 disabled:cursor-not-allowed disabled:opacity-60",onClick:()=>ei(!1),disabled:Si,children:"Not now"})]})})}),S.jsx(nD,{isOpen:gt,onClose:()=>Pt(!1),link:Ke}),S.jsx("input",{ref:Xi,type:"file",accept:"image/*,video/*",multiple:!0,onChange:oe,className:"hidden"})]})})},rD=()=>{const t=Ur(),{id:e}=eg(),{user:r,profile:l}=va(),[f,_]=ie.useState(null),[y,d]=ie.useState([]),[A,j]=ie.useState([]),[B,N]=ie.useState([]),[V,Q]=ie.useState(!0),[ne,J]=ie.useState(""),[ye,re]=ie.useState(!1),[ge,le]=ie.useState(!1),[me,be]=ie.useState(0);ie.useEffect(()=>{(async()=>{Q(!0),J("");try{const{data:Fe,error:He}=await Rt.from("profiles").select("*").eq("id",e).single();if(He||!Fe)throw He;if(_(Fe),Fe.subject_id){const[et,Tt]=await Promise.all([pu.getFollowersCount(Fe.subject_id),r&&l?.subject_id?pu.isFollowing(l.subject_id,Fe.subject_id):Promise.resolve(!1)]);be(et),re(Tt)}const lt=`
          *,
          organizer:profiles!events_organizer_id_fkey (
            id,
            username,
            display_name,
            role
          ),
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `;let Ye=[],Mt=[];if(Fe.role==="artist"){const{data:et}=await Rt.from("event_artists").select("event_id").eq("artist_entity_id",e);if(Ye=(et||[]).map(Tt=>Tt.event_id),Ye.length>0){const{data:Tt}=await Rt.from("events").select(lt).in("id",Ye).order("starts_at",{ascending:!1});Mt=Tt||[]}}else if(Fe.role==="venue"){const{data:et}=await Rt.from("venue_places").select("*").eq("created_by",e).order("name",{ascending:!0}),Tt=et||[];d(Tt);const Be=Tt.map(ct=>ct.id).filter(Boolean);if(Be.length>0){const{data:ct}=await Rt.from("events").select(lt).in("venue_place_id",Be).order("starts_at",{ascending:!1});Mt=ct||[],Ye=Mt.map(ut=>ut.id)}else Mt=[],Ye=[]}else if(Fe.role==="label"){const{data:et}=await Rt.from("events").select(lt).eq("organizer_id",e).order("starts_at",{ascending:!1});Mt=et||[],Ye=Mt.map(Tt=>Tt.id)}if(j(Mt),Ye.length>0){const{data:et}=await Rt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",Ye).order("created_at",{ascending:!1}).limit(18);N(et||[])}else N([])}catch{J("Profile not found.")}finally{Q(!1)}})()},[e,r,l?.subject_id]);const ke=async()=>{if(!r||!l?.subject_id||!f?.subject_id){r||t.push("/welcome");return}le(!0);try{ye?(await pu.unfollow(l.subject_id,f.subject_id),re(!1),be(Ue=>Math.max(0,Ue-1))):(await pu.follow(l.subject_id,f.subject_id),re(!0),be(Ue=>Ue+1))}catch(Ue){console.error("Failed to toggle follow",Ue)}finally{le(!1)}},Me=ie.useMemo(()=>{const Ue=f?.external_links||{};return Object.entries(Ue).map(([Fe,He])=>({key:Fe,value:He})).filter(Fe=>!!Fe.value)},[f]);return S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),V&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})}),!V&&ne&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:ne})}),!V&&f&&S.jsxs(S.Fragment,{children:[S.jsxs("section",{className:"relative h-[340px] w-full overflow-hidden bg-black",children:[f.avatar_url?S.jsx("img",{src:f.avatar_url,alt:f.display_name||"Profile",className:"absolute inset-0 h-full w-full object-cover"}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:f.role.toUpperCase()}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:f.display_name||f.username||"Unknown"}),f.primary_city&&S.jsx("p",{className:"mt-2 text-sm text-white/70",children:f.primary_city}),S.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:[me," followers"]}),r&&f.id!==r.id&&S.jsx("button",{type:"button",disabled:ge,onClick:ke,className:`px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${ye?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:ge?S.jsx(Ys,{name:"crescent"}):ye?"Following":"Follow"})]})]})]}),S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[f.bio&&S.jsx("p",{className:"text-sm text-white/70",children:f.bio}),Me.length>0&&S.jsxs("section",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Links"}),S.jsx("div",{className:"space-y-2 text-sm",children:Me.map(Ue=>S.jsx("a",{href:Ue.value,target:"_blank",rel:"noreferrer",className:"block text-white/70 hover:text-white",children:Ue.value.replace(/^https?:\/\//,"")},Ue.key))})]}),f.role==="venue"&&y.length>0&&S.jsxs("section",{className:"space-y-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venues"}),S.jsx("div",{className:"space-y-6",children:y.map(Ue=>S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"font-display text-lg font-bold text-white",children:Ue.name}),S.jsx("p",{className:"text-sm text-white/70",children:Ue.address||Ue.city}),(Ue.venue_type||Ue.capacity)&&S.jsxs("p",{className:"text-xs text-white/55",children:[Ue.venue_type||"Venue",Ue.capacity?`  ${Ue.capacity} cap`:""]})]}),Ue.website_url&&S.jsx("a",{href:Ue.website_url,target:"_blank",rel:"noreferrer",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:Ue.website_url.replace(/^https?:\/\//,"")}),(Ue.photos||[]).length>0&&S.jsx("div",{className:"-mx-4 flex gap-2 overflow-x-auto pb-1",children:Ue.photos.slice(0,8).map((Fe,He)=>S.jsx("div",{className:"h-28 w-44 flex-shrink-0 overflow-hidden bg-white/5",children:S.jsx("img",{src:Fe,alt:"Venue",className:"h-full w-full object-cover"})},`${Fe}-${He}`))})]},Ue.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Events"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Shows connected to this profile."})]}),A.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No events yet."}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:A.map(Ue=>S.jsx(ec,{event:Ue,className:"w-full",onSelect:Fe=>t.push(`/event/${Fe.id}`)},Ue.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Latest media from connected events."})]}),B.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No moments yet."}):S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:B.map(Ue=>S.jsx("button",{type:"button",onClick:()=>t.push(`/post/${Ue.id}`),className:"aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:Ue.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:Ue.media_url})}):S.jsx("img",{src:Ue.media_url,alt:Ue.caption||"Moment",className:"h-full w-full object-cover"})},Ue.id))})]}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>t.goBack(),children:"Back"})]})]})]})})})},aD=()=>{const{id:t}=eg(),e=Ur(),[r,l]=ie.useState(null),[f,_]=ie.useState(!0),[y,d]=ie.useState(""),A=r?.events??null;return ie.useEffect(()=>{(async()=>{_(!0),d("");try{const{data:B,error:N}=await Rt.from("posts").select(`
            id,
            media_url,
            media_type,
            thumbnail_url,
            caption,
            created_at,
            profiles:profiles!posts_user_id_fkey (
              id,
              username,
              display_name,
              avatar_url
            ),
            events:events!posts_event_id_fkey (
              id,
              name,
              city,
              starts_at,
              cover_image_url,
              address,
              venue_place:venue_places!events_venue_place_id_fkey (
                id,
                name,
                city,
                address
              )
            )
          `).eq("id",t).single();if(N||!B)throw N;l(B)}catch{d("Post not found."),l(null)}finally{_(!1)}})()},[t]),S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),f&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})}),!f&&y&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:y})}),!f&&r&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[r.media_type==="video"?S.jsx("video",{controls:!0,playsInline:!0,className:"absolute inset-0 h-full w-full object-cover",poster:r.thumbnail_url||r.events?.cover_image_url||void 0,children:S.jsx("source",{src:r.media_url})}):S.jsx("img",{src:r.media_url,alt:r.caption||"Moment",className:"absolute inset-0 h-full w-full object-cover"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moment"}),S.jsx("h2",{className:"mt-2 font-display text-2xl font-bold text-white",children:r.caption||"Relive the moment"}),S.jsxs("p",{className:"mt-2 text-sm text-white/70",children:[(r.profiles?.username?`@${r.profiles.username}`:r.profiles?.display_name)||"Anonymous","  ",new Date(r.created_at).toLocaleString()]})]})]}),S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("div",{className:"flex gap-2",children:[S.jsxs("button",{type:"button",className:"inline-flex flex-1 items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",children:[S.jsx(Nx,{className:"h-4 w-4"}),"Like"]}),S.jsxs("button",{type:"button",className:"inline-flex flex-1 items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",children:[S.jsx(ES,{className:"h-4 w-4"}),"Share"]})]}),A&&S.jsxs("button",{type:"button",onClick:()=>e.push(`/event/${A.id}`),className:"bg-white/5 p-4 text-left",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Event"}),S.jsx("p",{className:"mt-2 font-display text-lg font-bold text-white",children:A.name}),S.jsxs("p",{className:"mt-1 text-sm text-white/70",children:[A.venue_place?.name||A.address||"Venue","  ",new Date(A.starts_at).toLocaleString()]}),S.jsx("p",{className:"mt-2 text-xs text-white/55",children:"View event details"})]})]})]})]})})})},oD=()=>{const{id:t}=eg(),e=Ur(),{user:r,profile:l}=va(),[f,_]=ie.useState(null),[y,d]=ie.useState([]),[A,j]=ie.useState([]),[B,N]=ie.useState(!0),[V,Q]=ie.useState(""),[ne,J]=ie.useState(!1),[ye,re]=ie.useState(!1),[ge,le]=ie.useState(0);ie.useEffect(()=>{(async()=>{N(!0),Q("");try{const{data:Me,error:Ue}=await Rt.from("venue_places").select("*").eq("id",t).single();if(Ue||!Me)throw Ue;let Fe=null;try{const{data:Mt,error:et}=await Rt.rpc("get_or_create_venue_subject",{p_venue_place_id:Me.id});!et&&typeof Mt=="string"&&(Fe=Mt)}catch{}const{data:He,error:lt}=await Rt.from("events").select(`
            *,
            organizer:profiles!events_organizer_id_fkey (
              id,
              username,
              display_name,
              role
            ),
            venue_place:venue_places!events_venue_place_id_fkey (
              id,
              name,
              city,
              address,
              latitude,
              longitude
            ),
            event_artists (
              artist:artists!event_artists_artist_entity_fk (
                id,
                name,
                avatar_url
              )
            )
          `).eq("venue_place_id",t).order("starts_at",{ascending:!1});if(lt)throw lt;if(_({...Me,subject_id:Fe}),d(He||[]),Fe){const[Mt,et]=await Promise.all([pu.getFollowersCount(Fe),r&&l?.subject_id?pu.isFollowing(l.subject_id,Fe):Promise.resolve(!1)]);le(Mt),J(et)}const Ye=(He||[]).map(Mt=>Mt.id);if(Ye.length>0){const{data:Mt}=await Rt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",Ye).order("created_at",{ascending:!1}).limit(18);j(Mt||[])}else j([])}catch{Q("Venue not found."),_(null),d([]),j([])}finally{N(!1)}})()},[t,r,l?.subject_id]);const me=async()=>{if(!r||!l?.subject_id||!f?.subject_id){r||e.push("/welcome");return}re(!0);try{ne?(await pu.unfollow(l.subject_id,f.subject_id),J(!1),le(ke=>Math.max(0,ke-1))):(await pu.follow(l.subject_id,f.subject_id),J(!0),le(ke=>ke+1))}catch(ke){console.error("Failed to toggle follow",ke)}finally{re(!1)}},be=ie.useMemo(()=>f?f.address&&f.city?`${f.address}  ${f.city}`:f.address||f.city||"":"",[f]);return S.jsx(nr,{children:S.jsx(vs,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full",children:[S.jsx(ao,{}),B&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ys,{name:"crescent"})}),!B&&V&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:V})}),!B&&f&&S.jsxs(S.Fragment,{children:[S.jsxs("section",{className:"relative h-[340px] w-full overflow-hidden bg-black",children:[(f.photos||[])[0]?S.jsx("img",{src:(f.photos||[])[0],alt:f.name,className:"absolute inset-0 h-full w-full object-cover"}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venue"}),S.jsx("h1",{className:"mt-2 font-display text-3xl font-bold text-white",children:f.name}),be&&S.jsx("p",{className:"mt-2 text-sm text-white/70",children:be}),S.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:[ge," followers"]}),r&&S.jsx("button",{type:"button",disabled:ye,onClick:me,className:`px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${ne?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:ye?S.jsx(Ys,{name:"crescent"}):ne?"Following":"Follow"})]})]})]}),S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[(f.photos||[]).length>1&&S.jsx("section",{className:"-mx-4 flex gap-2 overflow-x-auto pb-1",children:(f.photos||[]).slice(1,8).map((ke,Me)=>S.jsx("div",{className:"h-36 w-52 flex-shrink-0 overflow-hidden bg-white/5",children:S.jsx("img",{src:ke,alt:`Venue ${f.name}`,className:"h-full w-full object-cover"})},`${ke}-${Me}`))}),(f.venue_type||f.capacity)&&S.jsxs("p",{className:"text-xs text-white/55",children:[f.venue_type||"Venue",f.capacity?`  ${f.capacity} cap`:""]}),f.website_url&&S.jsx("a",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",href:f.website_url,target:"_blank",rel:"noreferrer",children:f.website_url.replace(/^https?:\/\//,"")}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Events"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"All shows hosted here."})]}),y.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No events here yet."}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:y.map(ke=>S.jsx(ec,{event:ke,className:"w-full",onSelect:Me=>e.push(`/event/${Me.id}`)},ke.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Latest media from this room."})]}),A.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No memories here yet."}):S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:A.map(ke=>S.jsx("button",{type:"button",onClick:()=>e.push(`/post/${ke.id}`),className:"aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:ke.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:ke.media_url})}):S.jsx("img",{src:ke.media_url,alt:ke.caption||"Moment",className:"h-full w-full object-cover"})},ke.id))})]}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>e.goBack(),children:"Back"})]})]})]})})})},lD=[{key:"grant",label:"Grant Access",href:"/admin/grants"},{key:"artist",label:"Create Artist",href:"/admin/create-artist"},{key:"venue",label:"Create Venue",href:"/admin/create-venue"},{key:"list",label:"View Access Grants",href:"/admin/access-grants"}],y_=({active:t})=>S.jsx("div",{className:"grid gap-3 rounded-2xl border border-white/10 bg-white/5 p-3 sm:grid-cols-2",children:lD.map(e=>{const r=e.key===t;return S.jsx("a",{href:e.href,className:`flex min-h-[72px] items-center justify-center rounded-xl border px-4 py-3 text-base font-semibold uppercase tracking-[0.12em] transition ${r?"border-app-ink bg-app-ink text-white shadow-lg shadow-app-ink/30":"border-white/10 bg-white/5 text-app-light/80 hover:border-app-ink/40 hover:text-white"}`,children:e.label},e.key)})}),cD=()=>{const{profile:t}=va(),[e,r]=ie.useState(!1),[l,f]=ie.useState(null),[_,y]=ie.useState(""),[d,A]=ie.useState([]),[j,B]=ie.useState(null),[N,V]=ie.useState(""),[Q,ne]=ie.useState("artist"),[J,ye]=ie.useState([]),[re,ge]=ie.useState(null);ie.useEffect(()=>{_.length>2?Cm.searchProfiles(_).then(A):A([])},[_]),ie.useEffect(()=>{N.length>2?Q==="artist"?Cm.searchArtists(N).then(ye):Cm.searchVenues(N).then(ye):ye([])},[N,Q]);const le=async()=>{if(!(!j||!re)){r(!0),f(null);try{await Cm.adminGrantEntityAccess(j.id,Q,re.id,"admin"),f({type:"success",text:"Access granted successfully"}),B(null),ge(null),y(""),V("")}catch(me){f({type:"error",text:me.message||"Failed to grant access"})}finally{r(!1)}}};return t?.role!=="admin"?S.jsx(nr,{children:S.jsx(vs,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsxs(nr,{children:[S.jsx(ao,{title:"Admin Grants",showBack:!0}),S.jsx(vs,{className:"ion-padding",children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-10 py-6",children:[S.jsx(y_,{active:"grant"}),S.jsxs("section",{className:"space-y-3 rounded-2xl border border-white/10 bg-white/5 p-4",children:[S.jsx("div",{className:"flex items-center justify-between",children:S.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider text-app-light/70",children:"Grant Access"})}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Grant a user access to manage an artist or venue."}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wider text-app-light/50",children:"Find User"}),S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:"Search by username or display name...",value:_,onChange:me=>y(me.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),d.length>0&&!j&&S.jsx("div",{className:"absolute top-full z-10 mt-1 w-full overflow-hidden rounded-xl border border-white/10 bg-[#1A1D25] shadow-xl",children:d.map(me=>S.jsxs("button",{onClick:()=>{B(me),y(me.username||me.display_name)},className:"flex w-full items-center gap-3 p-3 text-left hover:bg-white/5",children:[me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-app-ink/20 text-xs font-bold text-app-ink",children:me.username?.[0]?.toUpperCase()||"?"}),S.jsxs("div",{children:[S.jsx("div",{className:"font-medium text-app-light",children:me.username}),S.jsx("div",{className:"text-xs text-app-light/50",children:me.display_name})]})]},me.id))})]}),j&&S.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-app-ink/10 p-3",children:[S.jsxs("span",{className:"text-sm text-app-ink",children:["Selected: ",S.jsx("strong",{children:j.username})]}),S.jsx("button",{onClick:()=>B(null),className:"text-xs text-app-ink hover:underline",children:"Clear"})]})]}),S.jsxs("div",{className:"space-y-3 pt-2",children:[S.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wider text-app-light/50",children:"Select Entity"}),S.jsxs("div",{className:"flex gap-2 rounded-xl bg-white/5 p-1",children:[S.jsx("button",{onClick:()=>{ne("artist"),ge(null),V("")},className:`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${Q==="artist"?"bg-app-ink text-white":"text-app-light/60 hover:text-app-light"}`,children:"Artist"}),S.jsx("button",{onClick:()=>{ne("venue"),ge(null),V("")},className:`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${Q==="venue"?"bg-app-ink text-white":"text-app-light/60 hover:text-app-light"}`,children:"Venue"})]}),S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:`Search for ${Q}...`,value:N,onChange:me=>V(me.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),J.length>0&&!re&&S.jsx("div",{className:"absolute top-full z-10 mt-1 w-full overflow-hidden rounded-xl border border-white/10 bg-[#1A1D25] shadow-xl",children:J.map(me=>S.jsxs("button",{onClick:()=>{ge(me),V(me.name)},className:"flex w-full items-center gap-3 p-3 text-left hover:bg-white/5",children:[me.image_url?S.jsx("img",{src:me.image_url,alt:"",className:"h-8 w-8 rounded-lg object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-white/10 text-xs font-bold text-app-light/40",children:me.name[0]}),S.jsxs("div",{children:[S.jsx("div",{className:"font-medium text-app-light",children:me.name}),me.city&&S.jsx("div",{className:"text-xs text-app-light/50",children:me.city})]})]},me.id))})]}),re&&S.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-app-ink/10 p-3",children:[S.jsxs("span",{className:"text-sm text-app-ink",children:["Selected: ",S.jsx("strong",{children:re.name})]}),S.jsx("button",{onClick:()=>ge(null),className:"text-xs text-app-ink hover:underline",children:"Clear"})]})]}),S.jsxs("div",{className:"pt-4",children:[l&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${l.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:l.text}),S.jsx("button",{disabled:!j||!re||e,onClick:le,className:"flex w-full items-center justify-center rounded-2xl bg-app-ink py-4 font-bold text-white shadow-lg shadow-app-ink/20 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:e?S.jsx(Ys,{name:"crescent",color:"light"}):"Grant Access"})]})]})]})})]})},uD={async createArtist(t){const{data:e,error:r}=await Rt.from("artists").insert(t).select().single();if(r)throw r;const{data:l,error:f}=await Rt.rpc("get_or_create_artist_subject",{p_artist_id:e.id});if(f)throw f;return{...e,subject_id:l}},async getArtistBySubject(t){const{data:e,error:r}=await Rt.from("v_subject_artists").select("*").eq("subject_id",t).maybeSingle();if(r)throw r;return e},async updateArtist(t,e){const{data:r,error:l}=await Rt.from("artists").update(e).eq("id",t).select().single();if(l)throw l;return r}},hD=()=>{const{profile:t}=va(),[e,r]=ie.useState(""),[l,f]=ie.useState(""),[_,y]=ie.useState("solo"),[d,A]=ie.useState(""),[j,B]=ie.useState(""),[N,V]=ie.useState(!1),[Q,ne]=ie.useState(null),J=async()=>{if(!e.trim()){ne({type:"error",text:"Artist name is required"});return}V(!0),ne(null);try{const ye=d.split(",").map(re=>re.trim()).filter(Boolean);await uD.createArtist({name:e.trim(),artist_type:_,city:l.trim()||null,bio:null,avatar_url:j.trim()||null,genres:ye,external_links:{}}),ne({type:"success",text:"Artist created successfully"}),r(""),f(""),A(""),B(""),y("solo")}catch(ye){ne({type:"error",text:ye.message||"Failed to create artist"})}finally{V(!1)}};return t?.role!=="admin"?S.jsx(nr,{children:S.jsx(vs,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsxs(nr,{children:[S.jsx(ao,{title:"Create Artist",showBack:!0}),S.jsx(vs,{className:"ion-padding",children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-6 py-6",children:[S.jsx(y_,{active:"artist"}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Create an artist entity so you can publish and assign access."}),S.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[S.jsx("input",{type:"text",placeholder:"Artist name *",value:e,onChange:ye=>r(ye.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"City",value:l,onChange:ye=>f(ye.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsxs("select",{value:_,onChange:ye=>y(ye.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50",children:[S.jsx("option",{value:"solo",children:"Solo"}),S.jsx("option",{value:"band",children:"Band"})]}),S.jsx("input",{type:"text",placeholder:"Avatar URL",value:j,onChange:ye=>B(ye.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Genres (comma separated)",value:d,onChange:ye=>A(ye.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"})]}),S.jsxs("div",{className:"pt-2",children:[Q&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${Q.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:Q.text}),S.jsx("button",{disabled:N,onClick:J,className:"flex w-full items-center justify-center rounded-2xl bg-white/10 py-4 font-bold text-app-light shadow-lg shadow-white/10 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:N?S.jsx(Ys,{name:"crescent",color:"light"}):"Create Artist"})]})]})})]})},dD={async createVenue(t){const{data:e,error:r}=await Rt.from("venue_places").insert(t).select().single();if(r)throw r;const{data:l,error:f}=await Rt.rpc("get_or_create_venue_subject",{p_venue_place_id:e.id});if(f)throw f;return{...e,subject_id:l}},async getVenueBySubject(t){const{data:e,error:r}=await Rt.from("v_subject_venues").select("*").eq("subject_id",t).maybeSingle();if(r)throw r;return e},async updateVenue(t,e){const{data:r,error:l}=await Rt.from("venue_places").update(e).eq("id",t).select().single();if(l)throw l;return r}},fD=()=>{const{profile:t}=va(),[e,r]=ie.useState(""),[l,f]=ie.useState(""),[_,y]=ie.useState(""),[d,A]=ie.useState(""),[j,B]=ie.useState(""),[N,V]=ie.useState(""),[Q,ne]=ie.useState(!1),[J,ye]=ie.useState(null),re=async()=>{if(!e.trim()||!l.trim()){ye({type:"error",text:"Venue name and city are required"});return}ne(!0),ye(null);try{const ge=N?Number(N):null;await dD.createVenue({name:e.trim(),city:l.trim(),address:d.trim()||null,capacity:Number.isNaN(ge)?null:ge,venue_type:_.trim()||null,latitude:null,longitude:null,website_url:j.trim()||null,photos:[],created_by:t?.id??null}),ye({type:"success",text:"Venue created successfully"}),r(""),f(""),A(""),B(""),V(""),y("")}catch(ge){ye({type:"error",text:ge.message||"Failed to create venue"})}finally{ne(!1)}};return t?.role!=="admin"?S.jsx(nr,{children:S.jsx(vs,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsxs(nr,{children:[S.jsx(ao,{title:"Create Venue",showBack:!0}),S.jsx(vs,{className:"ion-padding",children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-6 py-6",children:[S.jsx(y_,{active:"venue"}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Create a venue entity to manage events and content."}),S.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[S.jsx("input",{type:"text",placeholder:"Venue name *",value:e,onChange:ge=>r(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"City *",value:l,onChange:ge=>f(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Type (club, theatre...)",value:_,onChange:ge=>y(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Website",value:j,onChange:ge=>B(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Address",value:d,onChange:ge=>A(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"}),S.jsx("input",{type:"number",placeholder:"Capacity",value:N,onChange:ge=>V(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"})]}),S.jsxs("div",{className:"pt-2",children:[J&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${J.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:J.text}),S.jsx("button",{disabled:Q,onClick:re,className:"flex w-full items-center justify-center rounded-2xl bg-white/10 py-4 font-bold text-app-light shadow-lg shadow-white/10 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:Q?S.jsx(Ys,{name:"crescent",color:"light"}):"Create Venue"})]})]})})]})},pD=()=>{const{profile:t}=va(),[e,r]=ie.useState(!0),[l,f]=ie.useState(null),[_,y]=ie.useState([]);if(ie.useEffect(()=>{const j=async()=>{r(!0),f(null);try{const{data:B,error:N}=await Rt.from("entity_members").select(`
            admin_subject_id,
            entity_subject_id,
            role,
            created_at,
            admin:admin_subject_id (
              profile:profile_id (
                id,
                username,
                display_name,
                avatar_url
              )
            ),
            entity:entity_subject_id (
              type,
              profile:profile_id (
                username,
                display_name
              ),
              venue_place:venue_place_id (
                name,
                city
              ),
              artist:artist_id (
                name,
                city
              )
            )
          `).order("created_at",{ascending:!1});if(N)throw N;y(B)}catch(B){f(B.message||"Failed to load access grants")}finally{r(!1)}};t?.role==="admin"&&j()},[t]),t?.role!=="admin")return S.jsx(nr,{children:S.jsx(vs,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})});const d=j=>j.entity?j.entity.type==="artist"&&j.entity.artist?j.entity.artist.name:j.entity.type==="venue"&&j.entity.venue_place?j.entity.venue_place.name:j.entity.profile&&(j.entity.profile.display_name||j.entity.profile.username)||j.entity_subject_id:j.entity_subject_id,A=j=>j.entity?j.entity.type==="artist"&&j.entity.artist?.city?j.entity.artist.city:j.entity.type==="venue"&&j.entity.venue_place?.city?j.entity.venue_place.city:"":"";return S.jsxs(nr,{children:[S.jsx(ao,{title:"Access Grants",showBack:!0}),S.jsx(vs,{className:"ion-padding",children:S.jsxs("div",{className:"mx-auto max-w-3xl space-y-8 py-6",children:[S.jsx(y_,{active:"list"}),S.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wider text-app-light/70",children:"Granted Accesses"}),e&&S.jsx(Ys,{name:"crescent",color:"light"})]}),l&&S.jsx("div",{className:"mt-3 rounded-xl bg-red-500/10 p-3 text-sm text-red-300",children:l}),!e&&!l&&_.length===0&&S.jsx("div",{className:"mt-3 rounded-xl border border-white/10 bg-white/5 p-4 text-sm text-app-light/70",children:"No access grants found."}),S.jsx("div",{className:"mt-4 space-y-3",children:_.map(j=>S.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-white/10 bg-black/20 p-3",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"h-10 w-10 overflow-hidden rounded-full bg-white/10",children:j.admin?.profile?.avatar_url?S.jsx("img",{src:j.admin.profile.avatar_url,alt:"",className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-full w-full items-center justify-center text-xs font-bold text-app-light/70",children:j.admin?.profile?.username?.[0]?.toUpperCase()||"?"})}),S.jsxs("div",{children:[S.jsx("div",{className:"text-sm font-semibold text-app-light",children:j.admin?.profile?.display_name||j.admin?.profile?.username||"Unknown admin"}),S.jsx("div",{className:"text-xs uppercase tracking-widest text-app-light/50",children:j.role})]})]}),S.jsxs("div",{className:"text-right",children:[S.jsx("div",{className:"text-sm font-semibold text-app-light",children:d(j)}),S.jsxs("div",{className:"text-xs text-app-light/60",children:[j.entity?.type?j.entity.type.toUpperCase():"Entity"," ",A(j)&&` ${A(j)}`]})]})]},`${j.admin_subject_id}-${j.entity_subject_id}`))})]})]})})]})},mD=()=>{const{user:t,loading:e}=va(),{activeWorkspace:r,loading:l}=sf(),f=r?.type==="artist"&&(r.artist?.id||r.artist?.artist_id)||null,_=r?.type==="venue"&&(r.venue?.id||r.venue?.venue_place_id)||null,y=r?.type==="artist"&&f?`/tabs/artist/${f}`:r?.type==="venue"&&_?`/tabs/venue/${_}`:"/tabs/profile",d={"--background":"rgba(11, 11, 13, 0.92)","--border":"none","--color":"rgba(255, 255, 255, 0.62)","--color-selected":"#ffffff","--padding-top":"6px","--padding-bottom":"6px","--padding-start":"10px","--padding-end":"10px","--border-radius":"0px","--background-focused":"rgba(255, 107, 74, 0.16)"},A=e&&!t;return S.jsxs(uS,{children:[S.jsx(KP,{children:S.jsxs(ip,{children:[S.jsx(Ws,{exact:!0,path:"/welcome",render:()=>!e&&!t?S.jsx(WL,{}):S.jsx(kc,{to:"/tabs/events"})}),S.jsx(Ws,{exact:!0,path:"/event/:id",component:sD}),S.jsx(Ws,{exact:!0,path:"/profile/:id",component:rD}),S.jsx(Ws,{exact:!0,path:"/post/:id",component:aD}),S.jsx(Ws,{exact:!0,path:"/discover",render:()=>S.jsx(kc,{to:"/tabs/discover"})}),S.jsx(Ws,{exact:!0,path:"/artist/:id",render:({match:j})=>S.jsx(kc,{to:`/tabs/artist/${j.params.id}`})}),S.jsx(Ws,{exact:!0,path:"/venue/:id",render:({match:j})=>S.jsx(kc,{to:`/tabs/venue/${j.params.id}`})}),S.jsx(Ws,{exact:!0,path:"/admin/grants",component:cD}),S.jsx(Ws,{exact:!0,path:"/admin/create-artist",component:hD}),S.jsx(Ws,{exact:!0,path:"/admin/create-venue",component:fD}),S.jsx(Ws,{exact:!0,path:"/admin/access-grants",component:pD}),S.jsx(Ws,{exact:!0,path:"/reset",component:BR}),S.jsx(Ws,{exact:!0,path:"/create-event",component:NR}),S.jsx(Ws,{path:"/tabs",render:()=>!e&&!t?S.jsx(kc,{to:"/welcome"}):S.jsxs(qM,{children:[S.jsxs(ip,{children:[S.jsx(Ws,{exact:!0,path:"/tabs/feed",component:YL}),S.jsx(Ws,{exact:!0,path:"/tabs/map",component:sR}),S.jsx(Ws,{exact:!0,path:"/tabs/discover",component:_R}),S.jsx(Ws,{exact:!0,path:"/tabs/events",component:Bz}),S.jsx(Ws,{exact:!0,path:"/tabs/profile",render:()=>(console.log("[profile-route] workspace loading:",l,"workspace:",r),r?.type==="artist"&&f?S.jsx(kc,{to:`/tabs/artist/${f}`}):r?.type==="venue"&&_?S.jsx(kc,{to:`/tabs/venue/${_}`}):S.jsx($z,{}))}),S.jsx(Ws,{exact:!0,path:"/tabs/artist/:id",component:f2}),S.jsx(Ws,{exact:!0,path:"/tabs/venue/:id",component:oD}),S.jsx(Ws,{exact:!0,path:"/tabs",render:()=>S.jsx(kc,{to:"/tabs/events"})})]}),S.jsxs(GM,{slot:"bottom",className:"h-16 px-2 py-2",style:d,children:[S.jsxs(Hd,{tab:"events",href:"/tabs/events",children:[S.jsx(TS,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Main"})]}),S.jsxs(Hd,{tab:"discover",href:"/tabs/discover",children:[S.jsx(oj,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Discover"})]}),S.jsxs(Hd,{tab:"map",href:"/tabs/map",children:[S.jsx(h_,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Map"})]}),S.jsxs(Hd,{tab:"profile",href:y,children:[S.jsx(My,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Profile"})]})]})]})}),S.jsx(Ws,{exact:!0,path:"/",render:()=>S.jsx(kc,{to:e||t?"/tabs/events":"/welcome"})})]})}),A&&S.jsx("div",{className:"pointer-events-none fixed inset-0 z-[5000] flex items-center justify-center bg-black/35 backdrop-blur",children:S.jsx(Ys,{name:"crescent"})})]})};QM();P2.createRoot(document.getElementById("root")).render(S.jsx(VL,{children:S.jsx(HL,{children:S.jsx(mD,{})})}));export{L1 as K,Ny as a,Kd as b,hx as c,Mm as d,UT as e,Iv as f,FT as g,zv as h,Mk as i,$s as j,mu as k,wD as l,TD as m,pn as n,yD as o,gD as p,Ty as r,SD as s,zm as w};
