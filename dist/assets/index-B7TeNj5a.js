(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const _ of f)if(_.type==="childList")for(const y of _.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&l(y)}).observe(document,{childList:!0,subtree:!0});function r(f){const _={};return f.integrity&&(_.integrity=f.integrity),f.referrerPolicy&&(_.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?_.credentials="include":f.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function l(f){if(f.ep)return;f.ep=!0;const _=r(f);fetch(f.href,_)}})();function Kh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P_={exports:{}},xm={};var sb;function E2(){if(sb)return xm;sb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(l,f,_){var y=null;if(_!==void 0&&(y=""+_),f.key!==void 0&&(y=""+f.key),"key"in f){_={};for(var d in f)d!=="key"&&(_[d]=f[d])}else _=f;return f=_.ref,{$$typeof:t,type:l,key:y,ref:f!==void 0?f:null,props:_}}return xm.Fragment=e,xm.jsx=r,xm.jsxs=r,xm}var rb;function k2(){return rb||(rb=1,P_.exports=E2()),P_.exports}var S=k2(),I_={exports:{}},bm={},j_={exports:{}},L_={};var ab;function C2(){return ab||(ab=1,(function(t){function e(Be,ot){var Fe=Be.length;Be.push(ot);e:for(;0<Fe;){var kt=Fe-1>>>1,rt=Be[kt];if(0<f(rt,ot))Be[kt]=ot,Be[Fe]=rt,Fe=kt;else break e}}function r(Be){return Be.length===0?null:Be[0]}function l(Be){if(Be.length===0)return null;var ot=Be[0],Fe=Be.pop();if(Fe!==ot){Be[0]=Fe;e:for(var kt=0,rt=Be.length,be=rt>>>1;kt<be;){var Ie=2*(kt+1)-1,et=Be[Ie],at=Ie+1,mt=Be[at];if(0>f(et,Fe))at<rt&&0>f(mt,et)?(Be[kt]=mt,Be[at]=Fe,kt=at):(Be[kt]=et,Be[Ie]=Fe,kt=Ie);else if(at<rt&&0>f(mt,Fe))Be[kt]=mt,Be[at]=Fe,kt=at;else break e}}return ot}function f(Be,ot){var Fe=Be.sortIndex-ot.sortIndex;return Fe!==0?Fe:Be.id-ot.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var _=performance;t.unstable_now=function(){return _.now()}}else{var y=Date,d=y.now();t.unstable_now=function(){return y.now()-d}}var A=[],I=[],B=1,N=null,V=3,K=!1,ie=!1,ne=!1,ve=!1,se=typeof setTimeout=="function"?setTimeout:null,ge=typeof clearTimeout=="function"?clearTimeout:null,ae=typeof setImmediate<"u"?setImmediate:null;function me(Be){for(var ot=r(I);ot!==null;){if(ot.callback===null)l(I);else if(ot.startTime<=Be)l(I),ot.sortIndex=ot.expirationTime,e(A,ot);else break;ot=r(I)}}function ye(Be){if(ne=!1,me(Be),!ie)if(r(A)!==null)ie=!0,Se||(Se=!0,Ke());else{var ot=r(I);ot!==null&&St(ye,ot.startTime-Be)}}var Se=!1,ze=-1,He=5,Ze=-1;function st(){return ve?!0:!(t.unstable_now()-Ze<He)}function lt(){if(ve=!1,Se){var Be=t.unstable_now();Ze=Be;var ot=!0;try{e:{ie=!1,ne&&(ne=!1,ge(ze),ze=-1),K=!0;var Fe=V;try{t:{for(me(Be),N=r(A);N!==null&&!(N.expirationTime>Be&&st());){var kt=N.callback;if(typeof kt=="function"){N.callback=null,V=N.priorityLevel;var rt=kt(N.expirationTime<=Be);if(Be=t.unstable_now(),typeof rt=="function"){N.callback=rt,me(Be),ot=!0;break t}N===r(A)&&l(A),me(Be)}else l(A);N=r(A)}if(N!==null)ot=!0;else{var be=r(I);be!==null&&St(ye,be.startTime-Be),ot=!1}}break e}finally{N=null,V=Fe,K=!1}ot=void 0}}finally{ot?Ke():Se=!1}}}var Ke;if(typeof ae=="function")Ke=function(){ae(lt)};else if(typeof MessageChannel<"u"){var Mt=new MessageChannel,gt=Mt.port2;Mt.port1.onmessage=lt,Ke=function(){gt.postMessage(null)}}else Ke=function(){se(lt,0)};function St(Be,ot){ze=se(function(){Be(t.unstable_now())},ot)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Be){Be.callback=null},t.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):He=0<Be?Math.floor(1e3/Be):5},t.unstable_getCurrentPriorityLevel=function(){return V},t.unstable_next=function(Be){switch(V){case 1:case 2:case 3:var ot=3;break;default:ot=V}var Fe=V;V=ot;try{return Be()}finally{V=Fe}},t.unstable_requestPaint=function(){ve=!0},t.unstable_runWithPriority=function(Be,ot){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var Fe=V;V=Be;try{return ot()}finally{V=Fe}},t.unstable_scheduleCallback=function(Be,ot,Fe){var kt=t.unstable_now();switch(typeof Fe=="object"&&Fe!==null?(Fe=Fe.delay,Fe=typeof Fe=="number"&&0<Fe?kt+Fe:kt):Fe=kt,Be){case 1:var rt=-1;break;case 2:rt=250;break;case 5:rt=1073741823;break;case 4:rt=1e4;break;default:rt=5e3}return rt=Fe+rt,Be={id:B++,callback:ot,priorityLevel:Be,startTime:Fe,expirationTime:rt,sortIndex:-1},Fe>kt?(Be.sortIndex=Fe,e(I,Be),r(A)===null&&Be===r(I)&&(ne?(ge(ze),ze=-1):ne=!0,St(ye,Fe-kt))):(Be.sortIndex=rt,e(A,Be),ie||K||(ie=!0,Se||(Se=!0,Ke()))),Be},t.unstable_shouldYield=st,t.unstable_wrapCallback=function(Be){var ot=V;return function(){var Fe=V;V=ot;try{return Be.apply(this,arguments)}finally{V=Fe}}}})(L_)),L_}var ob;function A2(){return ob||(ob=1,j_.exports=C2()),j_.exports}var z_={exports:{}},hn={};var lb;function M2(){if(lb)return hn;lb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),y=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),I=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),V=Symbol.iterator;function K(be){return be===null||typeof be!="object"?null:(be=V&&be[V]||be["@@iterator"],typeof be=="function"?be:null)}var ie={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ne=Object.assign,ve={};function se(be,Ie,et){this.props=be,this.context=Ie,this.refs=ve,this.updater=et||ie}se.prototype.isReactComponent={},se.prototype.setState=function(be,Ie){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Ie,"setState")},se.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function ge(){}ge.prototype=se.prototype;function ae(be,Ie,et){this.props=be,this.context=Ie,this.refs=ve,this.updater=et||ie}var me=ae.prototype=new ge;me.constructor=ae,ne(me,se.prototype),me.isPureReactComponent=!0;var ye=Array.isArray;function Se(){}var ze={H:null,A:null,T:null,S:null},He=Object.prototype.hasOwnProperty;function Ze(be,Ie,et){var at=et.ref;return{$$typeof:t,type:be,key:Ie,ref:at!==void 0?at:null,props:et}}function st(be,Ie){return Ze(be.type,Ie,be.props)}function lt(be){return typeof be=="object"&&be!==null&&be.$$typeof===t}function Ke(be){var Ie={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(et){return Ie[et]})}var Mt=/\/+/g;function gt(be,Ie){return typeof be=="object"&&be!==null&&be.key!=null?Ke(""+be.key):Ie.toString(36)}function St(be){switch(be.status){case"fulfilled":return be.value;case"rejected":throw be.reason;default:switch(typeof be.status=="string"?be.then(Se,Se):(be.status="pending",be.then(function(Ie){be.status==="pending"&&(be.status="fulfilled",be.value=Ie)},function(Ie){be.status==="pending"&&(be.status="rejected",be.reason=Ie)})),be.status){case"fulfilled":return be.value;case"rejected":throw be.reason}}throw be}function Be(be,Ie,et,at,mt){var Ct=typeof be;(Ct==="undefined"||Ct==="boolean")&&(be=null);var Ot=!1;if(be===null)Ot=!0;else switch(Ct){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(be.$$typeof){case t:case e:Ot=!0;break;case B:return Ot=be._init,Be(Ot(be._payload),Ie,et,at,mt)}}if(Ot)return mt=mt(be),Ot=at===""?"."+gt(be,0):at,ye(mt)?(et="",Ot!=null&&(et=Ot.replace(Mt,"$&/")+"/"),Be(mt,Ie,et,"",function(Vi){return Vi})):mt!=null&&(lt(mt)&&(mt=st(mt,et+(mt.key==null||be&&be.key===mt.key?"":(""+mt.key).replace(Mt,"$&/")+"/")+Ot)),Ie.push(mt)),1;Ot=0;var Kt=at===""?".":at+":";if(ye(be))for(var _i=0;_i<be.length;_i++)at=be[_i],Ct=Kt+gt(at,_i),Ot+=Be(at,Ie,et,Ct,mt);else if(_i=K(be),typeof _i=="function")for(be=_i.call(be),_i=0;!(at=be.next()).done;)at=at.value,Ct=Kt+gt(at,_i++),Ot+=Be(at,Ie,et,Ct,mt);else if(Ct==="object"){if(typeof be.then=="function")return Be(St(be),Ie,et,at,mt);throw Ie=String(be),Error("Objects are not valid as a React child (found: "+(Ie==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Ie)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function ot(be,Ie,et){if(be==null)return be;var at=[],mt=0;return Be(be,at,"","",function(Ct){return Ie.call(et,Ct,mt++)}),at}function Fe(be){if(be._status===-1){var Ie=be._result;Ie=Ie(),Ie.then(function(et){(be._status===0||be._status===-1)&&(be._status=1,be._result=et)},function(et){(be._status===0||be._status===-1)&&(be._status=2,be._result=et)}),be._status===-1&&(be._status=0,be._result=Ie)}if(be._status===1)return be._result.default;throw be._result}var kt=typeof reportError=="function"?reportError:function(be){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof be=="object"&&be!==null&&typeof be.message=="string"?String(be.message):String(be),error:be});if(!window.dispatchEvent(Ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",be);return}console.error(be)},rt={map:ot,forEach:function(be,Ie,et){ot(be,function(){Ie.apply(this,arguments)},et)},count:function(be){var Ie=0;return ot(be,function(){Ie++}),Ie},toArray:function(be){return ot(be,function(Ie){return Ie})||[]},only:function(be){if(!lt(be))throw Error("React.Children.only expected to receive a single React element child.");return be}};return hn.Activity=N,hn.Children=rt,hn.Component=se,hn.Fragment=r,hn.Profiler=f,hn.PureComponent=ae,hn.StrictMode=l,hn.Suspense=A,hn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ze,hn.__COMPILER_RUNTIME={__proto__:null,c:function(be){return ze.H.useMemoCache(be)}},hn.cache=function(be){return function(){return be.apply(null,arguments)}},hn.cacheSignal=function(){return null},hn.cloneElement=function(be,Ie,et){if(be==null)throw Error("The argument must be a React element, but you passed "+be+".");var at=ne({},be.props),mt=be.key;if(Ie!=null)for(Ct in Ie.key!==void 0&&(mt=""+Ie.key),Ie)!He.call(Ie,Ct)||Ct==="key"||Ct==="__self"||Ct==="__source"||Ct==="ref"&&Ie.ref===void 0||(at[Ct]=Ie[Ct]);var Ct=arguments.length-2;if(Ct===1)at.children=et;else if(1<Ct){for(var Ot=Array(Ct),Kt=0;Kt<Ct;Kt++)Ot[Kt]=arguments[Kt+2];at.children=Ot}return Ze(be.type,mt,at)},hn.createContext=function(be){return be={$$typeof:y,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null},be.Provider=be,be.Consumer={$$typeof:_,_context:be},be},hn.createElement=function(be,Ie,et){var at,mt={},Ct=null;if(Ie!=null)for(at in Ie.key!==void 0&&(Ct=""+Ie.key),Ie)He.call(Ie,at)&&at!=="key"&&at!=="__self"&&at!=="__source"&&(mt[at]=Ie[at]);var Ot=arguments.length-2;if(Ot===1)mt.children=et;else if(1<Ot){for(var Kt=Array(Ot),_i=0;_i<Ot;_i++)Kt[_i]=arguments[_i+2];mt.children=Kt}if(be&&be.defaultProps)for(at in Ot=be.defaultProps,Ot)mt[at]===void 0&&(mt[at]=Ot[at]);return Ze(be,Ct,mt)},hn.createRef=function(){return{current:null}},hn.forwardRef=function(be){return{$$typeof:d,render:be}},hn.isValidElement=lt,hn.lazy=function(be){return{$$typeof:B,_payload:{_status:-1,_result:be},_init:Fe}},hn.memo=function(be,Ie){return{$$typeof:I,type:be,compare:Ie===void 0?null:Ie}},hn.startTransition=function(be){var Ie=ze.T,et={};ze.T=et;try{var at=be(),mt=ze.S;mt!==null&&mt(et,at),typeof at=="object"&&at!==null&&typeof at.then=="function"&&at.then(Se,kt)}catch(Ct){kt(Ct)}finally{Ie!==null&&et.types!==null&&(Ie.types=et.types),ze.T=Ie}},hn.unstable_useCacheRefresh=function(){return ze.H.useCacheRefresh()},hn.use=function(be){return ze.H.use(be)},hn.useActionState=function(be,Ie,et){return ze.H.useActionState(be,Ie,et)},hn.useCallback=function(be,Ie){return ze.H.useCallback(be,Ie)},hn.useContext=function(be){return ze.H.useContext(be)},hn.useDebugValue=function(){},hn.useDeferredValue=function(be,Ie){return ze.H.useDeferredValue(be,Ie)},hn.useEffect=function(be,Ie){return ze.H.useEffect(be,Ie)},hn.useEffectEvent=function(be){return ze.H.useEffectEvent(be)},hn.useId=function(){return ze.H.useId()},hn.useImperativeHandle=function(be,Ie,et){return ze.H.useImperativeHandle(be,Ie,et)},hn.useInsertionEffect=function(be,Ie){return ze.H.useInsertionEffect(be,Ie)},hn.useLayoutEffect=function(be,Ie){return ze.H.useLayoutEffect(be,Ie)},hn.useMemo=function(be,Ie){return ze.H.useMemo(be,Ie)},hn.useOptimistic=function(be,Ie){return ze.H.useOptimistic(be,Ie)},hn.useReducer=function(be,Ie,et){return ze.H.useReducer(be,Ie,et)},hn.useRef=function(be){return ze.H.useRef(be)},hn.useState=function(be){return ze.H.useState(be)},hn.useSyncExternalStore=function(be,Ie,et){return ze.H.useSyncExternalStore(be,Ie,et)},hn.useTransition=function(){return ze.H.useTransition()},hn.version="19.2.0",hn}var cb;function nx(){return cb||(cb=1,z_.exports=M2()),z_.exports}var R_={exports:{}},io={};var ub;function P2(){if(ub)return io;ub=1;var t=nx();function e(A){var I="https://react.dev/errors/"+A;if(1<arguments.length){I+="?args[]="+encodeURIComponent(arguments[1]);for(var B=2;B<arguments.length;B++)I+="&args[]="+encodeURIComponent(arguments[B])}return"Minified React error #"+A+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var l={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},f=Symbol.for("react.portal");function _(A,I,B){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:N==null?null:""+N,children:A,containerInfo:I,implementation:B}}var y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(A,I){if(A==="font")return"";if(typeof I=="string")return I==="use-credentials"?I:""}return io.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,io.createPortal=function(A,I){var B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I||I.nodeType!==1&&I.nodeType!==9&&I.nodeType!==11)throw Error(e(299));return _(A,I,null,B)},io.flushSync=function(A){var I=y.T,B=l.p;try{if(y.T=null,l.p=2,A)return A()}finally{y.T=I,l.p=B,l.d.f()}},io.preconnect=function(A,I){typeof A=="string"&&(I?(I=I.crossOrigin,I=typeof I=="string"?I==="use-credentials"?I:"":void 0):I=null,l.d.C(A,I))},io.prefetchDNS=function(A){typeof A=="string"&&l.d.D(A)},io.preinit=function(A,I){if(typeof A=="string"&&I&&typeof I.as=="string"){var B=I.as,N=d(B,I.crossOrigin),V=typeof I.integrity=="string"?I.integrity:void 0,K=typeof I.fetchPriority=="string"?I.fetchPriority:void 0;B==="style"?l.d.S(A,typeof I.precedence=="string"?I.precedence:void 0,{crossOrigin:N,integrity:V,fetchPriority:K}):B==="script"&&l.d.X(A,{crossOrigin:N,integrity:V,fetchPriority:K,nonce:typeof I.nonce=="string"?I.nonce:void 0})}},io.preinitModule=function(A,I){if(typeof A=="string")if(typeof I=="object"&&I!==null){if(I.as==null||I.as==="script"){var B=d(I.as,I.crossOrigin);l.d.M(A,{crossOrigin:B,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0})}}else I==null&&l.d.M(A)},io.preload=function(A,I){if(typeof A=="string"&&typeof I=="object"&&I!==null&&typeof I.as=="string"){var B=I.as,N=d(B,I.crossOrigin);l.d.L(A,B,{crossOrigin:N,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0,type:typeof I.type=="string"?I.type:void 0,fetchPriority:typeof I.fetchPriority=="string"?I.fetchPriority:void 0,referrerPolicy:typeof I.referrerPolicy=="string"?I.referrerPolicy:void 0,imageSrcSet:typeof I.imageSrcSet=="string"?I.imageSrcSet:void 0,imageSizes:typeof I.imageSizes=="string"?I.imageSizes:void 0,media:typeof I.media=="string"?I.media:void 0})}},io.preloadModule=function(A,I){if(typeof A=="string")if(I){var B=d(I.as,I.crossOrigin);l.d.m(A,{as:typeof I.as=="string"&&I.as!=="script"?I.as:void 0,crossOrigin:B,integrity:typeof I.integrity=="string"?I.integrity:void 0})}else l.d.m(A)},io.requestFormReset=function(A){l.d.r(A)},io.unstable_batchedUpdates=function(A,I){return A(I)},io.useFormState=function(A,I,B){return y.H.useFormState(A,I,B)},io.useFormStatus=function(){return y.H.useHostTransitionStatus()},io.version="19.2.0",io}var hb;function Tw(){if(hb)return R_.exports;hb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),R_.exports=P2(),R_.exports}var db;function I2(){if(db)return bm;db=1;var t=A2(),e=nx(),r=Tw();function l(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)o+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function _(s){var o=s,p=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(p=o.return),s=o.return;while(s)}return o.tag===3?p:null}function y(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function d(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function A(s){if(_(s)!==s)throw Error(l(188))}function I(s){var o=s.alternate;if(!o){if(o=_(s),o===null)throw Error(l(188));return o!==s?null:s}for(var p=s,w=o;;){var P=p.return;if(P===null)break;var D=P.alternate;if(D===null){if(w=P.return,w!==null){p=w;continue}break}if(P.child===D.child){for(D=P.child;D;){if(D===p)return A(P),s;if(D===w)return A(P),o;D=D.sibling}throw Error(l(188))}if(p.return!==w.return)p=P,w=D;else{for(var W=!1,pe=P.child;pe;){if(pe===p){W=!0,p=P,w=D;break}if(pe===w){W=!0,w=P,p=D;break}pe=pe.sibling}if(!W){for(pe=D.child;pe;){if(pe===p){W=!0,p=D,w=P;break}if(pe===w){W=!0,w=D,p=P;break}pe=pe.sibling}if(!W)throw Error(l(189))}}if(p.alternate!==w)throw Error(l(190))}if(p.tag!==3)throw Error(l(188));return p.stateNode.current===p?s:o}function B(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=B(s),o!==null)return o;s=s.sibling}return null}var N=Object.assign,V=Symbol.for("react.element"),K=Symbol.for("react.transitional.element"),ie=Symbol.for("react.portal"),ne=Symbol.for("react.fragment"),ve=Symbol.for("react.strict_mode"),se=Symbol.for("react.profiler"),ge=Symbol.for("react.consumer"),ae=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),ye=Symbol.for("react.suspense"),Se=Symbol.for("react.suspense_list"),ze=Symbol.for("react.memo"),He=Symbol.for("react.lazy"),Ze=Symbol.for("react.activity"),st=Symbol.for("react.memo_cache_sentinel"),lt=Symbol.iterator;function Ke(s){return s===null||typeof s!="object"?null:(s=lt&&s[lt]||s["@@iterator"],typeof s=="function"?s:null)}var Mt=Symbol.for("react.client.reference");function gt(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Mt?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ne:return"Fragment";case se:return"Profiler";case ve:return"StrictMode";case ye:return"Suspense";case Se:return"SuspenseList";case Ze:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case ie:return"Portal";case ae:return s.displayName||"Context";case ge:return(s._context.displayName||"Context")+".Consumer";case me:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ze:return o=s.displayName||null,o!==null?o:gt(s.type)||"Memo";case He:o=s._payload,s=s._init;try{return gt(s(o))}catch{}}return null}var St=Array.isArray,Be=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ot=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Fe={pending:!1,data:null,method:null,action:null},kt=[],rt=-1;function be(s){return{current:s}}function Ie(s){0>rt||(s.current=kt[rt],kt[rt]=null,rt--)}function et(s,o){rt++,kt[rt]=s.current,s.current=o}var at=be(null),mt=be(null),Ct=be(null),Ot=be(null);function Kt(s,o){switch(et(Ct,o),et(mt,s),et(at,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?k(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=k(o),s=C(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Ie(at),et(at,s)}function _i(){Ie(at),Ie(mt),Ie(Ct)}function Vi(s){s.memoizedState!==null&&et(Ot,s);var o=at.current,p=C(o,s.type);o!==p&&(et(mt,s),et(at,p))}function gi(s){mt.current===s&&(Ie(at),Ie(mt)),Ot.current===s&&(Ie(Ot),Nh._currentValue=Fe)}var Oi,xn;function cn(s){if(Oi===void 0)try{throw Error()}catch(p){var o=p.stack.trim().match(/\n( *(at )?)/);Oi=o&&o[1]||"",xn=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Oi+s+xn}var Zn=!1;function tt(s,o){if(!s||Zn)return"";Zn=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(o){var Lt=function(){throw Error()};if(Object.defineProperty(Lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Lt,[])}catch(yt){var ft=yt}Reflect.construct(s,[],Lt)}else{try{Lt.call()}catch(yt){ft=yt}s.call(Lt.prototype)}}else{try{throw Error()}catch(yt){ft=yt}(Lt=s())&&typeof Lt.catch=="function"&&Lt.catch(function(){})}}catch(yt){if(yt&&ft&&typeof yt.stack=="string")return[yt.stack,ft.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var P=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");P&&P.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=w.DetermineComponentFrameRoot(),W=D[0],pe=D[1];if(W&&pe){var Re=W.split(`
`),dt=pe.split(`
`);for(P=w=0;w<Re.length&&!Re[w].includes("DetermineComponentFrameRoot");)w++;for(;P<dt.length&&!dt[P].includes("DetermineComponentFrameRoot");)P++;if(w===Re.length||P===dt.length)for(w=Re.length-1,P=dt.length-1;1<=w&&0<=P&&Re[w]!==dt[P];)P--;for(;1<=w&&0<=P;w--,P--)if(Re[w]!==dt[P]){if(w!==1||P!==1)do if(w--,P--,0>P||Re[w]!==dt[P]){var Et=`
`+Re[w].replace(" at new "," at ");return s.displayName&&Et.includes("<anonymous>")&&(Et=Et.replace("<anonymous>",s.displayName)),Et}while(1<=w&&0<=P);break}}}finally{Zn=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?cn(p):""}function Xn(s,o){switch(s.tag){case 26:case 27:case 5:return cn(s.type);case 16:return cn("Lazy");case 13:return s.child!==o&&o!==null?cn("Suspense Fallback"):cn("Suspense");case 19:return cn("SuspenseList");case 0:case 15:return tt(s.type,!1);case 11:return tt(s.type.render,!1);case 1:return tt(s.type,!0);case 31:return cn("Activity");default:return""}}function Pn(s){try{var o="",p=null;do o+=Xn(s,p),p=s,s=s.return;while(s);return o}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var ki=Object.prototype.hasOwnProperty,yi=t.unstable_scheduleCallback,Cn=t.unstable_cancelCallback,Ln=t.unstable_shouldYield,us=t.unstable_requestPaint,an=t.unstable_now,en=t.unstable_getCurrentPriorityLevel,qi=t.unstable_ImmediatePriority,Fn=t.unstable_UserBlockingPriority,Tt=t.unstable_NormalPriority,On=t.unstable_LowPriority,dn=t.unstable_IdlePriority,An=t.log,Kn=t.unstable_setDisableYieldValue,It=null,ai=null;function ti(s){if(typeof An=="function"&&Kn(s),ai&&typeof ai.setStrictMode=="function")try{ai.setStrictMode(It,s)}catch{}}var Ji=Math.clz32?Math.clz32:Bt,Nn=Math.log,mi=Math.LN2;function Bt(s){return s>>>=0,s===0?32:31-(Nn(s)/mi|0)|0}var hi=256,Ci=262144,bi=4194304;function xe(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ee(s,o,p){var w=s.pendingLanes;if(w===0)return 0;var P=0,D=s.suspendedLanes,W=s.pingedLanes;s=s.warmLanes;var pe=w&134217727;return pe!==0?(w=pe&~D,w!==0?P=xe(w):(W&=pe,W!==0?P=xe(W):p||(p=pe&~s,p!==0&&(P=xe(p))))):(pe=w&~D,pe!==0?P=xe(pe):W!==0?P=xe(W):p||(p=w&~s,p!==0&&(P=xe(p)))),P===0?0:o!==0&&o!==P&&(o&D)===0&&(D=P&-P,p=o&-o,D>=p||D===32&&(p&4194048)!==0)?o:P}function Q(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function ue(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function we(){var s=bi;return bi<<=1,(bi&62914560)===0&&(bi=4194304),s}function je(s){for(var o=[],p=0;31>p;p++)o.push(s);return o}function Oe(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function qe(s,o,p,w,P,D){var W=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var pe=s.entanglements,Re=s.expirationTimes,dt=s.hiddenUpdates;for(p=W&~p;0<p;){var Et=31-Ji(p),Lt=1<<Et;pe[Et]=0,Re[Et]=-1;var ft=dt[Et];if(ft!==null)for(dt[Et]=null,Et=0;Et<ft.length;Et++){var yt=ft[Et];yt!==null&&(yt.lane&=-536870913)}p&=~Lt}w!==0&&de(s,w,0),D!==0&&P===0&&s.tag!==0&&(s.suspendedLanes|=D&~(W&~o))}function de(s,o,p){s.pendingLanes|=o,s.suspendedLanes&=~o;var w=31-Ji(o);s.entangledLanes|=o,s.entanglements[w]=s.entanglements[w]|1073741824|p&261930}function Je(s,o){var p=s.entangledLanes|=o;for(s=s.entanglements;p;){var w=31-Ji(p),P=1<<w;P&o|s[w]&o&&(s[w]|=o),p&=~P}}function ct(s,o){var p=o&-o;return p=(p&42)!==0?1:Ye(p),(p&(s.suspendedLanes|o))!==0?0:p}function Ye(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function nt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ei(){var s=ot.p;return s!==0?s:(s=window.event,s===void 0?32:Dr(s.type))}function si(s,o){var p=ot.p;try{return ot.p=s,o()}finally{ot.p=p}}var $t=Math.random().toString(36).slice(2),At="__reactFiber$"+$t,ni="__reactProps$"+$t,vi="__reactContainer$"+$t,Bi="__reactEvents$"+$t,_t="__reactListeners$"+$t,xt="__reactHandles$"+$t,Wt="__reactResources$"+$t,pi="__reactMarker$"+$t;function Ne(s){delete s[At],delete s[ni],delete s[Bi],delete s[_t],delete s[xt]}function zt(s){var o=s[At];if(o)return o;for(var p=s.parentNode;p;){if(o=p[vi]||p[At]){if(p=o.alternate,o.child!==null||p!==null&&p.child!==null)for(s=ci(s);s!==null;){if(p=s[At])return p;s=ci(s)}return o}s=p,p=s.parentNode}return null}function Jt(s){if(s=s[At]||s[vi]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function Ki(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(l(33))}function wi(s){var o=s[Wt];return o||(o=s[Wt]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function vn(s){s[pi]=!0}var gr=new Set,Ys={};function zs(s,o){Eo(s,o),Eo(s+"Capture",o)}function Eo(s,o){for(Ys[s]=o,s=0;s<o.length;s++)gr.add(o[s])}var ir=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yr={},ko={};function _a(s){return ki.call(ko,s)?!0:ki.call(yr,s)?!1:ir.test(s)?ko[s]=!0:(yr[s]=!0,!1)}function Pi(s,o,p){if(_a(o))if(p===null)s.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var w=o.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+p)}}function zn(s,o,p){if(p===null)s.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+p)}}function ys(s,o,p,w){if(w===null)s.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(o,p,""+w)}}function fn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ra(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Br(s,o,p){var w=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var P=w.get,D=w.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return P.call(this)},set:function(W){p=""+W,D.call(this,W)}}),Object.defineProperty(s,o,{enumerable:w.enumerable}),{getValue:function(){return p},setValue:function(W){p=""+W},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Hi(s){if(!s._valueTracker){var o=Ra(s)?"checked":"value";s._valueTracker=Br(s,o,""+s[o])}}function In(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var p=o.getValue(),w="";return s&&(w=Ra(s)?s.checked?"true":"false":s.value),s=w,s!==p?(o.setValue(s),!0):!1}function Il(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Wo=/[\n"\\]/g;function Bn(s){return s.replace(Wo,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Da(s,o,p,w,P,D,W,pe){s.name="",W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?s.type=W:s.removeAttribute("type"),o!=null?W==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+fn(o)):s.value!==""+fn(o)&&(s.value=""+fn(o)):W!=="submit"&&W!=="reset"||s.removeAttribute("value"),o!=null?va(s,W,fn(o)):p!=null?va(s,W,fn(p)):w!=null&&s.removeAttribute("value"),P==null&&D!=null&&(s.defaultChecked=!!D),P!=null&&(s.checked=P&&typeof P!="function"&&typeof P!="symbol"),pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?s.name=""+fn(pe):s.removeAttribute("name")}function pn(s,o,p,w,P,D,W,pe){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(s.type=D),o!=null||p!=null){if(!(D!=="submit"&&D!=="reset"||o!=null)){Hi(s);return}p=p!=null?""+fn(p):"",o=o!=null?""+fn(o):p,pe||o===s.value||(s.value=o),s.defaultValue=o}w=w??P,w=typeof w!="function"&&typeof w!="symbol"&&!!w,s.checked=pe?s.checked:!!w,s.defaultChecked=!!w,W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(s.name=W),Hi(s)}function va(s,o,p){o==="number"&&Il(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function Gn(s,o,p,w){if(s=s.options,o){o={};for(var P=0;P<p.length;P++)o["$"+p[P]]=!0;for(p=0;p<s.length;p++)P=o.hasOwnProperty("$"+s[p].value),s[p].selected!==P&&(s[p].selected=P),P&&w&&(s[p].defaultSelected=!0)}else{for(p=""+fn(p),o=null,P=0;P<s.length;P++){if(s[P].value===p){s[P].selected=!0,w&&(s[P].defaultSelected=!0);return}o!==null||s[P].disabled||(o=s[P])}o!==null&&(o.selected=!0)}}function $r(s,o,p){if(o!=null&&(o=""+fn(o),o!==s.value&&(s.value=o),p==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=p!=null?""+fn(p):""}function Co(s,o,p,w){if(o==null){if(w!=null){if(p!=null)throw Error(l(92));if(St(w)){if(1<w.length)throw Error(l(93));w=w[0]}p=w}p==null&&(p=""),o=p}p=fn(o),s.defaultValue=p,w=s.textContent,w===p&&w!==""&&w!==null&&(s.value=w),Hi(s)}function Ur(s,o){if(o){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=o;return}}s.textContent=o}var Yo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ro(s,o,p){var w=o.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?w?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":w?s.setProperty(o,p):typeof p!="number"||p===0||Yo.has(o)?o==="float"?s.cssFloat=p:s[o]=(""+p).trim():s[o]=p+"px"}function ao(s,o,p){if(o!=null&&typeof o!="object")throw Error(l(62));if(s=s.style,p!=null){for(var w in p)!p.hasOwnProperty(w)||o!=null&&o.hasOwnProperty(w)||(w.indexOf("--")===0?s.setProperty(w,""):w==="float"?s.cssFloat="":s[w]="");for(var P in o)w=o[P],o.hasOwnProperty(P)&&p[P]!==w&&ro(s,P,w)}else for(var D in o)o.hasOwnProperty(D)&&ro(s,D,o[D])}function jl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ic=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ll(s){return jc.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function $s(){}var Ao=null;function Us(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Rs=null,Di=null;function Mr(s){var o=Jt(s);if(o&&(s=o.stateNode)){var p=s[ni]||null;e:switch(s=o.stateNode,o.type){case"input":if(Da(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),o=p.name,p.type==="radio"&&o!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Bn(""+o)+'"][type="radio"]'),o=0;o<p.length;o++){var w=p[o];if(w!==s&&w.form===s.form){var P=w[ni]||null;if(!P)throw Error(l(90));Da(w,P.value,P.defaultValue,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name)}}for(o=0;o<p.length;o++)w=p[o],w.form===s.form&&In(w)}break e;case"textarea":$r(s,p.value,p.defaultValue);break e;case"select":o=p.value,o!=null&&Gn(s,!!p.multiple,o,!1)}}}var jn=!1;function Lc(s,o,p){if(jn)return s(o,p);jn=!0;try{var w=s(o);return w}finally{if(jn=!1,(Rs!==null||Di!==null)&&(Cd(),Rs&&(o=Rs,s=Di,Di=Rs=null,Mr(o),s)))for(o=0;o<s.length;o++)Mr(s[o])}}function ia(s,o){var p=s.stateNode;if(p===null)return null;var w=p[ni]||null;if(w===null)return null;p=w[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(s=s.type,w=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!w;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(l(231,o,typeof p));return p}var xa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zl=!1;if(xa)try{var na={};Object.defineProperty(na,"passive",{get:function(){zl=!0}}),window.addEventListener("test",na,na),window.removeEventListener("test",na,na)}catch{zl=!1}var Oa=null,Xo=null,xs=null;function sa(){if(xs)return xs;var s,o=Xo,p=o.length,w,P="value"in Oa?Oa.value:Oa.textContent,D=P.length;for(s=0;s<p&&o[s]===P[s];s++);var W=p-s;for(w=1;w<=W&&o[p-w]===P[D-w];w++);return xs=P.slice(s,1<w?1-w:void 0)}function Ko(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Mo(){return!0}function zc(){return!1}function Xs(s){function o(p,w,P,D,W){this._reactName=p,this._targetInst=P,this.type=w,this.nativeEvent=D,this.target=W,this.currentTarget=null;for(var pe in s)s.hasOwnProperty(pe)&&(p=s[pe],this[pe]=p?p(D):D[pe]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Mo:zc,this.isPropagationStopped=zc,this}return N(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Mo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Mo)},persist:function(){},isPersistent:Mo}),o}var Fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rc=Xs(Fs),Po=N({},Fs,{view:0,detail:0}),tn=Xs(Po),Na,Zi,ra,ec=N({},Po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xu,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ra&&(ra&&s.type==="mousemove"?(Na=s.screenX-ra.screenX,Zi=s.screenY-ra.screenY):Zi=Na=0,ra=s),Na)},movementY:function(s){return"movementY"in s?s.movementY:Zi}}),Jo=Xs(ec),yu=N({},ec,{dataTransfer:0}),Qu=Xs(yu),eh=N({},Po,{relatedTarget:0}),Dc=Xs(eh),_u=N({},Fs,{animationName:0,elapsedTime:0,pseudoElement:0}),Oc=Xs(_u),th=N({},Fs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ba=Xs(th),ih=N({},Fs,{data:0}),oo=Xs(ih),lo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qo(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=vu[s])?!!o[s]:!1}function xu(){return Qo}var tc=N({},Po,{key:function(s){if(s.key){var o=lo[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Ko(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?nh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xu,charCode:function(s){return s.type==="keypress"?Ko(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ko(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),sh=Xs(tc),Jh=N({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bu=Xs(Jh),Nc=N({},Po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xu}),rh=Xs(Nc),Bc=N({},Fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),wu=Xs(Bc),el=N({},ec,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),_r=Xs(el),Su=N({},Fs,{newState:0,oldState:0}),tl=Xs(Su),Pr=[9,13,27,32],il=xa&&"CompositionEvent"in window,Io=null;xa&&"documentMode"in document&&(Io=document.documentMode);var nl=xa&&"TextEvent"in window&&!Io,Rl=xa&&(!il||Io&&8<Io&&11>=Io),$c=" ",ps=!1;function ah(s,o){switch(s){case"keyup":return Pr.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yi(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var co=!1;function mn(s,o){switch(s){case"compositionend":return Yi(o);case"keypress":return o.which!==32?null:(ps=!0,$c);case"textInput":return s=o.data,s===$c&&ps?null:s;default:return null}}function Tn(s,o){if(co)return s==="compositionend"||!il&&ah(s,o)?(s=sa(),xs=Xo=Oa=null,co=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Rl&&o.locale!=="ko"?null:o.data;default:return null}}var sl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ir(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!sl[s.type]:o==="textarea"}function Dl(s,o,p,w){Rs?Di?Di.push(w):Di=[w]:Rs=w,o=zd(o,"onChange"),0<o.length&&(p=new Rc("onChange","change",null,p,w),s.push({event:p,listeners:o}))}var aa=null,wa=null;function Ba(s){jf(s,0)}function nr(s){var o=Ki(s);if(In(o))return s}function rl(s,o){if(s==="change")return o}var Uc=!1;if(xa){var oa;if(xa){var la="oninput"in document;if(!la){var Ol=document.createElement("div");Ol.setAttribute("oninput","return;"),la=typeof Ol.oninput=="function"}oa=la}else oa=!1;Uc=oa&&(!document.documentMode||9<document.documentMode)}function jo(){aa&&(aa.detachEvent("onpropertychange",al),wa=aa=null)}function al(s){if(s.propertyName==="value"&&nr(wa)){var o=[];Dl(o,wa,s,Us(s)),Lc(Ba,o)}}function Fr(s,o,p){s==="focusin"?(jo(),aa=o,wa=p,aa.attachEvent("onpropertychange",al)):s==="focusout"&&jo()}function Fc(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return nr(wa)}function Sa(s,o){if(s==="click")return nr(o)}function Nl(s,o){if(s==="input"||s==="change")return nr(o)}function $a(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Vs=typeof Object.is=="function"?Object.is:$a;function on(s,o){if(Vs(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var p=Object.keys(s),w=Object.keys(o);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var P=p[w];if(!ki.call(o,P)||!Vs(s[P],o[P]))return!1}return!0}function ol(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ic(s,o){var p=ol(s);s=0;for(var w;p;){if(p.nodeType===3){if(w=s+p.textContent.length,s<=o&&w>=o)return{node:p,offset:o-s};s=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=ol(p)}}function nc(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?nc(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Ua(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Il(s.document);o instanceof s.HTMLIFrameElement;){try{var p=typeof o.contentWindow.location.href=="string"}catch{p=!1}if(p)s=o.contentWindow;else break;o=Il(s.document)}return o}function uo(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var ll=xa&&"documentMode"in document&&11>=document.documentMode,ho=null,sc=null,Lo=null,fo=!1;function cl(s,o,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;fo||ho==null||ho!==Il(w)||(w=ho,"selectionStart"in w&&uo(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Lo&&on(Lo,w)||(Lo=w,w=zd(sc,"onSelect"),0<w.length&&(o=new Rc("onSelect","select",null,o,p),s.push({event:o,listeners:w}),o.target=ho)))}function Vr(s,o){var p={};return p[s.toLowerCase()]=o.toLowerCase(),p["Webkit"+s]="webkit"+o,p["Moz"+s]="moz"+o,p}var Ta={animationend:Vr("Animation","AnimationEnd"),animationiteration:Vr("Animation","AnimationIteration"),animationstart:Vr("Animation","AnimationStart"),transitionrun:Vr("Transition","TransitionRun"),transitionstart:Vr("Transition","TransitionStart"),transitioncancel:Vr("Transition","TransitionCancel"),transitionend:Vr("Transition","TransitionEnd")},Bl={},ul={};xa&&(ul=document.createElement("div").style,"AnimationEvent"in window||(delete Ta.animationend.animation,delete Ta.animationiteration.animation,delete Ta.animationstart.animation),"TransitionEvent"in window||delete Ta.transitionend.transition);function Cs(s){if(Bl[s])return Bl[s];if(!Ta[s])return s;var o=Ta[s],p;for(p in o)if(o.hasOwnProperty(p)&&p in ul)return Bl[s]=o[p];return s}var zo=Cs("animationend"),rc=Cs("animationiteration"),hl=Cs("animationstart"),Qh=Cs("transitionrun"),Tu=Cs("transitionstart"),Vc=Cs("transitioncancel"),Ro=Cs("transitionend"),$l=new Map,ca="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ca.push("scrollEnd");function Wn(s,o){$l.set(s,o),zs(o,[s])}var Ea=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},qr=[],vr=0,ss=0;function xr(){for(var s=vr,o=ss=vr=0;o<s;){var p=qr[o];qr[o++]=null;var w=qr[o];qr[o++]=null;var P=qr[o];qr[o++]=null;var D=qr[o];if(qr[o++]=null,w!==null&&P!==null){var W=w.pending;W===null?P.next=P:(P.next=W.next,W.next=P),w.pending=P}D!==0&&po(p,P,D)}}function As(s,o,p,w){qr[vr++]=s,qr[vr++]=o,qr[vr++]=p,qr[vr++]=w,ss|=w,s.lanes|=w,s=s.alternate,s!==null&&(s.lanes|=w)}function dl(s,o,p,w){return As(s,o,p,w),Fa(s)}function ua(s,o){return As(s,null,null,o),Fa(s)}function po(s,o,p){s.lanes|=p;var w=s.alternate;w!==null&&(w.lanes|=p);for(var P=!1,D=s.return;D!==null;)D.childLanes|=p,w=D.alternate,w!==null&&(w.childLanes|=p),D.tag===22&&(s=D.stateNode,s===null||s._visibility&1||(P=!0)),s=D,D=D.return;return s.tag===3?(D=s.stateNode,P&&o!==null&&(P=31-Ji(p),s=D.hiddenUpdates,w=s[P],w===null?s[P]=[o]:w.push(o),o.lane=p|536870912),D):null}function Fa(s){if(50<au)throw au=0,kd=null,Error(l(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var br={};function Eu(s,o,p,w){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ks(s,o,p,w){return new Eu(s,o,p,w)}function Ul(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Hr(s,o){var p=s.alternate;return p===null?(p=Ks(s.tag,o,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=o,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,o=s.dependencies,p.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function ac(s,o){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,o=p.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function fl(s,o,p,w,P,D){var W=0;if(w=s,typeof s=="function")Ul(s)&&(W=1);else if(typeof s=="string")W=So(s,p,at.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case Ze:return s=Ks(31,p,o,P),s.elementType=Ze,s.lanes=D,s;case ne:return Zr(p.children,P,D,o);case ve:W=8,P|=24;break;case se:return s=Ks(12,p,o,P|2),s.elementType=se,s.lanes=D,s;case ye:return s=Ks(13,p,o,P),s.elementType=ye,s.lanes=D,s;case Se:return s=Ks(19,p,o,P),s.elementType=Se,s.lanes=D,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ae:W=10;break e;case ge:W=9;break e;case me:W=11;break e;case ze:W=14;break e;case He:W=16,w=null;break e}W=29,p=Error(l(130,s===null?"null":typeof s,"")),w=null}return o=Ks(W,p,o,P),o.elementType=s,o.type=w,o.lanes=D,o}function Zr(s,o,p,w){return s=Ks(7,s,w,o),s.lanes=p,s}function pl(s,o,p){return s=Ks(6,s,null,o),s.lanes=p,s}function ml(s){var o=Ks(18,null,null,0);return o.stateNode=s,o}function oc(s,o,p){return o=Ks(4,s.children!==null?s.children:[],s.key,o),o.lanes=p,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var u=new WeakMap;function b(s,o){if(typeof s=="object"&&s!==null){var p=u.get(s);return p!==void 0?p:(o={value:s,source:o,stack:Pn(o)},u.set(s,o),o)}return{value:s,source:o,stack:Pn(o)}}var M=[],$=0,Z=null,le=0,Ce=[],We=0,ht=null,wt=1,Yt="";function Si(s,o){M[$++]=le,M[$++]=Z,Z=s,le=o}function ln(s,o,p){Ce[We++]=wt,Ce[We++]=Yt,Ce[We++]=ht,ht=s;var w=wt;s=Yt;var P=32-Ji(w)-1;w&=~(1<<P),p+=1;var D=32-Ji(o)+P;if(30<D){var W=P-P%5;D=(w&(1<<W)-1).toString(32),w>>=W,P-=W,wt=1<<32-Ji(o)+P|p<<P|w,Yt=D+s}else wt=1<<D|p<<P|w,Yt=s}function qs(s){s.return!==null&&(Si(s,1),ln(s,1,0))}function bs(s){for(;s===Z;)Z=M[--$],M[$]=null,le=M[--$],M[$]=null;for(;s===ht;)ht=Ce[--We],Ce[We]=null,Yt=Ce[--We],Ce[We]=null,wt=Ce[--We],Ce[We]=null}function wr(s,o){Ce[We++]=wt,Ce[We++]=Yt,Ce[We++]=ht,wt=o.id,Yt=o.overflow,ht=s}var bn=null,Qi=null,jt=!1,ka=null,jr=!1,lc=Error(l(519));function Gr(s){var o=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gl(b(o,s)),lc}function Do(s){var o=s.stateNode,p=s.type,w=s.memoizedProps;switch(o[At]=s,o[ni]=w,p){case"dialog":Mn("cancel",o),Mn("close",o);break;case"iframe":case"object":case"embed":Mn("load",o);break;case"video":case"audio":for(p=0;p<zh.length;p++)Mn(zh[p],o);break;case"source":Mn("error",o);break;case"img":case"image":case"link":Mn("error",o),Mn("load",o);break;case"details":Mn("toggle",o);break;case"input":Mn("invalid",o),pn(o,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":Mn("invalid",o);break;case"textarea":Mn("invalid",o),Co(o,w.value,w.defaultValue,w.children)}p=w.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||o.textContent===""+p||w.suppressHydrationWarning===!0||Rh(o.textContent,p)?(w.popover!=null&&(Mn("beforetoggle",o),Mn("toggle",o)),w.onScroll!=null&&Mn("scroll",o),w.onScrollEnd!=null&&Mn("scrollend",o),w.onClick!=null&&(o.onclick=$s),o=!0):o=!1,o||Gr(s,!0)}function ms(s){for(bn=s.return;bn;)switch(bn.tag){case 5:case 31:case 13:jr=!1;return;case 27:case 3:jr=!0;return;default:bn=bn.return}}function Ui(s){if(s!==bn)return!1;if(!jt)return ms(s),jt=!0,!1;var o=s.tag,p;if((p=o!==3&&o!==27)&&((p=o===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||j(s.type,s.memoizedProps)),p=!p),p&&Qi&&Gr(s),ms(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(l(317));Qi=fi(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(l(317));Qi=fi(s)}else o===27?(o=Qi,he(s.type)?(s=Gt,Gt=null,Qi=s):Qi=o):Qi=bn?Vt(s.stateNode.nextSibling):null;return!0}function mo(){Qi=bn=null,jt=!1}function ku(){var s=ka;return s!==null&&(Aa===null?Aa=s:Aa.push.apply(Aa,s),ka=null),s}function gl(s){ka===null?ka=[s]:ka.push(s)}var cc=be(null),Wr=null,Va=null;function Oo(s,o,p){et(cc,o._currentValue),o._currentValue=p}function No(s){s._currentValue=cc.current,Ie(cc)}function ed(s,o,p){for(;s!==null;){var w=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,w!==null&&(w.childLanes|=o)):w!==null&&(w.childLanes&o)!==o&&(w.childLanes|=o),s===p)break;s=s.return}}function Cu(s,o,p,w){var P=s.child;for(P!==null&&(P.return=s);P!==null;){var D=P.dependencies;if(D!==null){var W=P.child;D=D.firstContext;e:for(;D!==null;){var pe=D;D=P;for(var Re=0;Re<o.length;Re++)if(pe.context===o[Re]){D.lanes|=p,pe=D.alternate,pe!==null&&(pe.lanes|=p),ed(D.return,p,s),w||(W=null);break e}D=pe.next}}else if(P.tag===18){if(W=P.return,W===null)throw Error(l(341));W.lanes|=p,D=W.alternate,D!==null&&(D.lanes|=p),ed(W,p,s),W=null}else W=P.child;if(W!==null)W.return=P;else for(W=P;W!==null;){if(W===s){W=null;break}if(P=W.sibling,P!==null){P.return=W.return,W=P;break}W=W.return}P=W}}function qc(s,o,p,w){s=null;for(var P=o,D=!1;P!==null;){if(!D){if((P.flags&524288)!==0)D=!0;else if((P.flags&262144)!==0)break}if(P.tag===10){var W=P.alternate;if(W===null)throw Error(l(387));if(W=W.memoizedProps,W!==null){var pe=P.type;Vs(P.pendingProps.value,W.value)||(s!==null?s.push(pe):s=[pe])}}else if(P===Ot.current){if(W=P.alternate,W===null)throw Error(l(387));W.memoizedState.memoizedState!==P.memoizedState.memoizedState&&(s!==null?s.push(Nh):s=[Nh])}P=P.return}s!==null&&Cu(o,s,p,w),o.flags|=262144}function oh(s){for(s=s.firstContext;s!==null;){if(!Vs(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Js(s){Wr=s,Va=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function nn(s){return Au(Wr,s)}function yl(s,o){return Wr===null&&Js(s),Au(s,o)}function Au(s,o){var p=o._currentValue;if(o={context:o,memoizedValue:p,next:null},Va===null){if(s===null)throw Error(l(308));Va=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Va=Va.next=o;return p}var lh=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(p,w){s.push(w)}};this.abort=function(){o.aborted=!0,s.forEach(function(p){return p()})}},sf=t.unstable_scheduleCallback,Mu=t.unstable_NormalPriority,_s={$$typeof:ae,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qa(){return{controller:new lh,data:new Map,refCount:0}}function _l(s){s.refCount--,s.refCount===0&&sf(Mu,function(){s.controller.abort()})}var ui=null,Ti=0,vl=0,xl=null;function td(s,o){if(ui===null){var p=ui=[];Ti=0,vl=Lh(),xl={status:"pending",value:void 0,then:function(w){p.push(w)}}}return Ti++,o.then(E,E),o}function E(){if(--Ti===0&&ui!==null){xl!==null&&(xl.status="fulfilled");var s=ui;ui=null,vl=0,xl=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function i(s,o){var p=[],w={status:"pending",value:null,reason:null,then:function(P){p.push(P)}};return s.then(function(){w.status="fulfilled",w.value=o;for(var P=0;P<p.length;P++)(0,p[P])(o)},function(P){for(w.status="rejected",w.reason=P,P=0;P<p.length;P++)(0,p[P])(void 0)}),w}var h=Be.S;Be.S=function(s,o){zg=an(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&td(s,o),h!==null&&h(s,o)};var g=be(null);function v(){var s=g.current;return s!==null?s:ds.pooledCache}function T(s,o){o===null?et(g,g.current):et(g,o.pool)}function z(){var s=v();return s===null?null:{parent:_s._currentValue,pool:s}}var O=Error(l(460)),U=Error(l(474)),H=Error(l(542)),Y={then:function(){}};function X(s){return s=s.status,s==="fulfilled"||s==="rejected"}function oe(s,o,p){switch(p=s[p],p===void 0?s.push(o):p!==o&&(o.then($s,$s),o=p),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Me(s),s;default:if(typeof o.status=="string")o.then($s,$s);else{if(s=ds,s!==null&&100<s.shellSuspendCounter)throw Error(l(482));s=o,s.status="pending",s.then(function(w){if(o.status==="pending"){var P=o;P.status="fulfilled",P.value=w}},function(w){if(o.status==="pending"){var P=o;P.status="rejected",P.reason=w}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Me(s),s}throw _e=o,O}}function fe(s){try{var o=s._init;return o(s._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(_e=p,O):p}}var _e=null;function ke(){if(_e===null)throw Error(l(459));var s=_e;return _e=null,s}function Me(s){if(s===O||s===H)throw Error(l(483))}var Pe=null,Le=0;function Te(s){var o=Le;return Le+=1,Pe===null&&(Pe=[]),oe(Pe,s,o)}function $e(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Ve(s,o){throw o.$$typeof===V?Error(l(525)):(s=Object.prototype.toString.call(o),Error(l(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function it(s){function o(Qe,Ue){if(s){var ut=Qe.deletions;ut===null?(Qe.deletions=[Ue],Qe.flags|=16):ut.push(Ue)}}function p(Qe,Ue){if(!s)return null;for(;Ue!==null;)o(Qe,Ue),Ue=Ue.sibling;return null}function w(Qe){for(var Ue=new Map;Qe!==null;)Qe.key!==null?Ue.set(Qe.key,Qe):Ue.set(Qe.index,Qe),Qe=Qe.sibling;return Ue}function P(Qe,Ue){return Qe=Hr(Qe,Ue),Qe.index=0,Qe.sibling=null,Qe}function D(Qe,Ue,ut){return Qe.index=ut,s?(ut=Qe.alternate,ut!==null?(ut=ut.index,ut<Ue?(Qe.flags|=67108866,Ue):ut):(Qe.flags|=67108866,Ue)):(Qe.flags|=1048576,Ue)}function W(Qe){return s&&Qe.alternate===null&&(Qe.flags|=67108866),Qe}function pe(Qe,Ue,ut,Pt){return Ue===null||Ue.tag!==6?(Ue=pl(ut,Qe.mode,Pt),Ue.return=Qe,Ue):(Ue=P(Ue,ut),Ue.return=Qe,Ue)}function Re(Qe,Ue,ut,Pt){var Ni=ut.type;return Ni===ne?Et(Qe,Ue,ut.props.children,Pt,ut.key):Ue!==null&&(Ue.elementType===Ni||typeof Ni=="object"&&Ni!==null&&Ni.$$typeof===He&&fe(Ni)===Ue.type)?(Ue=P(Ue,ut.props),$e(Ue,ut),Ue.return=Qe,Ue):(Ue=fl(ut.type,ut.key,ut.props,null,Qe.mode,Pt),$e(Ue,ut),Ue.return=Qe,Ue)}function dt(Qe,Ue,ut,Pt){return Ue===null||Ue.tag!==4||Ue.stateNode.containerInfo!==ut.containerInfo||Ue.stateNode.implementation!==ut.implementation?(Ue=oc(ut,Qe.mode,Pt),Ue.return=Qe,Ue):(Ue=P(Ue,ut.children||[]),Ue.return=Qe,Ue)}function Et(Qe,Ue,ut,Pt,Ni){return Ue===null||Ue.tag!==7?(Ue=Zr(ut,Qe.mode,Pt,Ni),Ue.return=Qe,Ue):(Ue=P(Ue,ut),Ue.return=Qe,Ue)}function Lt(Qe,Ue,ut){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return Ue=pl(""+Ue,Qe.mode,ut),Ue.return=Qe,Ue;if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case K:return ut=fl(Ue.type,Ue.key,Ue.props,null,Qe.mode,ut),$e(ut,Ue),ut.return=Qe,ut;case ie:return Ue=oc(Ue,Qe.mode,ut),Ue.return=Qe,Ue;case He:return Ue=fe(Ue),Lt(Qe,Ue,ut)}if(St(Ue)||Ke(Ue))return Ue=Zr(Ue,Qe.mode,ut,null),Ue.return=Qe,Ue;if(typeof Ue.then=="function")return Lt(Qe,Te(Ue),ut);if(Ue.$$typeof===ae)return Lt(Qe,yl(Qe,Ue),ut);Ve(Qe,Ue)}return null}function ft(Qe,Ue,ut,Pt){var Ni=Ue!==null?Ue.key:null;if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Ni!==null?null:pe(Qe,Ue,""+ut,Pt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case K:return ut.key===Ni?Re(Qe,Ue,ut,Pt):null;case ie:return ut.key===Ni?dt(Qe,Ue,ut,Pt):null;case He:return ut=fe(ut),ft(Qe,Ue,ut,Pt)}if(St(ut)||Ke(ut))return Ni!==null?null:Et(Qe,Ue,ut,Pt,null);if(typeof ut.then=="function")return ft(Qe,Ue,Te(ut),Pt);if(ut.$$typeof===ae)return ft(Qe,Ue,yl(Qe,ut),Pt);Ve(Qe,ut)}return null}function yt(Qe,Ue,ut,Pt,Ni){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number"||typeof Pt=="bigint")return Qe=Qe.get(ut)||null,pe(Ue,Qe,""+Pt,Ni);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case K:return Qe=Qe.get(Pt.key===null?ut:Pt.key)||null,Re(Ue,Qe,Pt,Ni);case ie:return Qe=Qe.get(Pt.key===null?ut:Pt.key)||null,dt(Ue,Qe,Pt,Ni);case He:return Pt=fe(Pt),yt(Qe,Ue,ut,Pt,Ni)}if(St(Pt)||Ke(Pt))return Qe=Qe.get(ut)||null,Et(Ue,Qe,Pt,Ni,null);if(typeof Pt.then=="function")return yt(Qe,Ue,ut,Te(Pt),Ni);if(Pt.$$typeof===ae)return yt(Qe,Ue,ut,yl(Ue,Pt),Ni);Ve(Ue,Pt)}return null}function xi(Qe,Ue,ut,Pt){for(var Ni=null,is=null,Mi=Ue,wn=Ue=0,Dn=null;Mi!==null&&wn<ut.length;wn++){Mi.index>wn?(Dn=Mi,Mi=null):Dn=Mi.sibling;var ns=ft(Qe,Mi,ut[wn],Pt);if(ns===null){Mi===null&&(Mi=Dn);break}s&&Mi&&ns.alternate===null&&o(Qe,Mi),Ue=D(ns,Ue,wn),is===null?Ni=ns:is.sibling=ns,is=ns,Mi=Dn}if(wn===ut.length)return p(Qe,Mi),jt&&Si(Qe,wn),Ni;if(Mi===null){for(;wn<ut.length;wn++)Mi=Lt(Qe,ut[wn],Pt),Mi!==null&&(Ue=D(Mi,Ue,wn),is===null?Ni=Mi:is.sibling=Mi,is=Mi);return jt&&Si(Qe,wn),Ni}for(Mi=w(Mi);wn<ut.length;wn++)Dn=yt(Mi,Qe,wn,ut[wn],Pt),Dn!==null&&(s&&Dn.alternate!==null&&Mi.delete(Dn.key===null?wn:Dn.key),Ue=D(Dn,Ue,wn),is===null?Ni=Dn:is.sibling=Dn,is=Dn);return s&&Mi.forEach(function($h){return o(Qe,$h)}),jt&&Si(Qe,wn),Ni}function Fi(Qe,Ue,ut,Pt){if(ut==null)throw Error(l(151));for(var Ni=null,is=null,Mi=Ue,wn=Ue=0,Dn=null,ns=ut.next();Mi!==null&&!ns.done;wn++,ns=ut.next()){Mi.index>wn?(Dn=Mi,Mi=null):Dn=Mi.sibling;var $h=ft(Qe,Mi,ns.value,Pt);if($h===null){Mi===null&&(Mi=Dn);break}s&&Mi&&$h.alternate===null&&o(Qe,Mi),Ue=D($h,Ue,wn),is===null?Ni=$h:is.sibling=$h,is=$h,Mi=Dn}if(ns.done)return p(Qe,Mi),jt&&Si(Qe,wn),Ni;if(Mi===null){for(;!ns.done;wn++,ns=ut.next())ns=Lt(Qe,ns.value,Pt),ns!==null&&(Ue=D(ns,Ue,wn),is===null?Ni=ns:is.sibling=ns,is=ns);return jt&&Si(Qe,wn),Ni}for(Mi=w(Mi);!ns.done;wn++,ns=ut.next())ns=yt(Mi,Qe,wn,ns.value,Pt),ns!==null&&(s&&ns.alternate!==null&&Mi.delete(ns.key===null?wn:ns.key),Ue=D(ns,Ue,wn),is===null?Ni=ns:is.sibling=ns,is=ns);return s&&Mi.forEach(function(T2){return o(Qe,T2)}),jt&&Si(Qe,wn),Ni}function vs(Qe,Ue,ut,Pt){if(typeof ut=="object"&&ut!==null&&ut.type===ne&&ut.key===null&&(ut=ut.props.children),typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case K:e:{for(var Ni=ut.key;Ue!==null;){if(Ue.key===Ni){if(Ni=ut.type,Ni===ne){if(Ue.tag===7){p(Qe,Ue.sibling),Pt=P(Ue,ut.props.children),Pt.return=Qe,Qe=Pt;break e}}else if(Ue.elementType===Ni||typeof Ni=="object"&&Ni!==null&&Ni.$$typeof===He&&fe(Ni)===Ue.type){p(Qe,Ue.sibling),Pt=P(Ue,ut.props),$e(Pt,ut),Pt.return=Qe,Qe=Pt;break e}p(Qe,Ue);break}else o(Qe,Ue);Ue=Ue.sibling}ut.type===ne?(Pt=Zr(ut.props.children,Qe.mode,Pt,ut.key),Pt.return=Qe,Qe=Pt):(Pt=fl(ut.type,ut.key,ut.props,null,Qe.mode,Pt),$e(Pt,ut),Pt.return=Qe,Qe=Pt)}return W(Qe);case ie:e:{for(Ni=ut.key;Ue!==null;){if(Ue.key===Ni)if(Ue.tag===4&&Ue.stateNode.containerInfo===ut.containerInfo&&Ue.stateNode.implementation===ut.implementation){p(Qe,Ue.sibling),Pt=P(Ue,ut.children||[]),Pt.return=Qe,Qe=Pt;break e}else{p(Qe,Ue);break}else o(Qe,Ue);Ue=Ue.sibling}Pt=oc(ut,Qe.mode,Pt),Pt.return=Qe,Qe=Pt}return W(Qe);case He:return ut=fe(ut),vs(Qe,Ue,ut,Pt)}if(St(ut))return xi(Qe,Ue,ut,Pt);if(Ke(ut)){if(Ni=Ke(ut),typeof Ni!="function")throw Error(l(150));return ut=Ni.call(ut),Fi(Qe,Ue,ut,Pt)}if(typeof ut.then=="function")return vs(Qe,Ue,Te(ut),Pt);if(ut.$$typeof===ae)return vs(Qe,Ue,yl(Qe,ut),Pt);Ve(Qe,ut)}return typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint"?(ut=""+ut,Ue!==null&&Ue.tag===6?(p(Qe,Ue.sibling),Pt=P(Ue,ut),Pt.return=Qe,Qe=Pt):(p(Qe,Ue),Pt=pl(ut,Qe.mode,Pt),Pt.return=Qe,Qe=Pt),W(Qe)):p(Qe,Ue)}return function(Qe,Ue,ut,Pt){try{Le=0;var Ni=vs(Qe,Ue,ut,Pt);return Pe=null,Ni}catch(Mi){if(Mi===O||Mi===H)throw Mi;var is=Ks(29,Mi,null,Qe.mode);return is.lanes=Pt,is.return=Qe,is}}}var bt=it(!0),Ut=it(!1),qt=!1;function ii(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ht(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ft(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function oi(s,o,p){var w=s.updateQueue;if(w===null)return null;if(w=w.shared,(qn&2)!==0){var P=w.pending;return P===null?o.next=o:(o.next=P.next,P.next=o),w.pending=o,o=Fa(s),po(s,null,p),o}return As(s,w,o,p),Fa(s)}function ji(s,o,p){if(o=o.updateQueue,o!==null&&(o=o.shared,(p&4194048)!==0)){var w=o.lanes;w&=s.pendingLanes,p|=w,o.lanes=p,Je(s,p)}}function Zt(s,o){var p=s.updateQueue,w=s.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var P=null,D=null;if(p=p.firstBaseUpdate,p!==null){do{var W={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};D===null?P=D=W:D=D.next=W,p=p.next}while(p!==null);D===null?P=D=o:D=D.next=o}else P=D=o;p={baseState:w.baseState,firstBaseUpdate:P,lastBaseUpdate:D,shared:w.shared,callbacks:w.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=o:s.next=o,p.lastBaseUpdate=o}var Xt=!1;function Ii(){if(Xt){var s=xl;if(s!==null)throw s}}function Vn(s,o,p,w){Xt=!1;var P=s.updateQueue;qt=!1;var D=P.firstBaseUpdate,W=P.lastBaseUpdate,pe=P.shared.pending;if(pe!==null){P.shared.pending=null;var Re=pe,dt=Re.next;Re.next=null,W===null?D=dt:W.next=dt,W=Re;var Et=s.alternate;Et!==null&&(Et=Et.updateQueue,pe=Et.lastBaseUpdate,pe!==W&&(pe===null?Et.firstBaseUpdate=dt:pe.next=dt,Et.lastBaseUpdate=Re))}if(D!==null){var Lt=P.baseState;W=0,Et=dt=Re=null,pe=D;do{var ft=pe.lane&-536870913,yt=ft!==pe.lane;if(yt?(En&ft)===ft:(w&ft)===ft){ft!==0&&ft===vl&&(Xt=!0),Et!==null&&(Et=Et.next={lane:0,tag:pe.tag,payload:pe.payload,callback:null,next:null});e:{var xi=s,Fi=pe;ft=o;var vs=p;switch(Fi.tag){case 1:if(xi=Fi.payload,typeof xi=="function"){Lt=xi.call(vs,Lt,ft);break e}Lt=xi;break e;case 3:xi.flags=xi.flags&-65537|128;case 0:if(xi=Fi.payload,ft=typeof xi=="function"?xi.call(vs,Lt,ft):xi,ft==null)break e;Lt=N({},Lt,ft);break e;case 2:qt=!0}}ft=pe.callback,ft!==null&&(s.flags|=64,yt&&(s.flags|=8192),yt=P.callbacks,yt===null?P.callbacks=[ft]:yt.push(ft))}else yt={lane:ft,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},Et===null?(dt=Et=yt,Re=Lt):Et=Et.next=yt,W|=ft;if(pe=pe.next,pe===null){if(pe=P.shared.pending,pe===null)break;yt=pe,pe=yt.next,yt.next=null,P.lastBaseUpdate=yt,P.shared.pending=null}}while(!0);Et===null&&(Re=Lt),P.baseState=Re,P.firstBaseUpdate=dt,P.lastBaseUpdate=Et,D===null&&(P.shared.lanes=0),ru|=W,s.lanes=W,s.memoizedState=Lt}}function Xi(s,o){if(typeof s!="function")throw Error(l(191,s));s.call(o)}function un(s,o){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Xi(p[s],o)}var $n=be(null),Qs=be(0);function Ha(s,o){s=Fo,et(Qs,s),et($n,o),Fo=s|o.baseLanes}function Jn(){et(Qs,Fo),et($n,$n.current)}function Lr(){Fo=Qs.current,Ie($n),Ie(Qs)}var rs=be(null),as=null;function Ms(s){var o=s.alternate;et(Rn,Rn.current&1),et(rs,s),as===null&&(o===null||$n.current!==null||o.memoizedState!==null)&&(as=s)}function Za(s){et(Rn,Rn.current),et(rs,s),as===null&&(as=s)}function uc(s){s.tag===22?(et(Rn,Rn.current),et(rs,s),as===null&&(as=s)):go()}function go(){et(Rn,Rn.current),et(rs,rs.current)}function sr(s){Ie(rs),as===s&&(as=null),Ie(Rn)}var Rn=be(0);function hc(s){for(var o=s;o!==null;){if(o.tag===13){var p=o.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Dt(p)||Qt(p)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var yo=0,Ri=null,gn=null,os=null,ha=!1,Ps=!1,Is=!1,zr=0,sn=0,Ga=null,Hc=0;function ls(){throw Error(l(321))}function ch(s,o){if(o===null)return!1;for(var p=0;p<o.length&&p<s.length;p++)if(!Vs(s[p],o[p]))return!1;return!0}function id(s,o,p,w,P,D){return yo=D,Ri=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Be.H=s===null||s.memoizedState===null?hg:Lp,Is=!1,D=p(w,P),Is=!1,Ps&&(D=bl(o,p,w,P)),nd(s),D}function nd(s){Be.H=ud;var o=gn!==null&&gn.next!==null;if(yo=0,os=gn=Ri=null,ha=!1,sn=0,Ga=null,o)throw Error(l(300));s===null||Os||(s=s.dependencies,s!==null&&oh(s)&&(Os=!0))}function bl(s,o,p,w){Ri=s;var P=0;do{if(Ps&&(Ga=null),sn=0,Ps=!1,25<=P)throw Error(l(301));if(P+=1,os=gn=null,s.updateQueue!=null){var D=s.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Be.H=zp,D=o(p,w)}while(Ps);return D}function rf(){var s=Be.H,o=s.useState()[0];return o=typeof o.then=="function"?Wc(o):o,s=s.useState()[0],(gn!==null?gn.memoizedState:null)!==s&&(Ri.flags|=1024),o}function Zc(){var s=zr!==0;return zr=0,s}function dc(s,o,p){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~p}function Gc(s){if(ha){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}ha=!1}yo=0,os=gn=Ri=null,Ps=!1,sn=zr=0,Ga=null}function rr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return os===null?Ri.memoizedState=os=s:os=os.next=s,os}function hs(){if(gn===null){var s=Ri.alternate;s=s!==null?s.memoizedState:null}else s=gn.next;var o=os===null?Ri.memoizedState:os.next;if(o!==null)os=o,gn=s;else{if(s===null)throw Ri.alternate===null?Error(l(467)):Error(l(310));gn=s,s={memoizedState:gn.memoizedState,baseState:gn.baseState,baseQueue:gn.baseQueue,queue:gn.queue,next:null},os===null?Ri.memoizedState=os=s:os=os.next=s}return os}function Fl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wc(s){var o=sn;return sn+=1,Ga===null&&(Ga=[]),s=oe(Ga,s,o),o=Ri,(os===null?o.memoizedState:os.next)===null&&(o=o.alternate,Be.H=o===null||o.memoizedState===null?hg:Lp),s}function sd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Wc(s);if(s.$$typeof===ae)return nn(s)}throw Error(l(438,String(s)))}function af(s){var o=null,p=Ri.updateQueue;if(p!==null&&(o=p.memoCache),o==null){var w=Ri.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(o={data:w.data.map(function(P){return P.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),p===null&&(p=Fl(),Ri.updateQueue=p),p.memoCache=o,p=o.data[o.index],p===void 0)for(p=o.data[o.index]=Array(s),w=0;w<s;w++)p[w]=st;return o.index++,p}function fc(s,o){return typeof o=="function"?o(s):o}function uh(s){var o=hs();return Pu(o,gn,s)}function Pu(s,o,p){var w=s.queue;if(w===null)throw Error(l(311));w.lastRenderedReducer=p;var P=s.baseQueue,D=w.pending;if(D!==null){if(P!==null){var W=P.next;P.next=D.next,D.next=W}o.baseQueue=P=D,w.pending=null}if(D=s.baseState,P===null)s.memoizedState=D;else{o=P.next;var pe=W=null,Re=null,dt=o,Et=!1;do{var Lt=dt.lane&-536870913;if(Lt!==dt.lane?(En&Lt)===Lt:(yo&Lt)===Lt){var ft=dt.revertLane;if(ft===0)Re!==null&&(Re=Re.next={lane:0,revertLane:0,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),Lt===vl&&(Et=!0);else if((yo&ft)===ft){dt=dt.next,ft===vl&&(Et=!0);continue}else Lt={lane:0,revertLane:dt.revertLane,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},Re===null?(pe=Re=Lt,W=D):Re=Re.next=Lt,Ri.lanes|=ft,ru|=ft;Lt=dt.action,Is&&p(D,Lt),D=dt.hasEagerState?dt.eagerState:p(D,Lt)}else ft={lane:Lt,revertLane:dt.revertLane,gesture:dt.gesture,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},Re===null?(pe=Re=ft,W=D):Re=Re.next=ft,Ri.lanes|=Lt,ru|=Lt;dt=dt.next}while(dt!==null&&dt!==o);if(Re===null?W=D:Re.next=pe,!Vs(D,s.memoizedState)&&(Os=!0,Et&&(p=xl,p!==null)))throw p;s.memoizedState=D,s.baseState=W,s.baseQueue=Re,w.lastRenderedState=D}return P===null&&(w.lanes=0),[s.memoizedState,w.dispatch]}function Yc(s){var o=hs(),p=o.queue;if(p===null)throw Error(l(311));p.lastRenderedReducer=s;var w=p.dispatch,P=p.pending,D=o.memoizedState;if(P!==null){p.pending=null;var W=P=P.next;do D=s(D,W.action),W=W.next;while(W!==P);Vs(D,o.memoizedState)||(Os=!0),o.memoizedState=D,o.baseQueue===null&&(o.baseState=D),p.lastRenderedState=D}return[D,w]}function Vl(s,o,p){var w=Ri,P=hs(),D=jt;if(D){if(p===void 0)throw Error(l(407));p=p()}else p=o();var W=!Vs((gn||P).memoizedState,p);if(W&&(P.memoizedState=p,Os=!0),P=P.queue,Iu(yp.bind(null,w,P,s),[s]),P.getSnapshot!==o||W||os!==null&&os.memoizedState.tag&1){if(w.flags|=2048,Qc(9,{destroy:void 0},pc.bind(null,w,P,p,o),null),ds===null)throw Error(l(349));D||(yo&127)!==0||Bo(w,o,p)}return p}function Bo(s,o,p){s.flags|=16384,s={getSnapshot:o,value:p},o=Ri.updateQueue,o===null?(o=Fl(),Ri.updateQueue=o,o.stores=[s]):(p=o.stores,p===null?o.stores=[s]:p.push(s))}function pc(s,o,p,w){o.value=p,o.getSnapshot=w,Xc(o)&&ng(s)}function yp(s,o,p){return p(function(){Xc(o)&&ng(s)})}function Xc(s){var o=s.getSnapshot;s=s.value;try{var p=o();return!Vs(s,p)}catch{return!0}}function ng(s){var o=ua(s,2);o!==null&&da(o,s,2)}function of(s){var o=rr();if(typeof s=="function"){var p=s;if(s=p(),Is){ti(!0);try{p()}finally{ti(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:s},o}function Ds(s,o,p,w){return s.baseState=p,Pu(s,gn,typeof w=="function"?w:fc)}function _p(s,o,p,w,P){if(ff(s))throw Error(l(485));if(s=o.action,s!==null){var D={payload:P,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){D.listeners.push(W)}};Be.T!==null?p(!0):D.isTransition=!1,w(D),p=o.pending,p===null?(D.next=o.pending=D,vp(o,D)):(D.next=p.next,o.pending=p.next=D)}}function vp(s,o){var p=o.action,w=o.payload,P=s.state;if(o.isTransition){var D=Be.T,W={};Be.T=W;try{var pe=p(P,w),Re=Be.S;Re!==null&&Re(W,pe),Kc(s,o,pe)}catch(dt){hh(s,o,dt)}finally{D!==null&&W.types!==null&&(D.types=W.types),Be.T=D}}else try{D=p(P,w),Kc(s,o,D)}catch(dt){hh(s,o,dt)}}function Kc(s,o,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(w){Jc(s,o,w)},function(w){return hh(s,o,w)}):Jc(s,o,p)}function Jc(s,o,p){o.status="fulfilled",o.value=p,lf(o),s.state=p,o=s.pending,o!==null&&(p=o.next,p===o?s.pending=null:(p=p.next,o.next=p,vp(s,p)))}function hh(s,o,p){var w=s.pending;if(s.pending=null,w!==null){w=w.next;do o.status="rejected",o.reason=p,lf(o),o=o.next;while(o!==w)}s.action=null}function lf(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function xp(s,o){return o}function sg(s,o){if(jt){var p=ds.formState;if(p!==null){e:{var w=Ri;if(jt){if(Qi){t:{for(var P=Qi,D=jr;P.nodeType!==8;){if(!D){P=null;break t}if(P=Vt(P.nextSibling),P===null){P=null;break t}}D=P.data,P=D==="F!"||D==="F"?P:null}if(P){Qi=Vt(P.nextSibling),w=P.data==="F!";break e}}Gr(w)}w=!1}w&&(o=p[0])}}return p=rr(),p.memoizedState=p.baseState=o,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xp,lastRenderedState:o},p.queue=w,p=Wa.bind(null,Ri,w),w.dispatch=p,w=of(!1),D=cd.bind(null,Ri,!1,w.queue),w=rr(),P={state:o,dispatch:null,action:s,pending:null},w.queue=P,p=_p.bind(null,Ri,P,D,p),P.dispatch=p,w.memoizedState=s,[o,p,!1]}function bp(s){var o=hs();return rg(o,gn,s)}function rg(s,o,p){if(o=Pu(s,o,xp)[0],s=uh(fc)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var w=Wc(o)}catch(W){throw W===O?H:W}else w=o;o=hs();var P=o.queue,D=P.dispatch;return p!==o.memoizedState&&(Ri.flags|=2048,Qc(9,{destroy:void 0},wp.bind(null,P,p),null)),[w,D,s]}function wp(s,o){s.action=o}function ag(s){var o=hs(),p=gn;if(p!==null)return rg(o,p,s);hs(),o=o.memoizedState,p=hs();var w=p.queue.dispatch;return p.memoizedState=s,[o,w,!1]}function Qc(s,o,p,w){return s={tag:s,create:p,deps:w,inst:o,next:null},o=Ri.updateQueue,o===null&&(o=Fl(),Ri.updateQueue=o),p=o.lastEffect,p===null?o.lastEffect=s.next=s:(w=p.next,p.next=s,s.next=w,o.lastEffect=s),s}function Sp(){return hs().memoizedState}function rd(s,o,p,w){var P=rr();Ri.flags|=s,P.memoizedState=Qc(1|o,{destroy:void 0},p,w===void 0?null:w)}function mc(s,o,p,w){var P=hs();w=w===void 0?null:w;var D=P.memoizedState.inst;gn!==null&&w!==null&&ch(w,gn.memoizedState.deps)?P.memoizedState=Qc(o,D,p,w):(Ri.flags|=s,P.memoizedState=Qc(1|o,D,p,w))}function og(s,o){rd(8390656,8,s,o)}function Iu(s,o){mc(2048,8,s,o)}function cf(s){Ri.flags|=4;var o=Ri.updateQueue;if(o===null)o=Fl(),Ri.updateQueue=o,o.events=[s];else{var p=o.events;p===null?o.events=[s]:p.push(s)}}function ad(s){var o=hs().memoizedState;return cf({ref:o,nextImpl:s}),function(){if((qn&2)!==0)throw Error(l(440));return o.impl.apply(void 0,arguments)}}function Tp(s,o){return mc(4,2,s,o)}function Ep(s,o){return mc(4,4,s,o)}function lg(s,o){if(typeof o=="function"){s=s();var p=o(s);return function(){typeof p=="function"?p():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Yr(s,o,p){p=p!=null?p.concat([s]):null,mc(4,4,lg.bind(null,o,s),p)}function eu(){}function uf(s,o){var p=hs();o=o===void 0?null:o;var w=p.memoizedState;return o!==null&&ch(o,w[1])?w[0]:(p.memoizedState=[s,o],s)}function kp(s,o){var p=hs();o=o===void 0?null:o;var w=p.memoizedState;if(o!==null&&ch(o,w[1]))return w[0];if(w=s(),Is){ti(!0);try{s()}finally{ti(!1)}}return p.memoizedState=[w,o],w}function ju(s,o,p){return p===void 0||(yo&1073741824)!==0&&(En&261930)===0?s.memoizedState=o:(s.memoizedState=p,s=Tf(),Ri.lanes|=s,ru|=s,p)}function cg(s,o,p,w){return Vs(p,o)?p:$n.current!==null?(s=ju(s,p,w),Vs(s,o)||(Os=!0),s):(yo&42)===0||(yo&1073741824)!==0&&(En&261930)===0?(Os=!0,s.memoizedState=p):(s=Tf(),Ri.lanes|=s,ru|=s,o)}function od(s,o,p,w,P){var D=ot.p;ot.p=D!==0&&8>D?D:8;var W=Be.T,pe={};Be.T=pe,cd(s,!1,o,p);try{var Re=P(),dt=Be.S;if(dt!==null&&dt(pe,Re),Re!==null&&typeof Re=="object"&&typeof Re.then=="function"){var Et=i(Re,w);dh(s,o,Et,xo(s))}else dh(s,o,w,xo(s))}catch(Lt){dh(s,o,{then:function(){},status:"rejected",reason:Lt},xo())}finally{ot.p=D,W!==null&&pe.types!==null&&(W.types=pe.types),Be.T=W}}function __(){}function hf(s,o,p,w){if(s.tag!==5)throw Error(l(476));var P=Cp(s).queue;od(s,P,o,Fe,p===null?__:function(){return Ap(s),p(w)})}function Cp(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:Fe,baseState:Fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:Fe},next:null};var p={};return o.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:p},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Ap(s){var o=Cp(s);o.next===null&&(o=s.alternate.memoizedState),dh(s,o.next.queue,{},xo())}function Mp(){return nn(Nh)}function df(){return hs().memoizedState}function Pp(){return hs().memoizedState}function Ip(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var p=xo();s=Ft(p);var w=oi(o,s,p);w!==null&&(da(w,o,p),ji(w,o,p)),o={cache:qa()},s.payload=o;return}o=o.return}}function ld(s,o,p){var w=xo();p={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},ff(s)?jp(o,p):(p=dl(s,o,p,w),p!==null&&(da(p,s,w),ug(p,o,w)))}function Wa(s,o,p){var w=xo();dh(s,o,p,w)}function dh(s,o,p,w){var P={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(ff(s))jp(o,P);else{var D=s.alternate;if(s.lanes===0&&(D===null||D.lanes===0)&&(D=o.lastRenderedReducer,D!==null))try{var W=o.lastRenderedState,pe=D(W,p);if(P.hasEagerState=!0,P.eagerState=pe,Vs(pe,W))return As(s,o,P,0),ds===null&&xr(),!1}catch{}if(p=dl(s,o,P,w),p!==null)return da(p,s,w),ug(p,o,w),!0}return!1}function cd(s,o,p,w){if(w={lane:2,revertLane:Lh(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},ff(s)){if(o)throw Error(l(479))}else o=dl(s,p,w,2),o!==null&&da(o,s,2)}function ff(s){var o=s.alternate;return s===Ri||o!==null&&o===Ri}function jp(s,o){Ps=ha=!0;var p=s.pending;p===null?o.next=o:(o.next=p.next,p.next=o),s.pending=o}function ug(s,o,p){if((p&4194048)!==0){var w=o.lanes;w&=s.pendingLanes,p|=w,o.lanes=p,Je(s,p)}}var ud={readContext:nn,use:sd,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useLayoutEffect:ls,useInsertionEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useSyncExternalStore:ls,useId:ls,useHostTransitionStatus:ls,useFormState:ls,useActionState:ls,useOptimistic:ls,useMemoCache:ls,useCacheRefresh:ls};ud.useEffectEvent=ls;var hg={readContext:nn,use:sd,useCallback:function(s,o){return rr().memoizedState=[s,o===void 0?null:o],s},useContext:nn,useEffect:og,useImperativeHandle:function(s,o,p){p=p!=null?p.concat([s]):null,rd(4194308,4,lg.bind(null,o,s),p)},useLayoutEffect:function(s,o){return rd(4194308,4,s,o)},useInsertionEffect:function(s,o){rd(4,2,s,o)},useMemo:function(s,o){var p=rr();o=o===void 0?null:o;var w=s();if(Is){ti(!0);try{s()}finally{ti(!1)}}return p.memoizedState=[w,o],w},useReducer:function(s,o,p){var w=rr();if(p!==void 0){var P=p(o);if(Is){ti(!0);try{p(o)}finally{ti(!1)}}}else P=o;return w.memoizedState=w.baseState=P,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:P},w.queue=s,s=s.dispatch=ld.bind(null,Ri,s),[w.memoizedState,s]},useRef:function(s){var o=rr();return s={current:s},o.memoizedState=s},useState:function(s){s=of(s);var o=s.queue,p=Wa.bind(null,Ri,o);return o.dispatch=p,[s.memoizedState,p]},useDebugValue:eu,useDeferredValue:function(s,o){var p=rr();return ju(p,s,o)},useTransition:function(){var s=of(!1);return s=od.bind(null,Ri,s.queue,!0,!1),rr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,p){var w=Ri,P=rr();if(jt){if(p===void 0)throw Error(l(407));p=p()}else{if(p=o(),ds===null)throw Error(l(349));(En&127)!==0||Bo(w,o,p)}P.memoizedState=p;var D={value:p,getSnapshot:o};return P.queue=D,og(yp.bind(null,w,D,s),[s]),w.flags|=2048,Qc(9,{destroy:void 0},pc.bind(null,w,D,p,o),null),p},useId:function(){var s=rr(),o=ds.identifierPrefix;if(jt){var p=Yt,w=wt;p=(w&~(1<<32-Ji(w)-1)).toString(32)+p,o="_"+o+"R_"+p,p=zr++,0<p&&(o+="H"+p.toString(32)),o+="_"}else p=Hc++,o="_"+o+"r_"+p.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:Mp,useFormState:sg,useActionState:sg,useOptimistic:function(s){var o=rr();o.memoizedState=o.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=p,o=cd.bind(null,Ri,!0,p),p.dispatch=o,[s,o]},useMemoCache:af,useCacheRefresh:function(){return rr().memoizedState=Ip.bind(null,Ri)},useEffectEvent:function(s){var o=rr(),p={impl:s};return o.memoizedState=p,function(){if((qn&2)!==0)throw Error(l(440));return p.impl.apply(void 0,arguments)}}},Lp={readContext:nn,use:sd,useCallback:uf,useContext:nn,useEffect:Iu,useImperativeHandle:Yr,useInsertionEffect:Tp,useLayoutEffect:Ep,useMemo:kp,useReducer:uh,useRef:Sp,useState:function(){return uh(fc)},useDebugValue:eu,useDeferredValue:function(s,o){var p=hs();return cg(p,gn.memoizedState,s,o)},useTransition:function(){var s=uh(fc)[0],o=hs().memoizedState;return[typeof s=="boolean"?s:Wc(s),o]},useSyncExternalStore:Vl,useId:df,useHostTransitionStatus:Mp,useFormState:bp,useActionState:bp,useOptimistic:function(s,o){var p=hs();return Ds(p,gn,s,o)},useMemoCache:af,useCacheRefresh:Pp};Lp.useEffectEvent=ad;var zp={readContext:nn,use:sd,useCallback:uf,useContext:nn,useEffect:Iu,useImperativeHandle:Yr,useInsertionEffect:Tp,useLayoutEffect:Ep,useMemo:kp,useReducer:Yc,useRef:Sp,useState:function(){return Yc(fc)},useDebugValue:eu,useDeferredValue:function(s,o){var p=hs();return gn===null?ju(p,s,o):cg(p,gn.memoizedState,s,o)},useTransition:function(){var s=Yc(fc)[0],o=hs().memoizedState;return[typeof s=="boolean"?s:Wc(s),o]},useSyncExternalStore:Vl,useId:df,useHostTransitionStatus:Mp,useFormState:ag,useActionState:ag,useOptimistic:function(s,o){var p=hs();return gn!==null?Ds(p,gn,s,o):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:af,useCacheRefresh:Pp};zp.useEffectEvent=ad;function pf(s,o,p,w){o=s.memoizedState,p=p(w,o),p=p==null?o:N({},o,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var gc={enqueueSetState:function(s,o,p){s=s._reactInternals;var w=xo(),P=Ft(w);P.payload=o,p!=null&&(P.callback=p),o=oi(s,P,w),o!==null&&(da(o,s,w),ji(o,s,w))},enqueueReplaceState:function(s,o,p){s=s._reactInternals;var w=xo(),P=Ft(w);P.tag=1,P.payload=o,p!=null&&(P.callback=p),o=oi(s,P,w),o!==null&&(da(o,s,w),ji(o,s,w))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var p=xo(),w=Ft(p);w.tag=2,o!=null&&(w.callback=o),o=oi(s,w,p),o!==null&&(da(o,s,p),ji(o,s,p))}};function fh(s,o,p,w,P,D,W){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(w,D,W):o.prototype&&o.prototype.isPureReactComponent?!on(p,w)||!on(P,D):!0}function dg(s,o,p,w){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(p,w),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(p,w),o.state!==s&&gc.enqueueReplaceState(o,o.state,null)}function Lu(s,o){var p=o;if("ref"in o){p={};for(var w in o)w!=="ref"&&(p[w]=o[w])}if(s=s.defaultProps){p===o&&(p=N({},p));for(var P in s)p[P]===void 0&&(p[P]=s[P])}return p}function fg(s){Ea(s)}function pg(s){console.error(s)}function mg(s){Ea(s)}function mf(s,o){try{var p=s.onUncaughtError;p(o.value,{componentStack:o.stack})}catch(w){setTimeout(function(){throw w})}}function gg(s,o,p){try{var w=s.onCaughtError;w(p.value,{componentStack:p.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(P){setTimeout(function(){throw P})}}function hd(s,o,p){return p=Ft(p),p.tag=3,p.payload={element:null},p.callback=function(){mf(s,o)},p}function yg(s){return s=Ft(s),s.tag=3,s}function zu(s,o,p,w){var P=p.type.getDerivedStateFromError;if(typeof P=="function"){var D=w.value;s.payload=function(){return P(D)},s.callback=function(){gg(o,p,w)}}var W=p.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(s.callback=function(){gg(o,p,w),typeof P!="function"&&(bc===null?bc=new Set([this]):bc.add(this));var pe=w.stack;this.componentDidCatch(w.value,{componentStack:pe!==null?pe:""})})}function v_(s,o,p,w,P){if(p.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(o=p.alternate,o!==null&&qc(o,p,P,!0),p=rs.current,p!==null){switch(p.tag){case 31:case 13:return as===null?Ef():p.alternate===null&&Es===0&&(Es=3),p.flags&=-257,p.flags|=65536,p.lanes=P,w===Y?p.flags|=16384:(o=p.updateQueue,o===null?p.updateQueue=new Set([w]):o.add(w),Af(s,w,P)),!1;case 22:return p.flags|=65536,w===Y?p.flags|=16384:(o=p.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([w])},p.updateQueue=o):(p=o.retryQueue,p===null?o.retryQueue=new Set([w]):p.add(w)),Af(s,w,P)),!1}throw Error(l(435,p.tag))}return Af(s,w,P),Ef(),!1}if(jt)return o=rs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=P,w!==lc&&(s=Error(l(422),{cause:w}),gl(b(s,p)))):(w!==lc&&(o=Error(l(423),{cause:w}),gl(b(o,p))),s=s.current.alternate,s.flags|=65536,P&=-P,s.lanes|=P,w=b(w,p),P=hd(s.stateNode,w,P),Zt(s,P),Es!==4&&(Es=2)),!1;var D=Error(l(520),{cause:w});if(D=b(D,p),kh===null?kh=[D]:kh.push(D),Es!==4&&(Es=2),o===null)return!0;w=b(w,p),p=o;do{switch(p.tag){case 3:return p.flags|=65536,s=P&-P,p.lanes|=s,s=hd(p.stateNode,w,s),Zt(p,s),!1;case 1:if(o=p.type,D=p.stateNode,(p.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(bc===null||!bc.has(D))))return p.flags|=65536,P&=-P,p.lanes|=P,P=yg(P),zu(P,s,p,w),Zt(p,P),!1}p=p.return}while(p!==null);return!1}var ws=Error(l(461)),Os=!1;function Rr(s,o,p,w){o.child=s===null?Ut(o,null,p,w):bt(o,s.child,p,w)}function dd(s,o,p,w,P){p=p.render;var D=o.ref;if("ref"in w){var W={};for(var pe in w)pe!=="ref"&&(W[pe]=w[pe])}else W=w;return Js(o),w=id(s,o,p,W,D,P),pe=Zc(),s!==null&&!Os?(dc(s,o,P),ql(s,o,P)):(jt&&pe&&qs(o),o.flags|=1,Rr(s,o,w,P),o.child)}function fd(s,o,p,w,P){if(s===null){var D=p.type;return typeof D=="function"&&!Ul(D)&&D.defaultProps===void 0&&p.compare===null?(o.tag=15,o.type=D,ph(s,o,D,w,P)):(s=fl(p.type,null,w,o,o.mode,P),s.ref=o.ref,s.return=o,o.child=s)}if(D=s.child,!_f(s,P)){var W=D.memoizedProps;if(p=p.compare,p=p!==null?p:on,p(W,w)&&s.ref===o.ref)return ql(s,o,P)}return o.flags|=1,s=Hr(D,w),s.ref=o.ref,s.return=o,o.child=s}function ph(s,o,p,w,P){if(s!==null){var D=s.memoizedProps;if(on(D,w)&&s.ref===o.ref)if(Os=!1,o.pendingProps=w=D,_f(s,P))(s.flags&131072)!==0&&(Os=!0);else return o.lanes=s.lanes,ql(s,o,P)}return yf(s,o,p,w,P)}function Rp(s,o,p,w){var P=w.children,D=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((o.flags&128)!==0){if(D=D!==null?D.baseLanes|p:p,s!==null){for(w=o.child=s.child,P=0;w!==null;)P=P|w.lanes|w.childLanes,w=w.sibling;w=P&~D}else w=0,o.child=null;return gh(s,o,D,p,w)}if((p&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&T(o,D!==null?D.cachePool:null),D!==null?Ha(o,D):Jn(),uc(o);else return w=o.lanes=536870912,gh(s,o,D!==null?D.baseLanes|p:p,p,w)}else D!==null?(T(o,D.cachePool),Ha(o,D),go(),o.memoizedState=null):(s!==null&&T(o,null),Jn(),go());return Rr(s,o,P,p),o.child}function mh(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function gh(s,o,p,w,P){var D=v();return D=D===null?null:{parent:_s._currentValue,pool:D},o.memoizedState={baseLanes:p,cachePool:D},s!==null&&T(o,null),Jn(),uc(o),s!==null&&qc(s,o,w,!0),o.childLanes=P,null}function yh(s,o){return o=pd({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function gf(s,o,p){return bt(o,s.child,null,p),s=yh(o,o.pendingProps),s.flags|=2,sr(o),o.memoizedState=null,s}function Dp(s,o,p){var w=o.pendingProps,P=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(jt){if(w.mode==="hidden")return s=yh(o,w),o.lanes=536870912,mh(null,s);if(Za(o),(s=Qi)?(s=pt(s,jr),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ht!==null?{id:wt,overflow:Yt}:null,retryLane:536870912,hydrationErrors:null},p=ml(s),p.return=o,o.child=p,bn=o,Qi=null)):s=null,s===null)throw Gr(o);return o.lanes=536870912,null}return yh(o,w)}var D=s.memoizedState;if(D!==null){var W=D.dehydrated;if(Za(o),P)if(o.flags&256)o.flags&=-257,o=gf(s,o,p);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(l(558));else if(Os||qc(s,o,p,!1),P=(p&s.childLanes)!==0,Os||P){if(w=ds,w!==null&&(W=ct(w,p),W!==0&&W!==D.retryLane))throw D.retryLane=W,ua(s,W),da(w,s,W),ws;Ef(),o=gf(s,o,p)}else s=D.treeContext,Qi=Vt(W.nextSibling),bn=o,jt=!0,ka=null,jr=!1,s!==null&&wr(o,s),o=yh(o,w),o.flags|=4096;return o}return s=Hr(s.child,{mode:w.mode,children:w.children}),s.ref=o.ref,o.child=s,s.return=o,s}function _h(s,o){var p=o.ref;if(p===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(l(284));(s===null||s.ref!==p)&&(o.flags|=4194816)}}function yf(s,o,p,w,P){return Js(o),p=id(s,o,p,w,void 0,P),w=Zc(),s!==null&&!Os?(dc(s,o,P),ql(s,o,P)):(jt&&w&&qs(o),o.flags|=1,Rr(s,o,p,P),o.child)}function Op(s,o,p,w,P,D){return Js(o),o.updateQueue=null,p=bl(o,w,p,P),nd(s),w=Zc(),s!==null&&!Os?(dc(s,o,D),ql(s,o,D)):(jt&&w&&qs(o),o.flags|=1,Rr(s,o,p,D),o.child)}function _g(s,o,p,w,P){if(Js(o),o.stateNode===null){var D=br,W=p.contextType;typeof W=="object"&&W!==null&&(D=nn(W)),D=new p(w,D),o.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=gc,o.stateNode=D,D._reactInternals=o,D=o.stateNode,D.props=w,D.state=o.memoizedState,D.refs={},ii(o),W=p.contextType,D.context=typeof W=="object"&&W!==null?nn(W):br,D.state=o.memoizedState,W=p.getDerivedStateFromProps,typeof W=="function"&&(pf(o,p,W,w),D.state=o.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(W=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),W!==D.state&&gc.enqueueReplaceState(D,D.state,null),Vn(o,w,D,P),Ii(),D.state=o.memoizedState),typeof D.componentDidMount=="function"&&(o.flags|=4194308),w=!0}else if(s===null){D=o.stateNode;var pe=o.memoizedProps,Re=Lu(p,pe);D.props=Re;var dt=D.context,Et=p.contextType;W=br,typeof Et=="object"&&Et!==null&&(W=nn(Et));var Lt=p.getDerivedStateFromProps;Et=typeof Lt=="function"||typeof D.getSnapshotBeforeUpdate=="function",pe=o.pendingProps!==pe,Et||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(pe||dt!==W)&&dg(o,D,w,W),qt=!1;var ft=o.memoizedState;D.state=ft,Vn(o,w,D,P),Ii(),dt=o.memoizedState,pe||ft!==dt||qt?(typeof Lt=="function"&&(pf(o,p,Lt,w),dt=o.memoizedState),(Re=qt||fh(o,p,Re,w,ft,dt,W))?(Et||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(o.flags|=4194308)):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=w,o.memoizedState=dt),D.props=w,D.state=dt,D.context=W,w=Re):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),w=!1)}else{D=o.stateNode,Ht(s,o),W=o.memoizedProps,Et=Lu(p,W),D.props=Et,Lt=o.pendingProps,ft=D.context,dt=p.contextType,Re=br,typeof dt=="object"&&dt!==null&&(Re=nn(dt)),pe=p.getDerivedStateFromProps,(dt=typeof pe=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(W!==Lt||ft!==Re)&&dg(o,D,w,Re),qt=!1,ft=o.memoizedState,D.state=ft,Vn(o,w,D,P),Ii();var yt=o.memoizedState;W!==Lt||ft!==yt||qt||s!==null&&s.dependencies!==null&&oh(s.dependencies)?(typeof pe=="function"&&(pf(o,p,pe,w),yt=o.memoizedState),(Et=qt||fh(o,p,Et,w,ft,yt,Re)||s!==null&&s.dependencies!==null&&oh(s.dependencies))?(dt||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(w,yt,Re),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(w,yt,Re)),typeof D.componentDidUpdate=="function"&&(o.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof D.componentDidUpdate!="function"||W===s.memoizedProps&&ft===s.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&ft===s.memoizedState||(o.flags|=1024),o.memoizedProps=w,o.memoizedState=yt),D.props=w,D.state=yt,D.context=Re,w=Et):(typeof D.componentDidUpdate!="function"||W===s.memoizedProps&&ft===s.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&ft===s.memoizedState||(o.flags|=1024),w=!1)}return D=w,_h(s,o),w=(o.flags&128)!==0,D||w?(D=o.stateNode,p=w&&typeof p.getDerivedStateFromError!="function"?null:D.render(),o.flags|=1,s!==null&&w?(o.child=bt(o,s.child,null,P),o.child=bt(o,null,p,P)):Rr(s,o,p,P),o.memoizedState=D.state,s=o.child):s=ql(s,o,P),s}function vg(s,o,p,w){return mo(),o.flags|=256,Rr(s,o,p,w),o.child}var Np={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bp(s){return{baseLanes:s,cachePool:z()}}function $p(s,o,p){return s=s!==null?s.childLanes&~p:0,o&&(s|=Ka),s}function yc(s,o,p){var w=o.pendingProps,P=!1,D=(o.flags&128)!==0,W;if((W=D)||(W=s!==null&&s.memoizedState===null?!1:(Rn.current&2)!==0),W&&(P=!0,o.flags&=-129),W=(o.flags&32)!==0,o.flags&=-33,s===null){if(jt){if(P?Ms(o):go(),(s=Qi)?(s=pt(s,jr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ht!==null?{id:wt,overflow:Yt}:null,retryLane:536870912,hydrationErrors:null},p=ml(s),p.return=o,o.child=p,bn=o,Qi=null)):s=null,s===null)throw Gr(o);return Qt(s)?o.lanes=32:o.lanes=536870912,null}var pe=w.children;return w=w.fallback,P?(go(),P=o.mode,pe=pd({mode:"hidden",children:pe},P),w=Zr(w,P,p,null),pe.return=o,w.return=o,pe.sibling=w,o.child=pe,w=o.child,w.memoizedState=Bp(p),w.childLanes=$p(s,W,p),o.memoizedState=Np,mh(null,w)):(Ms(o),Up(o,pe))}var Re=s.memoizedState;if(Re!==null&&(pe=Re.dehydrated,pe!==null)){if(D)o.flags&256?(Ms(o),o.flags&=-257,o=tu(s,o,p)):o.memoizedState!==null?(go(),o.child=s.child,o.flags|=128,o=null):(go(),pe=w.fallback,P=o.mode,w=pd({mode:"visible",children:w.children},P),pe=Zr(pe,P,p,null),pe.flags|=2,w.return=o,pe.return=o,w.sibling=pe,o.child=w,bt(o,s.child,null,p),w=o.child,w.memoizedState=Bp(p),w.childLanes=$p(s,W,p),o.memoizedState=Np,o=mh(null,w));else if(Ms(o),Qt(pe)){if(W=pe.nextSibling&&pe.nextSibling.dataset,W)var dt=W.dgst;W=dt,w=Error(l(419)),w.stack="",w.digest=W,gl({value:w,source:null,stack:null}),o=tu(s,o,p)}else if(Os||qc(s,o,p,!1),W=(p&s.childLanes)!==0,Os||W){if(W=ds,W!==null&&(w=ct(W,p),w!==0&&w!==Re.retryLane))throw Re.retryLane=w,ua(s,w),da(W,s,w),ws;Dt(pe)||Ef(),o=tu(s,o,p)}else Dt(pe)?(o.flags|=192,o.child=s.child,o=null):(s=Re.treeContext,Qi=Vt(pe.nextSibling),bn=o,jt=!0,ka=null,jr=!1,s!==null&&wr(o,s),o=Up(o,w.children),o.flags|=4096);return o}return P?(go(),pe=w.fallback,P=o.mode,Re=s.child,dt=Re.sibling,w=Hr(Re,{mode:"hidden",children:w.children}),w.subtreeFlags=Re.subtreeFlags&65011712,dt!==null?pe=Hr(dt,pe):(pe=Zr(pe,P,p,null),pe.flags|=2),pe.return=o,w.return=o,w.sibling=pe,o.child=w,mh(null,w),w=o.child,pe=s.child.memoizedState,pe===null?pe=Bp(p):(P=pe.cachePool,P!==null?(Re=_s._currentValue,P=P.parent!==Re?{parent:Re,pool:Re}:P):P=z(),pe={baseLanes:pe.baseLanes|p,cachePool:P}),w.memoizedState=pe,w.childLanes=$p(s,W,p),o.memoizedState=Np,mh(s.child,w)):(Ms(o),p=s.child,s=p.sibling,p=Hr(p,{mode:"visible",children:w.children}),p.return=o,p.sibling=null,s!==null&&(W=o.deletions,W===null?(o.deletions=[s],o.flags|=16):W.push(s)),o.child=p,o.memoizedState=null,p)}function Up(s,o){return o=pd({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function pd(s,o){return s=Ks(22,s,null,o),s.lanes=0,s}function tu(s,o,p){return bt(o,s.child,null,p),s=Up(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function xg(s,o,p){s.lanes|=o;var w=s.alternate;w!==null&&(w.lanes|=o),ed(s.return,o,p)}function Fp(s,o,p,w,P,D){var W=s.memoizedState;W===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:P,treeForkCount:D}:(W.isBackwards=o,W.rendering=null,W.renderingStartTime=0,W.last=w,W.tail=p,W.tailMode=P,W.treeForkCount=D)}function bg(s,o,p){var w=o.pendingProps,P=w.revealOrder,D=w.tail;w=w.children;var W=Rn.current,pe=(W&2)!==0;if(pe?(W=W&1|2,o.flags|=128):W&=1,et(Rn,W),Rr(s,o,w,p),w=jt?le:0,!pe&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&xg(s,p,o);else if(s.tag===19)xg(s,p,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(P){case"forwards":for(p=o.child,P=null;p!==null;)s=p.alternate,s!==null&&hc(s)===null&&(P=p),p=p.sibling;p=P,p===null?(P=o.child,o.child=null):(P=p.sibling,p.sibling=null),Fp(o,!1,P,p,D,w);break;case"backwards":case"unstable_legacy-backwards":for(p=null,P=o.child,o.child=null;P!==null;){if(s=P.alternate,s!==null&&hc(s)===null){o.child=P;break}s=P.sibling,P.sibling=p,p=P,P=s}Fp(o,!0,p,null,D,w);break;case"together":Fp(o,!1,null,null,void 0,w);break;default:o.memoizedState=null}return o.child}function ql(s,o,p){if(s!==null&&(o.dependencies=s.dependencies),ru|=o.lanes,(p&o.childLanes)===0)if(s!==null){if(qc(s,o,p,!1),(p&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(l(153));if(o.child!==null){for(s=o.child,p=Hr(s,s.pendingProps),o.child=p,p.return=o;s.sibling!==null;)s=s.sibling,p=p.sibling=Hr(s,s.pendingProps),p.return=o;p.sibling=null}return o.child}function _f(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&oh(s)))}function x_(s,o,p){switch(o.tag){case 3:Kt(o,o.stateNode.containerInfo),Oo(o,_s,s.memoizedState.cache),mo();break;case 27:case 5:Vi(o);break;case 4:Kt(o,o.stateNode.containerInfo);break;case 10:Oo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Za(o),null;break;case 13:var w=o.memoizedState;if(w!==null)return w.dehydrated!==null?(Ms(o),o.flags|=128,null):(p&o.child.childLanes)!==0?yc(s,o,p):(Ms(o),s=ql(s,o,p),s!==null?s.sibling:null);Ms(o);break;case 19:var P=(s.flags&128)!==0;if(w=(p&o.childLanes)!==0,w||(qc(s,o,p,!1),w=(p&o.childLanes)!==0),P){if(w)return bg(s,o,p);o.flags|=128}if(P=o.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),et(Rn,Rn.current),w)break;return null;case 22:return o.lanes=0,Rp(s,o,p,o.pendingProps);case 24:Oo(o,_s,s.memoizedState.cache)}return ql(s,o,p)}function wg(s,o,p){if(s!==null)if(s.memoizedProps!==o.pendingProps)Os=!0;else{if(!_f(s,p)&&(o.flags&128)===0)return Os=!1,x_(s,o,p);Os=(s.flags&131072)!==0}else Os=!1,jt&&(o.flags&1048576)!==0&&ln(o,le,o.index);switch(o.lanes=0,o.tag){case 16:e:{var w=o.pendingProps;if(s=fe(o.elementType),o.type=s,typeof s=="function")Ul(s)?(w=Lu(s,w),o.tag=1,o=_g(null,o,s,w,p)):(o.tag=0,o=yf(null,o,s,w,p));else{if(s!=null){var P=s.$$typeof;if(P===me){o.tag=11,o=dd(null,o,s,w,p);break e}else if(P===ze){o.tag=14,o=fd(null,o,s,w,p);break e}}throw o=gt(s)||s,Error(l(306,o,""))}}return o;case 0:return yf(s,o,o.type,o.pendingProps,p);case 1:return w=o.type,P=Lu(w,o.pendingProps),_g(s,o,w,P,p);case 3:e:{if(Kt(o,o.stateNode.containerInfo),s===null)throw Error(l(387));w=o.pendingProps;var D=o.memoizedState;P=D.element,Ht(s,o),Vn(o,w,null,p);var W=o.memoizedState;if(w=W.cache,Oo(o,_s,w),w!==D.cache&&Cu(o,[_s],p,!0),Ii(),w=W.element,D.isDehydrated)if(D={element:w,isDehydrated:!1,cache:W.cache},o.updateQueue.baseState=D,o.memoizedState=D,o.flags&256){o=vg(s,o,w,p);break e}else if(w!==P){P=b(Error(l(424)),o),gl(P),o=vg(s,o,w,p);break e}else for(s=o.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Qi=Vt(s.firstChild),bn=o,jt=!0,ka=null,jr=!0,p=Ut(o,null,w,p),o.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(mo(),w===P){o=ql(s,o,p);break e}Rr(s,o,w,p)}o=o.child}return o;case 26:return _h(s,o),s===null?(p=kr(o.type,null,o.pendingProps,null))?o.memoizedState=p:jt||(p=o.type,s=o.pendingProps,w=x(Ct.current).createElement(p),w[At]=o,w[ni]=s,Tr(w,p,s),vn(w),o.stateNode=w):o.memoizedState=kr(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Vi(o),s===null&&jt&&(w=o.stateNode=ri(o.type,o.pendingProps,Ct.current),bn=o,jr=!0,P=Qi,he(o.type)?(Gt=P,Qi=Vt(w.firstChild)):Qi=P),Rr(s,o,o.pendingProps.children,p),_h(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&jt&&((P=w=Qi)&&(w=De(w,o.type,o.pendingProps,jr),w!==null?(o.stateNode=w,bn=o,Qi=Vt(w.firstChild),jr=!1,P=!0):P=!1),P||Gr(o)),Vi(o),P=o.type,D=o.pendingProps,W=s!==null?s.memoizedProps:null,w=D.children,j(P,D)?w=null:W!==null&&j(P,W)&&(o.flags|=32),o.memoizedState!==null&&(P=id(s,o,rf,null,null,p),Nh._currentValue=P),_h(s,o),Rr(s,o,w,p),o.child;case 6:return s===null&&jt&&((s=p=Qi)&&(p=Ge(p,o.pendingProps,jr),p!==null?(o.stateNode=p,bn=o,Qi=null,s=!0):s=!1),s||Gr(o)),null;case 13:return yc(s,o,p);case 4:return Kt(o,o.stateNode.containerInfo),w=o.pendingProps,s===null?o.child=bt(o,null,w,p):Rr(s,o,w,p),o.child;case 11:return dd(s,o,o.type,o.pendingProps,p);case 7:return Rr(s,o,o.pendingProps,p),o.child;case 8:return Rr(s,o,o.pendingProps.children,p),o.child;case 12:return Rr(s,o,o.pendingProps.children,p),o.child;case 10:return w=o.pendingProps,Oo(o,o.type,w.value),Rr(s,o,w.children,p),o.child;case 9:return P=o.type._context,w=o.pendingProps.children,Js(o),P=nn(P),w=w(P),o.flags|=1,Rr(s,o,w,p),o.child;case 14:return fd(s,o,o.type,o.pendingProps,p);case 15:return ph(s,o,o.type,o.pendingProps,p);case 19:return bg(s,o,p);case 31:return Dp(s,o,p);case 22:return Rp(s,o,p,o.pendingProps);case 24:return Js(o),w=nn(_s),s===null?(P=v(),P===null&&(P=ds,D=qa(),P.pooledCache=D,D.refCount++,D!==null&&(P.pooledCacheLanes|=p),P=D),o.memoizedState={parent:w,cache:P},ii(o),Oo(o,_s,P)):((s.lanes&p)!==0&&(Ht(s,o),Vn(o,null,null,p),Ii()),P=s.memoizedState,D=o.memoizedState,P.parent!==w?(P={parent:w,cache:w},o.memoizedState=P,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=P),Oo(o,_s,w)):(w=D.cache,Oo(o,_s,w),w!==P.cache&&Cu(o,[_s],p,!0))),Rr(s,o,o.pendingProps.children,p),o.child;case 29:throw o.pendingProps}throw Error(l(156,o.tag))}function _c(s){s.flags|=4}function Vp(s,o,p,w,P){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(P&335544128)===P)if(s.stateNode.complete)s.flags|=8192;else if(Ng())s.flags|=8192;else throw _e=Y,U}else s.flags&=-16777217}function vf(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!dr(o))if(Ng())s.flags|=8192;else throw _e=Y,U}function iu(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?we():536870912,s.lanes|=o,Eh|=o)}function Ru(s,o){if(!jt)switch(s.tailMode){case"hidden":o=s.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:w.sibling=null}}function Ss(s){var o=s.alternate!==null&&s.alternate.child===s.child,p=0,w=0;if(o)for(var P=s.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags&65011712,w|=P.flags&65011712,P.return=s,P=P.sibling;else for(P=s.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags,w|=P.flags,P.return=s,P=P.sibling;return s.subtreeFlags|=w,s.childLanes=p,o}function b_(s,o,p){var w=o.pendingProps;switch(bs(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ss(o),null;case 1:return Ss(o),null;case 3:return p=o.stateNode,w=null,s!==null&&(w=s.memoizedState.cache),o.memoizedState.cache!==w&&(o.flags|=2048),No(_s),_i(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Ui(o)?_c(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,ku())),Ss(o),null;case 26:var P=o.type,D=o.memoizedState;return s===null?(_c(o),D!==null?(Ss(o),vf(o,D)):(Ss(o),Vp(o,P,null,w,p))):D?D!==s.memoizedState?(_c(o),Ss(o),vf(o,D)):(Ss(o),o.flags&=-16777217):(s=s.memoizedProps,s!==w&&_c(o),Ss(o),Vp(o,P,s,w,p)),null;case 27:if(gi(o),p=Ct.current,P=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==w&&_c(o);else{if(!w){if(o.stateNode===null)throw Error(l(166));return Ss(o),null}s=at.current,Ui(o)?Do(o):(s=ri(P,w,p),o.stateNode=s,_c(o))}return Ss(o),null;case 5:if(gi(o),P=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==w&&_c(o);else{if(!w){if(o.stateNode===null)throw Error(l(166));return Ss(o),null}if(D=at.current,Ui(o))Do(o);else{var W=x(Ct.current);switch(D){case 1:D=W.createElementNS("http://www.w3.org/2000/svg",P);break;case 2:D=W.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;default:switch(P){case"svg":D=W.createElementNS("http://www.w3.org/2000/svg",P);break;case"math":D=W.createElementNS("http://www.w3.org/1998/Math/MathML",P);break;case"script":D=W.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof w.is=="string"?W.createElement("select",{is:w.is}):W.createElement("select"),w.multiple?D.multiple=!0:w.size&&(D.size=w.size);break;default:D=typeof w.is=="string"?W.createElement(P,{is:w.is}):W.createElement(P)}}D[At]=o,D[ni]=w;e:for(W=o.child;W!==null;){if(W.tag===5||W.tag===6)D.appendChild(W.stateNode);else if(W.tag!==4&&W.tag!==27&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===o)break e;for(;W.sibling===null;){if(W.return===null||W.return===o)break e;W=W.return}W.sibling.return=W.return,W=W.sibling}o.stateNode=D;e:switch(Tr(D,P,w),P){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&_c(o)}}return Ss(o),Vp(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,p),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==w&&_c(o);else{if(typeof w!="string"&&o.stateNode===null)throw Error(l(166));if(s=Ct.current,Ui(o)){if(s=o.stateNode,p=o.memoizedProps,w=null,P=bn,P!==null)switch(P.tag){case 27:case 5:w=P.memoizedProps}s[At]=o,s=!!(s.nodeValue===p||w!==null&&w.suppressHydrationWarning===!0||Rh(s.nodeValue,p)),s||Gr(o,!0)}else s=x(s).createTextNode(w),s[At]=o,o.stateNode=s}return Ss(o),null;case 31:if(p=o.memoizedState,s===null||s.memoizedState!==null){if(w=Ui(o),p!==null){if(s===null){if(!w)throw Error(l(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(l(557));s[At]=o}else mo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ss(o),s=!1}else p=ku(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),s=!0;if(!s)return o.flags&256?(sr(o),o):(sr(o),null);if((o.flags&128)!==0)throw Error(l(558))}return Ss(o),null;case 13:if(w=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(P=Ui(o),w!==null&&w.dehydrated!==null){if(s===null){if(!P)throw Error(l(318));if(P=o.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(l(317));P[At]=o}else mo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ss(o),P=!1}else P=ku(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=P),P=!0;if(!P)return o.flags&256?(sr(o),o):(sr(o),null)}return sr(o),(o.flags&128)!==0?(o.lanes=p,o):(p=w!==null,s=s!==null&&s.memoizedState!==null,p&&(w=o.child,P=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(P=w.alternate.memoizedState.cachePool.pool),D=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(D=w.memoizedState.cachePool.pool),D!==P&&(w.flags|=2048)),p!==s&&p&&(o.child.flags|=8192),iu(o,o.updateQueue),Ss(o),null);case 4:return _i(),s===null&&dm(o.stateNode.containerInfo),Ss(o),null;case 10:return No(o.type),Ss(o),null;case 19:if(Ie(Rn),w=o.memoizedState,w===null)return Ss(o),null;if(P=(o.flags&128)!==0,D=w.rendering,D===null)if(P)Ru(w,!1);else{if(Es!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(D=hc(s),D!==null){for(o.flags|=128,Ru(w,!1),s=D.updateQueue,o.updateQueue=s,iu(o,s),o.subtreeFlags=0,s=p,p=o.child;p!==null;)ac(p,s),p=p.sibling;return et(Rn,Rn.current&1|2),jt&&Si(o,w.treeForkCount),o.child}s=s.sibling}w.tail!==null&&an()>Sf&&(o.flags|=128,P=!0,Ru(w,!1),o.lanes=4194304)}else{if(!P)if(s=hc(D),s!==null){if(o.flags|=128,P=!0,s=s.updateQueue,o.updateQueue=s,iu(o,s),Ru(w,!0),w.tail===null&&w.tailMode==="hidden"&&!D.alternate&&!jt)return Ss(o),null}else 2*an()-w.renderingStartTime>Sf&&p!==536870912&&(o.flags|=128,P=!0,Ru(w,!1),o.lanes=4194304);w.isBackwards?(D.sibling=o.child,o.child=D):(s=w.last,s!==null?s.sibling=D:o.child=D,w.last=D)}return w.tail!==null?(s=w.tail,w.rendering=s,w.tail=s.sibling,w.renderingStartTime=an(),s.sibling=null,p=Rn.current,et(Rn,P?p&1|2:p&1),jt&&Si(o,w.treeForkCount),s):(Ss(o),null);case 22:case 23:return sr(o),Lr(),w=o.memoizedState!==null,s!==null?s.memoizedState!==null!==w&&(o.flags|=8192):w&&(o.flags|=8192),w?(p&536870912)!==0&&(o.flags&128)===0&&(Ss(o),o.subtreeFlags&6&&(o.flags|=8192)):Ss(o),p=o.updateQueue,p!==null&&iu(o,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),w=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(w=o.memoizedState.cachePool.pool),w!==p&&(o.flags|=2048),s!==null&&Ie(g),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),No(_s),Ss(o),null;case 25:return null;case 30:return null}throw Error(l(156,o.tag))}function Sg(s,o){switch(bs(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return No(_s),_i(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return gi(o),null;case 31:if(o.memoizedState!==null){if(sr(o),o.alternate===null)throw Error(l(340));mo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(sr(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(l(340));mo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return Ie(Rn),null;case 4:return _i(),null;case 10:return No(o.type),null;case 22:case 23:return sr(o),Lr(),s!==null&&Ie(g),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return No(_s),null;case 25:return null;default:return null}}function Tg(s,o){switch(bs(o),o.tag){case 3:No(_s),_i();break;case 26:case 27:case 5:gi(o);break;case 4:_i();break;case 31:o.memoizedState!==null&&sr(o);break;case 13:sr(o);break;case 19:Ie(Rn);break;case 10:No(o.type);break;case 22:case 23:sr(o),Lr(),s!==null&&Ie(g);break;case 24:No(_s)}}function md(s,o){try{var p=o.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var P=w.next;p=P;do{if((p.tag&s)===s){w=void 0;var D=p.create,W=p.inst;w=D(),W.destroy=w}p=p.next}while(p!==P)}}catch(pe){es(o,o.return,pe)}}function $o(s,o,p){try{var w=o.updateQueue,P=w!==null?w.lastEffect:null;if(P!==null){var D=P.next;w=D;do{if((w.tag&s)===s){var W=w.inst,pe=W.destroy;if(pe!==void 0){W.destroy=void 0,P=o;var Re=p,dt=pe;try{dt()}catch(Et){es(P,Re,Et)}}}w=w.next}while(w!==D)}}catch(Et){es(o,o.return,Et)}}function qp(s){var o=s.updateQueue;if(o!==null){var p=s.stateNode;try{un(o,p)}catch(w){es(s,s.return,w)}}}function Eg(s,o,p){p.props=Lu(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(w){es(s,o,w)}}function gd(s,o){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var w=s.stateNode;break;case 30:w=s.stateNode;break;default:w=s.stateNode}typeof p=="function"?s.refCleanup=p(w):p.current=w}}catch(P){es(s,o,P)}}function Hl(s,o){var p=s.ref,w=s.refCleanup;if(p!==null)if(typeof w=="function")try{w()}catch(P){es(s,o,P)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(P){es(s,o,P)}else p.current=null}function kg(s){var o=s.type,p=s.memoizedProps,w=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":p.autoFocus&&w.focus();break e;case"img":p.src?w.src=p.src:p.srcSet&&(w.srcset=p.srcSet)}}catch(P){es(s,s.return,P)}}function Hp(s,o,p){try{var w=s.stateNode;A_(w,s.type,p,o),w[ni]=o}catch(P){es(s,s.return,P)}}function Cg(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&he(s.type)||s.tag===4}function xf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Cg(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&he(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yd(s,o,p){var w=s.tag;if(w===5||w===6)s=s.stateNode,o?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,o):(o=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,o.appendChild(s),p=p._reactRootContainer,p!=null||o.onclick!==null||(o.onclick=$s));else if(w!==4&&(w===27&&he(s.type)&&(p=s.stateNode,o=null),s=s.child,s!==null))for(yd(s,o,p),s=s.sibling;s!==null;)yd(s,o,p),s=s.sibling}function _d(s,o,p){var w=s.tag;if(w===5||w===6)s=s.stateNode,o?p.insertBefore(s,o):p.appendChild(s);else if(w!==4&&(w===27&&he(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(_d(s,o,p),s=s.sibling;s!==null;)_d(s,o,p),s=s.sibling}function Zp(s){var o=s.stateNode,p=s.memoizedProps;try{for(var w=s.type,P=o.attributes;P.length;)o.removeAttributeNode(P[0]);Tr(o,w,p),o[At]=s,o[ni]=p}catch(D){es(s,s.return,D)}}var Zl=!1,ar=!1,vh=!1,Ag=typeof WeakSet=="function"?WeakSet:Set,Sr=null;function w_(s,o){if(s=s.containerInfo,c=Rf,s=Ua(s),uo(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var P=w.anchorOffset,D=w.focusNode;w=w.focusOffset;try{p.nodeType,D.nodeType}catch{p=null;break e}var W=0,pe=-1,Re=-1,dt=0,Et=0,Lt=s,ft=null;t:for(;;){for(var yt;Lt!==p||P!==0&&Lt.nodeType!==3||(pe=W+P),Lt!==D||w!==0&&Lt.nodeType!==3||(Re=W+w),Lt.nodeType===3&&(W+=Lt.nodeValue.length),(yt=Lt.firstChild)!==null;)ft=Lt,Lt=yt;for(;;){if(Lt===s)break t;if(ft===p&&++dt===P&&(pe=W),ft===D&&++Et===w&&(Re=W),(yt=Lt.nextSibling)!==null)break;Lt=ft,ft=Lt.parentNode}Lt=yt}p=pe===-1||Re===-1?null:{start:pe,end:Re}}else p=null}p=p||{start:0,end:0}}else p=null;for(m={focusedElem:s,selectionRange:p},Rf=!1,Sr=o;Sr!==null;)if(o=Sr,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Sr=s;else for(;Sr!==null;){switch(o=Sr,D=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(p=0;p<s.length;p++)P=s[p],P.ref.impl=P.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&D!==null){s=void 0,p=o,P=D.memoizedProps,D=D.memoizedState,w=p.stateNode;try{var xi=Lu(p.type,P);s=w.getSnapshotBeforeUpdate(xi,D),w.__reactInternalSnapshotBeforeUpdate=s}catch(Fi){es(p,p.return,Fi)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,p=s.nodeType,p===9)Xe(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Xe(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(l(163))}if(s=o.sibling,s!==null){s.return=o.return,Sr=s;break}Sr=o.return}}function Mg(s,o,p){var w=p.flags;switch(p.tag){case 0:case 11:case 15:Xa(s,p),w&4&&md(5,p);break;case 1:if(Xa(s,p),w&4)if(s=p.stateNode,o===null)try{s.componentDidMount()}catch(W){es(p,p.return,W)}else{var P=Lu(p.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(P,o,s.__reactInternalSnapshotBeforeUpdate)}catch(W){es(p,p.return,W)}}w&64&&qp(p),w&512&&gd(p,p.return);break;case 3:if(Xa(s,p),w&64&&(s=p.updateQueue,s!==null)){if(o=null,p.child!==null)switch(p.child.tag){case 27:case 5:o=p.child.stateNode;break;case 1:o=p.child.stateNode}try{un(s,o)}catch(W){es(p,p.return,W)}}break;case 27:o===null&&w&4&&Zp(p);case 26:case 5:Xa(s,p),o===null&&w&4&&kg(p),w&512&&gd(p,p.return);break;case 12:Xa(s,p);break;case 31:Xa(s,p),w&4&&Hs(s,p);break;case 13:Xa(s,p),w&4&&Gp(s,p),w&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Ug.bind(null,p),Ai(s,p))));break;case 22:if(w=p.memoizedState!==null||Zl,!w){o=o!==null&&o.memoizedState!==null||ar,P=Zl;var D=ar;Zl=w,(ar=o)&&!D?xc(s,p,(p.subtreeFlags&8772)!==0):Xa(s,p),Zl=P,ar=D}break;case 30:break;default:Xa(s,p)}}function Pg(s){var o=s.alternate;o!==null&&(s.alternate=null,Pg(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&Ne(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ts=null,Ya=!1;function vc(s,o,p){for(p=p.child;p!==null;)xh(s,o,p),p=p.sibling}function xh(s,o,p){if(ai&&typeof ai.onCommitFiberUnmount=="function")try{ai.onCommitFiberUnmount(It,p)}catch{}switch(p.tag){case 26:ar||Hl(p,o),vc(s,o,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:ar||Hl(p,o);var w=Ts,P=Ya;he(p.type)&&(Ts=p.stateNode,Ya=!1),vc(s,o,p),vt(p.stateNode),Ts=w,Ya=P;break;case 5:ar||Hl(p,o);case 6:if(w=Ts,P=Ya,Ts=null,vc(s,o,p),Ts=w,Ya=P,Ts!==null)if(Ya)try{(Ts.nodeType===9?Ts.body:Ts.nodeName==="HTML"?Ts.ownerDocument.body:Ts).removeChild(p.stateNode)}catch(D){es(p,o,D)}else try{Ts.removeChild(p.stateNode)}catch(D){es(p,o,D)}break;case 18:Ts!==null&&(Ya?(s=Ts,Ee(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),Bf(s)):Ee(Ts,p.stateNode));break;case 4:w=Ts,P=Ya,Ts=p.stateNode.containerInfo,Ya=!0,vc(s,o,p),Ts=w,Ya=P;break;case 0:case 11:case 14:case 15:$o(2,p,o),ar||$o(4,p,o),vc(s,o,p);break;case 1:ar||(Hl(p,o),w=p.stateNode,typeof w.componentWillUnmount=="function"&&Eg(p,o,w)),vc(s,o,p);break;case 21:vc(s,o,p);break;case 22:ar=(w=ar)||p.memoizedState!==null,vc(s,o,p),ar=w;break;default:vc(s,o,p)}}function Hs(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Bf(s)}catch(p){es(o,o.return,p)}}}function Gp(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Bf(s)}catch(p){es(o,o.return,p)}}function Ig(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Ag),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Ag),o;default:throw Error(l(435,s.tag))}}function vd(s,o){var p=Ig(s);o.forEach(function(w){if(!p.has(w)){p.add(w);var P=k_.bind(null,s,w);w.then(P,P)}})}function rn(s,o){var p=o.deletions;if(p!==null)for(var w=0;w<p.length;w++){var P=p[w],D=s,W=o,pe=W;e:for(;pe!==null;){switch(pe.tag){case 27:if(he(pe.type)){Ts=pe.stateNode,Ya=!1;break e}break;case 5:Ts=pe.stateNode,Ya=!1;break e;case 3:case 4:Ts=pe.stateNode.containerInfo,Ya=!0;break e}pe=pe.return}if(Ts===null)throw Error(l(160));xh(D,W,P),Ts=null,Ya=!1,D=P.alternate,D!==null&&(D.return=null),P.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Wp(o,s),o=o.sibling}var _o=null;function Wp(s,o){var p=s.alternate,w=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:rn(o,s),Ca(s),w&4&&($o(3,s,s.return),md(3,s),$o(5,s,s.return));break;case 1:rn(o,s),Ca(s),w&512&&(ar||p===null||Hl(p,p.return)),w&64&&Zl&&(s=s.updateQueue,s!==null&&(w=s.callbacks,w!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?w:p.concat(w))));break;case 26:var P=_o;if(rn(o,s),Ca(s),w&512&&(ar||p===null||Hl(p,p.return)),w&4){var D=p!==null?p.memoizedState:null;if(w=s.memoizedState,p===null)if(w===null)if(s.stateNode===null){e:{w=s.type,p=s.memoizedProps,P=P.ownerDocument||P;t:switch(w){case"title":D=P.getElementsByTagName("title")[0],(!D||D[pi]||D[At]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=P.createElement(w),P.head.insertBefore(D,P.querySelector("head > title"))),Tr(D,w,p),D[At]=s,vn(D),w=D;break e;case"link":var W=Tl("link","href",P).get(w+(p.href||""));if(W){for(var pe=0;pe<W.length;pe++)if(D=W[pe],D.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&D.getAttribute("rel")===(p.rel==null?null:p.rel)&&D.getAttribute("title")===(p.title==null?null:p.title)&&D.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){W.splice(pe,1);break t}}D=P.createElement(w),Tr(D,w,p),P.head.appendChild(D);break;case"meta":if(W=Tl("meta","content",P).get(w+(p.content||""))){for(pe=0;pe<W.length;pe++)if(D=W[pe],D.getAttribute("content")===(p.content==null?null:""+p.content)&&D.getAttribute("name")===(p.name==null?null:p.name)&&D.getAttribute("property")===(p.property==null?null:p.property)&&D.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&D.getAttribute("charset")===(p.charSet==null?null:p.charSet)){W.splice(pe,1);break t}}D=P.createElement(w),Tr(D,w,p),P.head.appendChild(D);break;default:throw Error(l(468,w))}D[At]=s,vn(D),w=D}s.stateNode=w}else wo(P,s.type,s.stateNode);else s.stateNode=cs(P,w,s.memoizedProps);else D!==w?(D===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):D.count--,w===null?wo(P,s.type,s.stateNode):cs(P,w,s.memoizedProps)):w===null&&s.stateNode!==null&&Hp(s,s.memoizedProps,p.memoizedProps)}break;case 27:rn(o,s),Ca(s),w&512&&(ar||p===null||Hl(p,p.return)),p!==null&&w&4&&Hp(s,s.memoizedProps,p.memoizedProps);break;case 5:if(rn(o,s),Ca(s),w&512&&(ar||p===null||Hl(p,p.return)),s.flags&32){P=s.stateNode;try{Ur(P,"")}catch(xi){es(s,s.return,xi)}}w&4&&s.stateNode!=null&&(P=s.memoizedProps,Hp(s,P,p!==null?p.memoizedProps:P)),w&1024&&(vh=!0);break;case 6:if(rn(o,s),Ca(s),w&4){if(s.stateNode===null)throw Error(l(162));w=s.memoizedProps,p=s.stateNode;try{p.nodeValue=w}catch(xi){es(s,s.return,xi)}}break;case 3:if(bo=null,P=_o,_o=Li(o.containerInfo),rn(o,s),_o=P,Ca(s),w&4&&p!==null&&p.memoizedState.isDehydrated)try{Bf(o.containerInfo)}catch(xi){es(s,s.return,xi)}vh&&(vh=!1,Gl(s));break;case 4:w=_o,_o=Li(s.stateNode.containerInfo),rn(o,s),Ca(s),_o=w;break;case 12:rn(o,s),Ca(s);break;case 31:rn(o,s),Ca(s),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,vd(s,w)));break;case 13:rn(o,s),Ca(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Ch=an()),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,vd(s,w)));break;case 22:P=s.memoizedState!==null;var Re=p!==null&&p.memoizedState!==null,dt=Zl,Et=ar;if(Zl=dt||P,ar=Et||Re,rn(o,s),ar=Et,Zl=dt,Ca(s),w&8192)e:for(o=s.stateNode,o._visibility=P?o._visibility&-2:o._visibility|1,P&&(p===null||Re||Zl||ar||nu(s)),p=null,o=s;;){if(o.tag===5||o.tag===26){if(p===null){Re=p=o;try{if(D=Re.stateNode,P)W=D.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none";else{pe=Re.stateNode;var Lt=Re.memoizedProps.style,ft=Lt!=null&&Lt.hasOwnProperty("display")?Lt.display:null;pe.style.display=ft==null||typeof ft=="boolean"?"":(""+ft).trim()}}catch(xi){es(Re,Re.return,xi)}}}else if(o.tag===6){if(p===null){Re=o;try{Re.stateNode.nodeValue=P?"":Re.memoizedProps}catch(xi){es(Re,Re.return,xi)}}}else if(o.tag===18){if(p===null){Re=o;try{var yt=Re.stateNode;P?Ae(yt,!0):Ae(Re.stateNode,!1)}catch(xi){es(Re,Re.return,xi)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;p===o&&(p=null),o=o.return}p===o&&(p=null),o.sibling.return=o.return,o=o.sibling}w&4&&(w=s.updateQueue,w!==null&&(p=w.retryQueue,p!==null&&(w.retryQueue=null,vd(s,p))));break;case 19:rn(o,s),Ca(s),w&4&&(w=s.updateQueue,w!==null&&(s.updateQueue=null,vd(s,w)));break;case 30:break;case 21:break;default:rn(o,s),Ca(s)}}function Ca(s){var o=s.flags;if(o&2){try{for(var p,w=s.return;w!==null;){if(Cg(w)){p=w;break}w=w.return}if(p==null)throw Error(l(160));switch(p.tag){case 27:var P=p.stateNode,D=xf(s);_d(s,D,P);break;case 5:var W=p.stateNode;p.flags&32&&(Ur(W,""),p.flags&=-33);var pe=xf(s);_d(s,pe,W);break;case 3:case 4:var Re=p.stateNode.containerInfo,dt=xf(s);yd(s,dt,Re);break;default:throw Error(l(161))}}catch(Et){es(s,s.return,Et)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Gl(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;Gl(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Xa(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Mg(s,o.alternate,o),o=o.sibling}function nu(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:$o(4,o,o.return),nu(o);break;case 1:Hl(o,o.return);var p=o.stateNode;typeof p.componentWillUnmount=="function"&&Eg(o,o.return,p),nu(o);break;case 27:vt(o.stateNode);case 26:case 5:Hl(o,o.return),nu(o);break;case 22:o.memoizedState===null&&nu(o);break;case 30:nu(o);break;default:nu(o)}s=s.sibling}}function xc(s,o,p){for(p=p&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var w=o.alternate,P=s,D=o,W=D.flags;switch(D.tag){case 0:case 11:case 15:xc(P,D,p),md(4,D);break;case 1:if(xc(P,D,p),w=D,P=w.stateNode,typeof P.componentDidMount=="function")try{P.componentDidMount()}catch(dt){es(w,w.return,dt)}if(w=D,P=w.updateQueue,P!==null){var pe=w.stateNode;try{var Re=P.shared.hiddenCallbacks;if(Re!==null)for(P.shared.hiddenCallbacks=null,P=0;P<Re.length;P++)Xi(Re[P],pe)}catch(dt){es(w,w.return,dt)}}p&&W&64&&qp(D),gd(D,D.return);break;case 27:Zp(D);case 26:case 5:xc(P,D,p),p&&w===null&&W&4&&kg(D),gd(D,D.return);break;case 12:xc(P,D,p);break;case 31:xc(P,D,p),p&&W&4&&Hs(P,D);break;case 13:xc(P,D,p),p&&W&4&&Gp(P,D);break;case 22:D.memoizedState===null&&xc(P,D,p),gd(D,D.return);break;case 30:break;default:xc(P,D,p)}o=o.sibling}}function Yp(s,o){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&_l(p))}function Xp(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&_l(s))}function wl(s,o,p,w){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)jg(s,o,p,w),o=o.sibling}function jg(s,o,p,w){var P=o.flags;switch(o.tag){case 0:case 11:case 15:wl(s,o,p,w),P&2048&&md(9,o);break;case 1:wl(s,o,p,w);break;case 3:wl(s,o,p,w),P&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&_l(s)));break;case 12:if(P&2048){wl(s,o,p,w),s=o.stateNode;try{var D=o.memoizedProps,W=D.id,pe=D.onPostCommit;typeof pe=="function"&&pe(W,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Re){es(o,o.return,Re)}}else wl(s,o,p,w);break;case 31:wl(s,o,p,w);break;case 13:wl(s,o,p,w);break;case 23:break;case 22:D=o.stateNode,W=o.alternate,o.memoizedState!==null?D._visibility&2?wl(s,o,p,w):xd(s,o):D._visibility&2?wl(s,o,p,w):(D._visibility|=2,bh(s,o,p,w,(o.subtreeFlags&10256)!==0||!1)),P&2048&&Yp(W,o);break;case 24:wl(s,o,p,w),P&2048&&Xp(o.alternate,o);break;default:wl(s,o,p,w)}}function bh(s,o,p,w,P){for(P=P&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var D=s,W=o,pe=p,Re=w,dt=W.flags;switch(W.tag){case 0:case 11:case 15:bh(D,W,pe,Re,P),md(8,W);break;case 23:break;case 22:var Et=W.stateNode;W.memoizedState!==null?Et._visibility&2?bh(D,W,pe,Re,P):xd(D,W):(Et._visibility|=2,bh(D,W,pe,Re,P)),P&&dt&2048&&Yp(W.alternate,W);break;case 24:bh(D,W,pe,Re,P),P&&dt&2048&&Xp(W.alternate,W);break;default:bh(D,W,pe,Re,P)}o=o.sibling}}function xd(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var p=s,w=o,P=w.flags;switch(w.tag){case 22:xd(p,w),P&2048&&Yp(w.alternate,w);break;case 24:xd(p,w),P&2048&&Xp(w.alternate,w);break;default:xd(p,w)}o=o.sibling}}var bd=8192;function wh(s,o,p){if(s.subtreeFlags&bd)for(s=s.child;s!==null;)wd(s,o,p),s=s.sibling}function wd(s,o,p){switch(s.tag){case 26:wh(s,o,p),s.flags&bd&&s.memoizedState!==null&&wc(p,_o,s.memoizedState,s.memoizedProps);break;case 5:wh(s,o,p);break;case 3:case 4:var w=_o;_o=Li(s.stateNode.containerInfo),wh(s,o,p),_o=w;break;case 22:s.memoizedState===null&&(w=s.alternate,w!==null&&w.memoizedState!==null?(w=bd,bd=16777216,wh(s,o,p),bd=w):wh(s,o,p));break;default:wh(s,o,p)}}function Du(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function Sh(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var w=o[p];Sr=w,Lg(w,s)}Du(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)bf(s),s=s.sibling}function bf(s){switch(s.tag){case 0:case 11:case 15:Sh(s),s.flags&2048&&$o(9,s,s.return);break;case 3:Sh(s);break;case 12:Sh(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Th(s)):Sh(s);break;default:Sh(s)}}function Th(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var p=0;p<o.length;p++){var w=o[p];Sr=w,Lg(w,s)}Du(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:$o(8,o,o.return),Th(o);break;case 22:p=o.stateNode,p._visibility&2&&(p._visibility&=-3,Th(o));break;default:Th(o)}s=s.sibling}}function Lg(s,o){for(;Sr!==null;){var p=Sr;switch(p.tag){case 0:case 11:case 15:$o(8,p,o);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var w=p.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:_l(p.memoizedState.cache)}if(w=p.child,w!==null)w.return=p,Sr=w;else e:for(p=s;Sr!==null;){w=Sr;var P=w.sibling,D=w.return;if(Pg(w),w===p){Sr=null;break e}if(P!==null){P.return=D,Sr=P;break e}Sr=D}}}var S_={getCacheForType:function(s){var o=nn(_s),p=o.data.get(s);return p===void 0&&(p=s(),o.data.set(s,p)),p},cacheSignal:function(){return nn(_s).controller.signal}},T_=typeof WeakMap=="function"?WeakMap:Map,qn=0,ds=null,$i=null,En=0,Qn=0,or=null,Uo=!1,Wl=!1,su=!1,Fo=0,Es=0,ru=0,Ou=0,wf=0,Ka=0,Eh=0,kh=null,Aa=null,Sd=!1,Ch=0,zg=0,Sf=1/0,Td=null,bc=null,Ns=0,Xr=null,vo=null,Yl=0,Ed=0,Kp=null,Rg=null,au=0,kd=null;function xo(){return(qn&2)!==0&&En!==0?En&-En:Be.T!==null?Lh():ei()}function Tf(){if(Ka===0)if((En&536870912)===0||jt){var s=Ci;Ci<<=1,(Ci&3932160)===0&&(Ci=262144),Ka=s}else Ka=536870912;return s=rs.current,s!==null&&(s.flags|=32),Ka}function da(s,o,p){(s===ds&&(Qn===2||Qn===9)||s.cancelPendingCommit!==null)&&(Bu(s,0),Xl(s,En,Ka,!1)),Oe(s,p),((qn&2)===0||s!==ds)&&(s===ds&&((qn&2)===0&&(Ou|=p),Es===4&&Xl(s,En,Ka,!1)),Kl(s))}function Nu(s,o,p){if((qn&6)!==0)throw Error(l(327));var w=!p&&(o&127)===0&&(o&s.expiredLanes)===0||Q(s,o),P=w?tm(s,o):em(s,o,!0),D=w;do{if(P===0){Wl&&!w&&Xl(s,o,0,!1);break}else{if(p=s.current.alternate,D&&!Dg(p)){P=em(s,o,!1),D=!1;continue}if(P===2){if(D=o,s.errorRecoveryDisabledLanes&D)var W=0;else W=s.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){o=W;e:{var pe=s;P=kh;var Re=pe.current.memoizedState.isDehydrated;if(Re&&(Bu(pe,W).flags|=256),W=em(pe,W,!1),W!==2){if(su&&!Re){pe.errorRecoveryDisabledLanes|=D,Ou|=D,P=4;break e}D=Aa,Aa=P,D!==null&&(Aa===null?Aa=D:Aa.push.apply(Aa,D))}P=W}if(D=!1,P!==2)continue}}if(P===1){Bu(s,0),Xl(s,o,0,!0);break}e:{switch(w=s,D=P,D){case 0:case 1:throw Error(l(345));case 4:if((o&4194048)!==o)break;case 6:Xl(w,o,Ka,!Uo);break e;case 2:Aa=null;break;case 3:case 5:break;default:throw Error(l(329))}if((o&62914560)===o&&(P=Ch+300-an(),10<P)){if(Xl(w,o,Ka,!Uo),ee(w,0,!0)!==0)break e;Yl=o,w.timeoutHandle=q(Jp.bind(null,w,p,Aa,Td,Sd,o,Ka,Ou,Eh,Uo,D,"Throttled",-0,0),P);break e}Jp(w,p,Aa,Td,Sd,o,Ka,Ou,Eh,Uo,D,null,-0,0)}}break}while(!0);Kl(s)}function Jp(s,o,p,w,P,D,W,pe,Re,dt,Et,Lt,ft,yt){if(s.timeoutHandle=-1,Lt=o.subtreeFlags,Lt&8192||(Lt&16785408)===16785408){Lt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$s},wd(o,D,Lt);var xi=(D&62914560)===D?Ch-an():(D&4194048)===D?zg-an():0;if(xi=Gg(Lt,xi),xi!==null){Yl=D,s.cancelPendingCommit=xi(kf.bind(null,s,o,D,p,w,P,W,pe,Re,Et,Lt,null,ft,yt)),Xl(s,D,W,!dt);return}}kf(s,o,D,p,w,P,W,pe,Re)}function Dg(s){for(var o=s;;){var p=o.tag;if((p===0||p===11||p===15)&&o.flags&16384&&(p=o.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var w=0;w<p.length;w++){var P=p[w],D=P.getSnapshot;P=P.value;try{if(!Vs(D(),P))return!1}catch{return!1}}if(p=o.child,o.subtreeFlags&16384&&p!==null)p.return=o,o=p;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Xl(s,o,p,w){o&=~wf,o&=~Ou,s.suspendedLanes|=o,s.pingedLanes&=~o,w&&(s.warmLanes|=o),w=s.expirationTimes;for(var P=o;0<P;){var D=31-Ji(P),W=1<<D;w[D]=-1,P&=~W}p!==0&&de(s,p,o)}function Cd(){return(qn&6)===0?(Ih(0),!1):!0}function Ah(){if($i!==null){if(Qn===0)var s=$i.return;else s=$i,Va=Wr=null,Gc(s),Pe=null,Le=0,s=$i;for(;s!==null;)Tg(s.alternate,s),s=s.return;$i=null}}function Bu(s,o){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,G(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Yl=0,Ah(),ds=s,$i=p=Hr(s.current,null),En=o,Qn=0,or=null,Uo=!1,Wl=Q(s,o),su=!1,Eh=Ka=wf=Ou=ru=Es=0,Aa=kh=null,Sd=!1,(o&8)!==0&&(o|=o&32);var w=s.entangledLanes;if(w!==0)for(s=s.entanglements,w&=o;0<w;){var P=31-Ji(w),D=1<<P;o|=s[P],w&=~D}return Fo=o,xr(),p}function Og(s,o){Ri=null,Be.H=ud,o===O||o===H?(o=ke(),Qn=3):o===U?(o=ke(),Qn=4):Qn=o===ws?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,or=o,$i===null&&(Es=1,mf(s,b(o,s.current)))}function Ng(){var s=rs.current;return s===null?!0:(En&4194048)===En?as===null:(En&62914560)===En||(En&536870912)!==0?s===as:!1}function Qp(){var s=Be.H;return Be.H=ud,s===null?ud:s}function Bg(){var s=Be.A;return Be.A=S_,s}function Ef(){Es=4,Uo||(En&4194048)!==En&&rs.current!==null||(Wl=!0),(ru&134217727)===0&&(Ou&134217727)===0||ds===null||Xl(ds,En,Ka,!1)}function em(s,o,p){var w=qn;qn|=2;var P=Qp(),D=Bg();(ds!==s||En!==o)&&(Td=null,Bu(s,o)),o=!1;var W=Es;e:do try{if(Qn!==0&&$i!==null){var pe=$i,Re=or;switch(Qn){case 8:Ah(),W=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(o=!0);var dt=Qn;if(Qn=0,or=null,$u(s,pe,Re,dt),p&&Wl){W=0;break e}break;default:dt=Qn,Qn=0,or=null,$u(s,pe,Re,dt)}}E_(),W=Es;break}catch(Et){Og(s,Et)}while(!0);return o&&s.shellSuspendCounter++,Va=Wr=null,qn=w,Be.H=P,Be.A=D,$i===null&&(ds=null,En=0,xr()),W}function E_(){for(;$i!==null;)im($i)}function tm(s,o){var p=qn;qn|=2;var w=Qp(),P=Bg();ds!==s||En!==o?(Td=null,Sf=an()+500,Bu(s,o)):Wl=Q(s,o);e:do try{if(Qn!==0&&$i!==null){o=$i;var D=or;t:switch(Qn){case 1:Qn=0,or=null,$u(s,o,D,1);break;case 2:case 9:if(X(D)){Qn=0,or=null,nm(o);break}o=function(){Qn!==2&&Qn!==9||ds!==s||(Qn=7),Kl(s)},D.then(o,o);break e;case 3:Qn=7;break e;case 4:Qn=5;break e;case 7:X(D)?(Qn=0,or=null,nm(o)):(Qn=0,or=null,$u(s,o,D,7));break;case 5:var W=null;switch($i.tag){case 26:W=$i.memoizedState;case 5:case 27:var pe=$i;if(W?dr(W):pe.stateNode.complete){Qn=0,or=null;var Re=pe.sibling;if(Re!==null)$i=Re;else{var dt=pe.return;dt!==null?($i=dt,Ad(dt)):$i=null}break t}}Qn=0,or=null,$u(s,o,D,5);break;case 6:Qn=0,or=null,$u(s,o,D,6);break;case 8:Ah(),Es=6;break e;default:throw Error(l(462))}}ou();break}catch(Et){Og(s,Et)}while(!0);return Va=Wr=null,Be.H=w,Be.A=P,qn=p,$i!==null?0:(ds=null,En=0,xr(),Es)}function ou(){for(;$i!==null&&!Ln();)im($i)}function im(s){var o=wg(s.alternate,s,Fo);s.memoizedProps=s.pendingProps,o===null?Ad(s):$i=o}function nm(s){var o=s,p=o.alternate;switch(o.tag){case 15:case 0:o=Op(p,o,o.pendingProps,o.type,void 0,En);break;case 11:o=Op(p,o,o.pendingProps,o.type.render,o.ref,En);break;case 5:Gc(o);default:Tg(p,o),o=$i=ac(o,Fo),o=wg(p,o,Fo)}s.memoizedProps=s.pendingProps,o===null?Ad(s):$i=o}function $u(s,o,p,w){Va=Wr=null,Gc(o),Pe=null,Le=0;var P=o.return;try{if(v_(s,P,o,p,En)){Es=1,mf(s,b(p,s.current)),$i=null;return}}catch(D){if(P!==null)throw $i=P,D;Es=1,mf(s,b(p,s.current)),$i=null;return}o.flags&32768?(jt||w===1?s=!0:Wl||(En&536870912)!==0?s=!1:(Uo=s=!0,(w===2||w===9||w===3||w===6)&&(w=rs.current,w!==null&&w.tag===13&&(w.flags|=16384))),sm(o,s)):Ad(o)}function Ad(s){var o=s;do{if((o.flags&32768)!==0){sm(o,Uo);return}s=o.return;var p=b_(o.alternate,o,Fo);if(p!==null){$i=p;return}if(o=o.sibling,o!==null){$i=o;return}$i=o=s}while(o!==null);Es===0&&(Es=5)}function sm(s,o){do{var p=Sg(s.alternate,s);if(p!==null){p.flags&=32767,$i=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!o&&(s=s.sibling,s!==null)){$i=s;return}$i=s=p}while(s!==null);Es=6,$i=null}function kf(s,o,p,w,P,D,W,pe,Re){s.cancelPendingCommit=null;do fa();while(Ns!==0);if((qn&6)!==0)throw Error(l(327));if(o!==null){if(o===s.current)throw Error(l(177));if(D=o.lanes|o.childLanes,D|=ss,qe(s,p,D,W,pe,Re),s===ds&&($i=ds=null,En=0),vo=o,Xr=s,Yl=p,Ed=D,Kp=P,Rg=w,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Fg(Tt,function(){return Ph(),null})):(s.callbackNode=null,s.callbackPriority=0),w=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||w){w=Be.T,Be.T=null,P=ot.p,ot.p=2,W=qn,qn|=4;try{w_(s,o,p)}finally{qn=W,ot.p=P,Be.T=w}}Ns=1,Mh(),rm(),Cf()}}function Mh(){if(Ns===1){Ns=0;var s=Xr,o=vo,p=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||p){p=Be.T,Be.T=null;var w=ot.p;ot.p=2;var P=qn;qn|=4;try{Wp(o,s);var D=m,W=Ua(s.containerInfo),pe=D.focusedElem,Re=D.selectionRange;if(W!==pe&&pe&&pe.ownerDocument&&nc(pe.ownerDocument.documentElement,pe)){if(Re!==null&&uo(pe)){var dt=Re.start,Et=Re.end;if(Et===void 0&&(Et=dt),"selectionStart"in pe)pe.selectionStart=dt,pe.selectionEnd=Math.min(Et,pe.value.length);else{var Lt=pe.ownerDocument||document,ft=Lt&&Lt.defaultView||window;if(ft.getSelection){var yt=ft.getSelection(),xi=pe.textContent.length,Fi=Math.min(Re.start,xi),vs=Re.end===void 0?Fi:Math.min(Re.end,xi);!yt.extend&&Fi>vs&&(W=vs,vs=Fi,Fi=W);var Qe=ic(pe,Fi),Ue=ic(pe,vs);if(Qe&&Ue&&(yt.rangeCount!==1||yt.anchorNode!==Qe.node||yt.anchorOffset!==Qe.offset||yt.focusNode!==Ue.node||yt.focusOffset!==Ue.offset)){var ut=Lt.createRange();ut.setStart(Qe.node,Qe.offset),yt.removeAllRanges(),Fi>vs?(yt.addRange(ut),yt.extend(Ue.node,Ue.offset)):(ut.setEnd(Ue.node,Ue.offset),yt.addRange(ut))}}}}for(Lt=[],yt=pe;yt=yt.parentNode;)yt.nodeType===1&&Lt.push({element:yt,left:yt.scrollLeft,top:yt.scrollTop});for(typeof pe.focus=="function"&&pe.focus(),pe=0;pe<Lt.length;pe++){var Pt=Lt[pe];Pt.element.scrollLeft=Pt.left,Pt.element.scrollTop=Pt.top}}Rf=!!c,m=c=null}finally{qn=P,ot.p=w,Be.T=p}}s.current=o,Ns=2}}function rm(){if(Ns===2){Ns=0;var s=Xr,o=vo,p=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||p){p=Be.T,Be.T=null;var w=ot.p;ot.p=2;var P=qn;qn|=4;try{Mg(s,o.alternate,o)}finally{qn=P,ot.p=w,Be.T=p}}Ns=3}}function Cf(){if(Ns===4||Ns===3){Ns=0,us();var s=Xr,o=vo,p=Yl,w=Rg;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Ns=5:(Ns=0,vo=Xr=null,am(s,s.pendingLanes));var P=s.pendingLanes;if(P===0&&(bc=null),nt(p),o=o.stateNode,ai&&typeof ai.onCommitFiberRoot=="function")try{ai.onCommitFiberRoot(It,o,void 0,(o.current.flags&128)===128)}catch{}if(w!==null){o=Be.T,P=ot.p,ot.p=2,Be.T=null;try{for(var D=s.onRecoverableError,W=0;W<w.length;W++){var pe=w[W];D(pe.value,{componentStack:pe.stack})}}finally{Be.T=o,ot.p=P}}(Yl&3)!==0&&fa(),Kl(s),P=s.pendingLanes,(p&261930)!==0&&(P&42)!==0?s===kd?au++:(au=0,kd=s):au=0,Ih(0)}}function am(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,_l(o)))}function fa(){return Mh(),rm(),Cf(),Ph()}function Ph(){if(Ns!==5)return!1;var s=Xr,o=Ed;Ed=0;var p=nt(Yl),w=Be.T,P=ot.p;try{ot.p=32>p?32:p,Be.T=null,p=Kp,Kp=null;var D=Xr,W=Yl;if(Ns=0,vo=Xr=null,Yl=0,(qn&6)!==0)throw Error(l(331));var pe=qn;if(qn|=4,bf(D.current),jg(D,D.current,W,p),qn=pe,Ih(0,!1),ai&&typeof ai.onPostCommitFiberRoot=="function")try{ai.onPostCommitFiberRoot(It,D)}catch{}return!0}finally{ot.p=P,Be.T=w,am(s,o)}}function om(s,o,p){o=b(p,o),o=hd(s.stateNode,o,2),s=oi(s,o,2),s!==null&&(Oe(s,2),Kl(s))}function es(s,o,p){if(s.tag===3)om(s,s,p);else for(;o!==null;){if(o.tag===3){om(o,s,p);break}else if(o.tag===1){var w=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(bc===null||!bc.has(w))){s=b(p,s),p=yg(2),w=oi(o,p,2),w!==null&&(zu(p,w,o,s),Oe(w,2),Kl(w));break}}o=o.return}}function Af(s,o,p){var w=s.pingCache;if(w===null){w=s.pingCache=new T_;var P=new Set;w.set(o,P)}else P=w.get(o),P===void 0&&(P=new Set,w.set(o,P));P.has(p)||(su=!0,P.add(p),s=$g.bind(null,s,o,p),o.then(s,s))}function $g(s,o,p){var w=s.pingCache;w!==null&&w.delete(o),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,ds===s&&(En&p)===p&&(Es===4||Es===3&&(En&62914560)===En&&300>an()-Ch?(qn&2)===0&&Bu(s,0):wf|=p,Eh===En&&(Eh=0)),Kl(s)}function lm(s,o){o===0&&(o=we()),s=ua(s,o),s!==null&&(Oe(s,o),Kl(s))}function Ug(s){var o=s.memoizedState,p=0;o!==null&&(p=o.retryLane),lm(s,p)}function k_(s,o){var p=0;switch(s.tag){case 31:case 13:var w=s.stateNode,P=s.memoizedState;P!==null&&(p=P.retryLane);break;case 19:w=s.stateNode;break;case 22:w=s.stateNode._retryCache;break;default:throw Error(l(314))}w!==null&&w.delete(o),lm(s,p)}function Fg(s,o){return yi(s,o)}var Sl=null,Uu=null,Mf=!1,Md=!1,Pf=!1,lu=0;function Kl(s){s!==Uu&&s.next===null&&(Uu===null?Sl=Uu=s:Uu=Uu.next=s),Md=!0,Mf||(Mf=!0,If())}function Ih(s,o){if(!Pf&&Md){Pf=!0;do for(var p=!1,w=Sl;w!==null;){if(s!==0){var P=w.pendingLanes;if(P===0)var D=0;else{var W=w.suspendedLanes,pe=w.pingedLanes;D=(1<<31-Ji(42|s)+1)-1,D&=P&~(W&~pe),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(p=!0,Id(w,D))}else D=En,D=ee(w,w===ds?D:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(D&3)===0||Q(w,D)||(p=!0,Id(w,D));w=w.next}while(p);Pf=!1}}function jh(){cm()}function cm(){Md=Mf=!1;var s=0;lu!==0&&F()&&(s=lu);for(var o=an(),p=null,w=Sl;w!==null;){var P=w.next,D=Pd(w,o);D===0?(w.next=null,p===null?Sl=P:p.next=P,P===null&&(Uu=p)):(p=w,(s!==0||(D&3)!==0)&&(Md=!0)),w=P}Ns!==0&&Ns!==5||Ih(s),lu!==0&&(lu=0)}function Pd(s,o){for(var p=s.suspendedLanes,w=s.pingedLanes,P=s.expirationTimes,D=s.pendingLanes&-62914561;0<D;){var W=31-Ji(D),pe=1<<W,Re=P[W];Re===-1?((pe&p)===0||(pe&w)!==0)&&(P[W]=ue(pe,o)):Re<=o&&(s.expiredLanes|=pe),D&=~pe}if(o=ds,p=En,p=ee(s,s===o?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),w=s.callbackNode,p===0||s===o&&(Qn===2||Qn===9)||s.cancelPendingCommit!==null)return w!==null&&w!==null&&Cn(w),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||Q(s,p)){if(o=p&-p,o===s.callbackPriority)return o;switch(w!==null&&Cn(w),nt(p)){case 2:case 8:p=Fn;break;case 32:p=Tt;break;case 268435456:p=dn;break;default:p=Tt}return w=um.bind(null,s),p=yi(p,w),s.callbackPriority=o,s.callbackNode=p,o}return w!==null&&w!==null&&Cn(w),s.callbackPriority=2,s.callbackNode=null,2}function um(s,o){if(Ns!==0&&Ns!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(fa()&&s.callbackNode!==p)return null;var w=En;return w=ee(s,s===ds?w:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),w===0?null:(Nu(s,w,o),Pd(s,an()),s.callbackNode!=null&&s.callbackNode===p?um.bind(null,s):null)}function Id(s,o){if(fa())return null;Nu(s,o,!0)}function If(){re(function(){(qn&6)!==0?yi(qi,jh):cm()})}function Lh(){if(lu===0){var s=vl;s===0&&(s=hi,hi<<=1,(hi&261888)===0&&(hi=256)),lu=s}return lu}function Vg(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ll(""+s)}function qg(s,o){var p=o.ownerDocument.createElement("input");return p.name=o.name,p.value=o.value,s.id&&p.setAttribute("form",s.id),o.parentNode.insertBefore(p,o),s=new FormData(s),p.parentNode.removeChild(p),s}function C_(s,o,p,w,P){if(o==="submit"&&p&&p.stateNode===P){var D=Vg((P[ni]||null).action),W=w.submitter;W&&(o=(o=W[ni]||null)?Vg(o.formAction):W.getAttribute("formAction"),o!==null&&(D=o,W=null));var pe=new Rc("action","action",null,w,P);s.push({event:pe,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(lu!==0){var Re=W?qg(P,W):new FormData(P);hf(p,{pending:!0,data:Re,method:P.method,action:D},null,Re)}}else typeof D=="function"&&(pe.preventDefault(),Re=W?qg(P,W):new FormData(P),hf(p,{pending:!0,data:Re,method:P.method,action:D},D,Re))},currentTarget:P}]})}}for(var cu=0;cu<ca.length;cu++){var lr=ca[cu],uu=lr.toLowerCase(),hm=lr[0].toUpperCase()+lr.slice(1);Wn(uu,"on"+hm)}Wn(zo,"onAnimationEnd"),Wn(rc,"onAnimationIteration"),Wn(hl,"onAnimationStart"),Wn("dblclick","onDoubleClick"),Wn("focusin","onFocus"),Wn("focusout","onBlur"),Wn(Qh,"onTransitionRun"),Wn(Tu,"onTransitionStart"),Wn(Vc,"onTransitionCancel"),Wn(Ro,"onTransitionEnd"),Eo("onMouseEnter",["mouseout","mouseover"]),Eo("onMouseLeave",["mouseout","mouseover"]),Eo("onPointerEnter",["pointerout","pointerover"]),Eo("onPointerLeave",["pointerout","pointerover"]),zs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),zs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),zs("onBeforeInput",["compositionend","keypress","textInput","paste"]),zs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),zs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),zs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zh));function jf(s,o){o=(o&4)!==0;for(var p=0;p<s.length;p++){var w=s[p],P=w.event;w=w.listeners;e:{var D=void 0;if(o)for(var W=w.length-1;0<=W;W--){var pe=w[W],Re=pe.instance,dt=pe.currentTarget;if(pe=pe.listener,Re!==D&&P.isPropagationStopped())break e;D=pe,P.currentTarget=dt;try{D(P)}catch(Et){Ea(Et)}P.currentTarget=null,D=Re}else for(W=0;W<w.length;W++){if(pe=w[W],Re=pe.instance,dt=pe.currentTarget,pe=pe.listener,Re!==D&&P.isPropagationStopped())break e;D=pe,P.currentTarget=dt;try{D(P)}catch(Et){Ea(Et)}P.currentTarget=null,D=Re}}}}function Mn(s,o){var p=o[Bi];p===void 0&&(p=o[Bi]=new Set);var w=s+"__bubble";p.has(w)||(fm(o,s,2,!1),p.add(w))}function Lf(s,o,p){var w=0;o&&(w|=4),fm(p,s,w,o)}var jd="_reactListening"+Math.random().toString(36).slice(2);function dm(s){if(!s[jd]){s[jd]=!0,gr.forEach(function(p){p!=="selectionchange"&&(Hg.has(p)||Lf(p,!1,s),Lf(p,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[jd]||(o[jd]=!0,Lf("selectionchange",!1,o))}}function fm(s,o,p,w){switch(Dr(o)){case 2:var P=El;break;case 8:P=Df;break;default:P=Of}p=P.bind(null,o,p,s),P=void 0,!zl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(P=!0),w?P!==void 0?s.addEventListener(o,p,{capture:!0,passive:P}):s.addEventListener(o,p,!0):P!==void 0?s.addEventListener(o,p,{passive:P}):s.addEventListener(o,p,!1)}function Ld(s,o,p,w,P){var D=w;if((o&1)===0&&(o&2)===0&&w!==null)e:for(;;){if(w===null)return;var W=w.tag;if(W===3||W===4){var pe=w.stateNode.containerInfo;if(pe===P)break;if(W===4)for(W=w.return;W!==null;){var Re=W.tag;if((Re===3||Re===4)&&W.stateNode.containerInfo===P)return;W=W.return}for(;pe!==null;){if(W=zt(pe),W===null)return;if(Re=W.tag,Re===5||Re===6||Re===26||Re===27){w=D=W;continue e}pe=pe.parentNode}}w=w.return}Lc(function(){var dt=D,Et=Us(p),Lt=[];e:{var ft=$l.get(s);if(ft!==void 0){var yt=Rc,xi=s;switch(s){case"keypress":if(Ko(p)===0)break e;case"keydown":case"keyup":yt=sh;break;case"focusin":xi="focus",yt=Dc;break;case"focusout":xi="blur",yt=Dc;break;case"beforeblur":case"afterblur":yt=Dc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=Jo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=Qu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=rh;break;case zo:case rc:case hl:yt=Oc;break;case Ro:yt=wu;break;case"scroll":case"scrollend":yt=tn;break;case"wheel":yt=_r;break;case"copy":case"cut":case"paste":yt=ba;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=bu;break;case"toggle":case"beforetoggle":yt=tl}var Fi=(o&4)!==0,vs=!Fi&&(s==="scroll"||s==="scrollend"),Qe=Fi?ft!==null?ft+"Capture":null:ft;Fi=[];for(var Ue=dt,ut;Ue!==null;){var Pt=Ue;if(ut=Pt.stateNode,Pt=Pt.tag,Pt!==5&&Pt!==26&&Pt!==27||ut===null||Qe===null||(Pt=ia(Ue,Qe),Pt!=null&&Fi.push(Fu(Ue,Pt,ut))),vs)break;Ue=Ue.return}0<Fi.length&&(ft=new yt(ft,xi,null,p,Et),Lt.push({event:ft,listeners:Fi}))}}if((o&7)===0){e:{if(ft=s==="mouseover"||s==="pointerover",yt=s==="mouseout"||s==="pointerout",ft&&p!==Ao&&(xi=p.relatedTarget||p.fromElement)&&(zt(xi)||xi[vi]))break e;if((yt||ft)&&(ft=Et.window===Et?Et:(ft=Et.ownerDocument)?ft.defaultView||ft.parentWindow:window,yt?(xi=p.relatedTarget||p.toElement,yt=dt,xi=xi?zt(xi):null,xi!==null&&(vs=_(xi),Fi=xi.tag,xi!==vs||Fi!==5&&Fi!==27&&Fi!==6)&&(xi=null)):(yt=null,xi=dt),yt!==xi)){if(Fi=Jo,Pt="onMouseLeave",Qe="onMouseEnter",Ue="mouse",(s==="pointerout"||s==="pointerover")&&(Fi=bu,Pt="onPointerLeave",Qe="onPointerEnter",Ue="pointer"),vs=yt==null?ft:Ki(yt),ut=xi==null?ft:Ki(xi),ft=new Fi(Pt,Ue+"leave",yt,p,Et),ft.target=vs,ft.relatedTarget=ut,Pt=null,zt(Et)===dt&&(Fi=new Fi(Qe,Ue+"enter",xi,p,Et),Fi.target=ut,Fi.relatedTarget=vs,Pt=Fi),vs=Pt,yt&&xi)t:{for(Fi=Rd,Qe=yt,Ue=xi,ut=0,Pt=Qe;Pt;Pt=Fi(Pt))ut++;Pt=0;for(var Ni=Ue;Ni;Ni=Fi(Ni))Pt++;for(;0<ut-Pt;)Qe=Fi(Qe),ut--;for(;0<Pt-ut;)Ue=Fi(Ue),Pt--;for(;ut--;){if(Qe===Ue||Ue!==null&&Qe===Ue.alternate){Fi=Qe;break t}Qe=Fi(Qe),Ue=Fi(Ue)}Fi=null}else Fi=null;yt!==null&&zf(Lt,ft,yt,Fi,!1),xi!==null&&vs!==null&&zf(Lt,vs,xi,Fi,!0)}}e:{if(ft=dt?Ki(dt):window,yt=ft.nodeName&&ft.nodeName.toLowerCase(),yt==="select"||yt==="input"&&ft.type==="file")var is=rl;else if(Ir(ft))if(Uc)is=Nl;else{is=Fc;var Mi=Fr}else yt=ft.nodeName,!yt||yt.toLowerCase()!=="input"||ft.type!=="checkbox"&&ft.type!=="radio"?dt&&jl(dt.elementType)&&(is=rl):is=Sa;if(is&&(is=is(s,dt))){Dl(Lt,is,p,Et);break e}Mi&&Mi(s,ft,dt),s==="focusout"&&dt&&ft.type==="number"&&dt.memoizedProps.value!=null&&va(ft,"number",ft.value)}switch(Mi=dt?Ki(dt):window,s){case"focusin":(Ir(Mi)||Mi.contentEditable==="true")&&(ho=Mi,sc=dt,Lo=null);break;case"focusout":Lo=sc=ho=null;break;case"mousedown":fo=!0;break;case"contextmenu":case"mouseup":case"dragend":fo=!1,cl(Lt,p,Et);break;case"selectionchange":if(ll)break;case"keydown":case"keyup":cl(Lt,p,Et)}var wn;if(il)e:{switch(s){case"compositionstart":var Dn="onCompositionStart";break e;case"compositionend":Dn="onCompositionEnd";break e;case"compositionupdate":Dn="onCompositionUpdate";break e}Dn=void 0}else co?ah(s,p)&&(Dn="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(Dn="onCompositionStart");Dn&&(Rl&&p.locale!=="ko"&&(co||Dn!=="onCompositionStart"?Dn==="onCompositionEnd"&&co&&(wn=sa()):(Oa=Et,Xo="value"in Oa?Oa.value:Oa.textContent,co=!0)),Mi=zd(dt,Dn),0<Mi.length&&(Dn=new oo(Dn,s,null,p,Et),Lt.push({event:Dn,listeners:Mi}),wn?Dn.data=wn:(wn=Yi(p),wn!==null&&(Dn.data=wn)))),(wn=nl?mn(s,p):Tn(s,p))&&(Dn=zd(dt,"onBeforeInput"),0<Dn.length&&(Mi=new oo("onBeforeInput","beforeinput",null,p,Et),Lt.push({event:Mi,listeners:Dn}),Mi.data=wn)),C_(Lt,s,dt,p,Et)}jf(Lt,o)})}function Fu(s,o,p){return{instance:s,listener:o,currentTarget:p}}function zd(s,o){for(var p=o+"Capture",w=[];s!==null;){var P=s,D=P.stateNode;if(P=P.tag,P!==5&&P!==26&&P!==27||D===null||(P=ia(s,p),P!=null&&w.unshift(Fu(s,P,D)),P=ia(s,o),P!=null&&w.push(Fu(s,P,D))),s.tag===3)return w;s=s.return}return[]}function Rd(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function zf(s,o,p,w,P){for(var D=o._reactName,W=[];p!==null&&p!==w;){var pe=p,Re=pe.alternate,dt=pe.stateNode;if(pe=pe.tag,Re!==null&&Re===w)break;pe!==5&&pe!==26&&pe!==27||dt===null||(Re=dt,P?(dt=ia(p,D),dt!=null&&W.unshift(Fu(p,dt,Re))):P||(dt=ia(p,D),dt!=null&&W.push(Fu(p,dt,Re)))),p=p.return}W.length!==0&&s.push({event:o,listeners:W})}var Zg=/\r\n?/g,pm=/\u0000|\uFFFD/g;function Dd(s){return(typeof s=="string"?s:""+s).replace(Zg,`
`).replace(pm,"")}function Rh(s,o){return o=Dd(o),Dd(s)===o}function ts(s,o,p,w,P,D){switch(p){case"children":typeof w=="string"?o==="body"||o==="textarea"&&w===""||Ur(s,w):(typeof w=="number"||typeof w=="bigint")&&o!=="body"&&Ur(s,""+w);break;case"className":zn(s,"class",w);break;case"tabIndex":zn(s,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":zn(s,p,w);break;case"style":ao(s,w,D);break;case"data":if(o!=="object"){zn(s,"data",w);break}case"src":case"href":if(w===""&&(o!=="a"||p!=="href")){s.removeAttribute(p);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){s.removeAttribute(p);break}w=Ll(""+w),s.setAttribute(p,w);break;case"action":case"formAction":if(typeof w=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(p==="formAction"?(o!=="input"&&ts(s,o,"name",P.name,P,null),ts(s,o,"formEncType",P.formEncType,P,null),ts(s,o,"formMethod",P.formMethod,P,null),ts(s,o,"formTarget",P.formTarget,P,null)):(ts(s,o,"encType",P.encType,P,null),ts(s,o,"method",P.method,P,null),ts(s,o,"target",P.target,P,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){s.removeAttribute(p);break}w=Ll(""+w),s.setAttribute(p,w);break;case"onClick":w!=null&&(s.onclick=$s);break;case"onScroll":w!=null&&Mn("scroll",s);break;case"onScrollEnd":w!=null&&Mn("scrollend",s);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(l(61));if(p=w.__html,p!=null){if(P.children!=null)throw Error(l(60));s.innerHTML=p}}break;case"multiple":s.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":s.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){s.removeAttribute("xlink:href");break}p=Ll(""+w),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(p,""+w):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":w===!0?s.setAttribute(p,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?s.setAttribute(p,w):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?s.setAttribute(p,w):s.removeAttribute(p);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?s.removeAttribute(p):s.setAttribute(p,w);break;case"popover":Mn("beforetoggle",s),Mn("toggle",s),Pi(s,"popover",w);break;case"xlinkActuate":ys(s,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":ys(s,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":ys(s,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":ys(s,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":ys(s,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":ys(s,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":ys(s,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":ys(s,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":ys(s,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":Pi(s,"is",w);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Ic.get(p)||p,Pi(s,p,w))}}function Od(s,o,p,w,P,D){switch(p){case"style":ao(s,w,D);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(l(61));if(p=w.__html,p!=null){if(P.children!=null)throw Error(l(60));s.innerHTML=p}}break;case"children":typeof w=="string"?Ur(s,w):(typeof w=="number"||typeof w=="bigint")&&Ur(s,""+w);break;case"onScroll":w!=null&&Mn("scroll",s);break;case"onScrollEnd":w!=null&&Mn("scrollend",s);break;case"onClick":w!=null&&(s.onclick=$s);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ys.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(P=p.endsWith("Capture"),o=p.slice(2,P?p.length-7:void 0),D=s[ni]||null,D=D!=null?D[p]:null,typeof D=="function"&&s.removeEventListener(o,D,P),typeof w=="function")){typeof D!="function"&&D!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(o,w,P);break e}p in s?s[p]=w:w===!0?s.setAttribute(p,""):Pi(s,p,w)}}}function Tr(s,o,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mn("error",s),Mn("load",s);var w=!1,P=!1,D;for(D in p)if(p.hasOwnProperty(D)){var W=p[D];if(W!=null)switch(D){case"src":w=!0;break;case"srcSet":P=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,o));default:ts(s,o,D,W,p,null)}}P&&ts(s,o,"srcSet",p.srcSet,p,null),w&&ts(s,o,"src",p.src,p,null);return;case"input":Mn("invalid",s);var pe=D=W=P=null,Re=null,dt=null;for(w in p)if(p.hasOwnProperty(w)){var Et=p[w];if(Et!=null)switch(w){case"name":P=Et;break;case"type":W=Et;break;case"checked":Re=Et;break;case"defaultChecked":dt=Et;break;case"value":D=Et;break;case"defaultValue":pe=Et;break;case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(l(137,o));break;default:ts(s,o,w,Et,p,null)}}pn(s,D,pe,Re,dt,W,P,!1);return;case"select":Mn("invalid",s),w=W=D=null;for(P in p)if(p.hasOwnProperty(P)&&(pe=p[P],pe!=null))switch(P){case"value":D=pe;break;case"defaultValue":W=pe;break;case"multiple":w=pe;default:ts(s,o,P,pe,p,null)}o=D,p=W,s.multiple=!!w,o!=null?Gn(s,!!w,o,!1):p!=null&&Gn(s,!!w,p,!0);return;case"textarea":Mn("invalid",s),D=P=w=null;for(W in p)if(p.hasOwnProperty(W)&&(pe=p[W],pe!=null))switch(W){case"value":w=pe;break;case"defaultValue":P=pe;break;case"children":D=pe;break;case"dangerouslySetInnerHTML":if(pe!=null)throw Error(l(91));break;default:ts(s,o,W,pe,p,null)}Co(s,w,P,D);return;case"option":for(Re in p)p.hasOwnProperty(Re)&&(w=p[Re],w!=null)&&(Re==="selected"?s.selected=w&&typeof w!="function"&&typeof w!="symbol":ts(s,o,Re,w,p,null));return;case"dialog":Mn("beforetoggle",s),Mn("toggle",s),Mn("cancel",s),Mn("close",s);break;case"iframe":case"object":Mn("load",s);break;case"video":case"audio":for(w=0;w<zh.length;w++)Mn(zh[w],s);break;case"image":Mn("error",s),Mn("load",s);break;case"details":Mn("toggle",s);break;case"embed":case"source":case"link":Mn("error",s),Mn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(dt in p)if(p.hasOwnProperty(dt)&&(w=p[dt],w!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,o));default:ts(s,o,dt,w,p,null)}return;default:if(jl(o)){for(Et in p)p.hasOwnProperty(Et)&&(w=p[Et],w!==void 0&&Od(s,o,Et,w,p,void 0));return}}for(pe in p)p.hasOwnProperty(pe)&&(w=p[pe],w!=null&&ts(s,o,pe,w,p,null))}function A_(s,o,p,w){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var P=null,D=null,W=null,pe=null,Re=null,dt=null,Et=null;for(yt in p){var Lt=p[yt];if(p.hasOwnProperty(yt)&&Lt!=null)switch(yt){case"checked":break;case"value":break;case"defaultValue":Re=Lt;default:w.hasOwnProperty(yt)||ts(s,o,yt,null,w,Lt)}}for(var ft in w){var yt=w[ft];if(Lt=p[ft],w.hasOwnProperty(ft)&&(yt!=null||Lt!=null))switch(ft){case"type":D=yt;break;case"name":P=yt;break;case"checked":dt=yt;break;case"defaultChecked":Et=yt;break;case"value":W=yt;break;case"defaultValue":pe=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(l(137,o));break;default:yt!==Lt&&ts(s,o,ft,yt,w,Lt)}}Da(s,W,pe,Re,dt,Et,D,P);return;case"select":yt=W=pe=ft=null;for(D in p)if(Re=p[D],p.hasOwnProperty(D)&&Re!=null)switch(D){case"value":break;case"multiple":yt=Re;default:w.hasOwnProperty(D)||ts(s,o,D,null,w,Re)}for(P in w)if(D=w[P],Re=p[P],w.hasOwnProperty(P)&&(D!=null||Re!=null))switch(P){case"value":ft=D;break;case"defaultValue":pe=D;break;case"multiple":W=D;default:D!==Re&&ts(s,o,P,D,w,Re)}o=pe,p=W,w=yt,ft!=null?Gn(s,!!p,ft,!1):!!w!=!!p&&(o!=null?Gn(s,!!p,o,!0):Gn(s,!!p,p?[]:"",!1));return;case"textarea":yt=ft=null;for(pe in p)if(P=p[pe],p.hasOwnProperty(pe)&&P!=null&&!w.hasOwnProperty(pe))switch(pe){case"value":break;case"children":break;default:ts(s,o,pe,null,w,P)}for(W in w)if(P=w[W],D=p[W],w.hasOwnProperty(W)&&(P!=null||D!=null))switch(W){case"value":ft=P;break;case"defaultValue":yt=P;break;case"children":break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(l(91));break;default:P!==D&&ts(s,o,W,P,w,D)}$r(s,ft,yt);return;case"option":for(var xi in p)ft=p[xi],p.hasOwnProperty(xi)&&ft!=null&&!w.hasOwnProperty(xi)&&(xi==="selected"?s.selected=!1:ts(s,o,xi,null,w,ft));for(Re in w)ft=w[Re],yt=p[Re],w.hasOwnProperty(Re)&&ft!==yt&&(ft!=null||yt!=null)&&(Re==="selected"?s.selected=ft&&typeof ft!="function"&&typeof ft!="symbol":ts(s,o,Re,ft,w,yt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fi in p)ft=p[Fi],p.hasOwnProperty(Fi)&&ft!=null&&!w.hasOwnProperty(Fi)&&ts(s,o,Fi,null,w,ft);for(dt in w)if(ft=w[dt],yt=p[dt],w.hasOwnProperty(dt)&&ft!==yt&&(ft!=null||yt!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(l(137,o));break;default:ts(s,o,dt,ft,w,yt)}return;default:if(jl(o)){for(var vs in p)ft=p[vs],p.hasOwnProperty(vs)&&ft!==void 0&&!w.hasOwnProperty(vs)&&Od(s,o,vs,void 0,w,ft);for(Et in w)ft=w[Et],yt=p[Et],!w.hasOwnProperty(Et)||ft===yt||ft===void 0&&yt===void 0||Od(s,o,Et,ft,w,yt);return}}for(var Qe in p)ft=p[Qe],p.hasOwnProperty(Qe)&&ft!=null&&!w.hasOwnProperty(Qe)&&ts(s,o,Qe,null,w,ft);for(Lt in w)ft=w[Lt],yt=p[Lt],!w.hasOwnProperty(Lt)||ft===yt||ft==null&&yt==null||ts(s,o,Lt,ft,w,yt)}function a(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function n(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,p=performance.getEntriesByType("resource"),w=0;w<p.length;w++){var P=p[w],D=P.transferSize,W=P.initiatorType,pe=P.duration;if(D&&pe&&a(W)){for(W=0,pe=P.responseEnd,w+=1;w<p.length;w++){var Re=p[w],dt=Re.startTime;if(dt>pe)break;var Et=Re.transferSize,Lt=Re.initiatorType;Et&&a(Lt)&&(Re=Re.responseEnd,W+=Et*(Re<pe?1:(pe-dt)/(Re-dt)))}if(--w,o+=8*(D+W)/(P.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var c=null,m=null;function x(s){return s.nodeType===9?s:s.ownerDocument}function k(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function C(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function j(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var R=null;function F(){var s=window.event;return s&&s.type==="popstate"?s===R?!1:(R=s,!0):(R=null,!1)}var q=typeof setTimeout=="function"?setTimeout:void 0,G=typeof clearTimeout=="function"?clearTimeout:void 0,J=typeof Promise=="function"?Promise:void 0,re=typeof queueMicrotask=="function"?queueMicrotask:typeof J<"u"?function(s){return J.resolve(null).then(s).catch(ce)}:q;function ce(s){setTimeout(function(){throw s})}function he(s){return s==="head"}function Ee(s,o){var p=o,w=0;do{var P=p.nextSibling;if(s.removeChild(p),P&&P.nodeType===8)if(p=P.data,p==="/$"||p==="/&"){if(w===0){s.removeChild(P),Bf(o);return}w--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")w++;else if(p==="html")vt(s.ownerDocument.documentElement);else if(p==="head"){p=s.ownerDocument.head,vt(p);for(var D=p.firstChild;D;){var W=D.nextSibling,pe=D.nodeName;D[pi]||pe==="SCRIPT"||pe==="STYLE"||pe==="LINK"&&D.rel.toLowerCase()==="stylesheet"||p.removeChild(D),D=W}}else p==="body"&&vt(s.ownerDocument.body);p=P}while(p);Bf(o)}function Ae(s,o){var p=s;s=0;do{var w=p.nextSibling;if(p.nodeType===1?o?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(o?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),w&&w.nodeType===8)if(p=w.data,p==="/$"){if(s===0)break;s--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||s++;p=w}while(p)}function Xe(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var p=o;switch(o=o.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Xe(p),Ne(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function De(s,o,p,w){for(;s.nodeType===1;){var P=p;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!w&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(w){if(!s[pi])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(D=s.getAttribute("rel"),D==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(D!==P.rel||s.getAttribute("href")!==(P.href==null||P.href===""?null:P.href)||s.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin)||s.getAttribute("title")!==(P.title==null?null:P.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(D=s.getAttribute("src"),(D!==(P.src==null?null:P.src)||s.getAttribute("type")!==(P.type==null?null:P.type)||s.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin))&&D&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var D=P.name==null?null:""+P.name;if(P.type==="hidden"&&s.getAttribute("name")===D)return s}else return s;if(s=Vt(s.nextSibling),s===null)break}return null}function Ge(s,o,p){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=Vt(s.nextSibling),s===null))return null;return s}function pt(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Vt(s.nextSibling),s===null))return null;return s}function Dt(s){return s.data==="$?"||s.data==="$~"}function Qt(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Ai(s,o){var p=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||p.readyState!=="loading")o();else{var w=function(){o(),p.removeEventListener("DOMContentLoaded",w)};p.addEventListener("DOMContentLoaded",w),s._reactRetry=w}}function Vt(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var Gt=null;function fi(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var p=s.data;if(p==="/$"||p==="/&"){if(o===0)return Vt(s.nextSibling);o--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||o++}s=s.nextSibling}return null}function ci(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(o===0)return s;o--}else p!=="/$"&&p!=="/&"||o++}s=s.previousSibling}return null}function ri(s,o,p){switch(o=x(p),s){case"html":if(s=o.documentElement,!s)throw Error(l(452));return s;case"head":if(s=o.head,!s)throw Error(l(453));return s;case"body":if(s=o.body,!s)throw Error(l(454));return s;default:throw Error(l(451))}}function vt(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);Ne(s)}var li=new Map,di=new Set;function Li(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var kn=ot.d;ot.d={f:Yn,r:cr,D:ur,C:pa,L:ma,m:ga,X:hr,S:js,M:Jr};function Yn(){var s=kn.f(),o=Cd();return s||o}function cr(s){var o=Jt(s);o!==null&&o.tag===5&&o.type==="form"?Ap(o):kn.r(s)}var Kr=typeof document>"u"?null:document;function Er(s,o,p){var w=Kr;if(w&&typeof o=="string"&&o){var P=Bn(o);P='link[rel="'+s+'"][href="'+P+'"]',typeof p=="string"&&(P+='[crossorigin="'+p+'"]'),di.has(P)||(di.add(P),s={rel:s,crossOrigin:p,href:o},w.querySelector(P)===null&&(o=w.createElement("link"),Tr(o,"link",s),vn(o),w.head.appendChild(o)))}}function ur(s){kn.D(s),Er("dns-prefetch",s,null)}function pa(s,o){kn.C(s,o),Er("preconnect",s,o)}function ma(s,o,p){kn.L(s,o,p);var w=Kr;if(w&&s&&o){var P='link[rel="preload"][as="'+Bn(o)+'"]';o==="image"&&p&&p.imageSrcSet?(P+='[imagesrcset="'+Bn(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(P+='[imagesizes="'+Bn(p.imageSizes)+'"]')):P+='[href="'+Bn(s)+'"]';var D=P;switch(o){case"style":D=er(s);break;case"script":D=yn(s)}li.has(D)||(s=N({rel:"preload",href:o==="image"&&p&&p.imageSrcSet?void 0:s,as:o},p),li.set(D,s),w.querySelector(P)!==null||o==="style"&&w.querySelector(Zs(D))||o==="script"&&w.querySelector(Un(D))||(o=w.createElement("link"),Tr(o,"link",s),vn(o),w.head.appendChild(o)))}}function ga(s,o){kn.m(s,o);var p=Kr;if(p&&s){var w=o&&typeof o.as=="string"?o.as:"script",P='link[rel="modulepreload"][as="'+Bn(w)+'"][href="'+Bn(s)+'"]',D=P;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=yn(s)}if(!li.has(D)&&(s=N({rel:"modulepreload",href:s},o),li.set(D,s),p.querySelector(P)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Un(D)))return}w=p.createElement("link"),Tr(w,"link",s),vn(w),p.head.appendChild(w)}}}function js(s,o,p){kn.S(s,o,p);var w=Kr;if(w&&s){var P=wi(w).hoistableStyles,D=er(s);o=o||"default";var W=P.get(D);if(!W){var pe={loading:0,preload:null};if(W=w.querySelector(Zs(D)))pe.loading=5;else{s=N({rel:"stylesheet",href:s,"data-precedence":o},p),(p=li.get(D))&&gs(s,p);var Re=W=w.createElement("link");vn(Re),Tr(Re,"link",s),Re._p=new Promise(function(dt,Et){Re.onload=dt,Re.onerror=Et}),Re.addEventListener("load",function(){pe.loading|=1}),Re.addEventListener("error",function(){pe.loading|=2}),pe.loading|=4,Qr(W,o,w)}W={type:"stylesheet",instance:W,count:1,state:pe},P.set(D,W)}}}function hr(s,o){kn.X(s,o);var p=Kr;if(p&&s){var w=wi(p).hoistableScripts,P=yn(s),D=w.get(P);D||(D=p.querySelector(Un(P)),D||(s=N({src:s,async:!0},o),(o=li.get(P))&&hu(s,o),D=p.createElement("script"),vn(D),Tr(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(P,D))}}function Jr(s,o){kn.M(s,o);var p=Kr;if(p&&s){var w=wi(p).hoistableScripts,P=yn(s),D=w.get(P);D||(D=p.querySelector(Un(P)),D||(s=N({src:s,async:!0,type:"module"},o),(o=li.get(P))&&hu(s,o),D=p.createElement("script"),vn(D),Tr(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},w.set(P,D))}}function kr(s,o,p,w){var P=(P=Ct.current)?Li(P):null;if(!P)throw Error(l(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(o=er(p.href),p=wi(P).hoistableStyles,w=p.get(o),w||(w={type:"style",instance:null,count:0,state:null},p.set(o,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=er(p.href);var D=wi(P).hoistableStyles,W=D.get(s);if(W||(P=P.ownerDocument||P,W={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(s,W),(D=P.querySelector(Zs(s)))&&!D._p&&(W.instance=D,W.state.loading=5),li.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},li.set(s,p),D||Ma(P,s,p,W.state))),o&&w===null)throw Error(l(528,""));return W}if(o&&w!==null)throw Error(l(529,""));return null;case"script":return o=p.async,p=p.src,typeof p=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=yn(p),p=wi(P).hoistableScripts,w=p.get(o),w||(w={type:"script",instance:null,count:0,state:null},p.set(o,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,s))}}function er(s){return'href="'+Bn(s)+'"'}function Zs(s){return'link[rel="stylesheet"]['+s+"]"}function Ja(s){return N({},s,{"data-precedence":s.precedence,precedence:null})}function Ma(s,o,p,w){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?w.loading=1:(o=s.createElement("link"),w.preload=o,o.addEventListener("load",function(){return w.loading|=1}),o.addEventListener("error",function(){return w.loading|=2}),Tr(o,"link",p),vn(o),s.head.appendChild(o))}function yn(s){return'[src="'+Bn(s)+'"]'}function Un(s){return"script[async]"+s}function cs(s,o,p){if(o.count++,o.instance===null)switch(o.type){case"style":var w=s.querySelector('style[data-href~="'+Bn(p.href)+'"]');if(w)return o.instance=w,vn(w),w;var P=N({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return w=(s.ownerDocument||s).createElement("style"),vn(w),Tr(w,"style",P),Qr(w,p.precedence,s),o.instance=w;case"stylesheet":P=er(p.href);var D=s.querySelector(Zs(P));if(D)return o.state.loading|=4,o.instance=D,vn(D),D;w=Ja(p),(P=li.get(P))&&gs(w,P),D=(s.ownerDocument||s).createElement("link"),vn(D);var W=D;return W._p=new Promise(function(pe,Re){W.onload=pe,W.onerror=Re}),Tr(D,"link",w),o.state.loading|=4,Qr(D,p.precedence,s),o.instance=D;case"script":return D=yn(p.src),(P=s.querySelector(Un(D)))?(o.instance=P,vn(P),P):(w=p,(P=li.get(D))&&(w=N({},p),hu(w,P)),s=s.ownerDocument||s,P=s.createElement("script"),vn(P),Tr(P,"link",w),s.head.appendChild(P),o.instance=P);case"void":return null;default:throw Error(l(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(w=o.instance,o.state.loading|=4,Qr(w,p.precedence,s));return o.instance}function Qr(s,o,p){for(var w=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),P=w.length?w[w.length-1]:null,D=P,W=0;W<w.length;W++){var pe=w[W];if(pe.dataset.precedence===o)D=pe;else if(D!==P)break}D?D.parentNode.insertBefore(s,D.nextSibling):(o=p.nodeType===9?p.head:p,o.insertBefore(s,o.firstChild))}function gs(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function hu(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var bo=null;function Tl(s,o,p){if(bo===null){var w=new Map,P=bo=new Map;P.set(p,w)}else P=bo,w=P.get(p),w||(w=new Map,P.set(p,w));if(w.has(s))return w;for(w.set(s,null),p=p.getElementsByTagName(s),P=0;P<p.length;P++){var D=p[P];if(!(D[pi]||D[At]||s==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var W=D.getAttribute(o)||"";W=s+W;var pe=w.get(W);pe?pe.push(D):w.set(W,[D])}}return w}function wo(s,o,p){s=s.ownerDocument||s,s.head.insertBefore(p,o==="title"?s.querySelector("head > title"):null)}function So(s,o,p){if(p===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(s=o.disabled,typeof o.precedence=="string"&&s==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function dr(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function wc(s,o,p,w){if(p.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var P=er(w.href),D=o.querySelector(Zs(P));if(D){o=D._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=Nd.bind(s),o.then(s,s)),p.state.loading|=4,p.instance=D,vn(D);return}D=o.ownerDocument||o,w=Ja(w),(P=li.get(P))&&gs(w,P),D=D.createElement("link"),vn(D);var W=D;W._p=new Promise(function(pe,Re){W.onload=pe,W.onerror=Re}),Tr(D,"link",w),p.instance=D}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(p,o),(o=p.state.preload)&&(p.state.loading&3)===0&&(s.count++,p=Nd.bind(s),o.addEventListener("load",p),o.addEventListener("error",p))}}var Vu=0;function Gg(s,o){return s.stylesheets&&s.count===0&&Oh(s,s.stylesheets),0<s.count||0<s.imgCount?function(p){var w=setTimeout(function(){if(s.stylesheets&&Oh(s,s.stylesheets),s.unsuspend){var D=s.unsuspend;s.unsuspend=null,D()}},6e4+o);0<s.imgBytes&&Vu===0&&(Vu=62500*n());var P=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Oh(s,s.stylesheets),s.unsuspend)){var D=s.unsuspend;s.unsuspend=null,D()}},(s.imgBytes>Vu?50:800)+o);return s.unsuspend=p,function(){s.unsuspend=null,clearTimeout(w),clearTimeout(P)}}:null}function Nd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Oh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Dh=null;function Oh(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Dh=new Map,o.forEach(Sc,s),Dh=null,Nd.call(s))}function Sc(s,o){if(!(o.state.loading&4)){var p=Dh.get(s);if(p)var w=p.get(null);else{p=new Map,Dh.set(s,p);for(var P=s.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<P.length;D++){var W=P[D];(W.nodeName==="LINK"||W.getAttribute("media")!=="not all")&&(p.set(W.dataset.precedence,W),w=W)}w&&p.set(null,w)}P=o.instance,W=P.getAttribute("data-precedence"),D=p.get(W)||w,D===w&&p.set(null,P),p.set(W,P),this.count++,w=Nd.bind(this),P.addEventListener("load",w),P.addEventListener("error",w),D?D.parentNode.insertBefore(P,D.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(P,s.firstChild)),o.state.loading|=4}}var Nh={$$typeof:ae,Provider:null,Consumer:null,_currentValue:Fe,_currentValue2:Fe,_threadCount:0};function Wg(s,o,p,w,P,D,W,pe,Re){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=je(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=je(0),this.hiddenUpdates=je(null),this.identifierPrefix=w,this.onUncaughtError=P,this.onCaughtError=D,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Re,this.incompleteTransitions=new Map}function Yg(s,o,p,w,P,D,W,pe,Re,dt,Et,Lt){return s=new Wg(s,o,p,W,Re,dt,Et,Lt,pe),o=1,D===!0&&(o|=24),D=Ks(3,null,null,o),s.current=D,D.stateNode=s,o=qa(),o.refCount++,s.pooledCache=o,o.refCount++,D.memoizedState={element:w,isDehydrated:p,cache:o},ii(D),s}function Xg(s){return s?(s=br,s):br}function Kg(s,o,p,w,P,D){P=Xg(P),w.context===null?w.context=P:w.pendingContext=P,w=Ft(o),w.payload={element:p},D=D===void 0?null:D,D!==null&&(w.callback=D),p=oi(s,w,o),p!==null&&(da(p,s,o),ji(p,s,o))}function Jg(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<o?p:o}}function mm(s,o){Jg(s,o),(s=s.alternate)&&Jg(s,o)}function Qg(s){if(s.tag===13||s.tag===31){var o=ua(s,67108864);o!==null&&da(o,s,67108864),mm(s,67108864)}}function ey(s){if(s.tag===13||s.tag===31){var o=xo();o=Ye(o);var p=ua(s,o);p!==null&&da(p,s,o),mm(s,o)}}var Rf=!0;function El(s,o,p,w){var P=Be.T;Be.T=null;var D=ot.p;try{ot.p=2,Of(s,o,p,w)}finally{ot.p=D,Be.T=P}}function Df(s,o,p,w){var P=Be.T;Be.T=null;var D=ot.p;try{ot.p=8,Of(s,o,p,w)}finally{ot.p=D,Be.T=P}}function Of(s,o,p,w){if(Rf){var P=gm(w);if(P===null)Ld(s,o,w,Nf,p),Jx(s,w);else if(b2(P,s,o,p,w))w.stopPropagation();else if(Jx(s,w),o&4&&-1<x2.indexOf(s)){for(;P!==null;){var D=Jt(P);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var W=xe(D.pendingLanes);if(W!==0){var pe=D;for(pe.pendingLanes|=2,pe.entangledLanes|=2;W;){var Re=1<<31-Ji(W);pe.entanglements[1]|=Re,W&=~Re}Kl(D),(qn&6)===0&&(Sf=an()+500,Ih(0))}}break;case 31:case 13:pe=ua(D,2),pe!==null&&da(pe,D,2),Cd(),mm(D,2)}if(D=gm(w),D===null&&Ld(s,o,w,Nf,p),D===P)break;P=D}P!==null&&w.stopPropagation()}else Ld(s,o,w,null,p)}}function gm(s){return s=Us(s),ym(s)}var Nf=null;function ym(s){if(Nf=null,s=zt(s),s!==null){var o=_(s);if(o===null)s=null;else{var p=o.tag;if(p===13){if(s=y(o),s!==null)return s;s=null}else if(p===31){if(s=d(o),s!==null)return s;s=null}else if(p===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Nf=s,null}function Dr(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(en()){case qi:return 2;case Fn:return 8;case Tt:case On:return 32;case dn:return 268435456;default:return 32}default:return 32}}var Pa=!1,Qa=null,Or=null,eo=null,to=new Map,_m=new Map,Bh=[],x2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jx(s,o){switch(s){case"focusin":case"focusout":Qa=null;break;case"dragenter":case"dragleave":Or=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":to.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":_m.delete(o.pointerId)}}function vm(s,o,p,w,P,D){return s===null||s.nativeEvent!==D?(s={blockedOn:o,domEventName:p,eventSystemFlags:w,nativeEvent:D,targetContainers:[P]},o!==null&&(o=Jt(o),o!==null&&Qg(o)),s):(s.eventSystemFlags|=w,o=s.targetContainers,P!==null&&o.indexOf(P)===-1&&o.push(P),s)}function b2(s,o,p,w,P){switch(o){case"focusin":return Qa=vm(Qa,s,o,p,w,P),!0;case"dragenter":return Or=vm(Or,s,o,p,w,P),!0;case"mouseover":return eo=vm(eo,s,o,p,w,P),!0;case"pointerover":var D=P.pointerId;return to.set(D,vm(to.get(D)||null,s,o,p,w,P)),!0;case"gotpointercapture":return D=P.pointerId,_m.set(D,vm(_m.get(D)||null,s,o,p,w,P)),!0}return!1}function Qx(s){var o=zt(s.target);if(o!==null){var p=_(o);if(p!==null){if(o=p.tag,o===13){if(o=y(p),o!==null){s.blockedOn=o,si(s.priority,function(){ey(p)});return}}else if(o===31){if(o=d(p),o!==null){s.blockedOn=o,si(s.priority,function(){ey(p)});return}}else if(o===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ty(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var p=gm(s.nativeEvent);if(p===null){p=s.nativeEvent;var w=new p.constructor(p.type,p);Ao=w,p.target.dispatchEvent(w),Ao=null}else return o=Jt(p),o!==null&&Qg(o),s.blockedOn=p,!1;o.shift()}return!0}function eb(s,o,p){ty(s)&&p.delete(o)}function w2(){Pa=!1,Qa!==null&&ty(Qa)&&(Qa=null),Or!==null&&ty(Or)&&(Or=null),eo!==null&&ty(eo)&&(eo=null),to.forEach(eb),_m.forEach(eb)}function iy(s,o){s.blockedOn===o&&(s.blockedOn=null,Pa||(Pa=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,w2)))}var ny=null;function tb(s){ny!==s&&(ny=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){ny===s&&(ny=null);for(var o=0;o<s.length;o+=3){var p=s[o],w=s[o+1],P=s[o+2];if(typeof w!="function"){if(ym(w||p)===null)continue;break}var D=Jt(p);D!==null&&(s.splice(o,3),o-=3,hf(D,{pending:!0,data:P,method:p.method,action:w},w,P))}}))}function Bf(s){function o(Re){return iy(Re,s)}Qa!==null&&iy(Qa,s),Or!==null&&iy(Or,s),eo!==null&&iy(eo,s),to.forEach(o),_m.forEach(o);for(var p=0;p<Bh.length;p++){var w=Bh[p];w.blockedOn===s&&(w.blockedOn=null)}for(;0<Bh.length&&(p=Bh[0],p.blockedOn===null);)Qx(p),p.blockedOn===null&&Bh.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(w=0;w<p.length;w+=3){var P=p[w],D=p[w+1],W=P[ni]||null;if(typeof D=="function")W||tb(p);else if(W){var pe=null;if(D&&D.hasAttribute("formAction")){if(P=D,W=D[ni]||null)pe=W.formAction;else if(ym(P)!==null)continue}else pe=W.action;typeof pe=="function"?p[w+1]=pe:(p.splice(w,3),w-=3),tb(p)}}}function ib(){function s(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(W){return P=W})},focusReset:"manual",scroll:"manual"})}function o(){P!==null&&(P(),P=null),w||setTimeout(p,20)}function p(){if(!w&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,P=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(p,100),function(){w=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),P!==null&&(P(),P=null)}}}function M_(s){this._internalRoot=s}sy.prototype.render=M_.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(l(409));var p=o.current,w=xo();Kg(p,w,s,o,null,null)},sy.prototype.unmount=M_.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Kg(s.current,2,null,s,null,null),Cd(),o[vi]=null}};function sy(s){this._internalRoot=s}sy.prototype.unstable_scheduleHydration=function(s){if(s){var o=ei();s={blockedOn:null,target:s,priority:o};for(var p=0;p<Bh.length&&o!==0&&o<Bh[p].priority;p++);Bh.splice(p,0,s),p===0&&Qx(s)}};var nb=e.version;if(nb!=="19.2.0")throw Error(l(527,nb,"19.2.0"));ot.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(l(188)):(s=Object.keys(s).join(","),Error(l(268,s)));return s=I(o),s=s!==null?B(s):null,s=s===null?null:s.stateNode,s};var S2={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Be,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ry=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ry.isDisabled&&ry.supportsFiber)try{It=ry.inject(S2),ai=ry}catch{}}return bm.createRoot=function(s,o){if(!f(s))throw Error(l(299));var p=!1,w="",P=fg,D=pg,W=mg;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(w=o.identifierPrefix),o.onUncaughtError!==void 0&&(P=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&(W=o.onRecoverableError)),o=Yg(s,1,!1,null,null,p,w,null,P,D,W,ib),s[vi]=o.current,dm(s),new M_(o)},bm.hydrateRoot=function(s,o,p){if(!f(s))throw Error(l(299));var w=!1,P="",D=fg,W=pg,pe=mg,Re=null;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(P=p.identifierPrefix),p.onUncaughtError!==void 0&&(D=p.onUncaughtError),p.onCaughtError!==void 0&&(W=p.onCaughtError),p.onRecoverableError!==void 0&&(pe=p.onRecoverableError),p.formState!==void 0&&(Re=p.formState)),o=Yg(s,1,!0,o,p??null,w,P,Re,D,W,pe,ib),o.context=Xg(null),p=o.current,w=xo(),w=Ye(w),P=Ft(w),P.callback=null,oi(p,P,w),p=w,o.current.lanes=p,Oe(o,p),Kl(o),s[vi]=o.current,dm(s),new sy(o)},bm.version="19.2.0",bm}var fb;function j2(){if(fb)return I_.exports;fb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),I_.exports=I2(),I_.exports}var L2=j2();const z2=Kh(L2);var te=nx();const Nt=Kh(te),R2="modulepreload",D2=function(t){return"/"+t},pb={},Ac=function(e,r,l){let f=Promise.resolve();if(r&&r.length>0){let A=function(I){return Promise.all(I.map(B=>Promise.resolve(B).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),d=y?.nonce||y?.getAttribute("nonce");f=A(r.map(I=>{if(I=D2(I),I in pb)return;pb[I]=!0;const B=I.endsWith(".css"),N=B?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${I}"]${N}`))return;const V=document.createElement("link");if(V.rel=B?"stylesheet":R2,B||(V.as="script"),V.crossOrigin="",V.href=I,d&&V.setAttribute("nonce",d),document.head.appendChild(V),B)return new Promise((K,ie)=>{V.addEventListener("load",K),V.addEventListener("error",()=>ie(new Error(`Unable to preload CSS for ${I}`)))})}))}function _(y){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=y,window.dispatchEvent(d),!d.defaultPrevented)throw y}return f.then(y=>{for(const d of y||[])d.status==="rejected"&&_(d.reason);return e().catch(_)})};var Cr={allRenderFn:!1,element:!0,event:!0,hasRenderFn:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,propChangeCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!0,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1},O2="app",N2=Object.defineProperty,B2=(t,e)=>{for(var r in e)N2(t,r,{get:e[r],enumerable:!0})},$2={isBrowser:!0},U2="http://www.w3.org/2000/svg",F2="http://www.w3.org/1999/xhtml",V2=(t,e)=>{var r;const l=e.$cmpMeta$;Object.entries((r=l.$members$)!=null?r:{}).map(([_,[y]])=>{if(y&31||y&32){const d=t[_],A=q2(Object.getPrototypeOf(t),_)||Object.getOwnPropertyDescriptor(t,_);A&&Object.defineProperty(t,_,{get(){return A.get.call(this)},set(I){A.set.call(this,I)},configurable:!0,enumerable:!0}),t[_]=e.$instanceValues$.has(_)?e.$instanceValues$.get(_):d}})};function q2(t,e){for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r?.get)return r;t=Object.getPrototypeOf(t)}}var Wu=t=>{if(t.__stencil__getHostRef)return t.__stencil__getHostRef()},H2=(t,e)=>{const r={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map,$serializerValues$:new Map};r.$onReadyPromise$=new Promise(f=>r.$onReadyResolve$=f),t["s-p"]=[],t["s-rc"]=[];const l=r;return t.__stencil__getHostRef=()=>l,Cr.modernPropertyDecls&&Cr.state&&V2(t,r),l},mb=(t,e)=>e in t,Xm=(t,e)=>(0,console.error)(t,e),jy=new Map,Ew=[],Z2="slot-fb{display:contents}slot-fb[hidden]{display:none}",gb="http://www.w3.org/1999/xlink",pr=typeof window<"u"?window:{},La=pr.HTMLElement||class{},za={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,r,l)=>t.addEventListener(e,r,l),rel:(t,e,r,l)=>t.removeEventListener(e,r,l),ce:(t,e)=>new CustomEvent(t,e)},G2=(()=>{var t;let e=!1;try{(t=pr.document)==null||t.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),W2=t=>Promise.resolve(t),sx=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),yv=sx?!!pr.document&&Object.getOwnPropertyDescriptor(pr.document.adoptedStyleSheets,"length").writable:!1,_v=!1,vv=[],kw=[],Cw=(t,e)=>r=>{t.push(r),_v||(_v=!0,e&&za.$flags$&4?rx(xv):za.raf(xv))},yb=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(r){Xm(r)}t.length=0},xv=()=>{yb(vv),yb(kw),(_v=vv.length>0)&&za.raf(xv)},rx=t=>W2().then(t),Ty=Cw(vv,!1),zm=Cw(kw,!0),Y2=t=>{const e=new URL(t,za.$resourcesUrl$);return e.origin!==pr.location.origin?e.href:e.pathname},X2=t=>t!=null&&t!==void 0,ax=t=>(t=typeof t,t==="object"||t==="function");function K2(t){var e,r,l;return(l=(r=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:r.getAttribute("content"))!=null?l:void 0}var J2=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Q2={};B2(Q2,{err:()=>Aw,map:()=>eT,ok:()=>bv,unwrap:()=>tT,unwrapErr:()=>iT});var bv=t=>({isOk:!0,isErr:!1,value:t}),Aw=t=>({isOk:!1,isErr:!0,value:t});function eT(t,e){if(t.isOk){const r=e(t.value);return r instanceof Promise?r.then(l=>bv(l)):bv(r)}if(t.isErr){const r=t.value;return Aw(r)}throw"should never get here"}var tT=t=>{if(t.isOk)return t.value;throw t.value},iT=t=>{if(t.isErr)return t.value;throw t.value};var wm;function nT(t){var e;const r=this.attachShadow({mode:"open",delegatesFocus:!!(t.$flags$&16)});wm===void 0&&(wm=(e=void 0)!=null?e:null),wm&&(yv?r.adoptedStyleSheets.push(wm):r.adoptedStyleSheets=[...r.adoptedStyleSheets,wm])}var Mw=t=>{const e=vb(t,"childNodes");t.tagName&&t.tagName.includes("-")&&t["s-cr"]&&t.tagName!=="SLOT-FB"&&Pw(e,t.tagName).forEach(l=>{l.nodeType===1&&l.tagName==="SLOT-FB"&&(rT(l,ox(l),!1).length?l.hidden=!0:l.hidden=!1)});let r=0;for(r=0;r<e.length;r++){const l=e[r];l.nodeType===1&&vb(l,"childNodes").length&&Mw(l)}},sT=t=>{const e=[];for(let r=0;r<t.length;r++){const l=t[r]["s-nr"]||void 0;l&&l.isConnected&&e.push(l)}return e};function Pw(t,e,r){let l=0,f=[],_;for(;l<t.length;l++)_=t[l],_["s-sr"]&&(!e||_["s-hn"]===e)&&r===void 0&&f.push(_),f=[...f,...Pw(_.childNodes,e,r)];return f}var rT=(t,e,r=!0)=>{const l=[];(r&&t["s-sr"]||!t["s-sr"])&&l.push(t);let f=t;for(;f=f.nextSibling;)ox(f)===e&&(r||!f["s-sr"])&&l.push(f);return l},_b=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",ox=t=>typeof t["s-sn"]=="string"?t["s-sn"]:t.nodeType===1&&t.getAttribute("slot")||void 0;function aT(t){if(t.assignedElements||t.assignedNodes||!t["s-sr"])return;const e=r=>(function(l){const f=[],_=this["s-sn"];l?.flatten&&console.error(`
          Flattening is not supported for Stencil non-shadow slots.
          You can use \`.childNodes\` to nested slot fallback content.
          If you have a particular use case, please open an issue on the Stencil repo.
        `);const y=this["s-cr"].parentElement;return(y.__childNodes?y.childNodes:sT(y.childNodes)).forEach(A=>{_===ox(A)&&f.push(A)}),r?f.filter(A=>A.nodeType===1):f}).bind(t);t.assignedElements=e(!0),t.assignedNodes=e(!1)}function vb(t,e){if("__"+e in t){const r=t["__"+e];return typeof r!="function"?r:r.bind(t)}else return typeof t[e]!="function"?t[e]:t[e].bind(t)}var Kd=(t,e="")=>()=>{},Qf=new WeakMap,oT=(t,e,r)=>{let l=jy.get(t);sx&&r?(l=l||new CSSStyleSheet,typeof l=="string"?l=e:l.replaceSync(e)):l=e,jy.set(t,l)},lT=(t,e,r)=>{var l;const f=Iw(e,r),_=jy.get(f);if(!pr.document)return f;if(t=t.nodeType===11?t:pr.document,_)if(typeof _=="string"){t=t.head||t;let y=Qf.get(t),d;if(y||Qf.set(t,y=new Set),!y.has(f)){{d=pr.document.createElement("style"),d.innerHTML=_;const A=(l=za.$nonce$)!=null?l:K2(pr.document);if(A!=null&&d.setAttribute("nonce",A),!(e.$flags$&1))if(t.nodeName==="HEAD"){const I=t.querySelectorAll("link[rel=preconnect]"),B=I.length>0?I[I.length-1].nextSibling:t.querySelector("style");t.insertBefore(d,B?.parentNode===t?B:null)}else if("host"in t)if(sx){const I=new CSSStyleSheet;I.replaceSync(_),yv?t.adoptedStyleSheets.unshift(I):t.adoptedStyleSheets=[I,...t.adoptedStyleSheets]}else{const I=t.querySelector("style");I?I.innerHTML=_+I.innerHTML:t.prepend(d)}else t.append(d);e.$flags$&1&&t.insertBefore(d,null)}e.$flags$&4&&(d.innerHTML+=Z2),y&&y.add(f)}}else t.adoptedStyleSheets.includes(_)||(yv?t.adoptedStyleSheets.push(_):t.adoptedStyleSheets=[...t.adoptedStyleSheets,_]);return f},cT=t=>{const e=t.$cmpMeta$,r=t.$hostElement$,l=e.$flags$,f=Kd("attachStyles",e.$tagName$),_=lT(r.shadowRoot?r.shadowRoot:r.getRootNode(),e,t.$modeName$);l&10&&(r["s-sc"]=_,r.classList.add(_+"-h")),f()},Iw=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),Ei=(t,e,...r)=>{let l=null,f=null,_=null,y=!1,d=!1;const A=[],I=N=>{for(let V=0;V<N.length;V++)l=N[V],Array.isArray(l)?I(l):l!=null&&typeof l!="boolean"&&((y=typeof t!="function"&&!ax(l))&&(l=String(l)),y&&d?A[A.length-1].$text$+=l:A.push(y?Ly(null,l):l),d=y)};if(I(r),e){e.key&&(f=e.key),e.name&&(_=e.name);{const N=e.className||e.class;N&&(e.class=typeof N!="object"?N:Object.keys(N).filter(V=>N[V]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,A,hT);const B=Ly(t,null);return B.$attrs$=e,A.length>0&&(B.$children$=A),B.$key$=f,B.$name$=_,B},Ly=(t,e)=>{const r={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return r.$attrs$=null,r.$key$=null,r.$name$=null,r},Go={},uT=t=>t&&t.$tag$===Go,hT={forEach:(t,e)=>t.map(xb).forEach(e),map:(t,e)=>t.map(xb).map(e).map(dT)},xb=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),dT=t=>{if(typeof t.vtag=="function"){const r={...t.vattrs};return t.vkey&&(r.key=t.vkey),t.vname&&(r.name=t.vname),Ei(t.vtag,r,...t.vchildren||[])}const e=Ly(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},lx=t=>{const e=J2(t);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${e}))(${e}\\b)`,"g")};lx("::slotted");lx(":host");lx(":host-context");var fT=t=>Ew.map(e=>e(t)).find(e=>!!e),pT=t=>Ew.push(t),mT=t=>{var e;return(e=Wu(t))==null?void 0:e.$modeName$},jw=(t,e,r)=>t!=null&&!ax(t)?e&4?t==="false"?!1:t===""||!!t:e&2?typeof t=="string"?parseFloat(t):typeof t=="number"?t:NaN:e&1?String(t):t:t,gT=t=>t,Hn=(t,e,r)=>{const l=gT(t);return{emit:f=>Lw(l,e,{bubbles:!!(r&4),composed:!!(r&2),cancelable:!!(r&1),detail:f})}},Lw=(t,e,r)=>{const l=za.ce(e,r);return t.dispatchEvent(l),l},bb=(t,e,r,l,f,_,y)=>{if(r===l)return;let d=mb(t,e),A=e.toLowerCase();if(e==="class"){const I=t.classList,B=wb(r);let N=wb(l);I.remove(...B.filter(V=>V&&!N.includes(V))),I.add(...N.filter(V=>V&&!B.includes(V)))}else if(e==="style"){for(const I in r)(!l||l[I]==null)&&(I.includes("-")?t.style.removeProperty(I):t.style[I]="");for(const I in l)(!r||l[I]!==r[I])&&(I.includes("-")?t.style.setProperty(I,l[I]):t.style[I]=l[I])}else if(e!=="key")if(e==="ref")l&&l(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):mb(pr,A)?e=A.slice(2):e=A[2]+e.slice(3),r||l){const I=e.endsWith(zw);e=e.replace(_T,""),r&&za.rel(t,e,r,I),l&&za.ael(t,e,l,I)}}else{const I=ax(l);if((d||I&&l!==null)&&!f)try{if(t.tagName.includes("-"))t[e]!==l&&(t[e]=l);else{const N=l??"";e==="list"?d=!1:(r==null||t[e]!=N)&&(typeof t.__lookupSetter__(e)=="function"?t[e]=N:t.setAttribute(e,N))}}catch{}let B=!1;A!==(A=A.replace(/^xlink\:?/,""))&&(e=A,B=!0),l==null||l===!1?(l!==!1||t.getAttribute(e)==="")&&(B?t.removeAttributeNS(gb,e):t.removeAttribute(e)):(!d||_&4||f)&&!I&&t.nodeType===1&&(l=l===!0?"":l,B?t.setAttributeNS(gb,e,l):t.setAttribute(e,l))}},yT=/\s/,wb=t=>(typeof t=="object"&&t&&"baseVal"in t&&(t=t.baseVal),!t||typeof t!="string"?[]:t.split(yT)),zw="Capture",_T=new RegExp(zw+"$"),wv=(t,e,r,l)=>{const f=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,_=t&&t.$attrs$||{},y=e.$attrs$||{};for(const d of Sb(Object.keys(_)))d in y||bb(f,d,_[d],void 0,r,e.$flags$);for(const d of Sb(Object.keys(y)))bb(f,d,_[d],y[d],r,e.$flags$)};function Sb(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var Ey,zy,Rm,Sv=!1,Ry=!1,cx=!1,qo=!1,Dy=(t,e,r)=>{var l;const f=e.$children$[r];let _=0,y,d,A;if(Sv||(cx=!0,f.$tag$==="slot"&&(f.$flags$|=f.$children$?2:1)),f.$text$!==null)y=f.$elm$=pr.document.createTextNode(f.$text$);else if(f.$flags$&1)y=f.$elm$=pr.document.createTextNode(""),wv(null,f,qo);else{if(qo||(qo=f.$tag$==="svg"),!pr.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(y=f.$elm$=pr.document.createElementNS(qo?U2:F2,!Sv&&Cr.slotRelocation&&f.$flags$&2?"slot-fb":f.$tag$),qo&&f.$tag$==="foreignObject"&&(qo=!1),wv(null,f,qo),X2(Ey)&&y["s-si"]!==Ey&&y.classList.add(y["s-si"]=Ey),f.$children$)for(_=0;_<f.$children$.length;++_)d=Dy(t,f,_),d&&y.appendChild(d);f.$tag$==="svg"?qo=!1:y.tagName==="foreignObject"&&(qo=!0)}return y["s-hn"]=Rm,f.$flags$&3&&(y["s-sr"]=!0,y["s-cr"]=zy,y["s-sn"]=f.$name$||"",y["s-rf"]=(l=f.$attrs$)==null?void 0:l.ref,aT(y),A=t&&t.$children$&&t.$children$[r],A&&A.$tag$===f.$tag$&&t.$elm$&&Dm(t.$elm$,!1),Bw(zy,y,e.$elm$,t?.$elm$)),y},Dm=(t,e)=>{za.$flags$|=1;const r=Array.from(t.__childNodes||t.childNodes);t["s-sr"]&&Cr.experimentalSlotFixes;for(let l=r.length-1;l>=0;l--){const f=r[l];f["s-hn"]!==Rm&&f["s-ol"]&&(Hh(Om(f).parentNode,f,Om(f)),f["s-ol"].remove(),f["s-ol"]=void 0,f["s-sh"]=void 0,cx=!0),e&&Dm(f,e)}za.$flags$&=-2},Rw=(t,e,r,l,f,_)=>{let y=t["s-cr"]&&t["s-cr"].parentNode||t,d;for(y.shadowRoot&&y.tagName===Rm&&(y=y.shadowRoot);f<=_;++f)l[f]&&(d=Dy(null,r,f),d&&(l[f].$elm$=d,Hh(y,d,Om(e))))},Dw=(t,e,r)=>{for(let l=e;l<=r;++l){const f=t[l];if(f){const _=f.$elm$;Nw(f),_&&(Ry=!0,_["s-ol"]?_["s-ol"].remove():Dm(_,!0),_.remove())}}},vT=(t,e,r,l,f=!1)=>{let _=0,y=0,d=0,A=0,I=e.length-1,B=e[0],N=e[I],V=l.length-1,K=l[0],ie=l[V],ne,ve;for(;_<=I&&y<=V;)if(B==null)B=e[++_];else if(N==null)N=e[--I];else if(K==null)K=l[++y];else if(ie==null)ie=l[--V];else if(ay(B,K,f))Gf(B,K,f),B=e[++_],K=l[++y];else if(ay(N,ie,f))Gf(N,ie,f),N=e[--I],ie=l[--V];else if(ay(B,ie,f))(B.$tag$==="slot"||ie.$tag$==="slot")&&Dm(B.$elm$.parentNode,!1),Gf(B,ie,f),Hh(t,B.$elm$,N.$elm$.nextSibling),B=e[++_],ie=l[--V];else if(ay(N,K,f))(B.$tag$==="slot"||ie.$tag$==="slot")&&Dm(N.$elm$.parentNode,!1),Gf(N,K,f),Hh(t,N.$elm$,B.$elm$),N=e[--I],K=l[++y];else{for(d=-1,A=_;A<=I;++A)if(e[A]&&e[A].$key$!==null&&e[A].$key$===K.$key$){d=A;break}d>=0?(ve=e[d],ve.$tag$!==K.$tag$?ne=Dy(e&&e[y],r,d):(Gf(ve,K,f),e[d]=void 0,ne=ve.$elm$),K=l[++y]):(ne=Dy(e&&e[y],r,y),K=l[++y]),ne&&Hh(Om(B.$elm$).parentNode,ne,Om(B.$elm$))}_>I?Rw(t,l[V+1]==null?null:l[V+1].$elm$,r,l,y,V):y>V&&Dw(e,_,I)},ay=(t,e,r=!1)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:r?(r&&!t.$key$&&e.$key$&&(t.$key$=e.$key$),!0):t.$key$===e.$key$:!1,Om=t=>t&&t["s-ol"]||t,Gf=(t,e,r=!1)=>{const l=e.$elm$=t.$elm$,f=t.$children$,_=e.$children$,y=e.$tag$,d=e.$text$;let A;d===null?(qo=y==="svg"?!0:y==="foreignObject"?!1:qo,wv(t,e,qo),f!==null&&_!==null?vT(l,f,e,_,r):_!==null?(t.$text$!==null&&(l.textContent=""),Rw(l,null,e,_,0,_.length-1)):!r&&Cr.updatable&&f!==null&&Dw(f,0,f.length-1),qo&&y==="svg"&&(qo=!1)):(A=l["s-cr"])?A.parentNode.textContent=d:t.$text$!==d&&(l.data=d)},Hu=[],Ow=t=>{let e,r,l;const f=t.__childNodes||t.childNodes;for(const _ of f){if(_["s-sr"]&&(e=_["s-cr"])&&e.parentNode){r=e.parentNode.__childNodes||e.parentNode.childNodes;const y=_["s-sn"];for(l=r.length-1;l>=0;l--)if(e=r[l],!e["s-cn"]&&!e["s-nr"]&&e["s-hn"]!==_["s-hn"])if(_b(e,y)){let d=Hu.find(A=>A.$nodeToRelocate$===e);Ry=!0,e["s-sn"]=e["s-sn"]||y,d?(d.$nodeToRelocate$["s-sh"]=_["s-hn"],d.$slotRefNode$=_):(e["s-sh"]=_["s-hn"],Hu.push({$slotRefNode$:_,$nodeToRelocate$:e})),e["s-sr"]&&Hu.map(A=>{_b(A.$nodeToRelocate$,e["s-sn"])&&(d=Hu.find(I=>I.$nodeToRelocate$===e),d&&!A.$slotRefNode$&&(A.$slotRefNode$=d.$slotRefNode$))})}else Hu.some(d=>d.$nodeToRelocate$===e)||Hu.push({$nodeToRelocate$:e})}_.nodeType===1&&Ow(_)}},Nw=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(Nw)},Hh=(t,e,r)=>(typeof e["s-sn"]=="string"&&e["s-sr"]&&e["s-cr"]&&Bw(e["s-cr"],e,t,e.parentElement),t?.insertBefore(e,r));function Bw(t,e,r,l){var f,_;let y;if(t&&typeof e["s-sn"]=="string"&&e["s-sr"]&&t.parentNode&&t.parentNode["s-sc"]&&(y=e["s-si"]||t.parentNode["s-sc"])){const d=e["s-sn"],A=e["s-hn"];if((f=r.classList)==null||f.add(y+"-s"),l&&((_=l.classList)!=null&&_.contains(y+"-s"))){let I=(l.__childNodes||l.childNodes)[0],B=!1;for(;I;){if(I["s-sn"]!==d&&I["s-hn"]===A&&I["s-sr"]){B=!0;break}I=I.nextSibling}B||l.classList.remove(y+"-s")}}}var xT=(t,e,r=!1)=>{var l,f,_,y,d;const A=t.$hostElement$,I=t.$cmpMeta$,B=t.$vnode$||Ly(null,null),V=uT(e)?e:Ei(null,null,e);if(Rm=A.tagName,I.$attrsToReflect$&&(V.$attrs$=V.$attrs$||{},I.$attrsToReflect$.forEach(([K,ie])=>{Cr.serializer&&t.$serializerValues$.has(K)?V.$attrs$[ie]=t.$serializerValues$.get(K):V.$attrs$[ie]=A[K]})),r&&V.$attrs$)for(const K of Object.keys(V.$attrs$))A.hasAttribute(K)&&!["key","ref","style","class"].includes(K)&&(V.$attrs$[K]=A[K]);V.$tag$=null,V.$flags$|=4,t.$vnode$=V,V.$elm$=B.$elm$=A.shadowRoot||A,Ey=A["s-sc"],Sv=!!(I.$flags$&1)&&!(I.$flags$&128),zy=A["s-cr"],Ry=!1,Gf(B,V,r);{if(za.$flags$|=1,cx){Ow(V.$elm$);for(const K of Hu){const ie=K.$nodeToRelocate$;if(!ie["s-ol"]&&pr.document){const ne=pr.document.createTextNode("");ne["s-nr"]=ie,Hh(ie.parentNode,ie["s-ol"]=ne,ie)}}for(const K of Hu){const ie=K.$nodeToRelocate$,ne=K.$slotRefNode$;if(ne){const ve=ne.parentNode;let se=ne.nextSibling;{let me=(l=ie["s-ol"])==null?void 0:l.previousSibling;for(;me;){let ye=(f=me["s-nr"])!=null?f:null;if(ye&&ye["s-sn"]===ie["s-sn"]&&ve===(ye.__parentNode||ye.parentNode)){for(ye=ye.nextSibling;ye===ie||ye?.["s-sr"];)ye=ye?.nextSibling;if(!ye||!ye["s-nr"]){se=ye;break}}me=me.previousSibling}}const ge=ie.__parentNode||ie.parentNode,ae=ie.__nextSibling||ie.nextSibling;(!se&&ve!==ge||ae!==se)&&ie!==se&&(!ie["s-hn"]&&ie["s-ol"]&&(ie["s-hn"]=ie["s-ol"].parentNode.nodeName),Hh(ve,ie,se),ie.nodeType===1&&ie.tagName!=="SLOT-FB"&&(ie.hidden=(_=ie["s-ih"])!=null?_:!1)),ie&&typeof ne["s-rf"]=="function"&&ne["s-rf"](ne)}else ie.nodeType===1&&(r&&(ie["s-ih"]=(y=ie.hidden)!=null?y:!1),ie.hidden=!0)}}Ry&&Mw(V.$elm$),za.$flags$&=-2,Hu.length=0}if(Cr.experimentalScopedSlotChanges&&I.$flags$&2){const K=V.$elm$.__childNodes||V.$elm$.childNodes;for(const ie of K)ie["s-hn"]!==Rm&&!ie["s-sh"]&&(r&&ie["s-ih"]==null&&(ie["s-ih"]=(d=ie.hidden)!=null?d:!1),ie.hidden=!0)}zy=void 0},$w=(t,e)=>{if(e&&!t.$onRenderResolve$&&e["s-p"]){const r=e["s-p"].push(new Promise(l=>t.$onRenderResolve$=()=>{e["s-p"].splice(r-1,1),l()}))}},n_=(t,e)=>{if(t.$flags$|=16,t.$flags$&4){t.$flags$|=512;return}$w(t,t.$ancestorComponent$);const r=()=>bT(t,e);if(e){queueMicrotask(()=>{r()});return}return zm(r)},bT=(t,e)=>{const r=t.$hostElement$,l=Kd("scheduleUpdate",t.$cmpMeta$.$tagName$),f=r;if(!f)throw new Error(`Can't render component <${r.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let _;return e?_=np(f,"componentWillLoad",void 0,r):_=np(f,"componentWillUpdate",void 0,r),_=Tb(_,()=>np(f,"componentWillRender",void 0,r)),l(),Tb(_,()=>ST(t,f,e))},Tb=(t,e)=>wT(t)?t.then(e).catch(r=>{console.error(r),e()}):e(),wT=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",ST=async(t,e,r)=>{var l;const f=t.$hostElement$,_=Kd("update",t.$cmpMeta$.$tagName$),y=f["s-rc"];r&&cT(t);const d=Kd("render",t.$cmpMeta$.$tagName$);TT(t,e,f,r),y&&(y.map(A=>A()),f["s-rc"]=void 0),d(),_();{const A=(l=f["s-p"])!=null?l:[],I=()=>ET(t);A.length===0?I():(Promise.all(A).then(I),t.$flags$|=4,A.length=0)}},Eb=null,TT=(t,e,r,l)=>{try{Eb=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(Cr.hasRenderFn||Cr.reflect)&&(Cr.vdomRender||Cr.reflect)&&(Cr.hydrateServerSide||xT(t,e,l))}catch(A){Xm(A,t.$hostElement$)}return Eb=null,null},ET=t=>{const e=t.$cmpMeta$.$tagName$,r=t.$hostElement$,l=Kd("postUpdate",e),f=r,_=t.$ancestorComponent$;np(f,"componentDidRender",void 0,r),t.$flags$&64?(np(f,"componentDidUpdate",void 0,r),l()):(t.$flags$|=64,CT(r),np(f,"componentDidLoad",void 0,r),l(),t.$onReadyResolve$(r),_||kT()),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),t.$flags$&512&&rx(()=>n_(t,!1)),t.$flags$&=-517},kb=t=>{var e;{const r=Wu(t),l=(e=r?.$hostElement$)==null?void 0:e.isConnected;return l&&(r.$flags$&18)===2&&n_(r,!1),l}},kT=t=>{rx(()=>Lw(pr,"appload",{detail:{namespace:O2}}))},np=(t,e,r,l)=>{if(t&&t[e])try{return t[e](r)}catch(f){Xm(f,l)}},CT=t=>{var e;return t.classList.add((e=Cr.hydratedSelectorName)!=null?e:"hydrated")},AT=(t,e)=>Wu(t).$instanceValues$.get(e),Cb=(t,e,r,l)=>{const f=Wu(t);if(!f||Cr.serializer&&f.$serializerValues$.has(e)&&f.$serializerValues$.get(e)===r)return;const _=t,y=f.$instanceValues$.get(e),d=f.$flags$,A=_;r=jw(r,l.$members$[e][0]);const I=Number.isNaN(y)&&Number.isNaN(r);if(r!==y&&!I){if(f.$instanceValues$.set(e,r),Cr.serializer&&Cr.reflect&&l.$attrsToReflect$&&A&&l.$serializers$&&l.$serializers$[e]){let N=r;for(const V of l.$serializers$[e])N=A[V](N,e);f.$serializerValues$.set(e,N)}{if(l.$watchers$&&d&128){const N=l.$watchers$[e];N&&N.map(V=>{try{A[V](r,y,e)}catch(K){Xm(K,_)}})}if((d&18)===2){if(A.componentShouldUpdate&&A.componentShouldUpdate(r,y,e)===!1)return;n_(f,!1)}}}},MT=(t,e,r)=>{var l,f;const _=t.prototype;if(e.$members$||Cr.propChangeCallback){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers),t.deserializers&&!e.$deserializers$&&(e.$deserializers$=t.deserializers),t.serializers&&!e.$serializers$&&(e.$serializers$=t.serializers);const y=Object.entries((l=e.$members$)!=null?l:{});y.map(([d,[A]])=>{if(A&31||A&32){const{get:I,set:B}=Object.getOwnPropertyDescriptor(_,d)||{};I&&(e.$members$[d][0]|=2048),B&&(e.$members$[d][0]|=4096),Object.defineProperty(_,d,{get(){return I?I.apply(this):AT(this,d)},configurable:!0,enumerable:!0}),Object.defineProperty(_,d,{set(N){const V=Wu(this);if(V){if(B){typeof(A&32?this[d]:V.$hostElement$[d])>"u"&&V.$instanceValues$.get(d)&&(N=V.$instanceValues$.get(d)),B.apply(this,[jw(N,A)]),N=A&32?this[d]:V.$hostElement$[d],Cb(this,d,N,e);return}{Cb(this,d,N,e);return}}}})}});{const d=new Map;_.attributeChangedCallback=function(A,I,B){za.jmp(()=>{var N;const V=d.get(A),K=Wu(this);if(Cr.serializer&&K.$serializerValues$.has(V)&&K.$serializerValues$.get(V)===B)return;if(this.hasOwnProperty(V)&&Cr.lazyLoad,Cr.deserializer&&e.$deserializers$&&e.$deserializers$[V]){const ne=(ve,se)=>{const ge=se?.[ve](B,V);ge!==this[V]&&(this[V]=ge)};for(const ve of e.$deserializers$[V])ne(ve,this);return}else{if(_.hasOwnProperty(V)&&typeof this[V]=="number"&&this[V]==B)return;if(V==null){const ne=K?.$flags$;if(K&&ne&&!(ne&8)&&ne&128&&B!==I){const se=this,ge=(N=e.$watchers$)==null?void 0:N[A];ge?.forEach(ae=>{se[ae]!=null&&se[ae].call(se,B,I,A)})}return}}const ie=Object.getOwnPropertyDescriptor(_,V);B=B===null&&typeof this[V]=="boolean"?!1:B,B!=this[V]&&(!ie.get||ie.set)&&(this[V]=B)})},t.observedAttributes=Array.from(new Set([...Object.keys((f=e.$watchers$)!=null?f:{}),...y.filter(([A,I])=>I[0]&31).map(([A,I])=>{var B;const N=I[1]||A;return d.set(N,A),I[0]&512&&((B=e.$attrsToReflect$)==null||B.push([A,N])),N})]))}}return t},PT=async(t,e,r,l)=>{let f;if((e.$flags$&32)===0){e.$flags$|=32,r.$lazyBundleId$;{f=t.constructor;const d=t.localName;customElements.whenDefined(d).then(()=>e.$flags$|=128)}if(f&&f.style){let d;typeof f.style=="string"?d=f.style:typeof f.style!="string"&&(e.$modeName$=fT(t),e.$modeName$&&(d=f.style[e.$modeName$]));const A=Iw(r,e.$modeName$);if(!jy.has(A)){const I=Kd("registerStyles",r.$tagName$);oT(A,d,!!(r.$flags$&1)),I()}}}const _=e.$ancestorComponent$,y=()=>n_(e,!0);_&&_["s-rc"]?_["s-rc"].push(y):y()},Ab=(t,e)=>{},IT=t=>{if((za.$flags$&1)===0){const e=Wu(t);if(!e)return;const r=e.$cmpMeta$,l=Kd("connectedCallback",r.$tagName$);if(e.$flags$&1)Uw(t,e,r.$listeners$),e?.$lazyInstance$?Ab(e.$lazyInstance$):e?.$onReadyPromise$&&e.$onReadyPromise$.then(()=>Ab(e.$lazyInstance$));else{e.$flags$|=1,r.$flags$&12&&jT(t);{let f=t;for(;f=f.parentNode||f.host;)if(f["s-p"]){$w(e,e.$ancestorComponent$=f);break}}r.$members$&&Object.entries(r.$members$).map(([f,[_]])=>{if(_&31&&f in t&&t[f]!==Object.prototype[f]){const y=t[f];delete t[f],t[f]=y}}),PT(t,e,r)}l()}},jT=t=>{if(!pr.document)return;const e=t["s-cr"]=pr.document.createComment("");e["s-cn"]=!0,Hh(t,e,t.firstChild)},LT=async t=>{if((za.$flags$&1)===0){const e=Wu(t);e?.$rmListeners$&&(e.$rmListeners$.map(r=>r()),e.$rmListeners$=void 0)}Qf.has(t)&&Qf.delete(t),t.shadowRoot&&Qf.has(t.shadowRoot)&&Qf.delete(t.shadowRoot)},To=(t,e)=>{const r={$flags$:e[0],$tagName$:e[1]};r.$members$=e[2],r.$listeners$=e[3],r.$watchers$=t.$watchers$,r.$deserializers$=t.$deserializers$,r.$serializers$=t.$serializers$,r.$attrsToReflect$=[],!(r.$flags$&1)&&r.$flags$&256;const l=t.prototype.connectedCallback,f=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__hasHostListenerAttached:!1,__registerHost(){H2(this,r)},connectedCallback(){if(!this.__hasHostListenerAttached){const _=Wu(this);if(!_)return;Uw(this,_,r.$listeners$),this.__hasHostListenerAttached=!0}IT(this),l&&l.call(this)},disconnectedCallback(){LT(this),f&&f.call(this)},__attachShadow(){if(!this.shadowRoot)nT.call(this,r);else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${r.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=r.$tagName$,MT(t,r)},Uw=(t,e,r,l)=>{r&&pr.document&&r.map(([f,_,y])=>{const d=RT(pr.document,t,f),A=zT(e,y),I=DT(f);za.ael(d,_,A,I),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>za.rel(d,_,A,I))})},zT=(t,e)=>r=>{var l;try{Cr.lazyLoad||t.$hostElement$[e](r)}catch(f){Xm(f,t.$hostElement$)}},RT=(t,e,r)=>r&4?t:r&8?pr:r&16?t.body:e,DT=t=>G2?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0;class OT{constructor(){this.m=new Map}reset(e){this.m=new Map(Object.entries(e))}get(e,r){const l=this.m.get(e);return l!==void 0?l:r}getBoolean(e,r=!1){const l=this.m.get(e);return l===void 0?r:typeof l=="string"?l==="true":!!l}getNumber(e,r){const l=parseFloat(this.m.get(e));return isNaN(l)?r!==void 0?r:NaN:l}set(e,r){this.m.set(e,r)}}const Sn=new OT,NT=t=>{try{const e=t.sessionStorage.getItem(Fw);return e!==null?JSON.parse(e):{}}catch{return{}}},BT=(t,e)=>{try{t.sessionStorage.setItem(Fw,JSON.stringify(e))}catch{return}},$T=t=>{const e={};return t.location.search.slice(1).split("&").map(r=>r.split("=")).map(([r,l])=>{try{return[decodeURIComponent(r),decodeURIComponent(l)]}catch{return["",""]}}).filter(([r])=>UT(r,Mb)).map(([r,l])=>[r.slice(Mb.length),l]).forEach(([r,l])=>{e[r]=l}),e},UT=(t,e)=>t.substr(0,e.length)===e,Mb="ionic:",Fw="ionic-persist-config";var Yd;(function(t){t.OFF="OFF",t.ERROR="ERROR",t.WARN="WARN"})(Yd||(Yd={}));const Ml=(t,...e)=>{const r=Sn.get("logLevel",Yd.WARN);if([Yd.WARN].includes(r))return console.warn(`[Ionic Warning]: ${t}`,...e)},Ku=(t,...e)=>{const r=Sn.get("logLevel",Yd.ERROR);if([Yd.ERROR,Yd.WARN].includes(r))return console.error(`[Ionic Error]: ${t}`,...e)},FT=(t,...e)=>console.error(`<${t.tagName.toLowerCase()}> must be used inside ${e.join(" or ")}.`);const Bs=typeof window<"u"?window:void 0,Mm=typeof document<"u"?document:void 0;let D_;const VT=t=>{if(D_===void 0){const e=t.style.animationName!==void 0,r=t.style.webkitAnimationName!==void 0;D_=!e&&r?"-webkit-":""}return D_},O_=(t,e,r)=>{const l=e.startsWith("animation")?VT(t):"";t.style.setProperty(l+e,r)},oy=(t=[],e)=>{if(e!==void 0){const r=Array.isArray(e)?e:[e];return[...t,...r]}return t},_n=t=>{let e,r,l,f,_,y,d=[],A=[],I=[],B=!1,N,V={},K=[],ie=[],ne={},ve=0,se=!1,ge=!1,ae,me,ye,Se=!0,ze=!1,He=!0,Ze,st=!1;const lt=t,Ke=[],Mt=[],gt=[],St=[],Be=[],ot=[],Fe=[],kt=[],rt=[],be=[],Ie=[],et=typeof AnimationEffect=="function"||Bs!==void 0&&typeof Bs.AnimationEffect=="function",at=typeof Element=="function"&&typeof Element.prototype.animate=="function"&&et,mt=()=>Ie,Ct=Ne=>(Be.forEach(zt=>{zt.destroy(Ne)}),Ot(Ne),St.length=0,Be.length=0,d.length=0,xn(),B=!1,He=!0,Ze),Ot=Ne=>{cn(),Ne&&Zn()},Kt=()=>{se=!1,ge=!1,He=!0,ae=void 0,me=void 0,ye=void 0,ve=0,ze=!1,Se=!0,st=!1},_i=()=>ve!==0&&!st,Vi=(Ne,zt)=>{const Jt=zt.findIndex(Ki=>Ki.c===Ne);Jt>-1&&zt.splice(Jt,1)},gi=(Ne,zt)=>(gt.push({c:Ne,o:zt}),Ze),Oi=(Ne,zt)=>((zt?.oneTimeCallback?Mt:Ke).push({c:Ne,o:zt}),Ze),xn=()=>(Ke.length=0,Mt.length=0,Ze),cn=()=>{at&&(Ie.forEach(Ne=>{Ne.cancel()}),Ie.length=0)},Zn=()=>{ot.forEach(Ne=>{Ne?.parentNode&&Ne.parentNode.removeChild(Ne)}),ot.length=0},tt=Ne=>(Fe.push(Ne),Ze),Xn=Ne=>(kt.push(Ne),Ze),Pn=Ne=>(rt.push(Ne),Ze),ki=Ne=>(be.push(Ne),Ze),yi=Ne=>(A=oy(A,Ne),Ze),Cn=Ne=>(I=oy(I,Ne),Ze),Ln=(Ne={})=>(V=Ne,Ze),us=(Ne=[])=>{for(const zt of Ne)V[zt]="";return Ze},an=Ne=>(K=oy(K,Ne),Ze),en=Ne=>(ie=oy(ie,Ne),Ze),qi=(Ne={})=>(ne=Ne,Ze),Fn=(Ne=[])=>{for(const zt of Ne)ne[zt]="";return Ze},Tt=()=>_!==void 0?_:N?N.getFill():"both",On=()=>ae!==void 0?ae:y!==void 0?y:N?N.getDirection():"normal",dn=()=>se?"linear":l!==void 0?l:N?N.getEasing():"linear",An=()=>ge?0:me!==void 0?me:r!==void 0?r:N?N.getDuration():0,Kn=()=>f!==void 0?f:N?N.getIterations():1,It=()=>ye!==void 0?ye:e!==void 0?e:N?N.getDelay():0,ai=()=>d,ti=Ne=>(y=Ne,ct(!0),Ze),Ji=Ne=>(_=Ne,ct(!0),Ze),Nn=Ne=>(e=Ne,ct(!0),Ze),mi=Ne=>(l=Ne,ct(!0),Ze),Bt=Ne=>(!at&&Ne===0&&(Ne=1),r=Ne,ct(!0),Ze),hi=Ne=>(f=Ne,ct(!0),Ze),Ci=Ne=>(N=Ne,Ze),bi=Ne=>{if(Ne!=null)if(Ne.nodeType===1)St.push(Ne);else if(Ne.length>=0)for(let zt=0;zt<Ne.length;zt++)St.push(Ne[zt]);else Ku("createAnimation - Invalid addElement value.");return Ze},xe=Ne=>{if(Ne!=null)if(Array.isArray(Ne))for(const zt of Ne)zt.parent(Ze),Be.push(zt);else Ne.parent(Ze),Be.push(Ne);return Ze},ee=Ne=>{const zt=d!==Ne;return d=Ne,zt&&Q(d),Ze},Q=Ne=>{at&&mt().forEach(zt=>{const Jt=zt.effect;if(Jt.setKeyframes)Jt.setKeyframes(Ne);else{const Ki=new KeyframeEffect(Jt.target,Ne,Jt.getTiming());zt.effect=Ki}})},ue=()=>{Fe.forEach(Ki=>Ki()),kt.forEach(Ki=>Ki());const Ne=A,zt=I,Jt=V;St.forEach(Ki=>{const wi=Ki.classList;Ne.forEach(vn=>wi.add(vn)),zt.forEach(vn=>wi.remove(vn));for(const vn in Jt)Jt.hasOwnProperty(vn)&&O_(Ki,vn,Jt[vn])})},we=()=>{rt.forEach(wi=>wi()),be.forEach(wi=>wi());const Ne=Se?1:0,zt=K,Jt=ie,Ki=ne;St.forEach(wi=>{const vn=wi.classList;zt.forEach(gr=>vn.add(gr)),Jt.forEach(gr=>vn.remove(gr));for(const gr in Ki)Ki.hasOwnProperty(gr)&&O_(wi,gr,Ki[gr])}),me=void 0,ae=void 0,ye=void 0,Ke.forEach(wi=>wi.c(Ne,Ze)),Mt.forEach(wi=>wi.c(Ne,Ze)),Mt.length=0,He=!0,Se&&(ze=!0),Se=!0},je=()=>{ve!==0&&(ve--,ve===0&&(we(),N&&N.animationFinish()))},Oe=()=>{St.forEach(Ne=>{const zt=Ne.animate(d,{id:lt,delay:It(),duration:An(),easing:dn(),iterations:Kn(),fill:Tt(),direction:On()});zt.pause(),Ie.push(zt)}),Ie.length>0&&(Ie[0].onfinish=()=>{je()})},qe=()=>{ue(),d.length>0&&at&&Oe(),B=!0},de=Ne=>{Ne=Math.min(Math.max(Ne,0),.9999),at&&Ie.forEach(zt=>{zt.currentTime=zt.effect.getComputedTiming().delay+An()*Ne,zt.pause()})},Je=Ne=>{Ie.forEach(zt=>{zt.effect.updateTiming({delay:It(),duration:An(),easing:dn(),iterations:Kn(),fill:Tt(),direction:On()})}),Ne!==void 0&&de(Ne)},ct=(Ne=!1,zt=!0,Jt)=>(Ne&&Be.forEach(Ki=>{Ki.update(Ne,zt,Jt)}),at&&Je(Jt),Ze),Ye=(Ne=!1,zt)=>(Be.forEach(Jt=>{Jt.progressStart(Ne,zt)}),si(),se=Ne,B||qe(),ct(!1,!0,zt),Ze),nt=Ne=>(Be.forEach(zt=>{zt.progressStep(Ne)}),de(Ne),Ze),ei=(Ne,zt,Jt)=>(se=!1,Be.forEach(Ki=>{Ki.progressEnd(Ne,zt,Jt)}),Jt!==void 0&&(me=Jt),ze=!1,Se=!0,Ne===0?(ae=On()==="reverse"?"normal":"reverse",ae==="reverse"&&(Se=!1),at?(ct(),de(1-zt)):(ye=(1-zt)*An()*-1,ct(!1,!1))):Ne===1&&(at?(ct(),de(zt)):(ye=zt*An()*-1,ct(!1,!1))),Ne!==void 0&&!N&&Bi(),Ze),si=()=>{B&&(at?Ie.forEach(Ne=>{Ne.pause()}):St.forEach(Ne=>{O_(Ne,"animation-play-state","paused")}),st=!0)},$t=()=>(Be.forEach(Ne=>{Ne.pause()}),si(),Ze),At=()=>{je()},ni=()=>{Ie.forEach(Ne=>{Ne.play()}),(d.length===0||St.length===0)&&je()},vi=()=>{at&&(de(0),Je())},Bi=Ne=>new Promise(zt=>{Ne?.sync&&(ge=!0,Oi(()=>ge=!1,{oneTimeCallback:!0})),B||qe(),ze&&(vi(),ze=!1),He&&(ve=Be.length+1,He=!1);const Jt=()=>{Vi(Ki,Mt),zt()},Ki=()=>{Vi(Jt,gt),zt()};Oi(Ki,{oneTimeCallback:!0}),gi(Jt,{oneTimeCallback:!0}),Be.forEach(wi=>{wi.play()}),at?ni():At(),st=!1}),_t=()=>{Be.forEach(Ne=>{Ne.stop()}),B&&(cn(),B=!1),Kt(),gt.forEach(Ne=>Ne.c(0,Ze)),gt.length=0},xt=(Ne,zt)=>{const Jt=d[0];return Jt!==void 0&&(Jt.offset===void 0||Jt.offset===0)?Jt[Ne]=zt:d=[{offset:0,[Ne]:zt},...d],Ze};return Ze={parentAnimation:N,elements:St,childAnimations:Be,id:lt,animationFinish:je,from:xt,to:(Ne,zt)=>{const Jt=d[d.length-1];return Jt!==void 0&&(Jt.offset===void 0||Jt.offset===1)?Jt[Ne]=zt:d=[...d,{offset:1,[Ne]:zt}],Ze},fromTo:(Ne,zt,Jt)=>xt(Ne,zt).to(Ne,Jt),parent:Ci,play:Bi,pause:$t,stop:_t,destroy:Ct,keyframes:ee,addAnimation:xe,addElement:bi,update:ct,fill:Ji,direction:ti,iterations:hi,duration:Bt,easing:mi,delay:Nn,getWebAnimations:mt,getKeyframes:ai,getFill:Tt,getDirection:On,getDelay:It,getIterations:Kn,getEasing:dn,getDuration:An,afterAddRead:Pn,afterAddWrite:ki,afterClearStyles:Fn,afterStyles:qi,afterRemoveClass:en,afterAddClass:an,beforeAddRead:tt,beforeAddWrite:Xn,beforeClearStyles:us,beforeStyles:Ln,beforeRemoveClass:Cn,beforeAddClass:yi,onFinish:Oi,isRunning:_i,progressStart:Ye,progressStep:nt,progressEnd:ei}};const Jd=(t,e)=>{t.componentOnReady?t.componentOnReady().then(r=>e(r)):pu(()=>e(t))},Oy=t=>t.componentOnReady!==void 0,ux=(t,e=[])=>{const r={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(r[l]=t.getAttribute(l)),t.removeAttribute(l))}),r},qT=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],Vw=(t,e)=>ux(t,qT),HT=(t,e,r,l)=>t.addEventListener(e,r,l),ZT=(t,e,r,l)=>t.removeEventListener(e,r,l),Ar=(t,e=t)=>t.shadowRoot||e,pu=t=>typeof __zone_symbol__requestAnimationFrame=="function"?__zone_symbol__requestAnimationFrame(t):typeof requestAnimationFrame=="function"?requestAnimationFrame(t):setTimeout(t),qw=t=>{if(t.focus(),t.classList.contains("ion-focusable")){const e=t.closest("ion-app");e&&e.setFocus([t])}},Ny=(t,e,r)=>Math.max(t,Math.min(e,r)),Vo=(t,e)=>{if(!t){const r="ASSERT: "+e;Ku(r);debugger;throw new Error(r)}},MD=t=>{if(t){const e=t.changedTouches;if(e&&e.length>0){const r=e[0];return{x:r.clientX,y:r.clientY}}if(t.pageX!==void 0)return{x:t.pageX,y:t.pageY}}return{x:0,y:0}},Hw=(t,e)=>{if(t??(t={}),e??(e={}),t===e)return!0;const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(const l of r)if(!(l in e)||t[l]!==e[l])return!1;return!0},GT="ionViewWillEnter",WT="ionViewDidEnter",Zw="ionViewWillLeave",Gw="ionViewDidLeave",N_="ionViewWillUnload",Sm=t=>{t.tabIndex=-1,t.focus()},ly=t=>t.offsetParent!==null,YT=()=>({saveViewFocus:r=>{if(Sn.get("focusManagerPriority",!1)){const f=document.activeElement;f!==null&&r?.contains(f)&&f.setAttribute(Pb,"true")}},setViewFocus:r=>{const l=Sn.get("focusManagerPriority",!1);if(Array.isArray(l)&&!r.contains(document.activeElement)){const f=r.querySelector(`[${Pb}]`);if(f&&ly(f)){Sm(f);return}for(const _ of l)switch(_){case"content":const y=r.querySelector('main, [role="main"]');if(y&&ly(y)){Sm(y);return}break;case"heading":const d=r.querySelector('h1, [role="heading"][aria-level="1"]');if(d&&ly(d)){Sm(d);return}break;case"banner":const A=r.querySelector('header, [role="banner"]');if(A&&ly(A)){Sm(A);return}break;default:Ml(`Unrecognized focus manager priority value ${_}`);break}Sm(r)}}}),Pb="ion-last-focus",XT=()=>Ac(()=>import("./ios.transition-Cjr5de9y.js"),[]),KT=()=>Ac(()=>import("./md.transition-C5Nbspfb.js"),[]),Ww=YT(),Yw=t=>new Promise((e,r)=>{zm(()=>{const l=oE(t);JT(t,l),QT(t).then(f=>{f.animation&&f.animation.destroy(),Ib(t),e(f)},f=>{Ib(t),r(f)}).finally(()=>{Qw(l,!1)})})}),JT=(t,e)=>{const r=t.enteringEl,l=t.leavingEl;Ww.saveViewFocus(l),aE(r,l,t.direction),Qw(e,!0),t.showGoBack?r.classList.add("can-go-back"):r.classList.remove("can-go-back"),Tv(r,!1),r.style.setProperty("pointer-events","none"),l&&(Tv(l,!1),l.style.setProperty("pointer-events","none"))},QT=async t=>{const e=await eE(t);return e&&$2.isBrowser?tE(e,t):iE(t)},Ib=t=>{const e=t.enteringEl,r=t.leavingEl;e.classList.remove("ion-page-invisible"),e.style.removeProperty("pointer-events"),r!==void 0&&(r.classList.remove("ion-page-invisible"),r.style.removeProperty("pointer-events")),Ww.setViewFocus(e)},eE=async t=>!t.leavingEl||!t.animated||t.duration===0?void 0:t.animationBuilder?t.animationBuilder:t.mode==="ios"?(await XT()).iosTransitionAnimation:(await KT()).mdTransitionAnimation,tE=async(t,e)=>{await Xw(e,!0);const r=t(e.baseEl,e);Kw(e.enteringEl,e.leavingEl);const l=await sE(r,e);return e.progressCallback&&e.progressCallback(void 0),l&&Jw(e.enteringEl,e.leavingEl),{hasCompleted:l,animation:r}},iE=async t=>{const e=t.enteringEl,r=t.leavingEl,l=Sn.get("focusManagerPriority",!1);return await Xw(t,l),Kw(e,r),Jw(e,r),{hasCompleted:!0}},Xw=async(t,e)=>{(t.deepWait!==void 0?t.deepWait:e)&&await Promise.all([By(t.enteringEl),By(t.leavingEl)]),await nE(t.viewIsReady,t.enteringEl)},nE=async(t,e)=>{t&&await t(e)},sE=(t,e)=>{const r=e.progressCallback,l=new Promise(f=>{t.onFinish(_=>f(_===1))});return r?(t.progressStart(!0),r(t)):t.play(),l},Kw=(t,e)=>{Zu(e,Zw),Zu(t,GT)},Jw=(t,e)=>{Zu(t,WT),Zu(e,Gw)},Zu=(t,e)=>{if(t){const r=new CustomEvent(e,{bubbles:!1,cancelable:!1});t.dispatchEvent(r)}},rE=()=>new Promise(t=>pu(()=>pu(()=>t()))),By=async t=>{const e=t;if(e){if(e.componentOnReady!=null){if(await e.componentOnReady()!=null)return}else if(e.__registerHost!=null){await new Promise(l=>pu(l));return}await Promise.all(Array.from(e.children).map(By))}},Tv=(t,e)=>{e?(t.setAttribute("aria-hidden","true"),t.classList.add("ion-page-hidden")):(t.hidden=!1,t.removeAttribute("aria-hidden"),t.classList.remove("ion-page-hidden"))},aE=(t,e,r)=>{t!==void 0&&(t.style.zIndex=r==="back"?"99":"101"),e!==void 0&&(e.style.zIndex="100")},Qw=(t,e)=>{if(!t)return;const r="header-transitioning";e?t.classList.add(r):t.classList.remove(r)},PD=t=>{if(t.classList.contains("ion-page"))return t;const e=t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return e||t},oE=t=>{const e=t.enteringEl,r=t.leavingEl,l=t.direction;if(t.mode!=="ios")return null;const _=l==="back"?r:e;return _?_.querySelector("ion-header"):null};const cp=(t,e,r,l,f)=>cE(t[1],e[1],r[1],l[1],f).map(_=>lE(t[0],e[0],r[0],l[0],_)),lE=(t,e,r,l,f)=>{const _=3*e*Math.pow(f-1,2),y=-3*r*f+3*r+l*f,d=t*Math.pow(f-1,3);return f*(_+f*y)-d},cE=(t,e,r,l,f)=>(t-=f,e-=f,r-=f,l-=f,hE(l-3*r+3*e-t,3*r-6*e+3*t,3*e-3*t,t).filter(y=>y>=0&&y<=1)),uE=(t,e,r)=>{const l=e*e-4*t*r;return l<0?[]:[(-e+Math.sqrt(l))/(2*t),(-e-Math.sqrt(l))/(2*t)]},hE=(t,e,r,l)=>{if(t===0)return uE(e,r,l);e/=t,r/=t,l/=t;const f=(3*r-e*e)/3,_=(2*e*e*e-9*e*r+27*l)/27;if(f===0)return[Math.pow(-_,1/3)];if(_===0)return[Math.sqrt(-f),-Math.sqrt(-f)];const y=Math.pow(_/2,2)+Math.pow(f/3,3);if(y===0)return[Math.pow(_/2,1/2)-e/3];if(y>0)return[Math.pow(-(_/2)+Math.sqrt(y),1/3)-Math.pow(_/2+Math.sqrt(y),1/3)-e/3];const d=Math.sqrt(Math.pow(-(f/3),3)),A=Math.acos(-(_/(2*Math.sqrt(Math.pow(-(f/3),3))))),I=2*Math.pow(d,1/3);return[I*Math.cos(A/3)-e/3,I*Math.cos((A+2*Math.PI)/3)-e/3,I*Math.cos((A+4*Math.PI)/3)-e/3]};class dE{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(e){var r;return new fE(this,this.newID(),e.name,(r=e.priority)!==null&&r!==void 0?r:0,!!e.disableScroll)}createBlocker(e={}){return new pE(this,this.newID(),e.disable,!!e.disableScroll)}start(e,r,l){return this.canStart(e)?(this.requestedStart.set(r,l),!0):(this.requestedStart.delete(r),!1)}capture(e,r,l){if(!this.start(e,r,l))return!1;const f=this.requestedStart;let _=-1e4;if(f.forEach(y=>{_=Math.max(_,y)}),_===l){this.capturedId=r,f.clear();const y=new CustomEvent("ionGestureCaptured",{detail:{gestureName:e}});return document.dispatchEvent(y),!0}return f.delete(r),!1}release(e){this.requestedStart.delete(e),this.capturedId===e&&(this.capturedId=void 0)}disableGesture(e,r){let l=this.disabledGestures.get(e);l===void 0&&(l=new Set,this.disabledGestures.set(e,l)),l.add(r)}enableGesture(e,r){const l=this.disabledGestures.get(e);l!==void 0&&l.delete(r)}disableScroll(e){this.disabledScroll.add(e),this.disabledScroll.size===1&&document.body.classList.add($y)}enableScroll(e){this.disabledScroll.delete(e),this.disabledScroll.size===0&&document.body.classList.remove($y)}canStart(e){return!(this.capturedId!==void 0||this.isDisabled(e))}isCaptured(){return this.capturedId!==void 0}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(e){const r=this.disabledGestures.get(e);return!!(r&&r.size>0)}newID(){return this.gestureId++,this.gestureId}}class fE{constructor(e,r,l,f,_){this.id=r,this.name=l,this.disableScroll=_,this.priority=f*1e6+r,this.ctrl=e}canStart(){return this.ctrl?this.ctrl.canStart(this.name):!1}start(){return this.ctrl?this.ctrl.start(this.name,this.id,this.priority):!1}capture(){if(!this.ctrl)return!1;const e=this.ctrl.capture(this.name,this.id,this.priority);return e&&this.disableScroll&&this.ctrl.disableScroll(this.id),e}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class pE{constructor(e,r,l,f){this.id=r,this.disable=l,this.disableScroll=f,this.ctrl=e}block(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.disableGesture(e,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.enableGesture(e,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const $y="backdrop-no-scroll",mE=new dE;const Bd=(t,e,r,l)=>{const f=gE(t)?{capture:!1,passive:!!l.passive}:!1;let _,y;return t.__zone_symbol__addEventListener?(_="__zone_symbol__addEventListener",y="__zone_symbol__removeEventListener"):(_="addEventListener",y="removeEventListener"),t[_](e,r,f),()=>{t[y](e,r,f)}},gE=t=>{if(cy===void 0)try{const e=Object.defineProperty({},"passive",{get:()=>{cy=!0}});t.addEventListener("optsTest",()=>{},e)}catch{cy=!1}return!!cy};let cy;const yE=2e3,_E=(t,e,r,l,f)=>{let _,y,d,A,I,B,N,V=0;const K=Se=>{V=Date.now()+yE,e(Se)&&(!y&&r&&(y=Bd(t,"touchmove",r,f)),d||(d=Bd(Se.target,"touchend",ne,f)),A||(A=Bd(Se.target,"touchcancel",ne,f)))},ie=Se=>{V>Date.now()||e(Se)&&(!B&&r&&(B=Bd(jb(t),"mousemove",r,f)),N||(N=Bd(jb(t),"mouseup",ve,f)))},ne=Se=>{se(),l&&l(Se)},ve=Se=>{ge(),l&&l(Se)},se=()=>{y&&y(),d&&d(),A&&A(),y=d=A=void 0},ge=()=>{B&&B(),N&&N(),B=N=void 0},ae=()=>{se(),ge()},me=(Se=!0)=>{Se?(_||(_=Bd(t,"touchstart",K,f)),I||(I=Bd(t,"mousedown",ie,f))):(_&&_(),I&&I(),_=I=void 0,ae())};return{enable:me,stop:ae,destroy:()=>{me(!1),l=r=e=void 0}}},jb=t=>t instanceof Document?t:t.ownerDocument,vE=(t,e,r)=>{const l=r*(Math.PI/180),f=t==="x",_=Math.cos(l),y=e*e;let d=0,A=0,I=!1,B=0;return{start(N,V){d=N,A=V,B=0,I=!0},detect(N,V){if(!I)return!1;const K=N-d,ie=V-A,ne=K*K+ie*ie;if(ne<y)return!1;const ve=Math.sqrt(ne),se=(f?K:ie)/ve;return se>_?B=1:se<-_?B=-1:B=0,I=!1,!0},isGesture(){return B!==0},getDirection(){return B}}},hx=t=>{let e=!1,r=!1,l=!0,f=!1;const _=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},t),y=_.canStart,d=_.onWillStart,A=_.onStart,I=_.onEnd,B=_.notCaptured,N=_.onMove,V=_.threshold,K=_.passive,ie=_.blurOnStart,ne={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},ve=vE(_.direction,_.threshold,_.maxAngle),se=mE.createGesture({name:t.gestureName,priority:t.gesturePriority,disableScroll:t.disableScroll}),ge=Ke=>{const Mt=t1(Ke);return r||!l||(e1(Ke,ne),ne.startX=ne.currentX,ne.startY=ne.currentY,ne.startTime=ne.currentTime=Mt,ne.velocityX=ne.velocityY=ne.deltaX=ne.deltaY=0,ne.event=Ke,y&&y(ne)===!1)||(se.release(),!se.start())?!1:(r=!0,V===0?ye():(ve.start(ne.startX,ne.startY),!0))},ae=Ke=>{if(e){!f&&l&&(f=!0,B_(ne,Ke),requestAnimationFrame(me));return}B_(ne,Ke),ve.detect(ne.currentX,ne.currentY)&&(!ve.isGesture()||!ye())&&lt()},me=()=>{e&&(f=!1,N&&N(ne))},ye=()=>se.capture()?(e=!0,l=!1,ne.startX=ne.currentX,ne.startY=ne.currentY,ne.startTime=ne.currentTime,d?d(ne).then(ze):ze(),!0):!1,Se=()=>{if(typeof document<"u"){const Ke=document.activeElement;Ke?.blur&&Ke.blur()}},ze=()=>{ie&&Se(),A&&A(ne),l=!0},He=()=>{e=!1,r=!1,f=!1,l=!0,se.release()},Ze=Ke=>{const Mt=e,gt=l;if(He(),!!gt){if(B_(ne,Ke),Mt){I&&I(ne);return}B&&B(ne)}},st=_E(_.el,ge,ae,Ze,{passive:K}),lt=()=>{He(),st.stop(),B&&B(ne)};return{enable(Ke=!0){Ke||(e&&Ze(void 0),He()),st.enable(Ke)},destroy(){se.destroy(),st.destroy()}}},B_=(t,e)=>{if(!e)return;const r=t.currentX,l=t.currentY,f=t.currentTime;e1(e,t);const _=t.currentX,y=t.currentY,A=(t.currentTime=t1(e))-f;if(A>0&&A<100){const I=(_-r)/A,B=(y-l)/A;t.velocityX=I*.7+t.velocityX*.3,t.velocityY=B*.7+t.velocityY*.3}t.deltaX=_-t.startX,t.deltaY=y-t.startY,t.event=e},e1=(t,e)=>{let r=0,l=0;if(t){const f=t.changedTouches;if(f&&f.length>0){const _=f[0];r=_.clientX,l=_.clientY}else t.pageX!==void 0&&(r=t.pageX,l=t.pageY)}e.currentX=r,e.currentY=l},t1=t=>t.timeStamp||Date.now();const xE=t=>i1(t),Vh=(t,e)=>(typeof t=="string"&&(e=t,t=void 0),xE(t).includes(e)),i1=(t=window)=>{if(typeof t>"u")return[];t.Ionic=t.Ionic||{};let e=t.Ionic.platforms;return e==null&&(e=t.Ionic.platforms=bE(t),e.forEach(r=>t.document.documentElement.classList.add(`plt-${r}`))),e},bE=t=>{const e=Sn.get("platform");return Object.keys(Lb).filter(r=>{const l=e?.[r];return typeof l=="function"?l(t):Lb[r](t)})},wE=t=>s_(t)&&!s1(t),dx=t=>!!(Qd(t,/iPad/i)||Qd(t,/Macintosh/i)&&s_(t)),SE=t=>Qd(t,/iPhone/i),TE=t=>Qd(t,/iPhone|iPod/i)||dx(t),n1=t=>Qd(t,/android|sink/i),EE=t=>n1(t)&&!Qd(t,/mobile/i),kE=t=>{const e=t.innerWidth,r=t.innerHeight,l=Math.min(e,r),f=Math.max(e,r);return l>390&&l<520&&f>620&&f<800},CE=t=>{const e=t.innerWidth,r=t.innerHeight,l=Math.min(e,r),f=Math.max(e,r);return dx(t)||EE(t)||l>460&&l<820&&f>780&&f<1400},s_=t=>IE(t,"(any-pointer:coarse)"),AE=t=>!s_(t),s1=t=>r1(t)||a1(t),r1=t=>!!(t.cordova||t.phonegap||t.PhoneGap),a1=t=>{const e=t.Capacitor;return!!(e?.isNative||e?.isNativePlatform&&e.isNativePlatform())},ME=t=>Qd(t,/electron/i),PE=t=>{var e;return!!(!((e=t.matchMedia)===null||e===void 0)&&e.call(t,"(display-mode: standalone)").matches||t.navigator.standalone)},Qd=(t,e)=>e.test(t.navigator.userAgent),IE=(t,e)=>{var r;return(r=t.matchMedia)===null||r===void 0?void 0:r.call(t,e).matches},Lb={ipad:dx,iphone:SE,ios:TE,android:n1,phablet:kE,tablet:CE,cordova:r1,capacitor:a1,electron:ME,pwa:PE,mobile:s_,mobileweb:wE,desktop:AE,hybrid:s1};let Wf;const ks=t=>t&&mT(t)||Wf,jE=(t={})=>{if(typeof window>"u")return;const e=window.document,r=window,l=r.Ionic=r.Ionic||{},f=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},NT(r)),{persistConfig:!1}),l.config),$T(r)),t);Sn.reset(f),Sn.getBoolean("persistConfig")&&BT(r,f),i1(r),l.config=Sn,l.mode=Wf=Sn.get("mode",e.documentElement.getAttribute("mode")||(Vh(r,"ios")?"ios":"md")),Sn.set("mode",Wf),e.documentElement.setAttribute("mode",Wf),e.documentElement.classList.add(Wf),Sn.getBoolean("_testing")&&Sn.set("animated",!1);const _=d=>{var A;return(A=d.tagName)===null||A===void 0?void 0:A.startsWith("ION-")},y=d=>["ios","md"].includes(d);pT(d=>{for(;d;){const A=d.mode||d.getAttribute("mode");if(A){if(y(A))return A;_(d)&&Ml('Invalid ionic mode: "'+A+'", expected: "ios" or "md"')}d=d.parentElement}return Wf})};const LE=t=>{try{if(t instanceof OE)return t.value;if(!zE()||typeof t!="string"||t==="")return t;if(t.includes("onload="))return"";const e=document.createDocumentFragment(),r=document.createElement("div");e.appendChild(r),r.innerHTML=t,DE.forEach(y=>{const d=e.querySelectorAll(y);for(let A=d.length-1;A>=0;A--){const I=d[A];I.parentNode?I.parentNode.removeChild(I):e.removeChild(I);const B=kv(I);for(let N=0;N<B.length;N++)Ev(B[N])}});const l=kv(e);for(let y=0;y<l.length;y++)Ev(l[y]);const f=document.createElement("div");f.appendChild(e);const _=f.querySelector("div");return _!==null?_.innerHTML:f.innerHTML}catch(e){return Ku("sanitizeDOMString",e),""}},Ev=t=>{if(t.nodeType&&t.nodeType!==1)return;if(typeof NamedNodeMap<"u"&&!(t.attributes instanceof NamedNodeMap)){t.remove();return}for(let r=t.attributes.length-1;r>=0;r--){const l=t.attributes.item(r),f=l.name;if(!RE.includes(f.toLowerCase())){t.removeAttribute(f);continue}const _=l.value,y=t[f];(_!=null&&_.toLowerCase().includes("javascript:")||y!=null&&y.toLowerCase().includes("javascript:"))&&t.removeAttribute(f)}const e=kv(t);for(let r=0;r<e.length;r++)Ev(e[r])},kv=t=>t.children!=null?t.children:t.childNodes,zE=()=>{var t;const e=window,r=(t=e?.Ionic)===null||t===void 0?void 0:t.config;return r?r.get?r.get("sanitizerEnabled",!0):r.sanitizerEnabled===!0||r.sanitizerEnabled===void 0:!0},RE=["class","id","href","src","name","slot"],DE=["script","style","iframe","meta","link","object","embed"];class OE{constructor(e){this.value=e}}const NE=!1;const Cv=(t,e)=>e.closest(t)!==null,Km=(t,e)=>typeof t=="string"&&t.length>0?Object.assign({"ion-color":!0,[`ion-color-${t}`]:!0},e):e,BE=t=>t!==void 0?(Array.isArray(t)?t:t.split(" ")).filter(r=>r!=null).map(r=>r.trim()).filter(r=>r!==""):[],o1=t=>{const e={};return BE(t).forEach(r=>e[r]=!0),e},$E=/^[a-z][a-z0-9+\-.]*:/,UE=async(t,e,r,l)=>{if(t!=null&&t[0]!=="#"&&!$E.test(t)){const f=document.querySelector("ion-router");if(f)return e?.preventDefault(),f.push(t,r,l)}return!1};const Nm=()=>Sn.get("experimentalCloseWatcher",!1)&&Bs!==void 0&&"CloseWatcher"in Bs,FE=()=>{document.addEventListener("backbutton",()=>{})},VE=()=>{const t=document;let e=!1;const r=()=>{if(e)return;let l=0,f=[];const _=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(A,I){f.push({priority:A,handler:I,id:l++})}}});t.dispatchEvent(_);const y=async A=>{try{if(A?.handler){const I=A.handler(d);I!=null&&await I}}catch(I){Ku("[ion-app] - Exception in startHardwareBackButton:",I)}},d=()=>{if(f.length>0){let A={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};f.forEach(I=>{I.priority>=A.priority&&(A=I)}),e=!0,f=f.filter(I=>I.id!==A.id),y(A).then(()=>e=!1)}};d()};if(Nm()){let l;const f=()=>{l?.destroy(),l=new Bs.CloseWatcher,l.onclose=()=>{r(),f()}};f()}else t.addEventListener("backbutton",r)},l1=100,qE=99,HE=Object.freeze(Object.defineProperty({__proto__:null,MENU_BACK_BUTTON_PRIORITY:qE,OVERLAY_BACK_BUTTON_PRIORITY:l1,blockHardwareBackButton:FE,shouldUseCloseWatcher:Nm,startHardwareBackButton:VE},Symbol.toStringTag,{value:"Module"}));const r_=async(t,e,r,l,f,_)=>{var y;if(t)return t.attachViewToDom(e,r,f,l);if(!_&&typeof r!="string"&&!(r instanceof HTMLElement))throw new Error("framework delegate is missing");const d=typeof r=="string"?(y=e.ownerDocument)===null||y===void 0?void 0:y.createElement(r):r;return l&&l.forEach(A=>d.classList.add(A)),f&&Object.assign(d,f),e.appendChild(d),await new Promise(A=>Jd(d,A)),d},c1=(t,e)=>{if(e){if(t){const r=e.parentElement;return t.removeViewFromDom(r,e)}e.remove()}return Promise.resolve()},u1=()=>{let t,e;return{attachViewToDom:async(f,_,y={},d=[])=>{var A,I;t=f;let B;if(_){const V=typeof _=="string"?(A=t.ownerDocument)===null||A===void 0?void 0:A.createElement(_):_;d.forEach(K=>V.classList.add(K)),Object.assign(V,y),t.appendChild(V),B=V,await new Promise(K=>Jd(V,K))}else if(t.children.length>0&&(t.tagName==="ION-MODAL"||t.tagName==="ION-POPOVER")&&!(B=t.children[0]).classList.contains("ion-delegate-host")){const K=(I=t.ownerDocument)===null||I===void 0?void 0:I.createElement("div");K.classList.add("ion-delegate-host"),d.forEach(ie=>K.classList.add(ie)),K.append(...t.children),t.appendChild(K),B=K}const N=document.querySelector("ion-app")||document.body;return e=document.createComment("ionic teleport"),t.parentNode.insertBefore(e,t),N.appendChild(t),B??t},removeViewFromDom:()=>(t&&e&&(e.parentNode.insertBefore(t,e),e.remove()),Promise.resolve())}};const Jm='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-checkbox:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-radio:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',zb=(t,e)=>{const r=t.querySelector(Jm);h1(r,e??t)},Rb=(t,e)=>{const r=Array.from(t.querySelectorAll(Jm)),l=r.length>0?r[r.length-1]:null;h1(l,e??t)},h1=(t,e)=>{let r=t;const l=t?.shadowRoot;if(l&&(r=l.querySelector(Jm)||t),r){const f=r.closest("ion-radio-group");f?f.setFocus():qw(r)}else e.focus()};let Av=0,ZE=0;const Uy=new WeakMap,Mv=t=>{var e;return t.showBackdrop!==!1&&!(((e=t.backdropBreakpoint)!==null&&e!==void 0?e:0)>0)},GE=t=>({create(e){return YE(t,e)},dismiss(e,r,l){return QE(document,e,r,t,l)},async getTop(){return Bm(document,t)}}),WE=GE("ion-toast"),d1=t=>{typeof document<"u"&&JE(document);const e=Av++;t.overlayIndex=e},f1=t=>(t.hasAttribute("id")||(t.id=`ion-overlay-${++ZE}`),t.id),YE=(t,e)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(t).then(()=>{const r=document.createElement(t);return r.classList.add("overlay-hidden"),Object.assign(r,Object.assign(Object.assign({},e),{hasController:!0})),fx(document).appendChild(r),new Promise(l=>Jd(r,l))}):Promise.resolve(),XE=t=>t.classList.contains("overlay-hidden"),Db=(t,e)=>{let r=t;const l=t?.shadowRoot;l&&(r=l.querySelector(Jm)||t),r?qw(r):e.focus()},KE=(t,e)=>{const r=Bm(e,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover"),l=t.target;if(!r||!l||r.classList.contains(qy))return;const f=()=>{if(r===l)r.lastFocus=void 0;else if(l.tagName==="ION-TOAST")Db(r.lastFocus,r);else{const y=Ar(r);if(!y.contains(l))return;const d=y.querySelector(".ion-overlay-wrapper");if(!d)return;if(d.contains(l)||l===y.querySelector("ion-backdrop"))r.lastFocus=l;else{const A=r.lastFocus;zb(d,r),A===e.activeElement&&Rb(d,r),r.lastFocus=e.activeElement}}},_=()=>{if(r.contains(l))r.lastFocus=l;else if(l.tagName==="ION-TOAST")Db(r.lastFocus,r);else{const y=r.lastFocus;zb(r),y===e.activeElement&&Rb(r),r.lastFocus=e.activeElement}};r.shadowRoot?_():f()},JE=t=>{Av===0&&(Av=1,t.addEventListener("focus",e=>{KE(e,t)},!0),t.addEventListener("ionBackButton",e=>{const r=Bm(t);r?.backdropDismiss&&e.detail.register(l1,()=>{r.dismiss(void 0,Vy)})}),Nm()||t.addEventListener("keydown",e=>{if(e.key==="Escape"){const r=Bm(t);r?.backdropDismiss&&r.dismiss(void 0,Vy)}}))},QE=(t,e,r,l,f)=>{const _=Bm(t,l,f);return _?_.dismiss(e,r):Promise.reject("overlay does not exist")},ek=(t,e)=>(e===void 0&&(e="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover,ion-toast"),Array.from(t.querySelectorAll(e)).filter(r=>r.overlayIndex>0)),p1=(t,e)=>ek(t,e).filter(r=>!XE(r)),Bm=(t,e,r)=>{const l=p1(t,e);return(r===void 0?l:l.filter(f=>f.id===r)).slice(-1)[0]},m1=(t=!1)=>{const r=fx(document).querySelector("ion-router-outlet, #ion-view-container-root");r&&(t?r.setAttribute("aria-hidden","true"):r.removeAttribute("aria-hidden"))},g1=async(t,e,r,l,f)=>{var _,y;if(t.presented)return;t.el.tagName!=="ION-TOAST"&&tk(t.el);const d=t.el,I=d.tagName!=="ION-TOAST"&&d.focusTrap!==!1&&Mv(d);if(t.presented=!0,t.willPresent.emit(),I){const ie=fx(document).querySelector("ion-router-outlet, #ion-view-container-root");ie&&ie.contains(d)||m1(!0),document.body.classList.add($y)}(_=t.willPresentShorthand)===null||_===void 0||_.emit();const B=ks(t),N=t.enterAnimation?t.enterAnimation:Sn.get(e,B==="ios"?r:l);await _1(t,N,t.el,f)&&(t.didPresent.emit(),(y=t.didPresentShorthand)===null||y===void 0||y.emit()),t.keyboardClose&&(document.activeElement===null||!t.el.contains(document.activeElement))&&t.el.focus(),t.el.removeAttribute("aria-hidden"),t.el.removeAttribute("inert")},tk=async t=>{let e=document.activeElement;if(!e)return;e.blur();const r=e?.shadowRoot;r&&(e=r.querySelector(Jm)||e),await t.onDidDismiss(),(document.activeElement===null||document.activeElement===document.body)&&e.focus()},y1=async(t,e,r,l,f,_,y)=>{var d,A;if(!t.presented)return!1;const B=(Mm!==void 0?p1(Mm):[]).filter(ie=>{const ne=ie;return ne.tagName!=="ION-TOAST"&&ne.focusTrap!==!1&&Mv(ne)}),N=t.el;N.tagName!=="ION-TOAST"&&N.focusTrap!==!1&&Mv(N)&&B.length===1&&B[0].id===N.id&&(m1(!1),document.body.classList.remove($y)),t.presented=!1;try{t.el.style.setProperty("pointer-events","none"),t.willDismiss.emit({data:e,role:r}),(d=t.willDismissShorthand)===null||d===void 0||d.emit({data:e,role:r});const ie=ks(t),ne=t.leaveAnimation?t.leaveAnimation:Sn.get(l,ie==="ios"?f:_);r!==sp&&await _1(t,ne,t.el,y),t.didDismiss.emit({data:e,role:r}),(A=t.didDismissShorthand)===null||A===void 0||A.emit({data:e,role:r}),(Uy.get(t)||[]).forEach(se=>se.destroy()),Uy.delete(t),t.el.classList.add("overlay-hidden"),t.el.style.removeProperty("pointer-events"),t.el.lastFocus!==void 0&&(t.el.lastFocus=void 0)}catch(ie){Ku(`[${t.el.tagName.toLowerCase()}] - `,ie)}return t.el.remove(),!0},fx=t=>t.querySelector("ion-app")||t.body,_1=async(t,e,r,l)=>{r.classList.remove("overlay-hidden");const f=t.el,_=e(f,l);(!t.animated||!Sn.getBoolean("animated",!0))&&_.duration(0),t.keyboardClose&&_.beforeAddWrite(()=>{const d=r.ownerDocument.activeElement;d?.matches("input,ion-input, ion-textarea")&&d.blur()});const y=Uy.get(t)||[];return Uy.set(t,[...y,_]),await _.play(),!0},Fy=(t,e)=>{let r;const l=new Promise(f=>r=f);return ik(t,e,f=>{r(f.detail)}),l},ik=(t,e,r)=>{const l=f=>{ZT(t,e,l),r(f)};HT(t,e,l)},Pv=t=>t==="cancel"||t===Vy,nk=t=>t(),sk=(t,e)=>{if(typeof t=="function")return Sn.get("_zoneGate",nk)(()=>{try{return t(e)}catch(l){throw l}})},Vy="backdrop",sp="gesture",v1=39,rk=t=>{let e=!1,r;const l=u1(),f=(d=!1)=>{if(r&&!d)return{delegate:r,inline:e};const{el:A,hasController:I,delegate:B}=t;return e=A.parentNode!==null&&!I,r=e?B||l:B,{inline:e,delegate:r}};return{attachViewToDom:async d=>{const{delegate:A}=f(!0);if(A)return await A.attachViewToDom(t.el,d);const{hasController:I}=t;if(I&&d!==void 0)throw new Error("framework delegate is missing");return null},removeViewFromDom:()=>{const{delegate:d}=f();d&&t.el!==void 0&&d.removeViewFromDom(t.el.parentElement,t.el)}}},x1=()=>{let t;const e=()=>{t&&(t(),t=void 0)};return{addClickListener:(l,f)=>{e();const _=f!==void 0?document.getElementById(f):null;if(!_){Ml(`[${l.tagName.toLowerCase()}] - A trigger element with the ID "${f}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,l);return}t=((d,A)=>{const I=()=>{A.present()};return d.addEventListener("click",I),()=>{d.removeEventListener("click",I)}})(_,l)},removeClickListener:e}},qy="ion-disable-focus-trap";var b1=Tw();const ak=Kh(b1);const ok="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M244 400 100 256l144-144M120 256h292' stroke-linecap='square' stroke-miterlimit='10' stroke-width='48px' class='ionicon-fill-none'/></svg>",lk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M328 112 184 256l144 144' stroke-linecap='round' stroke-linejoin='round' stroke-width='48px' class='ionicon-fill-none'/></svg>";let $_;const ck=()=>{if(typeof window>"u")return new Map;if(!$_){const t=window;t.Ionicons=t.Ionicons||{},$_=t.Ionicons.map=t.Ionicons.map||new Map}return $_},uk=t=>{let e=U_(t.src);return e||(e=w1(t.name,t.icon,t.mode,t.ios,t.md),e?hk(e,t):t.icon&&(e=U_(t.icon),e||(e=U_(t.icon[t.mode]),e))?e:null)},hk=(t,e)=>{const r=ck().get(t);if(r)return r;try{return Y2(`svg/${t}.svg`)}catch(l){console.log("e",l),console.warn(`[Ionicons Warning]: Could not load icon with name "${t}". Ensure that the icon is registered using addIcons or that the icon SVG data is passed directly to the icon component.`,e)}},w1=(t,e,r,l,f)=>(r=(r&&uy(r))==="ios"?"ios":"md",l&&r==="ios"?t=uy(l):f&&r==="md"?t=uy(f):(!t&&e&&!S1(e)&&(t=e),Hy(t)&&(t=uy(t))),!Hy(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),U_=t=>Hy(t)&&(t=t.trim(),S1(t))?t:null,S1=t=>t.length>0&&/(\/|\.)/.test(t),Hy=t=>typeof t=="string",uy=t=>t.toLowerCase(),dk=(t,e=[])=>{const r={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(r[l]=t.getAttribute(l)),t.removeAttribute(l))}),r},fk=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl",pk=t=>{const e=document.createElement("div");e.innerHTML=t;for(let l=e.childNodes.length-1;l>=0;l--)e.childNodes[l].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[l]);const r=e.firstElementChild;if(r&&r.nodeName.toLowerCase()==="svg"){const l=r.getAttribute("class")||"";if(r.setAttribute("class",(l+" s-ion-icon").trim()),T1(r))return e.innerHTML}return""},T1=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const r=t.attributes[e].name;if(Hy(r)&&r.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!T1(t.childNodes[e]))return!1}return!0},mk=t=>t.startsWith("data:image/svg+xml"),gk=t=>t.indexOf(";utf8,")!==-1,rp=new Map,E1=new Map;let F_;function Iv(t){return rp.set(t,""),""}const yk=(t,e)=>{const r=E1.get(t);return r||(typeof fetch<"u"&&typeof document<"u"?mk(t)&&gk(t)?Promise.resolve(_k(t)):vk(t,e):Promise.resolve(Iv(t)))};function _k(t){F_||(F_=new DOMParser);const r=F_.parseFromString(t,"text/html").querySelector("svg");if(r)return rp.set(t,r.outerHTML),r.outerHTML;throw new Error(`Could not parse svg from ${t}`)}function vk(t,e){const r=fetch(t).then(l=>l.text().then(f=>{f&&e!==!1&&(f=pk(f));const _=f||"";return rp.set(t,_),_}).catch(()=>Iv(t))).catch(()=>Iv(t));return E1.set(t,r),r}const xk=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:1.125rem !important}:host(.icon-large){font-size:2rem !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",bk=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.didLoadIcon=!1,this.isVisible=!1,this.mode=wk(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=dk(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}componentDidLoad(){this.didLoadIcon||this.loadIcon()}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,r,l){if(!!!(this.lazy&&typeof window<"u"&&window.IntersectionObserver))return l();const _=this.io=new window.IntersectionObserver(y=>{y[0].isIntersecting&&(_.disconnect(),this.io=void 0,l())},{rootMargin:r});_.observe(e)}loadIcon(){if(this.isVisible){const e=uk(this);e&&(rp.has(e)?this.svgContent=rp.get(e):yk(e,this.sanitize).then(()=>this.svgContent=rp.get(e)),this.didLoadIcon=!0)}this.iconName=w1(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:r,inheritedAttributes:l,el:f}=this,_=this.mode||"md",y=r?(r.includes("arrow")||r.includes("chevron"))&&e!==!1:!1,d=e||y;return Ei(Go,Object.assign({key:"0578c899781ca145dd8205acd9670af39b57cf2e",role:"img",class:Object.assign(Object.assign({[_]:!0},Sk(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":d,"icon-rtl":d&&fk(f)})},l),this.svgContent?Ei("div",{class:"icon-inner",innerHTML:this.svgContent}):Ei("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return xk}},[257,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},void 0,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]),wk=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",Sk=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function k1(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{e==="ion-icon"&&(customElements.get(e)||customElements.define(e,bk))})}const Tk=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",Ek=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",kk=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionBackdropTap=Hn(this,"ionBackdropTap",7),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}onMouseDown(e){this.emitTap(e)}emitTap(e){this.stopPropagation&&(e.preventDefault(),e.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const e=ks(this);return Ei(Go,{key:"7abaf2c310aa399607451b14063265e8a5846938","aria-hidden":"true",class:{[e]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:Tk,md:Ek}}},[289,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]);function Ck(){if(typeof customElements>"u")return;["ion-backdrop"].forEach(e=>{e==="ion-backdrop"&&(customElements.get(e)||customElements.define(e,kk))})}const Ak=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}",Mk=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(e,r){return new Promise(l=>{Ty(()=>{const f=this.el.getBoundingClientRect(),_=f.width,y=f.height,d=Math.sqrt(_*_+y*y),A=Math.max(y,_),I=this.unbounded?A:d+Ik,B=Math.floor(A*jk),N=I/B;let V=e-f.left,K=r-f.top;this.unbounded&&(V=_*.5,K=y*.5);const ie=V-B*.5,ne=K-B*.5,ve=_*.5-V,se=y*.5-K;zm(()=>{const ge=document.createElement("div");ge.classList.add("ripple-effect");const ae=ge.style;ae.top=ne+"px",ae.left=ie+"px",ae.width=ae.height=B+"px",ae.setProperty("--final-scale",`${N}`),ae.setProperty("--translate-end",`${ve}px, ${se}px`),(this.el.shadowRoot||this.el).appendChild(ge),setTimeout(()=>{l(()=>{Pk(ge)})},325)})})})}get unbounded(){return this.type==="unbounded"}render(){const e=ks(this);return Ei(Go,{key:"ae9d3b1ed6773a9b9bb2267129f7e9af23b6c9fc",role:"presentation",class:{[e]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return Ak}},[257,"ion-ripple-effect",{type:[1],addRipple:[64]}]),Pk=t=>{t.classList.add("fade-out"),setTimeout(()=>{t.remove()},200)},Ik=10,jk=.5;function px(){if(typeof customElements>"u")return;["ion-ripple-effect"].forEach(e=>{e==="ion-ripple-effect"&&(customElements.get(e)||customElements.define(e,Mk))})}const hy=typeof window<"u"?window:void 0;hy&&(hy.CSS&&hy.CSS.supports&&hy.CSS.supports("--a: 0"));const Lk=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl";const zk=':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-ms-touch-action:pan-x pan-y pinch-zoom;touch-action:pan-x pan-y pinch-zoom}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;z-index:0;will-change:scroll-position}.scroll-y{overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{overflow-x:var(--overflow);overscroll-behavior-x:contain}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:0;contain:none}:host(.content-sizing) .inner-scroll{position:relative;top:0;bottom:0;margin-top:calc(var(--offset-top) * -1);margin-bottom:calc(var(--offset-bottom) * -1)}.transition-effect{display:none;position:absolute;width:100%;height:100vh;opacity:0;pointer-events:none}:host(.content-ltr) .transition-effect{left:-100%;}:host(.content-rtl) .transition-effect{right:-100%;}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;width:100%;height:100%;-webkit-box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03);box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03)}:host(.content-ltr) .transition-shadow{right:0;}:host(.content-rtl) .transition-shadow{left:0;-webkit-transform:scaleX(-1);transform:scaleX(-1)}::slotted([slot=fixed]){position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}',Rk=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionScrollStart=Hn(this,"ionScrollStart",7),this.ionScroll=Hn(this,"ionScroll",7),this.ionScrollEnd=Hn(this,"ionScrollEnd",7),this.watchDog=null,this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.isMainContent=!0,this.resizeTimeout=null,this.inheritedAttributes={},this.tabsElement=null,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.fullscreen=!1,this.fixedSlotPlacement="after",this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1}componentWillLoad(){this.inheritedAttributes=Vw(this.el)}connectedCallback(){if(this.isMainContent=this.el.closest("ion-menu, ion-popover, ion-modal")===null,Oy(this.el)){const e=this.tabsElement=this.el.closest("ion-tabs");e!==null&&(this.tabsLoadCallback=()=>this.resize(),e.addEventListener("ionTabBarLoaded",this.tabsLoadCallback))}}disconnectedCallback(){if(this.onScrollEnd(),Oy(this.el)){const{tabsElement:e,tabsLoadCallback:r}=this;e!==null&&r!==void 0&&e.removeEventListener("ionTabBarLoaded",r),this.tabsElement=null,this.tabsLoadCallback=void 0}}onResize(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeTimeout=setTimeout(()=>{this.el.offsetParent!==null&&this.resize()},100)}shouldForceOverscroll(){const{forceOverscroll:e}=this,r=ks(this);return e===void 0?r==="ios"&&Vh("ios"):e}resize(){this.fullscreen?Ty(()=>this.readDimensions()):(this.cTop!==0||this.cBottom!==0)&&(this.cTop=this.cBottom=0,kb(this))}async recalculateDimensions(){Ty(()=>this.readDimensions())}readDimensions(){const e=Ok(this.el),r=Math.max(this.el.offsetTop,0),l=Math.max(e.offsetHeight-r-this.el.offsetHeight,0);(r!==this.cTop||l!==this.cBottom)&&(this.cTop=r,this.cBottom=l,kb(this))}onScroll(e){const r=Date.now(),l=!this.isScrolling;this.lastScroll=r,l&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,Ty(f=>{this.queued=!1,this.detail.event=e,Nk(this.detail,this.scrollEl,f,l),this.ionScroll.emit(this.detail)}))}async getScrollElement(){return this.scrollEl||await new Promise(e=>Jd(this.el,e)),Promise.resolve(this.scrollEl)}async getBackgroundElement(){return this.backgroundContentEl||await new Promise(e=>Jd(this.el,e)),Promise.resolve(this.backgroundContentEl)}scrollToTop(e=0){return this.scrollToPoint(void 0,0,e)}async scrollToBottom(e=0){const r=await this.getScrollElement(),l=r.scrollHeight-r.clientHeight;return this.scrollToPoint(void 0,l,e)}async scrollByPoint(e,r,l){const f=await this.getScrollElement();return this.scrollToPoint(e+f.scrollLeft,r+f.scrollTop,l)}async scrollToPoint(e,r,l=0){const f=await this.getScrollElement();if(l<32){r!=null&&(f.scrollTop=r),e!=null&&(f.scrollLeft=e);return}let _,y=0;const d=new Promise(K=>_=K),A=f.scrollTop,I=f.scrollLeft,B=r!=null?r-A:0,N=e!=null?e-I:0,V=K=>{const ie=Math.min(1,(K-y)/l)-1,ne=Math.pow(ie,3)+1;B!==0&&(f.scrollTop=Math.floor(ne*B+A)),N!==0&&(f.scrollLeft=Math.floor(ne*N+I)),ne<1?requestAnimationFrame(V):_()};return requestAnimationFrame(K=>{y=K,V(K)}),d}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval(()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()},100)}onScrollEnd(){this.watchDog&&clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{fixedSlotPlacement:e,inheritedAttributes:r,isMainContent:l,scrollX:f,scrollY:_,el:y}=this,d=Lk(y)?"rtl":"ltr",A=ks(this),I=this.shouldForceOverscroll(),B=A==="ios";return this.resize(),Ei(Go,Object.assign({key:"cd8781f848d8dc926fe66f43d43c49564425a507",role:l?"main":void 0,class:Km(this.color,{[A]:!0,"content-sizing":Cv("ion-popover",this.el),overscroll:I,[`content-${d}`]:!0}),style:{"--offset-top":`${this.cTop}px`,"--offset-bottom":`${this.cBottom}px`}},r),Ei("div",{key:"95b112d7cae30f22ef778ceffb88edb4d941c170",ref:N=>this.backgroundContentEl=N,id:"background-content",part:"background"}),e==="before"?Ei("slot",{name:"fixed"}):null,Ei("div",{key:"2fdfcbc39fb66f11b6191911f2941c660f4c12e5",class:{"inner-scroll":!0,"scroll-x":f,"scroll-y":_,overscroll:(f||_)&&I},ref:N=>this.scrollEl=N,onScroll:this.scrollEvents?N=>this.onScroll(N):void 0,part:"scroll"},Ei("slot",{key:"6bc77e0054ec8e21635a7f2abfe0ca46e0962e03"})),B?Ei("div",{class:"transition-effect"},Ei("div",{class:"transition-cover"}),Ei("div",{class:"transition-shadow"})):null,e==="after"?Ei("slot",{name:"fixed"}):null)}get el(){return this}static get style(){return zk}},[257,"ion-content",{color:[513],fullscreen:[4],fixedSlotPlacement:[1,"fixed-slot-placement"],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"],recalculateDimensions:[64],getScrollElement:[64],getBackgroundElement:[64],scrollToTop:[64],scrollToBottom:[64],scrollByPoint:[64],scrollToPoint:[64]},[[9,"resize","onResize"]]]),Dk=t=>{var e;return t.parentElement?t.parentElement:!((e=t.parentNode)===null||e===void 0)&&e.host?t.parentNode.host:null},Ok=t=>{const e=t.closest("ion-tabs");if(e)return e;const r=t.closest("ion-app, ion-page, .ion-page, page-inner, .popover-content");return r||Dk(t)},Nk=(t,e,r,l)=>{const f=t.currentX,_=t.currentY,y=t.currentTime,d=e.scrollLeft,A=e.scrollTop,I=r-y;if(l&&(t.startTime=r,t.startX=d,t.startY=A,t.velocityX=t.velocityY=0),t.currentTime=r,t.currentX=t.scrollLeft=d,t.currentY=t.scrollTop=A,t.deltaX=d-t.startX,t.deltaY=A-t.startY,I>0&&I<100){const B=(d-f)/I,N=(A-_)/I;t.velocityX=B*.7+t.velocityX*.3,t.velocityY=N*.7+t.velocityY*.3}};function Bk(){if(typeof customElements>"u")return;["ion-content"].forEach(e=>{e==="ion-content"&&(customElements.get(e)||customElements.define(e,Rk))})}const $k=Bk;const C1=()=>{if(Bs!==void 0)return Bs.Capacitor};const mx=()=>{let t;return{lock:async()=>{const r=t;let l;return t=new Promise(f=>l=f),r!==void 0&&await r,l}}};const Uk="ION-CONTENT",A1="ion-content",M1=".ion-content-scroll-host",P1=`${A1}, ${M1}`,mu=t=>t.tagName===Uk,RD=async t=>mu(t)?(await new Promise(e=>Jd(t,e)),t.getScrollElement()):t,Fk=t=>{const e=t.querySelector(M1);return e||t.querySelector(P1)},jv=t=>t.closest(P1),DD=(t,e)=>mu(t)?t.scrollToTop(e):Promise.resolve(t.scrollTo({top:0,left:0,behavior:"smooth"})),OD=(t,e,r,l)=>mu(t)?t.scrollByPoint(e,r,l):Promise.resolve(t.scrollBy({top:r,left:e,behavior:l>0?"smooth":"auto"})),Vk=t=>FT(t,A1),Ob=t=>{if(mu(t)){const e=t,r=e.scrollY;return e.scrollY=!1,r}else return t.style.setProperty("overflow","hidden"),!0},qk=(t,e)=>{mu(t)?t.scrollY=e:t.style.removeProperty("overflow")};var Lv;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Lv||(Lv={}));var zv;(function(t){t.Body="body",t.Ionic="ionic",t.Native="native",t.None="none"})(zv||(zv={}));const I1={getEngine(){const t=C1();if(t?.isPluginAvailable("Keyboard"))return t.Plugins.Keyboard},getResizeMode(){const t=this.getEngine();return t?.getResizeMode?t.getResizeMode().catch(e=>{if(e.code!==Lv.Unimplemented)throw e}):Promise.resolve(void 0)}};const j1=t=>{if(Mm===void 0||t===zv.None||t===void 0)return null;const e=Mm.querySelector("ion-app");return e??Mm.body},Nb=t=>{const e=j1(t);return e===null?0:e.clientHeight},Hk=async t=>{let e,r,l,f;const _=async()=>{const B=await I1.getResizeMode(),N=B===void 0?void 0:B.mode;e=()=>{f===void 0&&(f=Nb(N)),l=!0,y(l,N)},r=()=>{l=!1,y(l,N)},Bs?.addEventListener("keyboardWillShow",e),Bs?.addEventListener("keyboardWillHide",r)},y=(B,N)=>{t&&t(B,d(N))},d=B=>{if(f===0||f===Nb(B))return;const N=j1(B);if(N!==null)return new Promise(V=>{const K=()=>{N.clientHeight===f&&(ie.disconnect(),V())},ie=new ResizeObserver(K);ie.observe(N)})},A=()=>{Bs?.removeEventListener("keyboardWillShow",e),Bs?.removeEventListener("keyboardWillHide",r),e=r=void 0},I=()=>l;return await _(),{init:_,destroy:A,isKeyboardVisible:I}};const Zk={bubbles:{dur:1e3,circles:9,fn:(t,e,r)=>{const l=`${t*e/r-t}ms`,f=2*Math.PI*e/r;return{r:5,style:{top:`${32*Math.sin(f)}%`,left:`${32*Math.cos(f)}%`,"animation-delay":l}}}},circles:{dur:1e3,circles:8,fn:(t,e,r)=>{const l=e/r,f=`${t*l-t}ms`,_=2*Math.PI*l;return{r:5,style:{top:`${32*Math.sin(_)}%`,left:`${32*Math.cos(_)}%`,"animation-delay":f}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(t,e)=>{const r=-(110*e)+"ms";return{r:6,style:{left:`${32-32*e}%`,"animation-delay":r}}}},lines:{dur:1e3,lines:8,fn:(t,e,r)=>{const l=`rotate(${360/r*e+(e<r/2?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:14,y2:26,style:{transform:l,"animation-delay":f}}}},"lines-small":{dur:1e3,lines:8,fn:(t,e,r)=>{const l=`rotate(${360/r*e+(e<r/2?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:12,y2:20,style:{transform:l,"animation-delay":f}}}},"lines-sharp":{dur:1e3,lines:12,fn:(t,e,r)=>{const l=`rotate(${30*e+(e<6?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:17,y2:29,style:{transform:l,"animation-delay":f}}}},"lines-sharp-small":{dur:1e3,lines:12,fn:(t,e,r)=>{const l=`rotate(${30*e+(e<6?180:-180)}deg)`,f=`${t*e/r-t}ms`;return{y1:12,y2:20,style:{transform:l,"animation-delay":f}}}}},Bb=Zk,Gk=":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{-webkit-transform-origin:center;transform-origin:center;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}[dir=rtl] svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}@supports selector(:dir(rtl)){svg:dir(rtl){-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:7px}:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-width:4px}:host(.spinner-lines) line,:host(.spinner-lines-small) line,:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg,:host(.spinner-lines-sharp) svg,:host(.spinner-lines-sharp-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular) svg{-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}",Wk=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.paused=!1}getName(){const e=this.name||Sn.get("spinner"),r=ks(this);return e||(r==="ios"?"lines":"circular")}render(){var e;const r=this,l=ks(r),f=r.getName(),_=(e=Bb[f])!==null&&e!==void 0?e:Bb.lines,y=typeof r.duration=="number"&&r.duration>10?r.duration:_.dur,d=[];if(_.circles!==void 0)for(let A=0;A<_.circles;A++)d.push(Yk(_,y,A,_.circles));else if(_.lines!==void 0)for(let A=0;A<_.lines;A++)d.push(Xk(_,y,A,_.lines));return Ei(Go,{key:"a33d6421fcc885995fbc7a348516525f68ca496c",class:Km(r.color,{[l]:!0,[`spinner-${f}`]:!0,"spinner-paused":r.paused||Sn.getBoolean("_testing")}),role:"progressbar",style:_.elmDuration?{animationDuration:y+"ms"}:{}},d)}static get style(){return Gk}},[257,"ion-spinner",{color:[513],duration:[2],name:[1],paused:[4]}]),Yk=(t,e,r,l)=>{const f=t.fn(e,r,l);return f.style["animation-duration"]=e+"ms",Ei("svg",{viewBox:f.viewBox||"0 0 64 64",style:f.style},Ei("circle",{transform:f.transform||"translate(32,32)",cx:f.cx,cy:f.cy,r:f.r,style:t.elmDuration?{animationDuration:e+"ms"}:{}}))},Xk=(t,e,r,l)=>{const f=t.fn(e,r,l);return f.style["animation-duration"]=e+"ms",Ei("svg",{viewBox:f.viewBox||"0 0 64 64",style:f.style},Ei("line",{transform:"translate(32,32)",y1:f.y1,y2:f.y2}))};function Kk(){if(typeof customElements>"u")return;["ion-spinner"].forEach(e=>{e==="ion-spinner"&&(customElements.get(e)||customElements.define(e,Wk))})}const L1=1,z1=2,Zy=3;class Rv{constructor(e,r){this.component=e,this.params=r,this.state=L1}async init(e){if(this.state=z1,!this.element){const r=this.component;this.element=await r_(this.delegate,e,r,["ion-page","ion-page-invisible"],this.params)}}_destroy(){Vo(this.state!==Zy,"view state must be ATTACHED");const e=this.element;e&&(this.delegate?this.delegate.removeViewFromDom(e.parentElement,e):e.remove()),this.nav=void 0,this.state=Zy}}const $b=(t,e,r)=>!t||t.component!==e?!1:Hw(t.params,r),Ub=(t,e)=>t?t instanceof Rv?t:new Rv(t,e):null,Jk=t=>t.map(e=>e instanceof Rv?e:"component"in e?Ub(e.component,e.componentProps===null?void 0:e.componentProps):Ub(e,void 0)).filter(e=>e!==null),Qk=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",eC=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Hn(this,"ionNavWillLoad",7),this.ionNavWillChange=Hn(this,"ionNavWillChange",3),this.ionNavDidChange=Hn(this,"ionNavDidChange",3),this.transInstr=[],this.gestureOrAnimationInProgress=!1,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.animated=!0}swipeGestureChanged(){this.gesture&&this.gesture.enable(this.swipeGesture===!0)}rootChanged(){this.root!==void 0&&this.didLoad!==!1&&(this.useRouter||this.root!==void 0&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=document.querySelector("ion-router")!==null&&this.el.closest("[no-router]")===null,this.swipeGesture===void 0){const e=ks(this);this.swipeGesture=Sn.getBoolean("swipeBackEnabled",e==="ios")}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await Ac(async()=>{const{createSwipeBackGesture:e}=await import("./swipe-back-BJCUSLFW.js");return{createSwipeBackGesture:e}},[])).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const e of this.views)Zu(e.element,N_),e._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(e,r,l,f){return this.insert(-1,e,r,l,f)}insert(e,r,l,f,_){return this.insertPages(e,[{component:r,componentProps:l}],f,_)}insertPages(e,r,l,f){return this.queueTrns({insertStart:e,insertViews:r,opts:l},f)}pop(e,r){return this.removeIndex(-1,1,e,r)}popTo(e,r,l){const f={removeStart:-1,removeCount:-1,opts:r};return typeof e=="object"&&e.component?(f.removeView=e,f.removeStart=1):typeof e=="number"&&(f.removeStart=e+1),this.queueTrns(f,l)}popToRoot(e,r){return this.removeIndex(1,-1,e,r)}removeIndex(e,r=1,l,f){return this.queueTrns({removeStart:e,removeCount:r,opts:l},f)}setRoot(e,r,l,f){return this.setPages([{component:e,componentProps:r}],l,f)}setPages(e,r,l){return r??(r={}),r.animated!==!0&&(r.animated=!1),this.queueTrns({insertStart:0,insertViews:e,removeStart:0,removeCount:-1,opts:r},l)}setRouteId(e,r,l,f){const _=this.getActiveSync();if($b(_,e,r))return Promise.resolve({changed:!1,element:_.element});let y;const d=new Promise(B=>y=B);let A;const I={updateURL:!1,viewIsReady:B=>{let N;const V=new Promise(K=>N=K);return y({changed:!0,element:B,markVisible:async()=>{N(),await A}}),V}};if(l==="root")A=this.setRoot(e,r,I);else{const B=this.views.find(N=>$b(N,e,r));B?A=this.popTo(B,Object.assign(Object.assign({},I),{direction:"back",animationBuilder:f})):l==="forward"?A=this.push(e,r,Object.assign(Object.assign({},I),{animationBuilder:f})):l==="back"&&(A=this.setRoot(e,r,Object.assign(Object.assign({},I),{direction:"back",animated:!0,animationBuilder:f})))}return d}async getRouteId(){const e=this.getActiveSync();if(e)return{id:e.element.tagName,params:e.params,element:e.element}}async getActive(){return this.getActiveSync()}async getByIndex(e){return this.views[e]}async canGoBack(e){return this.canGoBackSync(e)}async getPrevious(e){return this.getPreviousSync(e)}async getLength(){return Promise.resolve(this.views.length)}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(e=this.getActiveSync()){return!!(e&&this.getPreviousSync(e))}getPreviousSync(e=this.getActiveSync()){if(!e)return;const r=this.views,l=r.indexOf(e);return l>0?r[l-1]:void 0}async queueTrns(e,r){var l,f;if(this.isTransitioning&&(!((l=e.opts)===null||l===void 0)&&l.skipIfBusy))return!1;const _=new Promise((y,d)=>{e.resolve=y,e.reject=d});if(e.done=r,e.opts&&e.opts.updateURL!==!1&&this.useRouter){const y=document.querySelector("ion-router");if(y){const d=await y.canTransition();if(d===!1)return!1;if(typeof d=="string")return y.push(d,e.opts.direction||"back"),!1}}return((f=e.insertViews)===null||f===void 0?void 0:f.length)===0&&(e.insertViews=void 0),this.transInstr.push(e),this.nextTrns(),_}success(e,r){if(this.destroyed){this.fireError("nav controller was destroyed",r);return}if(r.done&&r.done(e.hasCompleted,e.requiresTransition,e.enteringView,e.leavingView,e.direction),r.resolve(e.hasCompleted),r.opts.updateURL!==!1&&this.useRouter){const l=document.querySelector("ion-router");if(l){const f=e.direction==="back"?"back":"forward";l.navChanged(f)}}}failed(e,r){if(this.destroyed){this.fireError("nav controller was destroyed",r);return}this.transInstr.length=0,this.fireError(e,r)}fireError(e,r){r.done&&r.done(!1,!1,e),r.reject&&!this.destroyed?r.reject(e):r.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const e=this.transInstr.shift();return e?(this.runTransition(e),!0):!1}async runTransition(e){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(e);const r=this.getActiveSync(),l=this.getEnteringView(e,r);if(!r&&!l)throw new Error("no views in the stack to be removed");l&&l.state===L1&&await l.init(this.el),this.postViewInit(l,r,e);const f=(e.enteringRequiresTransition||e.leavingRequiresTransition)&&l!==r;f&&e.opts&&r&&(e.opts.direction==="back"&&(e.opts.animationBuilder=e.opts.animationBuilder||l?.animationBuilder),r.animationBuilder=e.opts.animationBuilder);let _;f?_=await this.transition(l,r,e):_={hasCompleted:!0,requiresTransition:!1},this.success(_,e),this.ionNavDidChange.emit()}catch(r){this.failed(r,e)}this.isTransitioning=!1,this.nextTrns()}prepareTI(e){var r,l,f;const _=this.views.length;if((r=e.opts)!==null&&r!==void 0||(e.opts={}),(l=(f=e.opts).delegate)!==null&&l!==void 0||(f.delegate=this.delegate),e.removeView!==void 0){Vo(e.removeStart!==void 0,"removeView needs removeStart"),Vo(e.removeCount!==void 0,"removeView needs removeCount");const A=this.views.indexOf(e.removeView);if(A<0)throw new Error("removeView was not found");e.removeStart+=A}e.removeStart!==void 0&&(e.removeStart<0&&(e.removeStart=_-1),e.removeCount<0&&(e.removeCount=_-e.removeStart),e.leavingRequiresTransition=e.removeCount>0&&e.removeStart+e.removeCount===_),e.insertViews&&((e.insertStart<0||e.insertStart>_)&&(e.insertStart=_),e.enteringRequiresTransition=e.insertStart===_);const y=e.insertViews;if(!y)return;Vo(y.length>0,"length can not be zero");const d=Jk(y);if(d.length===0)throw new Error("invalid views to insert");for(const A of d){A.delegate=e.opts.delegate;const I=A.nav;if(I&&I!==this)throw new Error("inserted view was already inserted");if(A.state===Zy)throw new Error("inserted view was already destroyed")}e.insertViews=d}getEnteringView(e,r){const l=e.insertViews;if(l!==void 0)return l[l.length-1];const f=e.removeStart;if(f!==void 0){const _=this.views,y=f+e.removeCount;for(let d=_.length-1;d>=0;d--){const A=_[d];if((d<f||d>=y)&&A!==r)return A}}}postViewInit(e,r,l){var f,_,y;Vo(r||e,"Both leavingView and enteringView are null"),Vo(l.resolve,"resolve must be valid"),Vo(l.reject,"reject must be valid");const d=l.opts,{insertViews:A,removeStart:I,removeCount:B}=l;let N;if(I!==void 0&&B!==void 0){Vo(I>=0,"removeStart can not be negative"),Vo(B>=0,"removeCount can not be negative"),N=[];for(let K=I;K<I+B;K++){const ie=this.views[K];ie!==void 0&&ie!==e&&ie!==r&&N.push(ie)}(f=d.direction)!==null&&f!==void 0||(d.direction="back")}const V=this.views.length+((_=A?.length)!==null&&_!==void 0?_:0)-(B??0);if(Vo(V>=0,"final balance can not be negative"),V===0)throw Ml("[ion-nav] - You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(A){let K=l.insertStart;for(const ie of A)this.insertViewAt(ie,K),K++;l.enteringRequiresTransition&&((y=d.direction)!==null&&y!==void 0||(d.direction="forward"))}if(N&&N.length>0){for(const K of N)Zu(K.element,Zw),Zu(K.element,Gw),Zu(K.element,N_);for(const K of N)this.destroyView(K)}}async transition(e,r,l){const f=l.opts,_=f.progressAnimation?N=>{N!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,N.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0}),N.progressEnd(0,0,0)):this.sbAni=N}:void 0,y=ks(this),d=e.element,A=r&&r.element,I=Object.assign(Object.assign({mode:y,showGoBack:this.canGoBackSync(e),baseEl:this.el,progressCallback:_,animated:this.animated&&Sn.getBoolean("animated",!0),enteringEl:d,leavingEl:A},f),{animationBuilder:f.animationBuilder||this.animation||Sn.get("navAnimation")}),{hasCompleted:B}=await Yw(I);return this.transitionFinish(B,e,r,f)}transitionFinish(e,r,l,f){const _=e?r:l;return _&&this.unmountInactiveViews(_),{hasCompleted:e,requiresTransition:!0,enteringView:r,leavingView:l,direction:f.direction}}insertViewAt(e,r){const l=this.views,f=l.indexOf(e);f>-1?(Vo(e.nav===this,"view is not part of the nav"),l.splice(f,1),l.splice(r,0,e)):(Vo(!e.nav,"nav is used"),e.nav=this,l.splice(r,0,e))}removeView(e){Vo(e.state===z1||e.state===Zy,"view state should be loaded or destroyed");const r=this.views,l=r.indexOf(e);Vo(l>-1,"view must be part of the stack"),l>=0&&r.splice(l,1)}destroyView(e){e._destroy(),this.removeView(e)}unmountInactiveViews(e){if(this.destroyed)return;const r=this.views,l=r.indexOf(e);for(let f=r.length-1;f>=0;f--){const _=r[f],y=_.element;y&&(f>l?(Zu(y,N_),this.destroyView(_)):f<l&&Tv(y,!0))}}canStart(){return!this.gestureOrAnimationInProgress&&!!this.swipeGesture&&!this.isTransitioning&&this.transInstr.length===0&&this.canGoBackSync()}onStart(){this.gestureOrAnimationInProgress=!0,this.pop({direction:"back",progressAnimation:!0})}onMove(e){this.sbAni&&this.sbAni.progressStep(e)}onEnd(e,r,l){if(this.sbAni){this.sbAni.onFinish(()=>{this.gestureOrAnimationInProgress=!1},{oneTimeCallback:!0});let f=e?-.001:.001;e?f+=cp([0,0],[.32,.72],[0,1],[1,1],r)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),f+=cp([0,0],[1,0],[.68,.28],[1,1],r)[0]),this.sbAni.progressEnd(e?1:0,f,l)}else this.gestureOrAnimationInProgress=!1}render(){return Ei("slot",{key:"8067c9835d255daec61f33dba200fd3a6ff839a0"})}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return Qk}},[257,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64],getLength:[64]},void 0,{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}]);function tC(){if(typeof customElements>"u")return;["ion-nav"].forEach(e=>{e==="ion-nav"&&(customElements.get(e)||customElements.define(e,eC))})}const iC=tC;const Gy="ionKeyboardDidShow",R1="ionKeyboardDidHide",nC=150;let Wy={},Gu={},dp=!1;const sC=()=>{Wy={},Gu={},dp=!1},rC=t=>{if(I1.getEngine())aC(t);else{if(!t.visualViewport)return;Gu=vx(t.visualViewport),t.visualViewport.onresize=()=>{N1(t),D1()||O1(t)?gx(t):_x(t)&&yx(t)}}},aC=t=>{t.addEventListener("keyboardDidShow",e=>gx(t,e)),t.addEventListener("keyboardDidHide",()=>yx(t))},gx=(t,e)=>{oC(t,e),dp=!0},yx=t=>{lC(t),dp=!1},D1=()=>{const t=(Wy.height-Gu.height)*Gu.scale;return!dp&&Wy.width===Gu.width&&t>nC},O1=t=>dp&&!_x(t),_x=t=>dp&&Gu.height===t.innerHeight,oC=(t,e)=>{const r=e?e.keyboardHeight:t.innerHeight-Gu.height,l=new CustomEvent(Gy,{detail:{keyboardHeight:r}});t.dispatchEvent(l)},lC=t=>{const e=new CustomEvent(R1);t.dispatchEvent(e)},N1=t=>{Wy=Object.assign({},Gu),Gu=vx(t.visualViewport)},vx=t=>({width:Math.round(t.width),height:Math.round(t.height),offsetTop:t.offsetTop,offsetLeft:t.offsetLeft,pageTop:t.pageTop,pageLeft:t.pageLeft,scale:t.scale}),cC=Object.freeze(Object.defineProperty({__proto__:null,KEYBOARD_DID_CLOSE:R1,KEYBOARD_DID_OPEN:Gy,copyVisualViewport:vx,keyboardDidClose:_x,keyboardDidOpen:D1,keyboardDidResize:O1,resetKeyboardAssist:sC,setKeyboardClose:yx,setKeyboardOpen:gx,startKeyboardAssist:rC,trackViewportChanges:N1},Symbol.toStringTag,{value:"Module"}));var up;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(up||(up={}));const xx={getEngine(){const t=C1();if(t?.isPluginAvailable("StatusBar"))return t.Plugins.StatusBar},setStyle(t){const e=this.getEngine();e&&e.setStyle(t)},getStyle:async function(){const t=this.getEngine();if(!t)return up.Default;const{style:e}=await t.getInfo();return e}},Dv=(t,e)=>{if(e===1)return 0;const r=1/(1-e),l=-(e*r);return t*r+l},B1=()=>{!Bs||Bs.innerWidth>=768||xx.setStyle({style:up.Dark})},Ov=(t=up.Default)=>{!Bs||Bs.innerWidth>=768||xx.setStyle({style:t})},$1=async(t,e)=>{typeof t.canDismiss!="function"||!await t.canDismiss(void 0,sp)||(e.isRunning()?e.onFinish(()=>{t.dismiss(void 0,"handler")},{oneTimeCallback:!0}):t.dismiss(void 0,"handler"))},Nv=t=>.00255275*2.71828**(-14.9619*t)-1.00255*2.71828**(-.0380968*t)+1,Yu={MIN_PRESENTING_SCALE:.915},uC=(t,e,r,l)=>{const _=t.offsetHeight;let y=!1,d=!1,A=null,I=null;const B=.2;let N=!0,V=0;const K=()=>A&&mu(A)?A.scrollY:!0,ge=hx({el:t,gestureName:"modalSwipeToClose",gesturePriority:v1,direction:"y",threshold:10,canStart:ae=>{const me=ae.event.target;return me===null||!me.closest?!0:(A=jv(me),A?(mu(A)?I=Ar(A).querySelector(".inner-scroll"):I=A,!!!A.querySelector("ion-refresher")&&I.scrollTop===0):me.closest("ion-footer")===null)},onStart:ae=>{const{deltaY:me}=ae;N=K(),d=t.canDismiss!==void 0&&t.canDismiss!==!0,me>0&&A&&Ob(A),e.progressStart(!0,y?1:0)},onMove:ae=>{const{deltaY:me}=ae;me>0&&A&&Ob(A);const ye=ae.deltaY/_,Se=ye>=0&&d,ze=Se?B:.9999,He=Se?Nv(ye/ze):ye,Ze=Ny(1e-4,He,ze);e.progressStep(Ze),Ze>=.5&&V<.5?Ov(r):Ze<.5&&V>=.5&&B1(),V=Ze},onEnd:ae=>{const me=ae.velocityY,ye=ae.deltaY/_,Se=ye>=0&&d,ze=Se?B:.9999,He=Se?Nv(ye/ze):ye,Ze=Ny(1e-4,He,ze),st=(ae.deltaY+me*1e3)/_,lt=!Se&&st>=.5;let Ke=lt?-.001:.001;lt?(e.easing("cubic-bezier(0.32, 0.72, 0, 1)"),Ke+=cp([0,0],[.32,.72],[0,1],[1,1],Ze)[0]):(e.easing("cubic-bezier(1, 0, 0.68, 0.28)"),Ke+=cp([0,0],[1,0],[.68,.28],[1,1],Ze)[0]);const Mt=Fb(lt?ye*_:(1-Ze)*_,me);y=lt,ge.enable(!1),A&&qk(A,N),e.onFinish(()=>{lt||ge.enable(!0)}).progressEnd(lt?1:0,Ke,Mt),Se&&Ze>ze/4?$1(t,e):lt&&l()}});return ge},Fb=(t,e)=>Ny(400,t/Math.abs(e*1.1),500),U1=t=>{const{currentBreakpoint:e,backdropBreakpoint:r,expandToScroll:l}=t,f=r===void 0||r<e,_=f?`calc(var(--backdrop-opacity) * ${e})`:"0",y=_n("backdropAnimation").fromTo("opacity",0,_);f&&y.beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]);const d=_n("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:`translateY(${100-e*100}%)`}]),A=l?void 0:_n("contentAnimation").keyframes([{offset:0,opacity:1,maxHeight:`${(1-e)*100}%`},{offset:1,opacity:1,maxHeight:`${e*100}%`}]);return{wrapperAnimation:d,backdropAnimation:y,contentAnimation:A}},F1=t=>{const{currentBreakpoint:e,backdropBreakpoint:r}=t,l=`calc(var(--backdrop-opacity) * ${Dv(e,r)})`,f=[{offset:0,opacity:l},{offset:1,opacity:0}],_=[{offset:0,opacity:l},{offset:r,opacity:0},{offset:1,opacity:0}],y=_n("backdropAnimation").keyframes(r!==0?_:f);return{wrapperAnimation:_n("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:`translateY(${100-e*100}%)`},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:y}},hC=()=>{const t=_n().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=_n().fromTo("transform","translateY(100vh)","translateY(0vh)");return{backdropAnimation:t,wrapperAnimation:e,contentAnimation:void 0}},Vb=(t,e)=>{const{presentingEl:r,currentBreakpoint:l,expandToScroll:f}=e,_=Ar(t),{wrapperAnimation:y,backdropAnimation:d,contentAnimation:A}=l!==void 0?U1(e):hC();d.addElement(_.querySelector("ion-backdrop")),y.addElement(_.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1}),!f&&A?.addElement(t.querySelector(".ion-page"));const I=_n("entering-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation([y]);if(A&&I.addAnimation(A),r){const B=window.innerWidth<768,N=r.tagName==="ION-MODAL"&&r.presentingElement!==void 0,V=Ar(r),K=_n().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),ie=document.body;if(B){const ne=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",ve=N?"-10px":ne,se=Yu.MIN_PRESENTING_SCALE,ge=`translateY(${ve}) scale(${se})`;K.afterStyles({transform:ge}).beforeAddWrite(()=>ie.style.setProperty("background-color","black")).addElement(r).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:ge,borderRadius:"10px 10px 0 0"}]),I.addAnimation(K)}else if(I.addAnimation(d),!N)y.fromTo("opacity","0","1");else{const ve=`translateY(-10px) scale(${N?Yu.MIN_PRESENTING_SCALE:1})`;K.afterStyles({transform:ve}).addElement(V.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:ve}]);const se=_n().afterStyles({transform:ve}).addElement(V.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:ve}]);I.addAnimation([K,se])}}else I.addAnimation(d);return I},dC=()=>{const t=_n().fromTo("opacity","var(--backdrop-opacity)",0),e=_n().fromTo("transform","translateY(0vh)","translateY(100vh)");return{backdropAnimation:t,wrapperAnimation:e}},qb=(t,e,r=500)=>{const{presentingEl:l,currentBreakpoint:f}=e,_=Ar(t),{wrapperAnimation:y,backdropAnimation:d}=f!==void 0?F1(e):dC();d.addElement(_.querySelector("ion-backdrop")),y.addElement(_.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const A=_n("leaving-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(r).addAnimation(y);if(l){const I=window.innerWidth<768,B=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,N=Ar(l),V=_n().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish(ie=>{if(ie!==1)return;l.style.setProperty("overflow",""),Array.from(K.querySelectorAll("ion-modal:not(.overlay-hidden)")).filter(ve=>ve.presentingElement!==void 0).length<=1&&K.style.setProperty("background-color","")}),K=document.body;if(I){const ie=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",ne=B?"-10px":ie,ve=Yu.MIN_PRESENTING_SCALE,se=`translateY(${ne}) scale(${ve})`;V.addElement(l).keyframes([{offset:0,filter:"contrast(0.85)",transform:se,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),A.addAnimation(V)}else if(A.addAnimation(d),!B)y.fromTo("opacity","1","0");else{const ne=`translateY(-10px) scale(${B?Yu.MIN_PRESENTING_SCALE:1})`;V.addElement(N.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:ne},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const ve=_n().addElement(N.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:ne},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);A.addAnimation([V,ve])}}else A.addAnimation(d);return A},fC=(t,e,r=300)=>{const{presentingEl:l}=e;if(!l)return _n("portrait-to-landscape-transition");const f=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,_=Ar(l),y=document.body,d=_n("portrait-to-landscape-transition").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(r),A=_n().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"});if(f){const B=`translateY(-10px) scale(${Yu.MIN_PRESENTING_SCALE})`,N="translateY(0px) scale(1)";A.addElement(l).afterStyles({transform:N}).fromTo("transform",B,N).fromTo("filter","contrast(0.85)","contrast(1)");const V=_n().addElement(_.querySelector(".modal-shadow")).afterStyles({transform:N,opacity:"0"}).fromTo("transform",B,N);d.addAnimation([A,V])}else{const I=Ar(t),B=_n().addElement(I.querySelectorAll(".modal-wrapper, .modal-shadow")).fromTo("opacity","1","1"),N=_n().addElement(I.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)","var(--backdrop-opacity)"),V=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",K=Yu.MIN_PRESENTING_SCALE,ie=`translateY(${V}) scale(${K})`;A.addElement(l).afterStyles({transform:"translateY(0px) scale(1)","border-radius":"0px"}).beforeAddWrite(()=>y.style.setProperty("background-color","")).fromTo("transform",ie,"translateY(0px) scale(1)").fromTo("filter","contrast(0.85)","contrast(1)").fromTo("border-radius","10px 10px 0 0","0px"),d.addAnimation([A,B,N])}return d},pC=(t,e,r=300)=>{const{presentingEl:l}=e;if(!l)return _n("landscape-to-portrait-transition");const f=l.tagName==="ION-MODAL"&&l.presentingElement!==void 0,_=Ar(l),y=document.body,d=_n("landscape-to-portrait-transition").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(r),A=_n().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"});if(f){const B=`translateY(-10px) scale(${Yu.MIN_PRESENTING_SCALE})`,N="translateY(0) scale(1)";A.addElement(l).afterStyles({transform:N}).fromTo("transform",B,N);const V=_n().addElement(_.querySelector(".modal-shadow")).afterStyles({transform:N,opacity:"0"}).fromTo("transform",B,N);d.addAnimation([A,V])}else{const I=Ar(t),B=_n().addElement(I.querySelectorAll(".modal-wrapper, .modal-shadow")).fromTo("opacity","1","1"),N=_n().addElement(I.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)","var(--backdrop-opacity)"),V=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",K=Yu.MIN_PRESENTING_SCALE,ie=`translateY(${V}) scale(${K})`;A.addElement(l).afterStyles({transform:ie}).beforeAddWrite(()=>y.style.setProperty("background-color","black")).keyframes([{offset:0,transform:"translateY(0px) scale(1)",filter:"contrast(1)",borderRadius:"0px"},{offset:.2,transform:"translateY(0px) scale(1)",filter:"contrast(1)",borderRadius:"10px 10px 0 0"},{offset:1,transform:ie,filter:"contrast(0.85)",borderRadius:"10px 10px 0 0"}]),d.addAnimation([A,B,N])}return d},mC=()=>{const t=_n().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=_n().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}]);return{backdropAnimation:t,wrapperAnimation:e,contentAnimation:void 0}},gC=(t,e)=>{const{currentBreakpoint:r,expandToScroll:l}=e,f=Ar(t),{wrapperAnimation:_,backdropAnimation:y,contentAnimation:d}=r!==void 0?U1(e):mC();y.addElement(f.querySelector("ion-backdrop")),_.addElement(f.querySelector(".modal-wrapper")),!l&&d?.addElement(t.querySelector(".ion-page"));const A=_n().addElement(t).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([y,_]);return d&&A.addAnimation(d),A},yC=()=>{const t=_n().fromTo("opacity","var(--backdrop-opacity)",0),e=_n().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}]);return{backdropAnimation:t,wrapperAnimation:e}},_C=(t,e)=>{const{currentBreakpoint:r}=e,l=Ar(t),{wrapperAnimation:f,backdropAnimation:_}=r!==void 0?F1(e):yC();return _.addElement(l.querySelector("ion-backdrop")),f.addElement(l.querySelector(".modal-wrapper")),_n().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([_,f])},vC=(t,e,r,l,f,_,y=[],d,A,I,B)=>{const N=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}],V=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-f,opacity:0},{offset:1,opacity:0}],K={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:f!==0?V:N,CONTENT_KEYFRAMES:[{offset:0,maxHeight:"100%"},{offset:1,maxHeight:"0%"}]},ie=t.querySelector("ion-content"),ne=r.clientHeight;let ve=l,se=0,ge=!1,ae=null,me=null,ye=null,Se=null;const ze=.95,He=y[y.length-1],Ze=y[0],st=_.childAnimations.find(Ie=>Ie.id==="wrapperAnimation"),lt=_.childAnimations.find(Ie=>Ie.id==="backdropAnimation"),Ke=_.childAnimations.find(Ie=>Ie.id==="contentAnimation"),Mt=()=>{const Ie=t;Ie.focusTrap===!1||Ie.showBackdrop===!1||(t.style.setProperty("pointer-events","auto"),e.style.setProperty("pointer-events","auto"),t.classList.remove(qy))},gt=()=>{t.style.setProperty("pointer-events","none"),e.style.setProperty("pointer-events","none"),t.classList.add(qy)},St=Ie=>{if(!me&&(me=Array.from(t.querySelectorAll("ion-footer")),!me.length))return;const et=t.querySelector(".ion-page");if(Se=Ie,Ie==="stationary")me.forEach(at=>{at.classList.remove("modal-footer-moving"),at.style.removeProperty("position"),at.style.removeProperty("width"),at.style.removeProperty("height"),at.style.removeProperty("top"),at.style.removeProperty("left"),et?.style.removeProperty("padding-bottom"),et?.appendChild(at)});else{let at=0;me.forEach((mt,Ct)=>{const Ot=mt.getBoundingClientRect(),Kt=document.body.getBoundingClientRect();at+=mt.clientHeight;const _i=Ot.top-Kt.top,Vi=Ot.left-Kt.left;if(mt.style.setProperty("--pinned-width",`${mt.clientWidth}px`),mt.style.setProperty("--pinned-height",`${mt.clientHeight}px`),mt.style.setProperty("--pinned-top",`${_i}px`),mt.style.setProperty("--pinned-left",`${Vi}px`),Ct===0){ye=_i;const gi=t.querySelector("ion-header");gi&&(ye-=gi.clientHeight)}}),me.forEach(mt=>{et?.style.setProperty("padding-bottom",`${at}px`),mt.classList.add("modal-footer-moving"),mt.style.setProperty("position","absolute"),mt.style.setProperty("width","var(--pinned-width)"),mt.style.setProperty("height","var(--pinned-height)"),mt.style.setProperty("top","var(--pinned-top)"),mt.style.setProperty("left","var(--pinned-left)"),document.body.appendChild(mt)})}};st&&lt&&(st.keyframes([...K.WRAPPER_KEYFRAMES]),lt.keyframes([...K.BACKDROP_KEYFRAMES]),Ke?.keyframes([...K.CONTENT_KEYFRAMES]),_.progressStart(!0,1-ve),ve>f&&t.focusTrap!==!1&&t.showBackdrop!==!1?Mt():gt()),ie&&ve!==He&&d&&(ie.scrollY=!1);const Be=Ie=>{const et=jv(Ie.event.target);if(ve=A(),!d&&et)return(mu(et)?Ar(et).querySelector(".inner-scroll"):et).scrollTop===0;if(ve===1&&et){const at=mu(et)?Ar(et).querySelector(".inner-scroll"):et;return!!!et.querySelector("ion-refresher")&&at.scrollTop===0}return!0},ot=Ie=>{if(ge=t.canDismiss!==void 0&&t.canDismiss!==!0&&Ze===0,!d){const et=jv(Ie.event.target);ae=et&&mu(et)?Ar(et).querySelector(".inner-scroll"):et}d||St("moving"),Ie.deltaY>0&&ie&&(ie.scrollY=!1),pu(()=>{t.focus()}),_.progressStart(!0,1-ve)},Fe=Ie=>{if(!d&&ye!==null&&Se!==null&&(Ie.currentY>=ye&&Se==="moving"?St("stationary"):Ie.currentY<ye&&Se==="stationary"&&St("moving")),!d&&Ie.deltaY<=0&&ae)return;Ie.deltaY>0&&ie&&(ie.scrollY=!1);const et=1-ve,at=y.length>1?1-y[1]:void 0,mt=et+Ie.deltaY/ne,Ct=at!==void 0&&mt>=at&&ge,Ot=Ct?ze:.9999,Kt=Ct&&at!==void 0?at+Nv((mt-at)/(Ot-at)):mt;se=Ny(1e-4,Kt,Ot),_.progressStep(se)},kt=Ie=>{if(!d&&Ie.deltaY<=0&&ae&&ae.scrollTop>0){St("stationary");return}const et=Ie.velocityY,at=(Ie.deltaY+et*350)/ne,mt=ve-at,Ct=y.reduce((Ot,Kt)=>Math.abs(Kt-mt)<Math.abs(Ot-mt)?Kt:Ot);rt({breakpoint:Ct,breakpointOffset:se,canDismiss:ge,animated:!0})},rt=Ie=>{const{breakpoint:et,canDismiss:at,breakpointOffset:mt,animated:Ct}=Ie,Ot=at&&et===0,Kt=Ot?ve:et,_i=Kt!==0;return ve=0,st&&lt&&(st.keyframes([{offset:0,transform:`translateY(${mt*100}%)`},{offset:1,transform:`translateY(${(1-Kt)*100}%)`}]),lt.keyframes([{offset:0,opacity:`calc(var(--backdrop-opacity) * ${Dv(1-mt,f)})`},{offset:1,opacity:`calc(var(--backdrop-opacity) * ${Dv(Kt,f)})`}]),Ke&&Ke.keyframes([{offset:0,maxHeight:`${(1-mt)*100}%`},{offset:1,maxHeight:`${Kt*100}%`}]),_.progressStep(0)),be.enable(!1),Ot?$1(t,_):_i||I(),ie&&(Kt===y[y.length-1]||!d)&&(ie.scrollY=!0),!d&&Kt===0&&St("stationary"),new Promise(Vi=>{_.onFinish(()=>{_i?(d||St("stationary"),st&&lt?pu(()=>{st.keyframes([...K.WRAPPER_KEYFRAMES]),lt.keyframes([...K.BACKDROP_KEYFRAMES]),Ke?.keyframes([...K.CONTENT_KEYFRAMES]),_.progressStart(!0,1-Kt),ve=Kt,B(ve),ve>f&&t.focusTrap!==!1&&t.showBackdrop!==!1?Mt():gt(),be.enable(!0),Vi()}):(be.enable(!0),Vi())):Vi()},{oneTimeCallback:!0}).progressEnd(1,0,Ct?500:0)})},be=hx({el:r,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:Be,onStart:ot,onMove:Fe,onEnd:kt});return{gesture:be,moveSheetToBreakpoint:rt}},xC=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, var(--ion-background-color-step-350, #c0c0be));cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host(.modal-sheet.modal-no-expand-scroll) ion-footer{position:absolute;bottom:0;width:var(--width)}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-start-start-radius:var(--border-radius);border-start-end-radius:var(--border-radius);border-end-end-radius:0;border-end-start-radius:0}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-start-start-radius:var(--border-radius);border-start-end-radius:var(--border-radius);border-end-end-radius:0;border-end-start-radius:0}',bC=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, var(--ion-background-color-step-350, #c0c0be));cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host(.modal-sheet.modal-no-expand-scroll) ion-footer{position:absolute;bottom:0;width:var(--width)}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}',wC=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.didPresent=Hn(this,"ionModalDidPresent",7),this.willPresent=Hn(this,"ionModalWillPresent",7),this.willDismiss=Hn(this,"ionModalWillDismiss",7),this.didDismiss=Hn(this,"ionModalDidDismiss",7),this.ionBreakpointDidChange=Hn(this,"ionBreakpointDidChange",7),this.didPresentShorthand=Hn(this,"didPresent",7),this.willPresentShorthand=Hn(this,"willPresent",7),this.willDismissShorthand=Hn(this,"willDismiss",7),this.didDismissShorthand=Hn(this,"didDismiss",7),this.ionMount=Hn(this,"ionMount",7),this.lockController=mx(),this.triggerController=x1(),this.coreDelegate=u1(),this.isSheetModal=!1,this.inheritedAttributes={},this.inline=!1,this.gestureAnimationDismissing=!1,this.presented=!1,this.hasController=!1,this.keyboardClose=!0,this.expandToScroll=!0,this.backdropBreakpoint=0,this.handleBehavior="none",this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.isOpen=!1,this.keepContentsMounted=!1,this.focusTrap=!0,this.canDismiss=!0,this.onHandleClick=()=>{const{sheetTransition:r,handleBehavior:l}=this;l!=="cycle"||r!==void 0||this.moveToNextBreakpoint()},this.onBackdropTap=()=>{const{sheetTransition:r}=this;r===void 0&&this.dismiss(void 0,Vy)},this.onLifecycle=r=>{const l=this.usersElement,f=SC[r.type];if(l&&f){const _=new CustomEvent(f,{bubbles:!1,cancelable:!1,detail:r.detail});l.dispatchEvent(_)}},this.onModalFocus=r=>{const{dragHandleEl:l,el:f}=this;r.target===f&&l&&l.tabIndex!==-1&&l.focus()},this.onSlotChange=({target:r})=>{r.assignedElements().forEach(f=>{f.querySelectorAll("ion-modal").forEach(_=>{_.getAttribute("data-parent-ion-modal")===null&&_.setAttribute("data-parent-ion-modal",this.el.id)})})}}onIsOpenChange(e,r){e===!0&&r===!1?this.present():e===!1&&r===!0&&this.dismiss()}triggerChanged(){const{trigger:e,el:r,triggerController:l}=this;e&&l.addClickListener(r,e)}onWindowResize(){ks(this)!=="ios"||!this.presentingElement||this.enterAnimation||this.leaveAnimation||(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.handleViewTransition()},50))}breakpointsChanged(e){e!==void 0&&(this.sortedBreakpoints=e.sort((r,l)=>r-l))}connectedCallback(){const{el:e}=this;d1(e),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener(),this.cleanupViewTransitionListener(),this.cleanupParentRemovalObserver()}componentWillLoad(){var e;const{breakpoints:r,initialBreakpoint:l,el:f,htmlAttributes:_}=this,y=this.isSheetModal=r!==void 0&&l!==void 0,d=["aria-label","role"];this.inheritedAttributes=ux(f,d),f.parentNode&&(this.cachedOriginalParent=f.parentNode),_!==void 0&&d.forEach(A=>{_[A]&&(this.inheritedAttributes=Object.assign(Object.assign({},this.inheritedAttributes),{[A]:_[A]}),delete _[A])}),y&&(this.currentBreakpoint=this.initialBreakpoint),r!==void 0&&l!==void 0&&!r.includes(l)&&Ml("[ion-modal] - Your breakpoints array must include the initialBreakpoint value."),!((e=this.htmlAttributes)===null||e===void 0)&&e.id||f1(this.el)}componentDidLoad(){this.isOpen===!0&&pu(()=>this.present()),this.breakpointsChanged(this.breakpoints),this.triggerChanged()}getDelegate(e=!1){if(this.workingDelegate&&!e)return{delegate:this.workingDelegate,inline:this.inline};const r=this.el.parentNode,l=this.inline=r!==null&&!this.hasController,f=this.workingDelegate=l?this.delegate||this.coreDelegate:this.delegate;return{inline:l,delegate:f}}async checkCanDismiss(e,r){const{canDismiss:l}=this;return typeof l=="function"?l(e,r):l}async present(){const e=await this.lockController.lock();if(this.presented){e();return}const{presentingElement:r,el:l}=this;this.currentBreakpoint=this.initialBreakpoint;const{inline:f,delegate:_}=this.getDelegate(!0);this.ionMount.emit(),this.usersElement=await r_(_,l,this.component,["ion-page"],this.componentProps,f),Oy(l)?await By(this.usersElement):this.keepContentsMounted||await rE(),zm(()=>this.el.classList.add("show-modal"));const y=r!==void 0;y&&ks(this)==="ios"&&(this.statusBarStyle=await xx.getStyle(),B1()),await g1(this,"modalEnter",Vb,gC,{presentingEl:r,currentBreakpoint:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint,expandToScroll:this.expandToScroll}),typeof window<"u"&&(this.keyboardOpenCallback=()=>{this.gesture&&(this.gesture.enable(!1),pu(()=>{this.gesture&&this.gesture.enable(!0)}))},window.addEventListener(Gy,this.keyboardOpenCallback));const d=this.breakpoints!==void 0&&this.initialBreakpoint!==void 0;this.isSheetModal=d,d?this.initSheetGesture():y&&this.initSwipeToClose(),this.initViewTransitionListener(),this.initParentRemovalObserver(),e()}initSwipeToClose(){var e;if(ks(this)!=="ios")return;const{el:r}=this,l=this.leaveAnimation||Sn.get("modalLeave",qb),f=this.animation=l(r,{presentingEl:this.presentingElement,expandToScroll:this.expandToScroll});if(!Fk(r)){Vk(r);return}const y=(e=this.statusBarStyle)!==null&&e!==void 0?e:up.Default;this.gesture=uC(r,f,y,()=>{this.gestureAnimationDismissing=!0,Ov(this.statusBarStyle),this.animation.onFinish(async()=>{await this.dismiss(void 0,sp),this.gestureAnimationDismissing=!1})}),this.gesture.enable(!0)}initSheetGesture(){const{wrapperEl:e,initialBreakpoint:r,backdropBreakpoint:l}=this;if(!e||r===void 0)return;const f=this.enterAnimation||Sn.get("modalEnter",Vb),_=this.animation=f(this.el,{presentingEl:this.presentingElement,currentBreakpoint:r,backdropBreakpoint:l,expandToScroll:this.expandToScroll});_.progressStart(!0,1);const{gesture:y,moveSheetToBreakpoint:d}=vC(this.el,this.backdropEl,e,r,l,_,this.sortedBreakpoints,this.expandToScroll,()=>{var I;return(I=this.currentBreakpoint)!==null&&I!==void 0?I:0},()=>this.sheetOnDismiss(),I=>{this.currentBreakpoint!==I&&(this.currentBreakpoint=I,this.ionBreakpointDidChange.emit({breakpoint:I}))});this.gesture=y,this.moveSheetToBreakpoint=d,this.gesture.enable(!0),(this.showBackdrop===!1||this.focusTrap===!1||l>0)&&this.setupChildRoutePassthrough()}setupChildRoutePassthrough(){var e;this.cachedPageParent=this.getOriginalPageParent();const r=this.cachedPageParent;if(!r||r.tagName==="ION-APP"||Array.from(r.children).some(_=>{var y;return _!==this.el&&!(_ instanceof La&&window.getComputedStyle(_).display==="none")&&_.tagName!=="TEMPLATE"&&_.tagName!=="SLOT"&&!(_.nodeType===Node.TEXT_NODE&&!(!((y=_.textContent)===null||y===void 0)&&y.trim()))}))return;r.classList.add("ion-page-overlay-passthrough");const f=r.parentElement;f?.tagName==="ION-ROUTER-OUTLET"&&((e=f.parentElement)===null||e===void 0?void 0:e.tagName)!=="ION-APP"&&(f.style.setProperty("pointer-events","none"),f.setAttribute("data-overlay-passthrough","true"))}getOriginalPageParent(){if(!this.cachedOriginalParent)return null;let e=this.cachedOriginalParent;for(;e&&!e.classList.contains("ion-page");)e=e.parentElement;return e}cleanupChildRoutePassthrough(){const e=this.cachedPageParent;if(!e)return;e.classList.remove("ion-page-overlay-passthrough");const r=e.parentElement;r?.hasAttribute("data-overlay-passthrough")&&(r.style.removeProperty("pointer-events"),r.removeAttribute("data-overlay-passthrough")),this.cachedPageParent=void 0}sheetOnDismiss(){this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{this.currentBreakpoint=0,this.ionBreakpointDidChange.emit({breakpoint:this.currentBreakpoint}),await this.dismiss(void 0,sp),this.gestureAnimationDismissing=!1})}async dismiss(e,r){var l;if(this.gestureAnimationDismissing&&r!==sp)return!1;const f=await this.lockController.lock();if(await this.dismissNestedModals(),r!=="handler"&&!await this.checkCanDismiss(e,r))return f(),!1;const{presentingElement:_}=this;_!==void 0&&ks(this)==="ios"&&Ov(this.statusBarStyle),typeof window<"u"&&this.keyboardOpenCallback&&(window.removeEventListener(Gy,this.keyboardOpenCallback),this.keyboardOpenCallback=void 0);const d=await y1(this,e,r,"modalLeave",qb,_C,{presentingEl:_,currentBreakpoint:(l=this.currentBreakpoint)!==null&&l!==void 0?l:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint,expandToScroll:this.expandToScroll});if(d){const{delegate:A}=this.getDelegate();await c1(A,this.usersElement),zm(()=>this.el.classList.remove("show-modal")),this.animation&&this.animation.destroy(),this.gesture&&this.gesture.destroy(),this.cleanupViewTransitionListener(),this.cleanupParentRemovalObserver(),this.cleanupChildRoutePassthrough()}return this.currentBreakpoint=void 0,this.animation=void 0,f(),d}onDidDismiss(){return Fy(this.el,"ionModalDidDismiss")}onWillDismiss(){return Fy(this.el,"ionModalWillDismiss")}async setCurrentBreakpoint(e){if(!this.isSheetModal){Ml("[ion-modal] - setCurrentBreakpoint is only supported on sheet modals.");return}if(!this.breakpoints.includes(e)){Ml(`[ion-modal] - Attempted to set invalid breakpoint value ${e}. Please double check that the breakpoint value is part of your defined breakpoints.`);return}const{currentBreakpoint:r,moveSheetToBreakpoint:l,canDismiss:f,breakpoints:_,animated:y}=this;r!==e&&l&&(this.sheetTransition=l({breakpoint:e,breakpointOffset:1-r,canDismiss:f!==void 0&&f!==!0&&_[0]===0,animated:y}),await this.sheetTransition,this.sheetTransition=void 0)}async getCurrentBreakpoint(){return this.currentBreakpoint}async moveToNextBreakpoint(){const{breakpoints:e,currentBreakpoint:r}=this;if(!e||r==null)return!1;const l=e.filter(d=>d!==0),_=(l.indexOf(r)+1)%l.length,y=l[_];return await this.setCurrentBreakpoint(y),!0}initViewTransitionListener(){ks(this)!=="ios"||!this.presentingElement||this.enterAnimation||this.leaveAnimation||(this.currentViewIsPortrait=window.innerWidth<768)}handleViewTransition(){if(!this.presented)return;const e=window.innerWidth<768;if(this.currentViewIsPortrait===e)return;this.viewTransitionAnimation&&(this.viewTransitionAnimation.destroy(),this.viewTransitionAnimation=void 0);const{presentingElement:r}=this;if(!r)return;let l;this.currentViewIsPortrait&&!e?l=fC(this.el,{presentingEl:r}):l=pC(this.el,{presentingEl:r}),this.currentViewIsPortrait=e,this.viewTransitionAnimation=l,l.play().then(()=>{this.viewTransitionAnimation=void 0,this.reinitSwipeToClose()})}cleanupViewTransitionListener(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=void 0),this.viewTransitionAnimation&&(this.viewTransitionAnimation.destroy(),this.viewTransitionAnimation=void 0)}reinitSwipeToClose(){ks(this)!=="ios"||!this.presentingElement||(this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.animation&&(this.animation.progressEnd(0,0,0),this.animation.destroy(),this.animation=void 0),pu(()=>{this.ensureCorrectModalPosition(),this.initSwipeToClose()}))}ensureCorrectModalPosition(){const{el:e,presentingElement:r}=this,f=Ar(e).querySelector(".modal-wrapper");if(f&&(f.style.transform="translateY(0vh)",f.style.opacity="1"),r?.tagName==="ION-MODAL")if(window.innerWidth<768){const y=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",d=Yu.MIN_PRESENTING_SCALE;r.style.transform=`translateY(${y}) scale(${d})`}else r.style.transform="translateY(0px) scale(1)"}async dismissNestedModals(){const e=document.querySelectorAll(`ion-modal[data-parent-ion-modal="${this.el.id}"]`);e?.forEach(async r=>{await r.dismiss(void 0,"parent-dismissed")})}initParentRemovalObserver(){typeof MutationObserver>"u"||typeof window>"u"||!this.cachedOriginalParent||this.cachedOriginalParent.nodeType===Node.DOCUMENT_NODE||this.cachedOriginalParent.nodeType===Node.DOCUMENT_FRAGMENT_NODE||this.hasController||this.cachedOriginalParent===document.body||this.cachedOriginalParent.tagName==="ION-APP"||(this.parentRemovalObserver=new MutationObserver(e=>{e.forEach(r=>{if(r.type==="childList"&&r.removedNodes.length>0){const l=Array.from(r.removedNodes).some(_=>{var y,d;const A=_===this.cachedOriginalParent,I=this.cachedOriginalParent?(d=(y=_).contains)===null||d===void 0?void 0:d.call(y,this.cachedOriginalParent):!1;return A||I}),f=this.cachedOriginalParent&&!this.cachedOriginalParent.isConnected;(l||f)&&(this.dismiss(void 0,"parent-removed"),this.cachedOriginalParent=void 0)}})}),this.parentRemovalObserver.observe(document.body,{childList:!0,subtree:!0}))}cleanupParentRemovalObserver(){var e;(e=this.parentRemovalObserver)===null||e===void 0||e.disconnect(),this.parentRemovalObserver=void 0}render(){const{handle:e,isSheetModal:r,presentingElement:l,htmlAttributes:f,handleBehavior:_,inheritedAttributes:y,focusTrap:d,expandToScroll:A}=this,I=e!==!1&&r,B=ks(this),N=l!==void 0&&B==="ios",V=_==="cycle";return Ei(Go,Object.assign({key:"87328006ea6c75ebc518ace300438492a567223e","no-router":!0,tabIndex:V&&(r&&I)?0:-1},f,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[B]:!0,"modal-default":!N&&!r,"modal-card":N,"modal-sheet":r,"modal-no-expand-scroll":r&&!A,"overlay-hidden":!0,[qy]:d===!1},o1(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle,onFocus:this.onModalFocus}),Ei("ion-backdrop",{key:"ee94ff8e09b691dd4ad4e4db1720f06bc3c5a469",ref:ie=>this.backdropEl=ie,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),B==="ios"&&Ei("div",{key:"bffd69b4635c22d9f249725bd952c1e93d5615c7",class:"modal-shadow"}),Ei("div",Object.assign({key:"1d394d3c68916e464ff1fbf5242419f4a3d3cca1",role:"dialog"},y,{"aria-modal":"true",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:ie=>this.wrapperEl=ie}),I&&Ei("button",{key:"2dcf58792018e557e0c323baad2d672bc99c0bb1",class:"modal-handle",tabIndex:V?0:-1,"aria-label":"Activate to adjust the size of the dialog overlaying the screen",onClick:V?this.onHandleClick:void 0,part:"handle",ref:ie=>this.dragHandleEl=ie}),Ei("slot",{key:"44164b1e8710c3895400ad9f44ecd99873874ad5",onSlotchange:this.onSlotChange})))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:xC,md:bC}}},[289,"ion-modal",{hasController:[4,"has-controller"],overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],breakpoints:[16],expandToScroll:[4,"expand-to-scroll"],initialBreakpoint:[2,"initial-breakpoint"],backdropBreakpoint:[2,"backdrop-breakpoint"],handle:[4],handleBehavior:[1,"handle-behavior"],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],presentingElement:[16],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],keepContentsMounted:[4,"keep-contents-mounted"],focusTrap:[4,"focus-trap"],canDismiss:[4,"can-dismiss"],isSheetModal:[32],presented:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64],setCurrentBreakpoint:[64],getCurrentBreakpoint:[64]},[[9,"resize","onWindowResize"]],{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}]),SC={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"};function TC(){if(typeof customElements>"u")return;["ion-modal","ion-backdrop"].forEach(e=>{switch(e){case"ion-modal":customElements.get(e)||customElements.define(e,wC);break;case"ion-backdrop":customElements.get(e)||Ck();break}})}const EC=Kk;const kC=":host(.tab-hidden){display:none !important}",CC=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.loaded=!1,this.active=!1}async componentWillLoad(){this.active&&await this.setActive()}async setActive(){await this.prepareLazyLoaded(),this.active=!0}changeActive(e){e&&this.prepareLazyLoaded()}prepareLazyLoaded(){if(!this.loaded&&this.component!=null){this.loaded=!0;try{return r_(this.delegate,this.el,this.component,["ion-page"])}catch(e){Ku("[ion-tab] - Exception in prepareLazyLoaded:",e)}}return Promise.resolve(void 0)}render(){const{tab:e,active:r,component:l}=this;return Ei(Go,{key:"dbad8fe9f1566277d14647626308eaf1601ab01f",role:"tabpanel","aria-hidden":r?null:"true","aria-labelledby":`tab-button-${e}`,class:{"ion-page":l===void 0,"tab-hidden":!r}},Ei("slot",{key:"3be64f4e7161f6769aaf8e4dcb5293fcaa09af45"}))}get el(){return this}static get watchers(){return{active:["changeActive"]}}static get style(){return kC}},[257,"ion-tab",{active:[1028],delegate:[16],tab:[1],component:[1],setActive:[64]},void 0,{active:["changeActive"]}]);function AC(){if(typeof customElements>"u")return;["ion-tab"].forEach(e=>{e==="ion-tab"&&(customElements.get(e)||customElements.define(e,CC))})}const MC=AC;function PC(t,e,r,l){let f;if(r==="md"?f=t==="top"?8:-8:f=t==="top"?10:-10,e&&Bs){IC(e,l);const _=e.getBoundingClientRect();return t==="top"?f+=_.bottom:t==="bottom"&&(f-=Bs.innerHeight-_.top),{top:`${f}px`,bottom:`${f}px`}}else return{top:`calc(${f}px + var(--ion-safe-area-top, 0px))`,bottom:`calc(${f}px - var(--ion-safe-area-bottom, 0px))`}}function IC(t,e){t.offsetParent===null&&Ml("[ion-toast] - The positionAnchor element for ion-toast was found in the DOM, but appears to be hidden. This may lead to unexpected positioning of the toast.",e)}const bx=(t,e)=>Math.floor(t/2-e/2),jC=(t,e)=>{const r=_n(),l=_n(),{position:f,top:_,bottom:y}=e,A=Ar(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":l.fromTo("transform","translateY(-100%)",`translateY(${_})`);break;case"middle":const I=bx(t.clientHeight,A.clientHeight);A.style.top=`${I}px`,l.fromTo("opacity",.01,1);break;default:l.fromTo("transform","translateY(100%)",`translateY(${y})`);break}return r.easing("cubic-bezier(.155,1.105,.295,1.12)").duration(400).addAnimation(l)},LC=(t,e)=>{const r=_n(),l=_n(),{position:f,top:_,bottom:y}=e,A=Ar(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":l.fromTo("transform",`translateY(${_})`,"translateY(-100%)");break;case"middle":l.fromTo("opacity",.99,0);break;default:l.fromTo("transform",`translateY(${y})`,"translateY(100%)");break}return r.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(l)},zC=(t,e)=>{const r=_n(),l=_n(),{position:f,top:_,bottom:y}=e,A=Ar(t).querySelector(".toast-wrapper");switch(l.addElement(A),f){case"top":A.style.setProperty("transform",`translateY(${_})`),l.fromTo("opacity",.01,1);break;case"middle":const I=bx(t.clientHeight,A.clientHeight);A.style.top=`${I}px`,l.fromTo("opacity",.01,1);break;default:A.style.setProperty("transform",`translateY(${y})`),l.fromTo("opacity",.01,1);break}return r.easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation(l)},RC=t=>{const e=_n(),r=_n(),f=Ar(t).querySelector(".toast-wrapper");return r.addElement(f).fromTo("opacity",.99,0),e.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(r)},DC=(t,e,r)=>{const l=Ar(t).querySelector(".toast-wrapper"),f=t.clientHeight,_=l.getBoundingClientRect();let y=0;const d=.5,A=t.position==="middle"?.5:0,I=t.position==="top"?-1:1,B=bx(f,_.height),N=[{offset:0,transform:`translateY(-${B+_.height}px)`},{offset:.5,transform:"translateY(0px)"},{offset:1,transform:`translateY(${B+_.height}px)`}],V=_n("toast-swipe-to-dismiss-animation").addElement(l).duration(100);switch(t.position){case"middle":y=f+_.height,V.keyframes(N),V.progressStart(!0,.5);break;case"top":y=_.bottom,V.keyframes([{offset:0,transform:`translateY(${e.top})`},{offset:1,transform:"translateY(-100%)"}]),V.progressStart(!0,0);break;default:y=f-_.top,V.keyframes([{offset:0,transform:`translateY(${e.bottom})`},{offset:1,transform:"translateY(100%)"}]),V.progressStart(!0,0);break}const K=se=>se*I/y,ve=hx({el:l,gestureName:"toast-swipe-to-dismiss",gesturePriority:v1,direction:"y",onMove:se=>{const ge=A+K(se.deltaY);V.progressStep(ge)},onEnd:se=>{const ge=se.velocityY,ae=(se.deltaY+ge*1e3)/y*I;ve.enable(!1);let me=!0,ye=1,Se=0,ze=0;if(t.position==="middle"){me=ae>=d/2||ae<=-.5/2,ye=1,Se=0;const Ze=l.getBoundingClientRect(),st=Ze.top-B,lt=`${st}px`,Ke=se.deltaY<=0?-1:1,Mt=(B+Ze.height)*Ke,gt=me?`${Mt}px`:"0px",St=[{offset:0,transform:`translateY(${lt})`},{offset:1,transform:`translateY(${gt})`}];V.keyframes(St),ze=Mt-st}else me=ae>=d,ye=me?1:0,Se=K(se.deltaY),ze=(me?1-Se:Se)*y;const He=Math.min(Math.abs(ze)/Math.abs(ge),200);V.onFinish(()=>{me?(r(),V.destroy()):(t.position==="middle"?V.keyframes(N).progressStart(!0,.5):V.progressStart(!0,0),ve.enable(!0))},{oneTimeCallback:!0}).progressEnd(ye,Se,He)}});return ve},OC=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host{inset-inline-start:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);pointer-events:auto}.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-content{min-width:0}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-50, var(--ion-background-color-step-50, #f2f2f2));--border-radius:14px;--button-color:var(--ion-color-primary, #0054e9);--color:var(--ion-color-step-850, var(--ion-text-color-step-150, #262626));--max-width:700px;--max-height:478px;--start:10px;--end:10px;font-size:clamp(14px, 0.875rem, 43.4px)}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;z-index:10}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.toast-translucent) .toast-wrapper{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}:host(.ion-color.toast-translucent) .toast-wrapper{background:rgba(var(--ion-color-base-rgb), 0.8)}}.toast-wrapper.toast-middle{opacity:0.01}.toast-content{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:15px;padding-bottom:15px}.toast-header{margin-bottom:2px;font-weight:500}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;min-height:44px;-webkit-transition:background-color, opacity 100ms linear;transition:background-color, opacity 100ms linear;border:0;background-color:transparent;font-family:var(--ion-font-family);font-size:clamp(17px, 1.0625rem, 21.998px);font-weight:500;overflow:hidden}.toast-button.ion-activated{opacity:0.4}@media (any-hover: hover){.toast-button:hover{opacity:0.6}}",NC=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host{inset-inline-start:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);pointer-events:auto}.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-content{min-width:0}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-800, var(--ion-background-color-step-800, #333333));--border-radius:4px;--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--button-color:var(--ion-color-primary, #0054e9);--color:var(--ion-color-step-50, var(--ion-text-color-step-950, #f2f2f2));--max-width:700px;--start:8px;--end:8px;font-size:0.875rem}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;opacity:0.01;z-index:10}.toast-content{-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px;padding-top:14px;padding-bottom:14px}.toast-header{margin-bottom:2px;font-weight:500;line-height:1.25rem}.toast-message{line-height:1.25rem}.toast-layout-baseline .toast-button-group-start{-webkit-margin-start:8px;margin-inline-start:8px}.toast-layout-stacked .toast-button-group-start{-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px}.toast-layout-baseline .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px}.toast-layout-stacked .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px;margin-bottom:8px}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;font-family:var(--ion-font-family);font-size:0.875rem;font-weight:500;letter-spacing:0.84px;text-transform:uppercase;overflow:hidden}.toast-button-cancel{color:var(--ion-color-step-100, var(--ion-text-color-step-900, #e6e6e6))}.toast-button-icon-only{border-radius:50%;-webkit-padding-start:9px;padding-inline-start:9px;-webkit-padding-end:9px;padding-inline-end:9px;padding-top:9px;padding-bottom:9px;width:36px;height:36px}@media (any-hover: hover){.toast-button:hover{background-color:rgba(var(--ion-color-primary-rgb, 0, 84, 233), 0.08)}.toast-button-cancel:hover{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.08)}}",BC=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.didPresent=Hn(this,"ionToastDidPresent",7),this.willPresent=Hn(this,"ionToastWillPresent",7),this.willDismiss=Hn(this,"ionToastWillDismiss",7),this.didDismiss=Hn(this,"ionToastDidDismiss",7),this.didPresentShorthand=Hn(this,"didPresent",7),this.willPresentShorthand=Hn(this,"willPresent",7),this.willDismissShorthand=Hn(this,"willDismiss",7),this.didDismissShorthand=Hn(this,"didDismiss",7),this.delegateController=rk(this),this.lockController=mx(),this.triggerController=x1(),this.customHTMLEnabled=Sn.get("innerHTMLTemplatesEnabled",NE),this.presented=!1,this.revealContentToScreenReader=!1,this.hasController=!1,this.duration=Sn.getNumber("toastDuration",0),this.layout="baseline",this.keyboardClose=!1,this.position="bottom",this.translucent=!1,this.animated=!0,this.isOpen=!1,this.dispatchCancelHandler=r=>{const l=r.detail.role;if(Pv(l)){const f=this.getButtons().find(_=>_.role==="cancel");this.callButtonHandler(f)}},this.createSwipeGesture=r=>{(this.gesture=DC(this.el,r,()=>{this.dismiss(void 0,sp)})).enable(!0)},this.destroySwipeGesture=()=>{const{gesture:r}=this;r!==void 0&&(r.destroy(),this.gesture=void 0)},this.prefersSwipeGesture=()=>{const{swipeGesture:r}=this;return r==="vertical"}}swipeGestureChanged(){this.destroySwipeGesture(),this.presented&&this.prefersSwipeGesture()&&this.createSwipeGesture(this.lastPresentedPosition)}onIsOpenChange(e,r){e===!0&&r===!1?this.present():e===!1&&r===!0&&this.dismiss()}triggerChanged(){const{trigger:e,el:r,triggerController:l}=this;e&&l.addClickListener(r,e)}connectedCallback(){d1(this.el),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){var e;!((e=this.htmlAttributes)===null||e===void 0)&&e.id||f1(this.el)}componentDidLoad(){this.isOpen===!0&&pu(()=>this.present()),this.triggerChanged()}async present(){const e=await this.lockController.lock();await this.delegateController.attachViewToDom();const{el:r,position:l}=this,f=this.getAnchorElement(),_=PC(l,f,ks(this),r);this.lastPresentedPosition=_,await g1(this,"toastEnter",jC,zC,{position:l,top:_.top,bottom:_.bottom}),this.revealContentToScreenReader=!0,this.duration>0&&(this.durationTimeout=setTimeout(()=>this.dismiss(void 0,"timeout"),this.duration)),this.prefersSwipeGesture()&&this.createSwipeGesture(_),e()}async dismiss(e,r){var l,f;const _=await this.lockController.lock(),{durationTimeout:y,position:d,lastPresentedPosition:A}=this;y&&clearTimeout(y);const I=await y1(this,e,r,"toastLeave",LC,RC,{position:d,top:(l=A?.top)!==null&&l!==void 0?l:"",bottom:(f=A?.bottom)!==null&&f!==void 0?f:""});return I&&(this.delegateController.removeViewFromDom(),this.revealContentToScreenReader=!1),this.lastPresentedPosition=void 0,this.destroySwipeGesture(),_(),I}onDidDismiss(){return Fy(this.el,"ionToastDidDismiss")}onWillDismiss(){return Fy(this.el,"ionToastWillDismiss")}getButtons(){return this.buttons?this.buttons.map(r=>typeof r=="string"?{text:r}:r):[]}getAnchorElement(){const{position:e,positionAnchor:r,el:l}=this;if(r!==void 0){if(e==="middle"&&r!==void 0){Ml('[ion-toast] - The positionAnchor property is ignored when using position="middle".',this.el);return}if(typeof r=="string"){const f=document.getElementById(r);if(f===null){Ml(`[ion-toast] - An anchor element with an ID of "${r}" was not found in the DOM.`,l);return}return f}if(r instanceof La)return r;Ml("[ion-toast] - Invalid positionAnchor value:",r,l)}}async buttonClick(e){const r=e.role;return Pv(r)?this.dismiss(void 0,r):await this.callButtonHandler(e)?this.dismiss(void 0,r):Promise.resolve()}async callButtonHandler(e){if(e?.handler)try{if(await sk(e.handler)===!1)return!1}catch(r){Ku("[ion-toast] - Exception in callButtonHandler:",r)}return!0}renderButtons(e,r){if(e.length===0)return;const l=ks(this),f={"toast-button-group":!0,[`toast-button-group-${r}`]:!0};return Ei("div",{class:f},e.map(_=>Ei("button",Object.assign({},_.htmlAttributes,{type:"button",class:$C(_),tabIndex:0,onClick:()=>this.buttonClick(_),part:UC(_)}),Ei("div",{class:"toast-button-inner"},_.icon&&Ei("ion-icon",{"aria-hidden":"true",icon:_.icon,slot:_.text===void 0?"icon-only":void 0,class:"toast-button-icon"}),_.text),l==="md"&&Ei("ion-ripple-effect",{type:_.icon!==void 0&&_.text===void 0?"unbounded":"bounded"}))))}renderToastMessage(e,r=null){const{customHTMLEnabled:l,message:f}=this;return l?Ei("div",{key:e,"aria-hidden":r,class:"toast-message",part:"message",innerHTML:LE(f)}):Ei("div",{key:e,"aria-hidden":r,class:"toast-message",part:"message"},f)}renderHeader(e,r=null){return Ei("div",{key:e,class:"toast-header","aria-hidden":r,part:"header"},this.header)}render(){const{layout:e,el:r,revealContentToScreenReader:l,header:f,message:_}=this,y=this.getButtons(),d=y.filter(N=>N.side==="start"),A=y.filter(N=>N.side!=="start"),I=ks(this),B={"toast-wrapper":!0,[`toast-${this.position}`]:!0,[`toast-layout-${e}`]:!0};return e==="stacked"&&d.length>0&&A.length>0&&Ml("[ion-toast] - This toast is using start and end buttons with the stacked toast layout. We recommend following the best practice of using either start or end buttons with the stacked toast layout.",r),Ei(Go,Object.assign({key:"d1ecd90c87700aad4685e230cdd430aa286b8791",tabindex:"-1"},this.htmlAttributes,{style:{zIndex:`${6e4+this.overlayIndex}`},class:Km(this.color,Object.assign(Object.assign({[I]:!0},o1(this.cssClass)),{"overlay-hidden":!0,"toast-translucent":this.translucent})),onIonToastWillDismiss:this.dispatchCancelHandler}),Ei("div",{key:"4bfc863417324de69e222054d5cf9c452038b41e",class:B},Ei("div",{key:"3417940afec0392e81b7d54c7cb00f3ab6c30d47",class:"toast-container",part:"container"},this.renderButtons(d,"start"),this.icon!==void 0&&Ei("ion-icon",{key:"6bf878fbc85c01e1e5faa9d97d46255a6511a952",class:"toast-icon",part:"icon",icon:this.icon,lazy:!1,"aria-hidden":"true"}),Ei("div",{key:"54b500348a9c37660c3aff37436d9188e4374947",class:"toast-content",role:"status","aria-atomic":"true","aria-live":"polite"},!l&&f!==void 0&&this.renderHeader("oldHeader","true"),!l&&_!==void 0&&this.renderToastMessage("oldMessage","true"),l&&f!==void 0&&this.renderHeader("header"),l&&_!==void 0&&this.renderToastMessage("header")),this.renderButtons(A,"end"))))}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:OC,md:NC}}},[289,"ion-toast",{overlayIndex:[2,"overlay-index"],delegate:[16],hasController:[4,"has-controller"],color:[513],enterAnimation:[16],leaveAnimation:[16],cssClass:[1,"css-class"],duration:[2],header:[1],layout:[1],message:[1],keyboardClose:[4,"keyboard-close"],position:[1],positionAnchor:[1,"position-anchor"],buttons:[16],translucent:[4],animated:[4],icon:[1],htmlAttributes:[16],swipeGesture:[1,"swipe-gesture"],isOpen:[4,"is-open"],trigger:[1],revealContentToScreenReader:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64]},void 0,{swipeGesture:["swipeGestureChanged"],isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}]),$C=t=>({"toast-button":!0,"toast-button-icon-only":t.icon!==void 0&&t.text===void 0,[`toast-button-${t.role}`]:t.role!==void 0,"ion-focusable":!0,"ion-activatable":!0}),UC=t=>Pv(t.role)?"button cancel":"button";function FC(){if(typeof customElements>"u")return;["ion-toast","ion-icon","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-toast":customElements.get(e)||customElements.define(e,BC);break;case"ion-icon":customElements.get(e)||k1();break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const VC=FC;const qC=TC,HC="html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html.plt-mobile ion-app [contenteditable]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}",ZC=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost()}componentDidLoad(){WC(async()=>{const e=Vh(window,"hybrid");if(Sn.getBoolean("_testing")||Ac(()=>import("./index7-BDaMFFz6.js"),[]).then(f=>f.startTapClick(Sn)),Sn.getBoolean("statusTap",e)&&Ac(()=>import("./status-tap-Br4uLiXN.js"),[]).then(f=>f.startStatusTap()),Sn.getBoolean("inputShims",GC())){const f=Vh(window,"ios")?"ios":"android";Ac(()=>import("./input-shims-lbtwpnIN.js"),[]).then(_=>_.startInputShims(Sn,f))}const r=await Ac(()=>Promise.resolve().then(()=>HE),void 0),l=e||Nm();Sn.getBoolean("hardwareBackButton",l)?r.startHardwareBackButton():(Nm()&&Ml("[ion-app] - experimentalCloseWatcher was set to `true`, but hardwareBackButton was set to `false`. Both config options must be `true` for the Close Watcher API to be used."),r.blockHardwareBackButton()),typeof window<"u"&&Ac(()=>Promise.resolve().then(()=>cC),void 0).then(f=>f.startKeyboardAssist(window)),Ac(()=>import("./focus-visible-DY9QzpaF.js"),[]).then(f=>this.focusVisible=f.startFocusVisible())})}async setFocus(e){this.focusVisible&&this.focusVisible.setFocus(e)}render(){const e=ks(this);return Ei(Go,{key:"9be440c65819e4fa67c2c3c6477ab40b3ad3eed3",class:{[e]:!0,"ion-page":!0,"force-statusbar-padding":Sn.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return HC}},[256,"ion-app",{setFocus:[64]}]),GC=()=>!!(Vh(window,"ios")&&Vh(window,"mobile")||Vh(window,"android")&&Vh(window,"mobileweb")),WC=t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,32)};function YC(){if(typeof customElements>"u")return;["ion-app"].forEach(e=>{e==="ion-app"&&(customElements.get(e)||customElements.define(e,ZC))})}const XC=YC;const KC=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}ion-ripple-effect{color:var(--ripple-color)}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--background-hover:transparent;--background-hover-opacity:1;--background-focused:currentColor;--background-focused-opacity:.1;--border-radius:4px;--color:var(--ion-color-primary, #0054e9);--icon-margin-end:1px;--icon-margin-start:-4px;--icon-font-size:1.6em;--min-height:32px;font-size:clamp(17px, 1.0625rem, 21.998px)}.button-native{-webkit-transform:translateZ(0);transform:translateZ(0);overflow:visible;z-index:99}:host(.ion-activated) .button-native{opacity:0.4}@media (any-hover: hover){:host(:hover){opacity:0.6}}',JC=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}ion-ripple-effect{color:var(--ripple-color)}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--border-radius:4px;--background-focused:currentColor;--background-focused-opacity:.12;--background-hover:currentColor;--background-hover-opacity:0.04;--color:currentColor;--icon-margin-end:0;--icon-margin-start:0;--icon-font-size:1.5rem;--icon-font-weight:normal;--min-height:32px;--min-width:44px;--padding-start:12px;--padding-end:12px;font-size:0.875rem;font-weight:500;text-transform:uppercase}:host(.back-button-has-icon-only){--border-radius:50%;min-width:48px;min-height:48px;aspect-ratio:1/1}.button-native{-webkit-box-shadow:none;box-shadow:none}.button-text{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:0;padding-bottom:0}ion-icon{line-height:0.67;text-align:start}@media (any-hover: hover){:host(.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}',QC=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.inheritedAttributes={},this.disabled=!1,this.type="button",this.onClick=async r=>{const l=this.el.closest("ion-nav");return r.preventDefault(),l&&await l.canGoBack()?l.pop({animationBuilder:this.routerAnimation,skipIfBusy:!0}):UE(this.defaultHref,r,"back",this.routerAnimation)}}componentWillLoad(){this.inheritedAttributes=Vw(this.el),this.defaultHref===void 0&&(this.defaultHref=Sn.get("backButtonDefaultHref"))}get backButtonIcon(){const e=this.icon;return e??(ks(this)==="ios"?Sn.get("backButtonIcon",lk):Sn.get("backButtonIcon",ok))}get backButtonText(){const e=ks(this)==="ios"?"Back":null;return this.text!=null?this.text:Sn.get("backButtonText",e)}get hasIconOnly(){return this.backButtonIcon&&!this.backButtonText}get rippleType(){return this.hasIconOnly?"unbounded":"bounded"}render(){const{color:e,defaultHref:r,disabled:l,type:f,hasIconOnly:_,backButtonIcon:y,backButtonText:d,icon:A,inheritedAttributes:I}=this,B=r!==void 0,N=ks(this),V=I["aria-label"]||d||"back";return Ei(Go,{key:"5466624a10f1ab56f5469e6dc07080303880f2fe",onClick:this.onClick,class:Km(e,{[N]:!0,button:!0,"back-button-disabled":l,"back-button-has-icon-only":_,"in-toolbar":Cv("ion-toolbar",this.el),"in-toolbar-color":Cv("ion-toolbar[color]",this.el),"ion-activatable":!0,"ion-focusable":!0,"show-back-button":B})},Ei("button",{key:"63bc75ef0ad7cc9fb79e58217a3314b20acd73e3",type:f,disabled:l,class:"button-native",part:"native","aria-label":V},Ei("span",{key:"5d3eacbd11af2245c6e1151cab446a0d96559ad8",class:"button-inner"},y&&Ei("ion-icon",{key:"6439af0ae463764174e7d3207f02267811df666d",part:"icon",icon:y,"aria-hidden":"true",lazy:!1,"flip-rtl":A===void 0}),d&&Ei("span",{key:"8ee89fb18dfdb5b75948a8b197ff4cdbc008742f",part:"text","aria-hidden":"true",class:"button-text"},d)),N==="md"&&Ei("ion-ripple-effect",{key:"63803a884998bc73bea5afe0b2a0a14e3fa4d6bf",type:this.rippleType})))}get el(){return this}static get style(){return{ios:KC,md:JC}}},[289,"ion-back-button",{color:[513],defaultHref:[1025,"default-href"],disabled:[516],icon:[1],text:[1],type:[1],routerAnimation:[16]}]);function eA(){if(typeof customElements>"u")return;["ion-back-button","ion-icon","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-back-button":customElements.get(e)||customElements.define(e,QC);break;case"ion-icon":customElements.get(e)||k1();break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const tA=eA,iA=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;z-index:0}",nA=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Hn(this,"ionNavWillLoad",7),this.ionNavWillChange=Hn(this,"ionNavWillChange",3),this.ionNavDidChange=Hn(this,"ionNavDidChange",3),this.lockController=mx(),this.gestureOrAnimationInProgress=!1,this.mode=ks(this),this.animated=!0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(this.swipeHandler!==void 0)}async connectedCallback(){const e=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await Ac(async()=>{const{createSwipeBackGesture:r}=await import("./swipe-back-BJCUSLFW.js");return{createSwipeBackGesture:r}},[])).createSwipeBackGesture(this.el,()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart(),()=>e(),r=>{var l;return(l=this.ani)===null||l===void 0?void 0:l.progressStep(r)},(r,l,f)=>{if(this.ani){this.ani.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(r)},{oneTimeCallback:!0});let _=r?-.001:.001;r?_+=cp([0,0],[.32,.72],[0,1],[1,1],l)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),_+=cp([0,0],[1,0],[.68,.28],[1,1],l)[0]),this.ani.progressEnd(r?1:0,_,f)}else this.gestureOrAnimationInProgress=!1}),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(e,r,l){const f=await this.lockController.lock();let _=!1;try{_=await this.transition(e,r,l)}catch(y){Ku("[ion-router-outlet] - Exception in commit:",y)}return f(),_}async setRouteId(e,r,l,f){return{changed:await this.setRoot(e,r,{duration:l==="root"?0:void 0,direction:l==="back"?"back":"forward",animationBuilder:f}),element:this.activeEl}}async getRouteId(){const e=this.activeEl;return e?{id:e.tagName,element:e,params:this.activeParams}:void 0}async setRoot(e,r,l){if(this.activeComponent===e&&Hw(r,this.activeParams))return!1;const f=this.activeEl,_=await r_(this.delegate,this.el,e,["ion-page","ion-page-invisible"],r);return this.activeComponent=e,this.activeEl=_,this.activeParams=r,await this.commit(_,f,l),await c1(this.delegate,f),!0}async transition(e,r,l={}){if(r===e)return!1;this.ionNavWillChange.emit();const{el:f,mode:_}=this,y=this.animated&&Sn.getBoolean("animated",!0),d=l.animationBuilder||this.animation||Sn.get("navAnimation");return await Yw(Object.assign(Object.assign({mode:_,animated:y,enteringEl:e,leavingEl:r,baseEl:f,deepWait:Oy(f),progressCallback:l.progressAnimation?A=>{A!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,A.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)},{oneTimeCallback:!0}),A.progressEnd(0,0,0)):this.ani=A}:void 0},l),{animationBuilder:d})),this.ionNavDidChange.emit(),!0}render(){return Ei("slot",{key:"84b50f1155b0d780dff802ee13223287259fd525"})}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return iA}},[257,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]},void 0,{swipeHandler:["swipeHandlerChanged"]}]);function sA(){if(typeof customElements>"u")return;["ion-router-outlet"].forEach(e=>{e==="ion-router-outlet"&&(customElements.get(e)||customElements.define(e,nA))})}const rA=sA;const aA=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, var(--ion-background-color-step-50, #f7f7f7)));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, var(--ion-background-color-step-150, rgba(0, 0, 0, 0.2)))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, var(--ion-text-color-step-400, #666666)));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #0054e9));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",oA=":host{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-right:var(--ion-safe-area-right);padding-bottom:var(--ion-safe-area-bottom, 0);padding-left:var(--ion-safe-area-left);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, var(--ion-background-color-step-150, rgba(0, 0, 0, 0.07)))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, var(--ion-text-color-step-350, #595959)));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #0054e9));height:56px}",lA=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=Hn(this,"ionTabBarChanged",7),this.ionTabBarLoaded=Hn(this,"ionTabBarLoaded",7),this.keyboardCtrl=null,this.didLoad=!1,this.keyboardVisible=!1,this.translucent=!1}selectedTabChanged(){this.didLoad&&this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentDidLoad(){this.ionTabBarLoaded.emit(),this.didLoad=!0,this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}async connectedCallback(){this.keyboardCtrl=await Hk(async(e,r)=>{e===!1&&r!==void 0&&await r,this.keyboardVisible=e})}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}render(){const{color:e,translucent:r,keyboardVisible:l}=this,f=ks(this),_=l&&this.el.getAttribute("slot")!=="top";return Ei(Go,{key:"388ec37ce308035bab78d6c9a016bb616e9517a9",role:"tablist","aria-hidden":_?"true":null,class:Km(e,{[f]:!0,"tab-bar-translucent":r,"tab-bar-hidden":_})},Ei("slot",{key:"ce10ade2b86725e24f3254516483eeedd8ecb16a"}))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:aA,md:oA}}},[289,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]},void 0,{selectedTab:["selectedTabChanged"]}]);function cA(){if(typeof customElements>"u")return;["ion-tab-bar"].forEach(e=>{e==="ion-tab-bar"&&(customElements.get(e)||customElements.define(e,lA))})}const uA=cA;const hA=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:24px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){font-size:30px}',dA=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}',fA=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=Hn(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.disabled=!1,this.selected=!1,this.onKeyUp=r=>{(r.key==="Enter"||r.key===" ")&&this.selectTab(r)},this.onClick=r=>{this.selectTab(r)}}onTabBarChanged(e){const r=e.target,l=this.el.parentElement;(e.composedPath().includes(l)||r?.contains(this.el))&&(this.selected=this.tab===e.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},ux(this.el,["aria-label"])),this.layout===void 0&&(this.layout=Sn.get("tabButtonLayout","icon-top"))}selectTab(e){this.tab!==void 0&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),e.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:e,hasIcon:r,hasLabel:l,href:f,rel:_,target:y,layout:d,selected:A,tab:I,inheritedAttributes:B}=this,N=ks(this),V={download:this.download,href:f,rel:_,target:y};return Ei(Go,{key:"ce9d29ced0c781d6b2fa62cd5feb801c11fc42e8",onClick:this.onClick,onKeyup:this.onKeyUp,id:I!==void 0?`tab-button-${I}`:null,class:{[N]:!0,"tab-selected":A,"tab-disabled":e,"tab-has-label":l,"tab-has-icon":r,"tab-has-label-only":l&&!r,"tab-has-icon-only":r&&!l,[`tab-layout-${d}`]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},Ei("a",Object.assign({key:"01cb0ed2e77c5c1a8abd48da1bb07ac1b305d0b6"},V,{class:"button-native",part:"native",role:"tab","aria-selected":A?"true":null,"aria-disabled":e?"true":null,tabindex:e?"-1":void 0},B),Ei("span",{key:"d0240c05f42217cfb186b86ff8a0c9cd70b9c8df",class:"button-inner"},Ei("slot",{key:"0a20b84925037dbaa8bb4a495b813d3f7c2e58ac"})),N==="md"&&Ei("ion-ripple-effect",{key:"4c92c27178cdac89d69cffef8d2c39c3644914e8",type:"unbounded"})))}get el(){return this}static get style(){return{ios:hA,md:dA}}},[289,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]);function pA(){if(typeof customElements>"u")return;["ion-tab-button","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-tab-button":customElements.get(e)||customElements.define(e,fA);break;case"ion-ripple-effect":customElements.get(e)||px();break}})}const mA=pA;const gA=":host{left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%;contain:layout size style;z-index:0}.tabs-inner{position:relative;-ms-flex:1;flex:1;contain:layout size style}",yA=To(class extends La{constructor(e){super(),e!==!1&&this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Hn(this,"ionNavWillLoad",7),this.ionTabsWillChange=Hn(this,"ionTabsWillChange",3),this.ionTabsDidChange=Hn(this,"ionTabsDidChange",3),this.transitioning=!1,this.useRouter=!1,this.onTabClicked=r=>{const{href:l,tab:f}=r.detail;if(this.useRouter&&l!==void 0){const _=document.querySelector("ion-router");_&&_.push(l)}else this.select(f)}}async componentWillLoad(){if(this.useRouter||(this.useRouter=(!!this.el.querySelector("ion-router-outlet")||!!document.querySelector("ion-router"))&&!this.el.closest("[no-router]")),!this.useRouter){const e=this.tabs;e.length>0&&await this.select(e[0])}this.ionNavWillLoad.emit()}componentDidLoad(){this.updateTabBar()}componentDidUpdate(){this.updateTabBar()}updateTabBar(){const e=this.el.querySelector("ion-tab-bar");if(!e)return;const r=this.selectedTab?this.selectedTab.tab:void 0;r!==void 0&&e.selectedTab!==r&&(e.selectedTab=r)}async select(e){const r=V_(this.tabs,e);return this.shouldSwitch(r)?(await this.setActive(r),await this.notifyRouter(),this.tabSwitch(),!0):!1}async getTab(e){return V_(this.tabs,e)}getSelected(){return Promise.resolve(this.selectedTab?this.selectedTab.tab:void 0)}async setRouteId(e){const r=V_(this.tabs,e);return this.shouldSwitch(r)?(await this.setActive(r),{changed:!0,element:this.selectedTab,markVisible:()=>this.tabSwitch()}):{changed:!1,element:this.selectedTab}}async getRouteId(){var e;const r=(e=this.selectedTab)===null||e===void 0?void 0:e.tab;return r!==void 0?{id:r,element:this.selectedTab}:void 0}setActive(e){return this.transitioning?Promise.reject("transitioning already happening"):(this.transitioning=!0,this.leavingTab=this.selectedTab,this.selectedTab=e,this.ionTabsWillChange.emit({tab:e.tab}),e.active=!0,this.updateTabBar(),Promise.resolve())}tabSwitch(){const e=this.selectedTab,r=this.leavingTab;this.leavingTab=void 0,this.transitioning=!1,e&&r!==e&&(r&&(r.active=!1),this.ionTabsDidChange.emit({tab:e.tab}))}notifyRouter(){if(this.useRouter){const e=document.querySelector("ion-router");if(e)return e.navChanged("forward")}return Promise.resolve(!1)}shouldSwitch(e){const r=this.selectedTab;return e!==void 0&&e!==r&&!this.transitioning}get tabs(){return Array.from(this.el.querySelectorAll("ion-tab"))}render(){return Ei(Go,{key:"7b4b302f2942d8d131f6fc24e817989a8be08867",onIonTabButtonClick:this.onTabClicked},Ei("slot",{key:"2c51cf14c0f17a8ddf2d879858c984cdf8fd3147",name:"top"}),Ei("div",{key:"7e9d6055092d41bd9bc80ae15965f77e216feb84",class:"tabs-inner"},Ei("slot",{key:"c308a787e37ff7f6653531d70deca597a7602d26"})),Ei("slot",{key:"d5f5e693710c853570811602f859cf3e88272684",name:"bottom"}))}get el(){return this}static get style(){return gA}},[257,"ion-tabs",{useRouter:[1028,"use-router"],selectedTab:[32],select:[64],getTab:[64],getSelected:[64],setRouteId:[64],getRouteId:[64]}]),V_=(t,e)=>{const r=typeof e=="string"?t.find(l=>l.tab===e):e;return r||Ku(`[ion-tabs] - Tab with id: "${r}" does not exist`),r};function _A(){if(typeof customElements>"u")return;["ion-tabs"].forEach(e=>{e==="ion-tabs"&&(customElements.get(e)||customElements.define(e,yA))})}const vA=_A,xA="ionicons",a_={hydratedSelectorName:"hydrated",lazyLoad:!1,updatable:!0};var bA=Object.defineProperty,wA=(t,e)=>{for(var r in e)bA(t,r,{get:e[r],enumerable:!0})},ef=t=>{if(t.__stencil__getHostRef)return t.__stencil__getHostRef()},SA=(t,e)=>{const r={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};r.$onReadyPromise$=new Promise(f=>r.$onReadyResolve$=f),t["s-p"]=[],t["s-rc"]=[];const l=r;return t.__stencil__getHostRef=()=>l,l},Hb=(t,e)=>e in t,o_=(t,e)=>(0,console.error)(t,e),Yy=new Map,TA="slot-fb{display:contents}slot-fb[hidden]{display:none}",Zb="http://www.w3.org/1999/xlink",Mc=typeof window<"u"?window:{},EA=Mc.HTMLElement||class{},Gh={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,r,l)=>t.addEventListener(e,r,l),rel:(t,e,r,l)=>t.removeEventListener(e,r,l),ce:(t,e)=>new CustomEvent(t,e)},kA=t=>Promise.resolve(t),V1=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),Bv=!1,Gb=[],q1=[],CA=(t,e)=>r=>{t.push(r),Bv||(Bv=!0,Gh.raf(H1))},Wb=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(r){o_(r)}t.length=0},H1=()=>{Wb(Gb),Wb(q1),(Bv=Gb.length>0)&&Gh.raf(H1)},wx=t=>kA().then(t),AA=CA(q1),MA=t=>{const e=new URL(t,Gh.$resourcesUrl$);return e.origin!==Mc.location.origin?e.href:e.pathname},Sx=t=>(t=typeof t,t==="object"||t==="function");function PA(t){var e,r,l;return(l=(r=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:r.getAttribute("content"))!=null?l:void 0}var IA=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),jA={};wA(jA,{err:()=>Z1,map:()=>LA,ok:()=>$v,unwrap:()=>zA,unwrapErr:()=>RA});var $v=t=>({isOk:!0,isErr:!1,value:t}),Z1=t=>({isOk:!1,isErr:!0,value:t});function LA(t,e){if(t.isOk){const r=e(t.value);return r instanceof Promise?r.then(l=>$v(l)):$v(r)}if(t.isErr){const r=t.value;return Z1(r)}throw"should never get here"}var zA=t=>{if(t.isOk)return t.value;throw t.value},RA=t=>{if(t.isErr)return t.value;throw t.value};var dy;function DA(t){var e;const r=this.attachShadow({mode:"open"});dy===void 0&&(dy=(e=void 0)!=null?e:null),dy&&r.adoptedStyleSheets.push(dy)}var tf=(t,e="")=>()=>{},ep=new WeakMap,OA=(t,e,r)=>{let l=Yy.get(t);V1&&r?(l=l||new CSSStyleSheet,typeof l=="string"?l=e:l.replaceSync(e)):l=e,Yy.set(t,l)},NA=(t,e,r)=>{var l;const f=G1(e),_=Yy.get(f);if(!Mc.document)return f;if(t=t.nodeType===11?t:Mc.document,_)if(typeof _=="string"){t=t.head||t;let y=ep.get(t),d;if(y||ep.set(t,y=new Set),!y.has(f)){{d=Mc.document.createElement("style"),d.innerHTML=_;const A=(l=Gh.$nonce$)!=null?l:PA(Mc.document);if(A!=null&&d.setAttribute("nonce",A),!(e.$flags$&1))if(t.nodeName==="HEAD"){const I=t.querySelectorAll("link[rel=preconnect]"),B=I.length>0?I[I.length-1].nextSibling:t.querySelector("style");t.insertBefore(d,B?.parentNode===t?B:null)}else if("host"in t)if(V1){const I=new CSSStyleSheet;I.replaceSync(_),t.adoptedStyleSheets.unshift(I)}else{const I=t.querySelector("style");I?I.innerHTML=_+I.innerHTML:t.prepend(d)}else t.append(d);e.$flags$&1&&t.insertBefore(d,null)}e.$flags$&4&&(d.innerHTML+=TA),y&&y.add(f)}}else t.adoptedStyleSheets.includes(_)||t.adoptedStyleSheets.push(_);return f},BA=t=>{const e=t.$cmpMeta$,r=t.$hostElement$,l=e.$flags$,f=tf("attachStyles",e.$tagName$),_=NA(r.shadowRoot?r.shadowRoot:r.getRootNode(),e);l&10&&(r["s-sc"]=_,r.classList.add(_+"-h")),f()},G1=(t,e)=>"sc-"+t.$tagName$,ky=(t,e,...r)=>{let l=null,f=null,_=!1,y=!1;const d=[],A=B=>{for(let N=0;N<B.length;N++)l=B[N],Array.isArray(l)?A(l):l!=null&&typeof l!="boolean"&&((_=typeof t!="function"&&!Sx(l))&&(l=String(l)),_&&y?d[d.length-1].$text$+=l:d.push(_?Uv(null,l):l),y=_)};if(A(r),e){e.key&&(f=e.key);{const B=e.className||e.class;B&&(e.class=typeof B!="object"?B:Object.keys(B).filter(N=>B[N]).join(" "))}}const I=Uv(t,null);return I.$attrs$=e,d.length>0&&(I.$children$=d),I.$key$=f,I},Uv=(t,e)=>{const r={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return r.$attrs$=null,r.$key$=null,r},W1={},$A=t=>t&&t.$tag$===W1,Tx=t=>{const e=IA(t);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${e}))(${e}\\b)`,"g")};Tx("::slotted");Tx(":host");Tx(":host-context");var Y1=(t,e,r)=>t!=null&&!Sx(t)?e&4?t==="false"?!1:t===""||!!t:e&1?String(t):t:t,UA=(t,e,r)=>{const l=Gh.ce(e,r);return t.dispatchEvent(l),l},Yb=(t,e,r,l,f,_,y)=>{if(r===l)return;let d=Hb(t,e),A=e.toLowerCase();if(e==="class"){const I=t.classList,B=Xb(r);let N=Xb(l);I.remove(...B.filter(V=>V&&!N.includes(V))),I.add(...N.filter(V=>V&&!B.includes(V)))}else if(e==="style"){for(const I in r)(!l||l[I]==null)&&(I.includes("-")?t.style.removeProperty(I):t.style[I]="");for(const I in l)(!r||l[I]!==r[I])&&(I.includes("-")?t.style.setProperty(I,l[I]):t.style[I]=l[I])}else if(e!=="key")if(e==="ref")l&&l(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n"){if(e[2]==="-"?e=e.slice(3):Hb(Mc,A)?e=A.slice(2):e=A[2]+e.slice(3),r||l){const I=e.endsWith(X1);e=e.replace(VA,""),r&&Gh.rel(t,e,r,I),l&&Gh.ael(t,e,l,I)}}else{const I=Sx(l);if(d||I&&l!==null)try{if(t.tagName.includes("-"))t[e]!==l&&(t[e]=l);else{const N=l??"";e==="list"?d=!1:(r==null||t[e]!=N)&&(typeof t.__lookupSetter__(e)=="function"?t[e]=N:t.setAttribute(e,N))}}catch{}let B=!1;A!==(A=A.replace(/^xlink\:?/,""))&&(e=A,B=!0),l==null||l===!1?(l!==!1||t.getAttribute(e)==="")&&(B?t.removeAttributeNS(Zb,e):t.removeAttribute(e)):(!d||_&4||f)&&!I&&t.nodeType===1&&(l=l===!0?"":l,B?t.setAttributeNS(Zb,e,l):t.setAttribute(e,l))}},FA=/\s/,Xb=t=>(typeof t=="object"&&t&&"baseVal"in t&&(t=t.baseVal),!t||typeof t!="string"?[]:t.split(FA)),X1="Capture",VA=new RegExp(X1+"$"),K1=(t,e,r,l)=>{const f=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,_=t&&t.$attrs$||{},y=e.$attrs$||{};for(const d of Kb(Object.keys(_)))d in y||Yb(f,d,_[d],void 0,r,e.$flags$);for(const d of Kb(Object.keys(y)))Yb(f,d,_[d],y[d],r,e.$flags$)};function Kb(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var Ex,J1=!1,Xy=(t,e,r)=>{const l=e.$children$[r];let f=0,_,y;if(l.$text$!==null)_=l.$elm$=Mc.document.createTextNode(l.$text$);else{if(!Mc.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(_=l.$elm$=Mc.document.createElement(l.$tag$),K1(null,l,J1),l.$children$)for(f=0;f<l.$children$.length;++f)y=Xy(t,l,f),y&&_.appendChild(y)}return _["s-hn"]=Ex,_},Q1=(t,e,r,l,f,_)=>{let y=t,d;for(y.shadowRoot&&y.tagName===Ex&&(y=y.shadowRoot);f<=_;++f)l[f]&&(d=Xy(null,r,f),d&&(l[f].$elm$=d,Cy(y,d,e)))},eS=(t,e,r)=>{for(let l=e;l<=r;++l){const f=t[l];if(f){const _=f.$elm$;tS(f),_&&_.remove()}}},qA=(t,e,r,l,f=!1)=>{let _=0,y=0,d=0,A=0,I=e.length-1,B=e[0],N=e[I],V=l.length-1,K=l[0],ie=l[V],ne,ve;for(;_<=I&&y<=V;)if(B==null)B=e[++_];else if(N==null)N=e[--I];else if(K==null)K=l[++y];else if(ie==null)ie=l[--V];else if(fy(B,K,f))Yf(B,K,f),B=e[++_],K=l[++y];else if(fy(N,ie,f))Yf(N,ie,f),N=e[--I],ie=l[--V];else if(fy(B,ie,f))Yf(B,ie,f),Cy(t,B.$elm$,N.$elm$.nextSibling),B=e[++_],ie=l[--V];else if(fy(N,K,f))Yf(N,K,f),Cy(t,N.$elm$,B.$elm$),N=e[--I],K=l[++y];else{for(d=-1,A=_;A<=I;++A)if(e[A]&&e[A].$key$!==null&&e[A].$key$===K.$key$){d=A;break}d>=0?(ve=e[d],ve.$tag$!==K.$tag$?ne=Xy(e&&e[y],r,d):(Yf(ve,K,f),e[d]=void 0,ne=ve.$elm$),K=l[++y]):(ne=Xy(e&&e[y],r,y),K=l[++y]),ne&&Cy(B.$elm$.parentNode,ne,B.$elm$)}_>I?Q1(t,l[V+1]==null?null:l[V+1].$elm$,r,l,y,V):y>V&&eS(e,_,I)},fy=(t,e,r=!1)=>t.$tag$===e.$tag$?r?(r&&!t.$key$&&e.$key$&&(t.$key$=e.$key$),!0):t.$key$===e.$key$:!1,Yf=(t,e,r=!1)=>{const l=e.$elm$=t.$elm$,f=t.$children$,_=e.$children$,y=e.$text$;y===null?(K1(t,e,J1),f!==null&&_!==null?qA(l,f,e,_,r):_!==null?(t.$text$!==null&&(l.textContent=""),Q1(l,null,e,_,0,_.length-1)):!r&&a_.updatable&&f!==null&&eS(f,0,f.length-1)):t.$text$!==y&&(l.data=y)},tS=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(tS)},Cy=(t,e,r)=>t?.insertBefore(e,r),HA=(t,e,r=!1)=>{const l=t.$hostElement$,f=t.$cmpMeta$,_=t.$vnode$||Uv(null,null),d=$A(e)?e:ky(null,null,e);if(Ex=l.tagName,f.$attrsToReflect$&&(d.$attrs$=d.$attrs$||{},f.$attrsToReflect$.map(([A,I])=>d.$attrs$[I]=l[A])),r&&d.$attrs$)for(const A of Object.keys(d.$attrs$))l.hasAttribute(A)&&!["key","ref","style","class"].includes(A)&&(d.$attrs$[A]=l[A]);d.$tag$=null,d.$flags$|=4,t.$vnode$=d,d.$elm$=_.$elm$=l.shadowRoot||l,Yf(_,d,r)},iS=(t,e)=>{if(e&&!t.$onRenderResolve$&&e["s-p"]){const r=e["s-p"].push(new Promise(l=>t.$onRenderResolve$=()=>{e["s-p"].splice(r-1,1),l()}))}},kx=(t,e)=>{if(t.$flags$|=16,t.$flags$&4){t.$flags$|=512;return}return iS(t,t.$ancestorComponent$),AA(()=>ZA(t,e))},ZA=(t,e)=>{const r=t.$hostElement$,l=tf("scheduleUpdate",t.$cmpMeta$.$tagName$),f=r;if(!f)throw new Error(`Can't render component <${r.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let _;return e?_=ap(f,"componentWillLoad",void 0,r):_=ap(f,"componentWillUpdate",void 0,r),_=Jb(_,()=>ap(f,"componentWillRender",void 0,r)),l(),Jb(_,()=>WA(t,f,e))},Jb=(t,e)=>GA(t)?t.then(e).catch(r=>{console.error(r),e()}):e(),GA=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",WA=async(t,e,r)=>{var l;const f=t.$hostElement$,_=tf("update",t.$cmpMeta$.$tagName$),y=f["s-rc"];r&&BA(t);const d=tf("render",t.$cmpMeta$.$tagName$);YA(t,e,f,r),y&&(y.map(A=>A()),f["s-rc"]=void 0),d(),_();{const A=(l=f["s-p"])!=null?l:[],I=()=>XA(t);A.length===0?I():(Promise.all(A).then(I),t.$flags$|=4,A.length=0)}},YA=(t,e,r,l)=>{try{e=e.render(),t.$flags$&=-17,t.$flags$|=2,HA(t,e,l)}catch(f){o_(f,t.$hostElement$)}return null},XA=t=>{const e=t.$cmpMeta$.$tagName$,r=t.$hostElement$,l=tf("postUpdate",e),f=r,_=t.$ancestorComponent$;ap(f,"componentDidRender",void 0,r),t.$flags$&64?(ap(f,"componentDidUpdate",void 0,r),l()):(t.$flags$|=64,JA(r),ap(f,"componentDidLoad",void 0,r),l(),t.$onReadyResolve$(r),_||KA()),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),t.$flags$&512&&wx(()=>kx(t,!1)),t.$flags$&=-517},KA=t=>{wx(()=>UA(Mc,"appload",{detail:{namespace:xA}}))},ap=(t,e,r,l)=>{if(t&&t[e])try{return t[e](r)}catch(f){o_(f,l)}},JA=t=>{var e;return t.classList.add((e=a_.hydratedSelectorName)!=null?e:"hydrated")},QA=(t,e)=>ef(t).$instanceValues$.get(e),Qb=(t,e,r,l)=>{const f=ef(t),_=t,y=f.$instanceValues$.get(e),d=f.$flags$,A=_;r=Y1(r,l.$members$[e][0]);const I=Number.isNaN(y)&&Number.isNaN(r);if(r!==y&&!I){f.$instanceValues$.set(e,r);{if(l.$watchers$&&d&128){const N=l.$watchers$[e];N&&N.map(V=>{try{A[V](r,y,e)}catch(K){o_(K,_)}})}if((d&18)===2){if(A.componentShouldUpdate&&A.componentShouldUpdate(r,y,e)===!1)return;kx(f,!1)}}}},eM=(t,e,r)=>{var l,f;const _=t.prototype;if(e.$members$||e.$watchers$||t.watchers){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers);const y=Object.entries((l=e.$members$)!=null?l:{});y.map(([d,[A]])=>{if(A&31||A&32){const{get:I,set:B}=Object.getOwnPropertyDescriptor(_,d)||{};I&&(e.$members$[d][0]|=2048),B&&(e.$members$[d][0]|=4096),Object.defineProperty(_,d,{get(){return I?I.apply(this):QA(this,d)},configurable:!0,enumerable:!0}),Object.defineProperty(_,d,{set(N){const V=ef(this);if(B){const K=A&32?this[d]:V.$hostElement$[d];typeof K>"u"&&V.$instanceValues$.get(d)?N=V.$instanceValues$.get(d):!V.$instanceValues$.get(d)&&K&&V.$instanceValues$.set(d,K),B.apply(this,[Y1(N,A)]),N=A&32?this[d]:V.$hostElement$[d],Qb(this,d,N,e);return}{Qb(this,d,N,e);return}}})}});{const d=new Map;_.attributeChangedCallback=function(A,I,B){Gh.jmp(()=>{var N;const V=d.get(A);if(!(this.hasOwnProperty(V)&&a_.lazyLoad)){if(_.hasOwnProperty(V)&&typeof this[V]=="number"&&this[V]==B)return;if(V==null){const ie=ef(this),ne=ie?.$flags$;if(ne&&!(ne&8)&&ne&128&&B!==I){const se=this,ge=(N=e.$watchers$)==null?void 0:N[A];ge?.forEach(ae=>{se[ae]!=null&&se[ae].call(se,B,I,A)})}return}}const K=Object.getOwnPropertyDescriptor(_,V);B=B===null&&typeof this[V]=="boolean"?!1:B,B!==this[V]&&(!K.get||K.set)&&(this[V]=B)})},t.observedAttributes=Array.from(new Set([...Object.keys((f=e.$watchers$)!=null?f:{}),...y.filter(([A,I])=>I[0]&15).map(([A,I])=>{var B;const N=I[1]||A;return d.set(N,A),I[0]&512&&((B=e.$attrsToReflect$)==null||B.push([A,N])),N})]))}}return t},e0=async(t,e,r,l)=>{let f;if((e.$flags$&32)===0){e.$flags$|=32;{f=t.constructor;const d=t.localName;customElements.whenDefined(d).then(()=>e.$flags$|=128)}if(f&&f.style){let d;typeof f.style=="string"&&(d=f.style);const A=G1(r);if(!Yy.has(A)){const I=tf("registerStyles",r.$tagName$);OA(A,d,!!(r.$flags$&1)),I()}}}const _=e.$ancestorComponent$,y=()=>kx(e,!0);_&&_["s-rc"]?_["s-rc"].push(y):y()},tM=(t,e)=>{},iM=t=>{{const e=ef(t),r=e.$cmpMeta$,l=tf("connectedCallback",r.$tagName$);if(e.$flags$&1)e?.$lazyInstance$||e?.$onReadyPromise$&&e.$onReadyPromise$.then(()=>tM());else{e.$flags$|=1;{let f=t;for(;f=f.parentNode||f.host;)if(f["s-p"]){iS(e,e.$ancestorComponent$=f);break}}r.$members$&&Object.entries(r.$members$).map(([f,[_]])=>{if(_&31&&t.hasOwnProperty(f)){const y=t[f];delete t[f],t[f]=y}}),a_.initializeNextTick?wx(()=>e0(t,e,r)):e0(t,e,r)}l()}},nM=async t=>{ef(t),ep.has(t)&&ep.delete(t),t.shadowRoot&&ep.has(t.shadowRoot)&&ep.delete(t.shadowRoot)},sM=(t,e)=>{const r={$flags$:e[0],$tagName$:e[1]};r.$members$=e[2],r.$watchers$=t.$watchers$,r.$attrsToReflect$=[];const l=t.prototype.connectedCallback,f=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__hasHostListenerAttached:!1,__registerHost(){SA(this,r)},connectedCallback(){this.__hasHostListenerAttached||(ef(this),this.__hasHostListenerAttached=!0),iM(this),l&&l.call(this)},disconnectedCallback(){nM(this),f&&f.call(this)},__attachShadow(){if(!this.shadowRoot)DA.call(this,r);else if(this.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${r.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}),t.is=r.$tagName$,eM(t,r)};let q_;const rM=()=>{if(typeof window>"u")return new Map;if(!q_){const t=window;t.Ionicons=t.Ionicons||{},q_=t.Ionicons.map=t.Ionicons.map||new Map}return q_},aM=t=>{let e=H_(t.src);return e||(e=nS(t.name,t.icon,t.mode,t.ios,t.md),e?oM(e,t):t.icon&&(e=H_(t.icon),e||(e=H_(t.icon[t.mode]),e))?e:null)},oM=(t,e)=>{const r=rM().get(t);if(r)return r;try{return MA(`svg/${t}.svg`)}catch(l){console.log("e",l),console.warn(`[Ionicons Warning]: Could not load icon with name "${t}". Ensure that the icon is registered using addIcons or that the icon SVG data is passed directly to the icon component.`,e)}},nS=(t,e,r,l,f)=>(r=(r&&py(r))==="ios"?"ios":"md",l&&r==="ios"?t=py(l):f&&r==="md"?t=py(f):(!t&&e&&!sS(e)&&(t=e),Ky(t)&&(t=py(t))),!Ky(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),H_=t=>Ky(t)&&(t=t.trim(),sS(t))?t:null,sS=t=>t.length>0&&/(\/|\.)/.test(t),Ky=t=>typeof t=="string",py=t=>t.toLowerCase(),lM=(t,e=[])=>{const r={};return e.forEach(l=>{t.hasAttribute(l)&&(t.getAttribute(l)!==null&&(r[l]=t.getAttribute(l)),t.removeAttribute(l))}),r},cM=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":document?.dir.toLowerCase()==="rtl",uM=t=>{const e=document.createElement("div");e.innerHTML=t;for(let l=e.childNodes.length-1;l>=0;l--)e.childNodes[l].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[l]);const r=e.firstElementChild;if(r&&r.nodeName.toLowerCase()==="svg"){const l=r.getAttribute("class")||"";if(r.setAttribute("class",(l+" s-ion-icon").trim()),rS(r))return e.innerHTML}return""},rS=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const r=t.attributes[e].name;if(Ky(r)&&r.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!rS(t.childNodes[e]))return!1}return!0},hM=t=>t.startsWith("data:image/svg+xml"),dM=t=>t.indexOf(";utf8,")!==-1,op=new Map,aS=new Map;let Z_;function Fv(t){return op.set(t,""),""}const fM=(t,e)=>{const r=aS.get(t);return r||(typeof fetch<"u"&&typeof document<"u"?hM(t)&&dM(t)?Promise.resolve(pM(t)):mM(t,e):Promise.resolve(Fv(t)))};function pM(t){Z_||(Z_=new DOMParser);const r=Z_.parseFromString(t,"text/html").querySelector("svg");if(r)return op.set(t,r.outerHTML),r.outerHTML;throw new Error(`Could not parse svg from ${t}`)}function mM(t,e){const r=fetch(t).then(l=>l.text().then(f=>{f&&e!==!1&&(f=uM(f));const _=f||"";return op.set(t,_),_}).catch(()=>Fv(t))).catch(()=>Fv(t));return aS.set(t,r),r}const gM=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{transform:scaleX(1)}}:host(.icon-small){font-size:1.125rem !important}:host(.icon-large){font-size:2rem !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",yM=sM(class extends EA{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.didLoadIcon=!1,this.isVisible=!1,this.mode=_M(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=lM(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}componentDidLoad(){this.didLoadIcon||this.loadIcon()}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,r,l){if(!!!(this.lazy&&typeof window<"u"&&window.IntersectionObserver))return l();const _=this.io=new window.IntersectionObserver(y=>{y[0].isIntersecting&&(_.disconnect(),this.io=void 0,l())},{rootMargin:r});_.observe(e)}loadIcon(){if(this.isVisible){const e=aM(this);e&&(op.has(e)?this.svgContent=op.get(e):fM(e,this.sanitize).then(()=>this.svgContent=op.get(e)),this.didLoadIcon=!0)}this.iconName=nS(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:r,inheritedAttributes:l,el:f}=this,_=this.mode||"md",y=r?(r.includes("arrow")||r.includes("chevron"))&&e!==!1:!1,d=e||y;return ky(W1,Object.assign({key:"0578c899781ca145dd8205acd9670af39b57cf2e",role:"img",class:Object.assign(Object.assign({[_]:!0},vM(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":d,"icon-rtl":d&&cM(f)})},l),this.svgContent?ky("div",{class:"icon-inner",innerHTML:this.svgContent}):ky("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return gM}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},void 0,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]),_M=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",vM=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function xM(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{e==="ion-icon"&&(customElements.get(e)||customElements.define(e,yM))})}const bM=xM,l_=Nt.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{},cleanupIonViewWillEnter:()=>{},cleanupIonViewDidEnter:()=>{},cleanupIonViewWillLeave:()=>{},cleanupIonViewDidLeave:()=>{}}),wM=class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[],this.ionViewWillEnterDestructorCallbacks=[],this.ionViewDidEnterDestructorCallbacks=[],this.ionViewWillLeaveDestructorCallbacks=[],this.ionViewDidLeaveDestructorCallbacks=[]}onIonViewWillEnter(t){if(t.id){const e=this.ionViewWillEnterCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewWillEnterCallbacks[e]=t:this.ionViewWillEnterCallbacks.push(t)}else this.ionViewWillEnterCallbacks.push(t)}teardownCallback(t,e){const r=e.filter(l=>l.id===t.id);r.length!==0&&(r.forEach(l=>{l&&typeof l.destructor=="function"&&l.destructor()}),e=e.filter(l=>l.id!==t.id))}cleanupIonViewWillEnter(t){this.teardownCallback(t,this.ionViewWillEnterDestructorCallbacks)}cleanupIonViewDidEnter(t){this.teardownCallback(t,this.ionViewDidEnterDestructorCallbacks)}cleanupIonViewWillLeave(t){this.teardownCallback(t,this.ionViewWillLeaveDestructorCallbacks)}cleanupIonViewDidLeave(t){this.teardownCallback(t,this.ionViewDidLeaveDestructorCallbacks)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewWillEnterDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewDidEnter(t){if(t.id){const e=this.ionViewDidEnterCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewDidEnterCallbacks[e]=t:this.ionViewDidEnterCallbacks.push(t)}else this.ionViewDidEnterCallbacks.push(t)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewDidEnterDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewWillLeave(t){if(t.id){const e=this.ionViewWillLeaveCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewWillLeaveCallbacks[e]=t:this.ionViewWillLeaveCallbacks.push(t)}else this.ionViewWillLeaveCallbacks.push(t)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewWillLeaveDestructorCallbacks.push({id:t.id,destructor:e})})}onIonViewDidLeave(t){if(t.id){const e=this.ionViewDidLeaveCallbacks.findIndex(r=>r.id===t.id);e>-1?this.ionViewDidLeaveCallbacks[e]=t:this.ionViewDidLeaveCallbacks.push(t)}else this.ionViewDidLeaveCallbacks.push(t)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach(t=>{const e=t();t.id&&this.ionViewDidLeaveDestructorCallbacks.push({id:t.id,destructor:e})}),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(t){this.componentCanBeDestroyedCallback=t}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},SM=(t,e=[])=>{const r=te.useContext(l_),l=te.useRef();l.current=l.current||Math.floor(Math.random()*1e6),te.useEffect(()=>(t.id=l.current,r.onIonViewDidEnter(t),()=>{r.cleanupIonViewDidEnter(t)}),e)},gu=Nt.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:t=>{typeof window<"u"&&(typeof t=="string"?window.location.pathname=t:window.history.back())},navigate:t=>{typeof window<"u"&&(window.location.pathname=t)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)},resetTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)}}),oS=t=>t.toLowerCase().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(""),Cx=t=>t.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`),Ax=(t,e,r={})=>{if(t instanceof Element){const l=TM(t.classList,e,r);l!==""&&(t.className=l),Object.keys(e).forEach(f=>{if(!(f==="children"||f==="style"||f==="ref"||f==="class"||f==="className"||f==="forwardedRef"))if(f.indexOf("on")===0&&f[2]===f[2].toUpperCase()){const _=f.substring(2),y=_[0].toLowerCase()+_.substring(1);c_(y)||kM(t,y,e[f])}else t[f]=e[f],typeof e[f]==="string"&&t.setAttribute(Cx(f),e[f])})}},TM=(t,e,r)=>{const l=e.className||e.class,f=r.className||r.class,_=G_(t),y=G_(l?l.split(" "):[]),d=G_(f?f.split(" "):[]),A=[];return _.forEach(I=>{y.has(I)?(A.push(I),y.delete(I)):d.has(I)||A.push(I)}),y.forEach(I=>A.push(I)),A.join(" ")},EM=t=>t==="doubleclick"?"dblclick":t;const c_=t=>{if(typeof document>"u")return!0;{const e="on"+EM(t);let r=e in document;if(!r){const l=document.createElement("div");l.setAttribute(e,"return;"),r=typeof l[e]=="function"}return r}},kM=(t,e,r)=>{const l=t.__events||(t.__events={}),f=l[e];f&&t.removeEventListener(e,f),t.addEventListener(e,l[e]=function(y){r&&r.call(this,y)})},G_=t=>{const e=new Map;return t.forEach(r=>e.set(r,r)),e},CM=(t,e)=>{typeof t=="function"?t(e):t!=null&&(t.current=e)},Mx=(...t)=>e=>{t.forEach(r=>{CM(r,e)})},AM=(t,e)=>{const r=(l,f)=>S.jsx(t,{...l,forwardedRef:f});return r.displayName=e,Nt.forwardRef(r)},Pc=(t,e,r,l)=>{l!==void 0&&l();const f=oS(t),_=class extends Nt.Component{constructor(y){super(y),this.setComponentElRef=d=>{this.componentEl=d}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(y){Ax(this.componentEl,this.props,y)}render(){const{children:y,forwardedRef:d,style:A,className:I,ref:B,...N}=this.props,K={...Object.keys(N).reduce((ie,ne)=>{const ve=N[ne];if(ne.indexOf("on")===0&&ne[2]===ne[2].toUpperCase()){const se=ne.substring(2).toLowerCase();typeof document<"u"&&c_(se)&&(ie[ne]=ve)}else{const se=typeof ve;(se==="string"||se==="boolean"||se==="number")&&(ie[Cx(ne)]=ve)}return ie},{}),ref:Mx(d,this.setComponentElRef),style:A};return te.createElement(t,K,y)}static get displayName(){return f}};return AM(_,f)},Pl=Pc("ion-content",void 0,void 0,$k),Ws=Pc("ion-spinner",void 0,void 0,EC),MM=Pc("ion-tab",void 0,void 0,MC),fp=(t,e)=>{const r=(l,f)=>S.jsx(t,{...l,forwardedRef:f});return r.displayName=e,Nt.forwardRef(r)},Px=()=>{if(typeof window<"u"){const t=window.Ionic;if(t&&t.config)return t.config}return null},PM=(t,e)=>{t instanceof Element&&Object.keys(e).forEach(r=>{if(r.indexOf("on")===0&&r[2]===r[2].toUpperCase()){const l=r.substring(2),f=l[0].toLowerCase()+l.substring(1);c_(f)||IM(t,f)}})},IM=(t,e)=>{const r=t.__events||(t.__events={}),l=r[e];l&&(t.removeEventListener(e,l),r[e]=void 0)},jM=(t,e,r)=>{e&&e();const l=oS(t),f=class extends Nt.Component{constructor(_){super(_),this.handleIonMount=()=>{this.setState({isOpen:!0})},this.handleWillPresent=y=>{this.setState({isOpen:!0}),this.props.onWillPresent&&this.props.onWillPresent(y)},this.handleDidDismiss=y=>{const d=this.wrapperRef.current,A=this.ref.current;d&&A&&(A.append(d),this.setState({isOpen:!1})),this.props.onDidDismiss&&this.props.onDidDismiss(y)},this.ref=Nt.createRef(),this.stableMergedRefs=Mx(this.ref,this.props.forwardedRef),this.state={isOpen:!1},this.wrapperRef=Nt.createRef()}componentDidMount(){this.componentDidUpdate(this.props),this.ref.current?.addEventListener("ionMount",this.handleIonMount),this.ref.current?.addEventListener("willPresent",this.handleWillPresent),this.ref.current?.addEventListener("didDismiss",this.handleDidDismiss)}componentDidUpdate(_){const y=this.ref.current,{onDidDismiss:d,onWillPresent:A,...I}=this.props;Ax(y,I,_)}componentWillUnmount(){const _=this.ref.current;_&&this.state.isOpen&&(_.removeEventListener("didDismiss",this.handleDidDismiss),_.remove(),PM(_,this.props))}render(){const{children:_,forwardedRef:y,style:d,className:A,ref:I,...B}=this.props,V={...Object.keys(B).reduce((ie,ne)=>{if(ne.indexOf("on")===0&&ne[2]===ne[2].toUpperCase()){const ve=ne.substring(2).toLowerCase();c_(ve)&&(ie[ne]=B[ne])}else["string","boolean","number"].includes(typeof B[ne])&&(ie[Cx(ne)]=B[ne]);return ie},{}),ref:this.stableMergedRefs,style:d},K=()=>r?`${t0} ion-page`:t0;return te.createElement("template",{},te.createElement(t,V,this.state.isOpen||this.props.keepContentsMounted?te.createElement("div",{ref:this.wrapperRef,className:K()},_):null))}static get displayName(){return l}};return fp(f,l)},t0="ion-delegate-host",$m=jM("ion-modal",qC,!0),LM=Nt.createContext({addOverlay:()=>{},removeOverlay:()=>{}}),zM=({onAddOverlay:t,onRemoveOverlay:e})=>{const[r,l]=te.useState({}),f=te.useRef({});te.useEffect(()=>{t(_),e(y)},[]);const _=(A,I,B)=>{const N={...f.current};N[A]={component:I,containerElement:B},f.current=N,l(N)},y=A=>{const I={...f.current};delete I[A],f.current=I,l(I)},d=Object.keys(r);return S.jsx(S.Fragment,{children:d.map(A=>{const I=r[A];return ak.createPortal(I.component,I.containerElement,`overlay-${A}`)})})},RM=Pc("ion-tab-button",void 0,void 0,mA),DM=Pc("ion-tab-bar",void 0,void 0,uA),i0=Pc("ion-tabs",void 0,void 0,vA),OM=Pc("ion-back-button",void 0,void 0,tA),Vv=Pc("ion-router-outlet",void 0,void 0,rA),NM=Pc("ion-app",void 0,void 0,XC),BM=Pc("ion-icon",void 0,void 0,bM);class lS extends Nt.Component{constructor(e){super(e),this.ionContext={addOverlay:(r,l,f)=>{this.addOverlayCallback&&this.addOverlayCallback(r,l,f)},removeOverlay:r=>{this.removeOverlayCallback&&this.removeOverlayCallback(r)}}}render(){return S.jsxs(LM.Provider,{value:this.ionContext,children:[S.jsx(NM,{...this.props,children:this.props.children}),S.jsx(zM,{onAddOverlay:e=>{this.addOverlayCallback=e},onRemoveOverlay:e=>{this.removeOverlayCallback=e}})]})}}lS.displayName="IonApp";const Ix=Nt.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class jx extends Nt.PureComponent{constructor(e){super(e),this.ionPageElementRef=Nt.createRef(),this.stableMergedRefs=Mx(this.ionPageElementRef,this.props.forwardedRef),this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const{className:e,children:r,routeInfo:l,forwardedRef:f,..._}=this.props;return S.jsx(l_.Consumer,{children:y=>(this.ionLifeCycleContext=y,S.jsx("div",{className:e?`${e} ion-page`:"ion-page",ref:this.stableMergedRefs,..._,children:r}))})}static get contextType(){return Ix}}class $M extends Nt.Component{constructor(e){super(e)}render(){const{className:e,children:r,forwardedRef:l,...f}=this.props;return this.context.hasIonicRouter()?S.jsx(jx,{className:e?`${e}`:"",routeInfo:this.context.routeInfo,forwardedRef:l,...f,children:r}):S.jsx("div",{className:e?`ion-page ${e}`:"ion-page",ref:l,...f,children:r})}static get displayName(){return"IonPage"}static get contextType(){return gu}}const Zh=fp($M,"IonPage"),n0={main:0},Um=(t="main")=>{const e=(n0[t]??0)+1;return n0[t]=e,e.toString()},UM=(t,e)=>{const r=new WeakMap,l=`react-delegate-${Um()}`;let f=0;return{attachViewToDom:async(d,A,I,B)=>{const N=document.createElement("div");B&&N.classList.add(...B),d.appendChild(N);const V=A(I),K=`${l}-${f++}`,ie=b1.createPortal(V,N,K);return r.set(N,ie),t(ie),Promise.resolve(N)},removeViewFromDom:(d,A)=>{const I=r.get(A);return I&&e(I),A.remove(),Promise.resolve()}}},FM=Pc("ion-nav",void 0,void 0,iC),VM=({children:t,forwardedRef:e,...r})=>{const[l,f]=te.useState([]),_=A=>f(I=>[...I,A]),y=A=>f(I=>I.filter(B=>B!==A)),d=te.useMemo(()=>UM(_,y),[]);return S.jsx(FM,{delegate:d,ref:e,...r,children:l})};fp(VM,"IonNav");const cS=Nt.createContext({activeTab:void 0,selectTab:()=>!1,hasRouterOutlet:!1,tabBarProps:{ref:Nt.createRef()}}),qM=typeof HTMLElement<"u"?HTMLElement:class{};class HM extends Nt.Component{constructor(e){super(e),this.outletIsReady=!1,this.ionViewWillEnterHandler=this.ionViewWillEnterHandler.bind(this),this.ionViewDidEnterHandler=this.ionViewDidEnterHandler.bind(this),this.ionViewWillLeaveHandler=this.ionViewWillLeaveHandler.bind(this),this.ionViewDidLeaveHandler=this.ionViewDidLeaveHandler.bind(this)}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||Jd(this.ionRouterOutlet,()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)}),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const{StackManager:e,children:r,routeInfo:l,...f}=this.props;return S.jsx(l_.Consumer,{children:_=>(this.ionLifeCycleContext=_,S.jsx(e,{routeInfo:l,children:S.jsx(Vv,{setRef:y=>this.ionRouterOutlet=y,...f,children:r})}))})}static get contextType(){return Ix}}class ZM extends Nt.Component{constructor(e){super(e)}render(){const e=this.context.getStackManager(),{children:r,forwardedRef:l,...f}=this.props;return this.context.hasIonicRouter()?f.ionPage?S.jsx(HM,{StackManager:e,routeInfo:this.context.routeInfo,...f,children:r}):S.jsx(e,{routeInfo:this.context.routeInfo,children:S.jsx(Vv,{...f,forwardedRef:l,children:r})}):S.jsx(Vv,{ref:l,...this.props,children:this.props.children})}static get contextType(){return gu}}const tp=fp(ZM,"IonRouterOutlet");class GM extends qM{constructor(){super()}}typeof window<"u"&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",GM));class WM extends Nt.Component{shouldComponentUpdate(){return!0}constructor(e){super(e),this.routerOutletRef=Nt.createRef(),this.tabBarRef=Nt.createRef(),this.ionTabContextState={activeTab:void 0,selectTab:()=>!1,hasRouterOutlet:!1,tabBarProps:{ref:this.tabBarRef}}}componentDidMount(){this.tabBarRef.current&&(this.ionTabContextState.activeTab=this.tabBarRef.current.state.activeTab,this.tabBarRef.current.setActiveTabOnContext=e=>{this.ionTabContextState.activeTab=e},this.ionTabContextState.selectTab=this.tabBarRef.current.selectTab)}renderTabsInner(e,r){return S.jsx(i0,{...this.props,children:Nt.Children.map(e,l=>Nt.isValidElement(l)&&(l.type===tp||l.type.isRouterOutlet||l.type===te.Fragment&&l.props.children[0].type===tp)?r:l)})}render(){let e,r=!1;const{className:l,onIonTabsDidChange:f,onIonTabsWillChange:_,...y}=this.props,d=typeof this.props.children=="function"?this.props.children(this.ionTabContextState):this.props.children;if(Nt.Children.forEach(d,A=>{if(A==null||typeof A!="object"||!A.hasOwnProperty("type"))return;A.type===tp||A.type.isRouterOutlet?e=Nt.cloneElement(A):A.type===te.Fragment&&A.props.children[0].type===tp?e=Nt.cloneElement(A.props.children[0]):A.type===MM&&(r=!0),this.ionTabContextState.hasRouterOutlet=!!e;let I={...this.ionTabContextState.tabBarProps};f!==void 0&&(I={...I,onIonTabsDidChange:f}),_!==void 0&&(I={...I,onIonTabsWillChange:_}),this.ionTabContextState.tabBarProps=I}),!e&&!r)throw new Error("IonTabs must contain an IonRouterOutlet or an IonTab");if(e&&r)throw new Error("IonTabs cannot contain an IonRouterOutlet and an IonTab at the same time");return r?S.jsx(i0,{...this.props}):S.jsx(cS.Provider,{value:this.ionTabContextState,children:this.context.hasIonicRouter()?S.jsx(jx,{className:l?`${l}`:"",routeInfo:this.context.routeInfo,...y,children:this.renderTabsInner(d,e)}):this.renderTabsInner(d,e)})}static get contextType(){return gu}}class Zd extends Nt.Component{shouldComponentUpdate(){return!0}constructor(e){super(e),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const{onClick:e,...r}=this.props;return S.jsx(RM,{onIonTabButtonClick:this.handleIonTabButtonClick,...r})}static get displayName(){return"IonTabButton"}}const s0=(t,e)=>{if(e===void 0)return!1;const r=e.endsWith("/")&&e!=="/"?e.slice(0,-1):e;return t===r||t.startsWith(r+"/")};class YM extends Nt.PureComponent{constructor(e){super(e),this.setActiveTabOnContext=l=>{};const r={};Nt.Children.forEach(e.children,l=>{l!=null&&typeof l=="object"&&l.props&&(l.type===Zd||l.type.isTabButton)&&(r[l.props.tab]={originalHref:l.props.href,currentHref:l.props.href,originalRouteOptions:l.props.href===e.routeInfo?.pathname?e.routeInfo?.routeOptions:void 0,currentRouteOptions:l.props.href===e.routeInfo?.pathname?e.routeInfo?.routeOptions:void 0})}),this.state={tabs:r},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const e=this.state.tabs,l=Object.keys(e).find(f=>{const _=e[f].originalHref;return s0(this.props.routeInfo.pathname,_)});l&&this.setState({activeTab:l})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(e){const r=this.state.tabs[e];return r?(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:r.currentHref,tab:e,selected:e===this.state.activeTab,routeOptions:void 0}})),!0):!1}static getDerivedStateFromProps(e,r){const l={...r.tabs},_=Object.keys(r.tabs).find(d=>{const A=r.tabs[d].originalHref;return s0(e.routeInfo.pathname,A)});Nt.Children.forEach(e.children,d=>{if(d!=null&&typeof d=="object"&&d.props&&(d.type===Zd||d.type.isTabButton)){const A=l[d.props.tab];(!A||A.originalHref!==d.props.href)&&(l[d.props.tab]={originalHref:d.props.href,currentHref:d.props.href,originalRouteOptions:d.props.routeOptions,currentRouteOptions:d.props.routeOptions})}});const{activeTab:y}=r;if(_&&y){const d=r.tabs[y].currentHref,A=r.tabs[y].currentRouteOptions;(_!==y||d!==e.routeInfo?.pathname||A!==e.routeInfo?.routeOptions)&&(l[_]={originalHref:l[_].originalHref,currentHref:e.routeInfo.pathname+(e.routeInfo.search||""),originalRouteOptions:l[_].originalRouteOptions,currentRouteOptions:e.routeInfo?.routeOptions},e.routeInfo.routeAction==="pop"&&_!==y&&(l[y]={originalHref:l[y].originalHref,currentHref:l[y].originalHref,originalRouteOptions:l[y].originalRouteOptions,currentRouteOptions:l[y].currentRouteOptions}))}return _&&e.onSetCurrentTab(_,e.routeInfo),{activeTab:_,tabs:l}}onTabButtonClick(e,r){const l=this.state.tabs[e.detail.tab],f=l.originalHref,_=this.props.tabsContext?.hasRouterOutlet,y=_?e.detail.href:"",{activeTab:d}=this.state;r&&r(e),d===e.detail.tab?f!==y&&this.context.resetTab(e.detail.tab,f,l.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:e.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:e.detail.tab}})),_&&(this.setActiveTabOnContext(e.detail.tab),this.context.changeTab(e.detail.tab,y,e.detail.routeOptions)))}renderTabButton(e){return r=>{if(r!=null&&r.props&&(r.type===Zd||r.type.isTabButton)){const l=r.props.tab===e?this.props.routeInfo?.pathname:this.state.tabs[r.props.tab].currentHref,f=r.props.tab===e?this.props.routeInfo?.routeOptions:this.state.tabs[r.props.tab].currentRouteOptions;return Nt.cloneElement(r,{href:l,routeOptions:f,onClick:_=>this.onTabButtonClick(_,r.props.onClick)})}return null}}render(){const{activeTab:e}=this.state;return S.jsx(DM,{...this.props,selectedTab:e,children:Nt.Children.map(this.props.children,this.renderTabButton(e))})}static get contextType(){return gu}}const XM=Nt.memo(({forwardedRef:t,...e})=>{const r=te.useContext(gu),l=te.useContext(cS),f=t||l.tabBarProps.ref,_={...l.tabBarProps,ref:f};return S.jsx(YM,{ref:f,...e,routeInfo:e.routeInfo||r.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:r.setCurrentTab,tabsContext:{...l,tabBarProps:_},children:e.children})}),KM=fp(XM,"IonTabBar");class XD extends Nt.Component{constructor(){super(...arguments),this.clickButton=e=>{if(e.target&&e.target.closest("ion-nav")!==null)return;const{defaultHref:r,routerAnimation:l}=this.props;this.context.hasIonicRouter()?(e.stopPropagation(),this.context.goBack(r,l)):r!==void 0&&(window.location.href=r)}}render(){return S.jsx(OM,{onClick:this.clickButton,...this.props})}static get displayName(){return"IonBackButton"}static get contextType(){return gu}shouldComponentUpdate(){return!0}}class JM extends Nt.PureComponent{constructor(e){super(e),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){const{icon:e,ios:r,md:l,mode:f,..._}=this.props;let y;const d=Px(),A=f||d?.get("mode");return r||l?A==="ios"?y=r??l??e:y=l??r??e:y=e,S.jsx(BM,{ref:this.props.forwardedRef,icon:y,..._,children:this.props.children})}static get contextType(){return gu}}fp(JM,"IonIcon");class Lx extends Nt.PureComponent{render(){const e=this.context.getIonRoute();return!this.context.hasIonicRouter()||!Lx?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null):S.jsx(e,{...this.props})}static get contextType(){return gu}}class uS extends Nt.PureComponent{render(){const e=this.context.getIonRedirect();return!this.context.hasIonicRouter()||!uS?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRedirect>"),null):S.jsx(e,{...this.props})}static get contextType(){return gu}}const hS=Nt.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});function QM(){const t=te.useContext(hS);return te.useMemo(()=>({back:t.back,push:t.push,goBack:t.back,canGoBack:t.canGoBack,routeInfo:t.routeInfo}),[t.back,t.push,t.canGoBack,t.routeInfo])}class KD extends Nt.PureComponent{constructor(e){super(e),this.nodes=new Map,this.animation=_n(e.id)}setupAnimation(e){const r=this.animation;this.nodes.size>0&&r.addElement(Array.from(this.nodes.values())),r0(r,e),a0(r,e)}componentDidMount(){const e=this.props;this.setupAnimation(e)}componentDidUpdate(e){const r=this.animation,l=this.props;r0(r,l,e),eP(r,l,e),a0(r,l,e)}render(){const{children:e}=this.props;return S.jsx(S.Fragment,{children:Nt.Children.map(e,(r,l)=>Nt.cloneElement(r,{ref:f=>this.nodes.set(l,f)}))})}}const r0=(t,e={},r={})=>{const l=["children","progressStart","progressStep","progressEnd","pause","stop","destroy","play","from","to","fromTo","onFinish"];for(const A in e)e.hasOwnProperty(A)&&!l.includes(A)&&e[A]!==r[A]&&t[A](e[A]);const f=e.from;f&&f!==r.from&&(Array.isArray(f)?f:[f]).forEach(I=>t.from(I.property,I.value));const _=e.to;_&&_!==r.to&&(Array.isArray(_)?_:[_]).forEach(I=>t.to(I.property,I.value));const y=e.fromTo;y&&y!==r.fromTo&&(Array.isArray(y)?y:[y]).forEach(I=>t.fromTo(I.property,I.fromValue,I.toValue));const d=e.onFinish;d&&d!==r.onFinish&&(Array.isArray(d)?d:[d]).forEach(I=>t.onFinish(I.callback,I.opts))},eP=(t,e={},r={})=>{const{progressStart:l,progressStep:f,progressEnd:_}=e;l&&(r.progressStart?.forceLinearEasing!==l?.forceLinearEasing||r.progressStart?.step!==l?.step)&&t.progressStart(l.forceLinearEasing,l.step),f&&r.progressStep?.step!==f?.step&&t.progressStep(f.step),_&&(r.progressEnd?.playTo!==_?.playTo||r.progressEnd?.step!==_?.step||r?.dur!==_?.dur)&&t.progressEnd(_.playTo,_.step,_.dur)},a0=(t,e={},r={})=>{!r.play&&e.play&&t.play(),!r.pause&&e.pause&&t.pause(),!r.stop&&e.stop&&t.stop(),!r.destroy&&e.destroy&&t.destroy()};function tP(t,e,r){const l=te.useRef(),f=te.useMemo(()=>`on${t}DidDismiss`,[t]),_=te.useMemo(()=>`on${t}DidPresent`,[t]),y=te.useMemo(()=>`on${t}WillDismiss`,[t]),d=te.useMemo(()=>`on${t}WillPresent`,[t]);r();const A=te.useCallback(async B=>{if(l.current)return;const{onDidDismiss:N,onWillDismiss:V,onDidPresent:K,onWillPresent:ie,...ne}=B,ve=se=>{N&&N(se),l.current=void 0};l.current=await e.create({...ne}),Ax(l.current,{[f]:ve,[_]:se=>K&&K(se),[y]:se=>V&&V(se),[d]:se=>ie&&ie(se)}),l.current.present()},[e]),I=te.useCallback(async()=>{l.current&&await l.current.dismiss(),l.current=void 0},[]);return{present:A,dismiss:I}}function iP(){const t=tP("IonToast",WE,VC);return[te.useCallback((r,l)=>typeof r=="string"?t.present({message:r,duration:l}):t.present(r),[t.present]),t.dismiss]}const nP=(t={})=>{typeof document<"u"&&document.documentElement.classList.add("ion-ce"),jE({...t})},dS=Nt.createContext({addViewItem:()=>{},canGoBack:()=>{},clearOutlet:()=>{},createViewItem:()=>{},findViewItemByPathname:()=>{},findLeavingViewItemByRouteInfo:()=>{},findViewItemByRouteInfo:()=>{},getChildrenToRender:()=>{},goBack:()=>{},unMountViewItem:()=>{}});class o0 extends Nt.Component{constructor(e){super(e),this.ionLifeCycleContext=new wM,this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed(()=>{this.props.mount||this._isMounted&&this.setState({show:!1},()=>this.props.removeView())}),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:e}=this.state;return S.jsx(l_.Provider,{value:this.ionLifeCycleContext,children:e&&this.props.children})}}class sP{constructor(){this.locationHistory=[],this.tabHistory={}}add(e){e.routeAction==="push"||e.routeAction==null?this._add(e):e.routeAction==="pop"?this._pop(e):e.routeAction==="replace"&&this._replace(e),e.routeDirection==="root"&&(this._clear(),this._add(e))}clearTabStack(e){const r=this._getRouteInfosByKey(e);r&&(r.forEach(l=>{this.locationHistory=this.locationHistory.filter(f=>f.id!==l.id)}),this.tabHistory[e]=[])}update(e){const r=this.locationHistory.findIndex(f=>f.id===e.id);r>-1&&this.locationHistory.splice(r,1,e);const l=this.tabHistory[e.tab||""];if(l){const f=l.findIndex(_=>_.id===e.id);f>-1?l.splice(f,1,e):l.push(e)}else e.tab&&(this.tabHistory[e.tab]=[e])}_add(e){const r=this._getRouteInfosByKey(e.tab);r&&(this._areRoutesEqual(r[r.length-1],e)&&r.pop(),r.push(e)),this.locationHistory.push(e)}_areRoutesEqual(e,r){return!e||!r?!1:e.pathname===r.pathname&&e.search===r.search}_pop(e){const r=this._getRouteInfosByKey(e.tab);r&&(r.pop(),r.pop(),r.push(e)),this.locationHistory.pop(),this.locationHistory.pop(),this.locationHistory.push(e)}_replace(e){const r=this._getRouteInfosByKey(e.tab);r&&r.pop(),this.locationHistory.pop(),this._add(e)}_clear(){Object.keys(this.tabHistory).forEach(r=>this.tabHistory[r]=[]),this.locationHistory=[]}_getRouteInfosByKey(e){let r;return e&&(r=this.tabHistory[e],r||(r=this.tabHistory[e]=[])),r}getFirstRouteInfoForTab(e){const r=this._getRouteInfosByKey(e);if(r)return r[0]}getCurrentRouteInfoForTab(e){const r=this._getRouteInfosByKey(e);if(r)return r[r.length-1]}findLastLocation(e){const r=this._getRouteInfosByKey(e.tab);if(r)for(let l=r.length-2;l>=0;l--){const f=r[l];if(f&&f.pathname===e.pushedByRoute)return f}for(let l=this.locationHistory.length-2;l>=0;l--){const f=this.locationHistory[l];if(f&&f.pathname===e.pushedByRoute)return f}}previous(){return this.locationHistory[this.locationHistory.length-2]||this.locationHistory[this.locationHistory.length-1]}current(){return this.locationHistory[this.locationHistory.length-1]}canGoBack(){return this.locationHistory.length>1}}class rP extends Nt.PureComponent{constructor(e){super(e),this.ionRouterContextValue={push:(r,l,f,_,y)=>{this.navigate(r,l,f,y,_)},back:r=>{this.goBack(void 0,r)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){typeof document<"u"&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){typeof document<"u"&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(e){e.detail.register(0,r=>{this.nativeGoBack(),r()})}goBack(e,r){this.props.onNavigateBack(e,r)}nativeGoBack(){this.props.onNativeBack()}navigate(e,r="forward",l="push",f,_,y){this.props.onNavigate(e,l,r,f,_,y)}getPageManager(){return jx}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return S.jsx(gu.Provider,{value:{...this.state,routeInfo:this.props.routeInfo},children:S.jsx(hS.Provider,{value:{...this.ionRouterContextValue,routeInfo:this.props.routeInfo},children:this.props.children})})}}class aP{constructor(){this.viewStacks={},this.add=this.add.bind(this),this.clear=this.clear.bind(this),this.getViewItemsForOutlet=this.getViewItemsForOutlet.bind(this),this.remove=this.remove.bind(this)}add(e){const{outletId:r}=e;this.viewStacks[r]?this.viewStacks[r].push(e):this.viewStacks[r]=[e]}clear(e){return setTimeout(()=>{delete this.viewStacks[e]},500)}getViewItemsForOutlet(e){return this.viewStacks[e]||[]}remove(e){const{outletId:r}=e,l=this.viewStacks[r];if(l){const f=l.find(_=>_.id===e.id);f&&(f.mount=!1,this.viewStacks[r]=l.filter(_=>_.id!==f.id))}}getStackIds(){return Object.keys(this.viewStacks)}getAllViewItems(){const e=this.getStackIds(),r=[];return e.forEach(l=>{r.push(...this.viewStacks[l])}),r}}function Xu(t,e){var r={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(r[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(t);f<l.length;f++)e.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(t,l[f])&&(r[l[f]]=t[l[f]]);return r}function oP(t,e,r,l){function f(_){return _ instanceof r?_:new r(function(y){y(_)})}return new(r||(r=Promise))(function(_,y){function d(B){try{I(l.next(B))}catch(N){y(N)}}function A(B){try{I(l.throw(B))}catch(N){y(N)}}function I(B){B.done?_(B.value):f(B.value).then(d,A)}I((l=l.apply(t,e||[])).next())})}function Zo(){return Zo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var l in r)({}).hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Zo.apply(null,arguments)}function my(t){return t.charAt(0)==="/"}function W_(t,e){for(var r=e,l=r+1,f=t.length;l<f;r+=1,l+=1)t[r]=t[l];t.pop()}function lP(t,e){e===void 0&&(e="");var r=t&&t.split("/")||[],l=e&&e.split("/")||[],f=t&&my(t),_=e&&my(e),y=f||_;if(t&&my(t)?l=r:r.length&&(l.pop(),l=l.concat(r)),!l.length)return"/";var d;if(l.length){var A=l[l.length-1];d=A==="."||A===".."||A===""}else d=!1;for(var I=0,B=l.length;B>=0;B--){var N=l[B];N==="."?W_(l,B):N===".."?(W_(l,B),I++):I&&(W_(l,B),I--)}if(!y)for(;I--;I)l.unshift("..");y&&l[0]!==""&&(!l[0]||!my(l[0]))&&l.unshift("");var V=l.join("/");return d&&V.substr(-1)!=="/"&&(V+="/"),V}function l0(t){return t.valueOf?t.valueOf():Object.prototype.valueOf.call(t)}function Ay(t,e){if(t===e)return!0;if(t==null||e==null)return!1;if(Array.isArray(t))return Array.isArray(e)&&t.length===e.length&&t.every(function(f,_){return Ay(f,e[_])});if(typeof t=="object"||typeof e=="object"){var r=l0(t),l=l0(e);return r!==t||l!==e?Ay(r,l):Object.keys(Object.assign({},t,e)).every(function(f){return Ay(t[f],e[f])})}return!1}var cP="Invariant failed";function nf(t,e){throw new Error(cP)}function Pm(t){return t.charAt(0)==="/"?t:"/"+t}function c0(t){return t.charAt(0)==="/"?t.substr(1):t}function uP(t,e){return t.toLowerCase().indexOf(e.toLowerCase())===0&&"/?#".indexOf(t.charAt(e.length))!==-1}function fS(t,e){return uP(t,e)?t.substr(e.length):t}function pS(t){return t.charAt(t.length-1)==="/"?t.slice(0,-1):t}function hP(t){var e=t||"/",r="",l="",f=e.indexOf("#");f!==-1&&(l=e.substr(f),e=e.substr(0,f));var _=e.indexOf("?");return _!==-1&&(r=e.substr(_),e=e.substr(0,_)),{pathname:e,search:r==="?"?"":r,hash:l==="#"?"":l}}function Jl(t){var e=t.pathname,r=t.search,l=t.hash,f=e||"/";return r&&r!=="?"&&(f+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(f+=l.charAt(0)==="#"?l:"#"+l),f}function Ho(t,e,r,l){var f;typeof t=="string"?(f=hP(t),f.state=e):(f=Zo({},t),f.pathname===void 0&&(f.pathname=""),f.search?f.search.charAt(0)!=="?"&&(f.search="?"+f.search):f.search="",f.hash?f.hash.charAt(0)!=="#"&&(f.hash="#"+f.hash):f.hash="",e!==void 0&&f.state===void 0&&(f.state=e));try{f.pathname=decodeURI(f.pathname)}catch(_){throw _ instanceof URIError?new URIError('Pathname "'+f.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):_}return r&&(f.key=r),l?f.pathname?f.pathname.charAt(0)!=="/"&&(f.pathname=lP(f.pathname,l.pathname)):f.pathname=l.pathname:f.pathname||(f.pathname="/"),f}function dP(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&Ay(t.state,e.state)}function zx(){var t=null;function e(y){return t=y,function(){t===y&&(t=null)}}function r(y,d,A,I){if(t!=null){var B=typeof t=="function"?t(y,d):t;typeof B=="string"?typeof A=="function"?A(B,I):I(!0):I(B!==!1)}else I(!0)}var l=[];function f(y){var d=!0;function A(){d&&y.apply(void 0,arguments)}return l.push(A),function(){d=!1,l=l.filter(function(I){return I!==A})}}function _(){for(var y=arguments.length,d=new Array(y),A=0;A<y;A++)d[A]=arguments[A];l.forEach(function(I){return I.apply(void 0,d)})}return{setPrompt:e,confirmTransitionTo:r,appendListener:f,notifyListeners:_}}var mS=!!(typeof window<"u"&&window.document&&window.document.createElement);function gS(t,e){e(window.confirm(t))}function fP(){var t=window.navigator.userAgent;return(t.indexOf("Android 2.")!==-1||t.indexOf("Android 4.0")!==-1)&&t.indexOf("Mobile Safari")!==-1&&t.indexOf("Chrome")===-1&&t.indexOf("Windows Phone")===-1?!1:window.history&&"pushState"in window.history}function pP(){return window.navigator.userAgent.indexOf("Trident")===-1}function mP(){return window.navigator.userAgent.indexOf("Firefox")===-1}function gP(t){return t.state===void 0&&navigator.userAgent.indexOf("CriOS")===-1}var u0="popstate",h0="hashchange";function d0(){try{return window.history.state||{}}catch{return{}}}function yP(t){t===void 0&&(t={}),mS||nf();var e=window.history,r=fP(),l=!pP(),f=t,_=f.forceRefresh,y=_===void 0?!1:_,d=f.getUserConfirmation,A=d===void 0?gS:d,I=f.keyLength,B=I===void 0?6:I,N=t.basename?pS(Pm(t.basename)):"";function V(kt){var rt=kt||{},be=rt.key,Ie=rt.state,et=window.location,at=et.pathname,mt=et.search,Ct=et.hash,Ot=at+mt+Ct;return N&&(Ot=fS(Ot,N)),Ho(Ot,Ie,be)}function K(){return Math.random().toString(36).substr(2,B)}var ie=zx();function ne(kt){Zo(Fe,kt),Fe.length=e.length,ie.notifyListeners(Fe.location,Fe.action)}function ve(kt){gP(kt)||ae(V(kt.state))}function se(){ae(V(d0()))}var ge=!1;function ae(kt){if(ge)ge=!1,ne();else{var rt="POP";ie.confirmTransitionTo(kt,rt,A,function(be){be?ne({action:rt,location:kt}):me(kt)})}}function me(kt){var rt=Fe.location,be=Se.indexOf(rt.key);be===-1&&(be=0);var Ie=Se.indexOf(kt.key);Ie===-1&&(Ie=0);var et=be-Ie;et&&(ge=!0,st(et))}var ye=V(d0()),Se=[ye.key];function ze(kt){return N+Jl(kt)}function He(kt,rt){var be="PUSH",Ie=Ho(kt,rt,K(),Fe.location);ie.confirmTransitionTo(Ie,be,A,function(et){if(et){var at=ze(Ie),mt=Ie.key,Ct=Ie.state;if(r)if(e.pushState({key:mt,state:Ct},null,at),y)window.location.href=at;else{var Ot=Se.indexOf(Fe.location.key),Kt=Se.slice(0,Ot+1);Kt.push(Ie.key),Se=Kt,ne({action:be,location:Ie})}else window.location.href=at}})}function Ze(kt,rt){var be="REPLACE",Ie=Ho(kt,rt,K(),Fe.location);ie.confirmTransitionTo(Ie,be,A,function(et){if(et){var at=ze(Ie),mt=Ie.key,Ct=Ie.state;if(r)if(e.replaceState({key:mt,state:Ct},null,at),y)window.location.replace(at);else{var Ot=Se.indexOf(Fe.location.key);Ot!==-1&&(Se[Ot]=Ie.key),ne({action:be,location:Ie})}else window.location.replace(at)}})}function st(kt){e.go(kt)}function lt(){st(-1)}function Ke(){st(1)}var Mt=0;function gt(kt){Mt+=kt,Mt===1&&kt===1?(window.addEventListener(u0,ve),l&&window.addEventListener(h0,se)):Mt===0&&(window.removeEventListener(u0,ve),l&&window.removeEventListener(h0,se))}var St=!1;function Be(kt){kt===void 0&&(kt=!1);var rt=ie.setPrompt(kt);return St||(gt(1),St=!0),function(){return St&&(St=!1,gt(-1)),rt()}}function ot(kt){var rt=ie.appendListener(kt);return gt(1),function(){gt(-1),rt()}}var Fe={length:e.length,action:"POP",location:ye,createHref:ze,push:He,replace:Ze,go:st,goBack:lt,goForward:Ke,block:Be,listen:ot};return Fe}var f0="hashchange",_P={hashbang:{encodePath:function(e){return e.charAt(0)==="!"?e:"!/"+c0(e)},decodePath:function(e){return e.charAt(0)==="!"?e.substr(1):e}},noslash:{encodePath:c0,decodePath:Pm},slash:{encodePath:Pm,decodePath:Pm}};function yS(t){var e=t.indexOf("#");return e===-1?t:t.slice(0,e)}function Tm(){var t=window.location.href,e=t.indexOf("#");return e===-1?"":t.substring(e+1)}function vP(t){window.location.hash=t}function Y_(t){window.location.replace(yS(window.location.href)+"#"+t)}function xP(t){t===void 0&&(t={}),mS||nf();var e=window.history;mP();var r=t,l=r.getUserConfirmation,f=l===void 0?gS:l,_=r.hashType,y=_===void 0?"slash":_,d=t.basename?pS(Pm(t.basename)):"",A=_P[y],I=A.encodePath,B=A.decodePath;function N(){var rt=B(Tm());return d&&(rt=fS(rt,d)),Ho(rt)}var V=zx();function K(rt){Zo(kt,rt),kt.length=e.length,V.notifyListeners(kt.location,kt.action)}var ie=!1,ne=null;function ve(rt,be){return rt.pathname===be.pathname&&rt.search===be.search&&rt.hash===be.hash}function se(){var rt=Tm(),be=I(rt);if(rt!==be)Y_(be);else{var Ie=N(),et=kt.location;if(!ie&&ve(et,Ie)||ne===Jl(Ie))return;ne=null,ge(Ie)}}function ge(rt){if(ie)ie=!1,K();else{var be="POP";V.confirmTransitionTo(rt,be,f,function(Ie){Ie?K({action:be,location:rt}):ae(rt)})}}function ae(rt){var be=kt.location,Ie=ze.lastIndexOf(Jl(be));Ie===-1&&(Ie=0);var et=ze.lastIndexOf(Jl(rt));et===-1&&(et=0);var at=Ie-et;at&&(ie=!0,lt(at))}var me=Tm(),ye=I(me);me!==ye&&Y_(ye);var Se=N(),ze=[Jl(Se)];function He(rt){var be=document.querySelector("base"),Ie="";return be&&be.getAttribute("href")&&(Ie=yS(window.location.href)),Ie+"#"+I(d+Jl(rt))}function Ze(rt,be){var Ie="PUSH",et=Ho(rt,void 0,void 0,kt.location);V.confirmTransitionTo(et,Ie,f,function(at){if(at){var mt=Jl(et),Ct=I(d+mt),Ot=Tm()!==Ct;if(Ot){ne=mt,vP(Ct);var Kt=ze.lastIndexOf(Jl(kt.location)),_i=ze.slice(0,Kt+1);_i.push(mt),ze=_i,K({action:Ie,location:et})}else K()}})}function st(rt,be){var Ie="REPLACE",et=Ho(rt,void 0,void 0,kt.location);V.confirmTransitionTo(et,Ie,f,function(at){if(at){var mt=Jl(et),Ct=I(d+mt),Ot=Tm()!==Ct;Ot&&(ne=mt,Y_(Ct));var Kt=ze.indexOf(Jl(kt.location));Kt!==-1&&(ze[Kt]=mt),K({action:Ie,location:et})}})}function lt(rt){e.go(rt)}function Ke(){lt(-1)}function Mt(){lt(1)}var gt=0;function St(rt){gt+=rt,gt===1&&rt===1?window.addEventListener(f0,se):gt===0&&window.removeEventListener(f0,se)}var Be=!1;function ot(rt){rt===void 0&&(rt=!1);var be=V.setPrompt(rt);return Be||(St(1),Be=!0),function(){return Be&&(Be=!1,St(-1)),be()}}function Fe(rt){var be=V.appendListener(rt);return St(1),function(){St(-1),be()}}var kt={length:e.length,action:"POP",location:Se,createHref:He,push:Ze,replace:st,go:lt,goBack:Ke,goForward:Mt,block:ot,listen:Fe};return kt}function p0(t,e,r){return Math.min(Math.max(t,e),r)}function bP(t){t===void 0&&(t={});var e=t,r=e.getUserConfirmation,l=e.initialEntries,f=l===void 0?["/"]:l,_=e.initialIndex,y=_===void 0?0:_,d=e.keyLength,A=d===void 0?6:d,I=zx();function B(He){Zo(ze,He),ze.length=ze.entries.length,I.notifyListeners(ze.location,ze.action)}function N(){return Math.random().toString(36).substr(2,A)}var V=p0(y,0,f.length-1),K=f.map(function(He){return typeof He=="string"?Ho(He,void 0,N()):Ho(He,void 0,He.key||N())}),ie=Jl;function ne(He,Ze){var st="PUSH",lt=Ho(He,Ze,N(),ze.location);I.confirmTransitionTo(lt,st,r,function(Ke){if(Ke){var Mt=ze.index,gt=Mt+1,St=ze.entries.slice(0);St.length>gt?St.splice(gt,St.length-gt,lt):St.push(lt),B({action:st,location:lt,index:gt,entries:St})}})}function ve(He,Ze){var st="REPLACE",lt=Ho(He,Ze,N(),ze.location);I.confirmTransitionTo(lt,st,r,function(Ke){Ke&&(ze.entries[ze.index]=lt,B({action:st,location:lt}))})}function se(He){var Ze=p0(ze.index+He,0,ze.entries.length-1),st="POP",lt=ze.entries[Ze];I.confirmTransitionTo(lt,st,r,function(Ke){Ke?B({action:st,location:lt,index:Ze}):B()})}function ge(){se(-1)}function ae(){se(1)}function me(He){var Ze=ze.index+He;return Ze>=0&&Ze<ze.entries.length}function ye(He){return He===void 0&&(He=!1),I.setPrompt(He)}function Se(He){return I.appendListener(He)}var ze={length:K.length,action:"POP",location:K[V],index:V,entries:K,createHref:ie,push:ne,replace:ve,go:se,goBack:ge,goForward:ae,canGo:me,block:ye,listen:Se};return ze}function qv(t,e){return qv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,l){return r.__proto__=l,r},qv(t,e)}function Wh(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,qv(t,e)}var X_={exports:{}},K_,m0;function wP(){if(m0)return K_;m0=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K_=t,K_}var J_,g0;function SP(){if(g0)return J_;g0=1;var t=wP();function e(){}function r(){}return r.resetWarningCache=e,J_=function(){function l(y,d,A,I,B,N){if(N!==t){var V=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw V.name="Invariant Violation",V}}l.isRequired=l;function f(){return l}var _={array:l,bigint:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:f,element:l,elementType:l,instanceOf:f,node:l,objectOf:f,oneOf:f,oneOfType:f,shape:f,exact:f,checkPropTypes:r,resetWarningCache:e};return _.PropTypes=_,_},J_}var y0;function TP(){return y0||(y0=1,X_.exports=SP()()),X_.exports}var EP=TP();const _0=Kh(EP);var $d={exports:{}},Q_,v0;function kP(){return v0||(v0=1,Q_=Array.isArray||function(t){return Object.prototype.toString.call(t)=="[object Array]"}),Q_}var x0;function CP(){if(x0)return $d.exports;x0=1;var t=kP();$d.exports=ve,$d.exports.parse=r,$d.exports.compile=f,$d.exports.tokensToFunction=d,$d.exports.tokensToRegExp=ne;var e=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function r(se,ge){for(var ae=[],me=0,ye=0,Se="",ze=ge&&ge.delimiter||"/",He;(He=e.exec(se))!=null;){var Ze=He[0],st=He[1],lt=He.index;if(Se+=se.slice(ye,lt),ye=lt+Ze.length,st){Se+=st[1];continue}var Ke=se[ye],Mt=He[2],gt=He[3],St=He[4],Be=He[5],ot=He[6],Fe=He[7];Se&&(ae.push(Se),Se="");var kt=Mt!=null&&Ke!=null&&Ke!==Mt,rt=ot==="+"||ot==="*",be=ot==="?"||ot==="*",Ie=Mt||ze,et=St||Be,at=Mt||(typeof ae[ae.length-1]=="string"?ae[ae.length-1]:"");ae.push({name:gt||me++,prefix:Mt||"",delimiter:Ie,optional:be,repeat:rt,partial:kt,asterisk:!!Fe,pattern:et?I(et):Fe?".*":l(Ie,at)})}return ye<se.length&&(Se+=se.substr(ye)),Se&&ae.push(Se),ae}function l(se,ge){return!ge||ge.indexOf(se)>-1?"[^"+A(se)+"]+?":A(ge)+"|(?:(?!"+A(ge)+")[^"+A(se)+"])+?"}function f(se,ge){return d(r(se,ge),ge)}function _(se){return encodeURI(se).replace(/[\/?#]/g,function(ge){return"%"+ge.charCodeAt(0).toString(16).toUpperCase()})}function y(se){return encodeURI(se).replace(/[?#]/g,function(ge){return"%"+ge.charCodeAt(0).toString(16).toUpperCase()})}function d(se,ge){for(var ae=new Array(se.length),me=0;me<se.length;me++)typeof se[me]=="object"&&(ae[me]=new RegExp("^(?:"+se[me].pattern+")$",N(ge)));return function(ye,Se){for(var ze="",He=ye||{},Ze=Se||{},st=Ze.pretty?_:encodeURIComponent,lt=0;lt<se.length;lt++){var Ke=se[lt];if(typeof Ke=="string"){ze+=Ke;continue}var Mt=He[Ke.name],gt;if(Mt==null)if(Ke.optional){Ke.partial&&(ze+=Ke.prefix);continue}else throw new TypeError('Expected "'+Ke.name+'" to be defined');if(t(Mt)){if(!Ke.repeat)throw new TypeError('Expected "'+Ke.name+'" to not repeat, but received `'+JSON.stringify(Mt)+"`");if(Mt.length===0){if(Ke.optional)continue;throw new TypeError('Expected "'+Ke.name+'" to not be empty')}for(var St=0;St<Mt.length;St++){if(gt=st(Mt[St]),!ae[lt].test(gt))throw new TypeError('Expected all "'+Ke.name+'" to match "'+Ke.pattern+'", but received `'+JSON.stringify(gt)+"`");ze+=(St===0?Ke.prefix:Ke.delimiter)+gt}continue}if(gt=Ke.asterisk?y(Mt):st(Mt),!ae[lt].test(gt))throw new TypeError('Expected "'+Ke.name+'" to match "'+Ke.pattern+'", but received "'+gt+'"');ze+=Ke.prefix+gt}return ze}}function A(se){return se.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function I(se){return se.replace(/([=!:$\/()])/g,"\\$1")}function B(se,ge){return se.keys=ge,se}function N(se){return se&&se.sensitive?"":"i"}function V(se,ge){var ae=se.source.match(/\((?!\?)/g);if(ae)for(var me=0;me<ae.length;me++)ge.push({name:me,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return B(se,ge)}function K(se,ge,ae){for(var me=[],ye=0;ye<se.length;ye++)me.push(ve(se[ye],ge,ae).source);var Se=new RegExp("(?:"+me.join("|")+")",N(ae));return B(Se,ge)}function ie(se,ge,ae){return ne(r(se,ae),ge,ae)}function ne(se,ge,ae){t(ge)||(ae=ge||ae,ge=[]),ae=ae||{};for(var me=ae.strict,ye=ae.end!==!1,Se="",ze=0;ze<se.length;ze++){var He=se[ze];if(typeof He=="string")Se+=A(He);else{var Ze=A(He.prefix),st="(?:"+He.pattern+")";ge.push(He),He.repeat&&(st+="(?:"+Ze+st+")*"),He.optional?He.partial?st=Ze+"("+st+")?":st="(?:"+Ze+"("+st+"))?":st=Ze+"("+st+")",Se+=st}}var lt=A(ae.delimiter||"/"),Ke=Se.slice(-lt.length)===lt;return me||(Se=(Ke?Se.slice(0,-lt.length):Se)+"(?:"+lt+"(?=$))?"),ye?Se+="$":Se+=me&&Ke?"":"(?="+lt+"|$)",B(new RegExp("^"+Se,N(ae)),ge)}function ve(se,ge,ae){return t(ge)||(ae=ge||ae,ge=[]),ae=ae||{},se instanceof RegExp?V(se,ge):t(se)?K(se,ge,ae):ie(se,ge,ae)}return $d.exports}var AP=CP();const _S=Kh(AP);var ev={exports:{}},fs={};var b0;function MP(){if(b0)return fs;b0=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,l=t?Symbol.for("react.fragment"):60107,f=t?Symbol.for("react.strict_mode"):60108,_=t?Symbol.for("react.profiler"):60114,y=t?Symbol.for("react.provider"):60109,d=t?Symbol.for("react.context"):60110,A=t?Symbol.for("react.async_mode"):60111,I=t?Symbol.for("react.concurrent_mode"):60111,B=t?Symbol.for("react.forward_ref"):60112,N=t?Symbol.for("react.suspense"):60113,V=t?Symbol.for("react.suspense_list"):60120,K=t?Symbol.for("react.memo"):60115,ie=t?Symbol.for("react.lazy"):60116,ne=t?Symbol.for("react.block"):60121,ve=t?Symbol.for("react.fundamental"):60117,se=t?Symbol.for("react.responder"):60118,ge=t?Symbol.for("react.scope"):60119;function ae(ye){if(typeof ye=="object"&&ye!==null){var Se=ye.$$typeof;switch(Se){case e:switch(ye=ye.type,ye){case A:case I:case l:case _:case f:case N:return ye;default:switch(ye=ye&&ye.$$typeof,ye){case d:case B:case ie:case K:case y:return ye;default:return Se}}case r:return Se}}}function me(ye){return ae(ye)===I}return fs.AsyncMode=A,fs.ConcurrentMode=I,fs.ContextConsumer=d,fs.ContextProvider=y,fs.Element=e,fs.ForwardRef=B,fs.Fragment=l,fs.Lazy=ie,fs.Memo=K,fs.Portal=r,fs.Profiler=_,fs.StrictMode=f,fs.Suspense=N,fs.isAsyncMode=function(ye){return me(ye)||ae(ye)===A},fs.isConcurrentMode=me,fs.isContextConsumer=function(ye){return ae(ye)===d},fs.isContextProvider=function(ye){return ae(ye)===y},fs.isElement=function(ye){return typeof ye=="object"&&ye!==null&&ye.$$typeof===e},fs.isForwardRef=function(ye){return ae(ye)===B},fs.isFragment=function(ye){return ae(ye)===l},fs.isLazy=function(ye){return ae(ye)===ie},fs.isMemo=function(ye){return ae(ye)===K},fs.isPortal=function(ye){return ae(ye)===r},fs.isProfiler=function(ye){return ae(ye)===_},fs.isStrictMode=function(ye){return ae(ye)===f},fs.isSuspense=function(ye){return ae(ye)===N},fs.isValidElementType=function(ye){return typeof ye=="string"||typeof ye=="function"||ye===l||ye===I||ye===_||ye===f||ye===N||ye===V||typeof ye=="object"&&ye!==null&&(ye.$$typeof===ie||ye.$$typeof===K||ye.$$typeof===y||ye.$$typeof===d||ye.$$typeof===B||ye.$$typeof===ve||ye.$$typeof===se||ye.$$typeof===ge||ye.$$typeof===ne)},fs.typeOf=ae,fs}var w0;function vS(){return w0||(w0=1,ev.exports=MP()),ev.exports}vS();function xS(t,e){if(t==null)return{};var r={};for(var l in t)if({}.hasOwnProperty.call(t,l)){if(e.indexOf(l)!==-1)continue;r[l]=t[l]}return r}var tv,S0;function PP(){if(S0)return tv;S0=1;var t=vS(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},f={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},_={};_[t.ForwardRef]=l,_[t.Memo]=f;function y(ie){return t.isMemo(ie)?f:_[ie.$$typeof]||e}var d=Object.defineProperty,A=Object.getOwnPropertyNames,I=Object.getOwnPropertySymbols,B=Object.getOwnPropertyDescriptor,N=Object.getPrototypeOf,V=Object.prototype;function K(ie,ne,ve){if(typeof ne!="string"){if(V){var se=N(ne);se&&se!==V&&K(ie,se,ve)}var ge=A(ne);I&&(ge=ge.concat(I(ne)));for(var ae=y(ie),me=y(ne),ye=0;ye<ge.length;++ye){var Se=ge[ye];if(!r[Se]&&!(ve&&ve[Se])&&!(me&&me[Se])&&!(ae&&ae[Se])){var ze=B(ne,Se);try{d(ie,Se,ze)}catch{}}}}return ie}return tv=K,tv}var IP=PP();const jP=Kh(IP);var iv=1073741823,T0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{};function LP(){var t="__global_unique_id__";return T0[t]=(T0[t]||0)+1}function zP(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function RP(t){var e=[];return{on:function(l){e.push(l)},off:function(l){e=e.filter(function(f){return f!==l})},get:function(){return t},set:function(l,f){t=l,e.forEach(function(_){return _(t,f)})}}}function DP(t){return Array.isArray(t)?t[0]:t}function OP(t,e){var r,l,f="__create-react-context-"+LP()+"__",_=(function(d){Wh(A,d);function A(){for(var B,N=arguments.length,V=new Array(N),K=0;K<N;K++)V[K]=arguments[K];return B=d.call.apply(d,[this].concat(V))||this,B.emitter=RP(B.props.value),B}var I=A.prototype;return I.getChildContext=function(){var N;return N={},N[f]=this.emitter,N},I.componentWillReceiveProps=function(N){if(this.props.value!==N.value){var V=this.props.value,K=N.value,ie;zP(V,K)?ie=0:(ie=typeof e=="function"?e(V,K):iv,ie|=0,ie!==0&&this.emitter.set(N.value,ie))}},I.render=function(){return this.props.children},A})(Nt.Component);_.childContextTypes=(r={},r[f]=_0.object.isRequired,r);var y=(function(d){Wh(A,d);function A(){for(var B,N=arguments.length,V=new Array(N),K=0;K<N;K++)V[K]=arguments[K];return B=d.call.apply(d,[this].concat(V))||this,B.observedBits=void 0,B.state={value:B.getValue()},B.onUpdate=function(ie,ne){var ve=B.observedBits|0;(ve&ne)!==0&&B.setState({value:B.getValue()})},B}var I=A.prototype;return I.componentWillReceiveProps=function(N){var V=N.observedBits;this.observedBits=V??iv},I.componentDidMount=function(){this.context[f]&&this.context[f].on(this.onUpdate);var N=this.props.observedBits;this.observedBits=N??iv},I.componentWillUnmount=function(){this.context[f]&&this.context[f].off(this.onUpdate)},I.getValue=function(){return this.context[f]?this.context[f].get():t},I.render=function(){return DP(this.props.children)(this.state.value)},A})(Nt.Component);return y.contextTypes=(l={},l[f]=_0.object,l),{Provider:_,Consumer:y}}var NP=Nt.createContext||OP,bS=function(e){var r=NP();return r.displayName=e,r},wS=bS("Router-History"),Yh=bS("Router"),Qm=(function(t){Wh(e,t),e.computeRootMatch=function(f){return{path:"/",url:"/",params:{},isExact:f==="/"}};function e(l){var f;return f=t.call(this,l)||this,f.state={location:l.history.location},f._isMounted=!1,f._pendingLocation=null,l.staticContext||(f.unlisten=l.history.listen(function(_){f._pendingLocation=_})),f}var r=e.prototype;return r.componentDidMount=function(){var f=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen(function(_){f._isMounted&&f.setState({location:_})})),this._pendingLocation&&this.setState({location:this._pendingLocation})},r.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},r.render=function(){return Nt.createElement(Yh.Provider,{value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},Nt.createElement(wS.Provider,{children:this.props.children||null,value:this.props.history}))},e})(Nt.Component);Nt.Component;var BP=(function(t){Wh(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},r.componentDidUpdate=function(f){this.props.onUpdate&&this.props.onUpdate.call(this,this,f)},r.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},r.render=function(){return null},e})(Nt.Component),nv={},$P=1e4,E0=0;function UP(t){if(nv[t])return nv[t];var e=_S.compile(t);return E0<$P&&(nv[t]=e,E0++),e}function k0(t,e){return t===void 0&&(t="/"),e===void 0&&(e={}),t==="/"?t:UP(t)(e,{pretty:!0})}function Ec(t){var e=t.computedMatch,r=t.to,l=t.push,f=l===void 0?!1:l;return Nt.createElement(Yh.Consumer,null,function(_){_||nf();var y=_.history,d=_.staticContext,A=f?y.push:y.replace,I=Ho(e?typeof r=="string"?k0(r,e.params):Zo({},r,{pathname:k0(r.pathname,e.params)}):r);return d?(A(I),null):Nt.createElement(BP,{onMount:function(){A(I)},onUpdate:function(N,V){var K=Ho(V.to);dP(K,Zo({},I,{key:K.key}))||A(I)},to:r})})}var C0={},FP=1e4,A0=0;function VP(t,e){var r=""+e.end+e.strict+e.sensitive,l=C0[r]||(C0[r]={});if(l[t])return l[t];var f=[],_=_S(t,f,e),y={regexp:_,keys:f};return A0<FP&&(l[t]=y,A0++),y}function Rx(t,e){e===void 0&&(e={}),(typeof e=="string"||Array.isArray(e))&&(e={path:e});var r=e,l=r.path,f=r.exact,_=f===void 0?!1:f,y=r.strict,d=y===void 0?!1:y,A=r.sensitive,I=A===void 0?!1:A,B=[].concat(l);return B.reduce(function(N,V){if(!V&&V!=="")return null;if(N)return N;var K=VP(V,{end:_,strict:d,sensitive:I}),ie=K.regexp,ne=K.keys,ve=ie.exec(t);if(!ve)return null;var se=ve[0],ge=ve.slice(1),ae=t===se;return _&&!ae?null:{path:V,url:V==="/"&&se===""?"/":se,isExact:ae,params:ne.reduce(function(me,ye,Se){return me[ye.name]=ge[Se],me},{})}},null)}function qP(t){return Nt.Children.count(t)===0}var Gs=(function(t){Wh(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.render=function(){var f=this;return Nt.createElement(Yh.Consumer,null,function(_){_||nf();var y=f.props.location||_.location,d=f.props.computedMatch?f.props.computedMatch:f.props.path?Rx(y.pathname,f.props):_.match,A=Zo({},_,{location:y,match:d}),I=f.props,B=I.children,N=I.component,V=I.render;return Array.isArray(B)&&qP(B)&&(B=null),Nt.createElement(Yh.Provider,{value:A},A.match?B?typeof B=="function"?B(A):B:N?Nt.createElement(N,A):V?V(A):null:typeof B=="function"?B(A):null)})},e})(Nt.Component);function Dx(t){return t.charAt(0)==="/"?t:"/"+t}function HP(t,e){return t?Zo({},e,{pathname:Dx(t)+e.pathname}):e}function ZP(t,e){if(!t)return e;var r=Dx(t);return e.pathname.indexOf(r)!==0?e:Zo({},e,{pathname:e.pathname.substr(r.length)})}function M0(t){return typeof t=="string"?t:Jl(t)}function sv(t){return function(){nf()}}function P0(){}Nt.Component;Nt.Component;function GP(t){var e="withRouter("+(t.displayName||t.name)+")",r=function(f){var _=f.wrappedComponentRef,y=xS(f,["wrappedComponentRef"]);return Nt.createElement(Yh.Consumer,null,function(d){return d||nf(),Nt.createElement(t,Zo({},y,d,{ref:_}))})};return r.displayName=e,r.WrappedComponent=t,jP(r,t)}var Ox=Nt.useContext;function ta(){return Ox(wS)}function pp(){return Ox(Yh).location}function eg(){var t=Ox(Yh).match;return t?t.params:{}}class WP extends Nt.PureComponent{render(){return Nt.createElement(Gs,Object.assign({path:this.props.path,exact:this.props.exact,render:this.props.render},this.props.computedMatch!==void 0?{computedMatch:this.props.computedMatch}:{}))}}const Fm=({pathname:t,componentProps:e})=>{const{exact:r,component:l}=e,f=e.path||e.from,y=Rx(t,{exact:r,path:f,component:l});return y||!1};class YP extends aP{constructor(){super(),this.createViewItem=this.createViewItem.bind(this),this.findViewItemByRouteInfo=this.findViewItemByRouteInfo.bind(this),this.findLeavingViewItemByRouteInfo=this.findLeavingViewItemByRouteInfo.bind(this),this.getChildrenToRender=this.getChildrenToRender.bind(this),this.findViewItemByPathname=this.findViewItemByPathname.bind(this)}createViewItem(e,r,l,f){const _={id:Um("viewItem"),outletId:e,ionPageElement:f,reactElement:r,mount:!0,ionRoute:!1};return r.type===Lx&&(_.ionRoute=!0,_.disableIonPageManagement=r.props.disableIonPageManagement),_.routeData={match:Fm({pathname:l.pathname,componentProps:r.props}),childProps:r.props},_}getChildrenToRender(e,r,l){const f=this.getViewItemsForOutlet(e);return Nt.Children.forEach(r.props.children,y=>{const d=f.find(A=>I0(y,A.routeData.childProps.path||A.routeData.childProps.from));d&&(d.reactElement=y)}),f.map(y=>{let d;if(y.ionRoute&&!y.disableIonPageManagement)d=Nt.createElement(o0,{key:`view-${y.id}`,mount:y.mount,removeView:()=>this.remove(y)},Nt.cloneElement(y.reactElement,{computedMatch:y.routeData.match}));else{const A=I0(y.reactElement,l.pathname);d=Nt.createElement(o0,{key:`view-${y.id}`,mount:y.mount,removeView:()=>this.remove(y)},Nt.cloneElement(y.reactElement,{computedMatch:y.routeData.match})),!A&&y.routeData.match&&(y.routeData.match=void 0,y.mount=!1)}return d})}findViewItemByRouteInfo(e,r,l){const{viewItem:f,match:_}=this.findViewItemByPath(e.pathname,r);return(l===void 0||l===!0)&&f&&_&&(f.routeData.match=_),f}findLeavingViewItemByRouteInfo(e,r,l=!0){const{viewItem:f}=this.findViewItemByPath(e.lastPathname,r,l);return f}findViewItemByPathname(e,r){const{viewItem:l}=this.findViewItemByPath(e,r);return l}findViewItemByPath(e,r,l){let f,_,y;if(r)y=this.getViewItemsForOutlet(r),y.some(d),f||y.some(A);else{const I=this.getAllViewItems();I.some(d),f||I.some(A)}return{viewItem:f,match:_};function d(I){var B,N;if(l&&!I.ionRoute)return!1;if(_=Fm({pathname:e,componentProps:I.routeData.childProps}),_){const V=_.path.includes(":");if(!V||V&&_.url===((N=(B=I.routeData)===null||B===void 0?void 0:B.match)===null||N===void 0?void 0:N.url))return f=I,!0}return!1}function A(I){return!I.routeData.childProps.path&&!I.routeData.childProps.from?(_={path:e,url:e,isExact:!0,params:{}},f=I,!0):!1}}}function I0(t,e){return Fm({pathname:e,componentProps:t.props})}function XP(t){let e;if(typeof t=="string"?e=t:e=t.outerHTML,document){const r=document.createElement("div");r.innerHTML=e,r.style.zIndex="";const l=r.getElementsByTagName("ion-back-button");return l[0]&&l[0].remove(),r.firstChild}}const j0=t=>!t.classList.contains("ion-page-invisible")&&!t.classList.contains("ion-page-hidden");class KP extends Nt.PureComponent{constructor(e){super(e),this.stackContextValue={registerIonPage:this.registerIonPage.bind(this),isInOutlet:()=>!0},this.pendingPageTransition=!1,this.registerIonPage=this.registerIonPage.bind(this),this.transitionPage=this.transitionPage.bind(this),this.handlePageTransition=this.handlePageTransition.bind(this),this.id=Um("routerOutlet"),this.prevProps=void 0,this.skipTransition=!1}componentDidMount(){this.clearOutletTimeout&&clearTimeout(this.clearOutletTimeout),this.routerOutletElement&&(this.setupRouterOutlet(this.routerOutletElement),this.handlePageTransition(this.props.routeInfo))}componentDidUpdate(e){const{pathname:r}=this.props.routeInfo,{pathname:l}=e.routeInfo;r!==l?(this.prevProps=e,this.handlePageTransition(this.props.routeInfo)):this.pendingPageTransition&&(this.handlePageTransition(this.props.routeInfo),this.pendingPageTransition=!1)}componentWillUnmount(){this.clearOutletTimeout=this.context.clearOutlet(this.id)}async handlePageTransition(e){var r,l;if(!this.routerOutletElement||!this.routerOutletElement.commit)this.pendingPageTransition=!0;else{let f=this.context.findViewItemByRouteInfo(e,this.id),_=this.context.findLeavingViewItemByRouteInfo(e,this.id);!_&&e.prevRouteLastPathname&&(_=this.context.findViewItemByPathname(e.prevRouteLastPathname,this.id)),_&&(e.routeAction==="replace"?_.mount=!1:e.routeAction==="push"&&e.routeDirection==="forward"?!((r=e.routeOptions)===null||r===void 0)&&r.unmount&&(_.mount=!1):e.routeDirection!=="none"&&f!==_&&(_.mount=!1));const y=JP((l=this.ionRouterOutlet)===null||l===void 0?void 0:l.props.children,e);if(f?f.reactElement=y:y&&(f=this.context.createViewItem(this.id,y,e),this.context.addViewItem(f)),f&&f.ionPageElement){if(f===_&&f.routeData.match.url!==e.pathname||(!_&&this.props.routeInfo.prevRouteLastPathname&&(_=this.context.findViewItemByPathname(this.props.routeInfo.prevRouteLastPathname,this.id)),j0(f.ionPageElement)&&_!==void 0&&!j0(_.ionPageElement)))return;this.transitionPage(e,f,_)}else _&&!y&&!f&&_.ionPageElement&&(_.ionPageElement.classList.add("ion-page-hidden"),_.ionPageElement.setAttribute("aria-hidden","true"));this.forceUpdate()}}registerIonPage(e,r){const l=this.context.findViewItemByRouteInfo(r,this.id);if(l){const f=l.ionPageElement;if(l.ionPageElement=e,l.ionRoute=!0,f===e)return}this.handlePageTransition(r)}async setupRouterOutlet(e){const r=()=>{const _=Px();if(!(_&&_.get("swipeBackEnabled",e.mode==="ios")))return!1;const{routeInfo:d}=this.props,A=this.prevProps&&this.prevProps.routeInfo.pathname===d.pushedByRoute?this.prevProps.routeInfo:{pathname:d.pushedByRoute||""},I=this.context.findViewItemByRouteInfo(A,this.id,!1);return!!I&&I.mount&&I.routeData.match.path!==d.pathname},l=async()=>{const{routeInfo:_}=this.props,y=this.prevProps&&this.prevProps.routeInfo.pathname===_.pushedByRoute?this.prevProps.routeInfo:{pathname:_.pushedByRoute||""},d=this.context.findViewItemByRouteInfo(y,this.id,!1),A=this.context.findViewItemByRouteInfo(_,this.id,!1);return d&&A&&await this.transitionPage(_,d,A,"back",!0),Promise.resolve()},f=_=>{if(_)this.skipTransition=!0,this.context.goBack();else{const{routeInfo:y}=this.props,d=this.prevProps&&this.prevProps.routeInfo.pathname===y.pushedByRoute?this.prevProps.routeInfo:{pathname:y.pushedByRoute||""},A=this.context.findViewItemByRouteInfo(d,this.id,!1),I=this.context.findViewItemByRouteInfo(y,this.id,!1);if(A!==I&&A?.ionPageElement!==void 0){const{ionPageElement:B}=A;B.setAttribute("aria-hidden","true"),B.classList.add("ion-page-hidden")}}};e.swipeHandler={canStart:r,onStart:l,onEnd:f}}async transitionPage(e,r,l,f,_=!1){const y=async(B,N)=>{const V=this.skipTransition;V?this.skipTransition=!1:(B.classList.add("ion-page"),B.classList.add("ion-page-invisible")),await d.commit(B,N,{duration:V||I===void 0?0:void 0,direction:I,showGoBack:!!e.pushedByRoute,progressAnimation:_,animationBuilder:e.routeAnimation})},d=this.routerOutletElement,A=e.routeDirection==="none"||e.routeDirection==="root"?void 0:e.routeDirection,I=f??A;if(r&&r.ionPageElement&&this.routerOutletElement)if(l&&l.ionPageElement&&r===l)if(QP(l.reactElement,e.pathname,!0)){const N=XP(l.ionPageElement.outerHTML);N&&(this.routerOutletElement.appendChild(N),await y(r.ionPageElement,N),this.routerOutletElement.removeChild(N))}else await y(r.ionPageElement,void 0);else await y(r.ionPageElement,l?.ionPageElement),l&&l.ionPageElement&&!_&&(l.ionPageElement.classList.add("ion-page-hidden"),l.ionPageElement.setAttribute("aria-hidden","true"))}render(){const{children:e}=this.props,r=Nt.Children.only(e);this.ionRouterOutlet=r;const l=this.context.getChildrenToRender(this.id,this.ionRouterOutlet,this.props.routeInfo,()=>{this.forceUpdate()});return Nt.createElement(Ix.Provider,{value:this.stackContextValue},Nt.cloneElement(r,{ref:f=>{r.props.setRef&&r.props.setRef(f),r.props.forwardedRef&&(r.props.forwardedRef.current=f),this.routerOutletElement=f;const{ref:_}=r;typeof _=="function"&&_(f)}},l))}static get contextType(){return dS}}function JP(t,e){let r;return Nt.Children.forEach(t,l=>{Fm({pathname:e.pathname,componentProps:l.props})&&(r=l)}),r||(Nt.Children.forEach(t,l=>{l.props.path||l.props.from||(r=l)}),r)}function QP(t,e,r){return Fm({pathname:e,componentProps:Object.assign(Object.assign({},t.props),{exact:r})})}class eI extends Nt.PureComponent{constructor(e){super(e),this.exitViewFromOtherOutletHandlers=[],this.locationHistory=new sP,this.viewStack=new YP,this.routeMangerContextState={canGoBack:()=>this.locationHistory.canGoBack(),clearOutlet:this.viewStack.clear,findViewItemByPathname:this.viewStack.findViewItemByPathname,getChildrenToRender:this.viewStack.getChildrenToRender,goBack:()=>this.handleNavigateBack(),createViewItem:this.viewStack.createViewItem,findViewItemByRouteInfo:this.viewStack.findViewItemByRouteInfo,findLeavingViewItemByRouteInfo:this.viewStack.findLeavingViewItemByRouteInfo,addViewItem:this.viewStack.add,unMountViewItem:this.viewStack.remove};const r={id:Um("routeInfo"),pathname:this.props.location.pathname,search:this.props.location.search};this.locationHistory.add(r),this.handleChangeTab=this.handleChangeTab.bind(this),this.handleResetTab=this.handleResetTab.bind(this),this.handleNativeBack=this.handleNativeBack.bind(this),this.handleNavigate=this.handleNavigate.bind(this),this.handleNavigateBack=this.handleNavigateBack.bind(this),this.props.registerHistoryListener(this.handleHistoryChange.bind(this)),this.handleSetCurrentTab=this.handleSetCurrentTab.bind(this),this.state={routeInfo:r}}handleChangeTab(e,r,l){if(!r)return;const f=this.locationHistory.getCurrentRouteInfoForTab(e),[_,y]=r.split("?");f?(this.incomingRouteParams=Object.assign(Object.assign({},f),{routeAction:"push",routeDirection:"none"}),f.pathname===_?(this.incomingRouteParams.routeOptions=l,this.props.history.push(f.pathname+(f.search||""))):(this.incomingRouteParams.pathname=_,this.incomingRouteParams.search=y?"?"+y:void 0,this.incomingRouteParams.routeOptions=l,this.props.history.push(_+(y?"?"+y:"")))):this.handleNavigate(_,"push","none",void 0,l,e)}handleHistoryChange(e,r){var l,f,_;let y;if(this.incomingRouteParams?this.incomingRouteParams.routeAction==="replace"?y=this.locationHistory.previous():y=this.locationHistory.current():y=this.locationHistory.current(),y.pathname+y.search!==e.pathname){if(!this.incomingRouteParams){if(r==="REPLACE"&&(this.incomingRouteParams={routeAction:"replace",routeDirection:"none",tab:this.currentTab}),r==="POP"){const I=this.locationHistory.current();if(I&&I.pushedByRoute){const B=this.locationHistory.findLastLocation(I);this.incomingRouteParams=Object.assign(Object.assign({},B),{routeAction:"pop",routeDirection:"back"})}else this.incomingRouteParams={routeAction:"pop",routeDirection:"none",tab:this.currentTab}}this.incomingRouteParams||(this.incomingRouteParams={routeAction:"push",routeDirection:((l=e.state)===null||l===void 0?void 0:l.direction)||"forward",routeOptions:(f=e.state)===null||f===void 0?void 0:f.routerOptions,tab:this.currentTab})}let A;if(!((_=this.incomingRouteParams)===null||_===void 0)&&_.id)A=Object.assign(Object.assign({},this.incomingRouteParams),{lastPathname:y.pathname}),this.locationHistory.add(A);else{const I=this.incomingRouteParams.routeAction==="push"&&this.incomingRouteParams.routeDirection==="forward";if(A=Object.assign(Object.assign({id:Um("routeInfo")},this.incomingRouteParams),{lastPathname:y.pathname,pathname:e.pathname,search:e.search,params:this.props.match.params,prevRouteLastPathname:y.lastPathname}),I)A.tab=y.tab,A.pushedByRoute=y.pathname;else if(A.routeAction==="pop"){const B=this.locationHistory.findLastLocation(A);A.pushedByRoute=B?.pushedByRoute}else if(A.routeAction==="push"&&A.tab!==y.tab){const B=this.locationHistory.getCurrentRouteInfoForTab(A.tab);A.pushedByRoute=B?.pushedByRoute}else if(A.routeAction==="replace"){const B=this.locationHistory.current(),N=B?.pushedByRoute,V=N!==void 0&&N!==A.pathname?N:A.pushedByRoute;A.lastPathname=B?.pathname||A.lastPathname,A.prevRouteLastPathname=B?.lastPathname,A.pushedByRoute=V,A.routeDirection=A.routeDirection||B?.routeDirection,A.routeAnimation=A.routeAnimation||B?.routeAnimation}this.locationHistory.add(A)}this.setState({routeInfo:A})}this.incomingRouteParams=void 0}handleNativeBack(){const e=this.props.history;(e.goBack||e.back)()}handleNavigate(e,r,l,f,_,y){this.incomingRouteParams=Object.assign(this.incomingRouteParams||{},{routeAction:r,routeDirection:l,routeOptions:_,routeAnimation:f,tab:y}),r==="push"?this.props.history.push(e):this.props.history.replace(e)}handleNavigateBack(e="/",r){const l=Px();e=e||l&&l.get("backButtonDefaultHref");const f=this.locationHistory.current();if(f&&f.pushedByRoute){const _=this.locationHistory.findLastLocation(f);if(_){const y=r||f.routeAnimation;if(this.incomingRouteParams=Object.assign(Object.assign({},_),{routeAction:"pop",routeDirection:"back",routeAnimation:y}),f.lastPathname===f.pushedByRoute||_.pathname===f.pushedByRoute&&f.tab===""&&_.tab===""){const d=this.props.history;(d.goBack||d.back)()}else this.handleNavigate(_.pathname+(_.search||""),"pop","back",y)}else this.handleNavigate(e,"pop","back",r)}else this.handleNavigate(e,"pop","back",r)}handleResetTab(e,r,l){const f=this.locationHistory.getFirstRouteInfoForTab(e);if(f){const _=Object.assign({},f);_.pathname=r,_.routeOptions=l,this.incomingRouteParams=Object.assign(Object.assign({},_),{routeAction:"pop",routeDirection:"back"}),this.props.history.push(_.pathname+(_.search||""))}}handleSetCurrentTab(e){this.currentTab=e;const r=Object.assign({},this.locationHistory.current());r.tab!==e&&(r.tab=e,this.locationHistory.update(r))}render(){return Nt.createElement(dS.Provider,{value:this.routeMangerContextState},Nt.createElement(rP,{ionRoute:WP,ionRedirect:{},stackManager:KP,routeInfo:this.state.routeInfo,onNativeBack:this.handleNativeBack,onNavigateBack:this.handleNavigateBack,onNavigate:this.handleNavigate,onSetCurrentTab:this.handleSetCurrentTab,onChangeTab:this.handleChangeTab,onResetTab:this.handleResetTab,locationHistory:this.locationHistory},this.props.children))}}const u_=GP(eI);u_.displayName="IonRouter";class tI extends Nt.Component{constructor(e){super(e);const{history:r}=e,l=Xu(e,["history"]);this.history=r||yP(l),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,r){const l=e.location||e,f=e.action||r;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:r}=e,l=Xu(e,["children"]);return Nt.createElement(Qm,Object.assign({history:this.history},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},r))}}class JD extends Nt.Component{constructor(e){super(e),this.history=e.history,this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,r){const l=e.location||e,f=e.action||r;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:r}=e,l=Xu(e,["children"]);return Nt.createElement(Qm,Object.assign({},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},r))}}class QD extends Nt.Component{constructor(e){super(e);const{history:r}=e,l=Xu(e,["history"]);this.history=r||xP(l),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,r){const l=e.location||e,f=e.action||r;this.historyListenHandler&&this.historyListenHandler(l,f)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:r}=e,l=Xu(e,["children"]);return Nt.createElement(Qm,Object.assign({history:this.history},l),Nt.createElement(u_,{registerHistoryListener:this.registerHistoryListener},r))}}const no=t=>({width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.8,strokeLinecap:"round",strokeLinejoin:"round"}),SS=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("rect",{x:"3",y:"5",width:"18",height:"16",rx:"3"}),S.jsx("path",{d:"M8 3v4M16 3v4M3 10h18"})]}),h_=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("path",{d:"M12 21s6-6.5 6-11a6 6 0 0 0-12 0c0 4.5 6 11 6 11z"}),S.jsx("circle",{cx:"12",cy:"10",r:"2.5"})]}),My=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"8",r:"3.5"}),S.jsx("path",{d:"M4 20c1.6-3.6 5-5 8-5s6.4 1.4 8 5"})]}),L0=({className:t,size:e=20})=>S.jsx("svg",{...no(e),className:t,children:S.jsx("path",{d:"M8 6l10 6-10 6z"})}),Nx=({className:t,size:e=20})=>S.jsx("svg",{...no(e),className:t,children:S.jsx("path",{d:"M12 20s-7-4.6-7-9.5A4.5 4.5 0 0 1 12 7a4.5 4.5 0 0 1 7 3.5C19 15.4 12 20 12 20z"})}),iI=({className:t,size:e=20})=>S.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",className:t,fill:"currentColor",children:S.jsx("path",{d:"M12 20s-7-4.6-7-9.5A4.5 4.5 0 0 1 12 7a4.5 4.5 0 0 1 7 3.5C19 15.4 12 20 12 20z"})}),nI=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M8.5 12.5l2.5 2.5 4.5-5"})]}),TS=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("path",{d:"M16 6l-8 4 8 4"}),S.jsx("circle",{cx:"17.5",cy:"6",r:"2.5"}),S.jsx("circle",{cx:"6.5",cy:"12",r:"2.5"}),S.jsx("circle",{cx:"17.5",cy:"18",r:"2.5"})]}),sI=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("path",{d:"M12 20h9"}),S.jsx("path",{d:"M16.5 3.5l4 4L8 20l-5 1 1-5 12.5-12.5z"})]}),rI=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),S.jsx("path",{d:"M16 17l5-5-5-5"}),S.jsx("path",{d:"M21 12H9"})]}),aI=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),S.jsx("rect",{x:"5",y:"5",width:"10",height:"10",rx:"2"})]}),oI=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),S.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),lI=({className:t,size:e=20})=>S.jsx("svg",{...no(e),className:t,children:S.jsx("path",{d:"M15 18l-6-6 6-6"})}),cI=({className:t,size:e=20})=>S.jsx("svg",{...no(e),className:t,children:S.jsx("path",{d:"M6 9l6 6 6-6"})}),uI=({className:t,size:e=20})=>S.jsx("svg",{...no(e),className:t,children:S.jsx("path",{d:"M18 15l-6-6-6 6"})}),z0=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2"}),S.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),hI=({className:t,size:e=20})=>S.jsxs("svg",{...no(e),className:t,children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M14.5 9.5l-1.3 3.7-3.7 1.3 1.3-3.7 3.7-1.3z"}),S.jsx("path",{d:"M12 3v2M21 12h-2M12 21v-2M3 12h2"})]}),dI=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Bx extends Error{constructor(e,r="FunctionsError",l){super(e),this.name=r,this.context=l}}class fI extends Bx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class R0 extends Bx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class D0 extends Bx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Hv;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Hv||(Hv={}));class pI{constructor(e,{headers:r={},customFetch:l,region:f=Hv.Any}={}){this.url=e,this.headers=r,this.region=f,this.fetch=dI(l)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return oP(this,arguments,void 0,function*(r,l={}){var f;let _,y;try{const{headers:d,method:A,body:I,signal:B,timeout:N}=l;let V={},{region:K}=l;K||(K=this.region);const ie=new URL(`${this.url}/${r}`);K&&K!=="any"&&(V["x-region"]=K,ie.searchParams.set("forceFunctionRegion",K));let ne;I&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&I instanceof Blob||I instanceof ArrayBuffer?(V["Content-Type"]="application/octet-stream",ne=I):typeof I=="string"?(V["Content-Type"]="text/plain",ne=I):typeof FormData<"u"&&I instanceof FormData?ne=I:(V["Content-Type"]="application/json",ne=JSON.stringify(I)):I&&typeof I!="string"&&!(typeof Blob<"u"&&I instanceof Blob)&&!(I instanceof ArrayBuffer)&&!(typeof FormData<"u"&&I instanceof FormData)?ne=JSON.stringify(I):ne=I;let ve=B;N&&(y=new AbortController,_=setTimeout(()=>y.abort(),N),B?(ve=y.signal,B.addEventListener("abort",()=>y.abort())):ve=y.signal);const se=yield this.fetch(ie.toString(),{method:A||"POST",headers:Object.assign(Object.assign(Object.assign({},V),this.headers),d),body:ne,signal:ve}).catch(ye=>{throw new fI(ye)}),ge=se.headers.get("x-relay-error");if(ge&&ge==="true")throw new R0(se);if(!se.ok)throw new D0(se);let ae=((f=se.headers.get("Content-Type"))!==null&&f!==void 0?f:"text/plain").split(";")[0].trim(),me;return ae==="application/json"?me=yield se.json():ae==="application/octet-stream"||ae==="application/pdf"?me=yield se.blob():ae==="text/event-stream"?me=se:ae==="multipart/form-data"?me=yield se.formData():me=yield se.text(),{data:me,error:null,response:se}}catch(d){return{data:null,error:d,response:d instanceof D0||d instanceof R0?d.context:void 0}}finally{_&&clearTimeout(_)}})}}var mI=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},gI=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let f=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async _=>{let y=null,d=null,A=null,I=_.status,B=_.statusText;if(_.ok){var N,V;if(r.method!=="HEAD"){var K;const se=await _.text();se===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((K=r.headers.get("Accept"))===null||K===void 0)&&K.includes("application/vnd.pgrst.plan+text"))?d=se:d=JSON.parse(se))}const ne=(N=r.headers.get("Prefer"))===null||N===void 0?void 0:N.match(/count=(exact|planned|estimated)/),ve=(V=_.headers.get("content-range"))===null||V===void 0?void 0:V.split("/");ne&&ve&&ve.length>1&&(A=parseInt(ve[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(d)&&(d.length>1?(y={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,A=null,I=406,B="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var ie;const ne=await _.text();try{y=JSON.parse(ne),Array.isArray(y)&&_.status===404&&(d=[],y=null,I=200,B="OK")}catch{_.status===404&&ne===""?(I=204,B="No Content"):y={message:ne}}if(y&&r.isMaybeSingle&&(!(y==null||(ie=y.details)===null||ie===void 0)&&ie.includes("0 rows"))&&(y=null,I=200,B="OK"),y&&r.shouldThrowOnError)throw new mI(y)}return{error:y,data:d,count:A,status:I,statusText:B}});return this.shouldThrowOnError||(f=f.catch(_=>{var y;let d="";const A=_?.cause;if(A){var I,B,N,V;const ie=(I=A?.message)!==null&&I!==void 0?I:"",ne=(B=A?.code)!==null&&B!==void 0?B:"";d=`${(N=_?.name)!==null&&N!==void 0?N:"FetchError"}: ${_?.message}`,d+=`

Caused by: ${(V=A?.name)!==null&&V!==void 0?V:"Error"}: ${ie}`,ne&&(d+=` (${ne})`),A?.stack&&(d+=`
${A.stack}`)}else{var K;d=(K=_?.stack)!==null&&K!==void 0?K:""}return{error:{message:`${(y=_?.name)!==null&&y!==void 0?y:"FetchError"}: ${_?.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),f.then(t,e)}returns(){return this}overrideTypes(){return this}},yI=class extends gI{select(t){let e=!1;const r=(t??"*").split("").map(l=>/\s/.test(l)&&!e?"":(l==='"'&&(e=!e),l)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:l,referencedTable:f=l}={}){const _=f?`${f}.order`:"order",y=this.url.searchParams.get(_);return this.url.searchParams.set(_,`${y?`${y},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const l=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(l,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:l=r}={}){const f=typeof l>"u"?"offset":`${l}.offset`,_=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(f,`${t}`),this.url.searchParams.set(_,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:l=!1,wal:f=!1,format:_="text"}={}){var y;const d=[t?"analyze":null,e?"verbose":null,r?"settings":null,l?"buffers":null,f?"wal":null].filter(Boolean).join("|"),A=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${_}; for="${A}"; options=${d};`),_==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const O0=new RegExp("[,()]");var Xf=class extends yI{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(l=>typeof l=="string"&&O0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(l=>typeof l=="string"&&O0.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:l}={}){let f="";l==="plain"?f="pl":l==="phrase"?f="ph":l==="websearch"&&(f="w");const _=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${f}fts${_}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const l=r?`${r}.or`:"or";return this.url.searchParams.append(l,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},_I=class{constructor(t,{headers:e={},schema:r,fetch:l}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=l}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:r=!1,count:l}=e??{},f=r?"HEAD":"GET";let _=!1;const y=(t??"*").split("").map(I=>/\s/.test(I)&&!_?"":(I==='"'&&(_=!_),I)).join(""),{url:d,headers:A}=this.cloneRequestState();return d.searchParams.set("select",y),l&&A.append("Prefer",`count=${l}`),new Xf({method:f,url:d,headers:A,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var l;const f="POST",{url:_,headers:y}=this.cloneRequestState();if(e&&y.append("Prefer",`count=${e}`),r||y.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((A,I)=>A.concat(Object.keys(I)),[]);if(d.length>0){const A=[...new Set(d)].map(I=>`"${I}"`);_.searchParams.set("columns",A.join(","))}}return new Xf({method:f,url:_,headers:y,schema:this.schema,body:t,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:l,defaultToNull:f=!0}={}){var _;const y="POST",{url:d,headers:A}=this.cloneRequestState();if(A.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&d.searchParams.set("on_conflict",e),l&&A.append("Prefer",`count=${l}`),f||A.append("Prefer","missing=default"),Array.isArray(t)){const I=t.reduce((B,N)=>B.concat(Object.keys(N)),[]);if(I.length>0){const B=[...new Set(I)].map(N=>`"${N}"`);d.searchParams.set("columns",B.join(","))}}return new Xf({method:y,url:d,headers:A,schema:this.schema,body:t,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}update(t,{count:e}={}){var r;const l="PATCH",{url:f,headers:_}=this.cloneRequestState();return e&&_.append("Prefer",`count=${e}`),new Xf({method:l,url:f,headers:_,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE",{url:l,headers:f}=this.cloneRequestState();return t&&f.append("Prefer",`count=${t}`),new Xf({method:r,url:l,headers:f,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},vI=class ES{constructor(e,{headers:r={},schema:l,fetch:f}={}){this.url=e,this.headers=new Headers(r),this.schemaName=l,this.fetch=f}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new _I(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new ES(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:l=!1,get:f=!1,count:_}={}){var y;let d;const A=new URL(`${this.url}/rpc/${e}`);let I;const B=K=>K!==null&&typeof K=="object"&&(!Array.isArray(K)||K.some(B)),N=l&&Object.values(r).some(B);N?(d="POST",I=r):l||f?(d=l?"HEAD":"GET",Object.entries(r).filter(([K,ie])=>ie!==void 0).map(([K,ie])=>[K,Array.isArray(ie)?`{${ie.join(",")}}`:`${ie}`]).forEach(([K,ie])=>{A.searchParams.append(K,ie)})):(d="POST",I=r);const V=new Headers(this.headers);return N?V.set("Prefer",_?`count=${_},return=minimal`:"return=minimal"):_&&V.set("Prefer",`count=${_}`),new Xf({method:d,url:A,headers:V,schema:this.schemaName,body:I,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}};class xI{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const l=r.versions;if(l&&l.node){const f=l.node,_=parseInt(f.replace(/^v/,"").split(".")[0]);return _>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${_} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${_} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const l=this.getWebSocketConstructor();return new l(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const bI="2.90.1",wI=`realtime-js/${bI}`,kS="1.0.0",SI="2.0.0",N0=kS,Zv=1e4,TI=1e3,EI=100;var Uh;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Uh||(Uh={}));var ea;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ea||(ea={}));var Cc;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Cc||(Cc={}));var Gv;(function(t){t.websocket="websocket"})(Gv||(Gv={}));var qd;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(qd||(qd={}));class kI{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let l=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(l))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,l;const f=(l=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,f)}_encodeJsonUserBroadcastPush(e){var r,l;const f=(l=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:{},y=new TextEncoder().encode(JSON.stringify(f)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,y)}_encodeUserBroadcastPush(e,r,l){var f,_;const y=e.topic,d=(f=e.ref)!==null&&f!==void 0?f:"",A=(_=e.join_ref)!==null&&_!==void 0?_:"",I=e.payload.event,B=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},N=Object.keys(B).length===0?"":JSON.stringify(B);if(A.length>255)throw new Error(`joinRef length ${A.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`topic length ${y.length} exceeds maximum of 255`);if(I.length>255)throw new Error(`userEvent length ${I.length} exceeds maximum of 255`);if(N.length>255)throw new Error(`metadata length ${N.length} exceeds maximum of 255`);const V=this.USER_BROADCAST_PUSH_META_LENGTH+A.length+d.length+y.length+I.length+N.length,K=new ArrayBuffer(this.HEADER_LENGTH+V);let ie=new DataView(K),ne=0;ie.setUint8(ne++,this.KINDS.userBroadcastPush),ie.setUint8(ne++,A.length),ie.setUint8(ne++,d.length),ie.setUint8(ne++,y.length),ie.setUint8(ne++,I.length),ie.setUint8(ne++,N.length),ie.setUint8(ne++,r),Array.from(A,se=>ie.setUint8(ne++,se.charCodeAt(0))),Array.from(d,se=>ie.setUint8(ne++,se.charCodeAt(0))),Array.from(y,se=>ie.setUint8(ne++,se.charCodeAt(0))),Array.from(I,se=>ie.setUint8(ne++,se.charCodeAt(0))),Array.from(N,se=>ie.setUint8(ne++,se.charCodeAt(0)));var ve=new Uint8Array(K.byteLength+l.byteLength);return ve.set(new Uint8Array(K),0),ve.set(new Uint8Array(l),K.byteLength),ve.buffer}decode(e,r){if(this._isArrayBuffer(e)){let l=this._binaryDecode(e);return r(l)}if(typeof e=="string"){const l=JSON.parse(e),[f,_,y,d,A]=l;return r({join_ref:f,ref:_,topic:y,event:d,payload:A})}return r({})}_binaryDecode(e){const r=new DataView(e),l=r.getUint8(0),f=new TextDecoder;if(l===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,r,f)}_decodeUserBroadcast(e,r,l){const f=r.getUint8(1),_=r.getUint8(2),y=r.getUint8(3),d=r.getUint8(4);let A=this.HEADER_LENGTH+4;const I=l.decode(e.slice(A,A+f));A=A+f;const B=l.decode(e.slice(A,A+_));A=A+_;const N=l.decode(e.slice(A,A+y));A=A+y;const V=e.slice(A,e.byteLength),K=d===this.JSON_ENCODING?JSON.parse(l.decode(V)):V,ie={type:this.BROADCAST_EVENT,event:B,payload:K};return y>0&&(ie.meta=JSON.parse(N)),{join_ref:null,ref:null,topic:I,event:this.BROADCAST_EVENT,payload:ie}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([l])=>r.includes(l)))}}class CS{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ls;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ls||(Ls={}));const B0=(t,e,r={})=>{var l;const f=(l=r.skipTypes)!==null&&l!==void 0?l:[];return e?Object.keys(e).reduce((_,y)=>(_[y]=CI(y,t,e,f),_),{}):{}},CI=(t,e,r,l)=>{const f=e.find(d=>d.name===t),_=f?.type,y=r[t];return _&&!l.includes(_)?AS(_,y):Wv(y)},AS=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return II(e,r)}switch(t){case Ls.bool:return AI(e);case Ls.float4:case Ls.float8:case Ls.int2:case Ls.int4:case Ls.int8:case Ls.numeric:case Ls.oid:return MI(e);case Ls.json:case Ls.jsonb:return PI(e);case Ls.timestamp:return jI(e);case Ls.abstime:case Ls.date:case Ls.daterange:case Ls.int4range:case Ls.int8range:case Ls.money:case Ls.reltime:case Ls.text:case Ls.time:case Ls.timestamptz:case Ls.timetz:case Ls.tsrange:case Ls.tstzrange:return Wv(e);default:return Wv(e)}},Wv=t=>t,AI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},MI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},PI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},II=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,l=t[r];if(t[0]==="{"&&l==="}"){let _;const y=t.slice(1,r);try{_=JSON.parse("["+y+"]")}catch{_=y?y.split(","):[]}return _.map(d=>AS(e,d))}return t},jI=t=>typeof t=="string"?t.replace(" ","T"):t,MS=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class rv{constructor(e,r,l={},f=Zv){this.channel=e,this.event=r,this.payload=l,this.timeout=f,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var l;return this._hasReceived(e)&&r((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(l=>l.status===e).forEach(l=>l.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $0;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})($0||($0={}));class Im{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},f=>{const{onJoin:_,onLeave:y,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Im.syncState(this.state,f,_,y),this.pendingDiffs.forEach(A=>{this.state=Im.syncDiff(this.state,A,_,y)}),this.pendingDiffs=[],d()}),this.channel._on(l.diff,{},f=>{const{onJoin:_,onLeave:y,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(f):(this.state=Im.syncDiff(this.state,f,_,y),d())}),this.onJoin((f,_,y)=>{this.channel._trigger("presence",{event:"join",key:f,currentPresences:_,newPresences:y})}),this.onLeave((f,_,y)=>{this.channel._trigger("presence",{event:"leave",key:f,currentPresences:_,leftPresences:y})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,l,f){const _=this.cloneDeep(e),y=this.transformState(r),d={},A={};return this.map(_,(I,B)=>{y[I]||(A[I]=B)}),this.map(y,(I,B)=>{const N=_[I];if(N){const V=B.map(ve=>ve.presence_ref),K=N.map(ve=>ve.presence_ref),ie=B.filter(ve=>K.indexOf(ve.presence_ref)<0),ne=N.filter(ve=>V.indexOf(ve.presence_ref)<0);ie.length>0&&(d[I]=ie),ne.length>0&&(A[I]=ne)}else d[I]=B}),this.syncDiff(_,{joins:d,leaves:A},l,f)}static syncDiff(e,r,l,f){const{joins:_,leaves:y}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return l||(l=()=>{}),f||(f=()=>{}),this.map(_,(d,A)=>{var I;const B=(I=e[d])!==null&&I!==void 0?I:[];if(e[d]=this.cloneDeep(A),B.length>0){const N=e[d].map(K=>K.presence_ref),V=B.filter(K=>N.indexOf(K.presence_ref)<0);e[d].unshift(...V)}l(d,B,A)}),this.map(y,(d,A)=>{let I=e[d];if(!I)return;const B=A.map(N=>N.presence_ref);I=I.filter(N=>B.indexOf(N.presence_ref)<0),e[d]=I,f(d,I,A),I.length===0&&delete e[d]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(l=>r(l,e[l]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,l)=>{const f=e[l];return"metas"in f?r[l]=f.metas.map(_=>(_.presence_ref=_.phx_ref,delete _.phx_ref,delete _.phx_ref_prev,_)):r[l]=f,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var U0;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(U0||(U0={}));var jm;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(jm||(jm={}));var qu;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qu||(qu={}));class ip{constructor(e,r={config:{}},l){var f,_;if(this.topic=e,this.params=r,this.socket=l,this.bindings={},this.state=ea.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new rv(this,Cc.join,this.params,this.timeout),this.rejoinTimer=new CS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ea.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(y=>y.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ea.closed,this.socket._remove(this)}),this._onError(y=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,y),this.state=ea.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ea.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",y=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,y),this.state=ea.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Cc.reply,{},(y,d)=>{this._trigger(this._replyEventName(d),y)}),this.presence=new Im(this),this.broadcastEndpointURL=MS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((_=(f=this.params.config)===null||f===void 0?void 0:f.broadcast)===null||_===void 0)&&_.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var l,f,_;if(this.socket.isConnected()||this.socket.connect(),this.state==ea.closed){const{config:{broadcast:y,presence:d,private:A}}=this.params,I=(f=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(K=>K.filter))!==null&&f!==void 0?f:[],B=!!this.bindings[jm.PRESENCE]&&this.bindings[jm.PRESENCE].length>0||((_=this.params.config.presence)===null||_===void 0?void 0:_.enabled)===!0,N={},V={broadcast:y,presence:Object.assign(Object.assign({},d),{enabled:B}),postgres_changes:I,private:A};this.socket.accessTokenValue&&(N.access_token=this.socket.accessTokenValue),this._onError(K=>e?.(qu.CHANNEL_ERROR,K)),this._onClose(()=>e?.(qu.CLOSED)),this.updateJoinPayload(Object.assign({config:V},N)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:K})=>{var ie;if(this.socket._isManualToken()||this.socket.setAuth(),K===void 0){e?.(qu.SUBSCRIBED);return}else{const ne=this.bindings.postgres_changes,ve=(ie=ne?.length)!==null&&ie!==void 0?ie:0,se=[];for(let ge=0;ge<ve;ge++){const ae=ne[ge],{filter:{event:me,schema:ye,table:Se,filter:ze}}=ae,He=K&&K[ge];if(He&&He.event===me&&ip.isFilterValueEqual(He.schema,ye)&&ip.isFilterValueEqual(He.table,Se)&&ip.isFilterValueEqual(He.filter,ze))se.push(Object.assign(Object.assign({},ae),{id:He.id}));else{this.unsubscribe(),this.state=ea.errored,e?.(qu.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=se,e&&e(qu.SUBSCRIBED);return}}).receive("error",K=>{this.state=ea.errored,e?.(qu.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(K).join(", ")||"error")))}).receive("timeout",()=>{e?.(qu.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,l){return this.state===ea.joined&&e===jm.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,l)}async httpSend(e,r,l={}){var f;if(r==null)return Promise.reject("Payload is required for httpSend()");const _={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(_.Authorization=`Bearer ${this.socket.accessTokenValue}`);const y={method:"POST",headers:_,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,y,(f=l.timeout)!==null&&f!==void 0?f:this.timeout);if(d.status===202)return{success:!0};let A=d.statusText;try{const I=await d.json();A=I.error||I.message||A}catch{}return Promise.reject(new Error(A))}async send(e,r={}){var l,f;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:_,payload:y}=e,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const A={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:_,payload:y,private:this.private}]})};try{const I=await this._fetchWithTimeout(this.broadcastEndpointURL,A,(l=r.timeout)!==null&&l!==void 0?l:this.timeout);return await((f=I.body)===null||f===void 0?void 0:f.cancel()),I.ok?"ok":"error"}catch(I){return I.name==="AbortError"?"timed out":"error"}}else return new Promise(_=>{var y,d,A;const I=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((A=(d=(y=this.params)===null||y===void 0?void 0:y.config)===null||d===void 0?void 0:d.broadcast)===null||A===void 0)&&A.ack)&&_("ok"),I.receive("ok",()=>_("ok")),I.receive("error",()=>_("error")),I.receive("timeout",()=>_("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ea.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Cc.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(f=>{l=new rv(this,Cc.leave,{},e),l.receive("ok",()=>{r(),f("ok")}).receive("timeout",()=>{r(),f("timed out")}).receive("error",()=>{f("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ea.closed,this.bindings={}}async _fetchWithTimeout(e,r,l){const f=new AbortController,_=setTimeout(()=>f.abort(),l),y=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:f.signal}));return clearTimeout(_),y}_push(e,r,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let f=new rv(this,e,r,l);return this._canPush()?f.send():this._addToPushBuffer(f),f}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>EI){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,l){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,l){var f,_;const y=e.toLocaleLowerCase(),{close:d,error:A,leave:I,join:B}=Cc;if(l&&[d,A,I,B].indexOf(y)>=0&&l!==this._joinRef())return;let V=this._onMessage(y,r,l);if(r&&!V)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(y)?(f=this.bindings.postgres_changes)===null||f===void 0||f.filter(K=>{var ie,ne,ve;return((ie=K.filter)===null||ie===void 0?void 0:ie.event)==="*"||((ve=(ne=K.filter)===null||ne===void 0?void 0:ne.event)===null||ve===void 0?void 0:ve.toLocaleLowerCase())===y}).map(K=>K.callback(V,l)):(_=this.bindings[y])===null||_===void 0||_.filter(K=>{var ie,ne,ve,se,ge,ae,me,ye;if(["broadcast","presence","postgres_changes"].includes(y))if("id"in K){const Se=K.id,ze=(ie=K.filter)===null||ie===void 0?void 0:ie.event;return Se&&((ne=r.ids)===null||ne===void 0?void 0:ne.includes(Se))&&(ze==="*"||ze?.toLocaleLowerCase()===((ve=r.data)===null||ve===void 0?void 0:ve.type.toLocaleLowerCase()))&&(!(!((se=K.filter)===null||se===void 0)&&se.table)||K.filter.table===((ge=r.data)===null||ge===void 0?void 0:ge.table))}else{const Se=(me=(ae=K?.filter)===null||ae===void 0?void 0:ae.event)===null||me===void 0?void 0:me.toLocaleLowerCase();return Se==="*"||Se===((ye=r?.event)===null||ye===void 0?void 0:ye.toLocaleLowerCase())}else return K.type.toLocaleLowerCase()===y}).map(K=>{if(typeof V=="object"&&"ids"in V){const ie=V.data,{schema:ne,table:ve,commit_timestamp:se,type:ge,errors:ae}=ie;V=Object.assign(Object.assign({},{schema:ne,table:ve,commit_timestamp:se,eventType:ge,new:{},old:{},errors:ae}),this._getPayloadRecords(ie))}K.callback(V,l)})}_isClosed(){return this.state===ea.closed}_isJoined(){return this.state===ea.joined}_isJoining(){return this.state===ea.joining}_isLeaving(){return this.state===ea.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,l){const f=e.toLocaleLowerCase(),_={type:f,filter:r,callback:l};return this.bindings[f]?this.bindings[f].push(_):this.bindings[f]=[_],this}_off(e,r){const l=e.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(f=>{var _;return!(((_=f.type)===null||_===void 0?void 0:_.toLocaleLowerCase())===l&&ip.isEqual(f.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const l in e)if(e[l]!==r[l])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Cc.close,{},e)}_onError(e){this._on(Cc.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ea.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=B0(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=B0(e.columns,e.old_record)),r}}const av=()=>{},gy={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},LI=[1e3,2e3,5e3,1e4],zI=1e4,RI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class DI{constructor(e,r){var l;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zv,this.transport=null,this.heartbeatIntervalMs=gy.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=av,this.ref=0,this.reconnectTimer=null,this.vsn=N0,this.logger=av,this.conn=null,this.sendBuffer=[],this.serializer=new kI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=f=>f?(..._)=>f(..._):(..._)=>fetch(..._),!(!((l=r?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Gv.websocket}`,this.httpEndpoint=MS(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=xI.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,l){this.logger(e,r,l)}connectionState(){switch(this.conn&&this.conn.readyState){case Uh.connecting:return qd.Connecting;case Uh.open:return qd.Open;case Uh.closing:return qd.Closing;default:return qd.Closed}}isConnected(){return this.connectionState()===qd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const l=`realtime:${e}`,f=this.getChannels().find(_=>_.topic===l);if(f)return f;{const _=new ip(`realtime:${e}`,r,this);return this.channels.push(_),_}}push(e){const{topic:r,event:l,payload:f,ref:_}=e,y=()=>{this.encode(e,d=>{var A;(A=this.conn)===null||A===void 0||A.send(d)})};this.log("push",`${r} ${l} (${_})`,f),this.isConnected()?y():this.sendBuffer.push(y)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(TI,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},gy.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(l=>l.topic===e&&(l._isJoined()||l._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const I=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",I)}catch(B){this.log("error","error in heartbeat callback",B)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:l,event:f,payload:_,ref:y}=r,d=y?`(${y})`:"",A=_.status||"";this.log("receive",`${A} ${l} ${f} ${d}`.trim(),_),this.channels.filter(I=>I._isMember(l)).forEach(I=>I._trigger(f,_,y)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Uh.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Uh.open||this.conn.readyState===Uh.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Cc.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const l=e.match(/\?/)?"&":"?",f=new URLSearchParams(r);return`${e}${l}${f}`}_workerObjectUrl(e){let r;if(e)r=e;else{const l=new Blob([RI],{type:"application/javascript"});r=URL.createObjectURL(l)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,l=!1;if(e)r=e,l=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(f){this.log("error","Error fetching access token from callback",f),r=this.accessTokenValue}else r=this.accessTokenValue;l?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(f=>{const _={access_token:r,version:wI};r&&f.updateJoinPayload(_),f.joinedOnce&&f._isJoined()&&f._push(Cc.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(l=>{try{l(r)}catch(f){this.log("error",`error in ${e} callback`,f)}})}catch(l){this.log("error",`error triggering ${e} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new CS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gy.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,l,f,_,y,d,A,I,B,N,V,K;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(l=e?.timeout)!==null&&l!==void 0?l:Zv,this.heartbeatIntervalMs=(f=e?.heartbeatIntervalMs)!==null&&f!==void 0?f:gy.HEARTBEAT_INTERVAL,this.worker=(_=e?.worker)!==null&&_!==void 0?_:!1,this.accessToken=(y=e?.accessToken)!==null&&y!==void 0?y:null,this.heartbeatCallback=(d=e?.heartbeatCallback)!==null&&d!==void 0?d:av,this.vsn=(A=e?.vsn)!==null&&A!==void 0?A:N0,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(I=e?.reconnectAfterMs)!==null&&I!==void 0?I:(ie=>LI[ie-1]||zI),this.vsn){case kS:this.encode=(B=e?.encode)!==null&&B!==void 0?B:((ie,ne)=>ne(JSON.stringify(ie))),this.decode=(N=e?.decode)!==null&&N!==void 0?N:((ie,ne)=>ne(JSON.parse(ie)));break;case SI:this.encode=(V=e?.encode)!==null&&V!==void 0?V:this.serializer.encode.bind(this.serializer),this.decode=(K=e?.decode)!==null&&K!==void 0?K:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Vm=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function OI(t,e,r){const l=new URL(e,t);if(r)for(const[f,_]of Object.entries(r))_!==void 0&&l.searchParams.set(f,_);return l.toString()}async function NI(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function BI(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:l,query:f,body:_,headers:y}){const d=OI(t.baseUrl,l,f),A=await NI(t.auth),I=await e(d,{method:r,headers:{..._?{"Content-Type":"application/json"}:{},...A,...y},body:_?JSON.stringify(_):void 0}),B=await I.text(),N=(I.headers.get("content-type")||"").includes("application/json"),V=N&&B?JSON.parse(B):B;if(!I.ok){const K=N?V:void 0,ie=K?.error;throw new Vm(ie?.message??`Request failed with status ${I.status}`,{status:I.status,icebergType:ie?.type,icebergCode:ie?.code,details:K})}return{status:I.status,headers:I.headers,data:V}}}}function yy(t){return t.join("")}var $I=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:yy(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(l=>({namespace:l}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${yy(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${yy(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${yy(t.namespace)}`}),!0}catch(e){if(e instanceof Vm&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Vm&&r.status===409)return;throw r}}};function $f(t){return t.join("")}var UI=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$f(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${$f(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${$f(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$f(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$f(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$f(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Vm&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Vm&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},FI=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=BI({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new $I(this.client,e),this.tableOps=new UI(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},d_=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function tr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var VI=class extends d_{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Yv=class extends d_{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const $x=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),qI=()=>Response,Xv=t=>{if(Array.isArray(t))return t.map(r=>Xv(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,l])=>{const f=r.replace(/([-_][a-z])/gi,_=>_.toUpperCase().replace(/[-_]/g,""));e[f]=Xv(l)}),e},HI=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},ZI=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function qm(t){"@babel/helpers - typeof";return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qm(t)}function GI(t,e){if(qm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var l=r.call(t,e);if(qm(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WI(t){var e=GI(t,"string");return qm(e)=="symbol"?e:e+""}function YI(t,e,r){return(e=WI(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),r.push.apply(r,l)}return r}function Wi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F0(Object(r),!0).forEach(function(l){YI(t,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F0(Object(r)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(r,l))})}return t}const ov=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},XI=async(t,e,r)=>{t instanceof await qI()&&!r?.noResolveJson?t.json().then(l=>{const f=t.status||500,_=l?.statusCode||f+"";e(new VI(ov(l),f,_))}).catch(l=>{e(new Yv(ov(l),l))}):e(new Yv(ov(t),t))},KI=(t,e,r,l)=>{const f={method:t,headers:e?.headers||{}};return t==="GET"||!l?f:(HI(l)?(f.headers=Wi({"Content-Type":"application/json"},e?.headers),f.body=JSON.stringify(l)):f.body=l,e?.duplex&&(f.duplex=e.duplex),Wi(Wi({},f),r))};async function tg(t,e,r,l,f,_){return new Promise((y,d)=>{t(r,KI(e,l,f,_)).then(A=>{if(!A.ok)throw A;return l?.noResolveJson?A:A.json()}).then(A=>y(A)).catch(A=>XI(A,d,l))})}async function Hm(t,e,r,l){return tg(t,"GET",e,r,l)}async function kc(t,e,r,l,f){return tg(t,"POST",e,l,f,r)}async function Kv(t,e,r,l,f){return tg(t,"PUT",e,l,f,r)}async function JI(t,e,r,l){return tg(t,"HEAD",e,Wi(Wi({},r),{},{noResolveJson:!0}),l)}async function Ux(t,e,r,l,f){return tg(t,"DELETE",e,l,f,r)}var QI=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(tr(e))return{data:null,error:e};throw e}}};let PS;PS=Symbol.toStringTag;var ej=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[PS]="BlobDownloadBuilder",this.promise=null}asStream(){return new QI(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(tr(e))return{data:null,error:e};throw e}}};const tj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},V0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ij=class{constructor(t,e={},r,l){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=$x(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,l){var f=this;try{let _;const y=Wi(Wi({},V0),l);let d=Wi(Wi({},f.headers),t==="POST"&&{"x-upsert":String(y.upsert)});const A=y.metadata;typeof Blob<"u"&&r instanceof Blob?(_=new FormData,_.append("cacheControl",y.cacheControl),A&&_.append("metadata",f.encodeMetadata(A)),_.append("",r)):typeof FormData<"u"&&r instanceof FormData?(_=r,_.has("cacheControl")||_.append("cacheControl",y.cacheControl),A&&!_.has("metadata")&&_.append("metadata",f.encodeMetadata(A))):(_=r,d["cache-control"]=`max-age=${y.cacheControl}`,d["content-type"]=y.contentType,A&&(d["x-metadata"]=f.toBase64(f.encodeMetadata(A))),(typeof ReadableStream<"u"&&_ instanceof ReadableStream||_&&typeof _=="object"&&"pipe"in _&&typeof _.pipe=="function")&&!y.duplex&&(y.duplex="half")),l?.headers&&(d=Wi(Wi({},d),l.headers));const I=f._removeEmptyFolders(e),B=f._getFinalPath(I),N=await(t=="PUT"?Kv:kc)(f.fetch,`${f.url}/object/${B}`,_,Wi({headers:d},y?.duplex?{duplex:y.duplex}:{}));return{data:{path:I,id:N.Id,fullPath:N.Key},error:null}}catch(_){if(f.shouldThrowOnError)throw _;if(tr(_))return{data:null,error:_};throw _}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,l){var f=this;const _=f._removeEmptyFolders(t),y=f._getFinalPath(_),d=new URL(f.url+`/object/upload/sign/${y}`);d.searchParams.set("token",e);try{let A;const I=Wi({upsert:V0.upsert},l),B=Wi(Wi({},f.headers),{"x-upsert":String(I.upsert)});return typeof Blob<"u"&&r instanceof Blob?(A=new FormData,A.append("cacheControl",I.cacheControl),A.append("",r)):typeof FormData<"u"&&r instanceof FormData?(A=r,A.append("cacheControl",I.cacheControl)):(A=r,B["cache-control"]=`max-age=${I.cacheControl}`,B["content-type"]=I.contentType),{data:{path:_,fullPath:(await Kv(f.fetch,d.toString(),A,{headers:B})).Key},error:null}}catch(A){if(f.shouldThrowOnError)throw A;if(tr(A))return{data:null,error:A};throw A}}async createSignedUploadUrl(t,e){var r=this;try{let l=r._getFinalPath(t);const f=Wi({},r.headers);e?.upsert&&(f["x-upsert"]="true");const _=await kc(r.fetch,`${r.url}/object/upload/sign/${l}`,{},{headers:f}),y=new URL(r.url+_.url),d=y.searchParams.get("token");if(!d)throw new d_("No token returned by API");return{data:{signedUrl:y.toString(),path:t,token:d},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(tr(l))return{data:null,error:l};throw l}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var l=this;try{return{data:await kc(l.fetch,`${l.url}/object/move`,{bucketId:l.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:l.headers}),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(tr(f))return{data:null,error:f};throw f}}async copy(t,e,r){var l=this;try{return{data:{path:(await kc(l.fetch,`${l.url}/object/copy`,{bucketId:l.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:l.headers})).Key},error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(tr(f))return{data:null,error:f};throw f}}async createSignedUrl(t,e,r){var l=this;try{let f=l._getFinalPath(t),_=await kc(l.fetch,`${l.url}/object/sign/${f}`,Wi({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:l.headers});const y=r?.download?`&download=${r.download===!0?"":r.download}`:"";return _={signedUrl:encodeURI(`${l.url}${_.signedURL}${y}`)},{data:_,error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(tr(f))return{data:null,error:f};throw f}}async createSignedUrls(t,e,r){var l=this;try{const f=await kc(l.fetch,`${l.url}/object/sign/${l.bucketId}`,{expiresIn:e,paths:t},{headers:l.headers}),_=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:f.map(y=>Wi(Wi({},y),{},{signedUrl:y.signedURL?encodeURI(`${l.url}${y.signedURL}${_}`):null})),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(tr(f))return{data:null,error:f};throw f}}download(t,e){const r=typeof e?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(e?.transform||{}),f=l?`?${l}`:"",_=this._getFinalPath(t),y=()=>Hm(this.fetch,`${this.url}/${r}/${_}${f}`,{headers:this.headers,noResolveJson:!0});return new ej(y,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:Xv(await Hm(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(l){if(e.shouldThrowOnError)throw l;if(tr(l))return{data:null,error:l};throw l}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await JI(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(l){if(e.shouldThrowOnError)throw l;if(tr(l)&&l instanceof Yv){const f=l.originalError;if([400,404].includes(f?.status))return{data:!1,error:l}}throw l}}getPublicUrl(t,e){const r=this._getFinalPath(t),l=[],f=e?.download?`download=${e.download===!0?"":e.download}`:"";f!==""&&l.push(f);const _=typeof e?.transform<"u"?"render/image":"object",y=this.transformOptsToQueryString(e?.transform||{});y!==""&&l.push(y);let d=l.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${_}/public/${r}${d}`)}}}async remove(t){var e=this;try{return{data:await Ux(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}async list(t,e,r){var l=this;try{const f=Wi(Wi(Wi({},tj),e),{},{prefix:t||""});return{data:await kc(l.fetch,`${l.url}/object/list/${l.bucketId}`,f,{headers:l.headers},r),error:null}}catch(f){if(l.shouldThrowOnError)throw f;if(tr(f))return{data:null,error:f};throw f}}async listV2(t,e){var r=this;try{const l=Wi({},t);return{data:await kc(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,l,{headers:r.headers},e),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(tr(l))return{data:null,error:l};throw l}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const IS="2.90.1",jS={"X-Client-Info":`storage-js/${IS}`};var nj=class{constructor(t,e={},r,l){this.shouldThrowOnError=!1;const f=new URL(t);l?.useNewHostname&&/supabase\.(co|in|red)$/.test(f.hostname)&&!f.hostname.includes("storage.supabase.")&&(f.hostname=f.hostname.replace("supabase.","storage.supabase.")),this.url=f.href.replace(/\/$/,""),this.headers=Wi(Wi({},jS),e),this.fetch=$x(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await Hm(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Hm(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await kc(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(tr(l))return{data:null,error:l};throw l}}async updateBucket(t,e){var r=this;try{return{data:await Kv(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(tr(l))return{data:null,error:l};throw l}}async emptyBucket(t){var e=this;try{return{data:await kc(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ux(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},sj=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wi(Wi({},jS),e),this.fetch=$x(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await kc(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const l=r.toString(),f=l?`${e.url}/bucket?${l}`:`${e.url}/bucket`;return{data:await Hm(e.fetch,f,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Ux(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(tr(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!ZI(t))throw new d_("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new FI({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),l=this.shouldThrowOnError;return new Proxy(r,{get(f,_){const y=f[_];return typeof y!="function"?y:async(...d)=>{try{return{data:await y.apply(f,d),error:null}}catch(A){if(l)throw A;return{data:null,error:A}}}}})}};const Fx={"X-Client-Info":`storage-js/${IS}`,"Content-Type":"application/json"};var LS=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Cl(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var lv=class extends LS{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},rj=class extends LS{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Vx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),aj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},q0=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),oj=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const l=t.status||500,f=t;if(typeof f.json=="function")f.json().then(_=>{const y=_?.statusCode||_?.code||l+"";e(new lv(q0(_),l,y))}).catch(()=>{const _=l+"";e(new lv(f.statusText||`HTTP ${l} error`,l,_))});else{const _=l+"";e(new lv(f.statusText||`HTTP ${l} error`,l,_))}}else e(new rj(q0(t),t))},lj=(t,e,r,l)=>{const f={method:t,headers:e?.headers||{}};return l?(aj(l)?(f.headers=Wi({"Content-Type":"application/json"},e?.headers),f.body=JSON.stringify(l)):f.body=l,Wi(Wi({},f),r)):f};async function cj(t,e,r,l,f,_){return new Promise((y,d)=>{t(r,lj(e,l,f,_)).then(A=>{if(!A.ok)throw A;if(l?.noResolveJson)return A;const I=A.headers.get("content-type");return!I||!I.includes("application/json")?{}:A.json()}).then(A=>y(A)).catch(A=>oj(A,d,l))})}async function Al(t,e,r,l,f){return cj(t,"POST",e,l,f,r)}var uj=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wi(Wi({},Fx),e),this.fetch=Vx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await Al(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(Cl(l))return{data:null,error:l};throw l}}async listIndexes(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await Al(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(Cl(l))return{data:null,error:l};throw l}}},hj=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wi(Wi({},Fx),e),this.fetch=Vx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Al(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Al(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Al(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}},dj=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wi(Wi({},Fx),e),this.fetch=Vx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await Al(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Al(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Cl(r))return{data:null,error:r};throw r}}},fj=class extends dj{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new pj(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},pj=class extends uj{constructor(t,e,r,l){super(t,e,l),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,Wi(Wi({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,Wi(Wi({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new mj(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},mj=class extends hj{constructor(t,e,r,l,f){super(t,e,f),this.vectorBucketName=r,this.indexName=l}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,Wi(Wi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,Wi(Wi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,Wi(Wi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,Wi(Wi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,Wi(Wi({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},gj=class extends nj{constructor(t,e={},r,l){super(t,e,r,l)}from(t){return new ij(this.url,this.headers,t,this.fetch)}get vectors(){return new fj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new sj(this.url+"/iceberg",this.headers,this.fetch)}};const zS="2.90.1",Kf=30*1e3,Jv=3,cv=Jv*Kf,yj="http://localhost:9999",_j="supabase.auth.token",vj={"X-Client-Info":`gotrue-js/${zS}`},Qv="X-Supabase-Api-Version",RS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},xj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,bj=600*1e3;class Zm extends Error{constructor(e,r,l){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=l}}function zi(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class wj extends Zm{constructor(e,r,l){super(e,r,l),this.name="AuthApiError",this.status=r,this.code=l}}function Sj(t){return zi(t)&&t.name==="AuthApiError"}class Hd extends Zm{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Ju extends Zm{constructor(e,r,l,f){super(e,l,f),this.name=r,this.status=l}}class kl extends Ju{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Tj(t){return zi(t)&&t.name==="AuthSessionMissingError"}class Uf extends Ju{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _y extends Ju{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class vy extends Ju{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ej(t){return zi(t)&&t.name==="AuthImplicitGrantRedirectError"}class H0 extends Ju{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class kj extends Ju{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ex extends Ju{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function uv(t){return zi(t)&&t.name==="AuthRetryableFetchError"}class Z0 extends Ju{constructor(e,r,l){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=l}}class tx extends Ju{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),G0=` 	
\r=`.split(""),Cj=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<G0.length;e+=1)t[G0[e].charCodeAt(0)]=-2;for(let e=0;e<Jy.length;e+=1)t[Jy[e].charCodeAt(0)]=e;return t})();function W0(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const l=e.queue>>e.queuedBits-6&63;r(Jy[l]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const l=e.queue>>e.queuedBits-6&63;r(Jy[l]),e.queuedBits-=6}}function DS(t,e,r){const l=Cj[t];if(l>-1)for(e.queue=e.queue<<6|l,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Y0(t){const e=[],r=y=>{e.push(String.fromCodePoint(y))},l={utf8seq:0,codepoint:0},f={queue:0,queuedBits:0},_=y=>{Pj(y,l,r)};for(let y=0;y<t.length;y+=1)DS(t.charCodeAt(y),f,_);return e.join("")}function Aj(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Mj(t,e){for(let r=0;r<t.length;r+=1){let l=t.charCodeAt(r);if(l>55295&&l<=56319){const f=(l-55296)*1024&65535;l=(t.charCodeAt(r+1)-56320&65535|f)+65536,r+=1}Aj(l,e)}}function Pj(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let l=1;l<6;l+=1)if((t>>7-l&1)===0){e.utf8seq=l;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function lp(t){const e=[],r={queue:0,queuedBits:0},l=f=>{e.push(f)};for(let f=0;f<t.length;f+=1)DS(t.charCodeAt(f),r,l);return new Uint8Array(e)}function Ij(t){const e=[];return Mj(t,r=>e.push(r)),new Uint8Array(e)}function Gd(t){const e=[],r={queue:0,queuedBits:0},l=f=>{e.push(f)};return t.forEach(f=>W0(f,r,l)),W0(null,r,l),e.join("")}function jj(t){return Math.round(Date.now()/1e3)+t}function Lj(){return Symbol("auth-callback")}const ja=()=>typeof window<"u"&&typeof document<"u",Ud={tested:!1,writable:!1},OS=()=>{if(!ja())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ud.tested)return Ud.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ud.tested=!0,Ud.writable=!0}catch{Ud.tested=!0,Ud.writable=!1}return Ud.writable};function zj(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((f,_)=>{e[_]=f})}catch{}return r.searchParams.forEach((l,f)=>{e[f]=l}),e}const NS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Rj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Jf=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Fd=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ia=async(t,e)=>{await t.removeItem(e)};class f_{constructor(){this.promise=new f_.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}f_.promiseConstructor=Promise;function hv(t){const e=t.split(".");if(e.length!==3)throw new tx("Invalid JWT structure");for(let l=0;l<e.length;l++)if(!xj.test(e[l]))throw new tx("JWT not in base64url format");return{header:JSON.parse(Y0(e[0])),payload:JSON.parse(Y0(e[1])),signature:lp(e[2]),raw:{header:e[0],payload:e[1]}}}async function Dj(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Oj(t,e){return new Promise((l,f)=>{(async()=>{for(let _=0;_<1/0;_++)try{const y=await t(_);if(!e(_,null,y)){l(y);return}}catch(y){if(!e(_,y)){f(y);return}}})()})}function Nj(t){return("0"+t.toString(16)).substr(-2)}function Bj(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=r.length;let f="";for(let _=0;_<56;_++)f+=r.charAt(Math.floor(Math.random()*l));return f}return crypto.getRandomValues(e),Array.from(e,Nj).join("")}async function $j(t){const r=new TextEncoder().encode(t),l=await crypto.subtle.digest("SHA-256",r),f=new Uint8Array(l);return Array.from(f).map(_=>String.fromCharCode(_)).join("")}async function Uj(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await $j(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ff(t,e,r=!1){const l=Bj();let f=l;r&&(f+="/PASSWORD_RECOVERY"),await Jf(t,`${e}-code-verifier`,f);const _=await Uj(l);return[_,l===_?"plain":"s256"]}const Fj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Vj(t){const e=t.headers.get(Qv);if(!e||!e.match(Fj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function qj(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Hj(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Zj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vf(t){if(!Zj.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dv(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Gj(t,e){return new Proxy(t,{get:(r,l,f)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const _=l.toString();if(_==="Symbol(Symbol.toPrimitive)"||_==="Symbol(Symbol.toStringTag)"||_==="Symbol(util.inspect.custom)"||_==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,l,f)}return!e.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,l,f)}})}function X0(t){return JSON.parse(JSON.stringify(t))}const Vd=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Wj=[502,503,504];async function K0(t){var e;if(!Rj(t))throw new ex(Vd(t),0);if(Wj.includes(t.status))throw new ex(Vd(t),t.status);let r;try{r=await t.json()}catch(_){throw new Hd(Vd(_),_)}let l;const f=Vj(t);if(f&&f.getTime()>=RS["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?l=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(l=r.error_code),l){if(l==="weak_password")throw new Z0(Vd(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(l==="session_not_found")throw new kl}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((_,y)=>_&&typeof y=="string",!0))throw new Z0(Vd(r),t.status,r.weak_password.reasons);throw new wj(Vd(r),t.status||500,l)}const Yj=(t,e,r,l)=>{const f={method:t,headers:e?.headers||{}};return t==="GET"?f:(f.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),f.body=JSON.stringify(l),Object.assign(Object.assign({},f),r))};async function Gi(t,e,r,l){var f;const _=Object.assign({},l?.headers);_[Qv]||(_[Qv]=RS["2024-01-01"].name),l?.jwt&&(_.Authorization=`Bearer ${l.jwt}`);const y=(f=l?.query)!==null&&f!==void 0?f:{};l?.redirectTo&&(y.redirect_to=l.redirectTo);const d=Object.keys(y).length?"?"+new URLSearchParams(y).toString():"",A=await Xj(t,e,r+d,{headers:_,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(A):{data:Object.assign({},A),error:null}}async function Xj(t,e,r,l,f,_){const y=Yj(e,l,f,_);let d;try{d=await t(r,Object.assign({},y))}catch(A){throw console.error(A),new ex(Vd(A),0)}if(d.ok||await K0(d),l?.noResolveJson)return d;try{return await d.json()}catch(A){await K0(A)}}function Tc(t){var e;let r=null;Qj(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=jj(t.expires_in)));const l=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:l},error:null}}function J0(t){const e=Tc(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,l)=>r&&typeof l=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Fh(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Kj(t){return{data:t,error:null}}function Jj(t){const{action_link:e,email_otp:r,hashed_token:l,redirect_to:f,verification_type:_}=t,y=Xu(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:r,hashed_token:l,redirect_to:f,verification_type:_},A=Object.assign({},y);return{data:{properties:d,user:A},error:null}}function Q0(t){return t}function Qj(t){return t.access_token&&t.refresh_token&&t.expires_in}const fv=["global","local","others"];class eL{constructor({url:e="",headers:r={},fetch:l}){this.url=e,this.headers=r,this.fetch=NS(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=fv[0]){if(fv.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fv.join(", ")}`);try{return await Gi(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(l){if(zi(l))return{data:null,error:l};throw l}}async inviteUserByEmail(e,r={}){try{return await Gi(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Fh})}catch(l){if(zi(l))return{data:{user:null},error:l};throw l}}async generateLink(e){try{const{options:r}=e,l=Xu(e,["options"]),f=Object.assign(Object.assign({},l),r);return"newEmail"in l&&(f.new_email=l?.newEmail,delete f.newEmail),await Gi(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:f,headers:this.headers,xform:Jj,redirectTo:r?.redirectTo})}catch(r){if(zi(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Gi(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fh})}catch(r){if(zi(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,l,f,_,y,d,A;try{const I={nextPage:null,lastPage:0,total:0},B=await Gi(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(_=(f=e?.perPage)===null||f===void 0?void 0:f.toString())!==null&&_!==void 0?_:""},xform:Q0});if(B.error)throw B.error;const N=await B.json(),V=(y=B.headers.get("x-total-count"))!==null&&y!==void 0?y:0,K=(A=(d=B.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&A!==void 0?A:[];return K.length>0&&(K.forEach(ie=>{const ne=parseInt(ie.split(";")[0].split("=")[1].substring(0,1)),ve=JSON.parse(ie.split(";")[1].split("=")[1]);I[`${ve}Page`]=ne}),I.total=parseInt(V)),{data:Object.assign(Object.assign({},N),I),error:null}}catch(I){if(zi(I))return{data:{users:[]},error:I};throw I}}async getUserById(e){Vf(e);try{return await Gi(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fh})}catch(r){if(zi(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Vf(e);try{return await Gi(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Fh})}catch(l){if(zi(l))return{data:{user:null},error:l};throw l}}async deleteUser(e,r=!1){Vf(e);try{return await Gi(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Fh})}catch(l){if(zi(l))return{data:{user:null},error:l};throw l}}async _listFactors(e){Vf(e.userId);try{const{data:r,error:l}=await Gi(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:f=>({data:{factors:f},error:null})});return{data:r,error:l}}catch(r){if(zi(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Vf(e.userId),Vf(e.id);try{return{data:await Gi(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(zi(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,l,f,_,y,d,A;try{const I={nextPage:null,lastPage:0,total:0},B=await Gi(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(_=(f=e?.perPage)===null||f===void 0?void 0:f.toString())!==null&&_!==void 0?_:""},xform:Q0});if(B.error)throw B.error;const N=await B.json(),V=(y=B.headers.get("x-total-count"))!==null&&y!==void 0?y:0,K=(A=(d=B.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&A!==void 0?A:[];return K.length>0&&(K.forEach(ie=>{const ne=parseInt(ie.split(";")[0].split("=")[1].substring(0,1)),ve=JSON.parse(ie.split(";")[1].split("=")[1]);I[`${ve}Page`]=ne}),I.total=parseInt(V)),{data:Object.assign(Object.assign({},N),I),error:null}}catch(I){if(zi(I))return{data:{clients:[]},error:I};throw I}}async _createOAuthClient(e){try{return await Gi(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(zi(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Gi(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(zi(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Gi(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(zi(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(e){try{return await Gi(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(zi(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Gi(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(zi(r))return{data:null,error:r};throw r}}}function ew(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const qf={debug:!!(globalThis&&OS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class BS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tL extends BS{}async function iL(t,e,r){qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const l=new globalThis.AbortController;return e>0&&setTimeout(()=>{l.abort(),qf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async f=>{if(f){qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,f.name);try{return await r()}finally{qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,f.name)}}else{if(e===0)throw qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new tL(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(qf.debug)try{const _=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(_,null,"  "))}catch(_){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",_)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function nL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function $S(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function sL(t){return parseInt(t,16)}function rL(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,l=>l.toString(16).padStart(2,"0")).join("")}function aL(t){var e;const{chainId:r,domain:l,expirationTime:f,issuedAt:_=new Date,nonce:y,notBefore:d,requestId:A,resources:I,scheme:B,uri:N,version:V}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(y&&y.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${y}`);if(!N)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(V!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${V}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const K=$S(t.address),ie=B?`${B}://${l}`:l,ne=t.statement?`${t.statement}
`:"",ve=`${ie} wants you to sign in with your Ethereum account:
${K}

${ne}`;let se=`URI: ${N}
Version: ${V}
Chain ID: ${r}${y?`
Nonce: ${y}`:""}
Issued At: ${_.toISOString()}`;if(f&&(se+=`
Expiration Time: ${f.toISOString()}`),d&&(se+=`
Not Before: ${d.toISOString()}`),A&&(se+=`
Request ID: ${A}`),I){let ge=`
Resources:`;for(const ae of I){if(!ae||typeof ae!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${ae}`);ge+=`
- ${ae}`}se+=ge}return`${ve}
${se}`}class Nr extends Error{constructor({message:e,code:r,cause:l,name:f}){var _;super(e,{cause:l}),this.__isWebAuthnError=!0,this.name=(_=f??(l instanceof Error?l.name:void 0))!==null&&_!==void 0?_:"Unknown Error",this.code=r}}class Qy extends Nr{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function oL({error:t,options:e}){var r,l,f;const{publicKey:_}=e;if(!_)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Nr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=_.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Nr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((l=_.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Nr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((f=_.authenticatorSelection)===null||f===void 0?void 0:f.userVerification)==="required")return new Nr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Nr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Nr({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return _.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Nr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Nr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const y=window.location.hostname;if(US(y)){if(_.rp.id!==y)return new Nr({message:`The RP ID "${_.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Nr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(_.user.id.byteLength<1||_.user.id.byteLength>64)return new Nr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Nr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function lL({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Nr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Nr({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(US(l)){if(r.rpId!==l)return new Nr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Nr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Nr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class cL{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const uL=new cL;function hL(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:l}=t,f=Xu(t,["challenge","user","excludeCredentials"]),_=lp(e).buffer,y=Object.assign(Object.assign({},r),{id:lp(r.id).buffer}),d=Object.assign(Object.assign({},f),{challenge:_,user:y});if(l&&l.length>0){d.excludeCredentials=new Array(l.length);for(let A=0;A<l.length;A++){const I=l[A];d.excludeCredentials[A]=Object.assign(Object.assign({},I),{id:lp(I.id).buffer,type:I.type||"public-key",transports:I.transports})}}return d}function dL(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,l=Xu(t,["challenge","allowCredentials"]),f=lp(e).buffer,_=Object.assign(Object.assign({},l),{challenge:f});if(r&&r.length>0){_.allowCredentials=new Array(r.length);for(let y=0;y<r.length;y++){const d=r[y];_.allowCredentials[y]=Object.assign(Object.assign({},d),{id:lp(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return _}function fL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Gd(new Uint8Array(t.response.attestationObject)),clientDataJSON:Gd(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function pL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,l=t.getClientExtensionResults(),f=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Gd(new Uint8Array(f.authenticatorData)),clientDataJSON:Gd(new Uint8Array(f.clientDataJSON)),signature:Gd(new Uint8Array(f.signature)),userHandle:f.userHandle?Gd(new Uint8Array(f.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function US(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function tw(){var t,e;return!!(ja()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function mL(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Qy("Browser returned unexpected credential type",e)}:{data:null,error:new Qy("Empty credential response",e)}}catch(e){return{data:null,error:oL({error:e,options:t})}}}async function gL(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Qy("Browser returned unexpected credential type",e)}:{data:null,error:new Qy("Empty credential response",e)}}catch(e){return{data:null,error:lL({error:e,options:t})}}}const yL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},_L={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function e_(...t){const e=f=>f!==null&&typeof f=="object"&&!Array.isArray(f),r=f=>f instanceof ArrayBuffer||ArrayBuffer.isView(f),l={};for(const f of t)if(f)for(const _ in f){const y=f[_];if(y!==void 0)if(Array.isArray(y))l[_]=y;else if(r(y))l[_]=y;else if(e(y)){const d=l[_];e(d)?l[_]=e_(d,y):l[_]=e_(y)}else l[_]=y}return l}function vL(t,e){return e_(yL,t,e||{})}function xL(t,e){return e_(_L,t,e||{})}class bL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:l,signal:f},_){try{const{data:y,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!y)return{data:null,error:d};const A=f??uL.createNewAbortSignal();if(y.webauthn.type==="create"){const{user:I}=y.webauthn.credential_options.publicKey;I.name||(I.name=`${I.id}:${l}`),I.displayName||(I.displayName=I.name)}switch(y.webauthn.type){case"create":{const I=vL(y.webauthn.credential_options.publicKey,_?.create),{data:B,error:N}=await mL({publicKey:I,signal:A});return B?{data:{factorId:e,challengeId:y.id,webauthn:{type:y.webauthn.type,credential_response:B}},error:null}:{data:null,error:N}}case"request":{const I=xL(y.webauthn.credential_options.publicKey,_?.request),{data:B,error:N}=await gL(Object.assign(Object.assign({},y.webauthn.credential_options),{publicKey:I,signal:A}));return B?{data:{factorId:e,challengeId:y.id,webauthn:{type:y.webauthn.type,credential_response:B}},error:null}:{data:null,error:N}}}}catch(y){return zi(y)?{data:null,error:y}:{data:null,error:new Hd("Unexpected error in challenge",y)}}}async _verify({challengeId:e,factorId:r,webauthn:l}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:l})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:f}={}},_){if(!r)return{data:null,error:new Zm("rpId is required for WebAuthn authentication")};try{if(!tw())return{data:null,error:new Hd("Browser does not support WebAuthn",null)};const{data:y,error:d}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:l},signal:f},{request:_});if(!y)return{data:null,error:d};const{webauthn:A}=y;return this._verify({factorId:e,challengeId:y.challengeId,webauthn:{type:A.type,rpId:r,rpOrigins:l,credential_response:A.credential_response}})}catch(y){return zi(y)?{data:null,error:y}:{data:null,error:new Hd("Unexpected error in authenticate",y)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:f}={}},_){if(!r)return{data:null,error:new Zm("rpId is required for WebAuthn registration")};try{if(!tw())return{data:null,error:new Hd("Browser does not support WebAuthn",null)};const{data:y,error:d}=await this._enroll({friendlyName:e});if(!y)return await this.client.mfa.listFactors().then(B=>{var N;return(N=B.data)===null||N===void 0?void 0:N.all.find(V=>V.factor_type==="webauthn"&&V.friendly_name===e&&V.status!=="unverified")}).then(B=>B?this.client.mfa.unenroll({factorId:B?.id}):void 0),{data:null,error:d};const{data:A,error:I}=await this._challenge({factorId:y.id,friendlyName:y.friendly_name,webauthn:{rpId:r,rpOrigins:l},signal:f},{create:_});return A?this._verify({factorId:y.id,challengeId:A.challengeId,webauthn:{rpId:r,rpOrigins:l,type:A.webauthn.type,credential_response:A.webauthn.credential_response}}):{data:null,error:I}}catch(y){return zi(y)?{data:null,error:y}:{data:null,error:new Hd("Unexpected error in register",y)}}}}nL();const wL={url:yj,storageKey:_j,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function iw(t,e,r){return await r()}const Hf={};class Gm{get jwks(){var e,r;return(r=(e=Hf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Hf[this.storageKey]=Object.assign(Object.assign({},Hf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Hf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Hf[this.storageKey]=Object.assign(Object.assign({},Hf[this.storageKey]),{cachedAt:e})}constructor(e){var r,l,f;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const _=Object.assign(Object.assign({},wL),e);if(this.storageKey=_.storageKey,this.instanceID=(r=Gm.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Gm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!_.debug,typeof _.debug=="function"&&(this.logger=_.debug),this.instanceID>0&&ja()){const y=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(y),this.logDebugMessages&&console.trace(y)}if(this.persistSession=_.persistSession,this.autoRefreshToken=_.autoRefreshToken,this.admin=new eL({url:_.url,headers:_.headers,fetch:_.fetch}),this.url=_.url,this.headers=_.headers,this.fetch=NS(_.fetch),this.lock=_.lock||iw,this.detectSessionInUrl=_.detectSessionInUrl,this.flowType=_.flowType,this.hasCustomAuthorizationHeader=_.hasCustomAuthorizationHeader,this.throwOnError=_.throwOnError,this.lockAcquireTimeout=_.lockAcquireTimeout,_.lock?this.lock=_.lock:this.persistSession&&ja()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=iL:this.lock=iw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new bL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(_.storage?this.storage=_.storage:OS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ew(this.memoryStorage)),_.userStorage&&(this.userStorage=_.userStorage)):(this.memoryStorage={},this.storage=ew(this.memoryStorage)),ja()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(y){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",y)}(f=this.broadcastChannel)===null||f===void 0||f.addEventListener("message",async y=>{this._debug("received broadcast notification from other tab or client",y),await this._notifyAllSubscribers(y.data.event,y.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${zS}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},l="none";if(ja()&&(r=zj(window.location.href),this._isImplicitGrantCallback(r)?l="implicit":await this._isPKCECallback(r)&&(l="pkce")),ja()&&this.detectSessionInUrl&&l!=="none"){const{data:f,error:_}=await this._getSessionFromURL(r,l);if(_){if(this._debug("#_initialize()","error detecting session from URL",_),Ej(_)){const A=(e=_.details)===null||e===void 0?void 0:e.code;if(A==="identity_already_exists"||A==="identity_not_found"||A==="single_identity_not_deletable")return{error:_}}return{error:_}}const{session:y,redirectType:d}=f;return this._debug("#_initialize()","detected session in URL",y,"redirect type",d),await this._saveSession(y),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",y):await this._notifyAllSubscribers("SIGNED_IN",y)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return zi(r)?this._returnResult({error:r}):this._returnResult({error:new Hd("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,l,f;try{const _=await Gi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(f=e?.options)===null||f===void 0?void 0:f.captchaToken}},xform:Tc}),{data:y,error:d}=_;if(d||!y)return this._returnResult({data:{user:null,session:null},error:d});const A=y.session,I=y.user;return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",A)),this._returnResult({data:{user:I,session:A},error:null})}catch(_){if(zi(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signUp(e){var r,l,f;try{let _;if("email"in e){const{email:B,password:N,options:V}=e;let K=null,ie=null;this.flowType==="pkce"&&([K,ie]=await Ff(this.storage,this.storageKey)),_=await Gi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:V?.emailRedirectTo,body:{email:B,password:N,data:(r=V?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:V?.captchaToken},code_challenge:K,code_challenge_method:ie},xform:Tc})}else if("phone"in e){const{phone:B,password:N,options:V}=e;_=await Gi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:B,password:N,data:(l=V?.data)!==null&&l!==void 0?l:{},channel:(f=V?.channel)!==null&&f!==void 0?f:"sms",gotrue_meta_security:{captcha_token:V?.captchaToken}},xform:Tc})}else throw new _y("You must provide either an email or phone number and a password");const{data:y,error:d}=_;if(d||!y)return await Ia(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const A=y.session,I=y.user;return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",A)),this._returnResult({data:{user:I,session:A},error:null})}catch(_){if(await Ia(this.storage,`${this.storageKey}-code-verifier`),zi(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithPassword(e){try{let r;if("email"in e){const{email:_,password:y,options:d}=e;r=await Gi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:_,password:y,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:J0})}else if("phone"in e){const{phone:_,password:y,options:d}=e;r=await Gi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:_,password:y,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:J0})}else throw new _y("You must provide either an email or phone number and a password");const{data:l,error:f}=r;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!l||!l.session||!l.user){const _=new Uf;return this._returnResult({data:{user:null,session:null},error:_})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:f})}catch(r){if(zi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,l,f,_;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:(_=e.options)===null||_===void 0?void 0:_.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,l,f,_,y,d,A,I,B,N,V;let K,ie;if("message"in e)K=e.message,ie=e.signature;else{const{chain:ne,wallet:ve,statement:se,options:ge}=e;let ae;if(ja())if(typeof ve=="object")ae=ve;else{const Ze=window;if("ethereum"in Ze&&typeof Ze.ethereum=="object"&&"request"in Ze.ethereum&&typeof Ze.ethereum.request=="function")ae=Ze.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof ve!="object"||!ge?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");ae=ve}const me=new URL((r=ge?.url)!==null&&r!==void 0?r:window.location.href),ye=await ae.request({method:"eth_requestAccounts"}).then(Ze=>Ze).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ye||ye.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const Se=$S(ye[0]);let ze=(l=ge?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!ze){const Ze=await ae.request({method:"eth_chainId"});ze=sL(Ze)}const He={domain:me.host,address:Se,statement:se,uri:me.href,version:"1",chainId:ze,nonce:(f=ge?.signInWithEthereum)===null||f===void 0?void 0:f.nonce,issuedAt:(y=(_=ge?.signInWithEthereum)===null||_===void 0?void 0:_.issuedAt)!==null&&y!==void 0?y:new Date,expirationTime:(d=ge?.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(A=ge?.signInWithEthereum)===null||A===void 0?void 0:A.notBefore,requestId:(I=ge?.signInWithEthereum)===null||I===void 0?void 0:I.requestId,resources:(B=ge?.signInWithEthereum)===null||B===void 0?void 0:B.resources};K=aL(He),ie=await ae.request({method:"personal_sign",params:[rL(K),Se]})}try{const{data:ne,error:ve}=await Gi(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:K,signature:ie},!((N=e.options)===null||N===void 0)&&N.captchaToken?{gotrue_meta_security:{captcha_token:(V=e.options)===null||V===void 0?void 0:V.captchaToken}}:null),xform:Tc});if(ve)throw ve;if(!ne||!ne.session||!ne.user){const se=new Uf;return this._returnResult({data:{user:null,session:null},error:se})}return ne.session&&(await this._saveSession(ne.session),await this._notifyAllSubscribers("SIGNED_IN",ne.session)),this._returnResult({data:Object.assign({},ne),error:ve})}catch(ne){if(zi(ne))return this._returnResult({data:{user:null,session:null},error:ne});throw ne}}async signInWithSolana(e){var r,l,f,_,y,d,A,I,B,N,V,K;let ie,ne;if("message"in e)ie=e.message,ne=e.signature;else{const{chain:ve,wallet:se,statement:ge,options:ae}=e;let me;if(ja())if(typeof se=="object")me=se;else{const Se=window;if("solana"in Se&&typeof Se.solana=="object"&&("signIn"in Se.solana&&typeof Se.solana.signIn=="function"||"signMessage"in Se.solana&&typeof Se.solana.signMessage=="function"))me=Se.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof se!="object"||!ae?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");me=se}const ye=new URL((r=ae?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in me&&me.signIn){const Se=await me.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},ae?.signInWithSolana),{version:"1",domain:ye.host,uri:ye.href}),ge?{statement:ge}:null));let ze;if(Array.isArray(Se)&&Se[0]&&typeof Se[0]=="object")ze=Se[0];else if(Se&&typeof Se=="object"&&"signedMessage"in Se&&"signature"in Se)ze=Se;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ze&&"signature"in ze&&(typeof ze.signedMessage=="string"||ze.signedMessage instanceof Uint8Array)&&ze.signature instanceof Uint8Array)ie=typeof ze.signedMessage=="string"?ze.signedMessage:new TextDecoder().decode(ze.signedMessage),ne=ze.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in me)||typeof me.signMessage!="function"||!("publicKey"in me)||typeof me!="object"||!me.publicKey||!("toBase58"in me.publicKey)||typeof me.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");ie=[`${ye.host} wants you to sign in with your Solana account:`,me.publicKey.toBase58(),...ge?["",ge,""]:[""],"Version: 1",`URI: ${ye.href}`,`Issued At: ${(f=(l=ae?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date().toISOString()}`,...!((_=ae?.signInWithSolana)===null||_===void 0)&&_.notBefore?[`Not Before: ${ae.signInWithSolana.notBefore}`]:[],...!((y=ae?.signInWithSolana)===null||y===void 0)&&y.expirationTime?[`Expiration Time: ${ae.signInWithSolana.expirationTime}`]:[],...!((d=ae?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${ae.signInWithSolana.chainId}`]:[],...!((A=ae?.signInWithSolana)===null||A===void 0)&&A.nonce?[`Nonce: ${ae.signInWithSolana.nonce}`]:[],...!((I=ae?.signInWithSolana)===null||I===void 0)&&I.requestId?[`Request ID: ${ae.signInWithSolana.requestId}`]:[],...!((N=(B=ae?.signInWithSolana)===null||B===void 0?void 0:B.resources)===null||N===void 0)&&N.length?["Resources",...ae.signInWithSolana.resources.map(ze=>`- ${ze}`)]:[]].join(`
`);const Se=await me.signMessage(new TextEncoder().encode(ie),"utf8");if(!Se||!(Se instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");ne=Se}}try{const{data:ve,error:se}=await Gi(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:ie,signature:Gd(ne)},!((V=e.options)===null||V===void 0)&&V.captchaToken?{gotrue_meta_security:{captcha_token:(K=e.options)===null||K===void 0?void 0:K.captchaToken}}:null),xform:Tc});if(se)throw se;if(!ve||!ve.session||!ve.user){const ge=new Uf;return this._returnResult({data:{user:null,session:null},error:ge})}return ve.session&&(await this._saveSession(ve.session),await this._notifyAllSubscribers("SIGNED_IN",ve.session)),this._returnResult({data:Object.assign({},ve),error:se})}catch(ve){if(zi(ve))return this._returnResult({data:{user:null,session:null},error:ve});throw ve}}async _exchangeCodeForSession(e){const r=await Fd(this.storage,`${this.storageKey}-code-verifier`),[l,f]=(r??"").split("/");try{if(!l&&this.flowType==="pkce")throw new kj;const{data:_,error:y}=await Gi(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:l},xform:Tc});if(await Ia(this.storage,`${this.storageKey}-code-verifier`),y)throw y;if(!_||!_.session||!_.user){const d=new Uf;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign(Object.assign({},_),{redirectType:f??null}),error:y})}catch(_){if(await Ia(this.storage,`${this.storageKey}-code-verifier`),zi(_))return this._returnResult({data:{user:null,session:null,redirectType:null},error:_});throw _}}async signInWithIdToken(e){try{const{options:r,provider:l,token:f,access_token:_,nonce:y}=e,d=await Gi(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:f,access_token:_,nonce:y,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Tc}),{data:A,error:I}=d;if(I)return this._returnResult({data:{user:null,session:null},error:I});if(!A||!A.session||!A.user){const B=new Uf;return this._returnResult({data:{user:null,session:null},error:B})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:A,error:I})}catch(r){if(zi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,l,f,_,y;try{if("email"in e){const{email:d,options:A}=e;let I=null,B=null;this.flowType==="pkce"&&([I,B]=await Ff(this.storage,this.storageKey));const{error:N}=await Gi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=A?.data)!==null&&r!==void 0?r:{},create_user:(l=A?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:A?.captchaToken},code_challenge:I,code_challenge_method:B},redirectTo:A?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:N})}if("phone"in e){const{phone:d,options:A}=e,{data:I,error:B}=await Gi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(f=A?.data)!==null&&f!==void 0?f:{},create_user:(_=A?.shouldCreateUser)!==null&&_!==void 0?_:!0,gotrue_meta_security:{captcha_token:A?.captchaToken},channel:(y=A?.channel)!==null&&y!==void 0?y:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:I?.message_id},error:B})}throw new _y("You must provide either an email or phone number.")}catch(d){if(await Ia(this.storage,`${this.storageKey}-code-verifier`),zi(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var r,l;try{let f,_;"options"in e&&(f=(r=e.options)===null||r===void 0?void 0:r.redirectTo,_=(l=e.options)===null||l===void 0?void 0:l.captchaToken);const{data:y,error:d}=await Gi(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:_}}),redirectTo:f,xform:Tc});if(d)throw d;if(!y)throw new Error("An error occurred on token verification.");const A=y.session,I=y.user;return A?.access_token&&(await this._saveSession(A),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",A)),this._returnResult({data:{user:I,session:A},error:null})}catch(f){if(zi(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async signInWithSSO(e){var r,l,f,_,y;try{let d=null,A=null;this.flowType==="pkce"&&([d,A]=await Ff(this.storage,this.storageKey));const I=await Gi(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(l=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&l!==void 0?l:void 0}),!((f=e?.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:A}),headers:this.headers,xform:Kj});return!((_=I.data)===null||_===void 0)&&_.url&&ja()&&!(!((y=e.options)===null||y===void 0)&&y.skipBrowserRedirect)&&window.location.assign(I.data.url),this._returnResult(I)}catch(d){if(await Ia(this.storage,`${this.storageKey}-code-verifier`),zi(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:l}=e;if(l)throw l;if(!r)throw new kl;const{error:f}=await Gi(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:f})})}catch(e){if(zi(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:l,type:f,options:_}=e,{error:y}=await Gi(this.fetch,"POST",r,{headers:this.headers,body:{email:l,type:f,gotrue_meta_security:{captcha_token:_?.captchaToken}},redirectTo:_?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}else if("phone"in e){const{phone:l,type:f,options:_}=e,{data:y,error:d}=await Gi(this.fetch,"POST",r,{headers:this.headers,body:{phone:l,type:f,gotrue_meta_security:{captcha_token:_?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:y?.message_id},error:d})}throw new _y("You must provide either an email or phone number and a type")}catch(r){if(zi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),f=(async()=>(await l,await r()))();return this.pendingInLock.push((async()=>{try{await f}catch{}})()),f}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=r();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const f=[...this.pendingInLock];await Promise.all(f),this.pendingInLock.splice(0,f.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Fd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const l=e.expires_at?e.expires_at*1e3-Date.now()<cv:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",e.expires_at),!l){if(this.userStorage){const y=await Fd(this.userStorage,this.storageKey+"-user");y?.user?e.user=y.user:e.user=dv()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const y={value:this.suppressGetSessionWarning};e.user=Gj(e.user,y),y.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:f,error:_}=await this._callRefreshToken(e.refresh_token);return _?this._returnResult({data:{session:null},error:_}):this._returnResult({data:{session:f},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await Gi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fh}):await this._useSession(async r=>{var l,f,_;const{data:y,error:d}=r;if(d)throw d;return!(!((l=y.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kl}:await Gi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(_=(f=y.session)===null||f===void 0?void 0:f.access_token)!==null&&_!==void 0?_:void 0,xform:Fh})})}catch(r){if(zi(r))return Tj(r)&&(await this._removeSession(),await Ia(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async l=>{const{data:f,error:_}=l;if(_)throw _;if(!f.session)throw new kl;const y=f.session;let d=null,A=null;this.flowType==="pkce"&&e.email!=null&&([d,A]=await Ff(this.storage,this.storageKey));const{data:I,error:B}=await Gi(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:A}),jwt:y.access_token,xform:Fh});if(B)throw B;return y.user=I.user,await this._saveSession(y),await this._notifyAllSubscribers("USER_UPDATED",y),this._returnResult({data:{user:y.user},error:null})})}catch(l){if(await Ia(this.storage,`${this.storageKey}-code-verifier`),zi(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kl;const r=Date.now()/1e3;let l=r,f=!0,_=null;const{payload:y}=hv(e.access_token);if(y.exp&&(l=y.exp,f=l<=r),f){const{data:d,error:A}=await this._callRefreshToken(e.refresh_token);if(A)return this._returnResult({data:{user:null,session:null},error:A});if(!d)return{data:{user:null,session:null},error:null};_=d}else{const{data:d,error:A}=await this._getUser(e.access_token);if(A)throw A;_={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:l-r,expires_at:l},await this._saveSession(_),await this._notifyAllSubscribers("SIGNED_IN",_)}return this._returnResult({data:{user:_.user,session:_},error:null})}catch(r){if(zi(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var l;if(!e){const{data:y,error:d}=r;if(d)throw d;e=(l=y.session)!==null&&l!==void 0?l:void 0}if(!e?.refresh_token)throw new kl;const{data:f,error:_}=await this._callRefreshToken(e.refresh_token);return _?this._returnResult({data:{user:null,session:null},error:_}):f?this._returnResult({data:{user:f.user,session:f},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(zi(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!ja())throw new vy("No browser detected.");if(e.error||e.error_description||e.error_code)throw new vy(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new H0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new vy("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new H0("No code detected.");const{data:ge,error:ae}=await this._exchangeCodeForSession(e.code);if(ae)throw ae;const me=new URL(window.location.href);return me.searchParams.delete("code"),window.history.replaceState(window.history.state,"",me.toString()),{data:{session:ge.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:f,access_token:_,refresh_token:y,expires_in:d,expires_at:A,token_type:I}=e;if(!_||!d||!y||!I)throw new vy("No session defined in URL");const B=Math.round(Date.now()/1e3),N=parseInt(d);let V=B+N;A&&(V=parseInt(A));const K=V-B;K*1e3<=Kf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${K}s, should have been closer to ${N}s`);const ie=V-N;B-ie>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",ie,V,B):B-ie<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",ie,V,B);const{data:ne,error:ve}=await this._getUser(_);if(ve)throw ve;const se={provider_token:l,provider_refresh_token:f,access_token:_,expires_in:N,expires_at:V,refresh_token:y,token_type:I,user:ne.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:se,redirectType:e.type},error:null})}catch(l){if(zi(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Fd(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var l;const{data:f,error:_}=r;if(_)return this._returnResult({error:_});const y=(l=f.session)===null||l===void 0?void 0:l.access_token;if(y){const{error:d}=await this.admin.signOut(y,e);if(d&&!(Sj(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await Ia(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=Lj(),l={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,l),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:l}}}async _emitInitialSession(e){return await this._useSession(async r=>{var l,f;try{const{data:{session:_},error:y}=r;if(y)throw y;await((l=this.stateChangeEmitters.get(e))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",_)),this._debug("INITIAL_SESSION","callback id",e,"session",_)}catch(_){await((f=this.stateChangeEmitters.get(e))===null||f===void 0?void 0:f.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",_),console.error(_)}})}async resetPasswordForEmail(e,r={}){let l=null,f=null;this.flowType==="pkce"&&([l,f]=await Ff(this.storage,this.storageKey,!0));try{return await Gi(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:l,code_challenge_method:f,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(_){if(await Ia(this.storage,`${this.storageKey}-code-verifier`),zi(_))return this._returnResult({data:null,error:_});throw _}}async getUserIdentities(){var e;try{const{data:r,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:l,error:f}=await this._useSession(async _=>{var y,d,A,I,B;const{data:N,error:V}=_;if(V)throw V;const K=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(y=e.options)===null||y===void 0?void 0:y.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(A=e.options)===null||A===void 0?void 0:A.queryParams,skipBrowserRedirect:!0});return await Gi(this.fetch,"GET",K,{headers:this.headers,jwt:(B=(I=N.session)===null||I===void 0?void 0:I.access_token)!==null&&B!==void 0?B:void 0})});if(f)throw f;return ja()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:e.provider,url:l?.url},error:null})}catch(l){if(zi(l))return this._returnResult({data:{provider:e.provider,url:null},error:l});throw l}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var l;try{const{error:f,data:{session:_}}=r;if(f)throw f;const{options:y,provider:d,token:A,access_token:I,nonce:B}=e,N=await Gi(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=_?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:d,id_token:A,access_token:I,nonce:B,link_identity:!0,gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Tc}),{data:V,error:K}=N;return K?this._returnResult({data:{user:null,session:null},error:K}):!V||!V.session||!V.user?this._returnResult({data:{user:null,session:null},error:new Uf}):(V.session&&(await this._saveSession(V.session),await this._notifyAllSubscribers("USER_UPDATED",V.session)),this._returnResult({data:V,error:K}))}catch(f){if(await Ia(this.storage,`${this.storageKey}-code-verifier`),zi(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var l,f;const{data:_,error:y}=r;if(y)throw y;return await Gi(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(f=(l=_.session)===null||l===void 0?void 0:l.access_token)!==null&&f!==void 0?f:void 0})})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const l=Date.now();return await Oj(async f=>(f>0&&await Dj(200*Math.pow(2,f-1)),this._debug(r,"refreshing attempt",f),await Gi(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Tc})),(f,_)=>{const y=200*Math.pow(2,f);return _&&uv(_)&&Date.now()+y-l<Kf})}catch(l){if(this._debug(r,"error",l),zi(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const l=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",l),ja()&&!r.skipBrowserRedirect&&window.location.assign(l),{data:{provider:e,url:l},error:null}}async _recoverAndRefresh(){var e,r;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const f=await Fd(this.storage,this.storageKey);if(f&&this.userStorage){let y=await Fd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!y&&(y={user:f.user},await Jf(this.userStorage,this.storageKey+"-user",y)),f.user=(e=y?.user)!==null&&e!==void 0?e:dv()}else if(f&&!f.user&&!f.user){const y=await Fd(this.storage,this.storageKey+"-user");y&&y?.user?(f.user=y.user,await Ia(this.storage,this.storageKey+"-user"),await Jf(this.storage,this.storageKey,f)):f.user=dv()}if(this._debug(l,"session from storage",f),!this._isValidSession(f)){this._debug(l,"session is not valid"),f!==null&&await this._removeSession();return}const _=((r=f.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<cv;if(this._debug(l,`session has${_?"":" not"} expired with margin of ${cv}s`),_){if(this.autoRefreshToken&&f.refresh_token){const{error:y}=await this._callRefreshToken(f.refresh_token);y&&(console.error(y),uv(y)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",y),await this._removeSession()))}}else if(f.user&&f.user.__isUserNotAvailableProxy===!0)try{const{data:y,error:d}=await this._getUser(f.access_token);!d&&y?.user?(f.user=y.user,await this._saveSession(f),await this._notifyAllSubscribers("SIGNED_IN",f)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(y){console.error("Error getting user data:",y),this._debug(l,"error getting user data, skipping SIGNED_IN notification",y)}else await this._notifyAllSubscribers("SIGNED_IN",f)}catch(f){this._debug(l,"error",f),console.error(f);return}finally{this._debug(l,"end")}}async _callRefreshToken(e){var r,l;if(!e)throw new kl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const f=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(f,"begin");try{this.refreshingDeferred=new f_;const{data:_,error:y}=await this._refreshAccessToken(e);if(y)throw y;if(!_.session)throw new kl;await this._saveSession(_.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",_.session);const d={data:_.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(_){if(this._debug(f,"error",_),zi(_)){const y={data:null,error:_};return uv(_)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(y),y}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(_),_}finally{this.refreshingDeferred=null,this._debug(f,"end")}}async _notifyAllSubscribers(e,r,l=!0){const f=`#_notifyAllSubscribers(${e})`;this._debug(f,"begin",r,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:e,session:r});const _=[],y=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,r)}catch(A){_.push(A)}});if(await Promise.all(y),_.length>0){for(let d=0;d<_.length;d+=1)console.error(_[d]);throw _[0]}}finally{this._debug(f,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ia(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),l=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&r.user&&await Jf(this.userStorage,this.storageKey+"-user",{user:r.user});const f=Object.assign({},r);delete f.user;const _=X0(f);await Jf(this.storage,this.storageKey,_)}else{const f=X0(r);await Jf(this.storage,this.storageKey,f)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ia(this.storage,this.storageKey),await Ia(this.storage,this.storageKey+"-code-verifier"),await Ia(this.storage,this.storageKey+"-user"),this.userStorage&&await Ia(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ja()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Kf);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:l}}=r;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const f=Math.floor((l.expires_at*1e3-e)/Kf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${f} ticks, a tick lasts ${Kf}ms, refresh threshold is ${Jv} ticks`),f<=Jv&&await this._callRefreshToken(l.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof BS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ja()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,l){const f=[`provider=${encodeURIComponent(r)}`];if(l?.redirectTo&&f.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&f.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[_,y]=await Ff(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(_)}`,code_challenge_method:`${encodeURIComponent(y)}`});f.push(d.toString())}if(l?.queryParams){const _=new URLSearchParams(l.queryParams);f.push(_.toString())}return l?.skipBrowserRedirect&&f.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${e}?${f.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var l;const{data:f,error:_}=r;return _?this._returnResult({data:null,error:_}):await Gi(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token})})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var l,f;const{data:_,error:y}=r;if(y)return this._returnResult({data:null,error:y});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:A,error:I}=await Gi(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(l=_?.session)===null||l===void 0?void 0:l.access_token});return I?this._returnResult({data:null,error:I}):(e.factorType==="totp"&&A.type==="totp"&&(!((f=A?.totp)===null||f===void 0)&&f.qr_code)&&(A.totp.qr_code=`data:image/svg+xml;utf-8,${A.totp.qr_code}`),this._returnResult({data:A,error:null}))})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var l;const{data:f,error:_}=r;if(_)return this._returnResult({data:null,error:_});const y=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?fL(e.webauthn.credential_response):pL(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:A}=await Gi(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:y,headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token});return A?this._returnResult({data:null,error:A}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:A}))})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var l;const{data:f,error:_}=r;if(_)return this._returnResult({data:null,error:_});const y=await Gi(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token});if(y.error)return y;const{data:d}=y;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:hL(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:dL(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:l}=await this._challenge({factorId:e.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:l}=await this.getUser();if(l)return{data:null,error:l};const f={all:[],phone:[],totp:[],webauthn:[]};for(const _ of(e=r?.factors)!==null&&e!==void 0?e:[])f.all.push(_),_.status==="verified"&&f[_.factor_type].push(_);return{data:f,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:l},error:f}=await this.getSession();if(f)return this._returnResult({data:null,error:f});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:_}=hv(l.access_token);let y=null;_.aal&&(y=_.aal);let d=y;((r=(e=l.user.factors)===null||e===void 0?void 0:e.filter(B=>B.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const I=_.amr||[];return{data:{currentLevel:y,nextLevel:d,currentAuthenticationMethods:I},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:l},error:f}=r;return f?this._returnResult({data:null,error:f}):l?await Gi(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:l.access_token,xform:_=>({data:_,error:null})}):this._returnResult({data:null,error:new kl})})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async l=>{const{data:{session:f},error:_}=l;if(_)return this._returnResult({data:null,error:_});if(!f)return this._returnResult({data:null,error:new kl});const y=await Gi(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:f.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return y.data&&y.data.redirect_url&&ja()&&!r?.skipBrowserRedirect&&window.location.assign(y.data.redirect_url),y})}catch(l){if(zi(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(e,r){try{return await this._useSession(async l=>{const{data:{session:f},error:_}=l;if(_)return this._returnResult({data:null,error:_});if(!f)return this._returnResult({data:null,error:new kl});const y=await Gi(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:f.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return y.data&&y.data.redirect_url&&ja()&&!r?.skipBrowserRedirect&&window.location.assign(y.data.redirect_url),y})}catch(l){if(zi(l))return this._returnResult({data:null,error:l});throw l}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:l}=e;return l?this._returnResult({data:null,error:l}):r?await Gi(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:f=>({data:f,error:null})}):this._returnResult({data:null,error:new kl})})}catch(e){if(zi(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:l},error:f}=r;return f?this._returnResult({data:null,error:f}):l?(await Gi(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:l.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new kl})})}catch(r){if(zi(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let l=r.keys.find(d=>d.kid===e);if(l)return l;const f=Date.now();if(l=this.jwks.keys.find(d=>d.kid===e),l&&this.jwks_cached_at+bj>f)return l;const{data:_,error:y}=await Gi(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(y)throw y;return!_.keys||_.keys.length===0||(this.jwks=_,this.jwks_cached_at=f,l=_.keys.find(d=>d.kid===e),!l)?null:l}async getClaims(e,r={}){try{let l=e;if(!l){const{data:K,error:ie}=await this.getSession();if(ie||!K.session)return this._returnResult({data:null,error:ie});l=K.session.access_token}const{header:f,payload:_,signature:y,raw:{header:d,payload:A}}=hv(l);r?.allowExpired||qj(_.exp);const I=!f.alg||f.alg.startsWith("HS")||!f.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(f.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!I){const{error:K}=await this.getUser(l);if(K)throw K;return{data:{claims:_,header:f,signature:y},error:null}}const B=Hj(f.alg),N=await crypto.subtle.importKey("jwk",I,B,!0,["verify"]);if(!await crypto.subtle.verify(B,N,y,Ij(`${d}.${A}`)))throw new tx("Invalid JWT signature");return{data:{claims:_,header:f,signature:y},error:null}}catch(l){if(zi(l))return this._returnResult({data:null,error:l});throw l}}}Gm.nextInstanceID={};const SL=Gm,TL="2.90.1";let km="";typeof Deno<"u"?km="deno":typeof document<"u"?km="web":typeof navigator<"u"&&navigator.product==="ReactNative"?km="react-native":km="node";const EL={"X-Client-Info":`supabase-js-${km}/${TL}`},kL={headers:EL},CL={schema:"public"},AL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ML={};function Wm(t){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wm(t)}function PL(t,e){if(Wm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var l=r.call(t,e);if(Wm(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IL(t){var e=PL(t,"string");return Wm(e)=="symbol"?e:e+""}function jL(t,e,r){return(e=IL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),r.push.apply(r,l)}return r}function fr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nw(Object(r),!0).forEach(function(l){jL(t,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nw(Object(r)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(r,l))})}return t}const LL=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),zL=()=>Headers,RL=(t,e,r)=>{const l=LL(r),f=zL();return async(_,y)=>{var d;const A=(d=await e())!==null&&d!==void 0?d:t;let I=new f(y?.headers);return I.has("apikey")||I.set("apikey",t),I.has("Authorization")||I.set("Authorization",`Bearer ${A}`),l(_,fr(fr({},y),{},{headers:I}))}};function DL(t){return t.endsWith("/")?t:t+"/"}function OL(t,e){var r,l;const{db:f,auth:_,realtime:y,global:d}=t,{db:A,auth:I,realtime:B,global:N}=e,V={db:fr(fr({},A),f),auth:fr(fr({},I),_),realtime:fr(fr({},B),y),storage:{},global:fr(fr(fr({},N),d),{},{headers:fr(fr({},(r=N?.headers)!==null&&r!==void 0?r:{}),(l=d?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return t.accessToken?V.accessToken=t.accessToken:delete V.accessToken,V}function NL(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(DL(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var BL=class extends SL{constructor(t){super(t)}},$L=class{constructor(t,e,r){var l,f;this.supabaseUrl=t,this.supabaseKey=e;const _=NL(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",_),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",_),this.storageUrl=new URL("storage/v1",_),this.functionsUrl=new URL("functions/v1",_);const y=`sb-${_.hostname.split(".")[0]}-auth-token`,d={db:CL,realtime:ML,auth:fr(fr({},AL),{},{storageKey:y}),global:kL},A=OL(r??{},d);if(this.storageKey=(l=A.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(f=A.global.headers)!==null&&f!==void 0?f:{},A.accessToken)this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(B,N)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(N)} is not possible`)}});else{var I;this.auth=this._initSupabaseAuthClient((I=A.auth)!==null&&I!==void 0?I:{},this.headers,A.global.fetch)}this.fetch=RL(e,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(fr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.accessToken&&this.accessToken().then(B=>this.realtime.setAuth(B)).catch(B=>console.warn("Failed to set initial Realtime auth token:",B)),this.rest=new vI(new URL("rest/v1",_).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new gj(this.storageUrl.href,this.headers,this.fetch,r?.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new pI(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:l}=await t.auth.getSession();return(e=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:l,userStorage:f,storageKey:_,flowType:y,lock:d,debug:A,throwOnError:I},B,N){const V={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BL({url:this.authUrl.href,headers:fr(fr({},V),B),storageKey:_,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:l,userStorage:f,flowType:y,lock:d,debug:A,throwOnError:I,fetch:N,hasCustomAuthorizationHeader:Object.keys(this.headers).some(K=>K.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new DI(this.realtimeUrl.href,fr(fr({},t),{},{params:fr(fr({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const UL=(t,e,r)=>new $L(t,e,r);function FL(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}FL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const VL={DEV:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFlc2Nva2xrZHllaHlmcHNxbnRyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1Njk4MTEsImV4cCI6MjA4MDE0NTgxMX0.9rWg2urAfOCc3qZs7_yXNPjRjCm9WP7bcD1qQ20CxFM",VITE_SUPABASE_URL:"https://aescoklkdyehyfpsqntr.supabase.co"},Ym=VL||{},t_=Ym.VITE_SUPABASE_URL||Ym.NEXT_PUBLIC_SUPABASE_URL||"",Lm=Ym.VITE_SUPABASE_ANON_KEY||Ym.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",p_=!!Ym.DEV,qL=!!(t_&&Lm),HL=async(...t)=>{if(p_){const e=t[0],r=typeof e=="string"?e:e instanceof URL?e.toString():e.url;console.info("[supabase] request",r)}return fetch(...t)},ZL=async(t,e,r)=>r(),Rt=UL(t_,Lm,{global:{fetch:p_?HL:fetch},auth:{lock:ZL}});if(p_){let t="missing";if(t_)try{t=new URL(t_).host}catch{t="invalid-url"}const e=Lm?`${Lm.slice(0,6)}...${Lm.slice(-4)}`:"missing";console.info("[supabase] config",{host:t,key:e,isConfigured:qL})}p_&&(window.supabase=Rt);const Wd=new Map,Xd=new Map,mr=async(t,e,r)=>{const l=r?.ttlMs??15e3,f=Date.now(),_=Xd.get(t);if(_&&_.expiresAt>f)return _.value;const y=Wd.get(t);if(y)return y;const d=e().then(A=>(Wd.delete(t),Xd.set(t,{value:A,expiresAt:f+l}),A)).catch(A=>{throw Wd.delete(t),Xd.delete(t),A});return Wd.set(t,d),d},ix=(t,e,r)=>{const l=r?.ttlMs??15e3;Xd.set(t,{value:e,expiresAt:Date.now()+l})},FS=t=>{if(!t){Wd.clear(),Xd.clear();return}for(const e of Array.from(Wd.keys()))e.startsWith(t)&&Wd.delete(e);for(const e of Array.from(Xd.keys()))e.startsWith(t)&&Xd.delete(e)},GL={auth:{userId:null},workspace:{activeWorkspaceId:null}},WL=(t,e)=>{switch(e.type){case"auth/setUserId":return{...t,auth:{userId:e.payload}};case"workspace/setActiveId":return{...t,workspace:{activeWorkspaceId:e.payload}};case"workspace/reset":return{...t,workspace:{activeWorkspaceId:null}};default:return t}},VS=te.createContext(void 0),qS=te.createContext(void 0),YL=({children:t})=>{const[e,r]=te.useReducer(WL,GL),l=te.useMemo(()=>e,[e]);return S.jsx(qS.Provider,{value:r,children:S.jsx(VS.Provider,{value:l,children:t})})},HS=()=>{const t=te.useContext(VS);if(!t)throw new Error("useAppStore must be used within AppStoreProvider");return t},ZS=()=>{const t=te.useContext(qS);if(!t)throw new Error("useAppDispatch must be used within AppStoreProvider");return t},XL=()=>{const{auth:t}=HS(),e=ZS();return{userId:t.userId,setUserId:r=>e({type:"auth/setUserId",payload:r})}},GS=()=>{const{workspace:t}=HS(),e=ZS();return{activeWorkspaceId:t.activeWorkspaceId,setActiveWorkspaceId:r=>e({type:"workspace/setActiveId",payload:r}),resetWorkspace:()=>e({type:"workspace/reset"})}},WS=te.createContext(void 0),ya=()=>{const t=te.useContext(WS);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},KL=({children:t})=>{const{setUserId:e}=XL(),{resetWorkspace:r}=GS(),[l,f]=te.useState({user:null,profile:null,loading:!0}),_=!1,y=te.useRef(null),d=te.useRef(null),A=async(se,ge,ae)=>{if(ae&&!(y.current===se&&l.profile&&!l.loading)&&d.current!==se){d.current=se,e(se),f(me=>({...me,user:ge,loading:!0}));try{const me=`profiles:${se}`,ye=await mr(me,async()=>{const{data:st,error:lt}=await Rt.from("profiles").select("*").eq("id",se).maybeSingle();if(lt)throw lt;return st},{ttlMs:3e4});if(!ae||d.current!==se)return;let Se=ye;if(!Se){const st=ge.user_metadata??{},{data:lt,error:Ke}=await Rt.from("profiles").insert({id:se,username:st.username??null,display_name:st.display_name??st.displayName??null,primary_city:st.primary_city??st.primaryCity??null}).select("*").single();if(Ke)throw Ke;Se=lt,ix(me,lt,{ttlMs:3e4})}const ze=`subject:user:${se}`,He=await mr(ze,async()=>{const{data:st,error:lt}=await Rt.rpc("get_or_create_user_subject",{p_profile_id:se});if(lt)throw lt;return st},{ttlMs:1440*60*1e3});if(!ae||d.current!==se)return;const Ze=Se?{...Se,subject_id:He}:null;y.current=se,f({user:ge,profile:Ze??null,loading:!1})}catch(me){console.error("[auth] failed to load profile",me),ae&&f(ye=>({...ye,loading:!1}))}finally{d.current===se&&(d.current=null)}}};te.useEffect(()=>{let se=!0,ge=null;return(async()=>{const{data:{session:me}}=await Rt.auth.getSession();se&&(me?.user?await A(me.user.id,me.user,se):(e(null),r(),f({user:null,profile:null,loading:!1})));const{data:ye}=Rt.auth.onAuthStateChange(async(Se,ze)=>{se&&(Se==="SIGNED_IN"||Se==="TOKEN_REFRESHED"||Se==="USER_UPDATED"?ze?.user&&await A(ze.user.id,ze.user,se):Se==="SIGNED_OUT"&&(y.current=null,e(null),r(),f({user:null,profile:null,loading:!1})))});ge=ye})(),()=>{se=!1,ge&&ge.subscription.unsubscribe()}},[]),te.useEffect(()=>{const se=()=>{document.visibilityState==="visible"&&ne().catch(()=>{})};return window.addEventListener("focus",se),document.addEventListener("visibilitychange",se),()=>{window.removeEventListener("focus",se),document.removeEventListener("visibilitychange",se)}},[l.user]);const I=async(se,ge)=>{const{error:ae}=await Rt.auth.signInWithPassword({email:se,password:ge});return{error:ae}},B=async(se,ge,ae)=>{const{error:me}=await Rt.auth.signUp({email:se,password:ge,options:{data:{username:ae.username||null,display_name:ae.displayName||null,primary_city:ae.primaryCity||null}}});return{error:me}},N=async se=>{const{error:ge}=await Rt.auth.resetPasswordForEmail(se,{redirectTo:`${window.location.origin}/reset`});return{error:ge}},V=async se=>{const{error:ge}=await Rt.auth.updateUser({password:se});return{error:ge}},K=async()=>{try{const{error:se}=await Rt.auth.signOut();se&&await Rt.auth.signOut({scope:"local"})}finally{y.current=null,e(null),r(),f({user:null,profile:null,loading:!1})}},ie=async se=>{if(!l.user)return{error:{message:"No user logged in"}};const{role:ge,...ae}=se,me={id:l.user.id,...ae};_&&ge&&(me.role=ge);const{data:ye,error:Se}=await Rt.from("profiles").upsert(me,{onConflict:"id"}).select("*").single();return!Se&&ye&&f(ze=>({...ze,profile:ye})),{error:Se}},ne=async()=>{if(!l.user)return;const{data:se}=await Rt.from("profiles").select("*").eq("id",l.user.id).single();se&&f(ge=>({...ge,profile:se}))},ve={...l,signIn:I,signUp:B,sendPasswordReset:N,updatePassword:V,signOut:K,updateProfile:ie,refreshProfile:ne};return S.jsx(WS.Provider,{value:ve,children:t})},Cm={async getManagedEntities(t){const e=await mr(`subject:user:${t}`,async()=>{const{data:f,error:_}=await Rt.rpc("get_or_create_user_subject",{p_profile_id:t});if(_)throw _;return f},{ttlMs:864e5}),{data:r,error:l}=await Rt.from("entity_members").select(`
        admin_subject_id,
        entity_subject_id,
        role,
        subjects:entity_subject_id (
          id,
          type
        )
      `).eq("admin_subject_id",e);if(l)throw l;return Promise.all(r.map(async f=>{const _=f.subjects.type,y={subject_id:f.entity_subject_id,role:f.role,type:_};if(_==="artist"){const d=await mr(`v_subject_artists:by_subject:${f.entity_subject_id}`,async()=>{const{data:A,error:I}=await Rt.from("v_subject_artists").select("*").eq("subject_id",f.entity_subject_id).maybeSingle();if(I)throw I;return A},{ttlMs:6e4});d&&(y.artist={...d,id:d.artist_id??d.id})}else if(_==="venue"){const d=await mr(`v_subject_venues:by_subject:${f.entity_subject_id}`,async()=>{const{data:A,error:I}=await Rt.from("v_subject_venues").select("*").eq("subject_id",f.entity_subject_id).maybeSingle();if(I)throw I;return A},{ttlMs:6e4});d&&(y.venue={...d,id:d.venue_place_id??d.id})}return y}))},async adminGrantEntityAccess(t,e,r,l="admin"){const{error:f}=await Rt.rpc("admin_grant_entity_access",{p_target_profile_id:t,p_entity_type:e,p_entity_id:r,p_role:l});if(f)throw f},async removeMember(t,e){const{error:r}=await Rt.from("entity_members").delete().match({admin_subject_id:t,entity_subject_id:e});if(r)throw r},async searchProfiles(t){const{data:e,error:r}=await Rt.from("profiles").select("id, username, display_name, avatar_url").or(`username.ilike.%${t}%,display_name.ilike.%${t}%`).limit(10);if(r)throw r;return e},async searchArtists(t){const{data:e,error:r}=await Rt.from("artists").select("id, name, artist_type, city, avatar_url").ilike("name",`%${t}%`).order("name",{ascending:!0}).limit(10);if(r)throw r;return e?.map(l=>({...l,image_url:l.avatar_url??null}))},async searchVenues(t){const{data:e,error:r}=await Rt.from("venue_places").select("id, name, city, photos, venue_type").or(`name.ilike.%${t}%,city.ilike.%${t}%`).order("name",{ascending:!0}).limit(10);if(r)throw r;return e?.map(l=>({...l,image_url:l.photos?.[0]??null}))}},YS=te.createContext(void 0),JL="live_space.workspace.",QL=({children:t})=>{const{profile:e}=ya(),{activeWorkspaceId:r,setActiveWorkspaceId:l}=GS(),[f,_]=te.useState([]),[y,d]=te.useState(!0),[A,I]=te.useState(null),B=e?.id?`${JL}${e.id}`:null,N=ae=>{if(!(!B||typeof window>"u"))try{ae?window.localStorage.setItem(B,ae):window.localStorage.removeItem(B)}catch{}},V=ae=>{console.log("[workspace] setActiveWorkspace ->",ae);const me=ae?.subject_id??null;l(me),N(me)},K=()=>{if(!B||typeof window>"u")return null;try{return window.localStorage.getItem(B)}catch{return null}},ie=async()=>{if(!e?.id){_([]),l(null),N(null),d(!1),I(null);return}try{d(!0);const ae=await Cm.getManagedEntities(e.id);if(console.log("[workspace] fetched entities",ae),_(ae),r)ae.find(ye=>ye.subject_id===r)||(l(null),N(null));else{const me=K();if(me){const ye=ae.find(Se=>Se.subject_id===me);ye&&(console.log("[workspace] restoring stored workspace",me),l(ye.subject_id))}}}catch(ae){console.error("Error fetching managed entities:",ae)}finally{d(!1),I(e.id)}};te.useEffect(()=>{ie()},[e?.id]),te.useEffect(()=>{const ae=()=>{document.visibilityState==="visible"&&e?.id&&ie().catch(()=>{})};return window.addEventListener("focus",ae),document.addEventListener("visibilitychange",ae),()=>{window.removeEventListener("focus",ae),document.removeEventListener("visibilitychange",ae)}},[e?.id]);const ne=te.useMemo(()=>r?f.find(ae=>ae.subject_id===r)??null:null,[r,f]),ve=ne!==null,se=ne!==null&&["owner","admin","editor"].includes(ne.role),ge=!!(e?.id&&A===e.id);return S.jsx(YS.Provider,{value:{managedEntities:f,activeWorkspace:ne,setActiveWorkspace:V,loading:y,ready:ge,refreshWorkspaces:ie,isActingAsEntity:ve,canCreateEvent:se},children:t})},mp=()=>{const t=te.useContext(YS);if(t===void 0)throw new Error("useWorkspace must be used within a WorkspaceProvider");return t},ez=()=>S.jsxs("div",{className:"inline-flex items-center gap-2",children:[S.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-[10px] bg-white/10 text-[11px] font-bold uppercase tracking-[0.2em] text-white","aria-hidden":"true",children:"icon"}),S.jsx("span",{className:"font-display text-sm font-semibold uppercase tracking-[0.2em] text-white/90",children:"Live Space"})]}),tz=()=>{const{managedEntities:t,activeWorkspace:e,setActiveWorkspace:r}=mp(),[l,f]=te.useState(!1),_=ta(),y=d=>{console.log("[workspace-switcher] selecting",d),r(d?{...d,artist:d.artist?{...d.artist,id:d.artist.id??d.artist.artist_id}:void 0,venue:d.venue?{...d.venue,id:d.venue.id??d.venue.venue_place_id}:void 0}:null),f(!1),d?.type==="artist"&&d.artist?.id?_.replace(`/tabs/artist/${d.artist.id}`):d?.type==="venue"&&d.venue?.id?_.replace(`/tabs/venue/${d.venue.id}`):_.replace("/tabs/profile")};return t.length===0?null:S.jsxs("div",{className:"relative",children:[S.jsxs("button",{onClick:()=>f(!l),className:"flex items-center gap-2 px-2 py-1 text-white/80 transition-colors hover:text-white",children:[S.jsx("div",{className:"flex h-5 w-5 items-center justify-center text-white/70",children:e?S.jsx(z0,{size:12}):S.jsx(My,{size:12})}),S.jsx("span",{className:"max-w-[120px] truncate text-xs font-medium text-white/80",children:e?e.artist?.name||e.venue?.name||"Workspace":"Personal Profile"}),l?S.jsx(uI,{size:14,className:"text-white/50"}):S.jsx(cI,{size:14,className:"text-white/50"})]}),l&&S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>f(!1)}),S.jsxs("div",{className:"absolute right-0 top-full z-40 mt-2 w-64 overflow-hidden rounded-xl bg-black/95",children:[S.jsx("div",{className:"px-4 pb-2 pt-4 text-[10px] font-semibold uppercase tracking-[0.24em] text-white/40",children:"Personal"}),S.jsxs("button",{onClick:()=>y(null),className:`flex w-full items-center gap-3 px-4 py-3 text-left transition-colors hover:bg-white/5 ${e?"text-white/80":"text-white"}`,children:[S.jsx("div",{className:"flex h-8 w-8 items-center justify-center bg-white/10 text-white/80",children:S.jsx(My,{size:16})}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("div",{className:"truncate text-sm font-medium",children:"Personal Profile"}),S.jsx("div",{className:"text-[10px] text-white/50",children:"Viewing as yourself"})]})]}),S.jsx("div",{className:"px-4 pb-2 pt-4 text-[10px] font-semibold uppercase tracking-[0.24em] text-white/40",children:"Workspaces"}),S.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.map(d=>S.jsxs("button",{onClick:()=>y(d),className:`flex w-full items-center gap-3 px-4 py-3 text-left transition-colors hover:bg-white/5 ${e?.subject_id===d.subject_id?"text-white":"text-white/80"}`,children:[S.jsx("div",{className:"relative",children:d.type==="artist"?d.artist?.avatar_url?S.jsx("img",{src:d.artist.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-white/10 text-white/70",children:S.jsx(My,{size:16})}):d.venue?.photos?.[0]?S.jsx("img",{src:d.venue.photos[0],alt:"",className:"h-8 w-8 rounded object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded bg-white/10 text-white/70",children:S.jsx(z0,{size:16})})}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("div",{className:"truncate text-sm font-medium",children:d.type==="artist"?d.artist?.name:d.venue?.name}),S.jsx("div",{className:"text-[10px] uppercase tracking-[0.22em] text-white/45",children:d.role})]})]},d.subject_id))})]})]})]})},iz=({title:t,rightSlot:e,showBack:r})=>{const l=ta(),f=pp(),_=r??!["/tabs/feed","/tabs/events","/tabs/map","/tabs/upload","/tabs/profile","/tabs/discover "].includes(f.pathname),y=()=>{l.push("/")},d=()=>{l.goBack()};return S.jsx("header",{className:"sticky top-0 z-20 bg-app-bg px-4 py-3 pt-[calc(12px+env(safe-area-inset-top,0px))]",children:S.jsxs("div",{className:"flex items-center justify-between gap-3",children:[S.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[_?S.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-3 py-2 text-sm font-semibold text-white/80 disabled:cursor-not-allowed disabled:opacity-60",onClick:d,"aria-label":"Go back",children:S.jsx(lI,{className:"h-4 w-4"})}):null,t?S.jsx("h1",{className:"text-lg font-bold text-app-light",children:t}):S.jsx("button",{type:"button",className:"flex items-center",onClick:y,"aria-label":"Go to home",children:S.jsx(ez,{})})]}),S.jsxs("div",{className:"inline-flex items-center gap-2",children:[S.jsx(tz,{}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-3 py-2 text-sm font-semibold text-white/80 disabled:cursor-not-allowed disabled:opacity-60","aria-label":"Notifications",disabled:!0,children:S.jsx(oI,{className:"h-4 w-4"})}),e]})]})})},so=({children:t,headerProps:e={},headerPlacement:r="inside",contentClassName:l,contentFullscreen:f=!0,contentWrapperClassName:_="min-h-full"})=>{const y=e?S.jsx(iz,{...e}):null,d=S.jsxs(S.Fragment,{children:[r==="inside"?y:null,t]});return S.jsxs(Zh,{children:[r==="outside"?y:null,S.jsx(Pl,{fullscreen:f,className:l,children:_===!1?d:S.jsx("div",{className:_,children:d})})]})},nz=()=>{const[t,e]=te.useState(!1),[r,l]=te.useState(""),[f,_]=te.useState(""),[y,d]=te.useState(""),[A,I]=te.useState(""),[B,N]=te.useState(""),[V,K]=te.useState(!1),[ie,ne]=te.useState(""),[ve,se]=te.useState(!1),[ge,ae]=te.useState(""),[me,ye]=te.useState(!1),Se=ta(),{signIn:ze,signUp:He,sendPasswordReset:Ze}=ya(),st=async()=>{K(!0),ne("");try{if(!r||!f||t&&!y){ne("Please fill in all required fields");return}if(t){const{error:Ke}=await He(r,f,{username:y,displayName:A,primaryCity:B});if(Ke){ne(Ke.message);return}}else{const{error:Ke}=await ze(r,f);if(Ke){ne(Ke.message);return}}Se.replace("/tabs/events")}catch{ne("An unexpected error occurred")}finally{K(!1)}},lt=async()=>{K(!0),ne(""),ye(!1);try{const Ke=ge||r;if(!Ke){ne("Enter your email to reset password");return}const{error:Mt}=await Ze(Ke);if(Mt){ne(Mt.message);return}ye(!0)}catch{ne("Could not send reset email")}finally{K(!1)}};return S.jsx(so,{children:S.jsx("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:S.jsxs("div",{className:"relative min-h-full",children:[S.jsxs("div",{className:"mx-auto max-w-md text-center",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"Your concert archive"}),S.jsx("h1",{className:"mt-4 font-display text-4xl font-bold leading-tight text-white",children:"Live Space"}),S.jsx("p",{className:"mt-3 text-sm text-white/70",children:"Keep what happened last night  and relive it when you want."})]}),S.jsxs("div",{className:"mt-8 space-y-4 rounded-2xl bg-white/5 p-5",children:[S.jsx("h2",{className:"font-display text-base font-semibold text-white",children:t?"Create Account":"Sign In"}),S.jsxs("div",{className:"space-y-3",children:[t&&S.jsxs(S.Fragment,{children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{value:y,onChange:Ke=>d(Ke.target.value),placeholder:"Choose a username",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Display name"}),S.jsx("input",{value:A,onChange:Ke=>I(Ke.target.value),placeholder:"How should we call you?",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Primary city"}),S.jsx("input",{value:B,onChange:Ke=>N(Ke.target.value),placeholder:"Barcelona",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Email"}),S.jsx("input",{type:"email",value:r,onChange:Ke=>l(Ke.target.value),placeholder:"your@email.com",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Password"}),S.jsx("input",{type:"password",value:f,onChange:Ke=>_(Ke.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),ie&&S.jsx("p",{className:"text-sm text-rose-400",children:ie}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:st,disabled:V||!r||!f||t&&!y,children:V?S.jsxs("span",{className:"flex items-center gap-2",children:[S.jsx(Ws,{name:"crescent"}),"Loading..."]}):t?"Sign Up":"Sign In"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>e(!t),children:t?"Already have an account? Sign In":"Don't have an account? Sign Up"}),!t&&S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>se(Ke=>!Ke),children:"Forgot your password?"}),ve&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Reset email"}),S.jsx("input",{type:"email",value:ge||r,onChange:Ke=>ae(Ke.target.value),placeholder:"you@email.com",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:lt,disabled:V,children:"Send reset link"}),me&&S.jsx("p",{className:"text-sm text-emerald-400",children:"Check your inbox for the reset link."})]})]})]})})})},pv=6,sz=()=>{const{profile:t}=ya(),[e,r]=te.useState([]),[l,f]=te.useState(0),[_,y]=te.useState(!0),[d,A]=te.useState(!1),[I,B]=te.useState(""),[N,V]=te.useState(!0),K=te.useRef(null),ie=ta(),ne=async(se,ge=!1)=>{const ae=se*pv,me=ae+pv-1,{data:ye,error:Se}=await Rt.from("posts").select(`
        id,
        user_id,
        event_id,
        media_url,
        media_type,
        thumbnail_url,
        caption,
        created_at,
        profiles:profiles!posts_user_id_fkey (
          id,
          username,
          display_name,
          avatar_url
        ),
        events:events!posts_event_id_fkey (
          id,
          name,
          city,
          starts_at,
          cover_image_url
        )
        `).order("created_at",{ascending:!1}).range(ae,me);if(Se)throw Se;ye&&(r(ze=>ge?ye:[...ze,...ye]),V(ye.length===pv))};te.useEffect(()=>{(async()=>{y(!0),B("");try{await ne(0,!0)}catch{V(!1),B("Could not load the feed. Check your Supabase connection.")}finally{y(!1)}})()},[]),te.useEffect(()=>{!_&&e.length===0&&(B(""),V(!0),f(0),ne(0,!0).catch(()=>{V(!1),B("Could not load the feed. Check your Supabase connection.")}))},[_,e.length]);const ve=async()=>{if(d||!N)return;const se=l+1;A(!0);try{await ne(se),f(se)}catch{V(!1),B("Could not load more posts.")}finally{A(!1)}};return te.useEffect(()=>{if(!N||_||d)return;const se=K.current;if(!se)return;const ge=new IntersectionObserver(ae=>{ae[0].isIntersecting&&ve()},{rootMargin:"200px"});return ge.observe(se),()=>ge.disconnect()},[N,_,d,l]),S.jsx(so,{children:S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("header",{className:"space-y-2",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:t?.primary_city?`Tonight in ${t.primary_city}`:"Tonight"}),S.jsx("p",{className:"text-sm text-white/55",children:"Relive what people lived."})]}),_?S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})}):S.jsxs("div",{className:"space-y-4",children:[I&&S.jsx("p",{className:"text-sm text-rose-400",children:I}),e.map(se=>{const ge=se.profiles?.username?`@${se.profiles.username}`:se.profiles?.display_name||"Anonymous",ae=se.caption||se.events?.name||"Relive the moment",me=`${se.events?.city||"Unknown"}  ${new Date(se.created_at).toLocaleDateString()}`,ye=se.thumbnail_url||se.events?.cover_image_url||null;return S.jsx("button",{type:"button",className:"-mx-4 block w-[calc(100%+2rem)] text-left",onClick:()=>ie.push(`/post/${se.id}`),children:S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[se.media_type==="image"?S.jsx("img",{src:se.media_url,alt:ae,className:"absolute inset-0 h-full w-full object-cover"}):ye?S.jsx("img",{src:ye,alt:ae,className:"absolute inset-0 h-full w-full object-cover"}):S.jsx("video",{muted:!0,playsInline:!0,preload:"metadata",className:"absolute inset-0 h-full w-full object-cover",children:S.jsx("source",{src:se.media_url})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:ge}),S.jsx("h3",{className:"mt-2 font-display text-2xl font-bold text-white line-clamp-2",children:ae}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:me})]})]})},se.id)})]}),N&&S.jsx("div",{ref:K,className:"flex items-center justify-center py-6",children:d&&S.jsx(Ws,{name:"crescent"})})]})})},XS="live_space.last_location",rz=()=>{try{const t=window.localStorage.getItem(XS);if(!t)return null;const e=JSON.parse(t),r=typeof e.lat=="number"?e.lat:Number(e.lat),l=typeof e.lng=="number"?e.lng:Number(e.lng),f=typeof e.ts=="number"?e.ts:Number(e.ts);if(!Number.isFinite(r)||!Number.isFinite(l)||!Number.isFinite(f))return null;const _=Date.now()-f;return _<0||_>1e3*60*60*24*30?null:{lat:r,lng:l}}catch{return null}},KS=()=>{const[t,e]=te.useState(null);return te.useEffect(()=>{e(rz())},[]),t},az=t=>{try{window.localStorage.setItem(XS,JSON.stringify({...t,ts:Date.now()}))}catch{}},oz=()=>{const t=KS(),[e,r]=te.useState(null),[l,f]=te.useState(!1),[_,y]=te.useState("");te.useEffect(()=>{t&&r(t)},[t]);const d=te.useCallback(()=>{if(!navigator.geolocation){y("Location is not supported on this device.");return}f(!0),y(""),navigator.geolocation.getCurrentPosition(A=>{const I={lat:A.coords.latitude,lng:A.coords.longitude};r(I),az(I),f(!1)},()=>{f(!1),y("Enable location to see concerts near you.")},{enableHighAccuracy:!0,timeout:5e3})},[]);return{location:e,loading:l,error:_,requestLocation:d}},fu={async follow(t,e){const{error:r}=await Rt.from("follows").insert({follower_subject_id:t,target_subject_id:e});if(r)throw r},async unfollow(t,e){const{error:r}=await Rt.from("follows").delete().match({follower_subject_id:t,target_subject_id:e});if(r)throw r},async isFollowing(t,e){const{data:r,error:l}=await Rt.from("follows").select("created_at").match({follower_subject_id:t,target_subject_id:e}).maybeSingle();if(l)throw l;return!!r},async getFollowersCount(t){const{count:e,error:r}=await Rt.from("follows").select("*",{count:"exact",head:!0}).eq("target_subject_id",t);if(r)throw r;return e||0},async getFollowingCount(t){const{count:e,error:r}=await Rt.from("follows").select("*",{count:"exact",head:!0}).eq("follower_subject_id",t);if(r)throw r;return e||0}},JS=()=>{const{user:t,profile:e}=ya(),r=e?.subject_id||null,[l,f]=te.useState(new Set),[_,y]=te.useState(!1),[d,A]=te.useState(new Set),I=!!(t&&r);te.useEffect(()=>{if(!r)return;let K=!1;return y(!0),mr(`follows:${r}`,async()=>{const{data:ie,error:ne}=await Rt.from("follows").select("target_subject_id").eq("follower_subject_id",r);if(ne)throw ne;return(ie||[]).map(ve=>ve.target_subject_id).filter(Boolean)},{ttlMs:1e4}).then(ie=>{K||f(new Set(ie))}).catch(()=>{K||f(new Set)}).finally(()=>{K||y(!1)}),()=>{K=!0}},[r]);const B=te.useCallback(K=>l.has(K),[l]),N=te.useCallback(K=>d.has(K),[d]),V=te.useCallback(async K=>{if(!t||!r)return{ok:!1,reason:"not-authenticated"};if(!K)return{ok:!1,reason:"invalid-target"};const ie=new Set(l),ne=ie.has(K);ne?ie.delete(K):ie.add(K),f(ie),A(ve=>new Set(ve).add(K));try{return ne?await fu.unfollow(r,K):await fu.follow(r,K),ix(`follows:${r}`,Array.from(ie),{ttlMs:1e4}),{ok:!0}}catch{const se=new Set(ie);return ne?se.add(K):se.delete(K),f(se),ix(`follows:${r}`,Array.from(se),{ttlMs:2e3}),{ok:!1,reason:"network"}}finally{A(ve=>{const se=new Set(ve);return se.delete(K),se})}},[r,l,t]);return te.useMemo(()=>({canFollow:I,loading:_,followedSubjectIds:l,isFollowing:B,isToggling:N,toggleFollowSubject:V}),[I,l,B,N,_,V])},qh=t=>{if(t==null)return null;if(typeof t=="number")return t;const e=Number(t);return Number.isNaN(e)?null:e},qx=(t,e,r,l)=>{const _=(r-t)*Math.PI/180,y=(l-e)*Math.PI/180,d=Math.sin(_/2)*Math.sin(_/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(y/2)*Math.sin(y/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},m_=t=>{const e=new Date(t);try{return new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric"}).format(e)}catch{return e.toLocaleDateString()}},lz=t=>t<1?`${(t*1e3).toFixed(0)} m`:t<10?`${t.toFixed(1)} km`:`${t.toFixed(0)} km`,g_=t=>(t.event_artists||[]).find(r=>r.artist?.name)?.artist?.name||t.name,hp=t=>t.cover_image_url||(t.event_artists||[]).find(e=>e.artist?.avatar_url)?.artist?.avatar_url||null,cz=t=>new Date(t).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric"}),uz=t=>t?.display_name||t?.username||null,hz=t=>{const e=t.event_artists?.find(r=>r.artist)?.artist;return e?.name?e.name:t.organizer&&t.organizer.role!=="venue"?uz(t.organizer):null},dz=t=>t.venue_place?.name||t.address||t.city||null,Ql=({event:t,onSelect:e,className:r,title:l,subtitle:f,kicker:_,badge:y})=>{const d=t.cover_image_url||t.event_artists?.find(N=>N.artist?.avatar_url)?.artist?.avatar_url||null,A=te.useMemo(()=>l||hz(t)||t.name,[t.name,l]),I=te.useMemo(()=>f||dz(t)||"Venue",[t,f]),B=te.useMemo(()=>_||cz(t.starts_at),[t.starts_at,_]);return S.jsx("button",{type:"button",className:r||"w-[220px] shrink-0",onClick:()=>e(t),children:S.jsxs("div",{className:"relative aspect-[4/5] overflow-hidden",children:[d?S.jsx("img",{src:d,alt:t.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),y&&S.jsx("div",{className:"absolute left-3 top-3",children:S.jsx("span",{className:"rounded-md bg-black/60 px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-white/90",children:y})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4 text-left",children:[S.jsx("p",{className:"font-display text-lg font-bold text-white line-clamp-2",children:A}),S.jsx("p",{className:"mt-1 text-xs font-semibold uppercase tracking-[0.18em] text-white/80 line-clamp-1",children:I}),S.jsx("p",{className:"mt-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65 line-clamp-1",children:B})]})]})})},fz=({canCreateEvent:t,loading:e,loadError:r,location:l,locationLoading:f,locationError:_,onRequestLocation:y,nearbyUpcoming:d})=>{const A=ta();return S.jsxs("section",{className:"animate-fade-up motion-reduce:animate-none space-y-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Concerts near you"}),S.jsx("p",{className:"mt-2 text-sm text-white/55",children:"Today + the next two weeks."})]}),t&&S.jsx("div",{className:"flex flex-col items-end gap-2",children:S.jsx("button",{type:"button",className:"inline-flex items-center gap-2 bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>A.push("/create-event"),children:"Create event"})})]}),_&&S.jsx("p",{className:"text-xs text-rose-400",children:_}),e?S.jsx("div",{className:"flex items-center justify-center py-8",children:S.jsx(Ws,{name:"crescent"})}):S.jsxs(S.Fragment,{children:[r&&S.jsx("p",{className:"text-sm text-rose-400",children:r}),l?d.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No concerts nearby today"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Try the map to explore whats happening around you."}),S.jsx("div",{className:"mt-4 flex items-center gap-3",children:S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>A.push("/tabs/map"),children:"Explore map"})})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:d.slice(0,10).map(I=>S.jsx(Ql,{event:{...I,cover_image_url:hp(I)},className:"w-[220px] shrink-0",kicker:m_(I.starts_at),title:g_(I),subtitle:I.venue_place?.name||I.city,badge:lz(I.distanceKm),onSelect:B=>A.push(`/event/${B.id}`)},I.id))}):S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"See concerts near you"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Use your location to get nearby events and distances."}),S.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:opacity-60",onClick:y,disabled:f,children:"Use my location"}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white/90",onClick:()=>A.push("/tabs/map"),children:"Explore map"})]})]})]})]})};function pz(t,e){const r=te.useRef(e);te.useEffect(function(){e!==r.current&&t.attributionControl!=null&&(r.current!=null&&t.attributionControl.removeAttribution(r.current),e!=null&&t.attributionControl.addAttribution(e)),r.current=e},[t,e])}function mz(t,e,r){e.center!==r.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==r.radius&&t.setRadius(e.radius)}const gz=1;function yz(t){return Object.freeze({__version:gz,map:t})}function QS(t,e){return Object.freeze({...t,...e})}const Hx=te.createContext(null);function Zx(){const t=te.use(Hx);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function e2(t){function e(r,l){const{instance:f,context:_}=t(r).current;te.useImperativeHandle(l,()=>f);const{children:y}=r;return y==null?null:Nt.createElement(Hx,{value:_},y)}return te.forwardRef(e)}function _z(t){function e(r,l){const{instance:f}=t(r).current;return te.useImperativeHandle(l,()=>f),null}return te.forwardRef(e)}function t2(t,e){const r=te.useRef(void 0);te.useEffect(function(){return e!=null&&t.instance.on(e),r.current=e,function(){r.current!=null&&t.instance.off(r.current),r.current=null}},[t,e])}function Gx(t,e){const r=t.pane??e.pane;return r?{...t,pane:r}:t}var Am={exports:{}};var vz=Am.exports,sw;function i2(){return sw||(sw=1,(function(t,e){(function(r,l){l(e)})(vz,(function(r){var l="1.9.4";function f(u){var b,M,$,Z;for(M=1,$=arguments.length;M<$;M++){Z=arguments[M];for(b in Z)u[b]=Z[b]}return u}var _=Object.create||(function(){function u(){}return function(b){return u.prototype=b,new u}})();function y(u,b){var M=Array.prototype.slice;if(u.bind)return u.bind.apply(u,M.call(arguments,1));var $=M.call(arguments,2);return function(){return u.apply(b,$.length?$.concat(M.call(arguments)):arguments)}}var d=0;function A(u){return"_leaflet_id"in u||(u._leaflet_id=++d),u._leaflet_id}function I(u,b,M){var $,Z,le,Ce;return Ce=function(){$=!1,Z&&(le.apply(M,Z),Z=!1)},le=function(){$?Z=arguments:(u.apply(M,arguments),setTimeout(Ce,b),$=!0)},le}function B(u,b,M){var $=b[1],Z=b[0],le=$-Z;return u===$&&M?u:((u-Z)%le+le)%le+Z}function N(){return!1}function V(u,b){if(b===!1)return u;var M=Math.pow(10,b===void 0?6:b);return Math.round(u*M)/M}function K(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function ie(u){return K(u).split(/\s+/)}function ne(u,b){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?_(u.options):{});for(var M in b)u.options[M]=b[M];return u.options}function ve(u,b,M){var $=[];for(var Z in u)$.push(encodeURIComponent(M?Z.toUpperCase():Z)+"="+encodeURIComponent(u[Z]));return(!b||b.indexOf("?")===-1?"?":"&")+$.join("&")}var se=/\{ *([\w_ -]+) *\}/g;function ge(u,b){return u.replace(se,function(M,$){var Z=b[$];if(Z===void 0)throw new Error("No value provided for variable "+M);return typeof Z=="function"&&(Z=Z(b)),Z})}var ae=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function me(u,b){for(var M=0;M<u.length;M++)if(u[M]===b)return M;return-1}var ye="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Se(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var ze=0;function He(u){var b=+new Date,M=Math.max(0,16-(b-ze));return ze=b+M,window.setTimeout(u,M)}var Ze=window.requestAnimationFrame||Se("RequestAnimationFrame")||He,st=window.cancelAnimationFrame||Se("CancelAnimationFrame")||Se("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function lt(u,b,M){if(M&&Ze===He)u.call(b);else return Ze.call(window,y(u,b))}function Ke(u){u&&st.call(window,u)}var Mt={__proto__:null,extend:f,create:_,bind:y,get lastId(){return d},stamp:A,throttle:I,wrapNum:B,falseFn:N,formatNum:V,trim:K,splitWords:ie,setOptions:ne,getParamString:ve,template:ge,isArray:ae,indexOf:me,emptyImageUrl:ye,requestFn:Ze,cancelFn:st,requestAnimFrame:lt,cancelAnimFrame:Ke};function gt(){}gt.extend=function(u){var b=function(){ne(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},M=b.__super__=this.prototype,$=_(M);$.constructor=b,b.prototype=$;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(b[Z]=this[Z]);return u.statics&&f(b,u.statics),u.includes&&(St(u.includes),f.apply(null,[$].concat(u.includes))),f($,u),delete $.statics,delete $.includes,$.options&&($.options=M.options?_(M.options):{},f($.options,u.options)),$._initHooks=[],$.callInitHooks=function(){if(!this._initHooksCalled){M.callInitHooks&&M.callInitHooks.call(this),this._initHooksCalled=!0;for(var le=0,Ce=$._initHooks.length;le<Ce;le++)$._initHooks[le].call(this)}},b},gt.include=function(u){var b=this.prototype.options;return f(this.prototype,u),u.options&&(this.prototype.options=b,this.mergeOptions(u.options)),this},gt.mergeOptions=function(u){return f(this.prototype.options,u),this},gt.addInitHook=function(u){var b=Array.prototype.slice.call(arguments,1),M=typeof u=="function"?u:function(){this[u].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(M),this};function St(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=ae(u)?u:[u];for(var b=0;b<u.length;b++)u[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Be={on:function(u,b,M){if(typeof u=="object")for(var $ in u)this._on($,u[$],b);else{u=ie(u);for(var Z=0,le=u.length;Z<le;Z++)this._on(u[Z],b,M)}return this},off:function(u,b,M){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var $ in u)this._off($,u[$],b);else{u=ie(u);for(var Z=arguments.length===1,le=0,Ce=u.length;le<Ce;le++)Z?this._off(u[le]):this._off(u[le],b,M)}return this},_on:function(u,b,M,$){if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}if(this._listens(u,b,M)===!1){M===this&&(M=void 0);var Z={fn:b,ctx:M};$&&(Z.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(Z)}},_off:function(u,b,M){var $,Z,le;if(this._events&&($=this._events[u],!!$)){if(arguments.length===1){if(this._firingCount)for(Z=0,le=$.length;Z<le;Z++)$[Z].fn=N;delete this._events[u];return}if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}var Ce=this._listens(u,b,M);if(Ce!==!1){var We=$[Ce];this._firingCount&&(We.fn=N,this._events[u]=$=$.slice()),$.splice(Ce,1)}}},fire:function(u,b,M){if(!this.listens(u,M))return this;var $=f({},b,{type:u,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events){var Z=this._events[u];if(Z){this._firingCount=this._firingCount+1||1;for(var le=0,Ce=Z.length;le<Ce;le++){var We=Z[le],ht=We.fn;We.once&&this.off(u,ht,We.ctx),ht.call(We.ctx||this,$)}this._firingCount--}}return M&&this._propagateEvent($),this},listens:function(u,b,M,$){typeof u!="string"&&console.warn('"string" type argument expected');var Z=b;typeof b!="function"&&($=!!b,Z=void 0,M=void 0);var le=this._events&&this._events[u];if(le&&le.length&&this._listens(u,Z,M)!==!1)return!0;if($){for(var Ce in this._eventParents)if(this._eventParents[Ce].listens(u,b,M,$))return!0}return!1},_listens:function(u,b,M){if(!this._events)return!1;var $=this._events[u]||[];if(!b)return!!$.length;M===this&&(M=void 0);for(var Z=0,le=$.length;Z<le;Z++)if($[Z].fn===b&&$[Z].ctx===M)return Z;return!1},once:function(u,b,M){if(typeof u=="object")for(var $ in u)this._on($,u[$],b,!0);else{u=ie(u);for(var Z=0,le=u.length;Z<le;Z++)this._on(u[Z],b,M,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[A(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[A(u)],this},_propagateEvent:function(u){for(var b in this._eventParents)this._eventParents[b].fire(u.type,f({layer:u.target,propagatedFrom:u.target},u),!0)}};Be.addEventListener=Be.on,Be.removeEventListener=Be.clearAllEventListeners=Be.off,Be.addOneTimeEventListener=Be.once,Be.fireEvent=Be.fire,Be.hasEventListeners=Be.listens;var ot=gt.extend(Be);function Fe(u,b,M){this.x=M?Math.round(u):u,this.y=M?Math.round(b):b}var kt=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};Fe.prototype={clone:function(){return new Fe(this.x,this.y)},add:function(u){return this.clone()._add(rt(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(rt(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new Fe(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new Fe(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=kt(this.x),this.y=kt(this.y),this},distanceTo:function(u){u=rt(u);var b=u.x-this.x,M=u.y-this.y;return Math.sqrt(b*b+M*M)},equals:function(u){return u=rt(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=rt(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+V(this.x)+", "+V(this.y)+")"}};function rt(u,b,M){return u instanceof Fe?u:ae(u)?new Fe(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new Fe(u.x,u.y):new Fe(u,b,M)}function be(u,b){if(u)for(var M=b?[u,b]:u,$=0,Z=M.length;$<Z;$++)this.extend(M[$])}be.prototype={extend:function(u){var b,M;if(!u)return this;if(u instanceof Fe||typeof u[0]=="number"||"x"in u)b=M=rt(u);else if(u=Ie(u),b=u.min,M=u.max,!b||!M)return this;return!this.min&&!this.max?(this.min=b.clone(),this.max=M.clone()):(this.min.x=Math.min(b.x,this.min.x),this.max.x=Math.max(M.x,this.max.x),this.min.y=Math.min(b.y,this.min.y),this.max.y=Math.max(M.y,this.max.y)),this},getCenter:function(u){return rt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return rt(this.min.x,this.max.y)},getTopRight:function(){return rt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var b,M;return typeof u[0]=="number"||u instanceof Fe?u=rt(u):u=Ie(u),u instanceof be?(b=u.min,M=u.max):b=M=u,b.x>=this.min.x&&M.x<=this.max.x&&b.y>=this.min.y&&M.y<=this.max.y},intersects:function(u){u=Ie(u);var b=this.min,M=this.max,$=u.min,Z=u.max,le=Z.x>=b.x&&$.x<=M.x,Ce=Z.y>=b.y&&$.y<=M.y;return le&&Ce},overlaps:function(u){u=Ie(u);var b=this.min,M=this.max,$=u.min,Z=u.max,le=Z.x>b.x&&$.x<M.x,Ce=Z.y>b.y&&$.y<M.y;return le&&Ce},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var b=this.min,M=this.max,$=Math.abs(b.x-M.x)*u,Z=Math.abs(b.y-M.y)*u;return Ie(rt(b.x-$,b.y-Z),rt(M.x+$,M.y+Z))},equals:function(u){return u?(u=Ie(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function Ie(u,b){return!u||u instanceof be?u:new be(u,b)}function et(u,b){if(u)for(var M=b?[u,b]:u,$=0,Z=M.length;$<Z;$++)this.extend(M[$])}et.prototype={extend:function(u){var b=this._southWest,M=this._northEast,$,Z;if(u instanceof mt)$=u,Z=u;else if(u instanceof et){if($=u._southWest,Z=u._northEast,!$||!Z)return this}else return u?this.extend(Ct(u)||at(u)):this;return!b&&!M?(this._southWest=new mt($.lat,$.lng),this._northEast=new mt(Z.lat,Z.lng)):(b.lat=Math.min($.lat,b.lat),b.lng=Math.min($.lng,b.lng),M.lat=Math.max(Z.lat,M.lat),M.lng=Math.max(Z.lng,M.lng)),this},pad:function(u){var b=this._southWest,M=this._northEast,$=Math.abs(b.lat-M.lat)*u,Z=Math.abs(b.lng-M.lng)*u;return new et(new mt(b.lat-$,b.lng-Z),new mt(M.lat+$,M.lng+Z))},getCenter:function(){return new mt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new mt(this.getNorth(),this.getWest())},getSouthEast:function(){return new mt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof mt||"lat"in u?u=Ct(u):u=at(u);var b=this._southWest,M=this._northEast,$,Z;return u instanceof et?($=u.getSouthWest(),Z=u.getNorthEast()):$=Z=u,$.lat>=b.lat&&Z.lat<=M.lat&&$.lng>=b.lng&&Z.lng<=M.lng},intersects:function(u){u=at(u);var b=this._southWest,M=this._northEast,$=u.getSouthWest(),Z=u.getNorthEast(),le=Z.lat>=b.lat&&$.lat<=M.lat,Ce=Z.lng>=b.lng&&$.lng<=M.lng;return le&&Ce},overlaps:function(u){u=at(u);var b=this._southWest,M=this._northEast,$=u.getSouthWest(),Z=u.getNorthEast(),le=Z.lat>b.lat&&$.lat<M.lat,Ce=Z.lng>b.lng&&$.lng<M.lng;return le&&Ce},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,b){return u?(u=at(u),this._southWest.equals(u.getSouthWest(),b)&&this._northEast.equals(u.getNorthEast(),b)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function at(u,b){return u instanceof et?u:new et(u,b)}function mt(u,b,M){if(isNaN(u)||isNaN(b))throw new Error("Invalid LatLng object: ("+u+", "+b+")");this.lat=+u,this.lng=+b,M!==void 0&&(this.alt=+M)}mt.prototype={equals:function(u,b){if(!u)return!1;u=Ct(u);var M=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return M<=(b===void 0?1e-9:b)},toString:function(u){return"LatLng("+V(this.lat,u)+", "+V(this.lng,u)+")"},distanceTo:function(u){return Kt.distance(this,Ct(u))},wrap:function(){return Kt.wrapLatLng(this)},toBounds:function(u){var b=180*u/40075017,M=b/Math.cos(Math.PI/180*this.lat);return at([this.lat-b,this.lng-M],[this.lat+b,this.lng+M])},clone:function(){return new mt(this.lat,this.lng,this.alt)}};function Ct(u,b,M){return u instanceof mt?u:ae(u)&&typeof u[0]!="object"?u.length===3?new mt(u[0],u[1],u[2]):u.length===2?new mt(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new mt(u.lat,"lng"in u?u.lng:u.lon,u.alt):b===void 0?null:new mt(u,b,M)}var Ot={latLngToPoint:function(u,b){var M=this.projection.project(u),$=this.scale(b);return this.transformation._transform(M,$)},pointToLatLng:function(u,b){var M=this.scale(b),$=this.transformation.untransform(u,M);return this.projection.unproject($)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var b=this.projection.bounds,M=this.scale(u),$=this.transformation.transform(b.min,M),Z=this.transformation.transform(b.max,M);return new be($,Z)},infinite:!1,wrapLatLng:function(u){var b=this.wrapLng?B(u.lng,this.wrapLng,!0):u.lng,M=this.wrapLat?B(u.lat,this.wrapLat,!0):u.lat,$=u.alt;return new mt(M,b,$)},wrapLatLngBounds:function(u){var b=u.getCenter(),M=this.wrapLatLng(b),$=b.lat-M.lat,Z=b.lng-M.lng;if($===0&&Z===0)return u;var le=u.getSouthWest(),Ce=u.getNorthEast(),We=new mt(le.lat-$,le.lng-Z),ht=new mt(Ce.lat-$,Ce.lng-Z);return new et(We,ht)}},Kt=f({},Ot,{wrapLng:[-180,180],R:6371e3,distance:function(u,b){var M=Math.PI/180,$=u.lat*M,Z=b.lat*M,le=Math.sin((b.lat-u.lat)*M/2),Ce=Math.sin((b.lng-u.lng)*M/2),We=le*le+Math.cos($)*Math.cos(Z)*Ce*Ce,ht=2*Math.atan2(Math.sqrt(We),Math.sqrt(1-We));return this.R*ht}}),_i=6378137,Vi={R:_i,MAX_LATITUDE:85.0511287798,project:function(u){var b=Math.PI/180,M=this.MAX_LATITUDE,$=Math.max(Math.min(M,u.lat),-M),Z=Math.sin($*b);return new Fe(this.R*u.lng*b,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(u){var b=180/Math.PI;return new mt((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*b,u.x*b/this.R)},bounds:(function(){var u=_i*Math.PI;return new be([-u,-u],[u,u])})()};function gi(u,b,M,$){if(ae(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=b,this._c=M,this._d=$}gi.prototype={transform:function(u,b){return this._transform(u.clone(),b)},_transform:function(u,b){return b=b||1,u.x=b*(this._a*u.x+this._b),u.y=b*(this._c*u.y+this._d),u},untransform:function(u,b){return b=b||1,new Fe((u.x/b-this._b)/this._a,(u.y/b-this._d)/this._c)}};function Oi(u,b,M,$){return new gi(u,b,M,$)}var xn=f({},Kt,{code:"EPSG:3857",projection:Vi,transformation:(function(){var u=.5/(Math.PI*Vi.R);return Oi(u,.5,-u,.5)})()}),cn=f({},xn,{code:"EPSG:900913"});function Zn(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function tt(u,b){var M="",$,Z,le,Ce,We,ht;for($=0,le=u.length;$<le;$++){for(We=u[$],Z=0,Ce=We.length;Z<Ce;Z++)ht=We[Z],M+=(Z?"L":"M")+ht.x+" "+ht.y;M+=b?nt.svg?"z":"x":""}return M||"M0 0"}var Xn=document.documentElement.style,Pn="ActiveXObject"in window,ki=Pn&&!document.addEventListener,yi="msLaunchUri"in navigator&&!("documentMode"in document),Cn=Ye("webkit"),Ln=Ye("android"),us=Ye("android 2")||Ye("android 3"),an=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),en=Ln&&Ye("Google")&&an<537&&!("AudioNode"in window),qi=!!window.opera,Fn=!yi&&Ye("chrome"),Tt=Ye("gecko")&&!Cn&&!qi&&!Pn,On=!Fn&&Ye("safari"),dn=Ye("phantom"),An="OTransition"in Xn,Kn=navigator.platform.indexOf("Win")===0,It=Pn&&"transition"in Xn,ai="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!us,ti="MozPerspective"in Xn,Ji=!window.L_DISABLE_3D&&(It||ai||ti)&&!An&&!dn,Nn=typeof orientation<"u"||Ye("mobile"),mi=Nn&&Cn,Bt=Nn&&ai,hi=!window.PointerEvent&&window.MSPointerEvent,Ci=!!(window.PointerEvent||hi),bi="ontouchstart"in window||!!window.TouchEvent,xe=!window.L_NO_TOUCH&&(bi||Ci),ee=Nn&&qi,Q=Nn&&Tt,ue=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,we=(function(){var u=!1;try{var b=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",N,b),window.removeEventListener("testPassiveEventSupport",N,b)}catch{}return u})(),je=(function(){return!!document.createElement("canvas").getContext})(),Oe=!!(document.createElementNS&&Zn("svg").createSVGRect),qe=!!Oe&&(function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),de=!Oe&&(function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var b=u.firstChild;return b.style.behavior="url(#default#VML)",b&&typeof b.adj=="object"}catch{return!1}})(),Je=navigator.platform.indexOf("Mac")===0,ct=navigator.platform.indexOf("Linux")===0;function Ye(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var nt={ie:Pn,ielt9:ki,edge:yi,webkit:Cn,android:Ln,android23:us,androidStock:en,opera:qi,chrome:Fn,gecko:Tt,safari:On,phantom:dn,opera12:An,win:Kn,ie3d:It,webkit3d:ai,gecko3d:ti,any3d:Ji,mobile:Nn,mobileWebkit:mi,mobileWebkit3d:Bt,msPointer:hi,pointer:Ci,touch:xe,touchNative:bi,mobileOpera:ee,mobileGecko:Q,retina:ue,passiveEvents:we,canvas:je,svg:Oe,vml:de,inlineSvg:qe,mac:Je,linux:ct},ei=nt.msPointer?"MSPointerDown":"pointerdown",si=nt.msPointer?"MSPointerMove":"pointermove",$t=nt.msPointer?"MSPointerUp":"pointerup",At=nt.msPointer?"MSPointerCancel":"pointercancel",ni={touchstart:ei,touchmove:si,touchend:$t,touchcancel:At},vi={touchstart:wi,touchmove:Ki,touchend:Ki,touchcancel:Ki},Bi={},_t=!1;function xt(u,b,M){return b==="touchstart"&&Jt(),vi[b]?(M=vi[b].bind(this,M),u.addEventListener(ni[b],M,!1),M):(console.warn("wrong event specified:",b),N)}function Wt(u,b,M){if(!ni[b]){console.warn("wrong event specified:",b);return}u.removeEventListener(ni[b],M,!1)}function pi(u){Bi[u.pointerId]=u}function Ne(u){Bi[u.pointerId]&&(Bi[u.pointerId]=u)}function zt(u){delete Bi[u.pointerId]}function Jt(){_t||(document.addEventListener(ei,pi,!0),document.addEventListener(si,Ne,!0),document.addEventListener($t,zt,!0),document.addEventListener(At,zt,!0),_t=!0)}function Ki(u,b){if(b.pointerType!==(b.MSPOINTER_TYPE_MOUSE||"mouse")){b.touches=[];for(var M in Bi)b.touches.push(Bi[M]);b.changedTouches=[b],u(b)}}function wi(u,b){b.MSPOINTER_TYPE_TOUCH&&b.pointerType===b.MSPOINTER_TYPE_TOUCH&&xs(b),Ki(u,b)}function vn(u){var b={},M,$;for($ in u)M=u[$],b[$]=M&&M.bind?M.bind(u):M;return u=b,b.type="dblclick",b.detail=2,b.isTrusted=!1,b._simulated=!0,b}var gr=200;function Ys(u,b){u.addEventListener("dblclick",b);var M=0,$;function Z(le){if(le.detail!==1){$=le.detail;return}if(!(le.pointerType==="mouse"||le.sourceCapabilities&&!le.sourceCapabilities.firesTouchEvents)){var Ce=Ko(le);if(!(Ce.some(function(ht){return ht instanceof HTMLLabelElement&&ht.attributes.for})&&!Ce.some(function(ht){return ht instanceof HTMLInputElement||ht instanceof HTMLSelectElement}))){var We=Date.now();We-M<=gr?($++,$===2&&b(vn(le))):$=1,M=We}}}return u.addEventListener("click",Z),{dblclick:b,simDblclick:Z}}function zs(u,b){u.removeEventListener("dblclick",b.dblclick),u.removeEventListener("click",b.simDblclick)}var Eo=pn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ir=pn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),yr=ir==="webkitTransition"||ir==="OTransition"?ir+"End":"transitionend";function ko(u){return typeof u=="string"?document.getElementById(u):u}function _a(u,b){var M=u.style[b]||u.currentStyle&&u.currentStyle[b];if((!M||M==="auto")&&document.defaultView){var $=document.defaultView.getComputedStyle(u,null);M=$?$[b]:null}return M==="auto"?null:M}function Pi(u,b,M){var $=document.createElement(u);return $.className=b||"",M&&M.appendChild($),$}function zn(u){var b=u.parentNode;b&&b.removeChild(u)}function ys(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function fn(u){var b=u.parentNode;b&&b.lastChild!==u&&b.appendChild(u)}function Ra(u){var b=u.parentNode;b&&b.firstChild!==u&&b.insertBefore(u,b.firstChild)}function Br(u,b){if(u.classList!==void 0)return u.classList.contains(b);var M=Wo(u);return M.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(M)}function Hi(u,b){if(u.classList!==void 0)for(var M=ie(b),$=0,Z=M.length;$<Z;$++)u.classList.add(M[$]);else if(!Br(u,b)){var le=Wo(u);Il(u,(le?le+" ":"")+b)}}function In(u,b){u.classList!==void 0?u.classList.remove(b):Il(u,K((" "+Wo(u)+" ").replace(" "+b+" "," ")))}function Il(u,b){u.className.baseVal===void 0?u.className=b:u.className.baseVal=b}function Wo(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function Bn(u,b){"opacity"in u.style?u.style.opacity=b:"filter"in u.style&&Da(u,b)}function Da(u,b){var M=!1,$="DXImageTransform.Microsoft.Alpha";try{M=u.filters.item($)}catch{if(b===1)return}b=Math.round(b*100),M?(M.Enabled=b!==100,M.Opacity=b):u.style.filter+=" progid:"+$+"(opacity="+b+")"}function pn(u){for(var b=document.documentElement.style,M=0;M<u.length;M++)if(u[M]in b)return u[M];return!1}function va(u,b,M){var $=b||new Fe(0,0);u.style[Eo]=(nt.ie3d?"translate("+$.x+"px,"+$.y+"px)":"translate3d("+$.x+"px,"+$.y+"px,0)")+(M?" scale("+M+")":"")}function Gn(u,b){u._leaflet_pos=b,nt.any3d?va(u,b):(u.style.left=b.x+"px",u.style.top=b.y+"px")}function $r(u){return u._leaflet_pos||new Fe(0,0)}var Co,Ur,Yo;if("onselectstart"in document)Co=function(){Di(window,"selectstart",xs)},Ur=function(){jn(window,"selectstart",xs)};else{var ro=pn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Co=function(){if(ro){var u=document.documentElement.style;Yo=u[ro],u[ro]="none"}},Ur=function(){ro&&(document.documentElement.style[ro]=Yo,Yo=void 0)}}function ao(){Di(window,"dragstart",xs)}function jl(){jn(window,"dragstart",xs)}var Ic,jc;function Ll(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&($s(),Ic=u,jc=u.style.outlineStyle,u.style.outlineStyle="none",Di(window,"keydown",$s))}function $s(){Ic&&(Ic.style.outlineStyle=jc,Ic=void 0,jc=void 0,jn(window,"keydown",$s))}function Ao(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function Us(u){var b=u.getBoundingClientRect();return{x:b.width/u.offsetWidth||1,y:b.height/u.offsetHeight||1,boundingClientRect:b}}var Rs={__proto__:null,TRANSFORM:Eo,TRANSITION:ir,TRANSITION_END:yr,get:ko,getStyle:_a,create:Pi,remove:zn,empty:ys,toFront:fn,toBack:Ra,hasClass:Br,addClass:Hi,removeClass:In,setClass:Il,getClass:Wo,setOpacity:Bn,testProp:pn,setTransform:va,setPosition:Gn,getPosition:$r,get disableTextSelection(){return Co},get enableTextSelection(){return Ur},disableImageDrag:ao,enableImageDrag:jl,preventOutline:Ll,restoreOutline:$s,getSizedParentNode:Ao,getScale:Us};function Di(u,b,M,$){if(b&&typeof b=="object")for(var Z in b)xa(u,Z,b[Z],M);else{b=ie(b);for(var le=0,Ce=b.length;le<Ce;le++)xa(u,b[le],M,$)}return this}var Mr="_leaflet_events";function jn(u,b,M,$){if(arguments.length===1)Lc(u),delete u[Mr];else if(b&&typeof b=="object")for(var Z in b)zl(u,Z,b[Z],M);else if(b=ie(b),arguments.length===2)Lc(u,function(We){return me(b,We)!==-1});else for(var le=0,Ce=b.length;le<Ce;le++)zl(u,b[le],M,$);return this}function Lc(u,b){for(var M in u[Mr]){var $=M.split(/\d/)[0];(!b||b($))&&zl(u,$,null,null,M)}}var ia={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function xa(u,b,M,$){var Z=b+A(M)+($?"_"+A($):"");if(u[Mr]&&u[Mr][Z])return this;var le=function(We){return M.call($||u,We||window.event)},Ce=le;!nt.touchNative&&nt.pointer&&b.indexOf("touch")===0?le=xt(u,b,le):nt.touch&&b==="dblclick"?le=Ys(u,le):"addEventListener"in u?b==="touchstart"||b==="touchmove"||b==="wheel"||b==="mousewheel"?u.addEventListener(ia[b]||b,le,nt.passiveEvents?{passive:!1}:!1):b==="mouseenter"||b==="mouseleave"?(le=function(We){We=We||window.event,Fs(u,We)&&Ce(We)},u.addEventListener(ia[b],le,!1)):u.addEventListener(b,Ce,!1):u.attachEvent("on"+b,le),u[Mr]=u[Mr]||{},u[Mr][Z]=le}function zl(u,b,M,$,Z){Z=Z||b+A(M)+($?"_"+A($):"");var le=u[Mr]&&u[Mr][Z];if(!le)return this;!nt.touchNative&&nt.pointer&&b.indexOf("touch")===0?Wt(u,b,le):nt.touch&&b==="dblclick"?zs(u,le):"removeEventListener"in u?u.removeEventListener(ia[b]||b,le,!1):u.detachEvent("on"+b,le),u[Mr][Z]=null}function na(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function Oa(u){return xa(u,"wheel",na),this}function Xo(u){return Di(u,"mousedown touchstart dblclick contextmenu",na),u._leaflet_disable_click=!0,this}function xs(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function sa(u){return xs(u),na(u),this}function Ko(u){if(u.composedPath)return u.composedPath();for(var b=[],M=u.target;M;)b.push(M),M=M.parentNode;return b}function Mo(u,b){if(!b)return new Fe(u.clientX,u.clientY);var M=Us(b),$=M.boundingClientRect;return new Fe((u.clientX-$.left)/M.x-b.clientLeft,(u.clientY-$.top)/M.y-b.clientTop)}var zc=nt.linux&&nt.chrome?window.devicePixelRatio:nt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Xs(u){return nt.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/zc:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function Fs(u,b){var M=b.relatedTarget;if(!M)return!0;try{for(;M&&M!==u;)M=M.parentNode}catch{return!1}return M!==u}var Rc={__proto__:null,on:Di,off:jn,stopPropagation:na,disableScrollPropagation:Oa,disableClickPropagation:Xo,preventDefault:xs,stop:sa,getPropagationPath:Ko,getMousePosition:Mo,getWheelDelta:Xs,isExternalTarget:Fs,addListener:Di,removeListener:jn},Po=ot.extend({run:function(u,b,M,$){this.stop(),this._el=u,this._inProgress=!0,this._duration=M||.25,this._easeOutPower=1/Math.max($||.5,.2),this._startPos=$r(u),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=lt(this._animate,this),this._step()},_step:function(u){var b=+new Date-this._startTime,M=this._duration*1e3;b<M?this._runFrame(this._easeOut(b/M),u):(this._runFrame(1),this._complete())},_runFrame:function(u,b){var M=this._startPos.add(this._offset.multiplyBy(u));b&&M._round(),Gn(this._el,M),this.fire("step")},_complete:function(){Ke(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),tn=ot.extend({options:{crs:xn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,b){b=ne(this,b),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=y(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==void 0&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==void 0&&this.setView(Ct(b.center),b.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ir&&nt.any3d&&!nt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Di(this._proxy,yr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,b,M){if(b=b===void 0?this._zoom:this._limitZoom(b),u=this._limitCenter(Ct(u),b,this.options.maxBounds),M=M||{},this._stop(),this._loaded&&!M.reset&&M!==!0){M.animate!==void 0&&(M.zoom=f({animate:M.animate},M.zoom),M.pan=f({animate:M.animate,duration:M.duration},M.pan));var $=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,b,M.zoom):this._tryAnimatedPan(u,M.pan);if($)return clearTimeout(this._sizeTimer),this}return this._resetView(u,b,M.pan&&M.pan.noMoveStart),this},setZoom:function(u,b){return this._loaded?this.setView(this.getCenter(),u,{zoom:b}):(this._zoom=u,this)},zoomIn:function(u,b){return u=u||(nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,b)},zoomOut:function(u,b){return u=u||(nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,b)},setZoomAround:function(u,b,M){var $=this.getZoomScale(b),Z=this.getSize().divideBy(2),le=u instanceof Fe?u:this.latLngToContainerPoint(u),Ce=le.subtract(Z).multiplyBy(1-1/$),We=this.containerPointToLatLng(Z.add(Ce));return this.setView(We,b,{zoom:M})},_getBoundsCenterZoom:function(u,b){b=b||{},u=u.getBounds?u.getBounds():at(u);var M=rt(b.paddingTopLeft||b.padding||[0,0]),$=rt(b.paddingBottomRight||b.padding||[0,0]),Z=this.getBoundsZoom(u,!1,M.add($));if(Z=typeof b.maxZoom=="number"?Math.min(b.maxZoom,Z):Z,Z===1/0)return{center:u.getCenter(),zoom:Z};var le=$.subtract(M).divideBy(2),Ce=this.project(u.getSouthWest(),Z),We=this.project(u.getNorthEast(),Z),ht=this.unproject(Ce.add(We).divideBy(2).add(le),Z);return{center:ht,zoom:Z}},fitBounds:function(u,b){if(u=at(u),!u.isValid())throw new Error("Bounds are not valid.");var M=this._getBoundsCenterZoom(u,b);return this.setView(M.center,M.zoom,b)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,b){return this.setView(u,this._zoom,{pan:b})},panBy:function(u,b){if(u=rt(u).round(),b=b||{},!u.x&&!u.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Po,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){Hi(this._mapPane,"leaflet-pan-anim");var M=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,M,b.duration||.25,b.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,b,M){if(M=M||{},M.animate===!1||!nt.any3d)return this.setView(u,b,M);this._stop();var $=this.project(this.getCenter()),Z=this.project(u),le=this.getSize(),Ce=this._zoom;u=Ct(u),b=b===void 0?Ce:b;var We=Math.max(le.x,le.y),ht=We*this.getZoomScale(Ce,b),wt=Z.distanceTo($)||1,Yt=1.42,Si=Yt*Yt;function ln(ms){var Ui=ms?-1:1,mo=ms?ht:We,ku=ht*ht-We*We+Ui*Si*Si*wt*wt,gl=2*mo*Si*wt,cc=ku/gl,Wr=Math.sqrt(cc*cc+1)-cc,Va=Wr<1e-9?-18:Math.log(Wr);return Va}function qs(ms){return(Math.exp(ms)-Math.exp(-ms))/2}function bs(ms){return(Math.exp(ms)+Math.exp(-ms))/2}function wr(ms){return qs(ms)/bs(ms)}var bn=ln(0);function Qi(ms){return We*(bs(bn)/bs(bn+Yt*ms))}function jt(ms){return We*(bs(bn)*wr(bn+Yt*ms)-qs(bn))/Si}function ka(ms){return 1-Math.pow(1-ms,1.5)}var jr=Date.now(),lc=(ln(1)-bn)/Yt,Gr=M.duration?1e3*M.duration:1e3*lc*.8;function Do(){var ms=(Date.now()-jr)/Gr,Ui=ka(ms)*lc;ms<=1?(this._flyToFrame=lt(Do,this),this._move(this.unproject($.add(Z.subtract($).multiplyBy(jt(Ui)/wt)),Ce),this.getScaleZoom(We/Qi(Ui),Ce),{flyTo:!0})):this._move(u,b)._moveEnd(!0)}return this._moveStart(!0,M.noMoveStart),Do.call(this),this},flyToBounds:function(u,b){var M=this._getBoundsCenterZoom(u,b);return this.flyTo(M.center,M.zoom,b)},setMaxBounds:function(u){return u=at(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var b=this.options.minZoom;return this.options.minZoom=u,this._loaded&&b!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var b=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&b!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,b){this._enforcingBounds=!0;var M=this.getCenter(),$=this._limitCenter(M,this._zoom,at(u));return M.equals($)||this.panTo($,b),this._enforcingBounds=!1,this},panInside:function(u,b){b=b||{};var M=rt(b.paddingTopLeft||b.padding||[0,0]),$=rt(b.paddingBottomRight||b.padding||[0,0]),Z=this.project(this.getCenter()),le=this.project(u),Ce=this.getPixelBounds(),We=Ie([Ce.min.add(M),Ce.max.subtract($)]),ht=We.getSize();if(!We.contains(le)){this._enforcingBounds=!0;var wt=le.subtract(We.getCenter()),Yt=We.extend(le).getSize().subtract(ht);Z.x+=wt.x<0?-Yt.x:Yt.x,Z.y+=wt.y<0?-Yt.y:Yt.y,this.panTo(this.unproject(Z),b),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=f({animate:!1,pan:!0},u===!0?{animate:!0}:u);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var M=this.getSize(),$=b.divideBy(2).round(),Z=M.divideBy(2).round(),le=$.subtract(Z);return!le.x&&!le.y?this:(u.animate&&u.pan?this.panBy(le):(u.pan&&this._rawPanBy(le),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(y(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:M}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=f({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=y(this._handleGeolocationResponse,this),M=y(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,M,u):navigator.geolocation.getCurrentPosition(b,M,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var b=u.code,M=u.message||(b===1?"permission denied":b===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+M+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var b=u.coords.latitude,M=u.coords.longitude,$=new mt(b,M),Z=$.toBounds(u.coords.accuracy*2),le=this._locateOptions;if(le.setView){var Ce=this.getBoundsZoom(Z);this.setView($,le.maxZoom?Math.min(Ce,le.maxZoom):Ce)}var We={latlng:$,bounds:Z,timestamp:u.timestamp};for(var ht in u.coords)typeof u.coords[ht]=="number"&&(We[ht]=u.coords[ht]);this.fire("locationfound",We)}},addHandler:function(u,b){if(!b)return this;var M=this[u]=new b(this);return this._handlers.push(M),this.options[u]&&M.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),zn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Ke(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)zn(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,b){var M="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),$=Pi("div",M,b||this._mapPane);return u&&(this._panes[u]=$),$},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),b=this.unproject(u.getBottomLeft()),M=this.unproject(u.getTopRight());return new et(b,M)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,b,M){u=at(u),M=rt(M||[0,0]);var $=this.getZoom()||0,Z=this.getMinZoom(),le=this.getMaxZoom(),Ce=u.getNorthWest(),We=u.getSouthEast(),ht=this.getSize().subtract(M),wt=Ie(this.project(We,$),this.project(Ce,$)).getSize(),Yt=nt.any3d?this.options.zoomSnap:1,Si=ht.x/wt.x,ln=ht.y/wt.y,qs=b?Math.max(Si,ln):Math.min(Si,ln);return $=this.getScaleZoom(qs,$),Yt&&($=Math.round($/(Yt/100))*(Yt/100),$=b?Math.ceil($/Yt)*Yt:Math.floor($/Yt)*Yt),Math.max(Z,Math.min(le,$))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Fe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,b){var M=this._getTopLeftPoint(u,b);return new be(M,M.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,b){var M=this.options.crs;return b=b===void 0?this._zoom:b,M.scale(u)/M.scale(b)},getScaleZoom:function(u,b){var M=this.options.crs;b=b===void 0?this._zoom:b;var $=M.zoom(u*M.scale(b));return isNaN($)?1/0:$},project:function(u,b){return b=b===void 0?this._zoom:b,this.options.crs.latLngToPoint(Ct(u),b)},unproject:function(u,b){return b=b===void 0?this._zoom:b,this.options.crs.pointToLatLng(rt(u),b)},layerPointToLatLng:function(u){var b=rt(u).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(u){var b=this.project(Ct(u))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(Ct(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(at(u))},distance:function(u,b){return this.options.crs.distance(Ct(u),Ct(b))},containerPointToLayerPoint:function(u){return rt(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return rt(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var b=this.containerPointToLayerPoint(rt(u));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ct(u)))},mouseEventToContainerPoint:function(u){return Mo(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var b=this._container=ko(u);if(b){if(b._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Di(b,"scroll",this._onScroll,this),this._containerId=A(b)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&nt.any3d,Hi(u,"leaflet-container"+(nt.touch?" leaflet-touch":"")+(nt.retina?" leaflet-retina":"")+(nt.ielt9?" leaflet-oldie":"")+(nt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=_a(u,"position");b!=="absolute"&&b!=="relative"&&b!=="fixed"&&b!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Gn(this._mapPane,new Fe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Hi(u.markerPane,"leaflet-zoom-hide"),Hi(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,b,M){Gn(this._mapPane,new Fe(0,0));var $=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var Z=this._zoom!==b;this._moveStart(Z,M)._move(u,b)._moveEnd(Z),this.fire("viewreset"),$&&this.fire("load")},_moveStart:function(u,b){return u&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(u,b,M,$){b===void 0&&(b=this._zoom);var Z=this._zoom!==b;return this._zoom=b,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),$?M&&M.pinch&&this.fire("zoom",M):((Z||M&&M.pinch)&&this.fire("zoom",M),this.fire("move",M)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Ke(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){Gn(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[A(this._container)]=this;var b=u?jn:Di;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),nt.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Ke(this._resizeRequest),this._resizeRequest=lt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,b){for(var M=[],$,Z=b==="mouseout"||b==="mouseover",le=u.target||u.srcElement,Ce=!1;le;){if($=this._targets[A(le)],$&&(b==="click"||b==="preclick")&&this._draggableMoved($)){Ce=!0;break}if($&&$.listens(b,!0)&&(Z&&!Fs(le,u)||(M.push($),Z))||le===this._container)break;le=le.parentNode}return!M.length&&!Ce&&!Z&&this.listens(b,!0)&&(M=[this]),M},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var b=u.target||u.srcElement;if(!(!this._loaded||b._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(b))){var M=u.type;M==="mousedown"&&Ll(b),this._fireDOMEvent(u,M)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,b,M){if(u.type==="click"){var $=f({},u);$.type="preclick",this._fireDOMEvent($,$.type,M)}var Z=this._findEventTargets(u,b);if(M){for(var le=[],Ce=0;Ce<M.length;Ce++)M[Ce].listens(b,!0)&&le.push(M[Ce]);Z=le.concat(Z)}if(Z.length){b==="contextmenu"&&xs(u);var We=Z[0],ht={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var wt=We.getLatLng&&(!We._radius||We._radius<=10);ht.containerPoint=wt?this.latLngToContainerPoint(We.getLatLng()):this.mouseEventToContainerPoint(u),ht.layerPoint=this.containerPointToLayerPoint(ht.containerPoint),ht.latlng=wt?We.getLatLng():this.layerPointToLatLng(ht.layerPoint)}for(Ce=0;Ce<Z.length;Ce++)if(Z[Ce].fire(b,ht,!0),ht.originalEvent._stopped||Z[Ce].options.bubblingMouseEvents===!1&&me(this._mouseEvents,b)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,b=this._handlers.length;u<b;u++)this._handlers[u].disable()},whenReady:function(u,b){return this._loaded?u.call(b||this,{target:this}):this.on("load",u,b),this},_getMapPanePos:function(){return $r(this._mapPane)||new Fe(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,b){var M=u&&b!==void 0?this._getNewPixelOrigin(u,b):this.getPixelOrigin();return M.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,b){var M=this.getSize()._divideBy(2);return this.project(u,b)._subtract(M)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,b,M){var $=this._getNewPixelOrigin(M,b);return this.project(u,b)._subtract($)},_latLngBoundsToNewLayerBounds:function(u,b,M){var $=this._getNewPixelOrigin(M,b);return Ie([this.project(u.getSouthWest(),b)._subtract($),this.project(u.getNorthWest(),b)._subtract($),this.project(u.getSouthEast(),b)._subtract($),this.project(u.getNorthEast(),b)._subtract($)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,b,M){if(!M)return u;var $=this.project(u,b),Z=this.getSize().divideBy(2),le=new be($.subtract(Z),$.add(Z)),Ce=this._getBoundsOffset(le,M,b);return Math.abs(Ce.x)<=1&&Math.abs(Ce.y)<=1?u:this.unproject($.add(Ce),b)},_limitOffset:function(u,b){if(!b)return u;var M=this.getPixelBounds(),$=new be(M.min.add(u),M.max.add(u));return u.add(this._getBoundsOffset($,b))},_getBoundsOffset:function(u,b,M){var $=Ie(this.project(b.getNorthEast(),M),this.project(b.getSouthWest(),M)),Z=$.min.subtract(u.min),le=$.max.subtract(u.max),Ce=this._rebound(Z.x,-le.x),We=this._rebound(Z.y,-le.y);return new Fe(Ce,We)},_rebound:function(u,b){return u+b>0?Math.round(u-b)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(b))},_limitZoom:function(u){var b=this.getMinZoom(),M=this.getMaxZoom(),$=nt.any3d?this.options.zoomSnap:1;return $&&(u=Math.round(u/$)*$),Math.max(b,Math.min(M,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){In(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,b){var M=this._getCenterOffset(u)._trunc();return(b&&b.animate)!==!0&&!this.getSize().contains(M)?!1:(this.panBy(M,b),!0)},_createAnimProxy:function(){var u=this._proxy=Pi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(b){var M=Eo,$=this._proxy.style[M];va(this._proxy,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),$===this._proxy.style[M]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){zn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),b=this.getZoom();va(this._proxy,this.project(u,b),this.getZoomScale(b,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,b,M){if(this._animatingZoom)return!0;if(M=M||{},!this._zoomAnimated||M.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var $=this.getZoomScale(b),Z=this._getCenterOffset(u)._divideBy(1-1/$);return M.animate!==!0&&!this.getSize().contains(Z)?!1:(lt(function(){this._moveStart(!0,M.noMoveStart||!1)._animateZoom(u,b,!0)},this),!0)},_animateZoom:function(u,b,M,$){this._mapPane&&(M&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=b,Hi(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:b,noUpdate:$}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(y(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&In(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Na(u,b){return new tn(u,b)}var Zi=gt.extend({options:{position:"topright"},initialize:function(u){ne(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var b=this._map;return b&&b.removeControl(this),this.options.position=u,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var b=this._container=this.onAdd(u),M=this.getPosition(),$=u._controlCorners[M];return Hi(b,"leaflet-control"),M.indexOf("bottom")!==-1?$.insertBefore(b,$.firstChild):$.appendChild(b),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(zn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),ra=function(u){return new Zi(u)};tn.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},b="leaflet-",M=this._controlContainer=Pi("div",b+"control-container",this._container);function $(Z,le){var Ce=b+Z+" "+b+le;u[Z+le]=Pi("div",Ce,M)}$("top","left"),$("top","right"),$("bottom","left"),$("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)zn(this._controlCorners[u]);zn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ec=Zi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,b,M,$){return M<$?-1:$<M?1:0}},initialize:function(u,b,M){ne(this,M),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var $ in u)this._addLayer(u[$],$);for($ in b)this._addLayer(b[$],$,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return Zi.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,b){return this._addLayer(u,b),this._map?this._update():this},addOverlay:function(u,b){return this._addLayer(u,b,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var b=this._getLayer(A(u));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){Hi(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?(Hi(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):In(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return In(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",b=this._container=Pi("div",u),M=this.options.collapsed;b.setAttribute("aria-haspopup",!0),Xo(b),Oa(b);var $=this._section=Pi("section",u+"-list");M&&(this._map.on("click",this.collapse,this),Di(b,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=Pi("a",u+"-toggle",b);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),Di(Z,{keydown:function(le){le.keyCode===13&&this._expandSafely()},click:function(le){xs(le),this._expandSafely()}},this),M||this.expand(),this._baseLayersList=Pi("div",u+"-base",$),this._separator=Pi("div",u+"-separator",$),this._overlaysList=Pi("div",u+"-overlays",$),b.appendChild($)},_getLayer:function(u){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&A(this._layers[b].layer)===u)return this._layers[b]},_addLayer:function(u,b,M){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:b,overlay:M}),this.options.sortLayers&&this._layers.sort(y(function($,Z){return this.options.sortFunction($.layer,Z.layer,$.name,Z.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ys(this._baseLayersList),ys(this._overlaysList),this._layerControlInputs=[];var u,b,M,$,Z=0;for(M=0;M<this._layers.length;M++)$=this._layers[M],this._addItem($),b=b||$.overlay,u=u||!$.overlay,Z+=$.overlay?0:1;return this.options.hideSingleBase&&(u=u&&Z>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=b&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var b=this._getLayer(A(u.target)),M=b.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;M&&this._map.fire(M,b)},_createRadioElement:function(u,b){var M='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(b?' checked="checked"':"")+"/>",$=document.createElement("div");return $.innerHTML=M,$.firstChild},_addItem:function(u){var b=document.createElement("label"),M=this._map.hasLayer(u.layer),$;u.overlay?($=document.createElement("input"),$.type="checkbox",$.className="leaflet-control-layers-selector",$.defaultChecked=M):$=this._createRadioElement("leaflet-base-layers_"+A(this),M),this._layerControlInputs.push($),$.layerId=A(u.layer),Di($,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+u.name;var le=document.createElement("span");b.appendChild(le),le.appendChild($),le.appendChild(Z);var Ce=u.overlay?this._overlaysList:this._baseLayersList;return Ce.appendChild(b),this._checkDisabledLayers(),b},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,b,M,$=[],Z=[];this._handlingClick=!0;for(var le=u.length-1;le>=0;le--)b=u[le],M=this._getLayer(b.layerId).layer,b.checked?$.push(M):b.checked||Z.push(M);for(le=0;le<Z.length;le++)this._map.hasLayer(Z[le])&&this._map.removeLayer(Z[le]);for(le=0;le<$.length;le++)this._map.hasLayer($[le])||this._map.addLayer($[le]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,b,M,$=this._map.getZoom(),Z=u.length-1;Z>=0;Z--)b=u[Z],M=this._getLayer(b.layerId).layer,b.disabled=M.options.minZoom!==void 0&&$<M.options.minZoom||M.options.maxZoom!==void 0&&$>M.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,Di(u,"click",xs),this.expand();var b=this;setTimeout(function(){jn(u,"click",xs),b._preventClick=!1})}}),Jo=function(u,b,M){return new ec(u,b,M)},yu=Zi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var b="leaflet-control-zoom",M=Pi("div",b+" leaflet-bar"),$=this.options;return this._zoomInButton=this._createButton($.zoomInText,$.zoomInTitle,b+"-in",M,this._zoomIn),this._zoomOutButton=this._createButton($.zoomOutText,$.zoomOutTitle,b+"-out",M,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),M},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,b,M,$,Z){var le=Pi("a",M,$);return le.innerHTML=u,le.href="#",le.title=b,le.setAttribute("role","button"),le.setAttribute("aria-label",b),Xo(le),Di(le,"click",sa),Di(le,"click",Z,this),Di(le,"click",this._refocusOnMap,this),le},_updateDisabled:function(){var u=this._map,b="leaflet-disabled";In(this._zoomInButton,b),In(this._zoomOutButton,b),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&(Hi(this._zoomOutButton,b),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&(Hi(this._zoomInButton,b),this._zoomInButton.setAttribute("aria-disabled","true"))}});tn.mergeOptions({zoomControl:!0}),tn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new yu,this.addControl(this.zoomControl))});var Qu=function(u){return new yu(u)},eh=Zi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var b="leaflet-control-scale",M=Pi("div",b),$=this.options;return this._addScales($,b+"-line",M),u.on($.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),M},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,b,M){u.metric&&(this._mScale=Pi("div",b,M)),u.imperial&&(this._iScale=Pi("div",b,M))},_update:function(){var u=this._map,b=u.getSize().y/2,M=u.distance(u.containerPointToLatLng([0,b]),u.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(M)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var b=this._getRoundNum(u),M=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,M,b/u)},_updateImperial:function(u){var b=u*3.2808399,M,$,Z;b>5280?(M=b/5280,$=this._getRoundNum(M),this._updateScale(this._iScale,$+" mi",$/M)):(Z=this._getRoundNum(b),this._updateScale(this._iScale,Z+" ft",Z/b))},_updateScale:function(u,b,M){u.style.width=Math.round(this.options.maxWidth*M)+"px",u.innerHTML=b},_getRoundNum:function(u){var b=Math.pow(10,(Math.floor(u)+"").length-1),M=u/b;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:1,b*M}}),Dc=function(u){return new eh(u)},_u='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Oc=Zi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(nt.inlineSvg?_u+" ":"")+"Leaflet</a>"},initialize:function(u){ne(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=Pi("div","leaflet-control-attribution"),Xo(this._container);for(var b in u._layers)u._layers[b].getAttribution&&this.addAttribution(u._layers[b].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var b in this._attributions)this._attributions[b]&&u.push(b);var M=[];this.options.prefix&&M.push(this.options.prefix),u.length&&M.push(u.join(", ")),this._container.innerHTML=M.join(' <span aria-hidden="true">|</span> ')}}});tn.mergeOptions({attributionControl:!0}),tn.addInitHook(function(){this.options.attributionControl&&new Oc().addTo(this)});var th=function(u){return new Oc(u)};Zi.Layers=ec,Zi.Zoom=yu,Zi.Scale=eh,Zi.Attribution=Oc,ra.layers=Jo,ra.zoom=Qu,ra.scale=Dc,ra.attribution=th;var ba=gt.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ba.addTo=function(u,b){return u.addHandler(b,this),this};var ih={Events:Be},oo=nt.touch?"touchstart mousedown":"mousedown",lo=ot.extend({options:{clickTolerance:3},initialize:function(u,b,M,$){ne(this,$),this._element=u,this._dragStartTarget=b||u,this._preventOutline=M},enable:function(){this._enabled||(Di(this._dragStartTarget,oo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(lo._dragging===this&&this.finishDrag(!0),jn(this._dragStartTarget,oo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!Br(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){lo._dragging===this&&this.finishDrag();return}if(!(lo._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(lo._dragging=this,this._preventOutline&&Ll(this._element),ao(),Co(),!this._moving)){this.fire("down");var b=u.touches?u.touches[0]:u,M=Ao(this._element);this._startPoint=new Fe(b.clientX,b.clientY),this._startPos=$r(this._element),this._parentScale=Us(M);var $=u.type==="mousedown";Di(document,$?"mousemove":"touchmove",this._onMove,this),Di(document,$?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var b=u.touches&&u.touches.length===1?u.touches[0]:u,M=new Fe(b.clientX,b.clientY)._subtract(this._startPoint);!M.x&&!M.y||Math.abs(M.x)+Math.abs(M.y)<this.options.clickTolerance||(M.x/=this._parentScale.x,M.y/=this._parentScale.y,xs(u),this._moved||(this.fire("dragstart"),this._moved=!0,Hi(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Hi(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(M),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),Gn(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){In(document.body,"leaflet-dragging"),this._lastTarget&&(In(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),jn(document,"mousemove touchmove",this._onMove,this),jn(document,"mouseup touchend touchcancel",this._onUp,this),jl(),Ur();var b=this._moved&&this._moving;this._moving=!1,lo._dragging=!1,b&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function nh(u,b,M){var $,Z=[1,4,2,8],le,Ce,We,ht,wt,Yt,Si,ln;for(le=0,Yt=u.length;le<Yt;le++)u[le]._code=_r(u[le],b);for(We=0;We<4;We++){for(Si=Z[We],$=[],le=0,Yt=u.length,Ce=Yt-1;le<Yt;Ce=le++)ht=u[le],wt=u[Ce],ht._code&Si?wt._code&Si||(ln=el(wt,ht,Si,b,M),ln._code=_r(ln,b),$.push(ln)):(wt._code&Si&&(ln=el(wt,ht,Si,b,M),ln._code=_r(ln,b),$.push(ln)),$.push(ht));u=$}return u}function vu(u,b){var M,$,Z,le,Ce,We,ht,wt,Yt;if(!u||u.length===0)throw new Error("latlngs not passed");Pr(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Si=Ct([0,0]),ln=at(u),qs=ln.getNorthWest().distanceTo(ln.getSouthWest())*ln.getNorthEast().distanceTo(ln.getNorthWest());qs<1700&&(Si=Qo(u));var bs=u.length,wr=[];for(M=0;M<bs;M++){var bn=Ct(u[M]);wr.push(b.project(Ct([bn.lat-Si.lat,bn.lng-Si.lng])))}for(We=ht=wt=0,M=0,$=bs-1;M<bs;$=M++)Z=wr[M],le=wr[$],Ce=Z.y*le.x-le.y*Z.x,ht+=(Z.x+le.x)*Ce,wt+=(Z.y+le.y)*Ce,We+=Ce*3;We===0?Yt=wr[0]:Yt=[ht/We,wt/We];var Qi=b.unproject(rt(Yt));return Ct([Qi.lat+Si.lat,Qi.lng+Si.lng])}function Qo(u){for(var b=0,M=0,$=0,Z=0;Z<u.length;Z++){var le=Ct(u[Z]);b+=le.lat,M+=le.lng,$++}return Ct([b/$,M/$])}var xu={__proto__:null,clipPolygon:nh,polygonCenter:vu,centroid:Qo};function tc(u,b){if(!b||!u.length)return u.slice();var M=b*b;return u=rh(u,M),u=bu(u,M),u}function sh(u,b,M){return Math.sqrt(tl(u,b,M,!0))}function Jh(u,b,M){return tl(u,b,M)}function bu(u,b){var M=u.length,$=typeof Uint8Array<"u"?Uint8Array:Array,Z=new $(M);Z[0]=Z[M-1]=1,Nc(u,Z,b,0,M-1);var le,Ce=[];for(le=0;le<M;le++)Z[le]&&Ce.push(u[le]);return Ce}function Nc(u,b,M,$,Z){var le=0,Ce,We,ht;for(We=$+1;We<=Z-1;We++)ht=tl(u[We],u[$],u[Z],!0),ht>le&&(Ce=We,le=ht);le>M&&(b[Ce]=1,Nc(u,b,M,$,Ce),Nc(u,b,M,Ce,Z))}function rh(u,b){for(var M=[u[0]],$=1,Z=0,le=u.length;$<le;$++)Su(u[$],u[Z])>b&&(M.push(u[$]),Z=$);return Z<le-1&&M.push(u[le-1]),M}var Bc;function wu(u,b,M,$,Z){var le=$?Bc:_r(u,M),Ce=_r(b,M),We,ht,wt;for(Bc=Ce;;){if(!(le|Ce))return[u,b];if(le&Ce)return!1;We=le||Ce,ht=el(u,b,We,M,Z),wt=_r(ht,M),We===le?(u=ht,le=wt):(b=ht,Ce=wt)}}function el(u,b,M,$,Z){var le=b.x-u.x,Ce=b.y-u.y,We=$.min,ht=$.max,wt,Yt;return M&8?(wt=u.x+le*(ht.y-u.y)/Ce,Yt=ht.y):M&4?(wt=u.x+le*(We.y-u.y)/Ce,Yt=We.y):M&2?(wt=ht.x,Yt=u.y+Ce*(ht.x-u.x)/le):M&1&&(wt=We.x,Yt=u.y+Ce*(We.x-u.x)/le),new Fe(wt,Yt,Z)}function _r(u,b){var M=0;return u.x<b.min.x?M|=1:u.x>b.max.x&&(M|=2),u.y<b.min.y?M|=4:u.y>b.max.y&&(M|=8),M}function Su(u,b){var M=b.x-u.x,$=b.y-u.y;return M*M+$*$}function tl(u,b,M,$){var Z=b.x,le=b.y,Ce=M.x-Z,We=M.y-le,ht=Ce*Ce+We*We,wt;return ht>0&&(wt=((u.x-Z)*Ce+(u.y-le)*We)/ht,wt>1?(Z=M.x,le=M.y):wt>0&&(Z+=Ce*wt,le+=We*wt)),Ce=u.x-Z,We=u.y-le,$?Ce*Ce+We*We:new Fe(Z,le)}function Pr(u){return!ae(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function il(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Pr(u)}function Io(u,b){var M,$,Z,le,Ce,We,ht,wt;if(!u||u.length===0)throw new Error("latlngs not passed");Pr(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Yt=Ct([0,0]),Si=at(u),ln=Si.getNorthWest().distanceTo(Si.getSouthWest())*Si.getNorthEast().distanceTo(Si.getNorthWest());ln<1700&&(Yt=Qo(u));var qs=u.length,bs=[];for(M=0;M<qs;M++){var wr=Ct(u[M]);bs.push(b.project(Ct([wr.lat-Yt.lat,wr.lng-Yt.lng])))}for(M=0,$=0;M<qs-1;M++)$+=bs[M].distanceTo(bs[M+1])/2;if($===0)wt=bs[0];else for(M=0,le=0;M<qs-1;M++)if(Ce=bs[M],We=bs[M+1],Z=Ce.distanceTo(We),le+=Z,le>$){ht=(le-$)/Z,wt=[We.x-ht*(We.x-Ce.x),We.y-ht*(We.y-Ce.y)];break}var bn=b.unproject(rt(wt));return Ct([bn.lat+Yt.lat,bn.lng+Yt.lng])}var nl={__proto__:null,simplify:tc,pointToSegmentDistance:sh,closestPointOnSegment:Jh,clipSegment:wu,_getEdgeIntersection:el,_getBitCode:_r,_sqClosestPointOnSegment:tl,isFlat:Pr,_flat:il,polylineCenter:Io},Rl={project:function(u){return new Fe(u.lng,u.lat)},unproject:function(u){return new mt(u.y,u.x)},bounds:new be([-180,-90],[180,90])},$c={R:6378137,R_MINOR:6356752314245179e-9,bounds:new be([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var b=Math.PI/180,M=this.R,$=u.lat*b,Z=this.R_MINOR/M,le=Math.sqrt(1-Z*Z),Ce=le*Math.sin($),We=Math.tan(Math.PI/4-$/2)/Math.pow((1-Ce)/(1+Ce),le/2);return $=-M*Math.log(Math.max(We,1e-10)),new Fe(u.lng*b*M,$)},unproject:function(u){for(var b=180/Math.PI,M=this.R,$=this.R_MINOR/M,Z=Math.sqrt(1-$*$),le=Math.exp(-u.y/M),Ce=Math.PI/2-2*Math.atan(le),We=0,ht=.1,wt;We<15&&Math.abs(ht)>1e-7;We++)wt=Z*Math.sin(Ce),wt=Math.pow((1-wt)/(1+wt),Z/2),ht=Math.PI/2-2*Math.atan(le*wt)-Ce,Ce+=ht;return new mt(Ce*b,u.x*b/M)}},ps={__proto__:null,LonLat:Rl,Mercator:$c,SphericalMercator:Vi},ah=f({},Kt,{code:"EPSG:3395",projection:$c,transformation:(function(){var u=.5/(Math.PI*$c.R);return Oi(u,.5,-u,.5)})()}),Yi=f({},Kt,{code:"EPSG:4326",projection:Rl,transformation:Oi(1/180,1,-1/180,.5)}),co=f({},Ot,{projection:Rl,transformation:Oi(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,b){var M=b.lng-u.lng,$=b.lat-u.lat;return Math.sqrt(M*M+$*$)},infinite:!0});Ot.Earth=Kt,Ot.EPSG3395=ah,Ot.EPSG3857=xn,Ot.EPSG900913=cn,Ot.EPSG4326=Yi,Ot.Simple=co;var mn=ot.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[A(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[A(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var b=u.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var M=this.getEvents();b.on(M,this),this.once("remove",function(){b.off(M,this)},this)}this.onAdd(b),this.fire("add"),b.fire("layeradd",{layer:this})}}});tn.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var b=A(u);return this._layers[b]?this:(this._layers[b]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var b=A(u);return this._layers[b]?(this._loaded&&u.onRemove(this),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return A(u)in this._layers},eachLayer:function(u,b){for(var M in this._layers)u.call(b,this._layers[M]);return this},_addLayers:function(u){u=u?ae(u)?u:[u]:[];for(var b=0,M=u.length;b<M;b++)this.addLayer(u[b])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[A(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var b=A(u);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,b=-1/0,M=this._getZoomSpan();for(var $ in this._zoomBoundLayers){var Z=this._zoomBoundLayers[$].options;u=Z.minZoom===void 0?u:Math.min(u,Z.minZoom),b=Z.maxZoom===void 0?b:Math.max(b,Z.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=u===1/0?void 0:u,M!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Tn=mn.extend({initialize:function(u,b){ne(this,b),this._layers={};var M,$;if(u)for(M=0,$=u.length;M<$;M++)this.addLayer(u[M])},addLayer:function(u){var b=this.getLayerId(u);return this._layers[b]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var b=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(u){var b=typeof u=="number"?u:this.getLayerId(u);return b in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var b=Array.prototype.slice.call(arguments,1),M,$;for(M in this._layers)$=this._layers[M],$[u]&&$[u].apply($,b);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,b){for(var M in this._layers)u.call(b,this._layers[M]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return A(u)}}),sl=function(u,b){return new Tn(u,b)},Ir=Tn.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),Tn.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),Tn.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new et;for(var b in this._layers){var M=this._layers[b];u.extend(M.getBounds?M.getBounds():M.getLatLng())}return u}}),Dl=function(u,b){return new Ir(u,b)},aa=gt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){ne(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,b){var M=this._getIconUrl(u);if(!M){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var $=this._createImg(M,b&&b.tagName==="IMG"?b:null);return this._setIconStyles($,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&($.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),$},_setIconStyles:function(u,b){var M=this.options,$=M[b+"Size"];typeof $=="number"&&($=[$,$]);var Z=rt($),le=rt(b==="shadow"&&M.shadowAnchor||M.iconAnchor||Z&&Z.divideBy(2,!0));u.className="leaflet-marker-"+b+" "+(M.className||""),le&&(u.style.marginLeft=-le.x+"px",u.style.marginTop=-le.y+"px"),Z&&(u.style.width=Z.x+"px",u.style.height=Z.y+"px")},_createImg:function(u,b){return b=b||document.createElement("img"),b.src=u,b},_getIconUrl:function(u){return nt.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function wa(u){return new aa(u)}var Ba=aa.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof Ba.imagePath!="string"&&(Ba.imagePath=this._detectIconPath()),(this.options.imagePath||Ba.imagePath)+aa.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var b=function(M,$,Z){var le=$.exec(M);return le&&le[Z]};return u=b(u,/^url\((['"])?(.+)\1\)$/,2),u&&b(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=Pi("div","leaflet-default-icon-path",document.body),b=_a(u,"background-image")||_a(u,"backgroundImage");if(document.body.removeChild(u),b=this._stripUrl(b),b)return b;var M=document.querySelector('link[href$="leaflet.css"]');return M?M.href.substring(0,M.href.length-11-1):""}}),nr=ba.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new lo(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Hi(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&In(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var b=this._marker,M=b._map,$=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,le=$r(b._icon),Ce=M.getPixelBounds(),We=M.getPixelOrigin(),ht=Ie(Ce.min._subtract(We).add(Z),Ce.max._subtract(We).subtract(Z));if(!ht.contains(le)){var wt=rt((Math.max(ht.max.x,le.x)-ht.max.x)/(Ce.max.x-ht.max.x)-(Math.min(ht.min.x,le.x)-ht.min.x)/(Ce.min.x-ht.min.x),(Math.max(ht.max.y,le.y)-ht.max.y)/(Ce.max.y-ht.max.y)-(Math.min(ht.min.y,le.y)-ht.min.y)/(Ce.min.y-ht.min.y)).multiplyBy($);M.panBy(wt,{animate:!1}),this._draggable._newPos._add(wt),this._draggable._startPos._add(wt),Gn(b._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=lt(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(Ke(this._panRequest),this._panRequest=lt(this._adjustPan.bind(this,u)))},_onDrag:function(u){var b=this._marker,M=b._shadow,$=$r(b._icon),Z=b._map.layerPointToLatLng($);M&&Gn(M,$),b._latlng=Z,u.latlng=Z,u.oldLatLng=this._oldLatLng,b.fire("move",u).fire("drag",u)},_onDragEnd:function(u){Ke(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),rl=mn.extend({options:{icon:new Ba,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,b){ne(this,b),this._latlng=Ct(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var b=this._latlng;return this._latlng=Ct(u),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),M=u.icon.createIcon(this._icon),$=!1;M!==this._icon&&(this._icon&&this._removeIcon(),$=!0,u.title&&(M.title=u.title),M.tagName==="IMG"&&(M.alt=u.alt||"")),Hi(M,b),u.keyboard&&(M.tabIndex="0",M.setAttribute("role","button")),this._icon=M,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Di(M,"focus",this._panOnFocus,this);var Z=u.icon.createShadow(this._shadow),le=!1;Z!==this._shadow&&(this._removeShadow(),le=!0),Z&&(Hi(Z,b),Z.alt=""),this._shadow=Z,u.opacity<1&&this._updateOpacity(),$&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&le&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&jn(this._icon,"focus",this._panOnFocus,this),zn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&zn(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&Gn(this._icon,u),this._shadow&&Gn(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(Hi(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),nr)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new nr(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&Bn(this._icon,u),this._shadow&&Bn(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var b=this.options.icon.options,M=b.iconSize?rt(b.iconSize):rt(0,0),$=b.iconAnchor?rt(b.iconAnchor):rt(0,0);u.panInside(this._latlng,{paddingTopLeft:$,paddingBottomRight:M.subtract($)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Uc(u,b){return new rl(u,b)}var oa=mn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return ne(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),la=oa.extend({options:{fill:!0,radius:10},initialize:function(u,b){ne(this,b),this._latlng=Ct(u),this._radius=this.options.radius},setLatLng:function(u){var b=this._latlng;return this._latlng=Ct(u),this.redraw(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var b=u&&u.radius||this._radius;return oa.prototype.setStyle.call(this,u),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,b=this._radiusY||u,M=this._clickTolerance(),$=[u+M,b+M];this._pxBounds=new be(this._point.subtract($),this._point.add($))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ol(u,b){return new la(u,b)}var jo=la.extend({initialize:function(u,b,M){if(typeof b=="number"&&(b=f({},M,{radius:b})),ne(this,b),this._latlng=Ct(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new et(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:oa.prototype.setStyle,_project:function(){var u=this._latlng.lng,b=this._latlng.lat,M=this._map,$=M.options.crs;if($.distance===Kt.distance){var Z=Math.PI/180,le=this._mRadius/Kt.R/Z,Ce=M.project([b+le,u]),We=M.project([b-le,u]),ht=Ce.add(We).divideBy(2),wt=M.unproject(ht).lat,Yt=Math.acos((Math.cos(le*Z)-Math.sin(b*Z)*Math.sin(wt*Z))/(Math.cos(b*Z)*Math.cos(wt*Z)))/Z;(isNaN(Yt)||Yt===0)&&(Yt=le/Math.cos(Math.PI/180*b)),this._point=ht.subtract(M.getPixelOrigin()),this._radius=isNaN(Yt)?0:ht.x-M.project([wt,u-Yt]).x,this._radiusY=ht.y-Ce.y}else{var Si=$.unproject($.project(this._latlng).subtract([this._mRadius,0]));this._point=M.latLngToLayerPoint(this._latlng),this._radius=this._point.x-M.latLngToLayerPoint(Si).x}this._updateBounds()}});function al(u,b,M){return new jo(u,b,M)}var Fr=oa.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,b){ne(this,b),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var b=1/0,M=null,$=tl,Z,le,Ce=0,We=this._parts.length;Ce<We;Ce++)for(var ht=this._parts[Ce],wt=1,Yt=ht.length;wt<Yt;wt++){Z=ht[wt-1],le=ht[wt];var Si=$(u,Z,le,!0);Si<b&&(b=Si,M=$(u,Z,le))}return M&&(M.distance=Math.sqrt(b)),M},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Io(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,b){return b=b||this._defaultShape(),u=Ct(u),b.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new et,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return Pr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var b=[],M=Pr(u),$=0,Z=u.length;$<Z;$++)M?(b[$]=Ct(u[$]),this._bounds.extend(b[$])):b[$]=this._convertLatLngs(u[$]);return b},_project:function(){var u=new be;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),b=new Fe(u,u);this._rawPxBounds&&(this._pxBounds=new be([this._rawPxBounds.min.subtract(b),this._rawPxBounds.max.add(b)]))},_projectLatlngs:function(u,b,M){var $=u[0]instanceof mt,Z=u.length,le,Ce;if($){for(Ce=[],le=0;le<Z;le++)Ce[le]=this._map.latLngToLayerPoint(u[le]),M.extend(Ce[le]);b.push(Ce)}else for(le=0;le<Z;le++)this._projectLatlngs(u[le],b,M)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var b=this._parts,M,$,Z,le,Ce,We,ht;for(M=0,Z=0,le=this._rings.length;M<le;M++)for(ht=this._rings[M],$=0,Ce=ht.length;$<Ce-1;$++)We=wu(ht[$],ht[$+1],u,$,!0),We&&(b[Z]=b[Z]||[],b[Z].push(We[0]),(We[1]!==ht[$+1]||$===Ce-2)&&(b[Z].push(We[1]),Z++))}},_simplifyPoints:function(){for(var u=this._parts,b=this.options.smoothFactor,M=0,$=u.length;M<$;M++)u[M]=tc(u[M],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,b){var M,$,Z,le,Ce,We,ht=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(M=0,le=this._parts.length;M<le;M++)for(We=this._parts[M],$=0,Ce=We.length,Z=Ce-1;$<Ce;Z=$++)if(!(!b&&$===0)&&sh(u,We[Z],We[$])<=ht)return!0;return!1}});function Fc(u,b){return new Fr(u,b)}Fr._flat=il;var Sa=Fr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var b=Fr.prototype._convertLatLngs.call(this,u),M=b.length;return M>=2&&b[0]instanceof mt&&b[0].equals(b[M-1])&&b.pop(),b},_setLatLngs:function(u){Fr.prototype._setLatLngs.call(this,u),Pr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Pr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,b=this.options.weight,M=new Fe(b,b);if(u=new be(u.min.subtract(M),u.max.add(M)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var $=0,Z=this._rings.length,le;$<Z;$++)le=nh(this._rings[$],u,!0),le.length&&this._parts.push(le)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var b=!1,M,$,Z,le,Ce,We,ht,wt;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(le=0,ht=this._parts.length;le<ht;le++)for(M=this._parts[le],Ce=0,wt=M.length,We=wt-1;Ce<wt;We=Ce++)$=M[Ce],Z=M[We],$.y>u.y!=Z.y>u.y&&u.x<(Z.x-$.x)*(u.y-$.y)/(Z.y-$.y)+$.x&&(b=!b);return b||Fr.prototype._containsPoint.call(this,u,!0)}});function Nl(u,b){return new Sa(u,b)}var $a=Ir.extend({initialize:function(u,b){ne(this,b),this._layers={},u&&this.addData(u)},addData:function(u){var b=ae(u)?u:u.features,M,$,Z;if(b){for(M=0,$=b.length;M<$;M++)Z=b[M],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var le=this.options;if(le.filter&&!le.filter(u))return this;var Ce=Vs(u,le);return Ce?(Ce.feature=ll(u),Ce.defaultOptions=Ce.options,this.resetStyle(Ce),le.onEachFeature&&le.onEachFeature(u,Ce),this.addLayer(Ce)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=f({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(b){this._setLayerStyle(b,u)},this)},_setLayerStyle:function(u,b){u.setStyle&&(typeof b=="function"&&(b=b(u.feature)),u.setStyle(b))}});function Vs(u,b){var M=u.type==="Feature"?u.geometry:u,$=M?M.coordinates:null,Z=[],le=b&&b.pointToLayer,Ce=b&&b.coordsToLatLng||ol,We,ht,wt,Yt;if(!$&&!M)return null;switch(M.type){case"Point":return We=Ce($),on(le,u,We,b);case"MultiPoint":for(wt=0,Yt=$.length;wt<Yt;wt++)We=Ce($[wt]),Z.push(on(le,u,We,b));return new Ir(Z);case"LineString":case"MultiLineString":return ht=ic($,M.type==="LineString"?0:1,Ce),new Fr(ht,b);case"Polygon":case"MultiPolygon":return ht=ic($,M.type==="Polygon"?1:2,Ce),new Sa(ht,b);case"GeometryCollection":for(wt=0,Yt=M.geometries.length;wt<Yt;wt++){var Si=Vs({geometry:M.geometries[wt],type:"Feature",properties:u.properties},b);Si&&Z.push(Si)}return new Ir(Z);case"FeatureCollection":for(wt=0,Yt=M.features.length;wt<Yt;wt++){var ln=Vs(M.features[wt],b);ln&&Z.push(ln)}return new Ir(Z);default:throw new Error("Invalid GeoJSON object.")}}function on(u,b,M,$){return u?u(b,M):new rl(M,$&&$.markersInheritOptions&&$)}function ol(u){return new mt(u[1],u[0],u[2])}function ic(u,b,M){for(var $=[],Z=0,le=u.length,Ce;Z<le;Z++)Ce=b?ic(u[Z],b-1,M):(M||ol)(u[Z]),$.push(Ce);return $}function nc(u,b){return u=Ct(u),u.alt!==void 0?[V(u.lng,b),V(u.lat,b),V(u.alt,b)]:[V(u.lng,b),V(u.lat,b)]}function Ua(u,b,M,$){for(var Z=[],le=0,Ce=u.length;le<Ce;le++)Z.push(b?Ua(u[le],Pr(u[le])?0:b-1,M,$):nc(u[le],$));return!b&&M&&Z.length>0&&Z.push(Z[0].slice()),Z}function uo(u,b){return u.feature?f({},u.feature,{geometry:b}):ll(b)}function ll(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var ho={toGeoJSON:function(u){return uo(this,{type:"Point",coordinates:nc(this.getLatLng(),u)})}};rl.include(ho),jo.include(ho),la.include(ho),Fr.include({toGeoJSON:function(u){var b=!Pr(this._latlngs),M=Ua(this._latlngs,b?1:0,!1,u);return uo(this,{type:(b?"Multi":"")+"LineString",coordinates:M})}}),Sa.include({toGeoJSON:function(u){var b=!Pr(this._latlngs),M=b&&!Pr(this._latlngs[0]),$=Ua(this._latlngs,M?2:b?1:0,!0,u);return b||($=[$]),uo(this,{type:(M?"Multi":"")+"Polygon",coordinates:$})}}),Tn.include({toMultiPoint:function(u){var b=[];return this.eachLayer(function(M){b.push(M.toGeoJSON(u).geometry.coordinates)}),uo(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(u){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(b==="MultiPoint")return this.toMultiPoint(u);var M=b==="GeometryCollection",$=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var le=Z.toGeoJSON(u);if(M)$.push(le.geometry);else{var Ce=ll(le);Ce.type==="FeatureCollection"?$.push.apply($,Ce.features):$.push(Ce)}}}),M?uo(this,{geometries:$,type:"GeometryCollection"}):{type:"FeatureCollection",features:$}}});function sc(u,b){return new $a(u,b)}var Lo=sc,fo=mn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,b,M){this._url=u,this._bounds=at(b),ne(this,M)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Hi(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){zn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&fn(this._image),this},bringToBack:function(){return this._map&&Ra(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=at(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",b=this._image=u?this._url:Pi("img");if(Hi(b,"leaflet-image-layer"),this._zoomAnimated&&Hi(b,"leaflet-zoom-animated"),this.options.className&&Hi(b,this.options.className),b.onselectstart=N,b.onmousemove=N,b.onload=y(this.fire,this,"load"),b.onerror=y(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=b.src;return}b.src=this._url,b.alt=this.options.alt},_animateZoom:function(u){var b=this._map.getZoomScale(u.zoom),M=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;va(this._image,M,b)},_reset:function(){var u=this._image,b=new be(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),M=b.getSize();Gn(u,b.min),u.style.width=M.x+"px",u.style.height=M.y+"px"},_updateOpacity:function(){Bn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),cl=function(u,b,M){return new fo(u,b,M)},Vr=fo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",b=this._image=u?this._url:Pi("video");if(Hi(b,"leaflet-image-layer"),this._zoomAnimated&&Hi(b,"leaflet-zoom-animated"),this.options.className&&Hi(b,this.options.className),b.onselectstart=N,b.onmousemove=N,b.onloadeddata=y(this.fire,this,"load"),u){for(var M=b.getElementsByTagName("source"),$=[],Z=0;Z<M.length;Z++)$.push(M[Z].src);this._url=M.length>0?$:[b.src];return}ae(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(b.style,"objectFit")&&(b.style.objectFit="fill"),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,b.muted=!!this.options.muted,b.playsInline=!!this.options.playsInline;for(var le=0;le<this._url.length;le++){var Ce=Pi("source");Ce.src=this._url[le],b.appendChild(Ce)}}});function Ta(u,b,M){return new Vr(u,b,M)}var Bl=fo.extend({_initImage:function(){var u=this._image=this._url;Hi(u,"leaflet-image-layer"),this._zoomAnimated&&Hi(u,"leaflet-zoom-animated"),this.options.className&&Hi(u,this.options.className),u.onselectstart=N,u.onmousemove=N}});function ul(u,b,M){return new Bl(u,b,M)}var Cs=mn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,b){u&&(u instanceof mt||ae(u))?(this._latlng=Ct(u),ne(this,b)):(ne(this,u),this._source=b),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&Bn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&Bn(this._container,1),this.bringToFront(),this.options.interactive&&(Hi(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(Bn(this._container,0),this._removeTimeout=setTimeout(y(zn,void 0,this._container),200)):zn(this._container),this.options.interactive&&(In(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=Ct(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fn(this._container),this},bringToBack:function(){return this._map&&Ra(this._container),this},_prepareOpen:function(u){var b=this._source;if(!b._map)return!1;if(b instanceof Ir){b=null;var M=this._source._layers;for(var $ in M)if(M[$]._map){b=M[$];break}if(!b)return!1;this._source=b}if(!u)if(b.getCenter)u=b.getCenter();else if(b.getLatLng)u=b.getLatLng();else if(b.getBounds)u=b.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,b=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof b=="string")u.innerHTML=b;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),b=rt(this.options.offset),M=this._getAnchor();this._zoomAnimated?Gn(this._container,u.add(M)):b=b.add(u).add(M);var $=this._containerBottom=-b.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=$+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});tn.include({_initOverlay:function(u,b,M,$){var Z=b;return Z instanceof u||(Z=new u($).setContent(b)),M&&Z.setLatLng(M),Z}}),mn.include({_initOverlay:function(u,b,M,$){var Z=M;return Z instanceof u?(ne(Z,$),Z._source=this):(Z=b&&!$?b:new u($,this),Z.setContent(M)),Z}});var zo=Cs.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,Cs.prototype.openOn.call(this,u)},onAdd:function(u){Cs.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof oa||this._source.on("preclick",na))},onRemove:function(u){Cs.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof oa||this._source.off("preclick",na))},getEvents:function(){var u=Cs.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",b=this._container=Pi("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),M=this._wrapper=Pi("div",u+"-content-wrapper",b);if(this._contentNode=Pi("div",u+"-content",M),Xo(b),Oa(this._contentNode),Di(b,"contextmenu",na),this._tipContainer=Pi("div",u+"-tip-container",b),this._tip=Pi("div",u+"-tip",this._tipContainer),this.options.closeButton){var $=this._closeButton=Pi("a",u+"-close-button",b);$.setAttribute("role","button"),$.setAttribute("aria-label","Close popup"),$.href="#close",$.innerHTML='<span aria-hidden="true">&#215;</span>',Di($,"click",function(Z){xs(Z),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,b=u.style;b.width="",b.whiteSpace="nowrap";var M=u.offsetWidth;M=Math.min(M,this.options.maxWidth),M=Math.max(M,this.options.minWidth),b.width=M+1+"px",b.whiteSpace="",b.height="";var $=u.offsetHeight,Z=this.options.maxHeight,le="leaflet-popup-scrolled";Z&&$>Z?(b.height=Z+"px",Hi(u,le)):In(u,le),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),M=this._getAnchor();Gn(this._container,b.add(M))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,b=parseInt(_a(this._container,"marginBottom"),10)||0,M=this._container.offsetHeight+b,$=this._containerWidth,Z=new Fe(this._containerLeft,-M-this._containerBottom);Z._add($r(this._container));var le=u.layerPointToContainerPoint(Z),Ce=rt(this.options.autoPanPadding),We=rt(this.options.autoPanPaddingTopLeft||Ce),ht=rt(this.options.autoPanPaddingBottomRight||Ce),wt=u.getSize(),Yt=0,Si=0;le.x+$+ht.x>wt.x&&(Yt=le.x+$-wt.x+ht.x),le.x-Yt-We.x<0&&(Yt=le.x-We.x),le.y+M+ht.y>wt.y&&(Si=le.y+M-wt.y+ht.y),le.y-Si-We.y<0&&(Si=le.y-We.y),(Yt||Si)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([Yt,Si]))}},_getAnchor:function(){return rt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),rc=function(u,b){return new zo(u,b)};tn.mergeOptions({closePopupOnClick:!0}),tn.include({openPopup:function(u,b,M){return this._initOverlay(zo,u,b,M).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),mn.include({bindPopup:function(u,b){return this._popup=this._initOverlay(zo,this._popup,u,b),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof Ir||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){sa(u);var b=u.layer||u.target;if(this._popup._source===b&&!(b instanceof oa)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=b,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var hl=Cs.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){Cs.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){Cs.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=Cs.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",b=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Pi("div",b),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+A(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var b,M,$=this._map,Z=this._container,le=$.latLngToContainerPoint($.getCenter()),Ce=$.layerPointToContainerPoint(u),We=this.options.direction,ht=Z.offsetWidth,wt=Z.offsetHeight,Yt=rt(this.options.offset),Si=this._getAnchor();We==="top"?(b=ht/2,M=wt):We==="bottom"?(b=ht/2,M=0):We==="center"?(b=ht/2,M=wt/2):We==="right"?(b=0,M=wt/2):We==="left"?(b=ht,M=wt/2):Ce.x<le.x?(We="right",b=0,M=wt/2):(We="left",b=ht+(Yt.x+Si.x)*2,M=wt/2),u=u.subtract(rt(b,M,!0)).add(Yt).add(Si),In(Z,"leaflet-tooltip-right"),In(Z,"leaflet-tooltip-left"),In(Z,"leaflet-tooltip-top"),In(Z,"leaflet-tooltip-bottom"),Hi(Z,"leaflet-tooltip-"+We),Gn(Z,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&Bn(this._container,u)},_animateZoom:function(u){var b=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(b)},_getAnchor:function(){return rt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Qh=function(u,b){return new hl(u,b)};tn.include({openTooltip:function(u,b,M){return this._initOverlay(hl,u,b,M).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),mn.include({bindTooltip:function(u,b){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(hl,this._tooltip,u,b),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var b=u?"off":"on",M={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?M.add=this._openTooltip:(M.mouseover=this._openTooltip,M.mouseout=this.closeTooltip,M.click=this._openTooltip,this._map?this._addFocusListeners():M.add=this._addFocusListeners),this._tooltip.options.sticky&&(M.mousemove=this._moveTooltip),this[b](M),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof Ir||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var b=typeof u.getElement=="function"&&u.getElement();b&&(Di(b,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),Di(b,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var b=typeof u.getElement=="function"&&u.getElement();b&&b.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var b=this;this._map.once("moveend",function(){b._openOnceFlag=!1,b._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var b=u.latlng,M,$;this._tooltip.options.sticky&&u.originalEvent&&(M=this._map.mouseEventToContainerPoint(u.originalEvent),$=this._map.containerPointToLayerPoint(M),b=this._map.layerPointToLatLng($)),this._tooltip.setLatLng(b)}});var Tu=aa.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var b=u&&u.tagName==="DIV"?u:document.createElement("div"),M=this.options;if(M.html instanceof Element?(ys(b),b.appendChild(M.html)):b.innerHTML=M.html!==!1?M.html:"",M.bgPos){var $=rt(M.bgPos);b.style.backgroundPosition=-$.x+"px "+-$.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});function Vc(u){return new Tu(u)}aa.Default=Ba;var Ro=mn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:nt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){ne(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),zn(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ra(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=I(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof Fe?u:new Fe(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var b=this.getPane().children,M=-u(-1/0,1/0),$=0,Z=b.length,le;$<Z;$++)le=b[$].style.zIndex,b[$]!==this._container&&le&&(M=u(M,+le));isFinite(M)&&(this.options.zIndex=M+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!nt.ielt9){Bn(this._container,this.options.opacity);var u=+new Date,b=!1,M=!1;for(var $ in this._tiles){var Z=this._tiles[$];if(!(!Z.current||!Z.loaded)){var le=Math.min(1,(u-Z.loaded)/200);Bn(Z.el,le),le<1?b=!0:(Z.active?M=!0:this._onOpaqueTile(Z),Z.active=!0)}}M&&!this._noPrune&&this._pruneTiles(),b&&(Ke(this._fadeFrame),this._fadeFrame=lt(this._updateOpacity,this))}},_onOpaqueTile:N,_initContainer:function(){this._container||(this._container=Pi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,b=this.options.maxZoom;if(u!==void 0){for(var M in this._levels)M=Number(M),this._levels[M].el.children.length||M===u?(this._levels[M].el.style.zIndex=b-Math.abs(u-M),this._onUpdateLevel(M)):(zn(this._levels[M].el),this._removeTilesAtZoom(M),this._onRemoveLevel(M),delete this._levels[M]);var $=this._levels[u],Z=this._map;return $||($=this._levels[u]={},$.el=Pi("div","leaflet-tile-container leaflet-zoom-animated",this._container),$.el.style.zIndex=b,$.origin=Z.project(Z.unproject(Z.getPixelOrigin()),u).round(),$.zoom=u,this._setZoomTransform($,Z.getCenter(),Z.getZoom()),N($.el.offsetWidth),this._onCreateLevel($)),this._level=$,$}},_onUpdateLevel:N,_onRemoveLevel:N,_onCreateLevel:N,_pruneTiles:function(){if(this._map){var u,b,M=this._map.getZoom();if(M>this.options.maxZoom||M<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)b=this._tiles[u],b.retain=b.current;for(u in this._tiles)if(b=this._tiles[u],b.current&&!b.active){var $=b.coords;this._retainParent($.x,$.y,$.z,$.z-5)||this._retainChildren($.x,$.y,$.z,$.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var b in this._tiles)this._tiles[b].coords.z===u&&this._removeTile(b)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)zn(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,b,M,$){var Z=Math.floor(u/2),le=Math.floor(b/2),Ce=M-1,We=new Fe(+Z,+le);We.z=+Ce;var ht=this._tileCoordsToKey(We),wt=this._tiles[ht];return wt&&wt.active?(wt.retain=!0,!0):(wt&&wt.loaded&&(wt.retain=!0),Ce>$?this._retainParent(Z,le,Ce,$):!1)},_retainChildren:function(u,b,M,$){for(var Z=2*u;Z<2*u+2;Z++)for(var le=2*b;le<2*b+2;le++){var Ce=new Fe(Z,le);Ce.z=M+1;var We=this._tileCoordsToKey(Ce),ht=this._tiles[We];if(ht&&ht.active){ht.retain=!0;continue}else ht&&ht.loaded&&(ht.retain=!0);M+1<$&&this._retainChildren(Z,le,M+1,$)}},_resetView:function(u){var b=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var b=this.options;return b.minNativeZoom!==void 0&&u<b.minNativeZoom?b.minNativeZoom:b.maxNativeZoom!==void 0&&b.maxNativeZoom<u?b.maxNativeZoom:u},_setView:function(u,b,M,$){var Z=Math.round(b);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var le=this.options.updateWhenZooming&&Z!==this._tileZoom;(!$||le)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(u),M||this._pruneTiles(),this._noPrune=!!M),this._setZoomTransforms(u,b)},_setZoomTransforms:function(u,b){for(var M in this._levels)this._setZoomTransform(this._levels[M],u,b)},_setZoomTransform:function(u,b,M){var $=this._map.getZoomScale(M,u.zoom),Z=u.origin.multiplyBy($).subtract(this._map._getNewPixelOrigin(b,M)).round();nt.any3d?va(u.el,Z,$):Gn(u.el,Z)},_resetGrid:function(){var u=this._map,b=u.options.crs,M=this._tileSize=this.getTileSize(),$=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,b.wrapLng[0]],$).x/M.x),Math.ceil(u.project([0,b.wrapLng[1]],$).x/M.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([b.wrapLat[0],0],$).y/M.x),Math.ceil(u.project([b.wrapLat[1],0],$).y/M.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var b=this._map,M=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),$=b.getZoomScale(M,this._tileZoom),Z=b.project(u,this._tileZoom).floor(),le=b.getSize().divideBy($*2);return new be(Z.subtract(le),Z.add(le))},_update:function(u){var b=this._map;if(b){var M=this._clampZoom(b.getZoom());if(u===void 0&&(u=b.getCenter()),this._tileZoom!==void 0){var $=this._getTiledPixelBounds(u),Z=this._pxBoundsToTileRange($),le=Z.getCenter(),Ce=[],We=this.options.keepBuffer,ht=new be(Z.getBottomLeft().subtract([We,-We]),Z.getTopRight().add([We,-We]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var wt in this._tiles){var Yt=this._tiles[wt].coords;(Yt.z!==this._tileZoom||!ht.contains(new Fe(Yt.x,Yt.y)))&&(this._tiles[wt].current=!1)}if(Math.abs(M-this._tileZoom)>1){this._setView(u,M);return}for(var Si=Z.min.y;Si<=Z.max.y;Si++)for(var ln=Z.min.x;ln<=Z.max.x;ln++){var qs=new Fe(ln,Si);if(qs.z=this._tileZoom,!!this._isValidTile(qs)){var bs=this._tiles[this._tileCoordsToKey(qs)];bs?bs.current=!0:Ce.push(qs)}}if(Ce.sort(function(bn,Qi){return bn.distanceTo(le)-Qi.distanceTo(le)}),Ce.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var wr=document.createDocumentFragment();for(ln=0;ln<Ce.length;ln++)this._addTile(Ce[ln],wr);this._level.el.appendChild(wr)}}}},_isValidTile:function(u){var b=this._map.options.crs;if(!b.infinite){var M=this._globalTileRange;if(!b.wrapLng&&(u.x<M.min.x||u.x>M.max.x)||!b.wrapLat&&(u.y<M.min.y||u.y>M.max.y))return!1}if(!this.options.bounds)return!0;var $=this._tileCoordsToBounds(u);return at(this.options.bounds).overlaps($)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var b=this._map,M=this.getTileSize(),$=u.scaleBy(M),Z=$.add(M),le=b.unproject($,u.z),Ce=b.unproject(Z,u.z);return[le,Ce]},_tileCoordsToBounds:function(u){var b=this._tileCoordsToNwSe(u),M=new et(b[0],b[1]);return this.options.noWrap||(M=this._map.wrapLatLngBounds(M)),M},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var b=u.split(":"),M=new Fe(+b[0],+b[1]);return M.z=+b[2],M},_removeTile:function(u){var b=this._tiles[u];b&&(zn(b.el),delete this._tiles[u],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){Hi(u,"leaflet-tile");var b=this.getTileSize();u.style.width=b.x+"px",u.style.height=b.y+"px",u.onselectstart=N,u.onmousemove=N,nt.ielt9&&this.options.opacity<1&&Bn(u,this.options.opacity)},_addTile:function(u,b){var M=this._getTilePos(u),$=this._tileCoordsToKey(u),Z=this.createTile(this._wrapCoords(u),y(this._tileReady,this,u));this._initTile(Z),this.createTile.length<2&&lt(y(this._tileReady,this,u,null,Z)),Gn(Z,M),this._tiles[$]={el:Z,coords:u,current:!0},b.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:u})},_tileReady:function(u,b,M){b&&this.fire("tileerror",{error:b,tile:M,coords:u});var $=this._tileCoordsToKey(u);M=this._tiles[$],M&&(M.loaded=+new Date,this._map._fadeAnimated?(Bn(M.el,0),Ke(this._fadeFrame),this._fadeFrame=lt(this._updateOpacity,this)):(M.active=!0,this._pruneTiles()),b||(Hi(M.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:M.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),nt.ielt9||!this._map._fadeAnimated?lt(this._pruneTiles,this):setTimeout(y(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var b=new Fe(this._wrapX?B(u.x,this._wrapX):u.x,this._wrapY?B(u.y,this._wrapY):u.y);return b.z=u.z,b},_pxBoundsToTileRange:function(u){var b=this.getTileSize();return new be(u.min.unscaleBy(b).floor(),u.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function $l(u){return new Ro(u)}var ca=Ro.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,b){this._url=u,b=ne(this,b),b.detectRetina&&nt.retina&&b.maxZoom>0?(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom=Math.min(b.maxZoom,b.minZoom+1)):(b.zoomOffset++,b.maxZoom=Math.max(b.minZoom,b.maxZoom-1)),b.minZoom=Math.max(0,b.minZoom)):b.zoomReverse?b.minZoom=Math.min(b.maxZoom,b.minZoom):b.maxZoom=Math.max(b.minZoom,b.maxZoom),typeof b.subdomains=="string"&&(b.subdomains=b.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,b){return this._url===u&&b===void 0&&(b=!0),this._url=u,b||this.redraw(),this},createTile:function(u,b){var M=document.createElement("img");return Di(M,"load",y(this._tileOnLoad,this,b,M)),Di(M,"error",y(this._tileOnError,this,b,M)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(M.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(M.referrerPolicy=this.options.referrerPolicy),M.alt="",M.src=this.getTileUrl(u),M},getTileUrl:function(u){var b={r:nt.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var M=this._globalTileRange.max.y-u.y;this.options.tms&&(b.y=M),b["-y"]=M}return ge(this._url,f(b,this.options))},_tileOnLoad:function(u,b){nt.ielt9?setTimeout(y(u,this,null,b),0):u(null,b)},_tileOnError:function(u,b,M){var $=this.options.errorTileUrl;$&&b.getAttribute("src")!==$&&(b.src=$),u(M,b)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,b=this.options.maxZoom,M=this.options.zoomReverse,$=this.options.zoomOffset;return M&&(u=b-u),u+$},_getSubdomain:function(u){var b=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var u,b;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(b=this._tiles[u].el,b.onload=N,b.onerror=N,!b.complete)){b.src=ye;var M=this._tiles[u].coords;zn(b),delete this._tiles[u],this.fire("tileabort",{tile:b,coords:M})}},_removeTile:function(u){var b=this._tiles[u];if(b)return b.el.setAttribute("src",ye),Ro.prototype._removeTile.call(this,u)},_tileReady:function(u,b,M){if(!(!this._map||M&&M.getAttribute("src")===ye))return Ro.prototype._tileReady.call(this,u,b,M)}});function Wn(u,b){return new ca(u,b)}var Ea=ca.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,b){this._url=u;var M=f({},this.defaultWmsParams);for(var $ in b)$ in this.options||(M[$]=b[$]);b=ne(this,b);var Z=b.detectRetina&&nt.retina?2:1,le=this.getTileSize();M.width=le.x*Z,M.height=le.y*Z,this.wmsParams=M},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,ca.prototype.onAdd.call(this,u)},getTileUrl:function(u){var b=this._tileCoordsToNwSe(u),M=this._crs,$=Ie(M.project(b[0]),M.project(b[1])),Z=$.min,le=$.max,Ce=(this._wmsVersion>=1.3&&this._crs===Yi?[Z.y,Z.x,le.y,le.x]:[Z.x,Z.y,le.x,le.y]).join(","),We=ca.prototype.getTileUrl.call(this,u);return We+ve(this.wmsParams,We,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ce},setParams:function(u,b){return f(this.wmsParams,u),b||this.redraw(),this}});function qr(u,b){return new Ea(u,b)}ca.WMS=Ea,Wn.wms=qr;var vr=mn.extend({options:{padding:.1},initialize:function(u){ne(this,u),A(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Hi(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,b){var M=this._map.getZoomScale(b,this._zoom),$=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,b),le=$.multiplyBy(-M).add(Z).subtract(this._map._getNewPixelOrigin(u,b));nt.any3d?va(this._container,le,M):Gn(this._container,le)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,b=this._map.getSize(),M=this._map.containerPointToLayerPoint(b.multiplyBy(-u)).round();this._bounds=new be(M,M.add(b.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ss=vr.extend({options:{tolerance:0},getEvents:function(){var u=vr.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){vr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");Di(u,"mousemove",this._onMouseMove,this),Di(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Di(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){Ke(this._redrawRequest),delete this._ctx,zn(this._container),jn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var b in this._layers)u=this._layers[b],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vr.prototype._update.call(this);var u=this._bounds,b=this._container,M=u.getSize(),$=nt.retina?2:1;Gn(b,u.min),b.width=$*M.x,b.height=$*M.y,b.style.width=M.x+"px",b.style.height=M.y+"px",nt.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){vr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[A(u)]=u;var b=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var b=u._order,M=b.next,$=b.prev;M?M.prev=$:this._drawLast=$,$?$.next=M:this._drawFirst=M,delete u._order,delete this._layers[A(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var b=u.options.dashArray.split(/[, ]+/),M=[],$,Z;for(Z=0;Z<b.length;Z++){if($=Number(b[Z]),isNaN($))return;M.push($)}u.options._dashArray=M}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||lt(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var b=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new be,this._redrawBounds.extend(u._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(u._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var b=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,b.x,b.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,b=this._redrawBounds;if(this._ctx.save(),b){var M=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,M.x,M.y),this._ctx.clip()}this._drawing=!0;for(var $=this._drawFirst;$;$=$.next)u=$.layer,(!b||u._pxBounds&&u._pxBounds.intersects(b))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,b){if(this._drawing){var M,$,Z,le,Ce=u._parts,We=Ce.length,ht=this._ctx;if(We){for(ht.beginPath(),M=0;M<We;M++){for($=0,Z=Ce[M].length;$<Z;$++)le=Ce[M][$],ht[$?"lineTo":"moveTo"](le.x,le.y);b&&ht.closePath()}this._fillStroke(ht,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var b=u._point,M=this._ctx,$=Math.max(Math.round(u._radius),1),Z=(Math.max(Math.round(u._radiusY),1)||$)/$;Z!==1&&(M.save(),M.scale(1,Z)),M.beginPath(),M.arc(b.x,b.y/Z,$,0,Math.PI*2,!1),Z!==1&&M.restore(),this._fillStroke(M,u)}},_fillStroke:function(u,b){var M=b.options;M.fill&&(u.globalAlpha=M.fillOpacity,u.fillStyle=M.fillColor||M.color,u.fill(M.fillRule||"evenodd")),M.stroke&&M.weight!==0&&(u.setLineDash&&u.setLineDash(b.options&&b.options._dashArray||[]),u.globalAlpha=M.opacity,u.lineWidth=M.weight,u.strokeStyle=M.color,u.lineCap=M.lineCap,u.lineJoin=M.lineJoin,u.stroke())},_onClick:function(u){for(var b=this._map.mouseEventToLayerPoint(u),M,$,Z=this._drawFirst;Z;Z=Z.next)M=Z.layer,M.options.interactive&&M._containsPoint(b)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(M))&&($=M);this._fireEvent($?[$]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var b=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,b)}},_handleMouseOut:function(u){var b=this._hoveredLayer;b&&(In(this._container,"leaflet-interactive"),this._fireEvent([b],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,b){if(!this._mouseHoverThrottled){for(var M,$,Z=this._drawFirst;Z;Z=Z.next)M=Z.layer,M.options.interactive&&M._containsPoint(b)&&($=M);$!==this._hoveredLayer&&(this._handleMouseOut(u),$&&(Hi(this._container,"leaflet-interactive"),this._fireEvent([$],u,"mouseover"),this._hoveredLayer=$)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(y(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,b,M){this._map._fireDOMEvent(b,M||b.type,u)},_bringToFront:function(u){var b=u._order;if(b){var M=b.next,$=b.prev;if(M)M.prev=$;else return;$?$.next=M:M&&(this._drawFirst=M),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(u)}},_bringToBack:function(u){var b=u._order;if(b){var M=b.next,$=b.prev;if($)$.next=M;else return;M?M.prev=$:$&&(this._drawLast=$),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(u)}}});function xr(u){return nt.canvas?new ss(u):null}var As=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),dl={_initContainer:function(){this._container=Pi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(vr.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var b=u._container=As("shape");Hi(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",u._path=As("path"),b.appendChild(u._path),this._updateStyle(u),this._layers[A(u)]=u},_addPath:function(u){var b=u._container;this._container.appendChild(b),u.options.interactive&&u.addInteractiveTarget(b)},_removePath:function(u){var b=u._container;zn(b),u.removeInteractiveTarget(b),delete this._layers[A(u)]},_updateStyle:function(u){var b=u._stroke,M=u._fill,$=u.options,Z=u._container;Z.stroked=!!$.stroke,Z.filled=!!$.fill,$.stroke?(b||(b=u._stroke=As("stroke")),Z.appendChild(b),b.weight=$.weight+"px",b.color=$.color,b.opacity=$.opacity,$.dashArray?b.dashStyle=ae($.dashArray)?$.dashArray.join(" "):$.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=$.lineCap.replace("butt","flat"),b.joinstyle=$.lineJoin):b&&(Z.removeChild(b),u._stroke=null),$.fill?(M||(M=u._fill=As("fill")),Z.appendChild(M),M.color=$.fillColor||$.color,M.opacity=$.fillOpacity):M&&(Z.removeChild(M),u._fill=null)},_updateCircle:function(u){var b=u._point.round(),M=Math.round(u._radius),$=Math.round(u._radiusY||M);this._setPath(u,u._empty()?"M0 0":"AL "+b.x+","+b.y+" "+M+","+$+" 0,"+65535*360)},_setPath:function(u,b){u._path.v=b},_bringToFront:function(u){fn(u._container)},_bringToBack:function(u){Ra(u._container)}},ua=nt.vml?As:Zn,po=vr.extend({_initContainer:function(){this._container=ua("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ua("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){zn(this._container),jn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vr.prototype._update.call(this);var u=this._bounds,b=u.getSize(),M=this._container;(!this._svgSize||!this._svgSize.equals(b))&&(this._svgSize=b,M.setAttribute("width",b.x),M.setAttribute("height",b.y)),Gn(M,u.min),M.setAttribute("viewBox",[u.min.x,u.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(u){var b=u._path=ua("path");u.options.className&&Hi(b,u.options.className),u.options.interactive&&Hi(b,"leaflet-interactive"),this._updateStyle(u),this._layers[A(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){zn(u._path),u.removeInteractiveTarget(u._path),delete this._layers[A(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var b=u._path,M=u.options;b&&(M.stroke?(b.setAttribute("stroke",M.color),b.setAttribute("stroke-opacity",M.opacity),b.setAttribute("stroke-width",M.weight),b.setAttribute("stroke-linecap",M.lineCap),b.setAttribute("stroke-linejoin",M.lineJoin),M.dashArray?b.setAttribute("stroke-dasharray",M.dashArray):b.removeAttribute("stroke-dasharray"),M.dashOffset?b.setAttribute("stroke-dashoffset",M.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),M.fill?(b.setAttribute("fill",M.fillColor||M.color),b.setAttribute("fill-opacity",M.fillOpacity),b.setAttribute("fill-rule",M.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(u,b){this._setPath(u,tt(u._parts,b))},_updateCircle:function(u){var b=u._point,M=Math.max(Math.round(u._radius),1),$=Math.max(Math.round(u._radiusY),1)||M,Z="a"+M+","+$+" 0 1,0 ",le=u._empty()?"M0 0":"M"+(b.x-M)+","+b.y+Z+M*2+",0 "+Z+-M*2+",0 ";this._setPath(u,le)},_setPath:function(u,b){u._path.setAttribute("d",b)},_bringToFront:function(u){fn(u._path)},_bringToBack:function(u){Ra(u._path)}});nt.vml&&po.include(dl);function Fa(u){return nt.svg||nt.vml?new po(u):null}tn.include({getRenderer:function(u){var b=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var b=this._paneRenderers[u];return b===void 0&&(b=this._createRenderer({pane:u}),this._paneRenderers[u]=b),b},_createRenderer:function(u){return this.options.preferCanvas&&xr(u)||Fa(u)}});var br=Sa.extend({initialize:function(u,b){Sa.prototype.initialize.call(this,this._boundsToLatLngs(u),b)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=at(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function Eu(u,b){return new br(u,b)}po.create=ua,po.pointsToPath=tt,$a.geometryToLayer=Vs,$a.coordsToLatLng=ol,$a.coordsToLatLngs=ic,$a.latLngToCoords=nc,$a.latLngsToCoords=Ua,$a.getFeature=uo,$a.asFeature=ll,tn.mergeOptions({boxZoom:!0});var Ks=ba.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){Di(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){jn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){zn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Co(),ao(),this._startPoint=this._map.mouseEventToContainerPoint(u),Di(document,{contextmenu:sa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=Pi("div","leaflet-zoom-box",this._container),Hi(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var b=new be(this._point,this._startPoint),M=b.getSize();Gn(this._box,b.min),this._box.style.width=M.x+"px",this._box.style.height=M.y+"px"},_finish:function(){this._moved&&(zn(this._box),In(this._container,"leaflet-crosshair")),Ur(),jl(),jn(document,{contextmenu:sa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(y(this._resetState,this),0);var b=new et(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});tn.addInitHook("addHandler","boxZoom",Ks),tn.mergeOptions({doubleClickZoom:!0});var Ul=ba.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var b=this._map,M=b.getZoom(),$=b.options.zoomDelta,Z=u.originalEvent.shiftKey?M-$:M+$;b.options.doubleClickZoom==="center"?b.setZoom(Z):b.setZoomAround(u.containerPoint,Z)}});tn.addInitHook("addHandler","doubleClickZoom",Ul),tn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Hr=ba.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new lo(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}Hi(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){In(this._map._container,"leaflet-grab"),In(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=at(this._map.options.maxBounds);this._offsetLimit=Ie(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var b=this._lastTime=+new Date,M=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(M),this._times.push(b),this._prunePositions(b)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,b){return u-(u-b)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;u.x<b.min.x&&(u.x=this._viscousLimit(u.x,b.min.x)),u.y<b.min.y&&(u.y=this._viscousLimit(u.y,b.min.y)),u.x>b.max.x&&(u.x=this._viscousLimit(u.x,b.max.x)),u.y>b.max.y&&(u.y=this._viscousLimit(u.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,b=Math.round(u/2),M=this._initialWorldOffset,$=this._draggable._newPos.x,Z=($-b+M)%u+b-M,le=($+b+M)%u-b-M,Ce=Math.abs(Z+M)<Math.abs(le+M)?Z:le;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ce},_onDragEnd:function(u){var b=this._map,M=b.options,$=!M.inertia||u.noInertia||this._times.length<2;if(b.fire("dragend",u),$)b.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),le=(this._lastTime-this._times[0])/1e3,Ce=M.easeLinearity,We=Z.multiplyBy(Ce/le),ht=We.distanceTo([0,0]),wt=Math.min(M.inertiaMaxSpeed,ht),Yt=We.multiplyBy(wt/ht),Si=wt/(M.inertiaDeceleration*Ce),ln=Yt.multiplyBy(-Si/2).round();!ln.x&&!ln.y?b.fire("moveend"):(ln=b._limitOffset(ln,b.options.maxBounds),lt(function(){b.panBy(ln,{duration:Si,easeLinearity:Ce,noMoveStart:!0,animate:!0})}))}}});tn.addInitHook("addHandler","dragging",Hr),tn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ac=ba.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),Di(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),jn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,b=document.documentElement,M=u.scrollTop||b.scrollTop,$=u.scrollLeft||b.scrollLeft;this._map._container.focus(),window.scrollTo($,M)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var b=this._panKeys={},M=this.keyCodes,$,Z;for($=0,Z=M.left.length;$<Z;$++)b[M.left[$]]=[-1*u,0];for($=0,Z=M.right.length;$<Z;$++)b[M.right[$]]=[u,0];for($=0,Z=M.down.length;$<Z;$++)b[M.down[$]]=[0,u];for($=0,Z=M.up.length;$<Z;$++)b[M.up[$]]=[0,-1*u]},_setZoomDelta:function(u){var b=this._zoomKeys={},M=this.keyCodes,$,Z;for($=0,Z=M.zoomIn.length;$<Z;$++)b[M.zoomIn[$]]=u;for($=0,Z=M.zoomOut.length;$<Z;$++)b[M.zoomOut[$]]=-u},_addHooks:function(){Di(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){jn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var b=u.keyCode,M=this._map,$;if(b in this._panKeys){if(!M._panAnim||!M._panAnim._inProgress)if($=this._panKeys[b],u.shiftKey&&($=rt($).multiplyBy(3)),M.options.maxBounds&&($=M._limitOffset(rt($),M.options.maxBounds)),M.options.worldCopyJump){var Z=M.wrapLatLng(M.unproject(M.project(M.getCenter()).add($)));M.panTo(Z)}else M.panBy($)}else if(b in this._zoomKeys)M.setZoom(M.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[b]);else if(b===27&&M._popup&&M._popup.options.closeOnEscapeKey)M.closePopup();else return;sa(u)}}});tn.addInitHook("addHandler","keyboard",ac),tn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var fl=ba.extend({addHooks:function(){Di(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){jn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var b=Xs(u),M=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var $=Math.max(M-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(y(this._performZoom,this),$),sa(u)},_performZoom:function(){var u=this._map,b=u.getZoom(),M=this._map.options.zoomSnap||0;u._stop();var $=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs($))))/Math.LN2,le=M?Math.ceil(Z/M)*M:Z,Ce=u._limitZoom(b+(this._delta>0?le:-le))-b;this._delta=0,this._startTime=null,Ce&&(u.options.scrollWheelZoom==="center"?u.setZoom(b+Ce):u.setZoomAround(this._lastMousePos,b+Ce))}});tn.addInitHook("addHandler","scrollWheelZoom",fl);var Zr=600;tn.mergeOptions({tapHold:nt.touchNative&&nt.safari&&nt.mobile,tapTolerance:15});var pl=ba.extend({addHooks:function(){Di(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){jn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var b=u.touches[0];this._startPos=this._newPos=new Fe(b.clientX,b.clientY),this._holdTimeout=setTimeout(y(function(){this._cancel(),this._isTapValid()&&(Di(document,"touchend",xs),Di(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",b))},this),Zr),Di(document,"touchend touchcancel contextmenu",this._cancel,this),Di(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){jn(document,"touchend",xs),jn(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),jn(document,"touchend touchcancel contextmenu",this._cancel,this),jn(document,"touchmove",this._onMove,this)},_onMove:function(u){var b=u.touches[0];this._newPos=new Fe(b.clientX,b.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,b){var M=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY});M._simulated=!0,b.target.dispatchEvent(M)}});tn.addInitHook("addHandler","tapHold",pl),tn.mergeOptions({touchZoom:nt.touch,bounceAtZoomLimits:!0});var ml=ba.extend({addHooks:function(){Hi(this._map._container,"leaflet-touch-zoom"),Di(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){In(this._map._container,"leaflet-touch-zoom"),jn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var b=this._map;if(!(!u.touches||u.touches.length!==2||b._animatingZoom||this._zooming)){var M=b.mouseEventToContainerPoint(u.touches[0]),$=b.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),b.options.touchZoom!=="center"&&(this._pinchStartLatLng=b.containerPointToLatLng(M.add($)._divideBy(2))),this._startDist=M.distanceTo($),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),Di(document,"touchmove",this._onTouchMove,this),Di(document,"touchend touchcancel",this._onTouchEnd,this),xs(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var b=this._map,M=b.mouseEventToContainerPoint(u.touches[0]),$=b.mouseEventToContainerPoint(u.touches[1]),Z=M.distanceTo($)/this._startDist;if(this._zoom=b.getScaleZoom(Z,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&Z<1||this._zoom>b.getMaxZoom()&&Z>1)&&(this._zoom=b._limitZoom(this._zoom)),b.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var le=M._add($)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&le.x===0&&le.y===0)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(le),this._zoom)}this._moved||(b._moveStart(!0,!1),this._moved=!0),Ke(this._animRequest);var Ce=y(b._move,b,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=lt(Ce,this,!0),xs(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Ke(this._animRequest),jn(document,"touchmove",this._onTouchMove,this),jn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});tn.addInitHook("addHandler","touchZoom",ml),tn.BoxZoom=Ks,tn.DoubleClickZoom=Ul,tn.Drag=Hr,tn.Keyboard=ac,tn.ScrollWheelZoom=fl,tn.TapHold=pl,tn.TouchZoom=ml,r.Bounds=be,r.Browser=nt,r.CRS=Ot,r.Canvas=ss,r.Circle=jo,r.CircleMarker=la,r.Class=gt,r.Control=Zi,r.DivIcon=Tu,r.DivOverlay=Cs,r.DomEvent=Rc,r.DomUtil=Rs,r.Draggable=lo,r.Evented=ot,r.FeatureGroup=Ir,r.GeoJSON=$a,r.GridLayer=Ro,r.Handler=ba,r.Icon=aa,r.ImageOverlay=fo,r.LatLng=mt,r.LatLngBounds=et,r.Layer=mn,r.LayerGroup=Tn,r.LineUtil=nl,r.Map=tn,r.Marker=rl,r.Mixin=ih,r.Path=oa,r.Point=Fe,r.PolyUtil=xu,r.Polygon=Sa,r.Polyline=Fr,r.Popup=zo,r.PosAnimation=Po,r.Projection=ps,r.Rectangle=br,r.Renderer=vr,r.SVG=po,r.SVGOverlay=Bl,r.TileLayer=ca,r.Tooltip=hl,r.Transformation=gi,r.Util=Mt,r.VideoOverlay=Vr,r.bind=y,r.bounds=Ie,r.canvas=xr,r.circle=al,r.circleMarker=Ol,r.control=ra,r.divIcon=Vc,r.extend=f,r.featureGroup=Dl,r.geoJSON=sc,r.geoJson=Lo,r.gridLayer=$l,r.icon=wa,r.imageOverlay=cl,r.latLng=Ct,r.latLngBounds=at,r.layerGroup=sl,r.map=Na,r.marker=Uc,r.point=rt,r.polygon=Nl,r.polyline=Fc,r.popup=rc,r.rectangle=Eu,r.setOptions=ne,r.stamp=A,r.svg=Fa,r.svgOverlay=ul,r.tileLayer=Wn,r.tooltip=Qh,r.transformation=Oi,r.version=l,r.videoOverlay=Ta;var oc=window.L;r.noConflict=function(){return window.L=oc,this},window.L=r}))})(Am,Am.exports)),Am.exports}var ig=i2();const Xh=Kh(ig);function Wx(t,e,r){return Object.freeze({instance:t,context:e,container:r})}function Yx(t,e){return e==null?function(l,f){const _=te.useRef(void 0);return _.current||(_.current=t(l,f)),_}:function(l,f){const _=te.useRef(void 0);_.current||(_.current=t(l,f));const y=te.useRef(l),{instance:d}=_.current;return te.useEffect(function(){y.current!==l&&(e(d,l,y.current),y.current=l)},[d,l,e]),_}}function n2(t,e){te.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function s2(t){return function(r){const l=Zx(),f=t(Gx(r,l),l);return pz(l.map,r.attribution),t2(f.current,r.eventHandlers),n2(f.current,l),f}}function xz(t,e){const r=te.useRef(void 0);te.useEffect(function(){if(e.pathOptions!==r.current){const f=e.pathOptions??{};t.instance.setStyle(f),r.current=f}},[t,e])}function bz(t){return function(r){const l=Zx(),f=t(Gx(r,l),l);return t2(f.current,r.eventHandlers),n2(f.current,l),xz(f.current,r),f}}function wz(t,e){const r=Yx(t,e),l=s2(r);return e2(l)}function Sz(t,e){const r=Yx(t,e),l=bz(r);return e2(l)}function Tz(t,e){const r=Yx(t,e),l=s2(r);return _z(l)}function Ez(t,e,r){const{opacity:l,zIndex:f}=e;l!=null&&l!==r.opacity&&t.setOpacity(l),f!=null&&f!==r.zIndex&&t.setZIndex(f)}function gp(){return Zx().map}function r2(t){const e=gp();return te.useEffect(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}const rw=Sz(function({center:e,children:r,...l},f){const _=new ig.CircleMarker(e,l);return Wx(_,QS(f,{overlayContainer:_}))},mz);function kz({bounds:t,boundsOptions:e,center:r,children:l,className:f,id:_,placeholder:y,style:d,whenReady:A,zoom:I,...B},N){const[V]=te.useState({className:f,id:_,style:d}),[K,ie]=te.useState(null),ne=te.useRef(void 0);te.useImperativeHandle(N,()=>K?.map??null,[K]);const ve=te.useCallback(ge=>{if(ge!==null&&!ne.current){const ae=new ig.Map(ge,B);ne.current=ae,r!=null&&I!=null?ae.setView(r,I):t!=null&&ae.fitBounds(t,e),A!=null&&ae.whenReady(A),ie(yz(ae))}},[]);te.useEffect(()=>()=>{K?.map.remove()},[K]);const se=K?Nt.createElement(Hx,{value:K},l):y??null;return Nt.createElement("div",{...V,ref:ve},se)}const Xx=te.forwardRef(kz),i_=wz(function({position:e,...r},l){const f=new ig.Marker(e,r);return Wx(f,QS(l,{overlayContainer:f}))},function(e,r,l){r.position!==l.position&&e.setLatLng(r.position),r.icon!=null&&r.icon!==l.icon&&e.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==l.zIndexOffset&&e.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==l.opacity&&e.setOpacity(r.opacity),e.dragging!=null&&r.draggable!==l.draggable&&(r.draggable===!0?e.dragging.enable():e.dragging.disable())}),Cz=Tz(function({url:e,...r},l){const f=new ig.TileLayer(e,Gx(r,l));return Wx(f,l)},function(e,r,l){Ez(e,r,l);const{url:f}=r;f!=null&&f!==l.url&&e.setUrl(f)}),Kx=()=>{const t=gp();return te.useEffect(()=>{const e=t.getContainer();if(!e)return;let r=0;const l=()=>{r&&cancelAnimationFrame(r),r=requestAnimationFrame(()=>{t.invalidateSize();const _=t._maplibreMap;_?.resize&&_.resize()})};l();let f=null;return"ResizeObserver"in window?(f=new ResizeObserver(()=>l()),f.observe(e)):window.addEventListener("resize",l),()=>{f?f.disconnect():window.removeEventListener("resize",l),r&&cancelAnimationFrame(r)}},[t]),null},Az=({center:t,pins:e})=>{const r=gp();return te.useEffect(()=>{const l=[];t&&l.push([t.lat,t.lng]);for(const _ of e)l.push([_.lat,_.lng]);if(l.length===0)return;const f=Xh.latLngBounds(l);r.fitBounds(f,{padding:[18,18],maxZoom:13,animate:!1})},[t,r,e]),null},Mz=({center:t,pins:e,onOpenMap:r})=>{const l=te.useMemo(()=>t?[t.lat,t.lng]:e.length>0?[e[0].lat,e[0].lng]:[37.3891,-5.9845],[t,e]);return S.jsx("section",{className:"space-y-3",children:S.jsx("button",{type:"button",onClick:r,className:"relative w-full overflow-hidden text-left",children:S.jsxs("div",{className:"relative h-44 w-full overflow-hidden bg-black",children:[S.jsx("div",{className:"pointer-events-none absolute inset-0",children:S.jsxs(Xx,{center:l,zoom:12,className:"h-full w-full",zoomControl:!1,dragging:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,keyboard:!1,attributionControl:!1,children:[S.jsx(Kx,{}),S.jsx(Cz,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),S.jsx(Az,{center:t,pins:e}),t&&S.jsx(rw,{center:[t.lat,t.lng],radius:6,pathOptions:{color:"#ffffff",fillColor:"#ffffff",fillOpacity:1,weight:2}}),e.map(f=>S.jsx(rw,{center:[f.lat,f.lng],radius:7,pathOptions:{color:"#ff6b4a",fillColor:"#ff6b4a",fillOpacity:.95,weight:2}},f.id))]})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Map"}),S.jsx("p",{className:"mt-1 text-sm font-semibold text-white/90",children:e.length>0?`${e.length} nearby`:"Open the map to explore"})]})]})})})},Pz=({loading:t,trending:e,meta:r})=>{const l=ta();return S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Trending"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Trending this week"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>l.push("/tabs/map"),children:"Explore"})]}),t?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(Ws,{name:"crescent"})}):e.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No trending nights yet"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Open the map to see what people are going to."})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:e.map(f=>{const _=r[f.id],d=[_?.saves?`${_.saves} likes`:null,_?.going?`${_.going} going`:null,_?.attended?`${_.attended} attended`:null,_?.moments?`${_.moments} moments`:null].filter(Boolean).slice(0,2).join("  ");return S.jsx(Ql,{event:{...f,cover_image_url:hp(f)},className:"w-[220px] shrink-0",kicker:m_(f.starts_at),title:g_(f),subtitle:f.venue_place?.name||f.city,badge:d||void 0,onSelect:A=>l.push(`/event/${A.id}`)},f.id)})})]})},Iz=({loading:t,canFollow:e,followedSubjectIds:r,suggestedArtists:l,suggestedVenues:f,onToggleFollowSubject:_})=>{const y=ta();return S.jsxs("section",{className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Discover"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Artists & venues"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Follow to keep them close."})]}),t?S.jsx("div",{className:"flex items-center justify-center py-6",children:S.jsx(Ws,{name:"crescent"})}):S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Artists"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>y.push("/tabs/discover",{initialTab:"artists"}),children:"Explore"})]}),l.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No suggestions yet."}):S.jsx("div",{className:"space-y-2",children:l.slice(0,6).map(d=>{const A=r.has(d.subject_id);return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:()=>y.push(`/artist/${d.id}`),children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:d.avatar_url?S.jsx("img",{src:d.avatar_url,alt:d.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:d.name}),S.jsxs("p",{className:"text-xs text-white/55",children:[d.upcomingCount," upcoming"]})]})]}),S.jsx("button",{type:"button",className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${A?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,onClick:()=>_(d.subject_id),disabled:!e,children:A?"Following":"Follow"})]},d.id)})})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venues"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>y.push("/tabs/discover",{initialTab:"venues"}),children:"Explore"})]}),f.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No suggestions yet."}):S.jsx("div",{className:"space-y-2",children:f.slice(0,6).map(d=>{const A=r.has(d.subject_id);return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"min-w-0 flex-1 text-left",onClick:()=>y.push(`/venue/${d.id}`),children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:d.name}),S.jsxs("p",{className:"mt-1 text-xs text-white/55",children:[d.city,"  ",d.upcomingCount," upcoming"]})]}),S.jsx("button",{type:"button",className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${A?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,onClick:()=>_(d.subject_id),disabled:!e,children:A?"Following":"Follow"})]},d.id)})})]})]})]})},jz=({visible:t,events:e})=>{const r=ta();return t?S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Following"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"From artists you follow"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/70 hover:text-white",onClick:()=>r.push("/tabs/map"),children:"Explore"})]}),e.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:"No upcoming shows from artists you follow"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Open the map to find something new."})]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:e.map(l=>S.jsx(Ql,{event:{...l,cover_image_url:hp(l)},className:"w-[220px] shrink-0",kicker:m_(l.starts_at),title:g_(l),subtitle:l.venue_place?.name||l.city,onSelect:f=>r.push(`/event/${f.id}`)},l.id))})]}):null},Lz=t=>{const[e,r]=te.useState([]),[l,f]=te.useState(!0),[_,y]=te.useState("");return te.useEffect(()=>{let d=!1;return f(!0),y(""),mr(`events:list:${t.startIso}:${t.endIso}`,async()=>{const{data:A,error:I}=await Rt.from("events").select(`
            *,
            organizer:profiles!events_organizer_id_fkey (
              id,
              username,
              display_name,
              role
            ),
            venue_place:venue_places!events_venue_place_id_fkey (
              id,
              name,
              city,
              address,
              latitude,
              longitude
            ),
            event_artists (
              artist:artists!event_artists_artist_entity_fk (
                id,
                name,
                avatar_url
              )
            )
          `).gte("starts_at",t.startIso).lte("starts_at",t.endIso).order("starts_at",{ascending:!0});if(I)throw I;return A||[]},{ttlMs:1e4}).then(A=>{d||r(A)}).catch(()=>{d||(y("Could not load events. Check your Supabase connection."),r([]))}).finally(()=>{d||f(!1)}),()=>{d=!0}},[t.endIso,t.startIso]),{events:e,loading:l,error:_}},zz=(t,e)=>{const[r,l]=te.useState([]),[f,_]=te.useState({}),[y,d]=te.useState(!1);return te.useEffect(()=>{if(t.length===0){l([]),_({});return}let A=!1;return(async()=>{d(!0);try{const B=new Date(Date.now()-2592e5).toISOString(),[N,V,K]=await mr(`trending:since:${B}`,async()=>{const[ae,me,ye]=await Promise.all([Rt.from("event_saves").select("event_id,created_at").gte("created_at",B).limit(1e3),Rt.from("event_attendance").select("event_id,status,created_at").gte("created_at",B).limit(1e3),Rt.from("posts").select("event_id,created_at").gte("created_at",B).limit(1e3)]);return[ae.data||[],me.data||[],ye.data||[]]},{ttlMs:1e4}),ie={},ne=(ae,me)=>{ie[ae]||={saves:0,going:0,attended:0,moments:0,score:0},ie[ae][me]+=1};for(const ae of N)ae?.event_id&&ne(ae.event_id,"saves");for(const ae of V)ae?.event_id&&ne(ae.event_id,ae.status==="attended"?"attended":"going");for(const ae of K)ae?.event_id&&ne(ae.event_id,"moments");for(const[ae,me]of Object.entries(ie)){me.score=me.saves*2+me.going*3+me.attended*4+me.moments*4;const ye=t.find(He=>He.id===ae);if(!ye){me.score=0;continue}const Se=new Date(ye.starts_at);Se.getTime()>=e.getTime()-1e3*60*60*24&&Se.getTime()<=e.getTime()+1e3*60*60*24*7||(me.score=0)}const ve=Object.entries(ie).filter(([,ae])=>ae.score>0).sort((ae,me)=>me[1].score-ae[1].score).slice(0,6).map(([ae])=>ae),se=ve.map(ae=>t.find(me=>me.id===ae)).filter(Boolean),ge={};for(const ae of ve){const me=ie[ae];me&&(ge[ae]={saves:me.saves,going:me.going,attended:me.attended,moments:me.moments})}if(A)return;l(se),_(ge)}catch{if(A)return;l([]),_({})}finally{A||d(!1)}})(),()=>{A=!0}},[t,e]),{trending:r,meta:f,loading:y}},Rz=(t,e)=>{const[r,l]=te.useState([]),[f,_]=te.useState([]),[y,d]=te.useState(!1);return te.useEffect(()=>{if(t.length===0){l([]),_([]);return}let A=!1;return(async()=>{d(!0);try{const B=t.filter(se=>{const ge=new Date(se.starts_at);return ge>=e.startOfToday&&ge<=e.endOfEventsWindow}),N=new Map,V=new Map;for(const se of B){for(const ge of se.event_artists||[]){if(!ge?.artist?.id)continue;const ae=N.get(ge.artist.id);N.set(ge.artist.id,{id:ge.artist.id,count:(ae?.count||0)+1})}if(se.venue_place?.id){const ge=V.get(se.venue_place.id);V.set(se.venue_place.id,{id:se.venue_place.id,name:se.venue_place.name,city:se.venue_place.city,count:(ge?.count||0)+1})}}const K=Array.from(N.values()).sort((se,ge)=>ge.count-se.count).slice(0,10).map(se=>se.id),ie=await(async()=>{if(K.length===0)return[];const se=Array.from(new Set(K)).sort(),ge=se.join(","),ae=await mr(`artists:by_ids:${ge}`,async()=>{const{data:ye,error:Se}=await Rt.from("v_subject_artists").select("artist_id,name,avatar_url,subject_id").in("artist_id",se);if(Se)throw Se;return ye||[]},{ttlMs:6e4}),me=new Map;for(const ye of ae)ye.artist_id&&me.set(ye.artist_id,ye);return K.map(ye=>{const Se=me.get(ye),ze=N.get(ye);return!Se?.subject_id||!ze?null:{id:ye,subject_id:Se.subject_id,name:Se.name,avatar_url:Se.avatar_url,upcomingCount:ze.count}}).filter(Boolean)})(),ne=Array.from(V.values()).sort((se,ge)=>ge.count-se.count).slice(0,10),ve=await mr(`home:suggested:venues:${ne.map(se=>se.id).join(",")}`,async()=>{if(ne.length===0)return[];const se=ne.map(ae=>ae.id),ge=new Map;try{const{data:ae,error:me}=await Rt.from("subjects").select("id,venue_place_id,type").eq("type","venue").in("venue_place_id",se);if(me)throw me;for(const ye of ae||[]){const Se=ye.venue_place_id,ze=ye.id;Se&&ze&&ge.set(Se,ze)}}catch{}for(const ae of ne){if(ge.has(ae.id))continue;const me=await mr(`subject:venue:${ae.id}`,async()=>{const{data:ye,error:Se}=await Rt.rpc("get_or_create_venue_subject",{p_venue_place_id:ae.id});if(Se)throw Se;return ye},{ttlMs:1440*60*1e3}).catch(()=>null);typeof me=="string"&&ge.set(ae.id,me)}return ne.map(ae=>{const me=ge.get(ae.id);return me?{id:ae.id,subject_id:me,name:ae.name,city:ae.city,upcomingCount:ae.count}:null}).filter(Boolean)},{ttlMs:3e4});if(A)return;l(ie),_(ve)}catch{if(A)return;l([]),_([])}finally{A||d(!1)}})(),()=>{A=!0}},[t,e.endOfEventsWindow,e.startOfToday]),{suggestedArtists:r,suggestedVenues:f,loading:y}},Dz=t=>{const[e,r]=te.useState(new Set);return te.useEffect(()=>{const l=Array.from(t);if(l.length===0){r(new Set);return}let f=!1;return mr(`subjects:artist_ids:${l.sort().join(",")}`,async()=>{const{data:_,error:y}=await Rt.from("subjects").select("id,type,artist_id").in("id",l);if(y)throw y;return(_||[]).filter(d=>d.type==="artist"&&d.artist_id).map(d=>d.artist_id)},{ttlMs:1e4}).then(_=>{f||r(new Set(_))}).catch(()=>{f||r(new Set)}),()=>{f=!0}},[t]),e},a2="live_space.pending_moments.dismissed",Oz=()=>{try{const t=window.localStorage.getItem(a2);if(!t)return{};const e=JSON.parse(t);return e&&typeof e=="object"?e:{}}catch{return{}}},Nz=t=>{try{window.localStorage.setItem(a2,JSON.stringify(t))}catch{}},Bz=t=>{const e=new Date(t.starts_at);return t.ends_at?new Date(t.ends_at):new Date(e.getTime()+360*60*1e3)},$z=t=>t<24?"You attended yesterday":t<48?"You attended 2 days ago":"You attended recently",Uz=async(t,e)=>await mr(`posts:count:user:${t}:event:${e}`,async()=>{const{count:l,error:f}=await Rt.from("posts").select("id",{count:"exact",head:!0}).eq("user_id",t).eq("event_id",e);if(f)throw f;return l||0},{ttlMs:1e4})>0,Fz=async t=>mr(`attendance:user:${t}`,async()=>{const{data:e,error:r}=await Rt.from("event_attendance").select("event_id,status,created_at").eq("user_id",t).in("status",["going","attended"]).order("created_at",{ascending:!1}).limit(50);if(r)throw r;return e||[]},{ttlMs:1e4}),Vz=async t=>mr(`event:detail:${t}`,async()=>{const{data:e,error:r}=await Rt.from("events").select(`
          *,
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `).eq("id",t).maybeSingle();if(r)throw r;return e||null},{ttlMs:6e4}),qz=t=>{const{user:e}=ya(),r=e?.id||null,l=t.now?t.now.getTime():null,[f,_]=te.useState({});te.useEffect(()=>{_(Oz())},[]);const y=V=>{const K={...f,[V]:Date.now()};_(K),Nz(K)},[d,A]=te.useState({kind:"loading"}),[I,B]=te.useState(null);te.useEffect(()=>{if(!r){A({kind:"cold_start"}),B(null);return}let V=!1;return(async()=>{A({kind:"loading"}),B(null);try{const ie=new Date(l??Date.now()),ne=await Fz(r);if(V)return;const ve=new Map;for(const ze of t.events)ve.set(ze.id,ze);const se=async ze=>{const He=ve.get(ze);if(He)return He;const Ze=await Vz(ze);return Ze&&ve.set(ze,Ze),Ze},ge=ne.filter(ze=>ze.status==="attended"),ae=[];for(const ze of ge){const He=await se(ze.event_id);if(!He)continue;const Ze=Bz(He),st=(ie.getTime()-Ze.getTime())/(1e3*60*60);st<0||st>72||ae.push({event:He,hoursSinceEnd:st})}ae.sort((ze,He)=>ze.hoursSinceEnd-He.hoursSinceEnd);const me=async()=>{const ze=ne.filter(Ze=>Ze.status==="going"),He=[];for(const Ze of ze){const st=await se(Ze.event_id);!st||new Date(st.starts_at).getTime()<ie.getTime()||He.push(st)}return He.sort((Ze,st)=>new Date(Ze.starts_at).getTime()-new Date(st.starts_at).getTime()),He};for(const ze of ae){const He=f[ze.event.id];if(He&&Date.now()-He<1e3*60*60*24*7||await Uz(r,ze.event.id))continue;const st=await me();B(st[0]||null);const lt=ze.hoursSinceEnd<=36?"hero":"compact",Ke=$z(ze.hoursSinceEnd);A({kind:"just_attended",event:ze.event,hoursSinceEnd:ze.hoursSinceEnd,timeLabel:Ke,size:lt});return}const ye=await me(),Se=ye[0]||null;if(B(ye[1]||null),Se){A({kind:"upcoming",event:Se});return}A({kind:"cold_start"})}catch{if(V)return;A({kind:"cold_start"}),B(null)}})(),()=>{V=!0}},[f,l,t.events,r]);const N=V=>{r&&FS(`posts:count:user:${r}:event:${V}`)};return te.useMemo(()=>({hero:d,nextUpcoming:I,dismissPendingMoments:y,refreshMomentsForEvent:N}),[y,d,I])},aw=t=>t.venue_place?.name||t.address||t.city||"Venue",ow=t=>t.event_artists?.find(r=>r.artist)?.artist?.name||t.name,lw=t=>new Date(t).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),Hz=({state:t,onDismissPendingMoments:e})=>{const r=ta(),l=te.useMemo(()=>{if(t.kind==="loading")return S.jsx("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("div",{className:"h-8 w-3/4 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-3 h-4 w-1/2 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-2 h-3 w-1/3 animate-pulse rounded bg-white/10"}),S.jsx("div",{className:"mt-5 h-11 w-full animate-pulse rounded bg-white/10"})]})});if(t.kind==="cold_start")return S.jsx("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:"Discover concerts near you"}),S.jsxs("div",{className:"mt-5 flex items-center gap-3",children:[S.jsx("button",{type:"button",className:"rounded bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>r.push("/tabs/map"),children:"Explore map"}),S.jsx("button",{type:"button",className:"rounded bg-white/10 px-4 py-2 text-sm font-semibold text-white/90",onClick:()=>r.push("/tabs/discover"),children:"Discover"})]})]})});if(t.kind==="upcoming"){const A=hp(t.event),I=ow(t.event),B=aw(t.event),N=lw(t.event.starts_at);return S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[A?S.jsx("img",{src:A,alt:t.event.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Youre going to"}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:I}),S.jsx("p",{className:"mt-2 text-sm font-semibold uppercase tracking-[0.18em] text-white/80",children:B}),S.jsx("p",{className:"mt-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:N}),S.jsx("div",{className:"mt-5",children:S.jsx("button",{type:"button",className:"w-full rounded bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>r.push(`/event/${t.event.id}`),children:"View event"})})]})]})}const f=hp(t.event),_=ow(t.event),y=aw(t.event),d=lw(t.event.starts_at);return S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[f?S.jsx("img",{src:f,alt:t.event.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy"}):S.jsx("div",{className:"absolute inset-0 bg-black"}),e&&S.jsx("button",{type:"button",className:"absolute right-4 top-4 z-10 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>e(t.event.id),children:"Dismiss"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:["Last night at ",y]}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:_}),S.jsx("p",{className:"mt-2 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:d}),S.jsx("div",{className:"mt-5",children:S.jsx("button",{type:"button",className:"w-full rounded bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white",onClick:()=>r.push(`/event/${t.event.id}`,{openAddMoments:!0}),children:"Add your moments"})})]})]})},[r,e,t]);return S.jsx("section",{children:l})},Zz=50,Gz=4,Wz=()=>{const t=ta(),{canCreateEvent:e}=mp(),r=te.useMemo(()=>{const gt=new Date;return gt.setHours(0,0,0,0),gt},[]),l=te.useMemo(()=>{const gt=new Date(r);return gt.setDate(gt.getDate()+14),gt.setHours(23,59,59,999),gt},[r]),f=te.useMemo(()=>{const gt=new Date(r);return gt.setDate(gt.getDate()+30),gt.setHours(23,59,59,999),gt},[r]),_=te.useMemo(()=>new Date(r.getTime()-1e3*60*60*24*Gz).toISOString(),[r]),y=te.useMemo(()=>f.toISOString(),[f]),{location:d,loading:A,error:I,requestLocation:B}=oz(),{events:N,loading:V,error:K}=Lz({startIso:_,endIso:y}),{hero:ie,nextUpcoming:ne,dismissPendingMoments:ve}=qz({events:N}),se=te.useMemo(()=>{if(!d)return[];const gt=[];for(const St of N){const Be=new Date(St.starts_at);if(Be<r||Be>l)continue;const ot=qh(St.latitude??St.venue_place?.latitude??null),Fe=qh(St.longitude??St.venue_place?.longitude??null);if(ot===null||Fe===null)continue;const kt=qx(d.lat,d.lng,ot,Fe);kt>Zz||gt.push({...St,distanceKm:kt})}return gt.sort((St,Be)=>new Date(St.starts_at).getTime()-new Date(Be.starts_at).getTime()||St.distanceKm-Be.distanceKm),gt},[l,N,d,r]),ge=te.useMemo(()=>se.map(gt=>{const St=qh(gt.latitude??gt.venue_place?.latitude??null),Be=qh(gt.longitude??gt.venue_place?.longitude??null);return St===null||Be===null?null:{id:gt.id,lat:St,lng:Be}}).filter(Boolean).slice(0,12),[se]),{trending:ae,meta:me,loading:ye}=zz(N,r),{suggestedArtists:Se,suggestedVenues:ze,loading:He}=Rz(N,{startOfToday:r,endOfEventsWindow:f}),{canFollow:Ze,followedSubjectIds:st,toggleFollowSubject:lt}=JS(),Ke=Dz(st),Mt=te.useMemo(()=>{if(Ke.size===0)return[];const gt=N.filter(St=>{const Be=new Date(St.starts_at);return Be<r||Be>f?!1:(St.event_artists||[]).some(ot=>ot.artist?.id&&Ke.has(ot.artist.id))});return gt.sort((St,Be)=>new Date(St.starts_at).getTime()-new Date(Be.starts_at).getTime()),gt.slice(0,6)},[f,N,Ke,r]);return S.jsxs(so,{children:[S.jsx(Hz,{state:ie,onDismissPendingMoments:ie.kind==="just_attended"?ve:void 0}),ie.kind!=="just_attended"&&S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[ie.kind!=="cold_start"&&ne&&S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Next"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:"Coming up"})]}),S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:S.jsx(Ql,{event:{...ne,cover_image_url:hp(ne)},className:"w-[220px] shrink-0",kicker:m_(ne.starts_at),title:g_(ne),subtitle:ne.venue_place?.name||ne.city,onSelect:gt=>t.push(`/event/${gt.id}`)})})]}),ie.kind==="cold_start"&&S.jsx(fz,{canCreateEvent:e,loading:V,loadError:K,location:d,locationLoading:A,locationError:I,onRequestLocation:B,nearbyUpcoming:se}),S.jsx(Mz,{center:d,pins:ge,onOpenMap:()=>t.push("/tabs/map")}),S.jsx(Pz,{loading:ye,trending:ae,meta:me}),S.jsx(Iz,{loading:He,canFollow:Ze,followedSubjectIds:st,suggestedArtists:Se,suggestedVenues:ze,onToggleFollowSubject:gt=>{lt(gt)}}),S.jsx(jz,{visible:Ke.size>0,events:Mt})]})]})},Yz=()=>{const{user:t,profile:e,updateProfile:r,signOut:l,refreshProfile:f}=ya(),{managedEntities:_,activeWorkspace:y,setActiveWorkspace:d}=mp(),[A,I]=te.useState(!1),B=ta(),N=pp(),V=!1,[K,ie]=te.useState([]),[ne,ve]=te.useState([]),[se,ge]=te.useState([]),[ae,me]=te.useState([]),[ye,Se]=te.useState([]),[ze,He]=te.useState(!0),[Ze,st]=te.useState(""),[lt,Ke]=te.useState("moments"),[Mt,gt]=te.useState(!1),[St,Be]=te.useState(e?.display_name||""),[ot,Fe]=te.useState(e?.username||""),[kt,rt]=te.useState(e?.primary_city||""),[be,Ie]=te.useState(e?.bio||""),[et,at]=te.useState(e?.role||"user"),[mt,Ct]=te.useState(e?.external_links?.website||""),[Ot,Kt]=te.useState(e?.external_links?.instagram||""),[_i,Vi]=te.useState(e?.external_links?.spotify||""),[gi,Oi]=te.useState(null),[xn,cn]=te.useState(""),[Zn,tt]=te.useState(""),[Xn,Pn]=te.useState(""),[ki,yi]=te.useState(""),[Cn,Ln]=te.useState(""),[us,an]=te.useState(""),[en,qi]=te.useState(""),[Fn,Tt]=te.useState(""),[On,dn]=te.useState(""),[An,Kn]=te.useState(""),[It,ai]=te.useState(""),[ti,Ji]=te.useState(!1),[Nn,mi]=te.useState(!1);te.useEffect(()=>{I(!!y)},[y]),te.useEffect(()=>{if(y){if(y.type==="artist"&&y.artist?.id){const de=`/tabs/artist/${y.artist.id}`;N.pathname.startsWith(de)||B.replace(de)}else if(y.type==="venue"&&y.venue?.id){const de=`/tabs/venue/${y.venue.id}`;N.pathname.startsWith(de)||B.replace(de)}}},[y,B,N.pathname]);const Bt=A&&y?y.type==="user"?y.profile:null:e,hi=Nt.useRef(""),Ci=async(de=!1)=>{if(!t?.id)return;const Je=`${t.id}-${A}-${y?.subject_id}`;if(!(!de&&hi.current===Je)){He(!0),st("");try{const ct=`
        id,
        name,
        city,
        address,
        starts_at,
        cover_image_url,
        venue_place:venue_places!events_venue_place_id_fkey (
          id,
          name,
          city,
          address
        ),
        event_artists (
          artist:artists!event_artists_artist_entity_fk (
            id,
            name,
            avatar_url
          )
        )
      `,Ye=Je;let nt=Rt.from("posts").select("id, media_url, media_type, caption, created_at, event_offset_ms, song_title");A&&y?nt=nt.eq("actor_subject_id",y.subject_id):nt=nt.eq("user_id",t.id);const[ei,si,$t]=await Promise.all([nt.order("created_at",{ascending:!1}).limit(12),Rt.from("event_saves").select(`events!inner (${ct})`).eq("user_id",t.id),Rt.from("event_attendance").select(`status, events!inner (${ct})`).eq("user_id",t.id)]);if(hi.current!==Ye&&!de)return;const At=ei.data,ni=si.data,vi=$t.data;let Bi=[],_t=[];const xt=A&&y?y.type:e?.role;if(xt==="artist"){const Ne=A&&y?y.artist?.id:null;if(Ne){const{data:zt}=await Rt.from("event_artists").select(`
                events!inner (
                  ${ct}
                )
              `).eq("artist_entity_id",Ne);Bi=(zt||[]).map(Jt=>Jt.events).filter(Jt=>!!Jt)}}if(xt==="venue"){const Ne=A&&y?y.venue?.id:null;if(Ne){const{data:zt}=await Rt.from("events").select(ct).eq("venue_place_id",Ne).order("starts_at",{ascending:!1});_t=zt||[]}}if(hi.current!==Ye&&!de)return;ie(At||[]);const Wt=(ni||[]).map(Ne=>Ne.events).filter(Ne=>!!Ne),pi=(vi||[]).map(Ne=>Ne.events).filter(Ne=>!!Ne);ve(Wt),ge([...pi,...Bi]),me(Bi),Se(_t),hi.current=Ye}catch{st("Could not load profile data. Check your Supabase connection.")}finally{He(!1)}}};te.useEffect(()=>{t?.id&&Ci()},[t?.id,e?.role,A,y?.subject_id]),te.useEffect(()=>{Be(e?.display_name||""),Fe(e?.username||""),rt(e?.primary_city||""),Ie(e?.bio||""),at(e?.role||"user"),Ct(e?.external_links?.website||""),Kt(e?.external_links?.instagram||""),Vi(e?.external_links?.spotify||"")},[e]);const bi=_.find(de=>de.venue?.id===gi)?.venue||null,xe=bi??_.find(de=>de.type==="venue")?.venue??null;te.useEffect(()=>{if(!bi){cn(""),tt(""),Pn(""),yi(""),Ln(""),an(""),qi(""),Tt(""),dn("");return}cn(bi.name||""),tt(bi.city||""),Pn(bi.address||""),yi(bi.website_url||""),Ln(bi.capacity!==null?bi.capacity.toString():""),an(bi.venue_type||""),qi(bi.latitude!==null?bi.latitude.toString():""),Tt(bi.longitude!==null?bi.longitude.toString():""),dn((bi.photos||[]).join(`
`))},[bi]);const ee=de=>{const Je=de.trim();if(!Je)return null;const ct=Number(Je);return Number.isNaN(ct)?null:ct},Q=de=>{const Je=de.trim();if(!Je)return null;const ct=Number(Je);return Number.isFinite(ct)?Math.round(ct):null},ue=async()=>{ai(""),Kn(""),Ji(!0);const de={...Bt?.external_links||{}},Je=(nt,ei)=>{const si=ei.trim();si?de[nt]=si:delete de[nt]};Je("website",mt),Je("instagram",Ot),Je("spotify",_i);const ct={display_name:St||null,username:ot||null,primary_city:kt||null,bio:be||null,external_links:de};V&&(ct.role=et);const{error:Ye}=await r(ct);if(Ye){ai(Ye.message),Ji(!1);return}if(e?.role==="venue"&&t&&gi){if(!xn.trim()||!Zn.trim()){ai("Venue name and city are required."),Ji(!1);return}const nt=On.split(/\n|,/).map(si=>si.trim()).filter(Boolean),{error:ei}=await Rt.from("venue_places").update({name:xn.trim()||null,city:Zn.trim()||kt||"",address:Xn.trim()||null,website_url:ki.trim()||null,capacity:Q(Cn),venue_type:us.trim()||null,latitude:ee(en),longitude:ee(Fn),photos:nt}).eq("id",gi);if(ei){ai(ei.message),Ji(!1);return}}await f(),await Ci(),Kn("Profile updated."),gt(!1),Ji(!1)},we=async()=>{ai(""),Kn(""),mi(!0);try{await l(),B.replace("/welcome")}catch{ai("Sign out failed. Check your Supabase connection.")}finally{mi(!1)}},je=()=>e?.role==="artist"?"Concerts":e?.role==="venue"?"Events":"Attended",Oe=()=>e?.role==="artist"?L0:SS,qe=()=>ze?S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})}):Ze?S.jsx("p",{className:"text-sm text-rose-400",children:Ze}):e?.role==="artist"&&lt==="attended"?ae.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No shows here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Find a show"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:ae.map(de=>S.jsx(Ql,{event:de,className:"w-full",onSelect:Je=>B.push(`/event/${Je.id}`)},de.id))}):e?.role==="venue"&&lt==="attended"?ye.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No nights here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Explore nearby"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:ye.map(de=>S.jsx(Ql,{event:de,className:"w-full",onSelect:Je=>B.push(`/event/${Je.id}`)},de.id))}):lt==="liked"?ne.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"Nothing saved yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/discover"),children:"Discover concerts"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:ne.map(de=>S.jsx(Ql,{event:de,className:"w-full",onSelect:Je=>B.push(`/event/${Je.id}`)},de.id))}):lt==="attended"?se.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"No nights here yet."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/map"),children:"Find a show"})]}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:se.map(de=>S.jsx(Ql,{event:de,className:"w-full",onSelect:Je=>B.push(`/event/${Je.id}`)},de.id))}):K.length===0?S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-white/55",children:"Your concert memories start after the show."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/events"),children:"Go to Main"})]}):S.jsx("div",{className:"grid grid-cols-3 gap-2",children:K.map(de=>S.jsx("button",{type:"button",onClick:()=>B.push(`/post/${de.id}`),className:"overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:de.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:de.media_url})}):S.jsx("img",{src:de.media_url,alt:de.caption||"Moment",className:"h-full w-full object-cover"})},de.id))});return S.jsx(so,{children:S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[!A&&S.jsxs("div",{className:"space-y-4 animate-fade-up motion-reduce:animate-none",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:S.jsx("img",{src:e?.avatar_url||`https://picsum.photos/seed/${e?.id}/120/120`,alt:"Profile avatar",className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"min-w-0 flex-1",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Profile"}),S.jsx("h2",{className:"mt-2 font-display text-2xl font-bold text-white line-clamp-1",children:e?.username?`@${e.username}`:e?.display_name||"You"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:e?.primary_city||""})]}),S.jsx("button",{type:"button",className:"px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>gt(de=>!de),children:"Edit"})]}),S.jsx("p",{className:"text-sm text-white/70",children:"Your concert memories live here."}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>B.push("/tabs/discover"),children:"Discover concerts"})]}),A&&S.jsxs("div",{className:"flex items-center gap-4 animate-fade-up motion-reduce:animate-none",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:S.jsx("img",{src:y?y.type==="artist"?y.artist?.avatar_url||`https://picsum.photos/seed/artist-${y.subject_id}/120/120`:y.venue?.photos?.[0]||`https://picsum.photos/seed/venue-${y.subject_id}/120/120`:e?.avatar_url||`https://picsum.photos/seed/${e?.id}/120/120`,alt:"Profile avatar",className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"flex-1",children:[S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:y?y.type==="artist"?y.artist?.name:y.venue?.name:e?.display_name||e?.username||"Your profile"}),S.jsx("p",{className:"text-sm text-white/55",children:y?y.type==="artist"?"Managed artist":"Managed venue":""})]}),S.jsxs("div",{className:"flex flex-col gap-2",children:[y?.type==="artist"&&y.artist?.id&&S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>B.push(`/tabs/artist/${y.artist.id||y.artist.artist_id}`),children:"View profile"}),y?.type==="venue"&&y.venue?.id&&S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-1.5 text-xs font-semibold text-white",onClick:()=>B.push(`/tabs/venue/${y.venue.id||y.venue.venue_place_id}`),children:"View profile"}),S.jsx("button",{type:"button",className:"px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>gt(de=>!de),children:"Edit"})]})]}),A&&_.length>1&&S.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 animate-fade-in",children:_.map(de=>S.jsx("button",{type:"button",className:`flex-shrink-0 rounded-xl px-4 py-1.5 text-xs font-semibold transition ${y?.subject_id===de.subject_id?"bg-white/10 text-app-accent":"bg-white/5 text-white/60 hover:bg-white/10 hover:text-white/80"}`,onClick:()=>d(de),children:de.type==="artist"?de.artist?.name:de.venue?.name},de.subject_id))}),e?.role==="artist"&&(mt||Ot||_i)&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artist links"}),S.jsxs("div",{className:"space-y-2 text-sm text-white/80",children:[mt&&S.jsx("a",{href:mt,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:mt.replace(/^https?:\/\//,"")}),Ot&&S.jsx("a",{href:Ot,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:Ot.replace(/^https?:\/\//,"")}),_i&&S.jsx("a",{href:_i,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:_i.replace(/^https?:\/\//,"")})]})]}),e?.role==="venue"&&xe&&S.jsxs("div",{className:"space-y-3 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue details"}),S.jsxs("div",{className:"space-y-2 text-sm text-white/80",children:[(xe.address||e.primary_city)&&S.jsx("p",{children:xe.address||e.primary_city}),xe.website_url&&S.jsx("a",{href:xe.website_url,target:"_blank",rel:"noreferrer",className:"text-white/80 hover:text-white",children:xe.website_url.replace(/^https?:\/\//,"")})]}),(xe.photos??[]).length>0&&S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:(xe.photos??[]).map((de,Je)=>S.jsx("div",{className:"h-24 w-40 flex-shrink-0 overflow-hidden rounded-2xl bg-black/30",children:S.jsx("img",{src:de,alt:"Venue",className:"h-full w-full object-cover"})},`${de}-${Je}`))})]}),Mt&&S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-4",style:{animationDelay:"0.16s"},children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Display name"}),S.jsx("input",{value:St,onChange:de=>Be(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{value:ot,onChange:de=>Fe(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Primary city"}),S.jsx("input",{value:kt,onChange:de=>rt(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Bio"}),S.jsx("textarea",{value:be,onChange:de=>Ie(de.target.value),className:"min-h-[96px] w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),V&&S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Role (dev)"}),S.jsxs("select",{value:et,onChange:de=>at(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",children:[S.jsx("option",{value:"user",children:"User"}),S.jsx("option",{value:"artist",children:"Artist"}),S.jsx("option",{value:"venue",children:"Venue"}),S.jsx("option",{value:"label",children:"Label"})]}),S.jsx("span",{className:"text-xs text-white/60",children:"Solo para testing. En prod queda bloqueado."})]}),e?.role==="artist"&&S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artist links"}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Website"}),S.jsx("input",{value:mt,onChange:de=>Ct(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://your-site.com"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Instagram"}),S.jsx("input",{value:Ot,onChange:de=>Kt(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://instagram.com/you"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Spotify"}),S.jsx("input",{value:_i,onChange:de=>Vi(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://open.spotify.com/artist/..."})]})]}),e?.role==="venue"&&S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue management"}),_.filter(de=>de.type==="venue").length===0?S.jsx("p",{className:"text-sm text-white/60",children:"No managed venue place yet. Create or claim a venue to edit its details."}):S.jsxs(S.Fragment,{children:[_.filter(de=>de.type==="venue").length>1&&S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Managed venue"}),S.jsx("select",{value:gi||"",onChange:de=>Oi(de.target.value||null),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",children:_.filter(de=>de.type==="venue").map(de=>S.jsx("option",{value:de.venue?.id,children:de.venue?.name},de.venue?.id))})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue name"}),S.jsx("input",{value:xn,onChange:de=>cn(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Venue name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("input",{value:Zn,onChange:de=>tt(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"City"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue type"}),S.jsx("input",{value:us,onChange:de=>an(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Club, hall, theatre..."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Capacity"}),S.jsx("input",{value:Cn,onChange:de=>Ln(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"450"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Address"}),S.jsx("input",{value:Xn,onChange:de=>Pn(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Street address"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Website"}),S.jsx("input",{value:ki,onChange:de=>yi(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"https://venue-site.com"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Latitude"}),S.jsx("input",{value:en,onChange:de=>qi(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Longitude"}),S.jsx("input",{value:Fn,onChange:de=>Tt(de.target.value),className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue photos (URLs)"}),S.jsx("textarea",{value:On,onChange:de=>dn(de.target.value),className:"min-h-[96px] w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"One URL per line"})]})]})]}),It&&S.jsx("p",{className:"text-sm text-rose-400",children:It}),An&&S.jsx("p",{className:"text-sm text-emerald-400",children:An}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:ue,disabled:ti,children:ti?"Saving...":"Save changes"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>gt(!1),children:"Cancel"})]}),S.jsxs("div",{className:"flex gap-2 animate-fade-up motion-reduce:animate-none",style:{animationDelay:"0.16s"},children:[S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${lt==="moments"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>Ke("moments"),children:[S.jsx(L0,{className:"h-4 w-4"}),"Moments"]}),S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${lt==="attended"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>Ke("attended"),children:[Nt.createElement(Oe(),{className:"h-4 w-4"}),je()]}),S.jsxs("button",{type:"button",className:`flex flex-1 items-center justify-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${lt==="liked"?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>Ke("liked"),children:[S.jsx(Nx,{className:"h-4 w-4"}),"Liked"]})]}),S.jsx("div",{className:"animate-fade-up motion-reduce:animate-none",style:{animationDelay:"0.24s"},children:qe()}),!Mt&&It&&S.jsx("p",{className:"text-sm text-rose-400",children:It}),!Mt&&An&&S.jsx("p",{className:"text-sm text-emerald-400",children:An}),S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:we,disabled:Nn,children:[S.jsx(rI,{className:"h-4 w-4"}),Nn?"Signing out...":"Log out"]})]})})};var Py={exports:{}};var Xz=Py.exports,cw;function l2(){return cw||(cw=1,(function(t,e){(function(r,l){t.exports=l()})(Xz,(function(){var r={},l={};function f(y,d,A){if(l[y]=A,y==="index"){var I="var sharedModule = {}; ("+l.shared+")(sharedModule); ("+l.worker+")(sharedModule);",B={};return l.shared(B),l.index(r,B),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([I],{type:"text/javascript"}))),r}}f("shared",["exports"],(function(y){function d(a,n,c,m){return new(c||(c=Promise))((function(x,k){function C(F){try{R(m.next(F))}catch(q){k(q)}}function j(F){try{R(m.throw(F))}catch(q){k(q)}}function R(F){var q;F.done?x(F.value):(q=F.value,q instanceof c?q:new c((function(G){G(q)}))).then(C,j)}R((m=m.apply(a,n||[])).next())}))}function A(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var I=B;function B(a,n){this.x=a,this.y=n}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,n){return this.clone()._rotateAround(a,n)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var n=a.x-this.x,c=a.y-this.y;return n*n+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,n){return Math.atan2(this.x*n-this.y*a,this.x*a+this.y*n)},_matMult:function(a){var n=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=n,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var n=Math.cos(a),c=Math.sin(a),m=c*this.x+n*this.y;return this.x=n*this.x-c*this.y,this.y=m,this},_rotateAround:function(a,n){var c=Math.cos(a),m=Math.sin(a),x=n.y+m*(this.x-n.x)+c*(this.y-n.y);return this.x=n.x+c*(this.x-n.x)-m*(this.y-n.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(a){return a instanceof B?a:Array.isArray(a)?new B(a[0],a[1]):a};var N=A(I),V=K;function K(a,n,c,m){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=n,this.p2x=c,this.p2y=m}K.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,n){if(n===void 0&&(n=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,m=0;m<8;m++){var x=this.sampleCurveX(c)-a;if(Math.abs(x)<n)return c;var k=this.sampleCurveDerivativeX(c);if(Math.abs(k)<1e-6)break;c-=x/k}var C=0,j=1;for(c=a,m=0;m<20&&(x=this.sampleCurveX(c),!(Math.abs(x-a)<n));m++)a>x?C=c:j=c,c=.5*(j-C)+C;return c},solve:function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))}};var ie=A(V);let ne,ve;function se(){return ne==null&&(ne=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ne}function ge(){if(ve==null&&(ve=!1,se())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let m=0;m<25;m++){const x=4*m;n.fillStyle=`rgb(${x},${x+1},${x+2})`,n.fillRect(m%5,Math.floor(m/5),1,1)}const c=n.getImageData(0,0,5,5).data;for(let m=0;m<100;m++)if(m%4!=3&&c[m]!==m){ve=!0;break}}}return ve||!1}function ae(a,n,c,m){const x=new ie(a,n,c,m);return k=>x.solve(k)}const me=ae(.25,.1,.25,1);function ye(a,n,c){return Math.min(c,Math.max(n,a))}function Se(a,n,c){const m=c-n,x=((a-n)%m+m)%m+n;return x===n?c:x}function ze(a,...n){for(const c of n)for(const m in c)a[m]=c[m];return a}let He=1;function Ze(a,n,c){const m={};for(const x in a)m[x]=n.call(this,a[x],x,a);return m}function st(a,n,c){const m={};for(const x in a)n.call(this,a[x],x,a)&&(m[x]=a[x]);return m}function lt(a){return Array.isArray(a)?a.map(lt):typeof a=="object"&&a?Ze(a,lt):a}const Ke={};function Mt(a){Ke[a]||(typeof console<"u"&&console.warn(a),Ke[a]=!0)}function gt(a,n,c){return(c.y-a.y)*(n.x-a.x)>(n.y-a.y)*(c.x-a.x)}function St(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Be=null;function ot(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function kt(a,n,c,m,x){return d(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const k=new VideoFrame(a,{timestamp:0});try{const C=k?.format;if(!C||!C.startsWith("BGR")&&!C.startsWith("RGB"))throw new Error(`Unrecognized format ${C}`);const j=C.startsWith("BGR"),R=new Uint8ClampedArray(m*x*4);if(yield k.copyTo(R,(function(F,q,G,J,re){const ce=4*Math.max(-q,0),he=(Math.max(0,G)-G)*J*4+ce,Ee=4*J,Ae=Math.max(0,q),Xe=Math.max(0,G);return{rect:{x:Ae,y:Xe,width:Math.min(F.width,q+J)-Ae,height:Math.min(F.height,G+re)-Xe},layout:[{offset:he,stride:Ee}]}})(a,n,c,m,x)),j)for(let F=0;F<R.length;F+=4){const q=R[F];R[F]=R[F+2],R[F+2]=q}return R}finally{k.close()}}))}let rt,be;const Ie="AbortError";function et(){return new Error(Ie)}const at={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function mt(a){return at.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Ct="global-dispatcher";class Ot extends Error{constructor(n,c,m,x){super(`AJAXError: ${c} (${n}): ${m}`),this.status=n,this.statusText=c,this.url=m,this.body=x}}const Kt=()=>St(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,_i=function(a,n){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const m=mt(a.url);if(m)return m(a,n);if(St(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Ct},n)}if(!(/^file:/.test(c=a.url)||/^file:/.test(Kt())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(m,x){return d(this,void 0,void 0,(function*(){const k=new Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,cache:m.cache,referrer:Kt(),signal:x.signal});m.type!=="json"||k.headers.has("Accept")||k.headers.set("Accept","application/json");const C=yield fetch(k);if(!C.ok){const F=yield C.blob();throw new Ot(C.status,C.statusText,m.url,F)}let j;j=m.type==="arrayBuffer"||m.type==="image"?C.arrayBuffer():m.type==="json"?C.json():C.text();const R=yield j;if(x.signal.aborted)throw et();return{data:R,cacheControl:C.headers.get("Cache-Control"),expires:C.headers.get("Expires")}}))})(a,n);if(St(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Ct},n)}var c;return(function(m,x){return new Promise(((k,C)=>{var j;const R=new XMLHttpRequest;R.open(m.method||"GET",m.url,!0),m.type!=="arrayBuffer"&&m.type!=="image"||(R.responseType="arraybuffer");for(const F in m.headers)R.setRequestHeader(F,m.headers[F]);m.type==="json"&&(R.responseType="text",!((j=m.headers)===null||j===void 0)&&j.Accept||R.setRequestHeader("Accept","application/json")),R.withCredentials=m.credentials==="include",R.onerror=()=>{C(new Error(R.statusText))},R.onload=()=>{if(!x.signal.aborted)if((R.status>=200&&R.status<300||R.status===0)&&R.response!==null){let F=R.response;if(m.type==="json")try{F=JSON.parse(R.response)}catch(q){return void C(q)}k({data:F,cacheControl:R.getResponseHeader("Cache-Control"),expires:R.getResponseHeader("Expires")})}else{const F=new Blob([R.response],{type:R.getResponseHeader("Content-Type")});C(new Ot(R.status,R.statusText,m.url,F))}},x.signal.addEventListener("abort",(()=>{R.abort(),C(et())})),R.send(m.body)}))})(a,n)};function Vi(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const n=new URL(a),c=window.location;return n.protocol===c.protocol&&n.host===c.host}function gi(a,n,c){c[a]&&c[a].indexOf(n)!==-1||(c[a]=c[a]||[],c[a].push(n))}function Oi(a,n,c){if(c&&c[a]){const m=c[a].indexOf(n);m!==-1&&c[a].splice(m,1)}}class xn{constructor(n,c={}){ze(this,c),this.type=n}}class cn extends xn{constructor(n,c={}){super("error",ze({error:n},c))}}class Zn{on(n,c){return this._listeners=this._listeners||{},gi(n,c,this._listeners),this}off(n,c){return Oi(n,c,this._listeners),Oi(n,c,this._oneTimeListeners),this}once(n,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},gi(n,c,this._oneTimeListeners),this):new Promise((m=>this.once(n,m)))}fire(n,c){typeof n=="string"&&(n=new xn(n,c||{}));const m=n.type;if(this.listens(m)){n.target=this;const x=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const j of x)j.call(this,n);const k=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const j of k)Oi(m,j,this._oneTimeListeners),j.call(this,n);const C=this._eventedParent;C&&(ze(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(n))}else n instanceof cn&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,c){return this._eventedParent=n,this._eventedParentData=c,this}}var tt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Xn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Pn(a,n){const c={};for(const m in a)m!=="ref"&&(c[m]=a[m]);return Xn.forEach((m=>{m in n&&(c[m]=n[m])})),c}function ki(a,n){if(Array.isArray(a)){if(!Array.isArray(n)||a.length!==n.length)return!1;for(let c=0;c<a.length;c++)if(!ki(a[c],n[c]))return!1;return!0}if(typeof a=="object"&&a!==null&&n!==null){if(typeof n!="object"||Object.keys(a).length!==Object.keys(n).length)return!1;for(const c in a)if(!ki(a[c],n[c]))return!1;return!0}return a===n}function yi(a,n){a.push(n)}function Cn(a,n,c){yi(c,{command:"addSource",args:[a,n[a]]})}function Ln(a,n,c){yi(n,{command:"removeSource",args:[a]}),c[a]=!0}function us(a,n,c,m){Ln(a,c,m),Cn(a,n,c)}function an(a,n,c){let m;for(m in a[c])if(Object.prototype.hasOwnProperty.call(a[c],m)&&m!=="data"&&!ki(a[c][m],n[c][m]))return!1;for(m in n[c])if(Object.prototype.hasOwnProperty.call(n[c],m)&&m!=="data"&&!ki(a[c][m],n[c][m]))return!1;return!0}function en(a,n,c,m,x,k){a=a||{},n=n||{};for(const C in a)Object.prototype.hasOwnProperty.call(a,C)&&(ki(a[C],n[C])||c.push({command:k,args:[m,C,n[C],x]}));for(const C in n)Object.prototype.hasOwnProperty.call(n,C)&&!Object.prototype.hasOwnProperty.call(a,C)&&(ki(a[C],n[C])||c.push({command:k,args:[m,C,n[C],x]}))}function qi(a){return a.id}function Fn(a,n){return a[n.id]=n,a}class Tt{constructor(n,c,m,x){this.message=(n?`${n}: `:"")+m,x&&(this.identifier=x),c!=null&&c.__line__&&(this.line=c.__line__)}}function On(a,...n){for(const c of n)for(const m in c)a[m]=c[m];return a}class dn extends Error{constructor(n,c){super(c),this.message=c,this.key=n}}class An{constructor(n,c=[]){this.parent=n,this.bindings={};for(const[m,x]of c)this.bindings[m]=x}concat(n){return new An(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Kn={kind:"null"},It={kind:"number"},ai={kind:"string"},ti={kind:"boolean"},Ji={kind:"color"},Nn={kind:"object"},mi={kind:"value"},Bt={kind:"collator"},hi={kind:"formatted"},Ci={kind:"padding"},bi={kind:"resolvedImage"},xe={kind:"variableAnchorOffsetCollection"};function ee(a,n){return{kind:"array",itemType:a,N:n}}function Q(a){if(a.kind==="array"){const n=Q(a.itemType);return typeof a.N=="number"?`array<${n}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${n}>`}return a.kind}const ue=[Kn,It,ai,ti,Ji,hi,Nn,ee(mi),Ci,bi,xe];function we(a,n){if(n.kind==="error")return null;if(a.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!we(a.itemType,n.itemType))&&(typeof a.N!="number"||a.N===n.N))return null}else{if(a.kind===n.kind)return null;if(a.kind==="value"){for(const c of ue)if(!we(c,n))return null}}return`Expected ${Q(a)} but found ${Q(n)} instead.`}function je(a,n){return n.some((c=>c.kind===a.kind))}function Oe(a,n){return n.some((c=>c==="null"?a===null:c==="array"?Array.isArray(a):c==="object"?a&&!Array.isArray(a)&&typeof a=="object":c===typeof a))}function qe(a,n){return a.kind==="array"&&n.kind==="array"?a.itemType.kind===n.itemType.kind&&typeof a.N=="number":a.kind===n.kind}const de=.96422,Je=.82521,ct=4/29,Ye=6/29,nt=3*Ye*Ye,ei=Ye*Ye*Ye,si=Math.PI/180,$t=180/Math.PI;function At(a){return(a%=360)<0&&(a+=360),a}function ni([a,n,c,m]){let x,k;const C=Bi((.2225045*(a=vi(a))+.7168786*(n=vi(n))+.0606169*(c=vi(c)))/1);a===n&&n===c?x=k=C:(x=Bi((.4360747*a+.3850649*n+.1430804*c)/de),k=Bi((.0139322*a+.0971045*n+.7141733*c)/Je));const j=116*C-16;return[j<0?0:j,500*(x-C),200*(C-k),m]}function vi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Bi(a){return a>ei?Math.pow(a,1/3):a/nt+ct}function _t([a,n,c,m]){let x=(a+16)/116,k=isNaN(n)?x:x+n/500,C=isNaN(c)?x:x-c/200;return x=1*Wt(x),k=de*Wt(k),C=Je*Wt(C),[xt(3.1338561*k-1.6168667*x-.4906146*C),xt(-.9787684*k+1.9161415*x+.033454*C),xt(.0719453*k-.2289914*x+1.4052427*C),m]}function xt(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Wt(a){return a>Ye?a*a*a:nt*(a-ct)}function pi(a){return parseInt(a.padEnd(2,a),16)/255}function Ne(a,n){return zt(n?a/100:a,0,1)}function zt(a,n,c){return Math.min(Math.max(n,a),c)}function Jt(a){return!a.some(Number.isNaN)}const Ki={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class wi{constructor(n,c,m,x=1,k=!0){this.r=n,this.g=c,this.b=m,this.a=x,k||(this.r*=x,this.g*=x,this.b*=x,x||this.overwriteGetter("rgb",[n,c,m,x]))}static parse(n){if(n instanceof wi)return n;if(typeof n!="string")return;const c=(function(m){if((m=m.toLowerCase().trim())==="transparent")return[0,0,0,0];const x=Ki[m];if(x){const[C,j,R]=x;return[C/255,j/255,R/255,1]}if(m.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(m)){const C=m.length<6?1:2;let j=1;return[pi(m.slice(j,j+=C)),pi(m.slice(j,j+=C)),pi(m.slice(j,j+=C)),pi(m.slice(j,j+C)||"ff")]}if(m.startsWith("rgb")){const C=m.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[j,R,F,q,G,J,re,ce,he,Ee,Ae,Xe]=C,De=[q||" ",re||" ",Ee].join("");if(De==="  "||De==="  /"||De===",,"||De===",,,"){const Ge=[F,J,he].join(""),pt=Ge==="%%%"?100:Ge===""?255:0;if(pt){const Dt=[zt(+R/pt,0,1),zt(+G/pt,0,1),zt(+ce/pt,0,1),Ae?Ne(+Ae,Xe):1];if(Jt(Dt))return Dt}}return}}const k=m.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[C,j,R,F,q,G,J,re,ce]=k,he=[R||" ",q||" ",J].join("");if(he==="  "||he==="  /"||he===",,"||he===",,,"){const Ee=[+j,zt(+F,0,100),zt(+G,0,100),re?Ne(+re,ce):1];if(Jt(Ee))return(function([Ae,Xe,De,Ge]){function pt(Dt){const Qt=(Dt+Ae/30)%12,Ai=Xe*Math.min(De,1-De);return De-Ai*Math.max(-1,Math.min(Qt-3,9-Qt,1))}return Ae=At(Ae),Xe/=100,De/=100,[pt(0),pt(8),pt(4),Ge]})(Ee)}}})(n);return c?new wi(...c,!1):void 0}get rgb(){const{r:n,g:c,b:m,a:x}=this,k=x||1/0;return this.overwriteGetter("rgb",[n/k,c/k,m/k,x])}get hcl(){return this.overwriteGetter("hcl",(function(n){const[c,m,x,k]=ni(n),C=Math.sqrt(m*m+x*x);return[Math.round(1e4*C)?At(Math.atan2(x,m)*$t):NaN,C,c,k]})(this.rgb))}get lab(){return this.overwriteGetter("lab",ni(this.rgb))}overwriteGetter(n,c){return Object.defineProperty(this,n,{value:c}),c}toString(){const[n,c,m,x]=this.rgb;return`rgba(${[n,c,m].map((k=>Math.round(255*k))).join(",")},${x})`}}wi.black=new wi(0,0,0,1),wi.white=new wi(1,1,1,1),wi.transparent=new wi(0,0,0,0),wi.red=new wi(1,0,0,1);class vn{constructor(n,c,m){this.sensitivity=n?c?"variant":"case":c?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,c){return this.collator.compare(n,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class gr{constructor(n,c,m,x,k){this.text=n,this.image=c,this.scale=m,this.fontStack=x,this.textColor=k}}class Ys{constructor(n){this.sections=n}static fromString(n){return new Ys([new gr(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((n=>n.text.length!==0||n.image&&n.image.name.length!==0))}static factory(n){return n instanceof Ys?n:Ys.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map((n=>n.text)).join("")}}class zs{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof zs)return n;if(typeof n=="number")return new zs([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const c of n)if(typeof c!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new zs(n)}}toString(){return JSON.stringify(this.values)}}const Eo=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ir{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof ir)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let c=0;c<n.length;c+=2){const m=n[c],x=n[c+1];if(typeof m!="string"||!Eo.has(m)||!Array.isArray(x)||x.length!==2||typeof x[0]!="number"||typeof x[1]!="number")return}return new ir(n)}}toString(){return JSON.stringify(this.values)}}class yr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new yr({name:n,available:!1}):null}}function ko(a,n,c,m){return typeof a=="number"&&a>=0&&a<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof c=="number"&&c>=0&&c<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[a,n,c,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[a,n,c,m]:[a,n,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _a(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof wi||a instanceof vn||a instanceof Ys||a instanceof zs||a instanceof ir||a instanceof yr)return!0;if(Array.isArray(a)){for(const n of a)if(!_a(n))return!1;return!0}if(typeof a=="object"){for(const n in a)if(!_a(a[n]))return!1;return!0}return!1}function Pi(a){if(a===null)return Kn;if(typeof a=="string")return ai;if(typeof a=="boolean")return ti;if(typeof a=="number")return It;if(a instanceof wi)return Ji;if(a instanceof vn)return Bt;if(a instanceof Ys)return hi;if(a instanceof zs)return Ci;if(a instanceof ir)return xe;if(a instanceof yr)return bi;if(Array.isArray(a)){const n=a.length;let c;for(const m of a){const x=Pi(m);if(c){if(c===x)continue;c=mi;break}c=x}return ee(c||mi,n)}return Nn}function zn(a){const n=typeof a;return a===null?"":n==="string"||n==="number"||n==="boolean"?String(a):a instanceof wi||a instanceof Ys||a instanceof zs||a instanceof ir||a instanceof yr?a.toString():JSON.stringify(a)}class ys{constructor(n,c){this.type=n,this.value=c}static parse(n,c){if(n.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!_a(n[1]))return c.error("invalid value");const m=n[1];let x=Pi(m);const k=c.expectedType;return x.kind!=="array"||x.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(x=k),new ys(x,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class fn{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Ra={string:ai,number:It,boolean:ti,object:Nn};class Br{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");let m,x=1;const k=n[0];if(k==="array"){let j,R;if(n.length>2){const F=n[1];if(typeof F!="string"||!(F in Ra)||F==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);j=Ra[F],x++}else j=mi;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return c.error('The length argument to "array" must be a positive integer literal',2);R=n[2],x++}m=ee(j,R)}else{if(!Ra[k])throw new Error(`Types doesn't contain name = ${k}`);m=Ra[k]}const C=[];for(;x<n.length;x++){const j=c.parse(n[x],x,mi);if(!j)return null;C.push(j)}return new Br(m,C)}evaluate(n){for(let c=0;c<this.args.length;c++){const m=this.args[c].evaluate(n);if(!we(this.type,Pi(m)))return m;if(c===this.args.length-1)throw new fn(`Expected value to be of type ${Q(this.type)}, but found ${Q(Pi(m))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const Hi={"to-boolean":ti,"to-color":Ji,"to-number":It,"to-string":ai};class In{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");const m=n[0];if(!Hi[m])throw new Error(`Can't parse ${m} as it is not part of the known types`);if((m==="to-boolean"||m==="to-string")&&n.length!==2)return c.error("Expected one argument.");const x=Hi[m],k=[];for(let C=1;C<n.length;C++){const j=c.parse(n[C],C,mi);if(!j)return null;k.push(j)}return new In(x,k)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let c,m;for(const x of this.args){if(c=x.evaluate(n),m=null,c instanceof wi)return c;if(typeof c=="string"){const k=n.parseColor(c);if(k)return k}else if(Array.isArray(c)&&(m=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:ko(c[0],c[1],c[2],c[3]),!m))return new wi(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new fn(m||`Could not parse color from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"padding":{let c;for(const m of this.args){c=m.evaluate(n);const x=zs.parse(c);if(x)return x}throw new fn(`Could not parse padding from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"variableAnchorOffsetCollection":{let c;for(const m of this.args){c=m.evaluate(n);const x=ir.parse(c);if(x)return x}throw new fn(`Could not parse variableAnchorOffsetCollection from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"number":{let c=null;for(const m of this.args){if(c=m.evaluate(n),c===null)return 0;const x=Number(c);if(!isNaN(x))return x}throw new fn(`Could not convert ${JSON.stringify(c)} to number.`)}case"formatted":return Ys.fromString(zn(this.args[0].evaluate(n)));case"resolvedImage":return yr.fromString(zn(this.args[0].evaluate(n)));default:return zn(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const Il=["Unknown","Point","LineString","Polygon"];class Wo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Il[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let c=this._parseColorCache[n];return c||(c=this._parseColorCache[n]=wi.parse(n)),c}}class Bn{constructor(n,c,m=[],x,k=new An,C=[]){this.registry=n,this.path=m,this.key=m.map((j=>`[${j}]`)).join(""),this.scope=k,this.errors=C,this.expectedType=x,this._isConstant=c}parse(n,c,m,x,k={}){return c?this.concat(c,m,x)._parse(n,k):this._parse(n,k)}_parse(n,c){function m(x,k,C){return C==="assert"?new Br(k,[x]):C==="coerce"?new In(k,[x]):x}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const x=n[0];if(typeof x!="string")return this.error(`Expression name must be a string, but found ${typeof x} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[x];if(k){let C=k.parse(n,this);if(!C)return null;if(this.expectedType){const j=this.expectedType,R=C.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||R.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||R.kind!=="value"&&R.kind!=="string")if(j.kind!=="padding"||R.kind!=="value"&&R.kind!=="number"&&R.kind!=="array")if(j.kind!=="variableAnchorOffsetCollection"||R.kind!=="value"&&R.kind!=="array"){if(this.checkSubtype(j,R))return null}else C=m(C,j,c.typeAnnotation||"coerce");else C=m(C,j,c.typeAnnotation||"coerce");else C=m(C,j,c.typeAnnotation||"coerce");else C=m(C,j,c.typeAnnotation||"assert")}if(!(C instanceof ys)&&C.type.kind!=="resolvedImage"&&this._isConstant(C)){const j=new Wo;try{C=new ys(C.type,C.evaluate(j))}catch(R){return this.error(R.message),null}}return C}return this.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,c,m){const x=typeof n=="number"?this.path.concat(n):this.path,k=m?this.scope.concat(m):this.scope;return new Bn(this.registry,this._isConstant,x,c||null,k,this.errors)}error(n,...c){const m=`${this.key}${c.map((x=>`[${x}]`)).join("")}`;this.errors.push(new dn(m,n))}checkSubtype(n,c){const m=we(n,c);return m&&this.error(m),m}}class Da{constructor(n,c){this.type=c.type,this.bindings=[].concat(n),this.result=c}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const c of this.bindings)n(c[1]);n(this.result)}static parse(n,c){if(n.length<4)return c.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const m=[];for(let k=1;k<n.length-1;k+=2){const C=n[k];if(typeof C!="string")return c.error(`Expected string, but found ${typeof C} instead.`,k);if(/[^a-zA-Z0-9_]/.test(C))return c.error("Variable names must contain only alphanumeric characters or '_'.",k);const j=c.parse(n[k+1],k+1);if(!j)return null;m.push([C,j])}const x=c.parse(n[n.length-1],n.length-1,c.expectedType,m);return x?new Da(m,x):null}outputDefined(){return this.result.outputDefined()}}class pn{constructor(n,c){this.type=c.type,this.name=n,this.boundExpression=c}static parse(n,c){if(n.length!==2||typeof n[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const m=n[1];return c.scope.has(m)?new pn(m,c.scope.get(m)):c.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class va{constructor(n,c,m){this.type=n,this.index=c,this.input=m}static parse(n,c){if(n.length!==3)return c.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,It),x=c.parse(n[2],2,ee(c.expectedType||mi));return m&&x?new va(x.type.itemType,m,x):null}evaluate(n){const c=this.index.evaluate(n),m=this.input.evaluate(n);if(c<0)throw new fn(`Array index out of bounds: ${c} < 0.`);if(c>=m.length)throw new fn(`Array index out of bounds: ${c} > ${m.length-1}.`);if(c!==Math.floor(c))throw new fn(`Array index must be an integer, but found ${c} instead.`);return m[c]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Gn{constructor(n,c){this.type=ti,this.needle=n,this.haystack=c}static parse(n,c){if(n.length!==3)return c.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,mi),x=c.parse(n[2],2,mi);return m&&x?je(m.type,[ti,ai,It,Kn,mi])?new Gn(m,x):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(m.type)} instead`):null}evaluate(n){const c=this.needle.evaluate(n),m=this.haystack.evaluate(n);if(!m)return!1;if(!Oe(c,["boolean","string","number","null"]))throw new fn(`Expected first argument to be of type boolean, string, number or null, but found ${Q(Pi(c))} instead.`);if(!Oe(m,["string","array"]))throw new fn(`Expected second argument to be of type array or string, but found ${Q(Pi(m))} instead.`);return m.indexOf(c)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class $r{constructor(n,c,m){this.type=It,this.needle=n,this.haystack=c,this.fromIndex=m}static parse(n,c){if(n.length<=2||n.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,mi),x=c.parse(n[2],2,mi);if(!m||!x)return null;if(!je(m.type,[ti,ai,It,Kn,mi]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(m.type)} instead`);if(n.length===4){const k=c.parse(n[3],3,It);return k?new $r(m,x,k):null}return new $r(m,x)}evaluate(n){const c=this.needle.evaluate(n),m=this.haystack.evaluate(n);if(!Oe(c,["boolean","string","number","null"]))throw new fn(`Expected first argument to be of type boolean, string, number or null, but found ${Q(Pi(c))} instead.`);let x;if(this.fromIndex&&(x=this.fromIndex.evaluate(n)),Oe(m,["string"])){const k=m.indexOf(c,x);return k===-1?-1:[...m.slice(0,k)].length}if(Oe(m,["array"]))return m.indexOf(c,x);throw new fn(`Expected second argument to be of type array or string, but found ${Q(Pi(m))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Co{constructor(n,c,m,x,k,C){this.inputType=n,this.type=c,this.input=m,this.cases=x,this.outputs=k,this.otherwise=C}static parse(n,c){if(n.length<5)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return c.error("Expected an even number of arguments.");let m,x;c.expectedType&&c.expectedType.kind!=="value"&&(x=c.expectedType);const k={},C=[];for(let F=2;F<n.length-1;F+=2){let q=n[F];const G=n[F+1];Array.isArray(q)||(q=[q]);const J=c.concat(F);if(q.length===0)return J.error("Expected at least one branch label.");for(const ce of q){if(typeof ce!="number"&&typeof ce!="string")return J.error("Branch labels must be numbers or strings.");if(typeof ce=="number"&&Math.abs(ce)>Number.MAX_SAFE_INTEGER)return J.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ce=="number"&&Math.floor(ce)!==ce)return J.error("Numeric branch labels must be integer values.");if(m){if(J.checkSubtype(m,Pi(ce)))return null}else m=Pi(ce);if(k[String(ce)]!==void 0)return J.error("Branch labels must be unique.");k[String(ce)]=C.length}const re=c.parse(G,F,x);if(!re)return null;x=x||re.type,C.push(re)}const j=c.parse(n[1],1,mi);if(!j)return null;const R=c.parse(n[n.length-1],n.length-1,x);return R?j.type.kind!=="value"&&c.concat(1).checkSubtype(m,j.type)?null:new Co(m,x,j,k,C,R):null}evaluate(n){const c=this.input.evaluate(n);return(Pi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))&&this.otherwise.outputDefined()}}class Ur{constructor(n,c,m){this.type=n,this.branches=c,this.otherwise=m}static parse(n,c){if(n.length<4)return c.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return c.error("Expected an odd number of arguments.");let m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const x=[];for(let C=1;C<n.length-1;C+=2){const j=c.parse(n[C],C,ti);if(!j)return null;const R=c.parse(n[C+1],C+1,m);if(!R)return null;x.push([j,R]),m=m||R.type}const k=c.parse(n[n.length-1],n.length-1,m);if(!k)return null;if(!m)throw new Error("Can't infer output type");return new Ur(m,x,k)}evaluate(n){for(const[c,m]of this.branches)if(c.evaluate(n))return m.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[c,m]of this.branches)n(c),n(m);n(this.otherwise)}outputDefined(){return this.branches.every((([n,c])=>c.outputDefined()))&&this.otherwise.outputDefined()}}class Yo{constructor(n,c,m,x){this.type=n,this.input=c,this.beginIndex=m,this.endIndex=x}static parse(n,c){if(n.length<=2||n.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const m=c.parse(n[1],1,mi),x=c.parse(n[2],2,It);if(!m||!x)return null;if(!je(m.type,[ee(mi),ai,mi]))return c.error(`Expected first argument to be of type array or string, but found ${Q(m.type)} instead`);if(n.length===4){const k=c.parse(n[3],3,It);return k?new Yo(m.type,m,x,k):null}return new Yo(m.type,m,x)}evaluate(n){const c=this.input.evaluate(n),m=this.beginIndex.evaluate(n);let x;if(this.endIndex&&(x=this.endIndex.evaluate(n)),Oe(c,["string"]))return[...c].slice(m,x).join("");if(Oe(c,["array"]))return c.slice(m,x);throw new fn(`Expected first argument to be of type array or string, but found ${Q(Pi(c))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function ro(a,n){const c=a.length-1;let m,x,k=0,C=c,j=0;for(;k<=C;)if(j=Math.floor((k+C)/2),m=a[j],x=a[j+1],m<=n){if(j===c||n<x)return j;k=j+1}else{if(!(m>n))throw new fn("Input is not a number.");C=j-1}return 0}class ao{constructor(n,c,m){this.type=n,this.input=c,this.labels=[],this.outputs=[];for(const[x,k]of m)this.labels.push(x),this.outputs.push(k)}static parse(n,c){if(n.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return c.error("Expected an even number of arguments.");const m=c.parse(n[1],1,It);if(!m)return null;const x=[];let k=null;c.expectedType&&c.expectedType.kind!=="value"&&(k=c.expectedType);for(let C=1;C<n.length;C+=2){const j=C===1?-1/0:n[C],R=n[C+1],F=C,q=C+1;if(typeof j!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(x.length&&x[x.length-1][0]>=j)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const G=c.parse(R,q,k);if(!G)return null;k=k||G.type,x.push([j,G])}return new ao(k,m,x)}evaluate(n){const c=this.labels,m=this.outputs;if(c.length===1)return m[0].evaluate(n);const x=this.input.evaluate(n);if(x<=c[0])return m[0].evaluate(n);const k=c.length;return x>=c[k-1]?m[k-1].evaluate(n):m[ro(c,x)].evaluate(n)}eachChild(n){n(this.input);for(const c of this.outputs)n(c)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function jl(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ic=jc;function jc(a,n,c,m){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=n,this.p2x=c,this.p2y=m}jc.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,n){if(n===void 0&&(n=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,m=0;m<8;m++){var x=this.sampleCurveX(c)-a;if(Math.abs(x)<n)return c;var k=this.sampleCurveDerivativeX(c);if(Math.abs(k)<1e-6)break;c-=x/k}var C=0,j=1;for(c=a,m=0;m<20&&(x=this.sampleCurveX(c),!(Math.abs(x-a)<n));m++)a>x?C=c:j=c,c=.5*(j-C)+C;return c},solve:function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))}};var Ll=jl(Ic);function $s(a,n,c){return a+c*(n-a)}function Ao(a,n,c){return a.map(((m,x)=>$s(m,n[x],c)))}const Us={number:$s,color:function(a,n,c,m="rgb"){switch(m){case"rgb":{const[x,k,C,j]=Ao(a.rgb,n.rgb,c);return new wi(x,k,C,j,!1)}case"hcl":{const[x,k,C,j]=a.hcl,[R,F,q,G]=n.hcl;let J,re;if(isNaN(x)||isNaN(R))isNaN(x)?isNaN(R)?J=NaN:(J=R,C!==1&&C!==0||(re=F)):(J=x,q!==1&&q!==0||(re=k));else{let Xe=R-x;R>x&&Xe>180?Xe-=360:R<x&&x-R>180&&(Xe+=360),J=x+c*Xe}const[ce,he,Ee,Ae]=(function([Xe,De,Ge,pt]){return Xe=isNaN(Xe)?0:Xe*si,_t([Ge,Math.cos(Xe)*De,Math.sin(Xe)*De,pt])})([J,re??$s(k,F,c),$s(C,q,c),$s(j,G,c)]);return new wi(ce,he,Ee,Ae,!1)}case"lab":{const[x,k,C,j]=_t(Ao(a.lab,n.lab,c));return new wi(x,k,C,j,!1)}}},array:Ao,padding:function(a,n,c){return new zs(Ao(a.values,n.values,c))},variableAnchorOffsetCollection:function(a,n,c){const m=a.values,x=n.values;if(m.length!==x.length)throw new fn(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${n.toString()}`);const k=[];for(let C=0;C<m.length;C+=2){if(m[C]!==x[C])throw new fn(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${m[C]}, to[${C}]: ${x[C]}`);k.push(m[C]);const[j,R]=m[C+1],[F,q]=x[C+1];k.push([$s(j,F,c),$s(R,q,c)])}return new ir(k)}};class Rs{constructor(n,c,m,x,k){this.type=n,this.operator=c,this.interpolation=m,this.input=x,this.labels=[],this.outputs=[];for(const[C,j]of k)this.labels.push(C),this.outputs.push(j)}static interpolationFactor(n,c,m,x){let k=0;if(n.name==="exponential")k=Di(c,n.base,m,x);else if(n.name==="linear")k=Di(c,1,m,x);else if(n.name==="cubic-bezier"){const C=n.controlPoints;k=new Ll(C[0],C[1],C[2],C[3]).solve(Di(c,1,m,x))}return k}static parse(n,c){let[m,x,k,...C]=n;if(!Array.isArray(x)||x.length===0)return c.error("Expected an interpolation type expression.",1);if(x[0]==="linear")x={name:"linear"};else if(x[0]==="exponential"){const F=x[1];if(typeof F!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);x={name:"exponential",base:F}}else{if(x[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(x[0])}`,1,0);{const F=x.slice(1);if(F.length!==4||F.some((q=>typeof q!="number"||q<0||q>1)))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);x={name:"cubic-bezier",controlPoints:F}}}if(n.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(k=c.parse(k,2,It),!k)return null;const j=[];let R=null;m==="interpolate-hcl"||m==="interpolate-lab"?R=Ji:c.expectedType&&c.expectedType.kind!=="value"&&(R=c.expectedType);for(let F=0;F<C.length;F+=2){const q=C[F],G=C[F+1],J=F+3,re=F+4;if(typeof q!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',J);if(j.length&&j[j.length-1][0]>=q)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',J);const ce=c.parse(G,re,R);if(!ce)return null;R=R||ce.type,j.push([q,ce])}return qe(R,It)||qe(R,Ji)||qe(R,Ci)||qe(R,xe)||qe(R,ee(It))?new Rs(R,m,x,k,j):c.error(`Type ${Q(R)} is not interpolatable.`)}evaluate(n){const c=this.labels,m=this.outputs;if(c.length===1)return m[0].evaluate(n);const x=this.input.evaluate(n);if(x<=c[0])return m[0].evaluate(n);const k=c.length;if(x>=c[k-1])return m[k-1].evaluate(n);const C=ro(c,x),j=Rs.interpolationFactor(this.interpolation,x,c[C],c[C+1]),R=m[C].evaluate(n),F=m[C+1].evaluate(n);switch(this.operator){case"interpolate":return Us[this.type.kind](R,F,j);case"interpolate-hcl":return Us.color(R,F,j,"hcl");case"interpolate-lab":return Us.color(R,F,j,"lab")}}eachChild(n){n(this.input);for(const c of this.outputs)n(c)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function Di(a,n,c,m){const x=m-c,k=a-c;return x===0?0:n===1?k/x:(Math.pow(n,k)-1)/(Math.pow(n,x)-1)}class Mr{constructor(n,c){this.type=n,this.args=c}static parse(n,c){if(n.length<2)return c.error("Expectected at least one argument.");let m=null;const x=c.expectedType;x&&x.kind!=="value"&&(m=x);const k=[];for(const j of n.slice(1)){const R=c.parse(j,1+k.length,m,void 0,{typeAnnotation:"omit"});if(!R)return null;m=m||R.type,k.push(R)}if(!m)throw new Error("No output type");const C=x&&k.some((j=>we(x,j.type)));return new Mr(C?mi:m,k)}evaluate(n){let c,m=null,x=0;for(const k of this.args)if(x++,m=k.evaluate(n),m&&m instanceof yr&&!m.available&&(c||(c=m.name),m=null,x===this.args.length&&(m=c)),m!==null)break;return m}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}function jn(a,n){return a==="=="||a==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Lc(a,n,c,m){return m.compare(n,c)===0}function ia(a,n,c){const m=a!=="=="&&a!=="!=";return class o2{constructor(k,C,j){this.type=ti,this.lhs=k,this.rhs=C,this.collator=j,this.hasUntypedArgument=k.type.kind==="value"||C.type.kind==="value"}static parse(k,C){if(k.length!==3&&k.length!==4)return C.error("Expected two or three arguments.");const j=k[0];let R=C.parse(k[1],1,mi);if(!R)return null;if(!jn(j,R.type))return C.concat(1).error(`"${j}" comparisons are not supported for type '${Q(R.type)}'.`);let F=C.parse(k[2],2,mi);if(!F)return null;if(!jn(j,F.type))return C.concat(2).error(`"${j}" comparisons are not supported for type '${Q(F.type)}'.`);if(R.type.kind!==F.type.kind&&R.type.kind!=="value"&&F.type.kind!=="value")return C.error(`Cannot compare types '${Q(R.type)}' and '${Q(F.type)}'.`);m&&(R.type.kind==="value"&&F.type.kind!=="value"?R=new Br(F.type,[R]):R.type.kind!=="value"&&F.type.kind==="value"&&(F=new Br(R.type,[F])));let q=null;if(k.length===4){if(R.type.kind!=="string"&&F.type.kind!=="string"&&R.type.kind!=="value"&&F.type.kind!=="value")return C.error("Cannot use collator to compare non-string types.");if(q=C.parse(k[3],3,Bt),!q)return null}return new o2(R,F,q)}evaluate(k){const C=this.lhs.evaluate(k),j=this.rhs.evaluate(k);if(m&&this.hasUntypedArgument){const R=Pi(C),F=Pi(j);if(R.kind!==F.kind||R.kind!=="string"&&R.kind!=="number")throw new fn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${R.kind}, ${F.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const R=Pi(C),F=Pi(j);if(R.kind!=="string"||F.kind!=="string")return n(k,C,j)}return this.collator?c(k,C,j,this.collator.evaluate(k)):n(k,C,j)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const xa=ia("==",(function(a,n,c){return n===c}),Lc),zl=ia("!=",(function(a,n,c){return n!==c}),(function(a,n,c,m){return!Lc(0,n,c,m)})),na=ia("<",(function(a,n,c){return n<c}),(function(a,n,c,m){return m.compare(n,c)<0})),Oa=ia(">",(function(a,n,c){return n>c}),(function(a,n,c,m){return m.compare(n,c)>0})),Xo=ia("<=",(function(a,n,c){return n<=c}),(function(a,n,c,m){return m.compare(n,c)<=0})),xs=ia(">=",(function(a,n,c){return n>=c}),(function(a,n,c,m){return m.compare(n,c)>=0}));class sa{constructor(n,c,m){this.type=Bt,this.locale=m,this.caseSensitive=n,this.diacriticSensitive=c}static parse(n,c){if(n.length!==2)return c.error("Expected one argument.");const m=n[1];if(typeof m!="object"||Array.isArray(m))return c.error("Collator options argument must be an object.");const x=c.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,ti);if(!x)return null;const k=c.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,ti);if(!k)return null;let C=null;return m.locale&&(C=c.parse(m.locale,1,ai),!C)?null:new sa(x,k,C)}evaluate(n){return new vn(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Ko{constructor(n,c,m,x,k){this.type=ai,this.number=n,this.locale=c,this.currency=m,this.minFractionDigits=x,this.maxFractionDigits=k}static parse(n,c){if(n.length!==3)return c.error("Expected two arguments.");const m=c.parse(n[1],1,It);if(!m)return null;const x=n[2];if(typeof x!="object"||Array.isArray(x))return c.error("NumberFormat options argument must be an object.");let k=null;if(x.locale&&(k=c.parse(x.locale,1,ai),!k))return null;let C=null;if(x.currency&&(C=c.parse(x.currency,1,ai),!C))return null;let j=null;if(x["min-fraction-digits"]&&(j=c.parse(x["min-fraction-digits"],1,It),!j))return null;let R=null;return x["max-fraction-digits"]&&(R=c.parse(x["max-fraction-digits"],1,It),!R)?null:new Ko(m,k,C,j,R)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Mo{constructor(n){this.type=hi,this.sections=n}static parse(n,c){if(n.length<2)return c.error("Expected at least one argument.");const m=n[1];if(!Array.isArray(m)&&typeof m=="object")return c.error("First argument must be an image or text section.");const x=[];let k=!1;for(let C=1;C<=n.length-1;++C){const j=n[C];if(k&&typeof j=="object"&&!Array.isArray(j)){k=!1;let R=null;if(j["font-scale"]&&(R=c.parse(j["font-scale"],1,It),!R))return null;let F=null;if(j["text-font"]&&(F=c.parse(j["text-font"],1,ee(ai)),!F))return null;let q=null;if(j["text-color"]&&(q=c.parse(j["text-color"],1,Ji),!q))return null;const G=x[x.length-1];G.scale=R,G.font=F,G.textColor=q}else{const R=c.parse(n[C],1,mi);if(!R)return null;const F=R.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,x.push({content:R,scale:null,font:null,textColor:null})}}return new Mo(x)}evaluate(n){return new Ys(this.sections.map((c=>{const m=c.content.evaluate(n);return Pi(m)===bi?new gr("",m,null,null,null):new gr(zn(m),null,c.scale?c.scale.evaluate(n):null,c.font?c.font.evaluate(n).join(","):null,c.textColor?c.textColor.evaluate(n):null)})))}eachChild(n){for(const c of this.sections)n(c.content),c.scale&&n(c.scale),c.font&&n(c.font),c.textColor&&n(c.textColor)}outputDefined(){return!1}}class zc{constructor(n){this.type=bi,this.input=n}static parse(n,c){if(n.length!==2)return c.error("Expected two arguments.");const m=c.parse(n[1],1,ai);return m?new zc(m):c.error("No image name provided.")}evaluate(n){const c=this.input.evaluate(n),m=yr.fromString(c);return m&&n.availableImages&&(m.available=n.availableImages.indexOf(c)>-1),m}eachChild(n){n(this.input)}outputDefined(){return!1}}class Xs{constructor(n){this.type=It,this.input=n}static parse(n,c){if(n.length!==2)return c.error(`Expected 1 argument, but found ${n.length-1} instead.`);const m=c.parse(n[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Q(m.type)} instead.`):new Xs(m):null}evaluate(n){const c=this.input.evaluate(n);if(typeof c=="string")return[...c].length;if(Array.isArray(c))return c.length;throw new fn(`Expected value to be of type string or array, but found ${Q(Pi(c))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Fs=8192;function Rc(a,n){const c=(180+a[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,x=Math.pow(2,n.z);return[Math.round(c*x*Fs),Math.round(m*x*Fs)]}function Po(a,n){const c=Math.pow(2,n.z);return[(x=(a[0]/Fs+n.x)/c,360*x-180),(m=(a[1]/Fs+n.y)/c,360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90)];var m,x}function tn(a,n){a[0]=Math.min(a[0],n[0]),a[1]=Math.min(a[1],n[1]),a[2]=Math.max(a[2],n[0]),a[3]=Math.max(a[3],n[1])}function Na(a,n){return!(a[0]<=n[0]||a[2]>=n[2]||a[1]<=n[1]||a[3]>=n[3])}function Zi(a,n,c){const m=a[0]-n[0],x=a[1]-n[1],k=a[0]-c[0],C=a[1]-c[1];return m*C-k*x==0&&m*k<=0&&x*C<=0}function ra(a,n,c,m){return(x=[m[0]-c[0],m[1]-c[1]])[0]*(k=[n[0]-a[0],n[1]-a[1]])[1]-x[1]*k[0]!=0&&!(!Dc(a,n,c,m)||!Dc(c,m,a,n));var x,k}function ec(a,n,c){for(const m of c)for(let x=0;x<m.length-1;++x)if(ra(a,n,m[x],m[x+1]))return!0;return!1}function Jo(a,n,c=!1){let m=!1;for(const j of n)for(let R=0;R<j.length-1;R++){if(Zi(a,j[R],j[R+1]))return c;(k=j[R])[1]>(x=a)[1]!=(C=j[R+1])[1]>x[1]&&x[0]<(C[0]-k[0])*(x[1]-k[1])/(C[1]-k[1])+k[0]&&(m=!m)}var x,k,C;return m}function yu(a,n){for(const c of n)if(Jo(a,c))return!0;return!1}function Qu(a,n){for(const c of a)if(!Jo(c,n))return!1;for(let c=0;c<a.length-1;++c)if(ec(a[c],a[c+1],n))return!1;return!0}function eh(a,n){for(const c of n)if(Qu(a,c))return!0;return!1}function Dc(a,n,c,m){const x=m[0]-c[0],k=m[1]-c[1],C=(a[0]-c[0])*k-x*(a[1]-c[1]),j=(n[0]-c[0])*k-x*(n[1]-c[1]);return C>0&&j<0||C<0&&j>0}function _u(a,n,c){const m=[];for(let x=0;x<a.length;x++){const k=[];for(let C=0;C<a[x].length;C++){const j=Rc(a[x][C],c);tn(n,j),k.push(j)}m.push(k)}return m}function Oc(a,n,c){const m=[];for(let x=0;x<a.length;x++){const k=_u(a[x],n,c);m.push(k)}return m}function th(a,n,c,m){if(a[0]<c[0]||a[0]>c[2]){const x=.5*m;let k=a[0]-c[0]>x?-m:c[0]-a[0]>x?m:0;k===0&&(k=a[0]-c[2]>x?-m:c[2]-a[0]>x?m:0),a[0]+=k}tn(n,a)}function ba(a,n,c,m){const x=Math.pow(2,m.z)*Fs,k=[m.x*Fs,m.y*Fs],C=[];for(const j of a)for(const R of j){const F=[R.x+k[0],R.y+k[1]];th(F,n,c,x),C.push(F)}return C}function ih(a,n,c,m){const x=Math.pow(2,m.z)*Fs,k=[m.x*Fs,m.y*Fs],C=[];for(const R of a){const F=[];for(const q of R){const G=[q.x+k[0],q.y+k[1]];tn(n,G),F.push(G)}C.push(F)}if(n[2]-n[0]<=x/2){(j=n)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const R of C)for(const F of R)th(F,n,c,x)}var j;return C}class oo{constructor(n,c){this.type=ti,this.geojson=n,this.geometries=c}static parse(n,c){if(n.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(_a(n[1])){const m=n[1];if(m.type==="FeatureCollection"){const x=[];for(const k of m.features){const{type:C,coordinates:j}=k.geometry;C==="Polygon"&&x.push(j),C==="MultiPolygon"&&x.push(...j)}if(x.length)return new oo(m,{type:"MultiPolygon",coordinates:x})}else if(m.type==="Feature"){const x=m.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new oo(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new oo(m,m)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(c,m){const x=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],C=c.canonicalID();if(m.type==="Polygon"){const j=_u(m.coordinates,k,C),R=ba(c.geometry(),x,k,C);if(!Na(x,k))return!1;for(const F of R)if(!Jo(F,j))return!1}if(m.type==="MultiPolygon"){const j=Oc(m.coordinates,k,C),R=ba(c.geometry(),x,k,C);if(!Na(x,k))return!1;for(const F of R)if(!yu(F,j))return!1}return!0})(n,this.geometries);if(n.geometryType()==="LineString")return(function(c,m){const x=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],C=c.canonicalID();if(m.type==="Polygon"){const j=_u(m.coordinates,k,C),R=ih(c.geometry(),x,k,C);if(!Na(x,k))return!1;for(const F of R)if(!Qu(F,j))return!1}if(m.type==="MultiPolygon"){const j=Oc(m.coordinates,k,C),R=ih(c.geometry(),x,k,C);if(!Na(x,k))return!1;for(const F of R)if(!eh(F,j))return!1}return!0})(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let lo=class{constructor(a=[],n=((c,m)=>c<m?-1:c>m?1:0)){if(this.data=a,this.length=this.data.length,this.compare=n,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:n,compare:c}=this,m=n[a];for(;a>0;){const x=a-1>>1,k=n[x];if(c(m,k)>=0)break;n[a]=k,a=x}n[a]=m}_down(a){const{data:n,compare:c}=this,m=this.length>>1,x=n[a];for(;a<m;){let k=1+(a<<1);const C=k+1;if(C<this.length&&c(n[C],n[k])<0&&(k=C),c(n[k],x)>=0)break;n[a]=n[k],a=k}n[a]=x}};function nh(a,n,c,m,x){vu(a,n,c,m||a.length-1,x||xu)}function vu(a,n,c,m,x){for(;m>c;){if(m-c>600){var k=m-c+1,C=n-c+1,j=Math.log(k),R=.5*Math.exp(2*j/3),F=.5*Math.sqrt(j*R*(k-R)/k)*(C-k/2<0?-1:1);vu(a,n,Math.max(c,Math.floor(n-C*R/k+F)),Math.min(m,Math.floor(n+(k-C)*R/k+F)),x)}var q=a[n],G=c,J=m;for(Qo(a,c,n),x(a[m],q)>0&&Qo(a,c,m);G<J;){for(Qo(a,G,J),G++,J--;x(a[G],q)<0;)G++;for(;x(a[J],q)>0;)J--}x(a[c],q)===0?Qo(a,c,J):Qo(a,++J,m),J<=n&&(c=J+1),n<=J&&(m=J-1)}}function Qo(a,n,c){var m=a[n];a[n]=a[c],a[c]=m}function xu(a,n){return a<n?-1:a>n?1:0}function tc(a,n){if(a.length<=1)return[a];const c=[];let m,x;for(const k of a){const C=Jh(k);C!==0&&(k.area=Math.abs(C),x===void 0&&(x=C<0),x===C<0?(m&&c.push(m),m=[k]):m.push(k))}if(m&&c.push(m),n>1)for(let k=0;k<c.length;k++)c[k].length<=n||(nh(c[k],n,1,c[k].length-1,sh),c[k]=c[k].slice(0,n));return c}function sh(a,n){return n.area-a.area}function Jh(a){let n=0;for(let c,m,x=0,k=a.length,C=k-1;x<k;C=x++)c=a[x],m=a[C],n+=(m.x-c.x)*(c.y+m.y);return n}const bu=1/298.257223563,Nc=bu*(2-bu),rh=Math.PI/180;class Bc{constructor(n){const c=6378.137*rh*1e3,m=Math.cos(n*rh),x=1/(1-Nc*(1-m*m)),k=Math.sqrt(x);this.kx=c*k*m,this.ky=c*k*x*(1-Nc)}distance(n,c){const m=this.wrap(n[0]-c[0])*this.kx,x=(n[1]-c[1])*this.ky;return Math.sqrt(m*m+x*x)}pointOnLine(n,c){let m,x,k,C,j=1/0;for(let R=0;R<n.length-1;R++){let F=n[R][0],q=n[R][1],G=this.wrap(n[R+1][0]-F)*this.kx,J=(n[R+1][1]-q)*this.ky,re=0;G===0&&J===0||(re=(this.wrap(c[0]-F)*this.kx*G+(c[1]-q)*this.ky*J)/(G*G+J*J),re>1?(F=n[R+1][0],q=n[R+1][1]):re>0&&(F+=G/this.kx*re,q+=J/this.ky*re)),G=this.wrap(c[0]-F)*this.kx,J=(c[1]-q)*this.ky;const ce=G*G+J*J;ce<j&&(j=ce,m=F,x=q,k=R,C=re)}return{point:[m,x],index:k,t:Math.max(0,Math.min(1,C))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function wu(a,n){return n[0]-a[0]}function el(a){return a[1]-a[0]+1}function _r(a,n){return a[1]>=a[0]&&a[1]<n}function Su(a,n){if(a[0]>a[1])return[null,null];const c=el(a);if(n){if(c===2)return[a,null];const x=Math.floor(c/2);return[[a[0],a[0]+x],[a[0]+x,a[1]]]}if(c===1)return[a,null];const m=Math.floor(c/2)-1;return[[a[0],a[0]+m],[a[0]+m+1,a[1]]]}function tl(a,n){if(!_r(n,a.length))return[1/0,1/0,-1/0,-1/0];const c=[1/0,1/0,-1/0,-1/0];for(let m=n[0];m<=n[1];++m)tn(c,a[m]);return c}function Pr(a){const n=[1/0,1/0,-1/0,-1/0];for(const c of a)for(const m of c)tn(n,m);return n}function il(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Io(a,n,c){if(!il(a)||!il(n))return NaN;let m=0,x=0;return a[2]<n[0]&&(m=n[0]-a[2]),a[0]>n[2]&&(m=a[0]-n[2]),a[1]>n[3]&&(x=a[1]-n[3]),a[3]<n[1]&&(x=n[1]-a[3]),c.distance([0,0],[m,x])}function nl(a,n,c){const m=c.pointOnLine(n,a);return c.distance(a,m.point)}function Rl(a,n,c,m,x){const k=Math.min(nl(a,[c,m],x),nl(n,[c,m],x)),C=Math.min(nl(c,[a,n],x),nl(m,[a,n],x));return Math.min(k,C)}function $c(a,n,c,m,x){if(!_r(n,a.length)||!_r(m,c.length))return 1/0;let k=1/0;for(let C=n[0];C<n[1];++C){const j=a[C],R=a[C+1];for(let F=m[0];F<m[1];++F){const q=c[F],G=c[F+1];if(ra(j,R,q,G))return 0;k=Math.min(k,Rl(j,R,q,G,x))}}return k}function ps(a,n,c,m,x){if(!_r(n,a.length)||!_r(m,c.length))return NaN;let k=1/0;for(let C=n[0];C<=n[1];++C)for(let j=m[0];j<=m[1];++j)if(k=Math.min(k,x.distance(a[C],c[j])),k===0)return k;return k}function ah(a,n,c){if(Jo(a,n,!0))return 0;let m=1/0;for(const x of n){const k=x[0],C=x[x.length-1];if(k!==C&&(m=Math.min(m,nl(a,[C,k],c)),m===0))return m;const j=c.pointOnLine(x,a);if(m=Math.min(m,c.distance(a,j.point)),m===0)return m}return m}function Yi(a,n,c,m){if(!_r(n,a.length))return NaN;for(let k=n[0];k<=n[1];++k)if(Jo(a[k],c,!0))return 0;let x=1/0;for(let k=n[0];k<n[1];++k){const C=a[k],j=a[k+1];for(const R of c)for(let F=0,q=R.length,G=q-1;F<q;G=F++){const J=R[G],re=R[F];if(ra(C,j,J,re))return 0;x=Math.min(x,Rl(C,j,J,re,m))}}return x}function co(a,n){for(const c of a)for(const m of c)if(Jo(m,n,!0))return!0;return!1}function mn(a,n,c,m=1/0){const x=Pr(a),k=Pr(n);if(m!==1/0&&Io(x,k,c)>=m)return m;if(Na(x,k)){if(co(a,n))return 0}else if(co(n,a))return 0;let C=1/0;for(const j of a)for(let R=0,F=j.length,q=F-1;R<F;q=R++){const G=j[q],J=j[R];for(const re of n)for(let ce=0,he=re.length,Ee=he-1;ce<he;Ee=ce++){const Ae=re[Ee],Xe=re[ce];if(ra(G,J,Ae,Xe))return 0;C=Math.min(C,Rl(G,J,Ae,Xe,c))}}return C}function Tn(a,n,c,m,x,k){if(!k)return;const C=Io(tl(m,k),x,c);C<n&&a.push([C,k,[0,0]])}function sl(a,n,c,m,x,k,C){if(!k||!C)return;const j=Io(tl(m,k),tl(x,C),c);j<n&&a.push([j,k,C])}function Ir(a,n,c,m,x=1/0){let k=Math.min(m.distance(a[0],c[0][0]),x);if(k===0)return k;const C=new lo([[0,[0,a.length-1],[0,0]]],wu),j=Pr(c);for(;C.length>0;){const R=C.pop();if(R[0]>=k)continue;const F=R[1],q=n?50:100;if(el(F)<=q){if(!_r(F,a.length))return NaN;if(n){const G=Yi(a,F,c,m);if(isNaN(G)||G===0)return G;k=Math.min(k,G)}else for(let G=F[0];G<=F[1];++G){const J=ah(a[G],c,m);if(k=Math.min(k,J),k===0)return 0}}else{const G=Su(F,n);Tn(C,k,m,a,j,G[0]),Tn(C,k,m,a,j,G[1])}}return k}function Dl(a,n,c,m,x,k=1/0){let C=Math.min(k,x.distance(a[0],c[0]));if(C===0)return C;const j=new lo([[0,[0,a.length-1],[0,c.length-1]]],wu);for(;j.length>0;){const R=j.pop();if(R[0]>=C)continue;const F=R[1],q=R[2],G=n?50:100,J=m?50:100;if(el(F)<=G&&el(q)<=J){if(!_r(F,a.length)&&_r(q,c.length))return NaN;let re;if(n&&m)re=$c(a,F,c,q,x),C=Math.min(C,re);else if(n&&!m){const ce=a.slice(F[0],F[1]+1);for(let he=q[0];he<=q[1];++he)if(re=nl(c[he],ce,x),C=Math.min(C,re),C===0)return C}else if(!n&&m){const ce=c.slice(q[0],q[1]+1);for(let he=F[0];he<=F[1];++he)if(re=nl(a[he],ce,x),C=Math.min(C,re),C===0)return C}else re=ps(a,F,c,q,x),C=Math.min(C,re)}else{const re=Su(F,n),ce=Su(q,m);sl(j,C,x,a,c,re[0],ce[0]),sl(j,C,x,a,c,re[0],ce[1]),sl(j,C,x,a,c,re[1],ce[0]),sl(j,C,x,a,c,re[1],ce[1])}}return C}function aa(a){return a.type==="MultiPolygon"?a.coordinates.map((n=>({type:"Polygon",coordinates:n}))):a.type==="MultiLineString"?a.coordinates.map((n=>({type:"LineString",coordinates:n}))):a.type==="MultiPoint"?a.coordinates.map((n=>({type:"Point",coordinates:n}))):[a]}class wa{constructor(n,c){this.type=It,this.geojson=n,this.geometries=c}static parse(n,c){if(n.length!==2)return c.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(_a(n[1])){const m=n[1];if(m.type==="FeatureCollection")return new wa(m,m.features.map((x=>aa(x.geometry))).flat());if(m.type==="Feature")return new wa(m,aa(m.geometry));if("type"in m&&"coordinates"in m)return new wa(m,aa(m))}return c.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(c,m){const x=c.geometry(),k=x.flat().map((R=>Po([R.x,R.y],c.canonical)));if(x.length===0)return NaN;const C=new Bc(k[0][1]);let j=1/0;for(const R of m){switch(R.type){case"Point":j=Math.min(j,Dl(k,!1,[R.coordinates],!1,C,j));break;case"LineString":j=Math.min(j,Dl(k,!1,R.coordinates,!0,C,j));break;case"Polygon":j=Math.min(j,Ir(k,!1,R.coordinates,C,j))}if(j===0)return j}return j})(n,this.geometries);if(n.geometryType()==="LineString")return(function(c,m){const x=c.geometry(),k=x.flat().map((R=>Po([R.x,R.y],c.canonical)));if(x.length===0)return NaN;const C=new Bc(k[0][1]);let j=1/0;for(const R of m){switch(R.type){case"Point":j=Math.min(j,Dl(k,!0,[R.coordinates],!1,C,j));break;case"LineString":j=Math.min(j,Dl(k,!0,R.coordinates,!0,C,j));break;case"Polygon":j=Math.min(j,Ir(k,!0,R.coordinates,C,j))}if(j===0)return j}return j})(n,this.geometries);if(n.geometryType()==="Polygon")return(function(c,m){const x=c.geometry();if(x.length===0||x[0].length===0)return NaN;const k=tc(x,0).map((R=>R.map((F=>F.map((q=>Po([q.x,q.y],c.canonical))))))),C=new Bc(k[0][0][0][1]);let j=1/0;for(const R of m)for(const F of k){switch(R.type){case"Point":j=Math.min(j,Ir([R.coordinates],!1,F,C,j));break;case"LineString":j=Math.min(j,Ir(R.coordinates,!0,F,C,j));break;case"Polygon":j=Math.min(j,mn(F,R.coordinates,C,j))}if(j===0)return j}return j})(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ba={"==":xa,"!=":zl,">":Oa,"<":na,">=":xs,"<=":Xo,array:Br,at:va,boolean:Br,case:Ur,coalesce:Mr,collator:sa,format:Mo,image:zc,in:Gn,"index-of":$r,interpolate:Rs,"interpolate-hcl":Rs,"interpolate-lab":Rs,length:Xs,let:Da,literal:ys,match:Co,number:Br,"number-format":Ko,object:Br,slice:Yo,step:ao,string:Br,"to-boolean":In,"to-color":In,"to-number":In,"to-string":In,var:pn,within:oo,distance:wa};class nr{constructor(n,c,m,x){this.name=n,this.type=c,this._evaluate=m,this.args=x}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,c){const m=n[0],x=nr.definitions[m];if(!x)return c.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(x)?x[0]:x.type,C=Array.isArray(x)?[[x[1],x[2]]]:x.overloads,j=C.filter((([F])=>!Array.isArray(F)||F.length===n.length-1));let R=null;for(const[F,q]of j){R=new Bn(c.registry,Ol,c.path,null,c.scope);const G=[];let J=!1;for(let re=1;re<n.length;re++){const ce=n[re],he=Array.isArray(F)?F[re-1]:F.type,Ee=R.parse(ce,1+G.length,he);if(!Ee){J=!0;break}G.push(Ee)}if(!J)if(Array.isArray(F)&&F.length!==G.length)R.error(`Expected ${F.length} arguments, but found ${G.length} instead.`);else{for(let re=0;re<G.length;re++){const ce=Array.isArray(F)?F[re]:F.type,he=G[re];R.concat(re+1).checkSubtype(ce,he.type)}if(R.errors.length===0)return new nr(m,k,q,G)}}if(j.length===1)c.errors.push(...R.errors);else{const F=(j.length?j:C).map((([G])=>{return J=G,Array.isArray(J)?`(${J.map(Q).join(", ")})`:`(${Q(J.type)}...)`;var J})).join(" | "),q=[];for(let G=1;G<n.length;G++){const J=c.parse(n[G],1+q.length);if(!J)return null;q.push(Q(J.type))}c.error(`Expected arguments of type ${F}, but found (${q.join(", ")}) instead.`)}return null}static register(n,c){nr.definitions=c;for(const m in c)n[m]=nr}}function rl(a,[n,c,m,x]){n=n.evaluate(a),c=c.evaluate(a),m=m.evaluate(a);const k=x?x.evaluate(a):1,C=ko(n,c,m,k);if(C)throw new fn(C);return new wi(n/255,c/255,m/255,k,!1)}function Uc(a,n){return a in n}function oa(a,n){const c=n[a];return c===void 0?null:c}function la(a){return{type:a}}function Ol(a){if(a instanceof pn)return Ol(a.boundExpression);if(a instanceof nr&&a.name==="error"||a instanceof sa||a instanceof oo||a instanceof wa)return!1;const n=a instanceof In||a instanceof Br;let c=!0;return a.eachChild((m=>{c=n?c&&Ol(m):c&&m instanceof ys})),!!c&&jo(a)&&Fr(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function jo(a){if(a instanceof nr&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof oo||a instanceof wa)return!1;let n=!0;return a.eachChild((c=>{n&&!jo(c)&&(n=!1)})),n}function al(a){if(a instanceof nr&&a.name==="feature-state")return!1;let n=!0;return a.eachChild((c=>{n&&!al(c)&&(n=!1)})),n}function Fr(a,n){if(a instanceof nr&&n.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild((m=>{c&&!Fr(m,n)&&(c=!1)})),c}function Fc(a){return{result:"success",value:a}}function Sa(a){return{result:"error",value:a}}function Nl(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function $a(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Vs(a){return!!a.expression&&a.expression.interpolated}function on(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ol(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function ic(a){return a}function nc(a,n){const c=n.type==="color",m=a.stops&&typeof a.stops[0][0]=="object",x=m||!(m||a.property!==void 0),k=a.type||(Vs(n)?"exponential":"interval");if(c||n.type==="padding"){const q=c?wi.parse:zs.parse;(a=On({},a)).stops&&(a.stops=a.stops.map((G=>[G[0],q(G[1])]))),a.default=q(a.default?a.default:n.default)}if(a.colorSpace&&(C=a.colorSpace)!=="rgb"&&C!=="hcl"&&C!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var C;let j,R,F;if(k==="exponential")j=ho;else if(k==="interval")j=ll;else if(k==="categorical"){j=uo,R=Object.create(null);for(const q of a.stops)R[q[0]]=q[1];F=typeof a.stops[0][0]}else{if(k!=="identity")throw new Error(`Unknown function type "${k}"`);j=sc}if(m){const q={},G=[];for(let ce=0;ce<a.stops.length;ce++){const he=a.stops[ce],Ee=he[0].zoom;q[Ee]===void 0&&(q[Ee]={zoom:Ee,type:a.type,property:a.property,default:a.default,stops:[]},G.push(Ee)),q[Ee].stops.push([he[0].value,he[1]])}const J=[];for(const ce of G)J.push([q[ce].zoom,nc(q[ce],n)]);const re={name:"linear"};return{kind:"composite",interpolationType:re,interpolationFactor:Rs.interpolationFactor.bind(void 0,re),zoomStops:J.map((ce=>ce[0])),evaluate:({zoom:ce},he)=>ho({stops:J,base:a.base},n,ce).evaluate(ce,he)}}if(x){const q=k==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:q,interpolationFactor:Rs.interpolationFactor.bind(void 0,q),zoomStops:a.stops.map((G=>G[0])),evaluate:({zoom:G})=>j(a,n,G,R,F)}}return{kind:"source",evaluate(q,G){const J=G&&G.properties?G.properties[a.property]:void 0;return J===void 0?Ua(a.default,n.default):j(a,n,J,R,F)}}}function Ua(a,n,c){return a!==void 0?a:n!==void 0?n:c!==void 0?c:void 0}function uo(a,n,c,m,x){return Ua(typeof c===x?m[c]:void 0,a.default,n.default)}function ll(a,n,c){if(on(c)!=="number")return Ua(a.default,n.default);const m=a.stops.length;if(m===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[m-1][0])return a.stops[m-1][1];const x=ro(a.stops.map((k=>k[0])),c);return a.stops[x][1]}function ho(a,n,c){const m=a.base!==void 0?a.base:1;if(on(c)!=="number")return Ua(a.default,n.default);const x=a.stops.length;if(x===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[x-1][0])return a.stops[x-1][1];const k=ro(a.stops.map((q=>q[0])),c),C=(function(q,G,J,re){const ce=re-J,he=q-J;return ce===0?0:G===1?he/ce:(Math.pow(G,he)-1)/(Math.pow(G,ce)-1)})(c,m,a.stops[k][0],a.stops[k+1][0]),j=a.stops[k][1],R=a.stops[k+1][1],F=Us[n.type]||ic;return typeof j.evaluate=="function"?{evaluate(...q){const G=j.evaluate.apply(void 0,q),J=R.evaluate.apply(void 0,q);if(G!==void 0&&J!==void 0)return F(G,J,C,a.colorSpace)}}:F(j,R,C,a.colorSpace)}function sc(a,n,c){switch(n.type){case"color":c=wi.parse(c);break;case"formatted":c=Ys.fromString(c.toString());break;case"resolvedImage":c=yr.fromString(c.toString());break;case"padding":c=zs.parse(c);break;default:on(c)===n.type||n.type==="enum"&&n.values[c]||(c=void 0)}return Ua(c,a.default,n.default)}nr.register(Ba,{error:[{kind:"error"},[ai],(a,[n])=>{throw new fn(n.evaluate(a))}],typeof:[ai,[mi],(a,[n])=>Q(Pi(n.evaluate(a)))],"to-rgba":[ee(It,4),[Ji],(a,[n])=>{const[c,m,x,k]=n.evaluate(a).rgb;return[255*c,255*m,255*x,k]}],rgb:[Ji,[It,It,It],rl],rgba:[Ji,[It,It,It,It],rl],has:{type:ti,overloads:[[[ai],(a,[n])=>Uc(n.evaluate(a),a.properties())],[[ai,Nn],(a,[n,c])=>Uc(n.evaluate(a),c.evaluate(a))]]},get:{type:mi,overloads:[[[ai],(a,[n])=>oa(n.evaluate(a),a.properties())],[[ai,Nn],(a,[n,c])=>oa(n.evaluate(a),c.evaluate(a))]]},"feature-state":[mi,[ai],(a,[n])=>oa(n.evaluate(a),a.featureState||{})],properties:[Nn,[],a=>a.properties()],"geometry-type":[ai,[],a=>a.geometryType()],id:[mi,[],a=>a.id()],zoom:[It,[],a=>a.globals.zoom],"heatmap-density":[It,[],a=>a.globals.heatmapDensity||0],"line-progress":[It,[],a=>a.globals.lineProgress||0],accumulated:[mi,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[It,la(It),(a,n)=>{let c=0;for(const m of n)c+=m.evaluate(a);return c}],"*":[It,la(It),(a,n)=>{let c=1;for(const m of n)c*=m.evaluate(a);return c}],"-":{type:It,overloads:[[[It,It],(a,[n,c])=>n.evaluate(a)-c.evaluate(a)],[[It],(a,[n])=>-n.evaluate(a)]]},"/":[It,[It,It],(a,[n,c])=>n.evaluate(a)/c.evaluate(a)],"%":[It,[It,It],(a,[n,c])=>n.evaluate(a)%c.evaluate(a)],ln2:[It,[],()=>Math.LN2],pi:[It,[],()=>Math.PI],e:[It,[],()=>Math.E],"^":[It,[It,It],(a,[n,c])=>Math.pow(n.evaluate(a),c.evaluate(a))],sqrt:[It,[It],(a,[n])=>Math.sqrt(n.evaluate(a))],log10:[It,[It],(a,[n])=>Math.log(n.evaluate(a))/Math.LN10],ln:[It,[It],(a,[n])=>Math.log(n.evaluate(a))],log2:[It,[It],(a,[n])=>Math.log(n.evaluate(a))/Math.LN2],sin:[It,[It],(a,[n])=>Math.sin(n.evaluate(a))],cos:[It,[It],(a,[n])=>Math.cos(n.evaluate(a))],tan:[It,[It],(a,[n])=>Math.tan(n.evaluate(a))],asin:[It,[It],(a,[n])=>Math.asin(n.evaluate(a))],acos:[It,[It],(a,[n])=>Math.acos(n.evaluate(a))],atan:[It,[It],(a,[n])=>Math.atan(n.evaluate(a))],min:[It,la(It),(a,n)=>Math.min(...n.map((c=>c.evaluate(a))))],max:[It,la(It),(a,n)=>Math.max(...n.map((c=>c.evaluate(a))))],abs:[It,[It],(a,[n])=>Math.abs(n.evaluate(a))],round:[It,[It],(a,[n])=>{const c=n.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[It,[It],(a,[n])=>Math.floor(n.evaluate(a))],ceil:[It,[It],(a,[n])=>Math.ceil(n.evaluate(a))],"filter-==":[ti,[ai,mi],(a,[n,c])=>a.properties()[n.value]===c.value],"filter-id-==":[ti,[mi],(a,[n])=>a.id()===n.value],"filter-type-==":[ti,[ai],(a,[n])=>a.geometryType()===n.value],"filter-<":[ti,[ai,mi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m<x}],"filter-id-<":[ti,[mi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c<m}],"filter->":[ti,[ai,mi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m>x}],"filter-id->":[ti,[mi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c>m}],"filter-<=":[ti,[ai,mi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m<=x}],"filter-id-<=":[ti,[mi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c<=m}],"filter->=":[ti,[ai,mi],(a,[n,c])=>{const m=a.properties()[n.value],x=c.value;return typeof m==typeof x&&m>=x}],"filter-id->=":[ti,[mi],(a,[n])=>{const c=a.id(),m=n.value;return typeof c==typeof m&&c>=m}],"filter-has":[ti,[mi],(a,[n])=>n.value in a.properties()],"filter-has-id":[ti,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[ti,[ee(ai)],(a,[n])=>n.value.indexOf(a.geometryType())>=0],"filter-id-in":[ti,[ee(mi)],(a,[n])=>n.value.indexOf(a.id())>=0],"filter-in-small":[ti,[ai,ee(mi)],(a,[n,c])=>c.value.indexOf(a.properties()[n.value])>=0],"filter-in-large":[ti,[ai,ee(mi)],(a,[n,c])=>(function(m,x,k,C){for(;k<=C;){const j=k+C>>1;if(x[j]===m)return!0;x[j]>m?C=j-1:k=j+1}return!1})(a.properties()[n.value],c.value,0,c.value.length-1)],all:{type:ti,overloads:[[[ti,ti],(a,[n,c])=>n.evaluate(a)&&c.evaluate(a)],[la(ti),(a,n)=>{for(const c of n)if(!c.evaluate(a))return!1;return!0}]]},any:{type:ti,overloads:[[[ti,ti],(a,[n,c])=>n.evaluate(a)||c.evaluate(a)],[la(ti),(a,n)=>{for(const c of n)if(c.evaluate(a))return!0;return!1}]]},"!":[ti,[ti],(a,[n])=>!n.evaluate(a)],"is-supported-script":[ti,[ai],(a,[n])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(n.evaluate(a))}],upcase:[ai,[ai],(a,[n])=>n.evaluate(a).toUpperCase()],downcase:[ai,[ai],(a,[n])=>n.evaluate(a).toLowerCase()],concat:[ai,la(mi),(a,n)=>n.map((c=>zn(c.evaluate(a)))).join("")],"resolved-locale":[ai,[Bt],(a,[n])=>n.evaluate(a).resolvedLocale()]});class Lo{constructor(n,c){var m;this.expression=n,this._warningHistory={},this._evaluator=new Wo,this._defaultValue=c?(m=c).type==="color"&&ol(m.default)?new wi(0,0,0,0):m.type==="color"?wi.parse(m.default)||null:m.type==="padding"?zs.parse(m.default)||null:m.type==="variableAnchorOffsetCollection"?ir.parse(m.default)||null:m.default===void 0?null:m.default:null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._evaluator.globals=n,this._evaluator.feature=c,this._evaluator.featureState=m,this._evaluator.canonical=x,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)}evaluate(n,c,m,x,k,C){this._evaluator.globals=n,this._evaluator.feature=c||null,this._evaluator.featureState=m||null,this._evaluator.canonical=x,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=C||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new fn(`Expected value to be one of ${Object.keys(this._enumValues).map((R=>JSON.stringify(R))).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(j.message)),this._defaultValue}}}function fo(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Ba}function cl(a,n){const c=new Bn(Ba,Ol,[],n?(function(x){const k={color:Ji,string:ai,number:It,enum:ai,boolean:ti,formatted:hi,padding:Ci,resolvedImage:bi,variableAnchorOffsetCollection:xe};return x.type==="array"?ee(k[x.value]||mi,x.length):k[x.type]})(n):void 0),m=c.parse(a,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?Fc(new Lo(m,n)):Sa(c.errors)}class Vr{constructor(n,c){this.kind=n,this._styleExpression=c,this.isStateDependent=n!=="constant"&&!al(c.expression)}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._styleExpression.evaluateWithoutErrorHandling(n,c,m,x,k,C)}evaluate(n,c,m,x,k,C){return this._styleExpression.evaluate(n,c,m,x,k,C)}}class Ta{constructor(n,c,m,x){this.kind=n,this.zoomStops=m,this._styleExpression=c,this.isStateDependent=n!=="camera"&&!al(c.expression),this.interpolationType=x}evaluateWithoutErrorHandling(n,c,m,x,k,C){return this._styleExpression.evaluateWithoutErrorHandling(n,c,m,x,k,C)}evaluate(n,c,m,x,k,C){return this._styleExpression.evaluate(n,c,m,x,k,C)}interpolationFactor(n,c,m){return this.interpolationType?Rs.interpolationFactor(this.interpolationType,n,c,m):0}}function Bl(a,n){const c=cl(a,n);if(c.result==="error")return c;const m=c.value.expression,x=jo(m);if(!x&&!Nl(n))return Sa([new dn("","data expressions not supported")]);const k=Fr(m,["zoom"]);if(!k&&!$a(n))return Sa([new dn("","zoom expressions not supported")]);const C=Cs(m);return C||k?C instanceof dn?Sa([C]):C instanceof Rs&&!Vs(n)?Sa([new dn("",'"interpolate" expressions cannot be used with this property')]):Fc(C?new Ta(x?"camera":"composite",c.value,C.labels,C instanceof Rs?C.interpolation:void 0):new Vr(x?"constant":"source",c.value)):Sa([new dn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ul{constructor(n,c){this._parameters=n,this._specification=c,On(this,nc(this._parameters,this._specification))}static deserialize(n){return new ul(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Cs(a){let n=null;if(a instanceof Da)n=Cs(a.result);else if(a instanceof Mr){for(const c of a.args)if(n=Cs(c),n)break}else(a instanceof ao||a instanceof Rs)&&a.input instanceof nr&&a.input.name==="zoom"&&(n=a);return n instanceof dn||a.eachChild((c=>{const m=Cs(c);m instanceof dn?n=m:!n&&m?n=new dn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&m&&n!==m&&(n=new dn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}function zo(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const n of a.slice(1))if(!zo(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const rc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hl(a){if(a==null)return{filter:()=>!0,needGeometry:!1};zo(a)||(a=Vc(a));const n=cl(a,rc);if(n.result==="error")throw new Error(n.value.map((c=>`${c.key}: ${c.message}`)).join(", "));return{filter:(c,m,x)=>n.value.evaluate(c,m,{},x),needGeometry:Tu(a)}}function Qh(a,n){return a<n?-1:a>n?1:0}function Tu(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let n=1;n<a.length;n++)if(Tu(a[n]))return!0;return!1}function Vc(a){if(!a)return!0;const n=a[0];return a.length<=1?n!=="any":n==="=="?Ro(a[1],a[2],"=="):n==="!="?Wn(Ro(a[1],a[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Ro(a[1],a[2],n):n==="any"?(c=a.slice(1),["any"].concat(c.map(Vc))):n==="all"?["all"].concat(a.slice(1).map(Vc)):n==="none"?["all"].concat(a.slice(1).map(Vc).map(Wn)):n==="in"?$l(a[1],a.slice(2)):n==="!in"?Wn($l(a[1],a.slice(2))):n==="has"?ca(a[1]):n!=="!has"||Wn(ca(a[1]));var c}function Ro(a,n,c){switch(a){case"$type":return[`filter-type-${c}`,n];case"$id":return[`filter-id-${c}`,n];default:return[`filter-${c}`,a,n]}}function $l(a,n){if(n.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some((c=>typeof c!=typeof n[0]))?["filter-in-large",a,["literal",n.sort(Qh)]]:["filter-in-small",a,["literal",n]]}}function ca(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Wn(a){return["!",a]}function Ea(a){const n=typeof a;if(n==="number"||n==="boolean"||n==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let x="[";for(const k of a)x+=`${Ea(k)},`;return`${x}]`}const c=Object.keys(a).sort();let m="{";for(let x=0;x<c.length;x++)m+=`${JSON.stringify(c[x])}:${Ea(a[c[x]])},`;return`${m}}`}function qr(a){let n="";for(const c of Xn)n+=`/${Ea(a[c])}`;return n}function vr(a){const n=a.value;return n?[new Tt(a.key,n,"constants have been deprecated as of v8")]:[]}function ss(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function xr(a){if(Array.isArray(a))return a.map(xr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const n={};for(const c in a)n[c]=xr(a[c]);return n}return ss(a)}function As(a){const n=a.key,c=a.value,m=a.valueSpec||{},x=a.objectElementValidators||{},k=a.style,C=a.styleSpec,j=a.validateSpec;let R=[];const F=on(c);if(F!=="object")return[new Tt(n,c,`object expected, ${F} found`)];for(const q in c){const G=q.split(".")[0],J=m[G]||m["*"];let re;if(x[G])re=x[G];else if(m[G])re=j;else if(x["*"])re=x["*"];else{if(!m["*"]){R.push(new Tt(n,c[q],`unknown property "${q}"`));continue}re=j}R=R.concat(re({key:(n&&`${n}.`)+q,value:c[q],valueSpec:J,style:k,styleSpec:C,object:c,objectKey:q,validateSpec:j},c))}for(const q in m)x[q]||m[q].required&&m[q].default===void 0&&c[q]===void 0&&R.push(new Tt(n,c,`missing required property "${q}"`));return R}function dl(a){const n=a.value,c=a.valueSpec,m=a.style,x=a.styleSpec,k=a.key,C=a.arrayElementValidator||a.validateSpec;if(on(n)!=="array")return[new Tt(k,n,`array expected, ${on(n)} found`)];if(c.length&&n.length!==c.length)return[new Tt(k,n,`array length ${c.length} expected, length ${n.length} found`)];if(c["min-length"]&&n.length<c["min-length"])return[new Tt(k,n,`array length at least ${c["min-length"]} expected, length ${n.length} found`)];let j={type:c.value,values:c.values};x.$version<7&&(j.function=c.function),on(c.value)==="object"&&(j=c.value);let R=[];for(let F=0;F<n.length;F++)R=R.concat(C({array:n,arrayIndex:F,value:n[F],valueSpec:j,validateSpec:a.validateSpec,style:m,styleSpec:x,key:`${k}[${F}]`}));return R}function ua(a){const n=a.key,c=a.value,m=a.valueSpec;let x=on(c);return x==="number"&&c!=c&&(x="NaN"),x!=="number"?[new Tt(n,c,`number expected, ${x} found`)]:"minimum"in m&&c<m.minimum?[new Tt(n,c,`${c} is less than the minimum value ${m.minimum}`)]:"maximum"in m&&c>m.maximum?[new Tt(n,c,`${c} is greater than the maximum value ${m.maximum}`)]:[]}function po(a){const n=a.valueSpec,c=ss(a.value.type);let m,x,k,C={};const j=c!=="categorical"&&a.value.property===void 0,R=!j,F=on(a.value.stops)==="array"&&on(a.value.stops[0])==="array"&&on(a.value.stops[0][0])==="object",q=As({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(re){if(c==="identity")return[new Tt(re.key,re.value,'identity function may not have a "stops" property')];let ce=[];const he=re.value;return ce=ce.concat(dl({key:re.key,value:he,valueSpec:re.valueSpec,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:G})),on(he)==="array"&&he.length===0&&ce.push(new Tt(re.key,he,"array must have at least one stop")),ce},default:function(re){return re.validateSpec({key:re.key,value:re.value,valueSpec:n,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec})}}});return c==="identity"&&j&&q.push(new Tt(a.key,a.value,'missing required property "property"')),c==="identity"||a.value.stops||q.push(new Tt(a.key,a.value,'missing required property "stops"')),c==="exponential"&&a.valueSpec.expression&&!Vs(a.valueSpec)&&q.push(new Tt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(R&&!Nl(a.valueSpec)?q.push(new Tt(a.key,a.value,"property functions not supported")):j&&!$a(a.valueSpec)&&q.push(new Tt(a.key,a.value,"zoom functions not supported"))),c!=="categorical"&&!F||a.value.property!==void 0||q.push(new Tt(a.key,a.value,'"property" property is required')),q;function G(re){let ce=[];const he=re.value,Ee=re.key;if(on(he)!=="array")return[new Tt(Ee,he,`array expected, ${on(he)} found`)];if(he.length!==2)return[new Tt(Ee,he,`array length 2 expected, length ${he.length} found`)];if(F){if(on(he[0])!=="object")return[new Tt(Ee,he,`object expected, ${on(he[0])} found`)];if(he[0].zoom===void 0)return[new Tt(Ee,he,"object stop key must have zoom")];if(he[0].value===void 0)return[new Tt(Ee,he,"object stop key must have value")];if(k&&k>ss(he[0].zoom))return[new Tt(Ee,he[0].zoom,"stop zoom values must appear in ascending order")];ss(he[0].zoom)!==k&&(k=ss(he[0].zoom),x=void 0,C={}),ce=ce.concat(As({key:`${Ee}[0]`,value:he[0],valueSpec:{zoom:{}},validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:ua,value:J}}))}else ce=ce.concat(J({key:`${Ee}[0]`,value:he[0],validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec},he));return fo(xr(he[1]))?ce.concat([new Tt(`${Ee}[1]`,he[1],"expressions are not allowed in function stops.")]):ce.concat(re.validateSpec({key:`${Ee}[1]`,value:he[1],valueSpec:n,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec}))}function J(re,ce){const he=on(re.value),Ee=ss(re.value),Ae=re.value!==null?re.value:ce;if(m){if(he!==m)return[new Tt(re.key,Ae,`${he} stop domain type must match previous stop domain type ${m}`)]}else m=he;if(he!=="number"&&he!=="string"&&he!=="boolean")return[new Tt(re.key,Ae,"stop domain value must be a number, string, or boolean")];if(he!=="number"&&c!=="categorical"){let Xe=`number expected, ${he} found`;return Nl(n)&&c===void 0&&(Xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Tt(re.key,Ae,Xe)]}return c!=="categorical"||he!=="number"||isFinite(Ee)&&Math.floor(Ee)===Ee?c!=="categorical"&&he==="number"&&x!==void 0&&Ee<x?[new Tt(re.key,Ae,"stop domain values must appear in ascending order")]:(x=Ee,c==="categorical"&&Ee in C?[new Tt(re.key,Ae,"stop domain values must be unique")]:(C[Ee]=!0,[])):[new Tt(re.key,Ae,`integer expected, found ${Ee}`)]}}function Fa(a){const n=(a.expressionContext==="property"?Bl:cl)(xr(a.value),a.valueSpec);if(n.result==="error")return n.value.map((m=>new Tt(`${a.key}${m.key}`,a.value,m.message)));const c=n.value.expression||n.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!c.outputDefined())return[new Tt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!al(c))return[new Tt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!al(c))return[new Tt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Fr(c,["zoom","feature-state"]))return[new Tt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!jo(c))return[new Tt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function br(a){const n=a.key,c=a.value,m=a.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(ss(c))===-1&&x.push(new Tt(n,c,`expected one of [${m.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(m.values).indexOf(ss(c))===-1&&x.push(new Tt(n,c,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(c)} found`)),x}function Eu(a){return zo(xr(a.value))?Fa(On({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ks(a)}function Ks(a){const n=a.value,c=a.key;if(on(n)!=="array")return[new Tt(c,n,`array expected, ${on(n)} found`)];const m=a.styleSpec;let x,k=[];if(n.length<1)return[new Tt(c,n,"filter array must have at least 1 element")];switch(k=k.concat(br({key:`${c}[0]`,value:n[0],valueSpec:m.filter_operator,style:a.style,styleSpec:a.styleSpec})),ss(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&ss(n[1])==="$type"&&k.push(new Tt(c,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&k.push(new Tt(c,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(x=on(n[1]),x!=="string"&&k.push(new Tt(`${c}[1]`,n[1],`string expected, ${x} found`)));for(let C=2;C<n.length;C++)x=on(n[C]),ss(n[1])==="$type"?k=k.concat(br({key:`${c}[${C}]`,value:n[C],valueSpec:m.geometry_type,style:a.style,styleSpec:a.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&k.push(new Tt(`${c}[${C}]`,n[C],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let C=1;C<n.length;C++)k=k.concat(Ks({key:`${c}[${C}]`,value:n[C],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":x=on(n[1]),n.length!==2?k.push(new Tt(c,n,`filter array for "${n[0]}" operator must have 2 elements`)):x!=="string"&&k.push(new Tt(`${c}[1]`,n[1],`string expected, ${x} found`))}return k}function Ul(a,n){const c=a.key,m=a.validateSpec,x=a.style,k=a.styleSpec,C=a.value,j=a.objectKey,R=k[`${n}_${a.layerType}`];if(!R)return[];const F=j.match(/^(.*)-transition$/);if(n==="paint"&&F&&R[F[1]]&&R[F[1]].transition)return m({key:c,value:C,valueSpec:k.transition,style:x,styleSpec:k});const q=a.valueSpec||R[j];if(!q)return[new Tt(c,C,`unknown property "${j}"`)];let G;if(on(C)==="string"&&Nl(q)&&!q.tokens&&(G=/^{([^}]+)}$/.exec(C)))return[new Tt(c,C,`"${j}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const J=[];return a.layerType==="symbol"&&(j==="text-field"&&x&&!x.glyphs&&J.push(new Tt(c,C,'use of "text-field" requires a style "glyphs" property')),j==="text-font"&&ol(xr(C))&&ss(C.type)==="identity"&&J.push(new Tt(c,C,'"text-font" does not support identity functions'))),J.concat(m({key:a.key,value:C,valueSpec:q,style:x,styleSpec:k,expressionContext:"property",propertyType:n,propertyKey:j}))}function Hr(a){return Ul(a,"paint")}function ac(a){return Ul(a,"layout")}function fl(a){let n=[];const c=a.value,m=a.key,x=a.style,k=a.styleSpec;c.type||c.ref||n.push(new Tt(m,c,'either "type" or "ref" is required'));let C=ss(c.type);const j=ss(c.ref);if(c.id){const R=ss(c.id);for(let F=0;F<a.arrayIndex;F++){const q=x.layers[F];ss(q.id)===R&&n.push(new Tt(m,c.id,`duplicate layer id "${c.id}", previously used at line ${q.id.__line__}`))}}if("ref"in c){let R;["type","source","source-layer","filter","layout"].forEach((F=>{F in c&&n.push(new Tt(m,c[F],`"${F}" is prohibited for ref layers`))})),x.layers.forEach((F=>{ss(F.id)===j&&(R=F)})),R?R.ref?n.push(new Tt(m,c.ref,"ref cannot reference another ref layer")):C=ss(R.type):n.push(new Tt(m,c.ref,`ref layer "${j}" not found`))}else if(C!=="background")if(c.source){const R=x.sources&&x.sources[c.source],F=R&&ss(R.type);R?F==="vector"&&C==="raster"?n.push(new Tt(m,c.source,`layer "${c.id}" requires a raster source`)):F!=="raster-dem"&&C==="hillshade"?n.push(new Tt(m,c.source,`layer "${c.id}" requires a raster-dem source`)):F==="raster"&&C!=="raster"?n.push(new Tt(m,c.source,`layer "${c.id}" requires a vector source`)):F!=="vector"||c["source-layer"]?F==="raster-dem"&&C!=="hillshade"?n.push(new Tt(m,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):C!=="line"||!c.paint||!c.paint["line-gradient"]||F==="geojson"&&R.lineMetrics||n.push(new Tt(m,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Tt(m,c,`layer "${c.id}" must specify a "source-layer"`)):n.push(new Tt(m,c.source,`source "${c.source}" not found`))}else n.push(new Tt(m,c,'missing required property "source"'));return n=n.concat(As({key:m,value:c,valueSpec:k.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${m}.type`,value:c.type,valueSpec:k.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:c,objectKey:"type"}),filter:Eu,layout:R=>As({layer:c,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":F=>ac(On({layerType:C},F))}}),paint:R=>As({layer:c,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":F=>Hr(On({layerType:C},F))}})}})),n}function Zr(a){const n=a.value,c=a.key,m=on(n);return m!=="string"?[new Tt(c,n,`string expected, ${m} found`)]:[]}const pl={promoteId:function({key:a,value:n}){if(on(n)==="string")return Zr({key:a,value:n});{const c=[];for(const m in n)c.push(...Zr({key:`${a}.${m}`,value:n[m]}));return c}}};function ml(a){const n=a.value,c=a.key,m=a.styleSpec,x=a.style,k=a.validateSpec;if(!n.type)return[new Tt(c,n,'"type" is required')];const C=ss(n.type);let j;switch(C){case"vector":case"raster":return j=As({key:c,value:n,valueSpec:m[`source_${C.replace("-","_")}`],style:a.style,styleSpec:m,objectElementValidators:pl,validateSpec:k}),j;case"raster-dem":return j=(function(R){var F;const q=(F=R.sourceName)!==null&&F!==void 0?F:"",G=R.value,J=R.styleSpec,re=J.source_raster_dem,ce=R.style;let he=[];const Ee=on(G);if(G===void 0)return he;if(Ee!=="object")return he.push(new Tt("source_raster_dem",G,`object expected, ${Ee} found`)),he;const Ae=ss(G.encoding)==="custom",Xe=["redFactor","greenFactor","blueFactor","baseShift"],De=R.value.encoding?`"${R.value.encoding}"`:"Default";for(const Ge in G)!Ae&&Xe.includes(Ge)?he.push(new Tt(Ge,G[Ge],`In "${q}": "${Ge}" is only valid when "encoding" is set to "custom". ${De} encoding found`)):re[Ge]?he=he.concat(R.validateSpec({key:Ge,value:G[Ge],valueSpec:re[Ge],validateSpec:R.validateSpec,style:ce,styleSpec:J})):he.push(new Tt(Ge,G[Ge],`unknown property "${Ge}"`));return he})({sourceName:c,value:n,style:a.style,styleSpec:m,validateSpec:k}),j;case"geojson":if(j=As({key:c,value:n,valueSpec:m.source_geojson,style:x,styleSpec:m,validateSpec:k,objectElementValidators:pl}),n.cluster)for(const R in n.clusterProperties){const[F,q]=n.clusterProperties[R],G=typeof F=="string"?[F,["accumulated"],["get",R]]:F;j.push(...Fa({key:`${c}.${R}.map`,value:q,expressionContext:"cluster-map"})),j.push(...Fa({key:`${c}.${R}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return j;case"video":return As({key:c,value:n,valueSpec:m.source_video,style:x,validateSpec:k,styleSpec:m});case"image":return As({key:c,value:n,valueSpec:m.source_image,style:x,validateSpec:k,styleSpec:m});case"canvas":return[new Tt(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return br({key:`${c}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function oc(a){const n=a.value,c=a.styleSpec,m=c.light,x=a.style;let k=[];const C=on(n);if(n===void 0)return k;if(C!=="object")return k=k.concat([new Tt("light",n,`object expected, ${C} found`)]),k;for(const j in n){const R=j.match(/^(.*)-transition$/);k=k.concat(R&&m[R[1]]&&m[R[1]].transition?a.validateSpec({key:j,value:n[j],valueSpec:c.transition,validateSpec:a.validateSpec,style:x,styleSpec:c}):m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],validateSpec:a.validateSpec,style:x,styleSpec:c}):[new Tt(j,n[j],`unknown property "${j}"`)])}return k}function u(a){const n=a.value,c=a.styleSpec,m=c.sky,x=a.style,k=on(n);if(n===void 0)return[];if(k!=="object")return[new Tt("sky",n,`object expected, ${k} found`)];let C=[];for(const j in n)C=C.concat(m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],style:x,styleSpec:c}):[new Tt(j,n[j],`unknown property "${j}"`)]);return C}function b(a){const n=a.value,c=a.styleSpec,m=c.terrain,x=a.style;let k=[];const C=on(n);if(n===void 0)return k;if(C!=="object")return k=k.concat([new Tt("terrain",n,`object expected, ${C} found`)]),k;for(const j in n)k=k.concat(m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],validateSpec:a.validateSpec,style:x,styleSpec:c}):[new Tt(j,n[j],`unknown property "${j}"`)]);return k}function M(a){let n=[];const c=a.value,m=a.key;if(Array.isArray(c)){const x=[],k=[];for(const C in c)c[C].id&&x.includes(c[C].id)&&n.push(new Tt(m,c,`all the sprites' ids must be unique, but ${c[C].id} is duplicated`)),x.push(c[C].id),c[C].url&&k.includes(c[C].url)&&n.push(new Tt(m,c,`all the sprites' URLs must be unique, but ${c[C].url} is duplicated`)),k.push(c[C].url),n=n.concat(As({key:`${m}[${C}]`,value:c[C],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return n}return Zr({key:m,value:c})}const $={"*":()=>[],array:dl,boolean:function(a){const n=a.value,c=a.key,m=on(n);return m!=="boolean"?[new Tt(c,n,`boolean expected, ${m} found`)]:[]},number:ua,color:function(a){const n=a.key,c=a.value,m=on(c);return m!=="string"?[new Tt(n,c,`color expected, ${m} found`)]:wi.parse(String(c))?[]:[new Tt(n,c,`color expected, "${c}" found`)]},constants:vr,enum:br,filter:Eu,function:po,layer:fl,object:As,source:ml,light:oc,sky:u,terrain:b,projection:function(a){const n=a.value,c=a.styleSpec,m=c.projection,x=a.style,k=on(n);if(n===void 0)return[];if(k!=="object")return[new Tt("projection",n,`object expected, ${k} found`)];let C=[];for(const j in n)C=C.concat(m[j]?a.validateSpec({key:j,value:n[j],valueSpec:m[j],style:x,styleSpec:c}):[new Tt(j,n[j],`unknown property "${j}"`)]);return C},string:Zr,formatted:function(a){return Zr(a).length===0?[]:Fa(a)},resolvedImage:function(a){return Zr(a).length===0?[]:Fa(a)},padding:function(a){const n=a.key,c=a.value;if(on(c)==="array"){if(c.length<1||c.length>4)return[new Tt(n,c,`padding requires 1 to 4 values; ${c.length} values found`)];const m={type:"number"};let x=[];for(let k=0;k<c.length;k++)x=x.concat(a.validateSpec({key:`${n}[${k}]`,value:c[k],validateSpec:a.validateSpec,valueSpec:m}));return x}return ua({key:n,value:c,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const n=a.key,c=a.value,m=on(c),x=a.styleSpec;if(m!=="array"||c.length<1||c.length%2!=0)return[new Tt(n,c,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let C=0;C<c.length;C+=2)k=k.concat(br({key:`${n}[${C}]`,value:c[C],valueSpec:x.layout_symbol["text-anchor"]})),k=k.concat(dl({key:`${n}[${C+1}]`,value:c[C+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:x}));return k},sprite:M};function Z(a){const n=a.value,c=a.valueSpec,m=a.styleSpec;return a.validateSpec=Z,c.expression&&ol(ss(n))?po(a):c.expression&&fo(xr(n))?Fa(a):c.type&&$[c.type]?$[c.type](a):As(On({},a,{valueSpec:c.type?m[c.type]:c}))}function le(a){const n=a.value,c=a.key,m=Zr(a);return m.length||(n.indexOf("{fontstack}")===-1&&m.push(new Tt(c,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&m.push(new Tt(c,n,'"glyphs" url must include a "{range}" token'))),m}function Ce(a,n=tt){let c=[];return c=c.concat(Z({key:"",value:a,valueSpec:n.$root,styleSpec:n,style:a,validateSpec:Z,objectElementValidators:{glyphs:le,"*":()=>[]}})),a.constants&&(c=c.concat(vr({key:"constants",value:a.constants}))),ht(c)}function We(a){return function(n){return a({...n,validateSpec:Z})}}function ht(a){return[].concat(a).sort(((n,c)=>n.line-c.line))}function wt(a){return function(...n){return ht(a.apply(this,n))}}Ce.source=wt(We(ml)),Ce.sprite=wt(We(M)),Ce.glyphs=wt(We(le)),Ce.light=wt(We(oc)),Ce.sky=wt(We(u)),Ce.terrain=wt(We(b)),Ce.layer=wt(We(fl)),Ce.filter=wt(We(Eu)),Ce.paintProperty=wt(We(Hr)),Ce.layoutProperty=wt(We(ac));const Yt=Ce,Si=Yt.light,ln=Yt.sky,qs=Yt.paintProperty,bs=Yt.layoutProperty;function wr(a,n){let c=!1;if(n&&n.length)for(const m of n)a.fire(new cn(new Error(m.message))),c=!0;return c}class bn{constructor(n,c,m){const x=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const C=new Int32Array(this.arrayBuffer);n=C[0],this.d=(c=C[1])+2*(m=C[2]);for(let R=0;R<this.d*this.d;R++){const F=C[3+R],q=C[3+R+1];x.push(F===q?null:C.subarray(F,q))}const j=C[3+x.length+1];this.keys=C.subarray(C[3+x.length],j),this.bboxes=C.subarray(j),this.insert=this._insertReadonly}else{this.d=c+2*m;for(let C=0;C<this.d*this.d;C++)x.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=n,this.padding=m,this.scale=c/n,this.uid=0;const k=m/c*n;this.min=-k,this.max=n+k}insert(n,c,m,x,k){this._forEachCell(c,m,x,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,c,m,x,k,C){this.cells[k].push(C)}query(n,c,m,x,k){const C=this.min,j=this.max;if(n<=C&&c<=C&&j<=m&&j<=x&&!k)return Array.prototype.slice.call(this.keys);{const R=[];return this._forEachCell(n,c,m,x,this._queryCell,R,{},k),R}}_queryCell(n,c,m,x,k,C,j,R){const F=this.cells[k];if(F!==null){const q=this.keys,G=this.bboxes;for(let J=0;J<F.length;J++){const re=F[J];if(j[re]===void 0){const ce=4*re;(R?R(G[ce+0],G[ce+1],G[ce+2],G[ce+3]):n<=G[ce+2]&&c<=G[ce+3]&&m>=G[ce+0]&&x>=G[ce+1])?(j[re]=!0,C.push(q[re])):j[re]=!1}}}}_forEachCell(n,c,m,x,k,C,j,R){const F=this._convertToCellCoord(n),q=this._convertToCellCoord(c),G=this._convertToCellCoord(m),J=this._convertToCellCoord(x);for(let re=F;re<=G;re++)for(let ce=q;ce<=J;ce++){const he=this.d*ce+re;if((!R||R(this._convertFromCellCoord(re),this._convertFromCellCoord(ce),this._convertFromCellCoord(re+1),this._convertFromCellCoord(ce+1)))&&k.call(this,n,c,m,x,he,C,j,R))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,c=3+this.cells.length+1+1;let m=0;for(let C=0;C<this.cells.length;C++)m+=this.cells[C].length;const x=new Int32Array(c+m+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;let k=c;for(let C=0;C<n.length;C++){const j=n[C];x[3+C]=k,x.set(j,k),k+=j.length}return x[3+n.length]=k,x.set(this.keys,k),k+=this.keys.length,x[3+n.length+1]=k,x.set(this.bboxes,k),k+=this.bboxes.length,x.buffer}static serialize(n,c){const m=n.toArrayBuffer();return c&&c.push(m),{buffer:m}}static deserialize(n){return new bn(n.buffer)}}const Qi={};function jt(a,n,c={}){if(Qi[a])throw new Error(`${a} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:a,writeable:!1}),Qi[a]={klass:n,omit:c.omit||[],shallow:c.shallow||[]}}jt("Object",Object),jt("TransferableGridIndex",bn),jt("Color",wi),jt("Error",Error),jt("AJAXError",Ot),jt("ResolvedImage",yr),jt("StylePropertyFunction",ul),jt("StyleExpression",Lo,{omit:["_evaluator"]}),jt("ZoomDependentExpression",Ta),jt("ZoomConstantExpression",Vr),jt("CompoundExpression",nr,{omit:["_evaluate"]});for(const a in Ba)Ba[a]._classRegistryKey||jt(`Expression_${a}`,Ba[a]);function ka(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function jr(a){return a.$name||a.constructor._classRegistryKey}function lc(a){return!(function(n){if(n===null||typeof n!="object")return!1;const c=jr(n);return!(!c||c==="Object")})(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||ka(a)||ot(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function Gr(a,n){if(lc(a))return(ka(a)||ot(a))&&n&&n.push(a),ArrayBuffer.isView(a)&&n&&n.push(a.buffer),a instanceof ImageData&&n&&n.push(a.data.buffer),a;if(Array.isArray(a)){const k=[];for(const C of a)k.push(Gr(C,n));return k}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const c=jr(a);if(!c)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Qi[c])throw new Error(`${c} is not registered.`);const{klass:m}=Qi[c],x=m.serialize?m.serialize(a,n):{};if(m.serialize){if(n&&x===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const k in a){if(!a.hasOwnProperty(k)||Qi[c].omit.indexOf(k)>=0)continue;const C=a[k];x[k]=Qi[c].shallow.indexOf(k)>=0?C:Gr(C,n)}a instanceof Error&&(x.message=a.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(x.$name=c),x}function Do(a){if(lc(a))return a;if(Array.isArray(a))return a.map(Do);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const n=jr(a)||"Object";if(!Qi[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:c}=Qi[n];if(!c)throw new Error(`can't deserialize unregistered class ${n}`);if(c.deserialize)return c.deserialize(a);const m=Object.create(c.prototype);for(const x of Object.keys(a)){if(x==="$name")continue;const k=a[x];m[x]=Qi[n].shallow.indexOf(x)>=0?k:Do(k)}return m}class ms{constructor(){this.first=!0}update(n,c){const m=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=c),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=m,!0))}}const Ui={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function mo(a){for(const n of a)if(Oo(n.charCodeAt(0)))return!0;return!1}function ku(a){for(const n of a)if(!Wr(n.charCodeAt(0)))return!1;return!0}function gl(a){const n=a.map((c=>{try{return new RegExp(`\\p{sc=${c}}`,"u").source}catch{return null}})).filter((c=>c));return new RegExp(n.join("|"),"u")}const cc=gl(["Arab","Dupl","Mong","Ougr","Syrc"]);function Wr(a){return!cc.test(String.fromCodePoint(a))}const Va=gl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Oo(a){return!(a!==746&&a!==747&&(a<4352||!(Ui["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Ui["CJK Compatibility"](a)||Ui["CJK Strokes"](a)||!(!Ui["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Ui["Enclosed CJK Letters and Months"](a)||Ui["Ideographic Description Characters"](a)||Ui.Kanbun(a)||Ui.Katakana(a)&&a!==12540||!(!Ui["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Ui["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Ui["Vertical Forms"](a)||Ui["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Va.test(String.fromCodePoint(a)))))}function No(a){return!(Oo(a)||(function(n){return!!(Ui["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Ui["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Ui["Letterlike Symbols"](n)||Ui["Number Forms"](n)||Ui["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Ui["Control Pictures"](n)&&n!==9251||Ui["Optical Character Recognition"](n)||Ui["Enclosed Alphanumerics"](n)||Ui["Geometric Shapes"](n)||Ui["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Ui["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ui["CJK Symbols and Punctuation"](n)||Ui.Katakana(n)||Ui["Private Use Area"](n)||Ui["CJK Compatibility Forms"](n)||Ui["Small Form Variants"](n)||Ui["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)})(a))}const ed=gl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Cu(a){return ed.test(String.fromCodePoint(a))}function qc(a,n){return!(!n&&Cu(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Ui.Khmer(a))}function oh(a){for(const n of a)if(Cu(n.charCodeAt(0)))return!0;return!1}const Js=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class nn{constructor(n,c){this.zoom=n,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ms,this.transition={})}isSupportedScript(n){return(function(c,m){for(const x of c)if(!qc(x.charCodeAt(0),m))return!1;return!0})(n,Js.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,c=n-Math.floor(n),m=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*c}}}class yl{constructor(n,c){this.property=n,this.value=c,this.expression=(function(m,x){if(ol(m))return new ul(m,x);if(fo(m)){const k=Bl(m,x);if(k.result==="error")throw new Error(k.value.map((C=>`${C.key}: ${C.message}`)).join(", "));return k.value}{let k=m;return x.type==="color"&&typeof m=="string"?k=wi.parse(m):x.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(m)&&(k=ir.parse(m)):k=zs.parse(m),{kind:"constant",evaluate:()=>k}}})(c===void 0?n.specification.default:c,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,c,m){return this.property.possiblyEvaluate(this,n,c,m)}}class Au{constructor(n){this.property=n,this.value=new yl(n,void 0)}transitioned(n,c){return new sf(this.property,this.value,c,ze({},n.transition,this.transition),n.now)}untransitioned(){return new sf(this.property,this.value,null,{},0)}}class lh{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return lt(this._values[n].value.value)}setValue(n,c){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Au(this._values[n].property)),this._values[n].value=new yl(this._values[n].property,c===null?void 0:lt(c))}getTransition(n){return lt(this._values[n].transition)}setTransition(n,c){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Au(this._values[n].property)),this._values[n].transition=lt(c)||void 0}serialize(){const n={};for(const c of Object.keys(this._values)){const m=this.getValue(c);m!==void 0&&(n[c]=m);const x=this.getTransition(c);x!==void 0&&(n[`${c}-transition`]=x)}return n}transitioned(n,c){const m=new Mu(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].transitioned(n,c._values[x]);return m}untransitioned(){const n=new Mu(this._properties);for(const c of Object.keys(this._values))n._values[c]=this._values[c].untransitioned();return n}}class sf{constructor(n,c,m,x,k){this.property=n,this.value=c,this.begin=k+x.delay||0,this.end=this.begin+x.duration||0,n.specification.transition&&(x.delay||x.duration)&&(this.prior=m)}possiblyEvaluate(n,c,m){const x=n.now||0,k=this.value.possiblyEvaluate(n,c,m),C=this.prior;if(C){if(x>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(x<this.begin)return C.possiblyEvaluate(n,c,m);{const j=(x-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(n,c,m),k,(function(R){if(R<=0)return 0;if(R>=1)return 1;const F=R*R,q=F*R;return 4*(R<.5?q:3*(R-F)+q-.75)})(j))}}return k}}class Mu{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,c,m){const x=new _l(this._properties);for(const k of Object.keys(this._values))x._values[k]=this._values[k].possiblyEvaluate(n,c,m);return x}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class _s{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return lt(this._values[n].value)}setValue(n,c){this._values[n]=new yl(this._values[n].property,c===null?void 0:lt(c))}serialize(){const n={};for(const c of Object.keys(this._values)){const m=this.getValue(c);m!==void 0&&(n[c]=m)}return n}possiblyEvaluate(n,c,m){const x=new _l(this._properties);for(const k of Object.keys(this._values))x._values[k]=this._values[k].possiblyEvaluate(n,c,m);return x}}class qa{constructor(n,c,m){this.property=n,this.value=c,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,c,m,x){return this.property.evaluate(this.value,this.parameters,n,c,m,x)}}class _l{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class ui{constructor(n){this.specification=n}possiblyEvaluate(n,c){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(c)}interpolate(n,c,m){const x=Us[this.specification.type];return x?x(n,c,m):n}}class Ti{constructor(n,c){this.specification=n,this.overrides=c}possiblyEvaluate(n,c,m,x){return new qa(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(c,null,{},m,x)}:n.expression,c)}interpolate(n,c,m){if(n.value.kind!=="constant"||c.value.kind!=="constant")return n;if(n.value.value===void 0||c.value.value===void 0)return new qa(this,{kind:"constant",value:void 0},n.parameters);const x=Us[this.specification.type];if(x){const k=x(n.value.value,c.value.value,m);return new qa(this,{kind:"constant",value:k},n.parameters)}return n}evaluate(n,c,m,x,k,C){return n.kind==="constant"?n.value:n.evaluate(c,m,x,k,C)}}class vl extends Ti{possiblyEvaluate(n,c,m,x){if(n.value===void 0)return new qa(this,{kind:"constant",value:void 0},c);if(n.expression.kind==="constant"){const k=n.expression.evaluate(c,null,{},m,x),C=n.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,j=this._calculate(C,C,C,c);return new qa(this,{kind:"constant",value:j},c)}if(n.expression.kind==="camera"){const k=this._calculate(n.expression.evaluate({zoom:c.zoom-1}),n.expression.evaluate({zoom:c.zoom}),n.expression.evaluate({zoom:c.zoom+1}),c);return new qa(this,{kind:"constant",value:k},c)}return new qa(this,n.expression,c)}evaluate(n,c,m,x,k,C){if(n.kind==="source"){const j=n.evaluate(c,m,x,k,C);return this._calculate(j,j,j,c)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(c.zoom)-1},m,x),n.evaluate({zoom:Math.floor(c.zoom)},m,x),n.evaluate({zoom:Math.floor(c.zoom)+1},m,x),c):n.value}_calculate(n,c,m,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:n,to:c}:{from:m,to:c}}interpolate(n){return n}}class xl{constructor(n){this.specification=n}possiblyEvaluate(n,c,m,x){if(n.value!==void 0){if(n.expression.kind==="constant"){const k=n.expression.evaluate(c,null,{},m,x);return this._calculate(k,k,k,c)}return this._calculate(n.expression.evaluate(new nn(Math.floor(c.zoom-1),c)),n.expression.evaluate(new nn(Math.floor(c.zoom),c)),n.expression.evaluate(new nn(Math.floor(c.zoom+1),c)),c)}}_calculate(n,c,m,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:n,to:c}:{from:m,to:c}}interpolate(n){return n}}class td{constructor(n){this.specification=n}possiblyEvaluate(n,c,m,x){return!!n.expression.evaluate(c,null,{},m,x)}interpolate(){return!1}}class E{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in n){const m=n[c];m.specification.overridable&&this.overridableProperties.push(c);const x=this.defaultPropertyValues[c]=new yl(m,void 0),k=this.defaultTransitionablePropertyValues[c]=new Au(m);this.defaultTransitioningPropertyValues[c]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=x.possiblyEvaluate({})}}}jt("DataDrivenProperty",Ti),jt("DataConstantProperty",ui),jt("CrossFadedDataDrivenProperty",vl),jt("CrossFadedProperty",xl),jt("ColorRampProperty",td);const i="-transition";class h extends Zn{constructor(n,c){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),c.layout&&(this._unevaluatedLayout=new _s(c.layout)),c.paint)){this._transitionablePaint=new lh(c.paint);for(const m in n.paint)this.setPaintProperty(m,n.paint[m],{validate:!1});for(const m in n.layout)this.setLayoutProperty(m,n.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _l(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,c,m={}){c!=null&&this._validate(bs,`layers.${this.id}.layout.${n}`,n,c,m)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,c):this.visibility=c)}getPaintProperty(n){return n.endsWith(i)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,c,m={}){if(c!=null&&this._validate(qs,`layers.${this.id}.paint.${n}`,n,c,m))return!1;if(n.endsWith(i))return this._transitionablePaint.setTransition(n.slice(0,-11),c||void 0),!1;{const x=this._transitionablePaint._values[n],k=x.property.specification["property-type"]==="cross-faded-data-driven",C=x.value.isDataDriven(),j=x.value;this._transitionablePaint.setValue(n,c),this._handleSpecialPaintPropertyUpdate(n);const R=this._transitionablePaint._values[n].value;return R.isDataDriven()||C||k||this._handleOverridablePaintPropertyUpdate(n,j,R)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,c,m){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,c){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,c)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),st(n,((c,m)=>!(c===void 0||m==="layout"&&!Object.keys(c).length||m==="paint"&&!Object.keys(c).length)))}_validate(n,c,m,x,k={}){return(!k||k.validate!==!1)&&wr(this,n.call(Yt,{key:c,layerType:this.type,objectKey:m,value:x,styleSpec:tt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const c=this.paint.get(n);if(c instanceof qa&&Nl(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}}const g={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class v{constructor(n,c){this._structArray=n,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class T{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,c){return n._trim(),c&&(n.isTransferred=!0,c.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const c=Object.create(this.prototype);return c.arrayBuffer=n.arrayBuffer,c.length=n.length,c.capacity=n.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function z(a,n=1){let c=0,m=0;return{members:a.map((x=>{const k=g[x.type].BYTES_PER_ELEMENT,C=c=O(c,Math.max(n,k)),j=x.components||1;return m=Math.max(m,k),c+=k*j,{name:x.name,type:x.type,components:j,offset:C}})),size:O(c,Math.max(m,n)),alignment:n}}function O(a,n){return Math.ceil(a/n)*n}class U extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.int16[x+0]=c,this.int16[x+1]=m,n}}U.prototype.bytesPerElement=4,jt("StructArrayLayout2i4",U);class H extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.int16[k+0]=c,this.int16[k+1]=m,this.int16[k+2]=x,n}}H.prototype.bytesPerElement=6,jt("StructArrayLayout3i6",H);class Y extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,n,c,m,x)}emplace(n,c,m,x,k){const C=4*n;return this.int16[C+0]=c,this.int16[C+1]=m,this.int16[C+2]=x,this.int16[C+3]=k,n}}Y.prototype.bytesPerElement=8,jt("StructArrayLayout4i8",Y);class X extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const R=6*n;return this.int16[R+0]=c,this.int16[R+1]=m,this.int16[R+2]=x,this.int16[R+3]=k,this.int16[R+4]=C,this.int16[R+5]=j,n}}X.prototype.bytesPerElement=12,jt("StructArrayLayout2i4i12",X);class oe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const R=4*n,F=8*n;return this.int16[R+0]=c,this.int16[R+1]=m,this.uint8[F+4]=x,this.uint8[F+5]=k,this.uint8[F+6]=C,this.uint8[F+7]=j,n}}oe.prototype.bytesPerElement=8,jt("StructArrayLayout2i4ub8",oe);class fe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.float32[x+0]=c,this.float32[x+1]=m,n}}fe.prototype.bytesPerElement=8,jt("StructArrayLayout2f8",fe);class _e extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,R,F,q){const G=this.length;return this.resize(G+1),this.emplace(G,n,c,m,x,k,C,j,R,F,q)}emplace(n,c,m,x,k,C,j,R,F,q,G){const J=10*n;return this.uint16[J+0]=c,this.uint16[J+1]=m,this.uint16[J+2]=x,this.uint16[J+3]=k,this.uint16[J+4]=C,this.uint16[J+5]=j,this.uint16[J+6]=R,this.uint16[J+7]=F,this.uint16[J+8]=q,this.uint16[J+9]=G,n}}_e.prototype.bytesPerElement=20,jt("StructArrayLayout10ui20",_e);class ke extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,R,F,q,G,J){const re=this.length;return this.resize(re+1),this.emplace(re,n,c,m,x,k,C,j,R,F,q,G,J)}emplace(n,c,m,x,k,C,j,R,F,q,G,J,re){const ce=12*n;return this.int16[ce+0]=c,this.int16[ce+1]=m,this.int16[ce+2]=x,this.int16[ce+3]=k,this.uint16[ce+4]=C,this.uint16[ce+5]=j,this.uint16[ce+6]=R,this.uint16[ce+7]=F,this.int16[ce+8]=q,this.int16[ce+9]=G,this.int16[ce+10]=J,this.int16[ce+11]=re,n}}ke.prototype.bytesPerElement=24,jt("StructArrayLayout4i4ui4i24",ke);class Me extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.float32[k+0]=c,this.float32[k+1]=m,this.float32[k+2]=x,n}}Me.prototype.bytesPerElement=12,jt("StructArrayLayout3f12",Me);class Pe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.uint32[1*n+0]=c,n}}Pe.prototype.bytesPerElement=4,jt("StructArrayLayout1ul4",Pe);class Le extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,R,F){const q=this.length;return this.resize(q+1),this.emplace(q,n,c,m,x,k,C,j,R,F)}emplace(n,c,m,x,k,C,j,R,F,q){const G=10*n,J=5*n;return this.int16[G+0]=c,this.int16[G+1]=m,this.int16[G+2]=x,this.int16[G+3]=k,this.int16[G+4]=C,this.int16[G+5]=j,this.uint32[J+3]=R,this.uint16[G+8]=F,this.uint16[G+9]=q,n}}Le.prototype.bytesPerElement=20,jt("StructArrayLayout6i1ul2ui20",Le);class Te extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const R=6*n;return this.int16[R+0]=c,this.int16[R+1]=m,this.int16[R+2]=x,this.int16[R+3]=k,this.int16[R+4]=C,this.int16[R+5]=j,n}}Te.prototype.bytesPerElement=12,jt("StructArrayLayout2i2i2i12",Te);class $e extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k){const C=this.length;return this.resize(C+1),this.emplace(C,n,c,m,x,k)}emplace(n,c,m,x,k,C){const j=4*n,R=8*n;return this.float32[j+0]=c,this.float32[j+1]=m,this.float32[j+2]=x,this.int16[R+6]=k,this.int16[R+7]=C,n}}$e.prototype.bytesPerElement=16,jt("StructArrayLayout2f1f2i16",$e);class Ve extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C){const j=this.length;return this.resize(j+1),this.emplace(j,n,c,m,x,k,C)}emplace(n,c,m,x,k,C,j){const R=16*n,F=4*n,q=8*n;return this.uint8[R+0]=c,this.uint8[R+1]=m,this.float32[F+1]=x,this.float32[F+2]=k,this.int16[q+6]=C,this.int16[q+7]=j,n}}Ve.prototype.bytesPerElement=16,jt("StructArrayLayout2ub2f2i16",Ve);class it extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.uint16[k+0]=c,this.uint16[k+1]=m,this.uint16[k+2]=x,n}}it.prototype.bytesPerElement=6,jt("StructArrayLayout3ui6",it);class bt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,R,F,q,G,J,re,ce,he,Ee,Ae){const Xe=this.length;return this.resize(Xe+1),this.emplace(Xe,n,c,m,x,k,C,j,R,F,q,G,J,re,ce,he,Ee,Ae)}emplace(n,c,m,x,k,C,j,R,F,q,G,J,re,ce,he,Ee,Ae,Xe){const De=24*n,Ge=12*n,pt=48*n;return this.int16[De+0]=c,this.int16[De+1]=m,this.uint16[De+2]=x,this.uint16[De+3]=k,this.uint32[Ge+2]=C,this.uint32[Ge+3]=j,this.uint32[Ge+4]=R,this.uint16[De+10]=F,this.uint16[De+11]=q,this.uint16[De+12]=G,this.float32[Ge+7]=J,this.float32[Ge+8]=re,this.uint8[pt+36]=ce,this.uint8[pt+37]=he,this.uint8[pt+38]=Ee,this.uint32[Ge+10]=Ae,this.int16[De+22]=Xe,n}}bt.prototype.bytesPerElement=48,jt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",bt);class Ut extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x,k,C,j,R,F,q,G,J,re,ce,he,Ee,Ae,Xe,De,Ge,pt,Dt,Qt,Ai,Vt,Gt,fi,ci){const ri=this.length;return this.resize(ri+1),this.emplace(ri,n,c,m,x,k,C,j,R,F,q,G,J,re,ce,he,Ee,Ae,Xe,De,Ge,pt,Dt,Qt,Ai,Vt,Gt,fi,ci)}emplace(n,c,m,x,k,C,j,R,F,q,G,J,re,ce,he,Ee,Ae,Xe,De,Ge,pt,Dt,Qt,Ai,Vt,Gt,fi,ci,ri){const vt=32*n,li=16*n;return this.int16[vt+0]=c,this.int16[vt+1]=m,this.int16[vt+2]=x,this.int16[vt+3]=k,this.int16[vt+4]=C,this.int16[vt+5]=j,this.int16[vt+6]=R,this.int16[vt+7]=F,this.uint16[vt+8]=q,this.uint16[vt+9]=G,this.uint16[vt+10]=J,this.uint16[vt+11]=re,this.uint16[vt+12]=ce,this.uint16[vt+13]=he,this.uint16[vt+14]=Ee,this.uint16[vt+15]=Ae,this.uint16[vt+16]=Xe,this.uint16[vt+17]=De,this.uint16[vt+18]=Ge,this.uint16[vt+19]=pt,this.uint16[vt+20]=Dt,this.uint16[vt+21]=Qt,this.uint16[vt+22]=Ai,this.uint32[li+12]=Vt,this.float32[li+13]=Gt,this.float32[li+14]=fi,this.uint16[vt+30]=ci,this.uint16[vt+31]=ri,n}}Ut.prototype.bytesPerElement=64,jt("StructArrayLayout8i15ui1ul2f2ui64",Ut);class qt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.float32[1*n+0]=c,n}}qt.prototype.bytesPerElement=4,jt("StructArrayLayout1f4",qt);class ii extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=3*n;return this.uint16[6*n+0]=c,this.float32[k+1]=m,this.float32[k+2]=x,n}}ii.prototype.bytesPerElement=12,jt("StructArrayLayout1ui2f12",ii);class Ht extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,c,m)}emplace(n,c,m,x){const k=4*n;return this.uint32[2*n+0]=c,this.uint16[k+2]=m,this.uint16[k+3]=x,n}}Ht.prototype.bytesPerElement=8,jt("StructArrayLayout1ul2ui8",Ht);class Ft extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,c)}emplace(n,c,m){const x=2*n;return this.uint16[x+0]=c,this.uint16[x+1]=m,n}}Ft.prototype.bytesPerElement=4,jt("StructArrayLayout2ui4",Ft);class oi extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const c=this.length;return this.resize(c+1),this.emplace(c,n)}emplace(n,c){return this.uint16[1*n+0]=c,n}}oi.prototype.bytesPerElement=2,jt("StructArrayLayout1ui2",oi);class ji extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,c,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,n,c,m,x)}emplace(n,c,m,x,k){const C=4*n;return this.float32[C+0]=c,this.float32[C+1]=m,this.float32[C+2]=x,this.float32[C+3]=k,n}}ji.prototype.bytesPerElement=16,jt("StructArrayLayout4f16",ji);class Zt extends v{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new N(this.anchorPointX,this.anchorPointY)}}Zt.prototype.size=20;class Xt extends Le{get(n){return new Zt(this,n)}}jt("CollisionBoxArray",Xt);class Ii extends v{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ii.prototype.size=48;class Vn extends bt{get(n){return new Ii(this,n)}}jt("PlacedSymbolArray",Vn);class Xi extends v{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Xi.prototype.size=64;class un extends Ut{get(n){return new Xi(this,n)}}jt("SymbolInstanceArray",un);class $n extends qt{getoffsetX(n){return this.float32[1*n+0]}}jt("GlyphOffsetArray",$n);class Qs extends H{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}jt("SymbolLineVertexArray",Qs);class Ha extends v{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ha.prototype.size=12;class Jn extends ii{get(n){return new Ha(this,n)}}jt("TextAnchorOffsetArray",Jn);class Lr extends v{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Lr.prototype.size=8;class rs extends Ht{get(n){return new Lr(this,n)}}jt("FeatureIndexArray",rs);class as extends U{}class Ms extends U{}class Za extends U{}class uc extends X{}class go extends oe{}class sr extends fe{}class Rn extends _e{}class hc extends ke{}class yo extends Me{}class Ri extends Pe{}class gn extends Te{}class os extends Ve{}class ha extends it{}class Ps extends Ft{}const Is=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:zr}=Is;class sn{constructor(n=[]){this.segments=n}prepareSegment(n,c,m,x){let k=this.segments[this.segments.length-1];return n>sn.MAX_VERTEX_ARRAY_LENGTH&&Mt(`Max vertices per segment is ${sn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!k||k.vertexLength+n>sn.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==x)&&(k={vertexOffset:c.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},x!==void 0&&(k.sortKey=x),this.segments.push(k)),k}get(){return this.segments}destroy(){for(const n of this.segments)for(const c in n.vaos)n.vaos[c].destroy()}static simpleSegment(n,c,m,x){return new sn([{vertexOffset:n,primitiveOffset:c,vertexLength:m,primitiveLength:x,vaos:{},sortKey:0}])}}function Ga(a,n){return 256*(a=ye(Math.floor(a),0,255))+ye(Math.floor(n),0,255)}sn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jt("SegmentVector",sn);const Hc=z([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ls={exports:{}},ch={exports:{}};ch.exports=function(a,n){var c,m,x,k,C,j,R,F;for(m=a.length-(c=3&a.length),x=n,C=3432918353,j=461845907,F=0;F<m;)R=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,x=27492+(65535&(k=5*(65535&(x=(x^=R=(65535&(R=(R=(65535&R)*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*j+(((R>>>16)*j&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(R=0,c){case 3:R^=(255&a.charCodeAt(F+2))<<16;case 2:R^=(255&a.charCodeAt(F+1))<<8;case 1:x^=R=(65535&(R=(R=(65535&(R^=255&a.charCodeAt(F)))*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*j+(((R>>>16)*j&65535)<<16)&4294967295}return x^=a.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0};var id=ch.exports,nd={exports:{}};nd.exports=function(a,n){for(var c,m=a.length,x=n^m,k=0;m>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(k)|(255&a.charCodeAt(++k))<<8|(255&a.charCodeAt(++k))<<16|(255&a.charCodeAt(++k))<<24))+((1540483477*(c>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),m-=4,++k;switch(m){case 3:x^=(255&a.charCodeAt(k+2))<<16;case 2:x^=(255&a.charCodeAt(k+1))<<8;case 1:x=1540483477*(65535&(x^=255&a.charCodeAt(k)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0};var bl=id,rf=nd.exports;ls.exports=bl,ls.exports.murmur3=bl,ls.exports.murmur2=rf;var Zc=A(ls.exports);class dc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,c,m,x){this.ids.push(Gc(n)),this.positions.push(c,m,x)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Gc(n);let m=0,x=this.ids.length-1;for(;m<x;){const C=m+x>>1;this.ids[C]>=c?x=C:m=C+1}const k=[];for(;this.ids[m]===c;)k.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return k}static serialize(n,c){const m=new Float64Array(n.ids),x=new Uint32Array(n.positions);return rr(m,x,0,m.length-1),c&&c.push(m.buffer,x.buffer),{ids:m,positions:x}}static deserialize(n){const c=new dc;return c.ids=n.ids,c.positions=n.positions,c.indexed=!0,c}}function Gc(a){const n=+a;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Zc(String(a))}function rr(a,n,c,m){for(;c<m;){const x=a[c+m>>1];let k=c-1,C=m+1;for(;;){do k++;while(a[k]<x);do C--;while(a[C]>x);if(k>=C)break;hs(a,k,C),hs(n,3*k,3*C),hs(n,3*k+1,3*C+1),hs(n,3*k+2,3*C+2)}C-c<m-C?(rr(a,n,c,C),c=C+1):(rr(a,n,C+1,m),m=C)}}function hs(a,n,c){const m=a[n];a[n]=a[c],a[c]=m}jt("FeaturePositionMap",dc);class Fl{constructor(n,c){this.gl=n.gl,this.location=c}}class Wc extends Fl{constructor(n,c){super(n,c),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class sd extends Fl{constructor(n,c){super(n,c),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class af extends Fl{constructor(n,c){super(n,c),this.current=wi.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const fc=new Float32Array(16);function uh(a){return[Ga(255*a.r,255*a.g),Ga(255*a.b,255*a.a)]}class Pu{constructor(n,c,m){this.value=n,this.uniformNames=c.map((x=>`u_${x}`)),this.type=m}setUniform(n,c,m){n.set(m.constantOr(this.value))}getBinding(n,c,m){return this.type==="color"?new af(n,c):new Wc(n,c)}}class Yc{constructor(n,c){this.uniformNames=c.map((m=>`u_${m}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=n.tlbr}setUniform(n,c,m,x){const k=x==="u_pattern_to"?this.patternTo:x==="u_pattern_from"?this.patternFrom:x==="u_pixel_ratio_to"?this.pixelRatioTo:x==="u_pixel_ratio_from"?this.pixelRatioFrom:null;k&&n.set(k)}getBinding(n,c,m){return m.substr(0,9)==="u_pattern"?new sd(n,c):new Wc(n,c)}}class Vl{constructor(n,c,m,x){this.expression=n,this.type=m,this.maxValue=0,this.paintVertexAttributes=c.map((k=>({name:`a_${k}`,type:"Float32",components:m==="color"?2:1,offset:0}))),this.paintVertexArray=new x}populatePaintArray(n,c,m,x,k){const C=this.paintVertexArray.length,j=this.expression.evaluate(new nn(0),c,{},x,[],k);this.paintVertexArray.resize(n),this._setPaintValue(C,n,j)}updatePaintArray(n,c,m,x){const k=this.expression.evaluate({zoom:0},m,x);this._setPaintValue(n,c,k)}_setPaintValue(n,c,m){if(this.type==="color"){const x=uh(m);for(let k=n;k<c;k++)this.paintVertexArray.emplace(k,x[0],x[1])}else{for(let x=n;x<c;x++)this.paintVertexArray.emplace(x,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bo{constructor(n,c,m,x,k,C){this.expression=n,this.uniformNames=c.map((j=>`u_${j}_t`)),this.type=m,this.useIntegerZoom=x,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=c.map((j=>({name:`a_${j}`,type:"Float32",components:m==="color"?4:2,offset:0}))),this.paintVertexArray=new C}populatePaintArray(n,c,m,x,k){const C=this.expression.evaluate(new nn(this.zoom),c,{},x,[],k),j=this.expression.evaluate(new nn(this.zoom+1),c,{},x,[],k),R=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(R,n,C,j)}updatePaintArray(n,c,m,x){const k=this.expression.evaluate({zoom:this.zoom},m,x),C=this.expression.evaluate({zoom:this.zoom+1},m,x);this._setPaintValue(n,c,k,C)}_setPaintValue(n,c,m,x){if(this.type==="color"){const k=uh(m),C=uh(x);for(let j=n;j<c;j++)this.paintVertexArray.emplace(j,k[0],k[1],C[0],C[1])}else{for(let k=n;k<c;k++)this.paintVertexArray.emplace(k,m,x);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(x))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,c){const m=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,x=ye(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);n.set(x)}getBinding(n,c,m){return new Wc(n,c)}}class pc{constructor(n,c,m,x,k,C){this.expression=n,this.type=c,this.useIntegerZoom=m,this.zoom=x,this.layerId=C,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(n,c,m){const x=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(x,n,c.patterns&&c.patterns[this.layerId],m)}updatePaintArray(n,c,m,x,k){this._setPaintValues(n,c,m.patterns&&m.patterns[this.layerId],k)}_setPaintValues(n,c,m,x){if(!x||!m)return;const{min:k,mid:C,max:j}=m,R=x[k],F=x[C],q=x[j];if(R&&F&&q)for(let G=n;G<c;G++)this.zoomInPaintVertexArray.emplace(G,F.tl[0],F.tl[1],F.br[0],F.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],F.pixelRatio,R.pixelRatio),this.zoomOutPaintVertexArray.emplace(G,F.tl[0],F.tl[1],F.br[0],F.br[1],q.tl[0],q.tl[1],q.br[0],q.br[1],F.pixelRatio,q.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Hc.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Hc.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class yp{constructor(n,c,m){this.binders={},this._buffers=[];const x=[];for(const k in n.paint._values){if(!m(k))continue;const C=n.paint.get(k);if(!(C instanceof qa&&Nl(C.property.specification)))continue;const j=ng(k,n.type),R=C.value,F=C.property.specification.type,q=C.property.useIntegerZoom,G=C.property.specification["property-type"],J=G==="cross-faded"||G==="cross-faded-data-driven";if(R.kind==="constant")this.binders[k]=J?new Yc(R.value,j):new Pu(R.value,j,F),x.push(`/u_${k}`);else if(R.kind==="source"||J){const re=of(k,F,"source");this.binders[k]=J?new pc(R,F,q,c,re,n.id):new Vl(R,j,F,re),x.push(`/a_${k}`)}else{const re=of(k,F,"composite");this.binders[k]=new Bo(R,j,F,q,c,re),x.push(`/z_${k}`)}}this.cacheKey=x.sort().join("")}getMaxValue(n){const c=this.binders[n];return c instanceof Vl||c instanceof Bo?c.maxValue:0}populatePaintArrays(n,c,m,x,k){for(const C in this.binders){const j=this.binders[C];(j instanceof Vl||j instanceof Bo||j instanceof pc)&&j.populatePaintArray(n,c,m,x,k)}}setConstantPatternPositions(n,c){for(const m in this.binders){const x=this.binders[m];x instanceof Yc&&x.setConstantPatternPositions(n,c)}}updatePaintArrays(n,c,m,x,k){let C=!1;for(const j in n){const R=c.getPositions(j);for(const F of R){const q=m.feature(F.index);for(const G in this.binders){const J=this.binders[G];if((J instanceof Vl||J instanceof Bo||J instanceof pc)&&J.expression.isStateDependent===!0){const re=x.paint.get(G);J.expression=re.value,J.updatePaintArray(F.start,F.end,q,n[j],k),C=!0}}}}return C}defines(){const n=[];for(const c in this.binders){const m=this.binders[c];(m instanceof Pu||m instanceof Yc)&&n.push(...m.uniformNames.map((x=>`#define HAS_UNIFORM_${x}`)))}return n}getBinderAttributes(){const n=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof Vl||m instanceof Bo)for(let x=0;x<m.paintVertexAttributes.length;x++)n.push(m.paintVertexAttributes[x].name);else if(m instanceof pc)for(let x=0;x<Hc.members.length;x++)n.push(Hc.members[x].name)}return n}getBinderUniforms(){const n=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof Pu||m instanceof Yc||m instanceof Bo)for(const x of m.uniformNames)n.push(x)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,c){const m=[];for(const x in this.binders){const k=this.binders[x];if(k instanceof Pu||k instanceof Yc||k instanceof Bo){for(const C of k.uniformNames)if(c[C]){const j=k.getBinding(n,c[C],C);m.push({name:C,property:x,binding:j})}}}return m}setUniforms(n,c,m,x){for(const{name:k,property:C,binding:j}of c)this.binders[C].setUniform(j,x,m.get(C),k)}updatePaintBuffers(n){this._buffers=[];for(const c in this.binders){const m=this.binders[c];if(n&&m instanceof pc){const x=n.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;x&&this._buffers.push(x)}else(m instanceof Vl||m instanceof Bo)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(n){for(const c in this.binders){const m=this.binders[c];(m instanceof Vl||m instanceof Bo||m instanceof pc)&&m.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const c=this.binders[n];(c instanceof Vl||c instanceof Bo||c instanceof pc)&&c.destroy()}}}class Xc{constructor(n,c,m=(()=>!0)){this.programConfigurations={};for(const x of n)this.programConfigurations[x.id]=new yp(x,c,m);this.needsUpload=!1,this._featureMap=new dc,this._bufferOffset=0}populatePaintArrays(n,c,m,x,k,C){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(n,c,x,k,C);c.id!==void 0&&this._featureMap.add(c.id,m,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,c,m,x){for(const k of m)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(n,this._featureMap,c,k,x)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function ng(a,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${n}-`,"").replace(/-/g,"_")]}function of(a,n,c){const m={color:{source:fe,composite:ji},number:{source:qt,composite:fe}},x=(function(k){return{"line-pattern":{source:Rn,composite:Rn},"fill-pattern":{source:Rn,composite:Rn},"fill-extrusion-pattern":{source:Rn,composite:Rn}}[k]})(a);return x&&x[c]||m[n][c]}jt("ConstantBinder",Pu),jt("CrossFadedConstantBinder",Yc),jt("SourceExpressionBinder",Vl),jt("CrossFadedCompositeBinder",pc),jt("CompositeExpressionBinder",Bo),jt("ProgramConfiguration",yp,{omit:["_buffers"]}),jt("ProgramConfigurationSet",Xc);const Ds=8192,_p=Math.pow(2,14)-1,vp=-_p-1;function Kc(a){const n=Ds/a.extent,c=a.loadGeometry();for(let m=0;m<c.length;m++){const x=c[m];for(let k=0;k<x.length;k++){const C=x[k],j=Math.round(C.x*n),R=Math.round(C.y*n);C.x=ye(j,vp,_p),C.y=ye(R,vp,_p),(j<C.x||j>C.x+1||R<C.y||R>C.y+1)&&Mt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Jc(a,n){return{type:a.type,id:a.id,properties:a.properties,geometry:n?Kc(a):[]}}function hh(a,n,c,m,x){a.emplaceBack(2*n+(m+1)/2,2*c+(x+1)/2)}class lf{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Ms,this.indexArray=new ha,this.segments=new sn,this.programConfigurations=new Xc(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){const x=this.layers[0],k=[];let C=null,j=!1;x.type==="circle"&&(C=x.layout.get("circle-sort-key"),j=!C.isConstant());for(const{feature:R,id:F,index:q,sourceLayerIndex:G}of n){const J=this.layers[0]._featureFilter.needGeometry,re=Jc(R,J);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),re,m))continue;const ce=j?C.evaluate(re,{},m):void 0,he={id:F,properties:R.properties,type:R.type,sourceLayerIndex:G,index:q,geometry:J?re.geometry:Kc(R),patterns:{},sortKey:ce};k.push(he)}j&&k.sort(((R,F)=>R.sortKey-F.sortKey));for(const R of k){const{geometry:F,index:q,sourceLayerIndex:G}=R,J=n[q].feature;this.addFeature(R,F,q,m),c.featureIndex.insert(J,F,q,G,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,zr),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,c,m,x){for(const k of c)for(const C of k){const j=C.x,R=C.y;if(j<0||j>=Ds||R<0||R>=Ds)continue;const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),q=F.vertexLength;hh(this.layoutVertexArray,j,R,-1,-1),hh(this.layoutVertexArray,j,R,1,-1),hh(this.layoutVertexArray,j,R,1,1),hh(this.layoutVertexArray,j,R,-1,1),this.indexArray.emplaceBack(q,q+1,q+2),this.indexArray.emplaceBack(q,q+3,q+2),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,{},x)}}function xp(a,n){for(let c=0;c<a.length;c++)if(mc(n,a[c]))return!0;for(let c=0;c<n.length;c++)if(mc(a,n[c]))return!0;return!!wp(a,n)}function sg(a,n,c){return!!mc(a,n)||!!Qc(n,a,c)}function bp(a,n){if(a.length===1)return rd(n,a[0]);for(let c=0;c<n.length;c++){const m=n[c];for(let x=0;x<m.length;x++)if(mc(a,m[x]))return!0}for(let c=0;c<a.length;c++)if(rd(n,a[c]))return!0;for(let c=0;c<n.length;c++)if(wp(a,n[c]))return!0;return!1}function rg(a,n,c){if(a.length>1){if(wp(a,n))return!0;for(let m=0;m<n.length;m++)if(Qc(n[m],a,c))return!0}for(let m=0;m<a.length;m++)if(Qc(a[m],n,c))return!0;return!1}function wp(a,n){if(a.length===0||n.length===0)return!1;for(let c=0;c<a.length-1;c++){const m=a[c],x=a[c+1];for(let k=0;k<n.length-1;k++)if(ag(m,x,n[k],n[k+1]))return!0}return!1}function ag(a,n,c,m){return gt(a,c,m)!==gt(n,c,m)&&gt(a,n,c)!==gt(a,n,m)}function Qc(a,n,c){const m=c*c;if(n.length===1)return a.distSqr(n[0])<m;for(let x=1;x<n.length;x++)if(Sp(a,n[x-1],n[x])<m)return!0;return!1}function Sp(a,n,c){const m=n.distSqr(c);if(m===0)return a.distSqr(n);const x=((a.x-n.x)*(c.x-n.x)+(a.y-n.y)*(c.y-n.y))/m;return a.distSqr(x<0?n:x>1?c:c.sub(n)._mult(x)._add(n))}function rd(a,n){let c,m,x,k=!1;for(let C=0;C<a.length;C++){c=a[C];for(let j=0,R=c.length-1;j<c.length;R=j++)m=c[j],x=c[R],m.y>n.y!=x.y>n.y&&n.x<(x.x-m.x)*(n.y-m.y)/(x.y-m.y)+m.x&&(k=!k)}return k}function mc(a,n){let c=!1;for(let m=0,x=a.length-1;m<a.length;x=m++){const k=a[m],C=a[x];k.y>n.y!=C.y>n.y&&n.x<(C.x-k.x)*(n.y-k.y)/(C.y-k.y)+k.x&&(c=!c)}return c}function og(a,n,c){const m=c[0],x=c[2];if(a.x<m.x&&n.x<m.x||a.x>x.x&&n.x>x.x||a.y<m.y&&n.y<m.y||a.y>x.y&&n.y>x.y)return!1;const k=gt(a,n,c[0]);return k!==gt(a,n,c[1])||k!==gt(a,n,c[2])||k!==gt(a,n,c[3])}function Iu(a,n,c){const m=n.paint.get(a).value;return m.kind==="constant"?m.value:c.programConfigurations.get(n.id).getMaxValue(a)}function cf(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function ad(a,n,c,m,x){if(!n[0]&&!n[1])return a;const k=N.convert(n)._mult(x);c==="viewport"&&k._rotate(-m);const C=[];for(let j=0;j<a.length;j++)C.push(a[j].sub(k));return C}let Tp,Ep;jt("CircleBucket",lf,{omit:["layers"]});var lg={get paint(){return Ep=Ep||new E({"circle-radius":new Ti(tt.paint_circle["circle-radius"]),"circle-color":new Ti(tt.paint_circle["circle-color"]),"circle-blur":new Ti(tt.paint_circle["circle-blur"]),"circle-opacity":new Ti(tt.paint_circle["circle-opacity"]),"circle-translate":new ui(tt.paint_circle["circle-translate"]),"circle-translate-anchor":new ui(tt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ui(tt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ui(tt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ti(tt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ti(tt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ti(tt.paint_circle["circle-stroke-opacity"])})},get layout(){return Tp=Tp||new E({"circle-sort-key":new Ti(tt.layout_circle["circle-sort-key"])})}},Yr=1e-6,eu=typeof Float32Array<"u"?Float32Array:Array;function uf(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function kp(a,n,c){var m=n[0],x=n[1],k=n[2],C=n[3],j=n[4],R=n[5],F=n[6],q=n[7],G=n[8],J=n[9],re=n[10],ce=n[11],he=n[12],Ee=n[13],Ae=n[14],Xe=n[15],De=c[0],Ge=c[1],pt=c[2],Dt=c[3];return a[0]=De*m+Ge*j+pt*G+Dt*he,a[1]=De*x+Ge*R+pt*J+Dt*Ee,a[2]=De*k+Ge*F+pt*re+Dt*Ae,a[3]=De*C+Ge*q+pt*ce+Dt*Xe,a[4]=(De=c[4])*m+(Ge=c[5])*j+(pt=c[6])*G+(Dt=c[7])*he,a[5]=De*x+Ge*R+pt*J+Dt*Ee,a[6]=De*k+Ge*F+pt*re+Dt*Ae,a[7]=De*C+Ge*q+pt*ce+Dt*Xe,a[8]=(De=c[8])*m+(Ge=c[9])*j+(pt=c[10])*G+(Dt=c[11])*he,a[9]=De*x+Ge*R+pt*J+Dt*Ee,a[10]=De*k+Ge*F+pt*re+Dt*Ae,a[11]=De*C+Ge*q+pt*ce+Dt*Xe,a[12]=(De=c[12])*m+(Ge=c[13])*j+(pt=c[14])*G+(Dt=c[15])*he,a[13]=De*x+Ge*R+pt*J+Dt*Ee,a[14]=De*k+Ge*F+pt*re+Dt*Ae,a[15]=De*C+Ge*q+pt*ce+Dt*Xe,a}Math.hypot||(Math.hypot=function(){for(var a=0,n=arguments.length;n--;)a+=arguments[n]*arguments[n];return Math.sqrt(a)});var ju,cg=kp;function od(a,n,c){var m=n[0],x=n[1],k=n[2],C=n[3];return a[0]=c[0]*m+c[4]*x+c[8]*k+c[12]*C,a[1]=c[1]*m+c[5]*x+c[9]*k+c[13]*C,a[2]=c[2]*m+c[6]*x+c[10]*k+c[14]*C,a[3]=c[3]*m+c[7]*x+c[11]*k+c[15]*C,a}ju=new eu(4),eu!=Float32Array&&(ju[0]=0,ju[1]=0,ju[2]=0,ju[3]=0);class __ extends h{constructor(n){super(n,lg)}createBucket(n){return new lf(n)}queryRadius(n){const c=n;return Iu("circle-radius",this,c)+Iu("circle-stroke-width",this,c)+cf(this.paint.get("circle-translate"))}queryIntersectsFeature(n,c,m,x,k,C,j,R){const F=ad(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),C.angle,j),q=this.paint.get("circle-radius").evaluate(c,m)+this.paint.get("circle-stroke-width").evaluate(c,m),G=this.paint.get("circle-pitch-alignment")==="map",J=G?F:(function(ce,he){return ce.map((Ee=>hf(Ee,he)))})(F,R),re=G?q*j:q;for(const ce of x)for(const he of ce){const Ee=G?he:hf(he,R);let Ae=re;const Xe=od([],[he.x,he.y,0,1],R);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ae*=Xe[3]/C.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ae*=C.cameraToCenterDistance/Xe[3]),sg(J,Ee,Ae))return!0}return!1}}function hf(a,n){const c=od([],[a.x,a.y,0,1],n);return new N(c[0]/c[3],c[1]/c[3])}class Cp extends lf{}let Ap;jt("HeatmapBucket",Cp,{omit:["layers"]});var Mp={get paint(){return Ap=Ap||new E({"heatmap-radius":new Ti(tt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ti(tt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ui(tt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new td(tt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ui(tt.paint_heatmap["heatmap-opacity"])})}};function df(a,{width:n,height:c},m,x){if(x){if(x instanceof Uint8ClampedArray)x=new Uint8Array(x.buffer);else if(x.length!==n*c*m)throw new RangeError(`mismatched image size. expected: ${x.length} but got: ${n*c*m}`)}else x=new Uint8Array(n*c*m);return a.width=n,a.height=c,a.data=x,a}function Pp(a,{width:n,height:c},m){if(n===a.width&&c===a.height)return;const x=df({},{width:n,height:c},m);Ip(a,x,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,n),height:Math.min(a.height,c)},m),a.width=n,a.height=c,a.data=x.data}function Ip(a,n,c,m,x,k){if(x.width===0||x.height===0)return n;if(x.width>a.width||x.height>a.height||c.x>a.width-x.width||c.y>a.height-x.height)throw new RangeError("out of range source coordinates for image copy");if(x.width>n.width||x.height>n.height||m.x>n.width-x.width||m.y>n.height-x.height)throw new RangeError("out of range destination coordinates for image copy");const C=a.data,j=n.data;if(C===j)throw new Error("srcData equals dstData, so image is already copied");for(let R=0;R<x.height;R++){const F=((c.y+R)*a.width+c.x)*k,q=((m.y+R)*n.width+m.x)*k;for(let G=0;G<x.width*k;G++)j[q+G]=C[F+G]}return n}class ld{constructor(n,c){df(this,n,1,c)}resize(n){Pp(this,n,1)}clone(){return new ld({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,c,m,x,k){Ip(n,c,m,x,k,1)}}class Wa{constructor(n,c){df(this,n,4,c)}resize(n){Pp(this,n,4)}replace(n,c){c?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Wa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,c,m,x,k){Ip(n,c,m,x,k,4)}}function dh(a){const n={},c=a.resolution||256,m=a.clips?a.clips.length:1,x=a.image||new Wa({width:c,height:m});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const k=(C,j,R)=>{n[a.evaluationKey]=R;const F=a.expression.evaluate(n);x.data[C+j+0]=Math.floor(255*F.r/F.a),x.data[C+j+1]=Math.floor(255*F.g/F.a),x.data[C+j+2]=Math.floor(255*F.b/F.a),x.data[C+j+3]=Math.floor(255*F.a)};if(a.clips)for(let C=0,j=0;C<m;++C,j+=4*c)for(let R=0,F=0;R<c;R++,F+=4){const q=R/(c-1),{start:G,end:J}=a.clips[C];k(j,F,G*(1-q)+J*q)}else for(let C=0,j=0;C<c;C++,j+=4)k(0,j,C/(c-1));return x}jt("AlphaImage",ld),jt("RGBAImage",Wa);const cd="big-fb";class ff extends h{createBucket(n){return new Cp(n)}constructor(n){super(n,Mp),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=dh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(cd)&&this.heatmapFbos.delete(cd)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let jp;var ug={get paint(){return jp=jp||new E({"hillshade-illumination-direction":new ui(tt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ui(tt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ui(tt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ui(tt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ui(tt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ui(tt.paint_hillshade["hillshade-accent-color"])})}};class ud extends h{constructor(n){super(n,ug)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const hg=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:Lp}=hg;function zp(a,n,c=2){const m=n&&n.length,x=m?n[0]*c:a.length;let k=pf(a,0,x,c,!0);const C=[];if(!k||k.next===k.prev)return C;let j,R,F;if(m&&(k=(function(q,G,J,re){const ce=[];for(let he=0,Ee=G.length;he<Ee;he++){const Ae=pf(q,G[he]*re,he<Ee-1?G[he+1]*re:q.length,re,!1);Ae===Ae.next&&(Ae.steiner=!0),ce.push(yg(Ae))}ce.sort(mg);for(let he=0;he<ce.length;he++)J=mf(ce[he],J);return J})(a,n,k,c)),a.length>80*c){j=1/0,R=1/0;let q=-1/0,G=-1/0;for(let J=c;J<x;J+=c){const re=a[J],ce=a[J+1];re<j&&(j=re),ce<R&&(R=ce),re>q&&(q=re),ce>G&&(G=ce)}F=Math.max(q-j,G-R),F=F!==0?32767/F:0}return fh(k,C,c,j,R,F,0),C}function pf(a,n,c,m,x){let k;if(x===(function(C,j,R,F){let q=0;for(let G=j,J=R-F;G<R;G+=F)q+=(C[J]-C[G])*(C[G+1]+C[J+1]),J=G;return q})(a,n,c,m)>0)for(let C=n;C<c;C+=m)k=mh(C/m|0,a[C],a[C+1],k);else for(let C=c-m;C>=n;C-=m)k=mh(C/m|0,a[C],a[C+1],k);return k&&Os(k,k.next)&&(gh(k),k=k.next),k}function gc(a,n){if(!a)return a;n||(n=a);let c,m=a;do if(c=!1,m.steiner||!Os(m,m.next)&&ws(m.prev,m,m.next)!==0)m=m.next;else{if(gh(m),m=n=m.prev,m===m.next)break;c=!0}while(c||m!==n);return n}function fh(a,n,c,m,x,k,C){if(!a)return;!C&&k&&(function(R,F,q,G){let J=R;do J.z===0&&(J.z=hd(J.x,J.y,F,q,G)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==R);J.prevZ.nextZ=null,J.prevZ=null,(function(re){let ce,he=1;do{let Ee,Ae=re;re=null;let Xe=null;for(ce=0;Ae;){ce++;let De=Ae,Ge=0;for(let Dt=0;Dt<he&&(Ge++,De=De.nextZ,De);Dt++);let pt=he;for(;Ge>0||pt>0&&De;)Ge!==0&&(pt===0||!De||Ae.z<=De.z)?(Ee=Ae,Ae=Ae.nextZ,Ge--):(Ee=De,De=De.nextZ,pt--),Xe?Xe.nextZ=Ee:re=Ee,Ee.prevZ=Xe,Xe=Ee;Ae=De}Xe.nextZ=null,he*=2}while(ce>1)})(J)})(a,m,x,k);let j=a;for(;a.prev!==a.next;){const R=a.prev,F=a.next;if(k?Lu(a,m,x,k):dg(a))n.push(R.i,a.i,F.i),gh(a),a=F.next,j=F.next;else if((a=F)===j){C?C===1?fh(a=fg(gc(a),n),n,c,m,x,k,2):C===2&&pg(a,n,c,m,x,k):fh(gc(a),n,c,m,x,k,1);break}}}function dg(a){const n=a.prev,c=a,m=a.next;if(ws(n,c,m)>=0)return!1;const x=n.x,k=c.x,C=m.x,j=n.y,R=c.y,F=m.y,q=x<k?x<C?x:C:k<C?k:C,G=j<R?j<F?j:F:R<F?R:F,J=x>k?x>C?x:C:k>C?k:C,re=j>R?j>F?j:F:R>F?R:F;let ce=m.next;for(;ce!==n;){if(ce.x>=q&&ce.x<=J&&ce.y>=G&&ce.y<=re&&zu(x,j,k,R,C,F,ce.x,ce.y)&&ws(ce.prev,ce,ce.next)>=0)return!1;ce=ce.next}return!0}function Lu(a,n,c,m){const x=a.prev,k=a,C=a.next;if(ws(x,k,C)>=0)return!1;const j=x.x,R=k.x,F=C.x,q=x.y,G=k.y,J=C.y,re=j<R?j<F?j:F:R<F?R:F,ce=q<G?q<J?q:J:G<J?G:J,he=j>R?j>F?j:F:R>F?R:F,Ee=q>G?q>J?q:J:G>J?G:J,Ae=hd(re,ce,n,c,m),Xe=hd(he,Ee,n,c,m);let De=a.prevZ,Ge=a.nextZ;for(;De&&De.z>=Ae&&Ge&&Ge.z<=Xe;){if(De.x>=re&&De.x<=he&&De.y>=ce&&De.y<=Ee&&De!==x&&De!==C&&zu(j,q,R,G,F,J,De.x,De.y)&&ws(De.prev,De,De.next)>=0||(De=De.prevZ,Ge.x>=re&&Ge.x<=he&&Ge.y>=ce&&Ge.y<=Ee&&Ge!==x&&Ge!==C&&zu(j,q,R,G,F,J,Ge.x,Ge.y)&&ws(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;De&&De.z>=Ae;){if(De.x>=re&&De.x<=he&&De.y>=ce&&De.y<=Ee&&De!==x&&De!==C&&zu(j,q,R,G,F,J,De.x,De.y)&&ws(De.prev,De,De.next)>=0)return!1;De=De.prevZ}for(;Ge&&Ge.z<=Xe;){if(Ge.x>=re&&Ge.x<=he&&Ge.y>=ce&&Ge.y<=Ee&&Ge!==x&&Ge!==C&&zu(j,q,R,G,F,J,Ge.x,Ge.y)&&ws(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function fg(a,n){let c=a;do{const m=c.prev,x=c.next.next;!Os(m,x)&&Rr(m,c,c.next,x)&&ph(m,x)&&ph(x,m)&&(n.push(m.i,c.i,x.i),gh(c),gh(c.next),c=a=x),c=c.next}while(c!==a);return gc(c)}function pg(a,n,c,m,x,k){let C=a;do{let j=C.next.next;for(;j!==C.prev;){if(C.i!==j.i&&v_(C,j)){let R=Rp(C,j);return C=gc(C,C.next),R=gc(R,R.next),fh(C,n,c,m,x,k,0),void fh(R,n,c,m,x,k,0)}j=j.next}C=C.next}while(C!==a)}function mg(a,n){return a.x-n.x}function mf(a,n){const c=(function(x,k){let C=k;const j=x.x,R=x.y;let F,q=-1/0;do{if(R<=C.y&&R>=C.next.y&&C.next.y!==C.y){const he=C.x+(R-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(he<=j&&he>q&&(q=he,F=C.x<C.next.x?C:C.next,he===j))return F}C=C.next}while(C!==k);if(!F)return null;const G=F,J=F.x,re=F.y;let ce=1/0;C=F;do{if(j>=C.x&&C.x>=J&&j!==C.x&&zu(R<re?j:q,R,J,re,R<re?q:j,R,C.x,C.y)){const he=Math.abs(R-C.y)/(j-C.x);ph(C,x)&&(he<ce||he===ce&&(C.x>F.x||C.x===F.x&&gg(F,C)))&&(F=C,ce=he)}C=C.next}while(C!==G);return F})(a,n);if(!c)return n;const m=Rp(c,a);return gc(m,m.next),gc(c,c.next)}function gg(a,n){return ws(a.prev,a,n.prev)<0&&ws(n.next,a,a.next)<0}function hd(a,n,c,m,x){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*x|0)|a<<8))|a<<4))|a<<2))|a<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-m)*x|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function yg(a){let n=a,c=a;do(n.x<c.x||n.x===c.x&&n.y<c.y)&&(c=n),n=n.next;while(n!==a);return c}function zu(a,n,c,m,x,k,C,j){return(x-C)*(n-j)>=(a-C)*(k-j)&&(a-C)*(m-j)>=(c-C)*(n-j)&&(c-C)*(k-j)>=(x-C)*(m-j)}function v_(a,n){return a.next.i!==n.i&&a.prev.i!==n.i&&!(function(c,m){let x=c;do{if(x.i!==c.i&&x.next.i!==c.i&&x.i!==m.i&&x.next.i!==m.i&&Rr(x,x.next,c,m))return!0;x=x.next}while(x!==c);return!1})(a,n)&&(ph(a,n)&&ph(n,a)&&(function(c,m){let x=c,k=!1;const C=(c.x+m.x)/2,j=(c.y+m.y)/2;do x.y>j!=x.next.y>j&&x.next.y!==x.y&&C<(x.next.x-x.x)*(j-x.y)/(x.next.y-x.y)+x.x&&(k=!k),x=x.next;while(x!==c);return k})(a,n)&&(ws(a.prev,a,n.prev)||ws(a,n.prev,n))||Os(a,n)&&ws(a.prev,a,a.next)>0&&ws(n.prev,n,n.next)>0)}function ws(a,n,c){return(n.y-a.y)*(c.x-n.x)-(n.x-a.x)*(c.y-n.y)}function Os(a,n){return a.x===n.x&&a.y===n.y}function Rr(a,n,c,m){const x=fd(ws(a,n,c)),k=fd(ws(a,n,m)),C=fd(ws(c,m,a)),j=fd(ws(c,m,n));return x!==k&&C!==j||!(x!==0||!dd(a,c,n))||!(k!==0||!dd(a,m,n))||!(C!==0||!dd(c,a,m))||!(j!==0||!dd(c,n,m))}function dd(a,n,c){return n.x<=Math.max(a.x,c.x)&&n.x>=Math.min(a.x,c.x)&&n.y<=Math.max(a.y,c.y)&&n.y>=Math.min(a.y,c.y)}function fd(a){return a>0?1:a<0?-1:0}function ph(a,n){return ws(a.prev,a,a.next)<0?ws(a,n,a.next)>=0&&ws(a,a.prev,n)>=0:ws(a,n,a.prev)<0||ws(a,a.next,n)<0}function Rp(a,n){const c=yh(a.i,a.x,a.y),m=yh(n.i,n.x,n.y),x=a.next,k=n.prev;return a.next=n,n.prev=a,c.next=x,x.prev=c,m.next=c,c.prev=m,k.next=m,m.prev=k,m}function mh(a,n,c,m){const x=yh(a,n,c);return m?(x.next=m.next,x.prev=m,m.next.prev=x,m.next=x):(x.prev=x,x.next=x),x}function gh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function yh(a,n,c){return{i:a,x:n,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function gf(a,n,c){const m=c.patternDependencies;let x=!1;for(const k of n){const C=k.paint.get(`${a}-pattern`);C.isConstant()||(x=!0);const j=C.constantOr(null);j&&(x=!0,m[j.to]=!0,m[j.from]=!0)}return x}function Dp(a,n,c,m,x){const k=x.patternDependencies;for(const C of n){const j=C.paint.get(`${a}-pattern`).value;if(j.kind!=="constant"){let R=j.evaluate({zoom:m-1},c,{},x.availableImages),F=j.evaluate({zoom:m},c,{},x.availableImages),q=j.evaluate({zoom:m+1},c,{},x.availableImages);R=R&&R.name?R.name:R,F=F&&F.name?F.name:F,q=q&&q.name?q.name:q,k[R]=!0,k[F]=!0,k[q]=!0,c.patterns[C.id]={min:R,mid:F,max:q}}}return c}class _h{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Za,this.indexArray=new ha,this.indexArray2=new Ps,this.programConfigurations=new Xc(n.layers,n.zoom),this.segments=new sn,this.segments2=new sn,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.hasPattern=gf("fill",this.layers,c);const x=this.layers[0].layout.get("fill-sort-key"),k=!x.isConstant(),C=[];for(const{feature:j,id:R,index:F,sourceLayerIndex:q}of n){const G=this.layers[0]._featureFilter.needGeometry,J=Jc(j,G);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),J,m))continue;const re=k?x.evaluate(J,{},m,c.availableImages):void 0,ce={id:R,properties:j.properties,type:j.type,sourceLayerIndex:q,index:F,geometry:G?J.geometry:Kc(j),patterns:{},sortKey:re};C.push(ce)}k&&C.sort(((j,R)=>j.sortKey-R.sortKey));for(const j of C){const{geometry:R,index:F,sourceLayerIndex:q}=j;if(this.hasPattern){const G=Dp("fill",this.layers,j,this.zoom,c);this.patternFeatures.push(G)}else this.addFeature(j,R,F,m,{});c.featureIndex.insert(n[F].feature,R,F,q,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}addFeatures(n,c,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Lp),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,c,m,x,k){for(const C of tc(c,500)){let j=0;for(const re of C)j+=re.length;const R=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),F=R.vertexLength,q=[],G=[];for(const re of C){if(re.length===0)continue;re!==C[0]&&G.push(q.length/2);const ce=this.segments2.prepareSegment(re.length,this.layoutVertexArray,this.indexArray2),he=ce.vertexLength;this.layoutVertexArray.emplaceBack(re[0].x,re[0].y),this.indexArray2.emplaceBack(he+re.length-1,he),q.push(re[0].x),q.push(re[0].y);for(let Ee=1;Ee<re.length;Ee++)this.layoutVertexArray.emplaceBack(re[Ee].x,re[Ee].y),this.indexArray2.emplaceBack(he+Ee-1,he+Ee),q.push(re[Ee].x),q.push(re[Ee].y);ce.vertexLength+=re.length,ce.primitiveLength+=re.length}const J=zp(q,G);for(let re=0;re<J.length;re+=3)this.indexArray.emplaceBack(F+J[re],F+J[re+1],F+J[re+2]);R.vertexLength+=j,R.primitiveLength+=J.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}}let yf,Op;jt("FillBucket",_h,{omit:["layers","patternFeatures"]});var _g={get paint(){return Op=Op||new E({"fill-antialias":new ui(tt.paint_fill["fill-antialias"]),"fill-opacity":new Ti(tt.paint_fill["fill-opacity"]),"fill-color":new Ti(tt.paint_fill["fill-color"]),"fill-outline-color":new Ti(tt.paint_fill["fill-outline-color"]),"fill-translate":new ui(tt.paint_fill["fill-translate"]),"fill-translate-anchor":new ui(tt.paint_fill["fill-translate-anchor"]),"fill-pattern":new vl(tt.paint_fill["fill-pattern"])})},get layout(){return yf=yf||new E({"fill-sort-key":new Ti(tt.layout_fill["fill-sort-key"])})}};class vg extends h{constructor(n){super(n,_g)}recalculate(n,c){super.recalculate(n,c);const m=this.paint._values["fill-outline-color"];m.value.kind==="constant"&&m.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new _h(n)}queryRadius(){return cf(this.paint.get("fill-translate"))}queryIntersectsFeature(n,c,m,x,k,C,j){return bp(ad(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),C.angle,j),x)}isTileClipped(){return!0}}const Np=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Bp=z([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$p}=Np;var yc={},Up=I,pd=tu;function tu(a,n,c,m,x){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=m,this._values=x,a.readFields(xg,this,n)}function xg(a,n,c){a==1?n.id=c.readVarint():a==2?(function(m,x){for(var k=m.readVarint()+m.pos;m.pos<k;){var C=x._keys[m.readVarint()],j=x._values[m.readVarint()];x.properties[C]=j}})(c,n):a==3?n.type=c.readVarint():a==4&&(n._geometry=c.pos)}function Fp(a){for(var n,c,m=0,x=0,k=a.length,C=k-1;x<k;C=x++)m+=((c=a[C]).x-(n=a[x]).x)*(n.y+c.y);return m}tu.types=["Unknown","Point","LineString","Polygon"],tu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var n,c=a.readVarint()+a.pos,m=1,x=0,k=0,C=0,j=[];a.pos<c;){if(x<=0){var R=a.readVarint();m=7&R,x=R>>3}if(x--,m===1||m===2)k+=a.readSVarint(),C+=a.readSVarint(),m===1&&(n&&j.push(n),n=[]),n.push(new Up(k,C));else{if(m!==7)throw new Error("unknown command "+m);n&&n.push(n[0].clone())}}return n&&j.push(n),j},tu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var n=a.readVarint()+a.pos,c=1,m=0,x=0,k=0,C=1/0,j=-1/0,R=1/0,F=-1/0;a.pos<n;){if(m<=0){var q=a.readVarint();c=7&q,m=q>>3}if(m--,c===1||c===2)(x+=a.readSVarint())<C&&(C=x),x>j&&(j=x),(k+=a.readSVarint())<R&&(R=k),k>F&&(F=k);else if(c!==7)throw new Error("unknown command "+c)}return[C,R,j,F]},tu.prototype.toGeoJSON=function(a,n,c){var m,x,k=this.extent*Math.pow(2,c),C=this.extent*a,j=this.extent*n,R=this.loadGeometry(),F=tu.types[this.type];function q(re){for(var ce=0;ce<re.length;ce++){var he=re[ce];re[ce]=[360*(he.x+C)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(he.y+j)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(m=0;m<R.length;m++)G[m]=R[m][0];q(R=G);break;case 2:for(m=0;m<R.length;m++)q(R[m]);break;case 3:for(R=(function(re){var ce=re.length;if(ce<=1)return[re];for(var he,Ee,Ae=[],Xe=0;Xe<ce;Xe++){var De=Fp(re[Xe]);De!==0&&(Ee===void 0&&(Ee=De<0),Ee===De<0?(he&&Ae.push(he),he=[re[Xe]]):he.push(re[Xe]))}return he&&Ae.push(he),Ae})(R),m=0;m<R.length;m++)for(x=0;x<R[m].length;x++)q(R[m][x])}R.length===1?R=R[0]:F="Multi"+F;var J={type:"Feature",geometry:{type:F,coordinates:R},properties:this.properties};return"id"in this&&(J.id=this.id),J};var bg=pd,ql=_f;function _f(a,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(x_,this,n),this.length=this._features.length}function x_(a,n,c){a===15?n.version=c.readVarint():a===1?n.name=c.readString():a===5?n.extent=c.readVarint():a===2?n._features.push(c.pos):a===3?n._keys.push(c.readString()):a===4&&n._values.push((function(m){for(var x=null,k=m.readVarint()+m.pos;m.pos<k;){var C=m.readVarint()>>3;x=C===1?m.readString():C===2?m.readFloat():C===3?m.readDouble():C===4?m.readVarint64():C===5?m.readVarint():C===6?m.readSVarint():C===7?m.readBoolean():null}return x})(c))}_f.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var n=this._pbf.readVarint()+this._pbf.pos;return new bg(this._pbf,n,this.extent,this._keys,this._values)};var wg=ql;function _c(a,n,c){if(a===3){var m=new wg(c,c.readVarint()+c.pos);m.length&&(n[m.name]=m)}}yc.VectorTile=function(a,n){this.layers=a.readFields(_c,{},n)},yc.VectorTileFeature=pd,yc.VectorTileLayer=ql;const Vp=yc.VectorTileFeature.types,vf=Math.pow(2,13);function iu(a,n,c,m,x,k,C,j){a.emplaceBack(n,c,2*Math.floor(m*vf)+C,x*vf*2,k*vf*2,Math.round(j))}class Ru{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new uc,this.centroidVertexArray=new as,this.indexArray=new ha,this.programConfigurations=new Xc(n.layers,n.zoom),this.segments=new sn,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.features=[],this.hasPattern=gf("fill-extrusion",this.layers,c);for(const{feature:x,id:k,index:C,sourceLayerIndex:j}of n){const R=this.layers[0]._featureFilter.needGeometry,F=Jc(x,R);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),F,m))continue;const q={id:k,sourceLayerIndex:j,index:C,geometry:R?F.geometry:Kc(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Dp("fill-extrusion",this.layers,q,this.zoom,c)):this.addFeature(q,q.geometry,C,m,{}),c.featureIndex.insert(x,q.geometry,C,j,this.index,!0)}}addFeatures(n,c,m){for(const x of this.features){const{geometry:k}=x;this.addFeature(x,k,x.index,c,m)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,$p),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,Bp.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,c,m,x,k){for(const C of tc(c,500)){const j={x:0,y:0,vertexCount:0};let R=0;for(const ce of C)R+=ce.length;let F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ce of C){if(ce.length===0||b_(ce))continue;let he=0;for(let Ee=0;Ee<ce.length;Ee++){const Ae=ce[Ee];if(Ee>=1){const Xe=ce[Ee-1];if(!Ss(Ae,Xe)){F.vertexLength+4>sn.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const De=Ae.sub(Xe)._perp()._unit(),Ge=Xe.dist(Ae);he+Ge>32768&&(he=0),iu(this.layoutVertexArray,Ae.x,Ae.y,De.x,De.y,0,0,he),iu(this.layoutVertexArray,Ae.x,Ae.y,De.x,De.y,0,1,he),j.x+=2*Ae.x,j.y+=2*Ae.y,j.vertexCount+=2,he+=Ge,iu(this.layoutVertexArray,Xe.x,Xe.y,De.x,De.y,0,0,he),iu(this.layoutVertexArray,Xe.x,Xe.y,De.x,De.y,0,1,he),j.x+=2*Xe.x,j.y+=2*Xe.y,j.vertexCount+=2;const pt=F.vertexLength;this.indexArray.emplaceBack(pt,pt+2,pt+1),this.indexArray.emplaceBack(pt+1,pt+2,pt+3),F.vertexLength+=4,F.primitiveLength+=2}}}}if(F.vertexLength+R>sn.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray)),Vp[n.type]!=="Polygon")continue;const q=[],G=[],J=F.vertexLength;for(const ce of C)if(ce.length!==0){ce!==C[0]&&G.push(q.length/2);for(let he=0;he<ce.length;he++){const Ee=ce[he];iu(this.layoutVertexArray,Ee.x,Ee.y,0,0,1,1,0),j.x+=Ee.x,j.y+=Ee.y,j.vertexCount+=1,q.push(Ee.x),q.push(Ee.y)}}const re=zp(q,G);for(let ce=0;ce<re.length;ce+=3)this.indexArray.emplaceBack(J+re[ce],J+re[ce+2],J+re[ce+1]);F.primitiveLength+=re.length/3,F.vertexLength+=R;for(let ce=0;ce<j.vertexCount;ce++){const he=Math.floor(j.x/j.vertexCount),Ee=Math.floor(j.y/j.vertexCount);this.centroidVertexArray.emplaceBack(he,Ee)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}}function Ss(a,n){return a.x===n.x&&(a.x<0||a.x>Ds)||a.y===n.y&&(a.y<0||a.y>Ds)}function b_(a){return a.every((n=>n.x<0))||a.every((n=>n.x>Ds))||a.every((n=>n.y<0))||a.every((n=>n.y>Ds))}let Sg;jt("FillExtrusionBucket",Ru,{omit:["layers","features"]});var Tg={get paint(){return Sg=Sg||new E({"fill-extrusion-opacity":new ui(tt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ti(tt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ui(tt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ui(tt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vl(tt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ti(tt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ti(tt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ui(tt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class md extends h{constructor(n){super(n,Tg)}createBucket(n){return new Ru(n)}queryRadius(){return cf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,c,m,x,k,C,j,R){const F=ad(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),C.angle,j),q=this.paint.get("fill-extrusion-height").evaluate(c,m),G=this.paint.get("fill-extrusion-base").evaluate(c,m),J=(function(ce,he,Ee,Ae){const Xe=[];for(const De of ce){const Ge=[De.x,De.y,0,1];od(Ge,Ge,he),Xe.push(new N(Ge[0]/Ge[3],Ge[1]/Ge[3]))}return Xe})(F,R),re=(function(ce,he,Ee,Ae){const Xe=[],De=[],Ge=Ae[8]*he,pt=Ae[9]*he,Dt=Ae[10]*he,Qt=Ae[11]*he,Ai=Ae[8]*Ee,Vt=Ae[9]*Ee,Gt=Ae[10]*Ee,fi=Ae[11]*Ee;for(const ci of ce){const ri=[],vt=[];for(const li of ci){const di=li.x,Li=li.y,kn=Ae[0]*di+Ae[4]*Li+Ae[12],Yn=Ae[1]*di+Ae[5]*Li+Ae[13],cr=Ae[2]*di+Ae[6]*Li+Ae[14],Kr=Ae[3]*di+Ae[7]*Li+Ae[15],Er=cr+Dt,ur=Kr+Qt,pa=kn+Ai,ma=Yn+Vt,ga=cr+Gt,js=Kr+fi,hr=new N((kn+Ge)/ur,(Yn+pt)/ur);hr.z=Er/ur,ri.push(hr);const Jr=new N(pa/js,ma/js);Jr.z=ga/js,vt.push(Jr)}Xe.push(ri),De.push(vt)}return[Xe,De]})(x,G,q,R);return(function(ce,he,Ee){let Ae=1/0;bp(Ee,he)&&(Ae=qp(Ee,he[0]));for(let Xe=0;Xe<he.length;Xe++){const De=he[Xe],Ge=ce[Xe];for(let pt=0;pt<De.length-1;pt++){const Dt=De[pt],Qt=[Dt,De[pt+1],Ge[pt+1],Ge[pt],Dt];xp(Ee,Qt)&&(Ae=Math.min(Ae,qp(Ee,Qt)))}}return Ae!==1/0&&Ae})(re[0],re[1],J)}}function $o(a,n){return a.x*n.x+a.y*n.y}function qp(a,n){if(a.length===1){let c=0;const m=n[c++];let x;for(;!x||m.equals(x);)if(x=n[c++],!x)return 1/0;for(;c<n.length;c++){const k=n[c],C=a[0],j=x.sub(m),R=k.sub(m),F=C.sub(m),q=$o(j,j),G=$o(j,R),J=$o(R,R),re=$o(F,j),ce=$o(F,R),he=q*J-G*G,Ee=(J*re-G*ce)/he,Ae=(q*ce-G*re)/he,Xe=m.z*(1-Ee-Ae)+x.z*Ee+k.z*Ae;if(isFinite(Xe))return Xe}return 1/0}{let c=1/0;for(const m of n)c=Math.min(c,m.z);return c}}const Eg=z([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:gd}=Eg,Hl=z([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:kg}=Hl,Hp=yc.VectorTileFeature.types,Cg=Math.cos(Math.PI/180*37.5),xf=Math.pow(2,14)/.5;class yd{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((c=>{this.gradients[c.id]={}})),this.layoutVertexArray=new go,this.layoutVertexArray2=new sr,this.indexArray=new ha,this.programConfigurations=new Xc(n.layers,n.zoom),this.segments=new sn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id))}populate(n,c,m){this.hasPattern=gf("line",this.layers,c);const x=this.layers[0].layout.get("line-sort-key"),k=!x.isConstant(),C=[];for(const{feature:j,id:R,index:F,sourceLayerIndex:q}of n){const G=this.layers[0]._featureFilter.needGeometry,J=Jc(j,G);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),J,m))continue;const re=k?x.evaluate(J,{},m):void 0,ce={id:R,properties:j.properties,type:j.type,sourceLayerIndex:q,index:F,geometry:G?J.geometry:Kc(j),patterns:{},sortKey:re};C.push(ce)}k&&C.sort(((j,R)=>j.sortKey-R.sortKey));for(const j of C){const{geometry:R,index:F,sourceLayerIndex:q}=j;if(this.hasPattern){const G=Dp("line",this.layers,j,this.zoom,c);this.patternFeatures.push(G)}else this.addFeature(j,R,F,m,{});c.featureIndex.insert(n[F].feature,R,F,q,this.index)}}update(n,c,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,c,this.stateDependentLayers,m)}addFeatures(n,c,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,kg)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,gd),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,c,m,x,k){const C=this.layers[0].layout,j=C.get("line-join").evaluate(n,{}),R=C.get("line-cap"),F=C.get("line-miter-limit"),q=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const G of c)this.addLine(G,n,j,R,F,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,m,k,x)}addLine(n,c,m,x,k,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ae=0;Ae<n.length-1;Ae++)this.totalDistance+=n[Ae].dist(n[Ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=Hp[c.type]==="Polygon";let R=n.length;for(;R>=2&&n[R-1].equals(n[R-2]);)R--;let F=0;for(;F<R-1&&n[F].equals(n[F+1]);)F++;if(R<(j?3:2))return;m==="bevel"&&(k=1.05);const q=this.overscaling<=16?15*Ds/(512*this.overscaling):0,G=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let J,re,ce,he,Ee;this.e1=this.e2=-1,j&&(J=n[R-2],Ee=n[F].sub(J)._unit()._perp());for(let Ae=F;Ae<R;Ae++){if(ce=Ae===R-1?j?n[F+1]:void 0:n[Ae+1],ce&&n[Ae].equals(ce))continue;Ee&&(he=Ee),J&&(re=J),J=n[Ae],Ee=ce?ce.sub(J)._unit()._perp():he,he=he||Ee;let Xe=he.add(Ee);Xe.x===0&&Xe.y===0||Xe._unit();const De=he.x*Ee.x+he.y*Ee.y,Ge=Xe.x*Ee.x+Xe.y*Ee.y,pt=Ge!==0?1/Ge:1/0,Dt=2*Math.sqrt(2-2*Ge),Qt=Ge<Cg&&re&&ce,Ai=he.x*Ee.y-he.y*Ee.x>0;if(Qt&&Ae>F){const fi=J.dist(re);if(fi>2*q){const ci=J.sub(J.sub(re)._mult(q/fi)._round());this.updateDistance(re,ci),this.addCurrentVertex(ci,he,0,0,G),re=ci}}const Vt=re&&ce;let Gt=Vt?m:j?"butt":x;if(Vt&&Gt==="round"&&(pt<C?Gt="miter":pt<=2&&(Gt="fakeround")),Gt==="miter"&&pt>k&&(Gt="bevel"),Gt==="bevel"&&(pt>2&&(Gt="flipbevel"),pt<k&&(Gt="miter")),re&&this.updateDistance(re,J),Gt==="miter")Xe._mult(pt),this.addCurrentVertex(J,Xe,0,0,G);else if(Gt==="flipbevel"){if(pt>100)Xe=Ee.mult(-1);else{const fi=pt*he.add(Ee).mag()/he.sub(Ee).mag();Xe._perp()._mult(fi*(Ai?-1:1))}this.addCurrentVertex(J,Xe,0,0,G),this.addCurrentVertex(J,Xe.mult(-1),0,0,G)}else if(Gt==="bevel"||Gt==="fakeround"){const fi=-Math.sqrt(pt*pt-1),ci=Ai?fi:0,ri=Ai?0:fi;if(re&&this.addCurrentVertex(J,he,ci,ri,G),Gt==="fakeround"){const vt=Math.round(180*Dt/Math.PI/20);for(let li=1;li<vt;li++){let di=li/vt;if(di!==.5){const kn=di-.5;di+=di*kn*(di-1)*((1.0904+De*(De*(3.55645-1.43519*De)-3.2452))*kn*kn+(.848013+De*(.215638*De-1.06021)))}const Li=Ee.sub(he)._mult(di)._add(he)._unit()._mult(Ai?-1:1);this.addHalfVertex(J,Li.x,Li.y,!1,Ai,0,G)}}ce&&this.addCurrentVertex(J,Ee,-ci,-ri,G)}else if(Gt==="butt")this.addCurrentVertex(J,Xe,0,0,G);else if(Gt==="square"){const fi=re?1:-1;this.addCurrentVertex(J,Xe,fi,fi,G)}else Gt==="round"&&(re&&(this.addCurrentVertex(J,he,0,0,G),this.addCurrentVertex(J,he,1,1,G,!0)),ce&&(this.addCurrentVertex(J,Ee,-1,-1,G,!0),this.addCurrentVertex(J,Ee,0,0,G)));if(Qt&&Ae<R-1){const fi=J.dist(ce);if(fi>2*q){const ci=J.add(ce.sub(J)._mult(q/fi)._round());this.updateDistance(J,ci),this.addCurrentVertex(ci,Ee,0,0,G),J=ci}}}}addCurrentVertex(n,c,m,x,k,C=!1){const j=c.y*x-c.x,R=-c.y-c.x*x;this.addHalfVertex(n,c.x+c.y*m,c.y-c.x*m,C,!1,m,k),this.addHalfVertex(n,j,R,C,!0,-x,k),this.distance>xf/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,c,m,x,k,C))}addHalfVertex({x:n,y:c},m,x,k,C,j,R){const F=.5*(this.lineClips?this.scaledDistance*(xf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(k?1:0),(c<<1)+(C?1:0),Math.round(63*m)+128,Math.round(63*x)+128,1+(j===0?0:j<0?-1:1)|(63&F)<<2,F>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const q=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,q),R.primitiveLength++),C?this.e2=q:this.e1=q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,c){this.distance+=n.dist(c),this.updateScaledDistance()}}let _d,Zp;jt("LineBucket",yd,{omit:["layers","patternFeatures"]});var Zl={get paint(){return Zp=Zp||new E({"line-opacity":new Ti(tt.paint_line["line-opacity"]),"line-color":new Ti(tt.paint_line["line-color"]),"line-translate":new ui(tt.paint_line["line-translate"]),"line-translate-anchor":new ui(tt.paint_line["line-translate-anchor"]),"line-width":new Ti(tt.paint_line["line-width"]),"line-gap-width":new Ti(tt.paint_line["line-gap-width"]),"line-offset":new Ti(tt.paint_line["line-offset"]),"line-blur":new Ti(tt.paint_line["line-blur"]),"line-dasharray":new xl(tt.paint_line["line-dasharray"]),"line-pattern":new vl(tt.paint_line["line-pattern"]),"line-gradient":new td(tt.paint_line["line-gradient"])})},get layout(){return _d=_d||new E({"line-cap":new ui(tt.layout_line["line-cap"]),"line-join":new Ti(tt.layout_line["line-join"]),"line-miter-limit":new ui(tt.layout_line["line-miter-limit"]),"line-round-limit":new ui(tt.layout_line["line-round-limit"]),"line-sort-key":new Ti(tt.layout_line["line-sort-key"])})}};class ar extends Ti{possiblyEvaluate(n,c){return c=new nn(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(n,c)}evaluate(n,c,m,x){return c=ze({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(n,c,m,x)}}let vh;class Ag extends h{constructor(n){super(n,Zl),this.gradientVersion=0,vh||(vh=new ar(Zl.paint.properties["line-width"].specification),vh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const c=this.gradientExpression();this.stepInterpolant=!!(function(m){return m._styleExpression!==void 0})(c)&&c._styleExpression.expression instanceof ao,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,c){super.recalculate(n,c),this.paint._values["line-floorwidth"]=vh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new yd(n)}queryRadius(n){const c=n,m=Sr(Iu("line-width",this,c),Iu("line-gap-width",this,c)),x=Iu("line-offset",this,c);return m/2+Math.abs(x)+cf(this.paint.get("line-translate"))}queryIntersectsFeature(n,c,m,x,k,C,j){const R=ad(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),C.angle,j),F=j/2*Sr(this.paint.get("line-width").evaluate(c,m),this.paint.get("line-gap-width").evaluate(c,m)),q=this.paint.get("line-offset").evaluate(c,m);return q&&(x=(function(G,J){const re=[];for(let ce=0;ce<G.length;ce++){const he=G[ce],Ee=[];for(let Ae=0;Ae<he.length;Ae++){const Xe=he[Ae-1],De=he[Ae],Ge=he[Ae+1],pt=Ae===0?new N(0,0):De.sub(Xe)._unit()._perp(),Dt=Ae===he.length-1?new N(0,0):Ge.sub(De)._unit()._perp(),Qt=pt._add(Dt)._unit(),Ai=Qt.x*Dt.x+Qt.y*Dt.y;Ai!==0&&Qt._mult(1/Ai),Ee.push(Qt._mult(J)._add(De))}re.push(Ee)}return re})(x,q*j)),(function(G,J,re){for(let ce=0;ce<J.length;ce++){const he=J[ce];if(G.length>=3){for(let Ee=0;Ee<he.length;Ee++)if(mc(G,he[Ee]))return!0}if(rg(G,he,re))return!0}return!1})(R,x,F)}isTileClipped(){return!0}}function Sr(a,n){return n>0?n+2*a:a}const w_=z([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Mg=z([{name:"a_projected_pos",components:3,type:"Float32"}],4);z([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Pg=z([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);z([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ts=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ya=z([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function vc(a,n,c){return a.sections.forEach((m=>{m.text=(function(x,k,C){const j=k.layout.get("text-transform").evaluate(C,{});return j==="uppercase"?x=x.toLocaleUpperCase():j==="lowercase"&&(x=x.toLocaleLowerCase()),Js.applyArabicShaping&&(x=Js.applyArabicShaping(x)),x})(m.text,n,c)})),a}z([{name:"triangle",components:3,type:"Uint16"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),z([{type:"Float32",name:"offsetX"}]),z([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),z([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const xh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Hs=24,Gp=rn,Ig=function(a,n,c,m,x){var k,C,j=8*x-m-1,R=(1<<j)-1,F=R>>1,q=-7,G=x-1,J=-1,re=a[n+G];for(G+=J,k=re&(1<<-q)-1,re>>=-q,q+=j;q>0;k=256*k+a[n+G],G+=J,q-=8);for(C=k&(1<<-q)-1,k>>=-q,q+=m;q>0;C=256*C+a[n+G],G+=J,q-=8);if(k===0)k=1-F;else{if(k===R)return C?NaN:1/0*(re?-1:1);C+=Math.pow(2,m),k-=F}return(re?-1:1)*C*Math.pow(2,k-m)},vd=function(a,n,c,m,x,k){var C,j,R,F=8*k-x-1,q=(1<<F)-1,G=q>>1,J=x===23?Math.pow(2,-24)-Math.pow(2,-77):0,re=0,ce=1,he=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(j=isNaN(n)?1:0,C=q):(C=Math.floor(Math.log(n)/Math.LN2),n*(R=Math.pow(2,-C))<1&&(C--,R*=2),(n+=C+G>=1?J/R:J*Math.pow(2,1-G))*R>=2&&(C++,R/=2),C+G>=q?(j=0,C=q):C+G>=1?(j=(n*R-1)*Math.pow(2,x),C+=G):(j=n*Math.pow(2,G-1)*Math.pow(2,x),C=0));x>=8;a[c+re]=255&j,re+=ce,j/=256,x-=8);for(C=C<<x|j,F+=x;F>0;a[c+re]=255&C,re+=ce,C/=256,F-=8);a[c+re-ce]|=128*he};function rn(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}rn.Varint=0,rn.Fixed64=1,rn.Bytes=2,rn.Fixed32=5;var _o=4294967296,Wp=1/_o,Ca=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Gl(a){return a.type===rn.Bytes?a.readVarint()+a.pos:a.pos+1}function Xa(a,n,c){return c?4294967296*n+(a>>>0):4294967296*(n>>>0)+(a>>>0)}function nu(a,n,c){var m=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));c.realloc(m);for(var x=c.pos-1;x>=a;x--)c.buf[x+m]=c.buf[x]}function xc(a,n){for(var c=0;c<a.length;c++)n.writeVarint(a[c])}function Yp(a,n){for(var c=0;c<a.length;c++)n.writeSVarint(a[c])}function Xp(a,n){for(var c=0;c<a.length;c++)n.writeFloat(a[c])}function wl(a,n){for(var c=0;c<a.length;c++)n.writeDouble(a[c])}function jg(a,n){for(var c=0;c<a.length;c++)n.writeBoolean(a[c])}function bh(a,n){for(var c=0;c<a.length;c++)n.writeFixed32(a[c])}function xd(a,n){for(var c=0;c<a.length;c++)n.writeSFixed32(a[c])}function bd(a,n){for(var c=0;c<a.length;c++)n.writeFixed64(a[c])}function wh(a,n){for(var c=0;c<a.length;c++)n.writeSFixed64(a[c])}function wd(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+16777216*a[n+3]}function Du(a,n,c){a[c]=n,a[c+1]=n>>>8,a[c+2]=n>>>16,a[c+3]=n>>>24}function Sh(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+(a[n+3]<<24)}rn.prototype={destroy:function(){this.buf=null},readFields:function(a,n,c){for(c=c||this.length;this.pos<c;){var m=this.readVarint(),x=m>>3,k=this.pos;this.type=7&m,a(x,n,this),this.pos===k&&this.skip(m)}return n},readMessage:function(a,n){return this.readFields(a,n,this.readVarint()+this.pos)},readFixed32:function(){var a=wd(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Sh(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=wd(this.buf,this.pos)+wd(this.buf,this.pos+4)*_o;return this.pos+=8,a},readSFixed64:function(){var a=wd(this.buf,this.pos)+Sh(this.buf,this.pos+4)*_o;return this.pos+=8,a},readFloat:function(){var a=Ig(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Ig(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var n,c,m=this.buf;return n=127&(c=m[this.pos++]),c<128?n:(n|=(127&(c=m[this.pos++]))<<7,c<128?n:(n|=(127&(c=m[this.pos++]))<<14,c<128?n:(n|=(127&(c=m[this.pos++]))<<21,c<128?n:(function(x,k,C){var j,R,F=C.buf;if(j=(112&(R=F[C.pos++]))>>4,R<128||(j|=(127&(R=F[C.pos++]))<<3,R<128)||(j|=(127&(R=F[C.pos++]))<<10,R<128)||(j|=(127&(R=F[C.pos++]))<<17,R<128)||(j|=(127&(R=F[C.pos++]))<<24,R<128)||(j|=(1&(R=F[C.pos++]))<<31,R<128))return Xa(x,j,k);throw new Error("Expected varint not more than 10 bytes")})(n|=(15&(c=m[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,n=this.pos;return this.pos=a,a-n>=12&&Ca?(function(c,m,x){return Ca.decode(c.subarray(m,x))})(this.buf,n,a):(function(c,m,x){for(var k="",C=m;C<x;){var j,R,F,q=c[C],G=null,J=q>239?4:q>223?3:q>191?2:1;if(C+J>x)break;J===1?q<128&&(G=q):J===2?(192&(j=c[C+1]))==128&&(G=(31&q)<<6|63&j)<=127&&(G=null):J===3?(R=c[C+2],(192&(j=c[C+1]))==128&&(192&R)==128&&((G=(15&q)<<12|(63&j)<<6|63&R)<=2047||G>=55296&&G<=57343)&&(G=null)):J===4&&(R=c[C+2],F=c[C+3],(192&(j=c[C+1]))==128&&(192&R)==128&&(192&F)==128&&((G=(15&q)<<18|(63&j)<<12|(63&R)<<6|63&F)<=65535||G>=1114112)&&(G=null)),G===null?(G=65533,J=1):G>65535&&(G-=65536,k+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),k+=String.fromCharCode(G),C+=J}return k})(this.buf,n,a)},readBytes:function(){var a=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,a);return this.pos=a,n},readPackedVarint:function(a,n){if(this.type!==rn.Bytes)return a.push(this.readVarint(n));var c=Gl(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(n));return a},readPackedSVarint:function(a){if(this.type!==rn.Bytes)return a.push(this.readSVarint());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==rn.Bytes)return a.push(this.readBoolean());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==rn.Bytes)return a.push(this.readFloat());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==rn.Bytes)return a.push(this.readDouble());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==rn.Bytes)return a.push(this.readFixed32());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==rn.Bytes)return a.push(this.readSFixed32());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==rn.Bytes)return a.push(this.readFixed64());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==rn.Bytes)return a.push(this.readSFixed64());var n=Gl(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed64());return a},skip:function(a){var n=7&a;if(n===rn.Varint)for(;this.buf[this.pos++]>127;);else if(n===rn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===rn.Fixed32)this.pos+=4;else{if(n!==rn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(a,n){this.writeVarint(a<<3|n)},realloc:function(a){for(var n=this.length||16;n<this.pos+a;)n*=2;if(n!==this.length){var c=new Uint8Array(n);c.set(this.buf),this.buf=c,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Du(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Du(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Du(this.buf,-1&a,this.pos),Du(this.buf,Math.floor(a*Wp),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Du(this.buf,-1&a,this.pos),Du(this.buf,Math.floor(a*Wp),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?(function(n,c){var m,x;if(n>=0?(m=n%4294967296|0,x=n/4294967296|0):(x=~(-n/4294967296),4294967295^(m=~(-n%4294967296))?m=m+1|0:(m=0,x=x+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),(function(k,C,j){j.buf[j.pos++]=127&k|128,k>>>=7,j.buf[j.pos++]=127&k|128,k>>>=7,j.buf[j.pos++]=127&k|128,k>>>=7,j.buf[j.pos++]=127&k|128,j.buf[j.pos]=127&(k>>>=7)})(m,0,c),(function(k,C){var j=(7&k)<<4;C.buf[C.pos++]|=j|((k>>>=3)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k|((k>>>=7)?128:0),k&&(C.buf[C.pos++]=127&k)))))})(x,c)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var n=this.pos;this.pos=(function(m,x,k){for(var C,j,R=0;R<x.length;R++){if((C=x.charCodeAt(R))>55295&&C<57344){if(!j){C>56319||R+1===x.length?(m[k++]=239,m[k++]=191,m[k++]=189):j=C;continue}if(C<56320){m[k++]=239,m[k++]=191,m[k++]=189,j=C;continue}C=j-55296<<10|C-56320|65536,j=null}else j&&(m[k++]=239,m[k++]=191,m[k++]=189,j=null);C<128?m[k++]=C:(C<2048?m[k++]=C>>6|192:(C<65536?m[k++]=C>>12|224:(m[k++]=C>>18|240,m[k++]=C>>12&63|128),m[k++]=C>>6&63|128),m[k++]=63&C|128)}return k})(this.buf,a,this.pos);var c=this.pos-n;c>=128&&nu(n,c,this),this.pos=n-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),vd(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),vd(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var n=a.length;this.writeVarint(n),this.realloc(n);for(var c=0;c<n;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,n){this.pos++;var c=this.pos;a(n,this);var m=this.pos-c;m>=128&&nu(c,m,this),this.pos=c-1,this.writeVarint(m),this.pos+=m},writeMessage:function(a,n,c){this.writeTag(a,rn.Bytes),this.writeRawMessage(n,c)},writePackedVarint:function(a,n){n.length&&this.writeMessage(a,xc,n)},writePackedSVarint:function(a,n){n.length&&this.writeMessage(a,Yp,n)},writePackedBoolean:function(a,n){n.length&&this.writeMessage(a,jg,n)},writePackedFloat:function(a,n){n.length&&this.writeMessage(a,Xp,n)},writePackedDouble:function(a,n){n.length&&this.writeMessage(a,wl,n)},writePackedFixed32:function(a,n){n.length&&this.writeMessage(a,bh,n)},writePackedSFixed32:function(a,n){n.length&&this.writeMessage(a,xd,n)},writePackedFixed64:function(a,n){n.length&&this.writeMessage(a,bd,n)},writePackedSFixed64:function(a,n){n.length&&this.writeMessage(a,wh,n)},writeBytesField:function(a,n){this.writeTag(a,rn.Bytes),this.writeBytes(n)},writeFixed32Field:function(a,n){this.writeTag(a,rn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(a,n){this.writeTag(a,rn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(a,n){this.writeTag(a,rn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(a,n){this.writeTag(a,rn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(a,n){this.writeTag(a,rn.Varint),this.writeVarint(n)},writeSVarintField:function(a,n){this.writeTag(a,rn.Varint),this.writeSVarint(n)},writeStringField:function(a,n){this.writeTag(a,rn.Bytes),this.writeString(n)},writeFloatField:function(a,n){this.writeTag(a,rn.Fixed32),this.writeFloat(n)},writeDoubleField:function(a,n){this.writeTag(a,rn.Fixed64),this.writeDouble(n)},writeBooleanField:function(a,n){this.writeVarintField(a,!!n)}};var bf=A(Gp);const Th=3;function Lg(a,n,c){a===1&&c.readMessage(S_,n)}function S_(a,n,c){if(a===3){const{id:m,bitmap:x,width:k,height:C,left:j,top:R,advance:F}=c.readMessage(T_,{});n.push({id:m,bitmap:new ld({width:k+2*Th,height:C+2*Th},x),metrics:{width:k,height:C,left:j,top:R,advance:F}})}}function T_(a,n,c){a===1?n.id=c.readVarint():a===2?n.bitmap=c.readBytes():a===3?n.width=c.readVarint():a===4?n.height=c.readVarint():a===5?n.left=c.readSVarint():a===6?n.top=c.readSVarint():a===7&&(n.advance=c.readVarint())}const qn=Th;function ds(a){let n=0,c=0;for(const C of a)n+=C.w*C.h,c=Math.max(c,C.w);a.sort(((C,j)=>j.h-C.h));const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),c),h:1/0}];let x=0,k=0;for(const C of a)for(let j=m.length-1;j>=0;j--){const R=m[j];if(!(C.w>R.w||C.h>R.h)){if(C.x=R.x,C.y=R.y,k=Math.max(k,C.y+C.h),x=Math.max(x,C.x+C.w),C.w===R.w&&C.h===R.h){const F=m.pop();j<m.length&&(m[j]=F)}else C.h===R.h?(R.x+=C.w,R.w-=C.w):C.w===R.w?(R.y+=C.h,R.h-=C.h):(m.push({x:R.x+C.w,y:R.y,w:R.w-C.w,h:C.h}),R.y+=C.h,R.h-=C.h);break}}return{w:x,h:k,fill:n/(x*k)||0}}const $i=1;class En{constructor(n,{pixelRatio:c,version:m,stretchX:x,stretchY:k,content:C,textFitWidth:j,textFitHeight:R}){this.paddedRect=n,this.pixelRatio=c,this.stretchX=x,this.stretchY=k,this.content=C,this.version=m,this.textFitWidth=j,this.textFitHeight=R}get tl(){return[this.paddedRect.x+$i,this.paddedRect.y+$i]}get br(){return[this.paddedRect.x+this.paddedRect.w-$i,this.paddedRect.y+this.paddedRect.h-$i]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*$i)/this.pixelRatio,(this.paddedRect.h-2*$i)/this.pixelRatio]}}class Qn{constructor(n,c){const m={},x={};this.haveRenderCallbacks=[];const k=[];this.addImages(n,m,k),this.addImages(c,x,k);const{w:C,h:j}=ds(k),R=new Wa({width:C||1,height:j||1});for(const F in n){const q=n[F],G=m[F].paddedRect;Wa.copy(q.data,R,{x:0,y:0},{x:G.x+$i,y:G.y+$i},q.data)}for(const F in c){const q=c[F],G=x[F].paddedRect,J=G.x+$i,re=G.y+$i,ce=q.data.width,he=q.data.height;Wa.copy(q.data,R,{x:0,y:0},{x:J,y:re},q.data),Wa.copy(q.data,R,{x:0,y:he-1},{x:J,y:re-1},{width:ce,height:1}),Wa.copy(q.data,R,{x:0,y:0},{x:J,y:re+he},{width:ce,height:1}),Wa.copy(q.data,R,{x:ce-1,y:0},{x:J-1,y:re},{width:1,height:he}),Wa.copy(q.data,R,{x:0,y:0},{x:J+ce,y:re},{width:1,height:he})}this.image=R,this.iconPositions=m,this.patternPositions=x}addImages(n,c,m){for(const x in n){const k=n[x],C={x:0,y:0,w:k.data.width+2*$i,h:k.data.height+2*$i};m.push(C),c[x]=new En(C,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(n,c){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in n.updatedImages)this.patchUpdatedImage(this.iconPositions[m],n.getImage(m),c),this.patchUpdatedImage(this.patternPositions[m],n.getImage(m),c)}patchUpdatedImage(n,c,m){if(!n||!c||n.version===c.version)return;n.version=c.version;const[x,k]=n.tl;m.update(c.data,void 0,{x,y:k})}}var or;jt("ImagePosition",En),jt("ImageAtlas",Qn),y.ah=void 0,(or=y.ah||(y.ah={}))[or.none=0]="none",or[or.horizontal=1]="horizontal",or[or.vertical=2]="vertical",or[or.horizontalOnly=3]="horizontalOnly";const Uo=-17;class Wl{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,c){const m=new Wl;return m.scale=n||1,m.fontStack=c,m}static forImage(n){const c=new Wl;return c.imageName=n,c}}class su{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,c){const m=new su;for(let x=0;x<n.sections.length;x++){const k=n.sections[x];k.image?m.addImageSection(k):m.addTextSection(k,c)}return m}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=(function(n){let c="";for(let m=0;m<n.length;m++){const x=n.charCodeAt(m+1)||null,k=n.charCodeAt(m-1)||null;c+=x&&No(x)&&!xh[n[m+1]]||k&&No(k)&&!xh[n[m-1]]||!xh[n[m]]?n[m]:xh[n[m]]}return c})(this.text)}trim(){let n=0;for(let m=0;m<this.text.length&&Es[this.text.charCodeAt(m)];m++)n++;let c=this.text.length;for(let m=this.text.length-1;m>=0&&m>=n&&Es[this.text.charCodeAt(m)];m--)c--;this.text=this.text.substring(n,c),this.sectionIndex=this.sectionIndex.slice(n,c)}substring(n,c){const m=new su;return m.text=this.text.substring(n,c),m.sectionIndex=this.sectionIndex.slice(n,c),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((n,c)=>Math.max(n,this.sections[c].scale)),0)}addTextSection(n,c){this.text+=n.text,this.sections.push(Wl.forText(n.scale,n.fontStack||c));const m=this.sections.length-1;for(let x=0;x<n.text.length;++x)this.sectionIndex.push(m)}addImageSection(n){const c=n.image?n.image.name:"";if(c.length===0)return void Mt("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(Wl.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Mt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Fo(a,n,c,m,x,k,C,j,R,F,q,G,J,re,ce){const he=su.fromFeature(a,x);let Ee;G===y.ah.vertical&&he.verticalizePunctuation();const{processBidirectionalText:Ae,processStyledBidirectionalText:Xe}=Js;if(Ae&&he.sections.length===1){Ee=[];const pt=Ae(he.toString(),Sd(he,F,k,n,m,re));for(const Dt of pt){const Qt=new su;Qt.text=Dt,Qt.sections=he.sections;for(let Ai=0;Ai<Dt.length;Ai++)Qt.sectionIndex.push(0);Ee.push(Qt)}}else if(Xe){Ee=[];const pt=Xe(he.text,he.sectionIndex,Sd(he,F,k,n,m,re));for(const Dt of pt){const Qt=new su;Qt.text=Dt[0],Qt.sectionIndex=Dt[1],Qt.sections=he.sections,Ee.push(Qt)}}else Ee=(function(pt,Dt){const Qt=[],Ai=pt.text;let Vt=0;for(const Gt of Dt)Qt.push(pt.substring(Vt,Gt)),Vt=Gt;return Vt<Ai.length&&Qt.push(pt.substring(Vt,Ai.length)),Qt})(he,Sd(he,F,k,n,m,re));const De=[],Ge={positionedLines:De,text:he.toString(),top:q[1],bottom:q[1],left:q[0],right:q[0],writingMode:G,iconsInText:!1,verticalizable:!1};return(function(pt,Dt,Qt,Ai,Vt,Gt,fi,ci,ri,vt,li,di){let Li=0,kn=Uo,Yn=0,cr=0;const Kr=ci==="right"?1:ci==="left"?0:.5;let Er=0;for(const js of Vt){js.trim();const hr=js.getMaxScale(),Jr=(hr-1)*Hs,kr={positionedGlyphs:[],lineOffset:0};pt.positionedLines[Er]=kr;const er=kr.positionedGlyphs;let Zs=0;if(!js.length()){kn+=Gt,++Er;continue}for(let Ma=0;Ma<js.length();Ma++){const yn=js.getSection(Ma),Un=js.getSectionIndex(Ma),cs=js.getCharCode(Ma);let Qr=0,gs=null,hu=null,bo=null,Tl=Hs;const wo=!(ri===y.ah.horizontal||!li&&!Oo(cs)||li&&(Es[cs]||(ur=cs,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(ur)))));if(yn.imageName){const So=Ai[yn.imageName];if(!So)continue;bo=yn.imageName,pt.iconsInText=pt.iconsInText||!0,hu=So.paddedRect;const dr=So.displaySize;yn.scale=yn.scale*Hs/di,gs={width:dr[0],height:dr[1],left:$i,top:-qn,advance:wo?dr[1]:dr[0]},Qr=Jr+(Hs-dr[1]*yn.scale),Tl=gs.advance;const wc=wo?dr[0]*yn.scale-Hs*hr:dr[1]*yn.scale-Hs*hr;wc>0&&wc>Zs&&(Zs=wc)}else{const So=Qt[yn.fontStack],dr=So&&So[cs];if(dr&&dr.rect)hu=dr.rect,gs=dr.metrics;else{const wc=Dt[yn.fontStack],Vu=wc&&wc[cs];if(!Vu)continue;gs=Vu.metrics}Qr=(hr-yn.scale)*Hs}wo?(pt.verticalizable=!0,er.push({glyph:cs,imageName:bo,x:Li,y:kn+Qr,vertical:wo,scale:yn.scale,fontStack:yn.fontStack,sectionIndex:Un,metrics:gs,rect:hu}),Li+=Tl*yn.scale+vt):(er.push({glyph:cs,imageName:bo,x:Li,y:kn+Qr,vertical:wo,scale:yn.scale,fontStack:yn.fontStack,sectionIndex:Un,metrics:gs,rect:hu}),Li+=gs.advance*yn.scale+vt)}er.length!==0&&(Yn=Math.max(Li-vt,Yn),zg(er,0,er.length-1,Kr,Zs)),Li=0;const Ja=Gt*hr+Zs;kr.lineOffset=Math.max(Zs,Jr),kn+=Ja,cr=Math.max(Ja,cr),++Er}var ur;const pa=kn-Uo,{horizontalAlign:ma,verticalAlign:ga}=Ch(fi);(function(js,hr,Jr,kr,er,Zs,Ja,Ma,yn){const Un=(hr-Jr)*er;let cs=0;cs=Zs!==Ja?-Ma*kr-Uo:(-kr*yn+.5)*Ja;for(const Qr of js)for(const gs of Qr.positionedGlyphs)gs.x+=Un,gs.y+=cs})(pt.positionedLines,Kr,ma,ga,Yn,cr,Gt,pa,Vt.length),pt.top+=-ga*pa,pt.bottom=pt.top+pa,pt.left+=-ma*Yn,pt.right=pt.left+Yn})(Ge,n,c,m,Ee,C,j,R,G,F,J,ce),!(function(pt){for(const Dt of pt)if(Dt.positionedGlyphs.length!==0)return!1;return!0})(De)&&Ge}const Es={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ru={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Ou={40:!0};function wf(a,n,c,m,x,k){if(n.imageName){const C=m[n.imageName];return C?C.displaySize[0]*n.scale*Hs/k+x:0}{const C=c[n.fontStack],j=C&&C[a];return j?j.metrics.advance*n.scale+x:0}}function Ka(a,n,c,m){const x=Math.pow(a-n,2);return m?a<n?x/2:2*x:x+Math.abs(c)*c}function Eh(a,n,c){let m=0;return a===10&&(m-=1e4),c&&(m+=150),a!==40&&a!==65288||(m+=50),n!==41&&n!==65289||(m+=50),m}function kh(a,n,c,m,x,k){let C=null,j=Ka(n,c,x,k);for(const R of m){const F=Ka(n-R.x,c,x,k)+R.badness;F<=j&&(C=R,j=F)}return{index:a,x:n,priorBreak:C,badness:j}}function Aa(a){return a?Aa(a.priorBreak).concat(a.index):[]}function Sd(a,n,c,m,x,k){if(!a)return[];const C=[],j=(function(G,J,re,ce,he,Ee){let Ae=0;for(let Xe=0;Xe<G.length();Xe++){const De=G.getSection(Xe);Ae+=wf(G.getCharCode(Xe),De,ce,he,J,Ee)}return Ae/Math.max(1,Math.ceil(Ae/re))})(a,n,c,m,x,k),R=a.text.indexOf("")>=0;let F=0;for(let G=0;G<a.length();G++){const J=a.getSection(G),re=a.getCharCode(G);if(Es[re]||(F+=wf(re,J,m,x,n,k)),G<a.length()-1){const ce=!((q=re)<11904)&&(!!Ui["CJK Compatibility Forms"](q)||!!Ui["CJK Compatibility"](q)||!!Ui["CJK Strokes"](q)||!!Ui["CJK Symbols and Punctuation"](q)||!!Ui["Enclosed CJK Letters and Months"](q)||!!Ui["Halfwidth and Fullwidth Forms"](q)||!!Ui["Ideographic Description Characters"](q)||!!Ui["Vertical Forms"](q)||Va.test(String.fromCodePoint(q)));(ru[re]||ce||J.imageName||G!==a.length()-2&&Ou[a.getCharCode(G+1)])&&C.push(kh(G+1,F,j,C,Eh(re,a.getCharCode(G+1),ce&&R),!1))}}var q;return Aa(kh(a.length(),F,j,C,0,!0))}function Ch(a){let n=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:n,verticalAlign:c}}function zg(a,n,c,m,x){if(!m&&!x)return;const k=a[c],C=(a[c].x+k.metrics.advance*k.scale)*m;for(let j=n;j<=c;j++)a[j].x-=C,a[j].y+=x}function Sf(a,n,c){const{horizontalAlign:m,verticalAlign:x}=Ch(c),k=n[0]-a.displaySize[0]*m,C=n[1]-a.displaySize[1]*x;return{image:a,top:C,bottom:C+a.displaySize[1],left:k,right:k+a.displaySize[0]}}function Td(a){var n,c;let m=a.left,x=a.top,k=a.right-m,C=a.bottom-x;const j=(n=a.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",R=(c=a.image.textFitHeight)!==null&&c!==void 0?c:"stretchOrShrink",F=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(R==="proportional"){if(j==="stretchOnly"&&k/C<F||j==="proportional"){const q=Math.ceil(C*F);m*=q/k,k=q}}else if(j==="proportional"&&R==="stretchOnly"&&F!==0&&k/C>F){const q=Math.ceil(k/F);x*=q/C,C=q}return{x1:m,y1:x,x2:m+k,y2:x+C}}function bc(a,n,c,m,x,k){const C=a.image;let j;if(C.content){const Ee=C.content,Ae=C.pixelRatio||1;j=[Ee[0]/Ae,Ee[1]/Ae,C.displaySize[0]-Ee[2]/Ae,C.displaySize[1]-Ee[3]/Ae]}const R=n.left*k,F=n.right*k;let q,G,J,re;c==="width"||c==="both"?(re=x[0]+R-m[3],G=x[0]+F+m[1]):(re=x[0]+(R+F-C.displaySize[0])/2,G=re+C.displaySize[0]);const ce=n.top*k,he=n.bottom*k;return c==="height"||c==="both"?(q=x[1]+ce-m[0],J=x[1]+he+m[2]):(q=x[1]+(ce+he-C.displaySize[1])/2,J=q+C.displaySize[1]),{image:C,top:q,right:G,bottom:J,left:re,collisionPadding:j}}const Ns=255,Xr=128,vo=Ns*Xr;function Yl(a,n){const{expression:c}=n;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new nn(a+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:x}=c;let k=0;for(;k<m.length&&m[k]<=a;)k++;k=Math.max(0,k-1);let C=k;for(;C<m.length&&m[C]<a+1;)C++;C=Math.min(m.length-1,C);const j=m[k],R=m[C];return c.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:R,interpolationType:x}:{kind:"camera",minZoom:j,maxZoom:R,minSize:c.evaluate(new nn(j)),maxSize:c.evaluate(new nn(R)),interpolationType:x}}}function Ed(a,n,c){let m="never";const x=a.get(n);return x?m=x:a.get(c)&&(m="always"),m}const Kp=yc.VectorTileFeature.types,Rg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function au(a,n,c,m,x,k,C,j,R,F,q,G,J){const re=j?Math.min(vo,Math.round(j[0])):0,ce=j?Math.min(vo,Math.round(j[1])):0;a.emplaceBack(n,c,Math.round(32*m),Math.round(32*x),k,C,(re<<1)+(R?1:0),ce,16*F,16*q,256*G,256*J)}function kd(a,n,c){a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c),a.emplaceBack(n.x,n.y,c)}function xo(a){for(const n of a.sections)if(oh(n.text))return!0;return!1}class Tf{constructor(n){this.layoutVertexArray=new hc,this.indexArray=new ha,this.programConfigurations=n,this.segments=new sn,this.dynamicLayoutVertexArray=new yo,this.opacityVertexArray=new Ri,this.hasVisibleVertices=!1,this.placedSymbolArray=new Vn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,c,m,x){this.isEmpty()||(m&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,w_.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Mg.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,Rg,!0),this.opacityVertexBuffer.itemSize=1),(m||x)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}jt("SymbolBuffers",Tf);class da{constructor(n,c,m){this.layoutVertexArray=new n,this.layoutAttributes=c,this.indexArray=new m,this.segments=new sn,this.collisionVertexArray=new os}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Pg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}jt("CollisionBuffers",da);class Nu{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((C=>C.id)),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=uf([]),this.placementViewportMatrix=uf([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Yl(this.zoom,c["text-size"]),this.iconSizeData=Yl(this.zoom,c["icon-size"]);const m=this.layers[0].layout,x=m.get("symbol-sort-key"),k=m.get("symbol-z-order");this.canOverlap=Ed(m,"text-overlap","text-allow-overlap")!=="never"||Ed(m,"icon-overlap","icon-allow-overlap")!=="never"||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!x.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map((C=>y.ah[C]))),this.stateDependentLayerIds=this.layers.filter((C=>C.isStateDependent())).map((C=>C.id)),this.sourceID=n.sourceID}createArrays(){this.text=new Tf(new Xc(this.layers,this.zoom,(n=>/^text/.test(n)))),this.icon=new Tf(new Xc(this.layers,this.zoom,(n=>/^icon/.test(n)))),this.glyphOffsetArray=new $n,this.lineVertexArray=new Qs,this.symbolInstances=new un,this.textAnchorOffsets=new Jn}calculateGlyphDependencies(n,c,m,x,k){for(let C=0;C<n.length;C++)if(c[n.charCodeAt(C)]=!0,(m||x)&&k){const j=xh[n.charAt(C)];j&&(c[j.charCodeAt(0)]=!0)}}populate(n,c,m){const x=this.layers[0],k=x.layout,C=k.get("text-font"),j=k.get("text-field"),R=k.get("icon-image"),F=(j.value.kind!=="constant"||j.value.value instanceof Ys&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),q=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,G=k.get("symbol-sort-key");if(this.features=[],!F&&!q)return;const J=c.iconDependencies,re=c.glyphDependencies,ce=c.availableImages,he=new nn(this.zoom);for(const{feature:Ee,id:Ae,index:Xe,sourceLayerIndex:De}of n){const Ge=x._featureFilter.needGeometry,pt=Jc(Ee,Ge);if(!x._featureFilter.filter(he,pt,m))continue;let Dt,Qt;if(Ge||(pt.geometry=Kc(Ee)),F){const Vt=x.getValueAndResolveTokens("text-field",pt,m,ce),Gt=Ys.factory(Vt),fi=this.hasRTLText=this.hasRTLText||xo(Gt);(!fi||Js.getRTLTextPluginStatus()==="unavailable"||fi&&Js.isParsed())&&(Dt=vc(Gt,x,pt))}if(q){const Vt=x.getValueAndResolveTokens("icon-image",pt,m,ce);Qt=Vt instanceof yr?Vt:yr.fromString(Vt)}if(!Dt&&!Qt)continue;const Ai=this.sortFeaturesByKey?G.evaluate(pt,{},m):void 0;if(this.features.push({id:Ae,text:Dt,icon:Qt,index:Xe,sourceLayerIndex:De,geometry:pt.geometry,properties:Ee.properties,type:Kp[Ee.type],sortKey:Ai}),Qt&&(J[Qt.name]=!0),Dt){const Vt=C.evaluate(pt,{},m).join(","),Gt=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ah.vertical)>=0;for(const fi of Dt.sections)if(fi.image)J[fi.image.name]=!0;else{const ci=mo(Dt.toString()),ri=fi.fontStack||Vt,vt=re[ri]=re[ri]||{};this.calculateGlyphDependencies(fi.text,vt,Gt,this.allowVerticalPlacement,ci)}}}k.get("symbol-placement")==="line"&&(this.features=(function(Ee){const Ae={},Xe={},De=[];let Ge=0;function pt(Vt){De.push(Ee[Vt]),Ge++}function Dt(Vt,Gt,fi){const ci=Xe[Vt];return delete Xe[Vt],Xe[Gt]=ci,De[ci].geometry[0].pop(),De[ci].geometry[0]=De[ci].geometry[0].concat(fi[0]),ci}function Qt(Vt,Gt,fi){const ci=Ae[Gt];return delete Ae[Gt],Ae[Vt]=ci,De[ci].geometry[0].shift(),De[ci].geometry[0]=fi[0].concat(De[ci].geometry[0]),ci}function Ai(Vt,Gt,fi){const ci=fi?Gt[0][Gt[0].length-1]:Gt[0][0];return`${Vt}:${ci.x}:${ci.y}`}for(let Vt=0;Vt<Ee.length;Vt++){const Gt=Ee[Vt],fi=Gt.geometry,ci=Gt.text?Gt.text.toString():null;if(!ci){pt(Vt);continue}const ri=Ai(ci,fi),vt=Ai(ci,fi,!0);if(ri in Xe&&vt in Ae&&Xe[ri]!==Ae[vt]){const li=Qt(ri,vt,fi),di=Dt(ri,vt,De[li].geometry);delete Ae[ri],delete Xe[vt],Xe[Ai(ci,De[di].geometry,!0)]=di,De[li].geometry=null}else ri in Xe?Dt(ri,vt,fi):vt in Ae?Qt(ri,vt,fi):(pt(Vt),Ae[ri]=Ge-1,Xe[vt]=Ge-1)}return De.filter((Vt=>Vt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Ee,Ae)=>Ee.sortKey-Ae.sortKey))}update(n,c,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,c,this.layers,m),this.icon.programConfigurations.updatePaintArrays(n,c,this.layers,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,c){const m=this.lineVertexArray.length;if(n.segment!==void 0){let x=n.dist(c[n.segment+1]),k=n.dist(c[n.segment]);const C={};for(let j=n.segment+1;j<c.length;j++)C[j]={x:c[j].x,y:c[j].y,tileUnitDistanceFromAnchor:x},j<c.length-1&&(x+=c[j+1].dist(c[j]));for(let j=n.segment||0;j>=0;j--)C[j]={x:c[j].x,y:c[j].y,tileUnitDistanceFromAnchor:k},j>0&&(k+=c[j-1].dist(c[j]));for(let j=0;j<c.length;j++){const R=C[j];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(n,c,m,x,k,C,j,R,F,q,G,J){const re=n.indexArray,ce=n.layoutVertexArray,he=n.segments.prepareSegment(4*c.length,ce,re,this.canOverlap?C.sortKey:void 0),Ee=this.glyphOffsetArray.length,Ae=he.vertexLength,Xe=this.allowVerticalPlacement&&j===y.ah.vertical?Math.PI/2:0,De=C.text&&C.text.sections;for(let Ge=0;Ge<c.length;Ge++){const{tl:pt,tr:Dt,bl:Qt,br:Ai,tex:Vt,pixelOffsetTL:Gt,pixelOffsetBR:fi,minFontScaleX:ci,minFontScaleY:ri,glyphOffset:vt,isSDF:li,sectionIndex:di}=c[Ge],Li=he.vertexLength,kn=vt[1];au(ce,R.x,R.y,pt.x,kn+pt.y,Vt.x,Vt.y,m,li,Gt.x,Gt.y,ci,ri),au(ce,R.x,R.y,Dt.x,kn+Dt.y,Vt.x+Vt.w,Vt.y,m,li,fi.x,Gt.y,ci,ri),au(ce,R.x,R.y,Qt.x,kn+Qt.y,Vt.x,Vt.y+Vt.h,m,li,Gt.x,fi.y,ci,ri),au(ce,R.x,R.y,Ai.x,kn+Ai.y,Vt.x+Vt.w,Vt.y+Vt.h,m,li,fi.x,fi.y,ci,ri),kd(n.dynamicLayoutVertexArray,R,Xe),re.emplaceBack(Li,Li+1,Li+2),re.emplaceBack(Li+1,Li+2,Li+3),he.vertexLength+=4,he.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vt[0]),Ge!==c.length-1&&di===c[Ge+1].sectionIndex||n.programConfigurations.populatePaintArrays(ce.length,C,C.index,{},J,De&&De[di])}n.placedSymbolArray.emplaceBack(R.x,R.y,Ee,this.glyphOffsetArray.length-Ee,Ae,F,q,R.segment,m?m[0]:0,m?m[1]:0,x[0],x[1],j,0,!1,0,G)}_addCollisionDebugVertex(n,c,m,x,k,C){return c.emplaceBack(0,0),n.emplaceBack(m.x,m.y,x,k,Math.round(C.x),Math.round(C.y))}addCollisionDebugVertices(n,c,m,x,k,C,j){const R=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),F=R.vertexLength,q=k.layoutVertexArray,G=k.collisionVertexArray,J=j.anchorX,re=j.anchorY;this._addCollisionDebugVertex(q,G,C,J,re,new N(n,c)),this._addCollisionDebugVertex(q,G,C,J,re,new N(m,c)),this._addCollisionDebugVertex(q,G,C,J,re,new N(m,x)),this._addCollisionDebugVertex(q,G,C,J,re,new N(n,x)),R.vertexLength+=4;const ce=k.indexArray;ce.emplaceBack(F,F+1),ce.emplaceBack(F+1,F+2),ce.emplaceBack(F+2,F+3),ce.emplaceBack(F+3,F),R.primitiveLength+=4}addDebugCollisionBoxes(n,c,m,x){for(let k=n;k<c;k++){const C=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,x?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,m)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new da(gn,Ts.members,Ps),this.iconCollisionBox=new da(gn,Ts.members,Ps);for(let n=0;n<this.symbolInstances.length;n++){const c=this.symbolInstances.get(n);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(n,c,m,x,k,C,j,R,F){const q={};for(let G=c;G<m;G++){const J=n.get(G);q.textBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.textFeatureIndex=J.featureIndex;break}for(let G=x;G<k;G++){const J=n.get(G);q.verticalTextBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.verticalTextFeatureIndex=J.featureIndex;break}for(let G=C;G<j;G++){const J=n.get(G);q.iconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.iconFeatureIndex=J.featureIndex;break}for(let G=R;G<F;G++){const J=n.get(G);q.verticalIconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},q.verticalIconFeatureIndex=J.featureIndex;break}return q}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const m=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,c){const m=n.placedSymbolArray.get(c),x=m.vertexStartIndex+4*m.numGlyphs;for(let k=m.vertexStartIndex;k<x;k+=4)n.indexArray.emplaceBack(k,k+1,k+2),n.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(n),m=Math.cos(n),x=[],k=[],C=[];for(let j=0;j<this.symbolInstances.length;++j){C.push(j);const R=this.symbolInstances.get(j);x.push(0|Math.round(c*R.anchorX+m*R.anchorY)),k.push(R.featureIndex)}return C.sort(((j,R)=>x[j]-x[R]||k[R]-k[j])),C}addToSortKeyRanges(n,c){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===c?m.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const m=this.symbolInstances.get(c);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach(((x,k,C)=>{x>=0&&C.indexOf(x)===k&&this.addIndicesForPlacedSymbol(this.text,x)})),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Jp,Dg;jt("SymbolBucket",Nu,{omit:["layers","collisionBoxArray","features","compareText"]}),Nu.MAX_GLYPHS=65535,Nu.addDynamicAttributes=kd;var Xl={get paint(){return Dg=Dg||new E({"icon-opacity":new Ti(tt.paint_symbol["icon-opacity"]),"icon-color":new Ti(tt.paint_symbol["icon-color"]),"icon-halo-color":new Ti(tt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ti(tt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ti(tt.paint_symbol["icon-halo-blur"]),"icon-translate":new ui(tt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ui(tt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ti(tt.paint_symbol["text-opacity"]),"text-color":new Ti(tt.paint_symbol["text-color"],{runtimeType:Ji,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Ti(tt.paint_symbol["text-halo-color"]),"text-halo-width":new Ti(tt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ti(tt.paint_symbol["text-halo-blur"]),"text-translate":new ui(tt.paint_symbol["text-translate"]),"text-translate-anchor":new ui(tt.paint_symbol["text-translate-anchor"])})},get layout(){return Jp=Jp||new E({"symbol-placement":new ui(tt.layout_symbol["symbol-placement"]),"symbol-spacing":new ui(tt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ui(tt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ti(tt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ui(tt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ui(tt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ui(tt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ui(tt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ui(tt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ui(tt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ti(tt.layout_symbol["icon-size"]),"icon-text-fit":new ui(tt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ui(tt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ti(tt.layout_symbol["icon-image"]),"icon-rotate":new Ti(tt.layout_symbol["icon-rotate"]),"icon-padding":new Ti(tt.layout_symbol["icon-padding"]),"icon-keep-upright":new ui(tt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ti(tt.layout_symbol["icon-offset"]),"icon-anchor":new Ti(tt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ui(tt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ui(tt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ui(tt.layout_symbol["text-rotation-alignment"]),"text-field":new Ti(tt.layout_symbol["text-field"]),"text-font":new Ti(tt.layout_symbol["text-font"]),"text-size":new Ti(tt.layout_symbol["text-size"]),"text-max-width":new Ti(tt.layout_symbol["text-max-width"]),"text-line-height":new ui(tt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ti(tt.layout_symbol["text-letter-spacing"]),"text-justify":new Ti(tt.layout_symbol["text-justify"]),"text-radial-offset":new Ti(tt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ui(tt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ti(tt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ti(tt.layout_symbol["text-anchor"]),"text-max-angle":new ui(tt.layout_symbol["text-max-angle"]),"text-writing-mode":new ui(tt.layout_symbol["text-writing-mode"]),"text-rotate":new Ti(tt.layout_symbol["text-rotate"]),"text-padding":new ui(tt.layout_symbol["text-padding"]),"text-keep-upright":new ui(tt.layout_symbol["text-keep-upright"]),"text-transform":new Ti(tt.layout_symbol["text-transform"]),"text-offset":new Ti(tt.layout_symbol["text-offset"]),"text-allow-overlap":new ui(tt.layout_symbol["text-allow-overlap"]),"text-overlap":new ui(tt.layout_symbol["text-overlap"]),"text-ignore-placement":new ui(tt.layout_symbol["text-ignore-placement"]),"text-optional":new ui(tt.layout_symbol["text-optional"])})}};class Cd{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Kn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(n.formattedSection))return c.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}jt("FormatSectionOverride",Cd,{omit:["defaultValue"]});class Ah extends h{constructor(n){super(n,Xl)}recalculate(n,c){if(super.recalculate(n,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const m=this.layout.get("text-writing-mode");if(m){const x=[];for(const k of m)x.indexOf(k)<0&&x.push(k);this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,c,m,x){const k=this.layout.get(n).evaluate(c,{},m,x),C=this._unevaluatedLayout._values[n];return C.isDataDriven()||fo(C.value)||!k?k:(function(j,R){return R.replace(/{([^{}]+)}/g,((F,q)=>j&&q in j?String(j[q]):""))})(c.properties,k)}createBucket(n){return new Nu(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Xl.paint.overridableProperties){if(!Ah.hasPaintOverride(this.layout,n))continue;const c=this.paint.get(n),m=new Cd(c),x=new Lo(m,c.property.specification);let k=null;k=c.value.kind==="constant"||c.value.kind==="source"?new Vr("source",x):new Ta("composite",x,c.value.zoomStops),this.paint._values[n]=new qa(c.property,k,c.parameters)}}_handleOverridablePaintPropertyUpdate(n,c,m){return!(!this.layout||c.isDataDriven()||m.isDataDriven())&&Ah.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,c){const m=n.get("text-field"),x=Xl.paint.properties[c];let k=!1;const C=j=>{for(const R of j)if(x.overrides&&x.overrides.hasOverride(R))return void(k=!0)};if(m.value.kind==="constant"&&m.value.value instanceof Ys)C(m.value.value.sections);else if(m.value.kind==="source"){const j=F=>{k||(F instanceof ys&&Pi(F.value)===hi?C(F.value.sections):F instanceof Mo?C(F.sections):F.eachChild(j))},R=m.value;R._styleExpression&&j(R._styleExpression.expression)}return k}}let Bu;var Og={get paint(){return Bu=Bu||new E({"background-color":new ui(tt.paint_background["background-color"]),"background-pattern":new xl(tt.paint_background["background-pattern"]),"background-opacity":new ui(tt.paint_background["background-opacity"])})}};class Ng extends h{constructor(n){super(n,Og)}}let Qp;var Bg={get paint(){return Qp=Qp||new E({"raster-opacity":new ui(tt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ui(tt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ui(tt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ui(tt.paint_raster["raster-brightness-max"]),"raster-saturation":new ui(tt.paint_raster["raster-saturation"]),"raster-contrast":new ui(tt.paint_raster["raster-contrast"]),"raster-resampling":new ui(tt.paint_raster["raster-resampling"]),"raster-fade-duration":new ui(tt.paint_raster["raster-fade-duration"])})}};class Ef extends h{constructor(n){super(n,Bg)}}class em extends h{constructor(n){super(n,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class E_{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const tm=63710088e-1;class ou{constructor(n,c){if(isNaN(n)||isNaN(c))throw new Error(`Invalid LngLat object: (${n}, ${c})`);if(this.lng=+n,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ou(Se(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const c=Math.PI/180,m=this.lat*c,x=n.lat*c,k=Math.sin(m)*Math.sin(x)+Math.cos(m)*Math.cos(x)*Math.cos((n.lng-this.lng)*c);return tm*Math.acos(Math.min(k,1))}static convert(n){if(n instanceof ou)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new ou(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new ou(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const im=2*Math.PI*tm;function nm(a){return im*Math.cos(a*Math.PI/180)}function $u(a){return(180+a)/360}function Ad(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function sm(a,n){return a/nm(n)}function kf(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class Mh{constructor(n,c,m=0){this.x=+n,this.y=+c,this.z=+m}static fromLngLat(n,c=0){const m=ou.convert(n);return new Mh($u(m.lng),Ad(m.lat),sm(c,m.lat))}toLngLat(){return new ou(360*this.x-180,kf(this.y))}toAltitude(){return this.z*nm(kf(this.y))}meterInMercatorCoordinateUnits(){return 1/im*(n=kf(this.y),1/Math.cos(n*Math.PI/180));var n}}function rm(a,n,c){var m=2*Math.PI*6378137/256/Math.pow(2,c);return[a*m-2*Math.PI*6378137/2,n*m-2*Math.PI*6378137/2]}class Cf{constructor(n,c,m){if(!(function(x,k,C){return!(x<0||x>25||C<0||C>=Math.pow(2,x)||k<0||k>=Math.pow(2,x))})(n,c,m))throw new Error(`x=${c}, y=${m}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=c,this.y=m,this.key=Ph(0,n,n,c,m)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,c,m){const x=(C=this.y,j=this.z,R=rm(256*(k=this.x),256*(C=Math.pow(2,j)-C-1),j),F=rm(256*(k+1),256*(C+1),j),R[0]+","+R[1]+","+F[0]+","+F[1]);var k,C,j,R,F;const q=(function(G,J,re){let ce,he="";for(let Ee=G;Ee>0;Ee--)ce=1<<Ee-1,he+=(J&ce?1:0)+(re&ce?2:0);return he})(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(m==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,q).replace(/{bbox-epsg-3857}/g,x)}isChildOf(n){const c=this.z-n.z;return c>0&&n.x===this.x>>c&&n.y===this.y>>c}getTilePoint(n){const c=Math.pow(2,this.z);return new N((n.x*c-this.x)*Ds,(n.y*c-this.y)*Ds)}toString(){return`${this.z}/${this.x}/${this.y}`}}class am{constructor(n,c){this.wrap=n,this.canonical=c,this.key=Ph(n,c.z,c.z,c.x,c.y)}}class fa{constructor(n,c,m,x,k){if(n<m)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${m}`);this.overscaledZ=n,this.wrap=c,this.canonical=new Cf(m,+x,+k),this.key=Ph(c,n,m,x,k)}clone(){return new fa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-n;return n>this.canonical.z?new fa(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fa(n,this.wrap,n,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(n,c){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const m=this.canonical.z-n;return n>this.canonical.z?Ph(this.wrap*+c,n,this.canonical.z,this.canonical.x,this.canonical.y):Ph(this.wrap*+c,n,n,this.canonical.x>>m,this.canonical.y>>m)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const c=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>c&&n.canonical.y===this.canonical.y>>c}children(n){if(this.overscaledZ>=n)return[new fa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,m=2*this.canonical.x,x=2*this.canonical.y;return[new fa(c,this.wrap,c,m,x),new fa(c,this.wrap,c,m+1,x),new fa(c,this.wrap,c,m,x+1),new fa(c,this.wrap,c,m+1,x+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new fa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new fa(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new am(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Mh(n.x-this.wrap,n.y))}}function Ph(a,n,c,m,x){(a*=2)<0&&(a=-1*a-1);const k=1<<c;return(k*k*a+k*x+m).toString(36)+c.toString(36)+n.toString(36)}jt("CanonicalTileID",Cf),jt("OverscaledTileID",fa,{omit:["posMatrix"]});class om{constructor(n,c,m,x=1,k=1,C=1,j=0){if(this.uid=n,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(m&&!["mapbox","terrarium","custom"].includes(m))return void Mt(`"${m}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=c.height;const R=this.dim=c.height-2;switch(this.data=new Uint32Array(c.data.buffer),m){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=x,this.greenFactor=k,this.blueFactor=C,this.baseShift=j;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let F=0;F<R;F++)this.data[this._idx(-1,F)]=this.data[this._idx(0,F)],this.data[this._idx(R,F)]=this.data[this._idx(R-1,F)],this.data[this._idx(F,-1)]=this.data[this._idx(F,0)],this.data[this._idx(F,R)]=this.data[this._idx(F,R-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(R,-1)]=this.data[this._idx(R-1,0)],this.data[this._idx(-1,R)]=this.data[this._idx(0,R-1)],this.data[this._idx(R,R)]=this.data[this._idx(R-1,R-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let F=0;F<R;F++)for(let q=0;q<R;q++){const G=this.get(F,q);G>this.max&&(this.max=G),G<this.min&&(this.min=G)}}get(n,c){const m=new Uint8Array(this.data.buffer),x=4*this._idx(n,c);return this.unpack(m[x],m[x+1],m[x+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,c){if(n<-1||n>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(n+1)}unpack(n,c,m){return n*this.redFactor+c*this.greenFactor+m*this.blueFactor-this.baseShift}getPixels(){return new Wa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,c,m){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let x=c*this.dim,k=c*this.dim+this.dim,C=m*this.dim,j=m*this.dim+this.dim;switch(c){case-1:x=k-1;break;case 1:k=x+1}switch(m){case-1:C=j-1;break;case 1:j=C+1}const R=-c*this.dim,F=-m*this.dim;for(let q=C;q<j;q++)for(let G=x;G<k;G++)this.data[this._idx(G,q)]=n.data[this._idx(G+R,q+F)]}}jt("DEMData",om);class es{constructor(n){this._stringToNumber={},this._numberToString=[];for(let c=0;c<n.length;c++){const m=n[c];this._stringToNumber[m]=c,this._numberToString[c]=m}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class Af{constructor(n,c,m,x,k){this.type="Feature",this._vectorTileFeature=n,n._z=c,n._x=m,n._y=x,this.properties=n.properties,this.id=k}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const c in this)c!=="_geometry"&&c!=="_vectorTileFeature"&&(n[c]=this[c]);return n}}class $g{constructor(n,c){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new bn(Ds,16,0),this.grid3D=new bn(Ds,16,0),this.featureIndexArray=new rs,this.promoteId=c}insert(n,c,m,x,k,C){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,x,k);const R=C?this.grid3D:this.grid;for(let F=0;F<c.length;F++){const q=c[F],G=[1/0,1/0,-1/0,-1/0];for(let J=0;J<q.length;J++){const re=q[J];G[0]=Math.min(G[0],re.x),G[1]=Math.min(G[1],re.y),G[2]=Math.max(G[2],re.x),G[3]=Math.max(G[3],re.y)}G[0]<Ds&&G[1]<Ds&&G[2]>=0&&G[3]>=0&&R.insert(j,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new yc.VectorTile(new bf(this.rawTileData)).layers,this.sourceLayerCoder=new es(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,c,m,x){this.loadVTLayers();const k=n.params||{},C=Ds/n.tileSize/n.scale,j=hl(k.filter),R=n.queryGeometry,F=n.queryPadding*C,q=Ug(R),G=this.grid.query(q.minX-F,q.minY-F,q.maxX+F,q.maxY+F),J=Ug(n.cameraQueryGeometry),re=this.grid3D.query(J.minX-F,J.minY-F,J.maxX+F,J.maxY+F,((Ee,Ae,Xe,De)=>(function(Ge,pt,Dt,Qt,Ai){for(const Gt of Ge)if(pt<=Gt.x&&Dt<=Gt.y&&Qt>=Gt.x&&Ai>=Gt.y)return!0;const Vt=[new N(pt,Dt),new N(pt,Ai),new N(Qt,Ai),new N(Qt,Dt)];if(Ge.length>2){for(const Gt of Vt)if(mc(Ge,Gt))return!0}for(let Gt=0;Gt<Ge.length-1;Gt++)if(og(Ge[Gt],Ge[Gt+1],Vt))return!0;return!1})(n.cameraQueryGeometry,Ee-F,Ae-F,Xe+F,De+F)));for(const Ee of re)G.push(Ee);G.sort(k_);const ce={};let he;for(let Ee=0;Ee<G.length;Ee++){const Ae=G[Ee];if(Ae===he)continue;he=Ae;const Xe=this.featureIndexArray.get(Ae);let De=null;this.loadMatchingFeature(ce,Xe.bucketIndex,Xe.sourceLayerIndex,Xe.featureIndex,j,k.layers,k.availableImages,c,m,x,((Ge,pt,Dt)=>(De||(De=Kc(Ge)),pt.queryIntersectsFeature(R,Ge,Dt,De,this.z,n.transform,C,n.pixelPosMatrix))))}return ce}loadMatchingFeature(n,c,m,x,k,C,j,R,F,q,G){const J=this.bucketLayerIDs[c];if(C&&!(function(Ee,Ae){for(let Xe=0;Xe<Ee.length;Xe++)if(Ae.indexOf(Ee[Xe])>=0)return!0;return!1})(C,J))return;const re=this.sourceLayerCoder.decode(m),ce=this.vtLayers[re].feature(x);if(k.needGeometry){const Ee=Jc(ce,!0);if(!k.filter(new nn(this.tileID.overscaledZ),Ee,this.tileID.canonical))return}else if(!k.filter(new nn(this.tileID.overscaledZ),ce))return;const he=this.getId(ce,re);for(let Ee=0;Ee<J.length;Ee++){const Ae=J[Ee];if(C&&C.indexOf(Ae)<0)continue;const Xe=R[Ae];if(!Xe)continue;let De={};he&&q&&(De=q.getState(Xe.sourceLayer||"_geojsonTileLayer",he));const Ge=ze({},F[Ae]);Ge.paint=lm(Ge.paint,Xe.paint,ce,De,j),Ge.layout=lm(Ge.layout,Xe.layout,ce,De,j);const pt=!G||G(ce,Xe,De);if(!pt)continue;const Dt=new Af(ce,this.z,this.x,this.y,he);Dt.layer=Ge;let Qt=n[Ae];Qt===void 0&&(Qt=n[Ae]=[]),Qt.push({featureIndex:x,feature:Dt,intersectionZ:pt})}}lookupSymbolFeatures(n,c,m,x,k,C,j,R){const F={};this.loadVTLayers();const q=hl(k);for(const G of n)this.loadMatchingFeature(F,m,x,G,q,C,j,R,c);return F}hasLayer(n){for(const c of this.bucketLayerIDs)for(const m of c)if(n===m)return!0;return!1}getId(n,c){let m=n.id;return this.promoteId&&(m=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[c]],typeof m=="boolean"&&(m=Number(m))),m}}function lm(a,n,c,m,x){return Ze(a,((k,C)=>{const j=n instanceof _l?n.get(C):null;return j&&j.evaluate?j.evaluate(c,m,x):j}))}function Ug(a){let n=1/0,c=1/0,m=-1/0,x=-1/0;for(const k of a)n=Math.min(n,k.x),c=Math.min(c,k.y),m=Math.max(m,k.x),x=Math.max(x,k.y);return{minX:n,minY:c,maxX:m,maxY:x}}function k_(a,n){return n-a}function Fg(a,n,c,m,x){const k=[];for(let C=0;C<a.length;C++){const j=a[C];let R;for(let F=0;F<j.length-1;F++){let q=j[F],G=j[F+1];q.x<n&&G.x<n||(q.x<n?q=new N(n,q.y+(n-q.x)/(G.x-q.x)*(G.y-q.y))._round():G.x<n&&(G=new N(n,q.y+(n-q.x)/(G.x-q.x)*(G.y-q.y))._round()),q.y<c&&G.y<c||(q.y<c?q=new N(q.x+(c-q.y)/(G.y-q.y)*(G.x-q.x),c)._round():G.y<c&&(G=new N(q.x+(c-q.y)/(G.y-q.y)*(G.x-q.x),c)._round()),q.x>=m&&G.x>=m||(q.x>=m?q=new N(m,q.y+(m-q.x)/(G.x-q.x)*(G.y-q.y))._round():G.x>=m&&(G=new N(m,q.y+(m-q.x)/(G.x-q.x)*(G.y-q.y))._round()),q.y>=x&&G.y>=x||(q.y>=x?q=new N(q.x+(x-q.y)/(G.y-q.y)*(G.x-q.x),x)._round():G.y>=x&&(G=new N(q.x+(x-q.y)/(G.y-q.y)*(G.x-q.x),x)._round()),R&&q.equals(R[R.length-1])||(R=[q],k.push(R)),R.push(G)))))}}return k}jt("FeatureIndex",$g,{omit:["rawTileData","sourceLayerCoder"]});class Sl extends N{constructor(n,c,m,x){super(n,c),this.angle=m,x!==void 0&&(this.segment=x)}clone(){return new Sl(this.x,this.y,this.angle,this.segment)}}function Uu(a,n,c,m,x){if(n.segment===void 0||c===0)return!0;let k=n,C=n.segment+1,j=0;for(;j>-c/2;){if(C--,C<0)return!1;j-=a[C].dist(k),k=a[C]}j+=a[C].dist(a[C+1]),C++;const R=[];let F=0;for(;j<c/2;){const q=a[C],G=a[C+1];if(!G)return!1;let J=a[C-1].angleTo(q)-q.angleTo(G);for(J=Math.abs((J+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:j,angleDelta:J}),F+=J;j-R[0].distance>m;)F-=R.shift().angleDelta;if(F>x)return!1;C++,j+=q.dist(G)}return!0}function Mf(a){let n=0;for(let c=0;c<a.length-1;c++)n+=a[c].dist(a[c+1]);return n}function Md(a,n,c){return a?.6*n*c:0}function Pf(a,n){return Math.max(a?a.right-a.left:0,n?n.right-n.left:0)}function lu(a,n,c,m,x,k){const C=Md(c,x,k),j=Pf(c,m)*k;let R=0;const F=Mf(a)/2;for(let q=0;q<a.length-1;q++){const G=a[q],J=a[q+1],re=G.dist(J);if(R+re>F){const ce=(F-R)/re,he=Us.number(G.x,J.x,ce),Ee=Us.number(G.y,J.y,ce),Ae=new Sl(he,Ee,J.angleTo(G),q);return Ae._round(),!C||Uu(a,Ae,j,C,n)?Ae:void 0}R+=re}}function Kl(a,n,c,m,x,k,C,j,R){const F=Md(m,k,C),q=Pf(m,x),G=q*C,J=a[0].x===0||a[0].x===R||a[0].y===0||a[0].y===R;return n-G<n/4&&(n=G+n/4),Ih(a,J?n/2*j%n:(q/2+2*k)*C*j%n,n,F,c,G,J,!1,R)}function Ih(a,n,c,m,x,k,C,j,R){const F=k/2,q=Mf(a);let G=0,J=n-c,re=[];for(let ce=0;ce<a.length-1;ce++){const he=a[ce],Ee=a[ce+1],Ae=he.dist(Ee),Xe=Ee.angleTo(he);for(;J+c<G+Ae;){J+=c;const De=(J-G)/Ae,Ge=Us.number(he.x,Ee.x,De),pt=Us.number(he.y,Ee.y,De);if(Ge>=0&&Ge<R&&pt>=0&&pt<R&&J-F>=0&&J+F<=q){const Dt=new Sl(Ge,pt,Xe,ce);Dt._round(),m&&!Uu(a,Dt,k,m,x)||re.push(Dt)}}G+=Ae}return j||re.length||C||(re=Ih(a,G/2,c,m,x,k,C,!0,R)),re}jt("Anchor",Sl);const jh=$i;function cm(a,n,c,m){const x=[],k=a.image,C=k.pixelRatio,j=k.paddedRect.w-2*jh,R=k.paddedRect.h-2*jh;let F={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const q=k.stretchX||[[0,j]],G=k.stretchY||[[0,R]],J=(vt,li)=>vt+li[1]-li[0],re=q.reduce(J,0),ce=G.reduce(J,0),he=j-re,Ee=R-ce;let Ae=0,Xe=re,De=0,Ge=ce,pt=0,Dt=he,Qt=0,Ai=Ee;if(k.content&&m){const vt=k.content,li=vt[2]-vt[0],di=vt[3]-vt[1];(k.textFitWidth||k.textFitHeight)&&(F=Td(a)),Ae=Pd(q,0,vt[0]),De=Pd(G,0,vt[1]),Xe=Pd(q,vt[0],vt[2]),Ge=Pd(G,vt[1],vt[3]),pt=vt[0]-Ae,Qt=vt[1]-De,Dt=li-Xe,Ai=di-Ge}const Vt=F.x1,Gt=F.y1,fi=F.x2-Vt,ci=F.y2-Gt,ri=(vt,li,di,Li)=>{const kn=Id(vt.stretch-Ae,Xe,fi,Vt),Yn=If(vt.fixed-pt,Dt,vt.stretch,re),cr=Id(li.stretch-De,Ge,ci,Gt),Kr=If(li.fixed-Qt,Ai,li.stretch,ce),Er=Id(di.stretch-Ae,Xe,fi,Vt),ur=If(di.fixed-pt,Dt,di.stretch,re),pa=Id(Li.stretch-De,Ge,ci,Gt),ma=If(Li.fixed-Qt,Ai,Li.stretch,ce),ga=new N(kn,cr),js=new N(Er,cr),hr=new N(Er,pa),Jr=new N(kn,pa),kr=new N(Yn/C,Kr/C),er=new N(ur/C,ma/C),Zs=n*Math.PI/180;if(Zs){const yn=Math.sin(Zs),Un=Math.cos(Zs),cs=[Un,-yn,yn,Un];ga._matMult(cs),js._matMult(cs),Jr._matMult(cs),hr._matMult(cs)}const Ja=vt.stretch+vt.fixed,Ma=li.stretch+li.fixed;return{tl:ga,tr:js,bl:Jr,br:hr,tex:{x:k.paddedRect.x+jh+Ja,y:k.paddedRect.y+jh+Ma,w:di.stretch+di.fixed-Ja,h:Li.stretch+Li.fixed-Ma},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:kr,pixelOffsetBR:er,minFontScaleX:Dt/C/fi,minFontScaleY:Ai/C/ci,isSDF:c}};if(m&&(k.stretchX||k.stretchY)){const vt=um(q,he,re),li=um(G,Ee,ce);for(let di=0;di<vt.length-1;di++){const Li=vt[di],kn=vt[di+1];for(let Yn=0;Yn<li.length-1;Yn++)x.push(ri(Li,li[Yn],kn,li[Yn+1]))}}else x.push(ri({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:R+1}));return x}function Pd(a,n,c){let m=0;for(const x of a)m+=Math.max(n,Math.min(c,x[1]))-Math.max(n,Math.min(c,x[0]));return m}function um(a,n,c){const m=[{fixed:-jh,stretch:0}];for(const[x,k]of a){const C=m[m.length-1];m.push({fixed:x-C.stretch,stretch:C.stretch}),m.push({fixed:x-C.stretch,stretch:C.stretch+(k-x)})}return m.push({fixed:n+jh,stretch:c}),m}function Id(a,n,c,m){return a/n*c+m}function If(a,n,c,m){return a-n*c/m}class Lh{constructor(n,c,m,x,k,C,j,R,F,q){var G;if(this.boxStartIndex=n.length,F){let J=C.top,re=C.bottom;const ce=C.collisionPadding;ce&&(J-=ce[1],re+=ce[3]);let he=re-J;he>0&&(he=Math.max(10,he),this.circleDiameter=he)}else{const J=!((G=C.image)===null||G===void 0)&&G.content&&(C.image.textFitWidth||C.image.textFitHeight)?Td(C):{x1:C.left,y1:C.top,x2:C.right,y2:C.bottom};J.y1=J.y1*j-R[0],J.y2=J.y2*j+R[2],J.x1=J.x1*j-R[3],J.x2=J.x2*j+R[1];const re=C.collisionPadding;if(re&&(J.x1-=re[0]*j,J.y1-=re[1]*j,J.x2+=re[2]*j,J.y2+=re[3]*j),q){const ce=new N(J.x1,J.y1),he=new N(J.x2,J.y1),Ee=new N(J.x1,J.y2),Ae=new N(J.x2,J.y2),Xe=q*Math.PI/180;ce._rotate(Xe),he._rotate(Xe),Ee._rotate(Xe),Ae._rotate(Xe),J.x1=Math.min(ce.x,he.x,Ee.x,Ae.x),J.x2=Math.max(ce.x,he.x,Ee.x,Ae.x),J.y1=Math.min(ce.y,he.y,Ee.y,Ae.y),J.y2=Math.max(ce.y,he.y,Ee.y,Ae.y)}n.emplaceBack(c.x,c.y,J.x1,J.y1,J.x2,J.y2,m,x,k)}this.boxEndIndex=n.length}}class Vg{constructor(n=[],c=((m,x)=>m<x?-1:m>x?1:0)){if(this.data=n,this.length=this.data.length,this.compare=c,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:c,compare:m}=this,x=c[n];for(;n>0;){const k=n-1>>1,C=c[k];if(m(x,C)>=0)break;c[n]=C,n=k}c[n]=x}_down(n){const{data:c,compare:m}=this,x=this.length>>1,k=c[n];for(;n<x;){let C=1+(n<<1);const j=C+1;if(j<this.length&&m(c[j],c[C])<0&&(C=j),m(c[C],k)>=0)break;c[n]=c[C],n=C}c[n]=k}}function qg(a,n=1,c=!1){let m=1/0,x=1/0,k=-1/0,C=-1/0;const j=a[0];for(let re=0;re<j.length;re++){const ce=j[re];(!re||ce.x<m)&&(m=ce.x),(!re||ce.y<x)&&(x=ce.y),(!re||ce.x>k)&&(k=ce.x),(!re||ce.y>C)&&(C=ce.y)}const R=Math.min(k-m,C-x);let F=R/2;const q=new Vg([],C_);if(R===0)return new N(m,x);for(let re=m;re<k;re+=R)for(let ce=x;ce<C;ce+=R)q.push(new cu(re+F,ce+F,F,a));let G=(function(re){let ce=0,he=0,Ee=0;const Ae=re[0];for(let Xe=0,De=Ae.length,Ge=De-1;Xe<De;Ge=Xe++){const pt=Ae[Xe],Dt=Ae[Ge],Qt=pt.x*Dt.y-Dt.x*pt.y;he+=(pt.x+Dt.x)*Qt,Ee+=(pt.y+Dt.y)*Qt,ce+=3*Qt}return new cu(he/ce,Ee/ce,0,re)})(a),J=q.length;for(;q.length;){const re=q.pop();(re.d>G.d||!G.d)&&(G=re,c&&console.log("found best %d after %d probes",Math.round(1e4*re.d)/1e4,J)),re.max-G.d<=n||(F=re.h/2,q.push(new cu(re.p.x-F,re.p.y-F,F,a)),q.push(new cu(re.p.x+F,re.p.y-F,F,a)),q.push(new cu(re.p.x-F,re.p.y+F,F,a)),q.push(new cu(re.p.x+F,re.p.y+F,F,a)),J+=4)}return c&&(console.log(`num probes: ${J}`),console.log(`best distance: ${G.d}`)),G.p}function C_(a,n){return n.max-a.max}function cu(a,n,c,m){this.p=new N(a,n),this.h=c,this.d=(function(x,k){let C=!1,j=1/0;for(let R=0;R<k.length;R++){const F=k[R];for(let q=0,G=F.length,J=G-1;q<G;J=q++){const re=F[q],ce=F[J];re.y>x.y!=ce.y>x.y&&x.x<(ce.x-re.x)*(x.y-re.y)/(ce.y-re.y)+re.x&&(C=!C),j=Math.min(j,Sp(x,re,ce))}}return(C?1:-1)*Math.sqrt(j)})(this.p,m),this.max=this.d+this.h*Math.SQRT2}var lr;y.aq=void 0,(lr=y.aq||(y.aq={}))[lr.center=1]="center",lr[lr.left=2]="left",lr[lr.right=3]="right",lr[lr.top=4]="top",lr[lr.bottom=5]="bottom",lr[lr["top-left"]=6]="top-left",lr[lr["top-right"]=7]="top-right",lr[lr["bottom-left"]=8]="bottom-left",lr[lr["bottom-right"]=9]="bottom-right";const uu=7,hm=Number.POSITIVE_INFINITY;function zh(a,n){return n[1]!==hm?(function(c,m,x){let k=0,C=0;switch(m=Math.abs(m),x=Math.abs(x),c){case"top-right":case"top-left":case"top":C=x-uu;break;case"bottom-right":case"bottom-left":case"bottom":C=-x+uu}switch(c){case"top-right":case"bottom-right":case"right":k=-m;break;case"top-left":case"bottom-left":case"left":k=m}return[k,C]})(a,n[0],n[1]):(function(c,m){let x=0,k=0;m<0&&(m=0);const C=m/Math.SQRT2;switch(c){case"top-right":case"top-left":k=C-uu;break;case"bottom-right":case"bottom-left":k=-C+uu;break;case"bottom":k=-m+uu;break;case"top":k=m-uu}switch(c){case"top-right":case"bottom-right":x=-C;break;case"top-left":case"bottom-left":x=C;break;case"left":x=m;break;case"right":x=-m}return[x,k]})(a,n[0])}function Hg(a,n,c){var m;const x=a.layout,k=(m=x.get("text-variable-anchor-offset"))===null||m===void 0?void 0:m.evaluate(n,{},c);if(k){const j=k.values,R=[];for(let F=0;F<j.length;F+=2){const q=R[F]=j[F],G=j[F+1].map((J=>J*Hs));q.startsWith("top")?G[1]-=uu:q.startsWith("bottom")&&(G[1]+=uu),R[F+1]=G}return new ir(R)}const C=x.get("text-variable-anchor");if(C){let j;j=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[x.get("text-radial-offset").evaluate(n,{},c)*Hs,hm]:x.get("text-offset").evaluate(n,{},c).map((F=>F*Hs));const R=[];for(const F of C)R.push(F,zh(F,j));return new ir(R)}return null}function jf(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mn(a,n,c,m,x,k,C,j,R,F,q){let G=k.textMaxSize.evaluate(n,{});G===void 0&&(G=C);const J=a.layers[0].layout,re=J.get("icon-offset").evaluate(n,{},q),ce=jd(c.horizontal),he=C/24,Ee=a.tilePixelRatio*he,Ae=a.tilePixelRatio*G/24,Xe=a.tilePixelRatio*j,De=a.tilePixelRatio*J.get("symbol-spacing"),Ge=J.get("text-padding")*a.tilePixelRatio,pt=(function(vt,li,di,Li=1){const kn=vt.get("icon-padding").evaluate(li,{},di),Yn=kn&&kn.values;return[Yn[0]*Li,Yn[1]*Li,Yn[2]*Li,Yn[3]*Li]})(J,n,q,a.tilePixelRatio),Dt=J.get("text-max-angle")/180*Math.PI,Qt=J.get("text-rotation-alignment")!=="viewport"&&J.get("symbol-placement")!=="point",Ai=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",Vt=J.get("symbol-placement"),Gt=De/2,fi=J.get("icon-text-fit");let ci;m&&fi!=="none"&&(a.allowVerticalPlacement&&c.vertical&&(ci=bc(m,c.vertical,fi,J.get("icon-text-fit-padding"),re,he)),ce&&(m=bc(m,ce,fi,J.get("icon-text-fit-padding"),re,he)));const ri=(vt,li)=>{li.x<0||li.x>=Ds||li.y<0||li.y>=Ds||(function(di,Li,kn,Yn,cr,Kr,Er,ur,pa,ma,ga,js,hr,Jr,kr,er,Zs,Ja,Ma,yn,Un,cs,Qr,gs,hu){const bo=di.addToLineVertexArray(Li,kn);let Tl,wo,So,dr,wc=0,Vu=0,Gg=0,Nd=0,Dh=-1,Oh=-1;const Sc={};let Nh=Zc("");if(di.allowVerticalPlacement&&Yn.vertical){const Dr=ur.layout.get("text-rotate").evaluate(Un,{},gs)+90;So=new Lh(pa,Li,ma,ga,js,Yn.vertical,hr,Jr,kr,Dr),Er&&(dr=new Lh(pa,Li,ma,ga,js,Er,Zs,Ja,kr,Dr))}if(cr){const Dr=ur.layout.get("icon-rotate").evaluate(Un,{}),Pa=ur.layout.get("icon-text-fit")!=="none",Qa=cm(cr,Dr,Qr,Pa),Or=Er?cm(Er,Dr,Qr,Pa):void 0;wo=new Lh(pa,Li,ma,ga,js,cr,Zs,Ja,!1,Dr),wc=4*Qa.length;const eo=di.iconSizeData;let to=null;eo.kind==="source"?(to=[Xr*ur.layout.get("icon-size").evaluate(Un,{})],to[0]>vo&&Mt(`${di.layerIds[0]}: Value for "icon-size" is >= ${Ns}. Reduce your "icon-size".`)):eo.kind==="composite"&&(to=[Xr*cs.compositeIconSizes[0].evaluate(Un,{},gs),Xr*cs.compositeIconSizes[1].evaluate(Un,{},gs)],(to[0]>vo||to[1]>vo)&&Mt(`${di.layerIds[0]}: Value for "icon-size" is >= ${Ns}. Reduce your "icon-size".`)),di.addSymbols(di.icon,Qa,to,yn,Ma,Un,y.ah.none,Li,bo.lineStartIndex,bo.lineLength,-1,gs),Dh=di.icon.placedSymbolArray.length-1,Or&&(Vu=4*Or.length,di.addSymbols(di.icon,Or,to,yn,Ma,Un,y.ah.vertical,Li,bo.lineStartIndex,bo.lineLength,-1,gs),Oh=di.icon.placedSymbolArray.length-1)}const Wg=Object.keys(Yn.horizontal);for(const Dr of Wg){const Pa=Yn.horizontal[Dr];if(!Tl){Nh=Zc(Pa.text);const Or=ur.layout.get("text-rotate").evaluate(Un,{},gs);Tl=new Lh(pa,Li,ma,ga,js,Pa,hr,Jr,kr,Or)}const Qa=Pa.positionedLines.length===1;if(Gg+=Lf(di,Li,Pa,Kr,ur,kr,Un,er,bo,Yn.vertical?y.ah.horizontal:y.ah.horizontalOnly,Qa?Wg:[Dr],Sc,Dh,cs,gs),Qa)break}Yn.vertical&&(Nd+=Lf(di,Li,Yn.vertical,Kr,ur,kr,Un,er,bo,y.ah.vertical,["vertical"],Sc,Oh,cs,gs));const Yg=Tl?Tl.boxStartIndex:di.collisionBoxArray.length,Xg=Tl?Tl.boxEndIndex:di.collisionBoxArray.length,Kg=So?So.boxStartIndex:di.collisionBoxArray.length,Jg=So?So.boxEndIndex:di.collisionBoxArray.length,mm=wo?wo.boxStartIndex:di.collisionBoxArray.length,Qg=wo?wo.boxEndIndex:di.collisionBoxArray.length,ey=dr?dr.boxStartIndex:di.collisionBoxArray.length,Rf=dr?dr.boxEndIndex:di.collisionBoxArray.length;let El=-1;const Df=(Dr,Pa)=>Dr&&Dr.circleDiameter?Math.max(Dr.circleDiameter,Pa):Pa;El=Df(Tl,El),El=Df(So,El),El=Df(wo,El),El=Df(dr,El);const Of=El>-1?1:0;Of&&(El*=hu/Hs),di.glyphOffsetArray.length>=Nu.MAX_GLYPHS&&Mt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Un.sortKey!==void 0&&di.addToSortKeyRanges(di.symbolInstances.length,Un.sortKey);const gm=Hg(ur,Un,gs),[Nf,ym]=(function(Dr,Pa){const Qa=Dr.length,Or=Pa?.values;if(Or?.length>0)for(let eo=0;eo<Or.length;eo+=2){const to=Or[eo+1];Dr.emplaceBack(y.aq[Or[eo]],to[0],to[1])}return[Qa,Dr.length]})(di.textAnchorOffsets,gm);di.symbolInstances.emplaceBack(Li.x,Li.y,Sc.right>=0?Sc.right:-1,Sc.center>=0?Sc.center:-1,Sc.left>=0?Sc.left:-1,Sc.vertical||-1,Dh,Oh,Nh,Yg,Xg,Kg,Jg,mm,Qg,ey,Rf,ma,Gg,Nd,wc,Vu,Of,0,hr,El,Nf,ym)})(a,li,vt,c,m,x,ci,a.layers[0],a.collisionBoxArray,n.index,n.sourceLayerIndex,a.index,Ee,[Ge,Ge,Ge,Ge],Qt,R,Xe,pt,Ai,re,n,k,F,q,C)};if(Vt==="line")for(const vt of Fg(n.geometry,0,0,Ds,Ds)){const li=Kl(vt,De,Dt,c.vertical||ce,m,24,Ae,a.overscaling,Ds);for(const di of li)ce&&dm(a,ce.text,Gt,di)||ri(vt,di)}else if(Vt==="line-center"){for(const vt of n.geometry)if(vt.length>1){const li=lu(vt,Dt,c.vertical||ce,m,24,Ae);li&&ri(vt,li)}}else if(n.type==="Polygon")for(const vt of tc(n.geometry,0)){const li=qg(vt,16);ri(vt[0],new Sl(li.x,li.y,0))}else if(n.type==="LineString")for(const vt of n.geometry)ri(vt,new Sl(vt[0].x,vt[0].y,0));else if(n.type==="Point")for(const vt of n.geometry)for(const li of vt)ri([li],new Sl(li.x,li.y,0))}function Lf(a,n,c,m,x,k,C,j,R,F,q,G,J,re,ce){const he=(function(Xe,De,Ge,pt,Dt,Qt,Ai,Vt){const Gt=pt.layout.get("text-rotate").evaluate(Qt,{})*Math.PI/180,fi=[];for(const ci of De.positionedLines)for(const ri of ci.positionedGlyphs){if(!ri.rect)continue;const vt=ri.rect||{};let li=qn+1,di=!0,Li=1,kn=0;const Yn=(Dt||Vt)&&ri.vertical,cr=ri.metrics.advance*ri.scale/2;if(Vt&&De.verticalizable&&(kn=ci.lineOffset/2-(ri.imageName?-(Hs-ri.metrics.width*ri.scale)/2:(ri.scale-1)*Hs)),ri.imageName){const yn=Ai[ri.imageName];di=yn.sdf,Li=yn.pixelRatio,li=$i/Li}const Kr=Dt?[ri.x+cr,ri.y]:[0,0];let Er=Dt?[0,0]:[ri.x+cr+Ge[0],ri.y+Ge[1]-kn],ur=[0,0];Yn&&(ur=Er,Er=[0,0]);const pa=ri.metrics.isDoubleResolution?2:1,ma=(ri.metrics.left-li)*ri.scale-cr+Er[0],ga=(-ri.metrics.top-li)*ri.scale+Er[1],js=ma+vt.w/pa*ri.scale/Li,hr=ga+vt.h/pa*ri.scale/Li,Jr=new N(ma,ga),kr=new N(js,ga),er=new N(ma,hr),Zs=new N(js,hr);if(Yn){const yn=new N(-cr,cr-Uo),Un=-Math.PI/2,cs=Hs/2-cr,Qr=new N(5-Uo-cs,-(ri.imageName?cs:0)),gs=new N(...ur);Jr._rotateAround(Un,yn)._add(Qr)._add(gs),kr._rotateAround(Un,yn)._add(Qr)._add(gs),er._rotateAround(Un,yn)._add(Qr)._add(gs),Zs._rotateAround(Un,yn)._add(Qr)._add(gs)}if(Gt){const yn=Math.sin(Gt),Un=Math.cos(Gt),cs=[Un,-yn,yn,Un];Jr._matMult(cs),kr._matMult(cs),er._matMult(cs),Zs._matMult(cs)}const Ja=new N(0,0),Ma=new N(0,0);fi.push({tl:Jr,tr:kr,bl:er,br:Zs,tex:vt,writingMode:De.writingMode,glyphOffset:Kr,sectionIndex:ri.sectionIndex,isSDF:di,pixelOffsetTL:Ja,pixelOffsetBR:Ma,minFontScaleX:0,minFontScaleY:0})}return fi})(0,c,j,x,k,C,m,a.allowVerticalPlacement),Ee=a.textSizeData;let Ae=null;Ee.kind==="source"?(Ae=[Xr*x.layout.get("text-size").evaluate(C,{})],Ae[0]>vo&&Mt(`${a.layerIds[0]}: Value for "text-size" is >= ${Ns}. Reduce your "text-size".`)):Ee.kind==="composite"&&(Ae=[Xr*re.compositeTextSizes[0].evaluate(C,{},ce),Xr*re.compositeTextSizes[1].evaluate(C,{},ce)],(Ae[0]>vo||Ae[1]>vo)&&Mt(`${a.layerIds[0]}: Value for "text-size" is >= ${Ns}. Reduce your "text-size".`)),a.addSymbols(a.text,he,Ae,j,k,C,F,n,R.lineStartIndex,R.lineLength,J,ce);for(const Xe of q)G[Xe]=a.text.placedSymbolArray.length-1;return 4*he.length}function jd(a){for(const n in a)return a[n];return null}function dm(a,n,c,m){const x=a.compareText;if(n in x){const k=x[n];for(let C=k.length-1;C>=0;C--)if(m.dist(k[C])<c)return!0}else x[n]=[];return x[n].push(m),!1}const fm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ld{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,m]=new Uint8Array(n,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const x=m>>4;if(x!==1)throw new Error(`Got v${x} data when expected v1.`);const k=fm[15&m];if(!k)throw new Error("Unrecognized array type.");const[C]=new Uint16Array(n,2,1),[j]=new Uint32Array(n,4,1);return new Ld(j,C,k,n)}constructor(n,c=64,m=Float64Array,x){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=m,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const k=fm.indexOf(this.ArrayType),C=2*n*this.ArrayType.BYTES_PER_ELEMENT,j=n*this.IndexArrayType.BYTES_PER_ELEMENT,R=(8-j%8)%8;if(k<0)throw new Error(`Unexpected typed array class: ${m}.`);x&&x instanceof ArrayBuffer?(this.data=x,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+j+R,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+C+j+R),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+j+R,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+k]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=n)}add(n,c){const m=this._pos>>1;return this.ids[m]=m,this.coords[this._pos++]=n,this.coords[this._pos++]=c,m}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Fu(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,c,m,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:k,coords:C,nodeSize:j}=this,R=[0,k.length-1,0],F=[];for(;R.length;){const q=R.pop()||0,G=R.pop()||0,J=R.pop()||0;if(G-J<=j){for(let Ee=J;Ee<=G;Ee++){const Ae=C[2*Ee],Xe=C[2*Ee+1];Ae>=n&&Ae<=m&&Xe>=c&&Xe<=x&&F.push(k[Ee])}continue}const re=J+G>>1,ce=C[2*re],he=C[2*re+1];ce>=n&&ce<=m&&he>=c&&he<=x&&F.push(k[re]),(q===0?n<=ce:c<=he)&&(R.push(J),R.push(re-1),R.push(1-q)),(q===0?m>=ce:x>=he)&&(R.push(re+1),R.push(G),R.push(1-q))}return F}within(n,c,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:k,nodeSize:C}=this,j=[0,x.length-1,0],R=[],F=m*m;for(;j.length;){const q=j.pop()||0,G=j.pop()||0,J=j.pop()||0;if(G-J<=C){for(let Ee=J;Ee<=G;Ee++)Zg(k[2*Ee],k[2*Ee+1],n,c)<=F&&R.push(x[Ee]);continue}const re=J+G>>1,ce=k[2*re],he=k[2*re+1];Zg(ce,he,n,c)<=F&&R.push(x[re]),(q===0?n-m<=ce:c-m<=he)&&(j.push(J),j.push(re-1),j.push(1-q)),(q===0?n+m>=ce:c+m>=he)&&(j.push(re+1),j.push(G),j.push(1-q))}return R}}function Fu(a,n,c,m,x,k){if(x-m<=c)return;const C=m+x>>1;zd(a,n,C,m,x,k),Fu(a,n,c,m,C-1,1-k),Fu(a,n,c,C+1,x,1-k)}function zd(a,n,c,m,x,k){for(;x>m;){if(x-m>600){const F=x-m+1,q=c-m+1,G=Math.log(F),J=.5*Math.exp(2*G/3),re=.5*Math.sqrt(G*J*(F-J)/F)*(q-F/2<0?-1:1);zd(a,n,c,Math.max(m,Math.floor(c-q*J/F+re)),Math.min(x,Math.floor(c+(F-q)*J/F+re)),k)}const C=n[2*c+k];let j=m,R=x;for(Rd(a,n,m,c),n[2*x+k]>C&&Rd(a,n,m,x);j<R;){for(Rd(a,n,j,R),j++,R--;n[2*j+k]<C;)j++;for(;n[2*R+k]>C;)R--}n[2*m+k]===C?Rd(a,n,m,R):(R++,Rd(a,n,R,x)),R<=c&&(m=R+1),c<=R&&(x=R-1)}}function Rd(a,n,c,m){zf(a,c,m),zf(n,2*c,2*m),zf(n,2*c+1,2*m+1)}function zf(a,n,c){const m=a[n];a[n]=a[c],a[c]=m}function Zg(a,n,c,m){const x=a-c,k=n-m;return x*x+k*k}var pm;y.bg=void 0,(pm=y.bg||(y.bg={})).create="create",pm.load="load",pm.fullLoad="fullLoad";let Dd=null,Rh=[];const ts=1e3/60,Od="loadTime",Tr="fullLoadTime",A_={mark(a){performance.mark(a)},frame(a){const n=a;Dd!=null&&Rh.push(n-Dd),Dd=n},clearMetrics(){Dd=null,Rh=[],performance.clearMeasures(Od),performance.clearMeasures(Tr);for(const a in y.bg)performance.clearMarks(y.bg[a])},getPerformanceMetrics(){performance.measure(Od,y.bg.create,y.bg.load),performance.measure(Tr,y.bg.create,y.bg.fullLoad);const a=performance.getEntriesByName(Od)[0].duration,n=performance.getEntriesByName(Tr)[0].duration,c=Rh.length,m=1/(Rh.reduce(((k,C)=>k+C),0)/c/1e3),x=Rh.filter((k=>k>ts)).reduce(((k,C)=>k+(C-ts)/ts),0);return{loadTime:a,fullLoadTime:n,fps:m,percentDroppedFrames:x/(c+x)*100,totalFrames:c}}};y.$=class extends Y{},y.A=eu,y.B=ln,y.C=function(a){if(Be==null){const n=a.navigator?a.navigator.userAgent:null;Be=!!a.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Be},y.D=ui,y.E=Zn,y.F=class{constructor(a,n){this.target=a,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new E_((()=>this.process())),this.subscription=(function(c,m,x,k){return c.addEventListener(m,x,!1),{unsubscribe:()=>{c.removeEventListener(m,x,!1)}}})(this.target,"message",(c=>this.receive(c))),this.globalScope=St(self)?a:window}registerMessageHandler(a,n){this.messageHandlers[a]=n}sendAsync(a,n){return new Promise(((c,m)=>{const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[x]={resolve:c,reject:m},n&&n.signal.addEventListener("abort",(()=>{delete this.resolveRejects[x];const j={id:x,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(j)}),{once:!0});const k=[],C=Object.assign(Object.assign({},a),{id:x,sourceMapId:this.mapId,origin:location.origin,data:Gr(a.data,k)});this.target.postMessage(C,{transfer:k})}))}receive(a){const n=a.data,c=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[c];const m=this.abortControllers[c];return delete this.abortControllers[c],void(m&&m.abort())}if(St(self)||n.mustQueue)return this.tasks[c]=n,this.taskQueue.push(c),void this.invoker.trigger();this.processTask(c,n)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),n=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(a,n)}processTask(a,n){return d(this,void 0,void 0,(function*(){if(n.type==="<response>"){const x=this.resolveRejects[a];return delete this.resolveRejects[a],x?void(n.error?x.reject(Do(n.error)):x.resolve(Do(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const c=Do(n.data),m=new AbortController;this.abortControllers[a]=m;try{const x=yield this.messageHandlers[n.type](n.sourceMapId,c,m);this.completeTask(a,null,x)}catch(x){this.completeTask(a,x)}}))}completeTask(a,n,c){const m=[];delete this.abortControllers[a];const x={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?Gr(n):null,data:Gr(c,m)};this.target.postMessage(x,{transfer:m})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.G=Ct,y.H=function(){var a=new eu(16);return eu!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},y.I=En,y.J=function(a,n,c){var m,x,k,C,j,R,F,q,G,J,re,ce,he=c[0],Ee=c[1],Ae=c[2];return n===a?(a[12]=n[0]*he+n[4]*Ee+n[8]*Ae+n[12],a[13]=n[1]*he+n[5]*Ee+n[9]*Ae+n[13],a[14]=n[2]*he+n[6]*Ee+n[10]*Ae+n[14],a[15]=n[3]*he+n[7]*Ee+n[11]*Ae+n[15]):(x=n[1],k=n[2],C=n[3],j=n[4],R=n[5],F=n[6],q=n[7],G=n[8],J=n[9],re=n[10],ce=n[11],a[0]=m=n[0],a[1]=x,a[2]=k,a[3]=C,a[4]=j,a[5]=R,a[6]=F,a[7]=q,a[8]=G,a[9]=J,a[10]=re,a[11]=ce,a[12]=m*he+j*Ee+G*Ae+n[12],a[13]=x*he+R*Ee+J*Ae+n[13],a[14]=k*he+F*Ee+re*Ae+n[14],a[15]=C*he+q*Ee+ce*Ae+n[15]),a},y.K=function(a,n,c){var m=c[0],x=c[1],k=c[2];return a[0]=n[0]*m,a[1]=n[1]*m,a[2]=n[2]*m,a[3]=n[3]*m,a[4]=n[4]*x,a[5]=n[5]*x,a[6]=n[6]*x,a[7]=n[7]*x,a[8]=n[8]*k,a[9]=n[9]*k,a[10]=n[10]*k,a[11]=n[11]*k,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},y.L=kp,y.M=function(a,n){const c={};for(let m=0;m<n.length;m++){const x=n[m];x in a&&(c[x]=a[x])}return c},y.N=ou,y.O=$u,y.P=N,y.Q=Ad,y.R=Wa,y.S=fa,y.T=lh,y.U=se,y.V=ge,y.W=kt,y.X=Ds,y.Y=z,y.Z=Mh,y._=d,y.a=at,y.a$=function(a,n){var c=a[0],m=a[1],x=a[2],k=a[3],C=a[4],j=a[5],R=a[6],F=a[7],q=a[8],G=a[9],J=a[10],re=a[11],ce=a[12],he=a[13],Ee=a[14],Ae=a[15],Xe=n[0],De=n[1],Ge=n[2],pt=n[3],Dt=n[4],Qt=n[5],Ai=n[6],Vt=n[7],Gt=n[8],fi=n[9],ci=n[10],ri=n[11],vt=n[12],li=n[13],di=n[14],Li=n[15];return Math.abs(c-Xe)<=Yr*Math.max(1,Math.abs(c),Math.abs(Xe))&&Math.abs(m-De)<=Yr*Math.max(1,Math.abs(m),Math.abs(De))&&Math.abs(x-Ge)<=Yr*Math.max(1,Math.abs(x),Math.abs(Ge))&&Math.abs(k-pt)<=Yr*Math.max(1,Math.abs(k),Math.abs(pt))&&Math.abs(C-Dt)<=Yr*Math.max(1,Math.abs(C),Math.abs(Dt))&&Math.abs(j-Qt)<=Yr*Math.max(1,Math.abs(j),Math.abs(Qt))&&Math.abs(R-Ai)<=Yr*Math.max(1,Math.abs(R),Math.abs(Ai))&&Math.abs(F-Vt)<=Yr*Math.max(1,Math.abs(F),Math.abs(Vt))&&Math.abs(q-Gt)<=Yr*Math.max(1,Math.abs(q),Math.abs(Gt))&&Math.abs(G-fi)<=Yr*Math.max(1,Math.abs(G),Math.abs(fi))&&Math.abs(J-ci)<=Yr*Math.max(1,Math.abs(J),Math.abs(ci))&&Math.abs(re-ri)<=Yr*Math.max(1,Math.abs(re),Math.abs(ri))&&Math.abs(ce-vt)<=Yr*Math.max(1,Math.abs(ce),Math.abs(vt))&&Math.abs(he-li)<=Yr*Math.max(1,Math.abs(he),Math.abs(li))&&Math.abs(Ee-di)<=Yr*Math.max(1,Math.abs(Ee),Math.abs(di))&&Math.abs(Ae-Li)<=Yr*Math.max(1,Math.abs(Ae),Math.abs(Li))},y.a0=sn,y.a1=Cf,y.a2=Tt,y.a3=a=>{const n=window.document.createElement("video");return n.muted=!0,new Promise((c=>{n.onloadstart=()=>{c(n)};for(const m of a){const x=window.document.createElement("source");Vi(m)||(n.crossOrigin="Anonymous"),x.src=m,n.appendChild(x)}}))},y.a4=function(){return He++},y.a5=Xt,y.a6=Nu,y.a7=hl,y.a8=Jc,y.a9=Af,y.aA=function(a){if(a.type==="custom")return new em(a);switch(a.type){case"background":return new Ng(a);case"circle":return new __(a);case"fill":return new vg(a);case"fill-extrusion":return new md(a);case"heatmap":return new ff(a);case"hillshade":return new ud(a);case"line":return new Ag(a);case"raster":return new Ef(a);case"symbol":return new Ah(a)}},y.aB=lt,y.aC=function(a,n){if(!a)return[{command:"setStyle",args:[n]}];let c=[];try{if(!ki(a.version,n.version))return[{command:"setStyle",args:[n]}];ki(a.center,n.center)||c.push({command:"setCenter",args:[n.center]}),ki(a.zoom,n.zoom)||c.push({command:"setZoom",args:[n.zoom]}),ki(a.bearing,n.bearing)||c.push({command:"setBearing",args:[n.bearing]}),ki(a.pitch,n.pitch)||c.push({command:"setPitch",args:[n.pitch]}),ki(a.sprite,n.sprite)||c.push({command:"setSprite",args:[n.sprite]}),ki(a.glyphs,n.glyphs)||c.push({command:"setGlyphs",args:[n.glyphs]}),ki(a.transition,n.transition)||c.push({command:"setTransition",args:[n.transition]}),ki(a.light,n.light)||c.push({command:"setLight",args:[n.light]}),ki(a.terrain,n.terrain)||c.push({command:"setTerrain",args:[n.terrain]}),ki(a.sky,n.sky)||c.push({command:"setSky",args:[n.sky]}),ki(a.projection,n.projection)||c.push({command:"setProjection",args:[n.projection]});const m={},x=[];(function(C,j,R,F){let q;for(q in j=j||{},C=C||{})Object.prototype.hasOwnProperty.call(C,q)&&(Object.prototype.hasOwnProperty.call(j,q)||Ln(q,R,F));for(q in j)Object.prototype.hasOwnProperty.call(j,q)&&(Object.prototype.hasOwnProperty.call(C,q)?ki(C[q],j[q])||(C[q].type==="geojson"&&j[q].type==="geojson"&&an(C,j,q)?yi(R,{command:"setGeoJSONSourceData",args:[q,j[q].data]}):us(q,j,R,F)):Cn(q,j,R))})(a.sources,n.sources,x,m);const k=[];a.layers&&a.layers.forEach((C=>{"source"in C&&m[C.source]?c.push({command:"removeLayer",args:[C.id]}):k.push(C)})),c=c.concat(x),(function(C,j,R){j=j||[];const F=(C=C||[]).map(qi),q=j.map(qi),G=C.reduce(Fn,{}),J=j.reduce(Fn,{}),re=F.slice(),ce=Object.create(null);let he,Ee,Ae,Xe,De;for(let Ge=0,pt=0;Ge<F.length;Ge++)he=F[Ge],Object.prototype.hasOwnProperty.call(J,he)?pt++:(yi(R,{command:"removeLayer",args:[he]}),re.splice(re.indexOf(he,pt),1));for(let Ge=0,pt=0;Ge<q.length;Ge++)he=q[q.length-1-Ge],re[re.length-1-Ge]!==he&&(Object.prototype.hasOwnProperty.call(G,he)?(yi(R,{command:"removeLayer",args:[he]}),re.splice(re.lastIndexOf(he,re.length-pt),1)):pt++,Xe=re[re.length-Ge],yi(R,{command:"addLayer",args:[J[he],Xe]}),re.splice(re.length-Ge,0,he),ce[he]=!0);for(let Ge=0;Ge<q.length;Ge++)if(he=q[Ge],Ee=G[he],Ae=J[he],!ce[he]&&!ki(Ee,Ae))if(ki(Ee.source,Ae.source)&&ki(Ee["source-layer"],Ae["source-layer"])&&ki(Ee.type,Ae.type)){for(De in en(Ee.layout,Ae.layout,R,he,null,"setLayoutProperty"),en(Ee.paint,Ae.paint,R,he,null,"setPaintProperty"),ki(Ee.filter,Ae.filter)||yi(R,{command:"setFilter",args:[he,Ae.filter]}),ki(Ee.minzoom,Ae.minzoom)&&ki(Ee.maxzoom,Ae.maxzoom)||yi(R,{command:"setLayerZoomRange",args:[he,Ae.minzoom,Ae.maxzoom]}),Ee)Object.prototype.hasOwnProperty.call(Ee,De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?en(Ee[De],Ae[De],R,he,De.slice(6),"setPaintProperty"):ki(Ee[De],Ae[De])||yi(R,{command:"setLayerProperty",args:[he,De,Ae[De]]}));for(De in Ae)Object.prototype.hasOwnProperty.call(Ae,De)&&!Object.prototype.hasOwnProperty.call(Ee,De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?en(Ee[De],Ae[De],R,he,De.slice(6),"setPaintProperty"):ki(Ee[De],Ae[De])||yi(R,{command:"setLayerProperty",args:[he,De,Ae[De]]}))}else yi(R,{command:"removeLayer",args:[he]}),Xe=re[re.lastIndexOf(he)+1],yi(R,{command:"addLayer",args:[Ae,Xe]})})(k,n.layers,c)}catch(m){console.warn("Unable to compute style diff:",m),c=[{command:"setStyle",args:[n]}]}return c},y.aD=function(a){const n=[],c=a.id;return c===void 0&&n.push({message:`layers.${c}: missing required property "id"`}),a.render===void 0&&n.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&n.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),n},y.aE=function a(n,c){if(Array.isArray(n)){if(!Array.isArray(c)||n.length!==c.length)return!1;for(let m=0;m<n.length;m++)if(!a(n[m],c[m]))return!1;return!0}if(typeof n=="object"&&n!==null&&c!==null){if(typeof c!="object"||Object.keys(n).length!==Object.keys(c).length)return!1;for(const m in n)if(!a(n[m],c[m]))return!1;return!0}return n===c},y.aF=Ze,y.aG=st,y.aH=class extends Fl{constructor(a,n){super(a,n),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},y.aI=Wc,y.aJ=class extends Fl{constructor(a,n){super(a,n),this.current=fc}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let n=1;n<16;n++)if(a[n]!==this.current[n]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},y.aK=sd,y.aL=af,y.aM=wi,y.aN=class extends Fl{constructor(a,n){super(a,n),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},y.aO=class extends Fl{constructor(a,n){super(a,n),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},y.aP=function(a,n,c,m,x,k,C){var j=1/(n-c),R=1/(m-x),F=1/(k-C);return a[0]=-2*j,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*R,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*F,a[11]=0,a[12]=(n+c)*j,a[13]=(x+m)*R,a[14]=(C+k)*F,a[15]=1,a},y.aQ=cg,y.aR=class extends $e{},y.aS=Ya,y.aT=class extends it{},y.aU=cd,y.aV=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},y.aW=dh,y.aX=as,y.aY=ha,y.aZ=class extends oi{},y.a_=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]&&a[4]===n[4]&&a[5]===n[5]&&a[6]===n[6]&&a[7]===n[7]&&a[8]===n[8]&&a[9]===n[9]&&a[10]===n[10]&&a[11]===n[11]&&a[12]===n[12]&&a[13]===n[13]&&a[14]===n[14]&&a[15]===n[15]},y.aa=function(a){const n={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((c,m,x,k)=>{const C=x||k;return n[m]=!C||C.toLowerCase(),""})),n["max-age"]){const c=parseInt(n["max-age"],10);isNaN(c)?delete n["max-age"]:n["max-age"]=c}return n},y.ab=function(a,n){const c=[];for(const m in a)m in n||c.push(m);return c},y.ac=ye,y.ad=function(a,n,c){var m=Math.sin(c),x=Math.cos(c),k=n[0],C=n[1],j=n[2],R=n[3],F=n[4],q=n[5],G=n[6],J=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=k*x+F*m,a[1]=C*x+q*m,a[2]=j*x+G*m,a[3]=R*x+J*m,a[4]=F*x-k*m,a[5]=q*x-C*m,a[6]=G*x-j*m,a[7]=J*x-R*m,a},y.ae=function(a){var n=new eu(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n},y.af=od,y.ag=function(a,n){let c=0,m=0;if(a.kind==="constant")m=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:x,minZoom:k,maxZoom:C}=a,j=x?ye(Rs.interpolationFactor(x,n,k,C),0,1):0;a.kind==="camera"?m=Us.number(a.minSize,a.maxSize,j):c=j}return{uSizeT:c,uSize:m}},y.ai=function(a,{uSize:n,uSizeT:c},{lowerSize:m,upperSize:x}){return a.kind==="source"?m/Xr:a.kind==="composite"?Us.number(m/Xr,x/Xr,c):n},y.aj=kd,y.ak=function(a,n,c,m){const x=n.y-a.y,k=n.x-a.x,C=m.y-c.y,j=m.x-c.x,R=C*k-j*x;if(R===0)return null;const F=(j*(a.y-c.y)-C*(a.x-c.x))/R;return new N(a.x+F*k,a.y+F*x)},y.al=Fg,y.am=xp,y.an=uf,y.ao=function(a){let n=1/0,c=1/0,m=-1/0,x=-1/0;for(const k of a)n=Math.min(n,k.x),c=Math.min(c,k.y),m=Math.max(m,k.x),x=Math.max(x,k.y);return[n,c,m,x]},y.ap=Hs,y.ar=Ed,y.as=function(a,n){var c=n[0],m=n[1],x=n[2],k=n[3],C=n[4],j=n[5],R=n[6],F=n[7],q=n[8],G=n[9],J=n[10],re=n[11],ce=n[12],he=n[13],Ee=n[14],Ae=n[15],Xe=c*j-m*C,De=c*R-x*C,Ge=c*F-k*C,pt=m*R-x*j,Dt=m*F-k*j,Qt=x*F-k*R,Ai=q*he-G*ce,Vt=q*Ee-J*ce,Gt=q*Ae-re*ce,fi=G*Ee-J*he,ci=G*Ae-re*he,ri=J*Ae-re*Ee,vt=Xe*ri-De*ci+Ge*fi+pt*Gt-Dt*Vt+Qt*Ai;return vt?(a[0]=(j*ri-R*ci+F*fi)*(vt=1/vt),a[1]=(x*ci-m*ri-k*fi)*vt,a[2]=(he*Qt-Ee*Dt+Ae*pt)*vt,a[3]=(J*Dt-G*Qt-re*pt)*vt,a[4]=(R*Gt-C*ri-F*Vt)*vt,a[5]=(c*ri-x*Gt+k*Vt)*vt,a[6]=(Ee*Ge-ce*Qt-Ae*De)*vt,a[7]=(q*Qt-J*Ge+re*De)*vt,a[8]=(C*ci-j*Gt+F*Ai)*vt,a[9]=(m*Gt-c*ci-k*Ai)*vt,a[10]=(ce*Dt-he*Ge+Ae*Xe)*vt,a[11]=(G*Ge-q*Dt-re*Xe)*vt,a[12]=(j*Vt-C*fi-R*Ai)*vt,a[13]=(c*fi-m*Vt+x*Ai)*vt,a[14]=(he*De-ce*pt-Ee*Xe)*vt,a[15]=(q*pt-G*De+J*Xe)*vt,a):null},y.at=jf,y.au=Ch,y.av=Ld,y.aw=function(){const a={},n=tt.$version;for(const c in tt.$root){const m=tt.$root[c];if(m.required){let x=null;x=c==="version"?n:m.type==="array"?[]:{},x!=null&&(a[c]=x)}}return a},y.ax=ms,y.ay=Kt,y.az=function(a){a=a.slice();const n=Object.create(null);for(let c=0;c<a.length;c++)n[a[c].id]=a[c];for(let c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=Pn(a[c],n[a[c].ref]));return a},y.b=ot,y.b0=function(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},y.b1=function(a,n,c){return a[0]=n[0]*c[0],a[1]=n[1]*c[1],a[2]=n[2]*c[2],a[3]=n[3]*c[3],a},y.b2=function(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]},y.b3=Se,y.b4=am,y.b5=sm,y.b6=function(a,n,c,m,x){var k,C=1/Math.tan(n/2);return a[0]=C/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=C,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,x!=null&&x!==1/0?(a[10]=(x+m)*(k=1/(m-x)),a[14]=2*x*m*k):(a[10]=-1,a[14]=-2*m),a},y.b7=function(a,n,c){var m=Math.sin(c),x=Math.cos(c),k=n[4],C=n[5],j=n[6],R=n[7],F=n[8],q=n[9],G=n[10],J=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=k*x+F*m,a[5]=C*x+q*m,a[6]=j*x+G*m,a[7]=R*x+J*m,a[8]=F*x-k*m,a[9]=q*x-C*m,a[10]=G*x-j*m,a[11]=J*x-R*m,a},y.b8=ae,y.b9=me,y.bA=Gp,y.bB=function(a){return a.message===Ie},y.bC=cl,y.bD=Js,y.ba=function(a){return a*Math.PI/180},y.bb=function(a,n){const{x:c,y:m}=Mh.fromLngLat(n);return!(a<0||a>25||m<0||m>=1||c<0||c>=1)},y.bc=function(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},y.bd=class extends H{},y.be=tm,y.bf=A_,y.bh=Ot,y.bi=function(a,n){at.REGISTERED_PROTOCOLS[a]=n},y.bj=function(a){delete at.REGISTERED_PROTOCOLS[a]},y.bk=function(a,n){const c={};for(let x=0;x<a.length;x++){const k=n&&n[a[x].id]||qr(a[x]);n&&(n[a[x].id]=k);let C=c[k];C||(C=c[k]=[]),C.push(a[x])}const m=[];for(const x in c)m.push(c[x]);return m},y.bl=jt,y.bm=es,y.bn=$g,y.bo=Qn,y.bp=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Ds/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const n=a.bucket.layers[0],c=n.layout,m=n._unevaluatedLayout._values,x={layoutIconSize:m["icon-size"].possiblyEvaluate(new nn(a.bucket.zoom+1),a.canonical),layoutTextSize:m["text-size"].possiblyEvaluate(new nn(a.bucket.zoom+1),a.canonical),textMaxSize:m["text-size"].possiblyEvaluate(new nn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=a.bucket.textSizeData;x.compositeTextSizes=[m["text-size"].possiblyEvaluate(new nn(F),a.canonical),m["text-size"].possiblyEvaluate(new nn(q),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:q}=a.bucket.iconSizeData;x.compositeIconSizes=[m["icon-size"].possiblyEvaluate(new nn(F),a.canonical),m["icon-size"].possiblyEvaluate(new nn(q),a.canonical)]}const k=c.get("text-line-height")*Hs,C=c.get("text-rotation-alignment")!=="viewport"&&c.get("symbol-placement")!=="point",j=c.get("text-keep-upright"),R=c.get("text-size");for(const F of a.bucket.features){const q=c.get("text-font").evaluate(F,{},a.canonical).join(","),G=R.evaluate(F,{},a.canonical),J=x.layoutTextSize.evaluate(F,{},a.canonical),re=x.layoutIconSize.evaluate(F,{},a.canonical),ce={horizontal:{},vertical:void 0},he=F.text;let Ee,Ae=[0,0];if(he){const Ge=he.toString(),pt=c.get("text-letter-spacing").evaluate(F,{},a.canonical)*Hs,Dt=ku(Ge)?pt:0,Qt=c.get("text-anchor").evaluate(F,{},a.canonical),Ai=Hg(n,F,a.canonical);if(!Ai){const ci=c.get("text-radial-offset").evaluate(F,{},a.canonical);Ae=ci?zh(Qt,[ci*Hs,hm]):c.get("text-offset").evaluate(F,{},a.canonical).map((ri=>ri*Hs))}let Vt=C?"center":c.get("text-justify").evaluate(F,{},a.canonical);const Gt=c.get("symbol-placement")==="point"?c.get("text-max-width").evaluate(F,{},a.canonical)*Hs:1/0,fi=()=>{a.bucket.allowVerticalPlacement&&mo(Ge)&&(ce.vertical=Fo(he,a.glyphMap,a.glyphPositions,a.imagePositions,q,Gt,k,Qt,"left",Dt,Ae,y.ah.vertical,!0,J,G))};if(!C&&Ai){const ci=new Set;if(Vt==="auto")for(let vt=0;vt<Ai.values.length;vt+=2)ci.add(jf(Ai.values[vt]));else ci.add(Vt);let ri=!1;for(const vt of ci)if(!ce.horizontal[vt])if(ri)ce.horizontal[vt]=ce.horizontal[0];else{const li=Fo(he,a.glyphMap,a.glyphPositions,a.imagePositions,q,Gt,k,"center",vt,Dt,Ae,y.ah.horizontal,!1,J,G);li&&(ce.horizontal[vt]=li,ri=li.positionedLines.length===1)}fi()}else{Vt==="auto"&&(Vt=jf(Qt));const ci=Fo(he,a.glyphMap,a.glyphPositions,a.imagePositions,q,Gt,k,Qt,Vt,Dt,Ae,y.ah.horizontal,!1,J,G);ci&&(ce.horizontal[Vt]=ci),fi(),mo(Ge)&&C&&j&&(ce.vertical=Fo(he,a.glyphMap,a.glyphPositions,a.imagePositions,q,Gt,k,Qt,Vt,Dt,Ae,y.ah.vertical,!1,J,G))}}let Xe=!1;if(F.icon&&F.icon.name){const Ge=a.imageMap[F.icon.name];Ge&&(Ee=Sf(a.imagePositions[F.icon.name],c.get("icon-offset").evaluate(F,{},a.canonical),c.get("icon-anchor").evaluate(F,{},a.canonical)),Xe=!!Ge.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=Xe:a.bucket.sdfIcons!==Xe&&Mt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ge.pixelRatio!==a.bucket.pixelRatio||c.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const De=jd(ce.horizontal)||ce.vertical;a.bucket.iconsInText=!!De&&De.iconsInText,(De||Ee)&&Mn(a.bucket,F,ce,Ee,a.imageMap,x,J,re,Ae,Xe,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},y.bq=yd,y.br=_h,y.bs=Ru,y.bt=yc,y.bu=bf,y.bv=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},y.bw=function(a,n,c,m,x){return d(this,void 0,void 0,(function*(){if(ge())try{return yield kt(a,n,c,m,x)}catch{}return(function(k,C,j,R,F){const q=k.width,G=k.height;rt&&be||(rt=new OffscreenCanvas(q,G),be=rt.getContext("2d",{willReadFrequently:!0})),rt.width=q,rt.height=G,be.drawImage(k,0,0,q,G);const J=be.getImageData(C,j,R,F);return be.clearRect(0,0,q,G),J.data})(a,n,c,m,x)}))},y.bx=om,y.by=A,y.bz=I,y.c=et,y.d=a=>d(void 0,void 0,void 0,(function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(n)}catch(c){throw new Error(`Could not load image because of ${c.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),y.e=ze,y.f=a=>new Promise(((n,c)=>{const m=new Image;m.onload=()=>{n(m),URL.revokeObjectURL(m.src),m.onload=null,window.requestAnimationFrame((()=>{m.src=Fe}))},m.onerror=()=>c(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const x=new Blob([new Uint8Array(a)],{type:"image/png"});m.src=a.byteLength?URL.createObjectURL(x):Fe})),y.g=mt,y.h=(a,n)=>_i(ze(a,{type:"json"}),n),y.i=St,y.j=cn,y.k=xn,y.l=(a,n)=>_i(ze(a,{type:"arrayBuffer"}),n),y.m=_i,y.n=function(a){return new bf(a).readFields(Lg,[])},y.o=ld,y.p=ds,y.q=E,y.r=Si,y.s=Vi,y.t=wr,y.u=Yt,y.v=tt,y.w=Mt,y.x=function([a,n,c]){return n+=90,n*=Math.PI/180,c*=Math.PI/180,{x:a*Math.cos(n)*Math.sin(c),y:a*Math.sin(n)*Math.sin(c),z:a*Math.cos(c)}},y.y=Us,y.z=nn})),f("worker",["./shared"],(function(y){class d{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,Q){for(const we of ee){this._layerConfigs[we.id]=we;const je=this._layers[we.id]=y.aA(we);je._featureFilter=y.a7(je.filter),this.keyCache[we.id]&&delete this.keyCache[we.id]}for(const we of Q)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const ue=y.bk(Object.values(this._layerConfigs),this.keyCache);for(const we of ue){const je=we.map((Ye=>this._layers[Ye.id])),Oe=je[0];if(Oe.visibility==="none")continue;const qe=Oe.source||"";let de=this.familiesBySource[qe];de||(de=this.familiesBySource[qe]={});const Je=Oe.sourceLayer||"_geojsonTileLayer";let ct=de[Je];ct||(ct=de[Je]=[]),ct.push(je)}}}class A{constructor(ee){const Q={},ue=[];for(const qe in ee){const de=ee[qe],Je=Q[qe]={};for(const ct in de){const Ye=de[+ct];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const nt={x:0,y:0,w:Ye.bitmap.width+2,h:Ye.bitmap.height+2};ue.push(nt),Je[ct]={rect:nt,metrics:Ye.metrics}}}const{w:we,h:je}=y.p(ue),Oe=new y.o({width:we||1,height:je||1});for(const qe in ee){const de=ee[qe];for(const Je in de){const ct=de[+Je];if(!ct||ct.bitmap.width===0||ct.bitmap.height===0)continue;const Ye=Q[qe][Je].rect;y.o.copy(ct.bitmap,Oe,{x:0,y:0},{x:Ye.x+1,y:Ye.y+1},ct.bitmap)}}this.image=Oe,this.positions=Q}}y.bl("GlyphAtlas",A);class I{constructor(ee){this.tileID=new y.S(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,Q,ue,we){return y._(this,void 0,void 0,(function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new y.a5;const je=new y.bm(Object.keys(ee.layers).sort()),Oe=new y.bn(this.tileID,this.promoteId);Oe.bucketLayerIDs=[];const qe={},de={featureIndex:Oe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ue},Je=Q.familiesBySource[this.source];for(const xt in Je){const Wt=ee.layers[xt];if(!Wt)continue;Wt.version===1&&y.w(`Vector tile source "${this.source}" layer "${xt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pi=je.encode(xt),Ne=[];for(let zt=0;zt<Wt.length;zt++){const Jt=Wt.feature(zt),Ki=Oe.getId(Jt,xt);Ne.push({feature:Jt,id:Ki,index:zt,sourceLayerIndex:pi})}for(const zt of Je[xt]){const Jt=zt[0];Jt.source!==this.source&&y.w(`layer.source = ${Jt.source} does not equal this.source = ${this.source}`),Jt.minzoom&&this.zoom<Math.floor(Jt.minzoom)||Jt.maxzoom&&this.zoom>=Jt.maxzoom||Jt.visibility!=="none"&&(B(zt,this.zoom,ue),(qe[Jt.id]=Jt.createBucket({index:Oe.bucketLayerIDs.length,layers:zt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pi,sourceID:this.source})).populate(Ne,de,this.tileID.canonical),Oe.bucketLayerIDs.push(zt.map((Ki=>Ki.id))))}}const ct=y.aF(de.glyphDependencies,(xt=>Object.keys(xt).map(Number)));this.inFlightDependencies.forEach((xt=>xt?.abort())),this.inFlightDependencies=[];let Ye=Promise.resolve({});if(Object.keys(ct).length){const xt=new AbortController;this.inFlightDependencies.push(xt),Ye=we.sendAsync({type:"GG",data:{stacks:ct,source:this.source,tileID:this.tileID,type:"glyphs"}},xt)}const nt=Object.keys(de.iconDependencies);let ei=Promise.resolve({});if(nt.length){const xt=new AbortController;this.inFlightDependencies.push(xt),ei=we.sendAsync({type:"GI",data:{icons:nt,source:this.source,tileID:this.tileID,type:"icons"}},xt)}const si=Object.keys(de.patternDependencies);let $t=Promise.resolve({});if(si.length){const xt=new AbortController;this.inFlightDependencies.push(xt),$t=we.sendAsync({type:"GI",data:{icons:si,source:this.source,tileID:this.tileID,type:"patterns"}},xt)}const[At,ni,vi]=yield Promise.all([Ye,ei,$t]),Bi=new A(At),_t=new y.bo(ni,vi);for(const xt in qe){const Wt=qe[xt];Wt instanceof y.a6?(B(Wt.layers,this.zoom,ue),y.bp({bucket:Wt,glyphMap:At,glyphPositions:Bi.positions,imageMap:ni,imagePositions:_t.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Wt.hasPattern&&(Wt instanceof y.bq||Wt instanceof y.br||Wt instanceof y.bs)&&(B(Wt.layers,this.zoom,ue),Wt.addFeatures(de,this.tileID.canonical,_t.patternPositions))}return this.status="done",{buckets:Object.values(qe).filter((xt=>!xt.isEmpty())),featureIndex:Oe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Bi.image,imageAtlas:_t,glyphMap:this.returnDependencies?At:null,iconMap:this.returnDependencies?ni:null,glyphPositions:this.returnDependencies?Bi.positions:null}}))}}function B(xe,ee,Q){const ue=new y.z(ee);for(const we of xe)we.recalculate(ue,Q)}class N{constructor(ee,Q,ue){this.actor=ee,this.layerIndex=Q,this.availableImages=ue,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,Q){return y._(this,void 0,void 0,(function*(){const ue=yield y.l(ee.request,Q);try{return{vectorTile:new y.bt.VectorTile(new y.bu(ue.data)),rawData:ue.data,cacheControl:ue.cacheControl,expires:ue.expires}}catch(we){const je=new Uint8Array(ue.data);let Oe=`Unable to parse the tile at ${ee.request.url}, `;throw Oe+=je[0]===31&&je[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${we.message}`,new Error(Oe)}}))}loadTile(ee){return y._(this,void 0,void 0,(function*(){const Q=ee.uid,ue=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new y.bv(ee.request),we=new I(ee);this.loading[Q]=we;const je=new AbortController;we.abort=je;try{const Oe=yield this.loadVectorTile(ee,je);if(delete this.loading[Q],!Oe)return null;const qe=Oe.rawData,de={};Oe.expires&&(de.expires=Oe.expires),Oe.cacheControl&&(de.cacheControl=Oe.cacheControl);const Je={};if(ue){const Ye=ue.finish();Ye&&(Je.resourceTiming=JSON.parse(JSON.stringify(Ye)))}we.vectorTile=Oe.vectorTile;const ct=we.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[Q]=we,this.fetching[Q]={rawTileData:qe,cacheControl:de,resourceTiming:Je};try{const Ye=yield ct;return y.e({rawTileData:qe.slice(0)},Ye,de,Je)}finally{delete this.fetching[Q]}}catch(Oe){throw delete this.loading[Q],we.status="done",this.loaded[Q]=we,Oe}}))}reloadTile(ee){return y._(this,void 0,void 0,(function*(){const Q=ee.uid;if(!this.loaded||!this.loaded[Q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ue=this.loaded[Q];if(ue.showCollisionBoxes=ee.showCollisionBoxes,ue.status==="parsing"){const we=yield ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor);let je;if(this.fetching[Q]){const{rawTileData:Oe,cacheControl:qe,resourceTiming:de}=this.fetching[Q];delete this.fetching[Q],je=y.e({rawTileData:Oe.slice(0)},we,qe,de)}else je=we;return je}if(ue.status==="done"&&ue.vectorTile)return ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(ee){return y._(this,void 0,void 0,(function*(){const Q=this.loading,ue=ee.uid;Q&&Q[ue]&&Q[ue].abort&&(Q[ue].abort.abort(),delete Q[ue])}))}removeTile(ee){return y._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]}))}}class V{constructor(){this.loaded={}}loadTile(ee){return y._(this,void 0,void 0,(function*(){const{uid:Q,encoding:ue,rawImageData:we,redFactor:je,greenFactor:Oe,blueFactor:qe,baseShift:de}=ee,Je=we.width+2,ct=we.height+2,Ye=y.b(we)?new y.R({width:Je,height:ct},yield y.bw(we,-1,-1,Je,ct)):we,nt=new y.bx(Q,Ye,ue,je,Oe,qe,de);return this.loaded=this.loaded||{},this.loaded[Q]=nt,nt}))}removeTile(ee){const Q=this.loaded,ue=ee.uid;Q&&Q[ue]&&delete Q[ue]}}function K(xe,ee){if(xe.length!==0){ie(xe[0],ee);for(var Q=1;Q<xe.length;Q++)ie(xe[Q],!ee)}}function ie(xe,ee){for(var Q=0,ue=0,we=0,je=xe.length,Oe=je-1;we<je;Oe=we++){var qe=(xe[we][0]-xe[Oe][0])*(xe[Oe][1]+xe[we][1]),de=Q+qe;ue+=Math.abs(Q)>=Math.abs(qe)?Q-de+qe:qe-de+Q,Q=de}Q+ue>=0!=!!ee&&xe.reverse()}var ne=y.by((function xe(ee,Q){var ue,we=ee&&ee.type;if(we==="FeatureCollection")for(ue=0;ue<ee.features.length;ue++)xe(ee.features[ue],Q);else if(we==="GeometryCollection")for(ue=0;ue<ee.geometries.length;ue++)xe(ee.geometries[ue],Q);else if(we==="Feature")xe(ee.geometry,Q);else if(we==="Polygon")K(ee.coordinates,Q);else if(we==="MultiPolygon")for(ue=0;ue<ee.coordinates.length;ue++)K(ee.coordinates[ue],Q);return ee}));const ve=y.bt.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},ge=y.bz,ae=y.bt.VectorTileFeature,me=ye;function ye(xe,ee){this.options=ee||{},this.features=xe,this.length=xe.length}function Se(xe,ee){this.id=typeof xe.id=="number"?xe.id:void 0,this.type=xe.type,this.rawGeometry=xe.type===1?[xe.geometry]:xe.geometry,this.properties=xe.tags,this.extent=ee||4096}ye.prototype.feature=function(xe){return new Se(this.features[xe],this.options.extent)},Se.prototype.loadGeometry=function(){var xe=this.rawGeometry;this.geometry=[];for(var ee=0;ee<xe.length;ee++){for(var Q=xe[ee],ue=[],we=0;we<Q.length;we++)ue.push(new ge(Q[we][0],Q[we][1]));this.geometry.push(ue)}return this.geometry},Se.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var xe=this.geometry,ee=1/0,Q=-1/0,ue=1/0,we=-1/0,je=0;je<xe.length;je++)for(var Oe=xe[je],qe=0;qe<Oe.length;qe++){var de=Oe[qe];ee=Math.min(ee,de.x),Q=Math.max(Q,de.x),ue=Math.min(ue,de.y),we=Math.max(we,de.y)}return[ee,ue,Q,we]},Se.prototype.toGeoJSON=ae.prototype.toGeoJSON;var ze=y.bA,He=me;function Ze(xe){var ee=new ze;return(function(Q,ue){for(var we in Q.layers)ue.writeMessage(3,st,Q.layers[we])})(xe,ee),ee.finish()}function st(xe,ee){var Q;ee.writeVarintField(15,xe.version||1),ee.writeStringField(1,xe.name||""),ee.writeVarintField(5,xe.extent||4096);var ue={keys:[],values:[],keycache:{},valuecache:{}};for(Q=0;Q<xe.length;Q++)ue.feature=xe.feature(Q),ee.writeMessage(2,lt,ue);var we=ue.keys;for(Q=0;Q<we.length;Q++)ee.writeStringField(3,we[Q]);var je=ue.values;for(Q=0;Q<je.length;Q++)ee.writeMessage(4,Be,je[Q])}function lt(xe,ee){var Q=xe.feature;Q.id!==void 0&&ee.writeVarintField(1,Q.id),ee.writeMessage(2,Ke,xe),ee.writeVarintField(3,Q.type),ee.writeMessage(4,St,Q)}function Ke(xe,ee){var Q=xe.feature,ue=xe.keys,we=xe.values,je=xe.keycache,Oe=xe.valuecache;for(var qe in Q.properties){var de=Q.properties[qe],Je=je[qe];if(de!==null){Je===void 0&&(ue.push(qe),je[qe]=Je=ue.length-1),ee.writeVarint(Je);var ct=typeof de;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(de=JSON.stringify(de));var Ye=ct+":"+de,nt=Oe[Ye];nt===void 0&&(we.push(de),Oe[Ye]=nt=we.length-1),ee.writeVarint(nt)}}}function Mt(xe,ee){return(ee<<3)+(7&xe)}function gt(xe){return xe<<1^xe>>31}function St(xe,ee){for(var Q=xe.loadGeometry(),ue=xe.type,we=0,je=0,Oe=Q.length,qe=0;qe<Oe;qe++){var de=Q[qe],Je=1;ue===1&&(Je=de.length),ee.writeVarint(Mt(1,Je));for(var ct=ue===3?de.length-1:de.length,Ye=0;Ye<ct;Ye++){Ye===1&&ue!==1&&ee.writeVarint(Mt(2,ct-1));var nt=de[Ye].x-we,ei=de[Ye].y-je;ee.writeVarint(gt(nt)),ee.writeVarint(gt(ei)),we+=nt,je+=ei}ue===3&&ee.writeVarint(Mt(7,1))}}function Be(xe,ee){var Q=typeof xe;Q==="string"?ee.writeStringField(1,xe):Q==="boolean"?ee.writeBooleanField(7,xe):Q==="number"&&(xe%1!=0?ee.writeDoubleField(3,xe):xe<0?ee.writeSVarintField(6,xe):ee.writeVarintField(5,xe))}se.exports=Ze,se.exports.fromVectorTileJs=Ze,se.exports.fromGeojsonVt=function(xe,ee){ee=ee||{};var Q={};for(var ue in xe)Q[ue]=new He(xe[ue].features,ee),Q[ue].name=ue,Q[ue].version=ee.version,Q[ue].extent=ee.extent;return Ze({layers:Q})},se.exports.GeoJSONWrapper=He;var ot=y.by(se.exports);const Fe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},kt=Math.fround||(rt=new Float32Array(1),xe=>(rt[0]=+xe,rt[0]));var rt;const be=3,Ie=5,et=6;class at{constructor(ee){this.options=Object.assign(Object.create(Fe),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:Q,minZoom:ue,maxZoom:we}=this.options;Q&&console.time("total time");const je=`prepare ${ee.length} points`;Q&&console.time(je),this.points=ee;const Oe=[];for(let de=0;de<ee.length;de++){const Je=ee[de];if(!Je.geometry)continue;const[ct,Ye]=Je.geometry.coordinates,nt=kt(Ot(ct)),ei=kt(Kt(Ye));Oe.push(nt,ei,1/0,de,-1,1),this.options.reduce&&Oe.push(0)}let qe=this.trees[we+1]=this._createTree(Oe);Q&&console.timeEnd(je);for(let de=we;de>=ue;de--){const Je=+Date.now();qe=this.trees[de]=this._createTree(this._cluster(qe,de)),Q&&console.log("z%d: %d clusters in %dms",de,qe.numItems,+Date.now()-Je)}return Q&&console.timeEnd("total time"),this}getClusters(ee,Q){let ue=((ee[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,ee[1]));let je=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ue=-180,je=180;else if(ue>je){const Ye=this.getClusters([ue,we,180,Oe],Q),nt=this.getClusters([-180,we,je,Oe],Q);return Ye.concat(nt)}const qe=this.trees[this._limitZoom(Q)],de=qe.range(Ot(ue),Kt(Oe),Ot(je),Kt(we)),Je=qe.data,ct=[];for(const Ye of de){const nt=this.stride*Ye;ct.push(Je[nt+Ie]>1?mt(Je,nt,this.clusterProps):this.points[Je[nt+be]])}return ct}getChildren(ee){const Q=this._getOriginId(ee),ue=this._getOriginZoom(ee),we="No cluster with the specified id.",je=this.trees[ue];if(!je)throw new Error(we);const Oe=je.data;if(Q*this.stride>=Oe.length)throw new Error(we);const qe=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),de=je.within(Oe[Q*this.stride],Oe[Q*this.stride+1],qe),Je=[];for(const ct of de){const Ye=ct*this.stride;Oe[Ye+4]===ee&&Je.push(Oe[Ye+Ie]>1?mt(Oe,Ye,this.clusterProps):this.points[Oe[Ye+be]])}if(Je.length===0)throw new Error(we);return Je}getLeaves(ee,Q,ue){const we=[];return this._appendLeaves(we,ee,Q=Q||10,ue=ue||0,0),we}getTile(ee,Q,ue){const we=this.trees[this._limitZoom(ee)],je=Math.pow(2,ee),{extent:Oe,radius:qe}=this.options,de=qe/Oe,Je=(ue-de)/je,ct=(ue+1+de)/je,Ye={features:[]};return this._addTileFeatures(we.range((Q-de)/je,Je,(Q+1+de)/je,ct),we.data,Q,ue,je,Ye),Q===0&&this._addTileFeatures(we.range(1-de/je,Je,1,ct),we.data,je,ue,je,Ye),Q===je-1&&this._addTileFeatures(we.range(0,Je,de/je,ct),we.data,-1,ue,je,Ye),Ye.features.length?Ye:null}getClusterExpansionZoom(ee){let Q=this._getOriginZoom(ee)-1;for(;Q<=this.options.maxZoom;){const ue=this.getChildren(ee);if(Q++,ue.length!==1)break;ee=ue[0].properties.cluster_id}return Q}_appendLeaves(ee,Q,ue,we,je){const Oe=this.getChildren(Q);for(const qe of Oe){const de=qe.properties;if(de&&de.cluster?je+de.point_count<=we?je+=de.point_count:je=this._appendLeaves(ee,de.cluster_id,ue,we,je):je<we?je++:ee.push(qe),ee.length===ue)break}return je}_createTree(ee){const Q=new y.av(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ue=0;ue<ee.length;ue+=this.stride)Q.add(ee[ue],ee[ue+1]);return Q.finish(),Q.data=ee,Q}_addTileFeatures(ee,Q,ue,we,je,Oe){for(const qe of ee){const de=qe*this.stride,Je=Q[de+Ie]>1;let ct,Ye,nt;if(Je)ct=Ct(Q,de,this.clusterProps),Ye=Q[de],nt=Q[de+1];else{const $t=this.points[Q[de+be]];ct=$t.properties;const[At,ni]=$t.geometry.coordinates;Ye=Ot(At),nt=Kt(ni)}const ei={type:1,geometry:[[Math.round(this.options.extent*(Ye*je-ue)),Math.round(this.options.extent*(nt*je-we))]],tags:ct};let si;si=Je||this.options.generateId?Q[de+be]:this.points[Q[de+be]].id,si!==void 0&&(ei.id=si),Oe.features.push(ei)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,Q){const{radius:ue,extent:we,reduce:je,minPoints:Oe}=this.options,qe=ue/(we*Math.pow(2,Q)),de=ee.data,Je=[],ct=this.stride;for(let Ye=0;Ye<de.length;Ye+=ct){if(de[Ye+2]<=Q)continue;de[Ye+2]=Q;const nt=de[Ye],ei=de[Ye+1],si=ee.within(de[Ye],de[Ye+1],qe),$t=de[Ye+Ie];let At=$t;for(const ni of si){const vi=ni*ct;de[vi+2]>Q&&(At+=de[vi+Ie])}if(At>$t&&At>=Oe){let ni,vi=nt*$t,Bi=ei*$t,_t=-1;const xt=((Ye/ct|0)<<5)+(Q+1)+this.points.length;for(const Wt of si){const pi=Wt*ct;if(de[pi+2]<=Q)continue;de[pi+2]=Q;const Ne=de[pi+Ie];vi+=de[pi]*Ne,Bi+=de[pi+1]*Ne,de[pi+4]=xt,je&&(ni||(ni=this._map(de,Ye,!0),_t=this.clusterProps.length,this.clusterProps.push(ni)),je(ni,this._map(de,pi)))}de[Ye+4]=xt,Je.push(vi/At,Bi/At,1/0,xt,-1,At),je&&Je.push(_t)}else{for(let ni=0;ni<ct;ni++)Je.push(de[Ye+ni]);if(At>1)for(const ni of si){const vi=ni*ct;if(!(de[vi+2]<=Q)){de[vi+2]=Q;for(let Bi=0;Bi<ct;Bi++)Je.push(de[vi+Bi])}}}}return Je}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,Q,ue){if(ee[Q+Ie]>1){const Oe=this.clusterProps[ee[Q+et]];return ue?Object.assign({},Oe):Oe}const we=this.points[ee[Q+be]].properties,je=this.options.map(we);return ue&&je===we?Object.assign({},je):je}}function mt(xe,ee,Q){return{type:"Feature",id:xe[ee+be],properties:Ct(xe,ee,Q),geometry:{type:"Point",coordinates:[(ue=xe[ee],360*(ue-.5)),_i(xe[ee+1])]}};var ue}function Ct(xe,ee,Q){const ue=xe[ee+Ie],we=ue>=1e4?`${Math.round(ue/1e3)}k`:ue>=1e3?Math.round(ue/100)/10+"k":ue,je=xe[ee+et],Oe=je===-1?{}:Object.assign({},Q[je]);return Object.assign(Oe,{cluster:!0,cluster_id:xe[ee+be],point_count:ue,point_count_abbreviated:we})}function Ot(xe){return xe/360+.5}function Kt(xe){const ee=Math.sin(xe*Math.PI/180),Q=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return Q<0?0:Q>1?1:Q}function _i(xe){const ee=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Vi(xe,ee,Q,ue){let we=ue;const je=ee+(Q-ee>>1);let Oe,qe=Q-ee;const de=xe[ee],Je=xe[ee+1],ct=xe[Q],Ye=xe[Q+1];for(let nt=ee+3;nt<Q;nt+=3){const ei=gi(xe[nt],xe[nt+1],de,Je,ct,Ye);if(ei>we)Oe=nt,we=ei;else if(ei===we){const si=Math.abs(nt-je);si<qe&&(Oe=nt,qe=si)}}we>ue&&(Oe-ee>3&&Vi(xe,ee,Oe,ue),xe[Oe+2]=we,Q-Oe>3&&Vi(xe,Oe,Q,ue))}function gi(xe,ee,Q,ue,we,je){let Oe=we-Q,qe=je-ue;if(Oe!==0||qe!==0){const de=((xe-Q)*Oe+(ee-ue)*qe)/(Oe*Oe+qe*qe);de>1?(Q=we,ue=je):de>0&&(Q+=Oe*de,ue+=qe*de)}return Oe=xe-Q,qe=ee-ue,Oe*Oe+qe*qe}function Oi(xe,ee,Q,ue){const we={id:xe??null,type:ee,geometry:Q,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")xn(we,Q);else if(ee==="Polygon")xn(we,Q[0]);else if(ee==="MultiLineString")for(const je of Q)xn(we,je);else if(ee==="MultiPolygon")for(const je of Q)xn(we,je[0]);return we}function xn(xe,ee){for(let Q=0;Q<ee.length;Q+=3)xe.minX=Math.min(xe.minX,ee[Q]),xe.minY=Math.min(xe.minY,ee[Q+1]),xe.maxX=Math.max(xe.maxX,ee[Q]),xe.maxY=Math.max(xe.maxY,ee[Q+1])}function cn(xe,ee,Q,ue){if(!ee.geometry)return;const we=ee.geometry.coordinates;if(we&&we.length===0)return;const je=ee.geometry.type,Oe=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2);let qe=[],de=ee.id;if(Q.promoteId?de=ee.properties[Q.promoteId]:Q.generateId&&(de=ue||0),je==="Point")Zn(we,qe);else if(je==="MultiPoint")for(const Je of we)Zn(Je,qe);else if(je==="LineString")tt(we,qe,Oe,!1);else if(je==="MultiLineString"){if(Q.lineMetrics){for(const Je of we)qe=[],tt(Je,qe,Oe,!1),xe.push(Oi(de,"LineString",qe,ee.properties));return}Xn(we,qe,Oe,!1)}else if(je==="Polygon")Xn(we,qe,Oe,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const Je of ee.geometry.geometries)cn(xe,{id:de,geometry:Je,properties:ee.properties},Q,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Je of we){const ct=[];Xn(Je,ct,Oe,!0),qe.push(ct)}}xe.push(Oi(de,je,qe,ee.properties))}function Zn(xe,ee){ee.push(Pn(xe[0]),ki(xe[1]),0)}function tt(xe,ee,Q,ue){let we,je,Oe=0;for(let de=0;de<xe.length;de++){const Je=Pn(xe[de][0]),ct=ki(xe[de][1]);ee.push(Je,ct,0),de>0&&(Oe+=ue?(we*ct-Je*je)/2:Math.sqrt(Math.pow(Je-we,2)+Math.pow(ct-je,2))),we=Je,je=ct}const qe=ee.length-3;ee[2]=1,Vi(ee,0,qe,Q),ee[qe+2]=1,ee.size=Math.abs(Oe),ee.start=0,ee.end=ee.size}function Xn(xe,ee,Q,ue){for(let we=0;we<xe.length;we++){const je=[];tt(xe[we],je,Q,ue),ee.push(je)}}function Pn(xe){return xe/360+.5}function ki(xe){const ee=Math.sin(xe*Math.PI/180),Q=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return Q<0?0:Q>1?1:Q}function yi(xe,ee,Q,ue,we,je,Oe,qe){if(ue/=ee,je>=(Q/=ee)&&Oe<ue)return xe;if(Oe<Q||je>=ue)return null;const de=[];for(const Je of xe){const ct=Je.geometry;let Ye=Je.type;const nt=we===0?Je.minX:Je.minY,ei=we===0?Je.maxX:Je.maxY;if(nt>=Q&&ei<ue){de.push(Je);continue}if(ei<Q||nt>=ue)continue;let si=[];if(Ye==="Point"||Ye==="MultiPoint")Cn(ct,si,Q,ue,we);else if(Ye==="LineString")Ln(ct,si,Q,ue,we,!1,qe.lineMetrics);else if(Ye==="MultiLineString")an(ct,si,Q,ue,we,!1);else if(Ye==="Polygon")an(ct,si,Q,ue,we,!0);else if(Ye==="MultiPolygon")for(const $t of ct){const At=[];an($t,At,Q,ue,we,!0),At.length&&si.push(At)}if(si.length){if(qe.lineMetrics&&Ye==="LineString"){for(const $t of si)de.push(Oi(Je.id,Ye,$t,Je.tags));continue}Ye!=="LineString"&&Ye!=="MultiLineString"||(si.length===1?(Ye="LineString",si=si[0]):Ye="MultiLineString"),Ye!=="Point"&&Ye!=="MultiPoint"||(Ye=si.length===3?"Point":"MultiPoint"),de.push(Oi(Je.id,Ye,si,Je.tags))}}return de.length?de:null}function Cn(xe,ee,Q,ue,we){for(let je=0;je<xe.length;je+=3){const Oe=xe[je+we];Oe>=Q&&Oe<=ue&&en(ee,xe[je],xe[je+1],xe[je+2])}}function Ln(xe,ee,Q,ue,we,je,Oe){let qe=us(xe);const de=we===0?qi:Fn;let Je,ct,Ye=xe.start;for(let At=0;At<xe.length-3;At+=3){const ni=xe[At],vi=xe[At+1],Bi=xe[At+2],_t=xe[At+3],xt=xe[At+4],Wt=we===0?ni:vi,pi=we===0?_t:xt;let Ne=!1;Oe&&(Je=Math.sqrt(Math.pow(ni-_t,2)+Math.pow(vi-xt,2))),Wt<Q?pi>Q&&(ct=de(qe,ni,vi,_t,xt,Q),Oe&&(qe.start=Ye+Je*ct)):Wt>ue?pi<ue&&(ct=de(qe,ni,vi,_t,xt,ue),Oe&&(qe.start=Ye+Je*ct)):en(qe,ni,vi,Bi),pi<Q&&Wt>=Q&&(ct=de(qe,ni,vi,_t,xt,Q),Ne=!0),pi>ue&&Wt<=ue&&(ct=de(qe,ni,vi,_t,xt,ue),Ne=!0),!je&&Ne&&(Oe&&(qe.end=Ye+Je*ct),ee.push(qe),qe=us(xe)),Oe&&(Ye+=Je)}let nt=xe.length-3;const ei=xe[nt],si=xe[nt+1],$t=we===0?ei:si;$t>=Q&&$t<=ue&&en(qe,ei,si,xe[nt+2]),nt=qe.length-3,je&&nt>=3&&(qe[nt]!==qe[0]||qe[nt+1]!==qe[1])&&en(qe,qe[0],qe[1],qe[2]),qe.length&&ee.push(qe)}function us(xe){const ee=[];return ee.size=xe.size,ee.start=xe.start,ee.end=xe.end,ee}function an(xe,ee,Q,ue,we,je){for(const Oe of xe)Ln(Oe,ee,Q,ue,we,je,!1)}function en(xe,ee,Q,ue){xe.push(ee,Q,ue)}function qi(xe,ee,Q,ue,we,je){const Oe=(je-ee)/(ue-ee);return en(xe,je,Q+(we-Q)*Oe,1),Oe}function Fn(xe,ee,Q,ue,we,je){const Oe=(je-Q)/(we-Q);return en(xe,ee+(ue-ee)*Oe,je,1),Oe}function Tt(xe,ee){const Q=[];for(let ue=0;ue<xe.length;ue++){const we=xe[ue],je=we.type;let Oe;if(je==="Point"||je==="MultiPoint"||je==="LineString")Oe=On(we.geometry,ee);else if(je==="MultiLineString"||je==="Polygon"){Oe=[];for(const qe of we.geometry)Oe.push(On(qe,ee))}else if(je==="MultiPolygon"){Oe=[];for(const qe of we.geometry){const de=[];for(const Je of qe)de.push(On(Je,ee));Oe.push(de)}}Q.push(Oi(we.id,je,Oe,we.tags))}return Q}function On(xe,ee){const Q=[];Q.size=xe.size,xe.start!==void 0&&(Q.start=xe.start,Q.end=xe.end);for(let ue=0;ue<xe.length;ue+=3)Q.push(xe[ue]+ee,xe[ue+1],xe[ue+2]);return Q}function dn(xe,ee){if(xe.transformed)return xe;const Q=1<<xe.z,ue=xe.x,we=xe.y;for(const je of xe.features){const Oe=je.geometry,qe=je.type;if(je.geometry=[],qe===1)for(let de=0;de<Oe.length;de+=2)je.geometry.push(An(Oe[de],Oe[de+1],ee,Q,ue,we));else for(let de=0;de<Oe.length;de++){const Je=[];for(let ct=0;ct<Oe[de].length;ct+=2)Je.push(An(Oe[de][ct],Oe[de][ct+1],ee,Q,ue,we));je.geometry.push(Je)}}return xe.transformed=!0,xe}function An(xe,ee,Q,ue,we,je){return[Math.round(Q*(xe*ue-we)),Math.round(Q*(ee*ue-je))]}function Kn(xe,ee,Q,ue,we){const je=ee===we.maxZoom?0:we.tolerance/((1<<ee)*we.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:Q,y:ue,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const qe of xe)It(Oe,qe,je,we);return Oe}function It(xe,ee,Q,ue){const we=ee.geometry,je=ee.type,Oe=[];if(xe.minX=Math.min(xe.minX,ee.minX),xe.minY=Math.min(xe.minY,ee.minY),xe.maxX=Math.max(xe.maxX,ee.maxX),xe.maxY=Math.max(xe.maxY,ee.maxY),je==="Point"||je==="MultiPoint")for(let qe=0;qe<we.length;qe+=3)Oe.push(we[qe],we[qe+1]),xe.numPoints++,xe.numSimplified++;else if(je==="LineString")ai(Oe,we,xe,Q,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let qe=0;qe<we.length;qe++)ai(Oe,we[qe],xe,Q,je==="Polygon",qe===0);else if(je==="MultiPolygon")for(let qe=0;qe<we.length;qe++){const de=we[qe];for(let Je=0;Je<de.length;Je++)ai(Oe,de[Je],xe,Q,!0,Je===0)}if(Oe.length){let qe=ee.tags||null;if(je==="LineString"&&ue.lineMetrics){qe={};for(const Je in ee.tags)qe[Je]=ee.tags[Je];qe.mapbox_clip_start=we.start/we.size,qe.mapbox_clip_end=we.end/we.size}const de={geometry:Oe,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:qe};ee.id!==null&&(de.id=ee.id),xe.features.push(de)}}function ai(xe,ee,Q,ue,we,je){const Oe=ue*ue;if(ue>0&&ee.size<(we?Oe:ue))return void(Q.numPoints+=ee.length/3);const qe=[];for(let de=0;de<ee.length;de+=3)(ue===0||ee[de+2]>Oe)&&(Q.numSimplified++,qe.push(ee[de],ee[de+1])),Q.numPoints++;we&&(function(de,Je){let ct=0;for(let Ye=0,nt=de.length,ei=nt-2;Ye<nt;ei=Ye,Ye+=2)ct+=(de[Ye]-de[ei])*(de[Ye+1]+de[ei+1]);if(ct>0===Je)for(let Ye=0,nt=de.length;Ye<nt/2;Ye+=2){const ei=de[Ye],si=de[Ye+1];de[Ye]=de[nt-2-Ye],de[Ye+1]=de[nt-1-Ye],de[nt-2-Ye]=ei,de[nt-1-Ye]=si}})(qe,je),xe.push(qe)}const ti={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ji{constructor(ee,Q){const ue=(Q=this.options=(function(je,Oe){for(const qe in Oe)je[qe]=Oe[qe];return je})(Object.create(ti),Q)).debug;if(ue&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");let we=(function(je,Oe){const qe=[];if(je.type==="FeatureCollection")for(let de=0;de<je.features.length;de++)cn(qe,je.features[de],Oe,de);else cn(qe,je.type==="Feature"?je:{geometry:je},Oe);return qe})(ee,Q);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),we=(function(je,Oe){const qe=Oe.buffer/Oe.extent;let de=je;const Je=yi(je,1,-1-qe,qe,0,-1,2,Oe),ct=yi(je,1,1-qe,2+qe,0,-1,2,Oe);return(Je||ct)&&(de=yi(je,1,-qe,1+qe,0,-1,2,Oe)||[],Je&&(de=Tt(Je,1).concat(de)),ct&&(de=de.concat(Tt(ct,-1)))),de})(we,Q),we.length&&this.splitTile(we,0,0,0),ue&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,Q,ue,we,je,Oe,qe){const de=[ee,Q,ue,we],Je=this.options,ct=Je.debug;for(;de.length;){we=de.pop(),ue=de.pop(),Q=de.pop(),ee=de.pop();const Ye=1<<Q,nt=Nn(Q,ue,we);let ei=this.tiles[nt];if(!ei&&(ct>1&&console.time("creation"),ei=this.tiles[nt]=Kn(ee,Q,ue,we,Je),this.tileCoords.push({z:Q,x:ue,y:we}),ct)){ct>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,ue,we,ei.numFeatures,ei.numPoints,ei.numSimplified),console.timeEnd("creation"));const Ne=`z${Q}`;this.stats[Ne]=(this.stats[Ne]||0)+1,this.total++}if(ei.source=ee,je==null){if(Q===Je.indexMaxZoom||ei.numPoints<=Je.indexMaxPoints)continue}else{if(Q===Je.maxZoom||Q===je)continue;if(je!=null){const Ne=je-Q;if(ue!==Oe>>Ne||we!==qe>>Ne)continue}}if(ei.source=null,ee.length===0)continue;ct>1&&console.time("clipping");const si=.5*Je.buffer/Je.extent,$t=.5-si,At=.5+si,ni=1+si;let vi=null,Bi=null,_t=null,xt=null,Wt=yi(ee,Ye,ue-si,ue+At,0,ei.minX,ei.maxX,Je),pi=yi(ee,Ye,ue+$t,ue+ni,0,ei.minX,ei.maxX,Je);ee=null,Wt&&(vi=yi(Wt,Ye,we-si,we+At,1,ei.minY,ei.maxY,Je),Bi=yi(Wt,Ye,we+$t,we+ni,1,ei.minY,ei.maxY,Je),Wt=null),pi&&(_t=yi(pi,Ye,we-si,we+At,1,ei.minY,ei.maxY,Je),xt=yi(pi,Ye,we+$t,we+ni,1,ei.minY,ei.maxY,Je),pi=null),ct>1&&console.timeEnd("clipping"),de.push(vi||[],Q+1,2*ue,2*we),de.push(Bi||[],Q+1,2*ue,2*we+1),de.push(_t||[],Q+1,2*ue+1,2*we),de.push(xt||[],Q+1,2*ue+1,2*we+1)}}getTile(ee,Q,ue){ee=+ee,Q=+Q,ue=+ue;const we=this.options,{extent:je,debug:Oe}=we;if(ee<0||ee>24)return null;const qe=1<<ee,de=Nn(ee,Q=Q+qe&qe-1,ue);if(this.tiles[de])return dn(this.tiles[de],je);Oe>1&&console.log("drilling down to z%d-%d-%d",ee,Q,ue);let Je,ct=ee,Ye=Q,nt=ue;for(;!Je&&ct>0;)ct--,Ye>>=1,nt>>=1,Je=this.tiles[Nn(ct,Ye,nt)];return Je&&Je.source?(Oe>1&&(console.log("found parent tile z%d-%d-%d",ct,Ye,nt),console.time("drilling down")),this.splitTile(Je.source,ct,Ye,nt,ee,Q,ue),Oe>1&&console.timeEnd("drilling down"),this.tiles[de]?dn(this.tiles[de],je):null):null}}function Nn(xe,ee,Q){return 32*((1<<xe)*Q+ee)+xe}function mi(xe,ee){return ee?xe.properties[ee]:xe.id}function Bt(xe,ee){if(xe==null)return!0;if(xe.type==="Feature")return mi(xe,ee)!=null;if(xe.type==="FeatureCollection"){const Q=new Set;for(const ue of xe.features){const we=mi(ue,ee);if(we==null||Q.has(we))return!1;Q.add(we)}return!0}return!1}function hi(xe,ee){const Q=new Map;if(xe!=null)if(xe.type==="Feature")Q.set(mi(xe,ee),xe);else for(const ue of xe.features)Q.set(mi(ue,ee),ue);return Q}class Ci extends N{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,Q){return y._(this,void 0,void 0,(function*(){const ue=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const we=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!we)return null;const je=new class{constructor(qe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.X,this.length=qe.length,this._features=qe}feature(qe){return new class{constructor(de){this._feature=de,this.extent=y.X,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const Je of this._feature.geometry)de.push([new y.P(Je[0],Je[1])]);return de}{const de=[];for(const Je of this._feature.geometry){const ct=[];for(const Ye of Je)ct.push(new y.P(Ye[0],Ye[1]));de.push(ct)}return de}}toGeoJSON(de,Je,ct){return ve.call(this,de,Je,ct)}}(this._features[qe])}}(we.features);let Oe=ot(je);return Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),{vectorTile:je,rawData:Oe.buffer}}))}loadData(ee){return y._(this,void 0,void 0,(function*(){var Q;(Q=this._pendingRequest)===null||Q===void 0||Q.abort();const ue=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new y.bv(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest),this._geoJSONIndex=ee.cluster?new at((function({superclusterOptions:Oe,clusterProperties:qe}){if(!qe||!Oe)return Oe;const de={},Je={},ct={accumulated:null,zoom:0},Ye={properties:null},nt=Object.keys(qe);for(const ei of nt){const[si,$t]=qe[ei],At=y.bC($t),ni=y.bC(typeof si=="string"?[si,["accumulated"],["get",ei]]:si);de[ei]=At.value,Je[ei]=ni.value}return Oe.map=ei=>{Ye.properties=ei;const si={};for(const $t of nt)si[$t]=de[$t].evaluate(ct,Ye);return si},Oe.reduce=(ei,si)=>{Ye.properties=si;for(const $t of nt)ct.accumulated=ei[$t],ei[$t]=Je[$t].evaluate(ct,Ye)},Oe})(ee)).load((yield this._pendingData).features):(we=yield this._pendingData,new Ji(we,ee.geojsonVtOptions)),this.loaded={};const je={};if(ue){const Oe=ue.finish();Oe&&(je.resourceTiming={},je.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Oe)))}return je}catch(je){if(delete this._pendingRequest,y.bB(je))return{abandoned:!0};throw je}var we}))}getData(){return y._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(ee){const Q=this.loaded;return Q&&Q[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,Q){return y._(this,void 0,void 0,(function*(){let ue=yield this.loadGeoJSON(ee,Q);if(delete this._pendingRequest,typeof ue!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(ne(ue,!0),ee.filter){const we=y.bC(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(we.result==="error")throw new Error(we.value.map((Oe=>`${Oe.key}: ${Oe.message}`)).join(", "));ue={type:"FeatureCollection",features:ue.features.filter((Oe=>we.value.evaluate({zoom:0},Oe)))}}return ue}))}loadGeoJSON(ee,Q){return y._(this,void 0,void 0,(function*(){const{promoteId:ue}=ee;if(ee.request){const we=yield y.h(ee.request,Q);return this._dataUpdateable=Bt(we.data,ue)?hi(we.data,ue):void 0,we.data}if(typeof ee.data=="string")try{const we=JSON.parse(ee.data);return this._dataUpdateable=Bt(we,ue)?hi(we,ue):void 0,we}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return(function(we,je,Oe){var qe,de,Je,ct;if(je.removeAll&&we.clear(),je.remove)for(const Ye of je.remove)we.delete(Ye);if(je.add)for(const Ye of je.add){const nt=mi(Ye,Oe);nt!=null&&we.set(nt,Ye)}if(je.update)for(const Ye of je.update){let nt=we.get(Ye.id);if(nt==null)continue;const ei=!Ye.removeAllProperties&&(((qe=Ye.removeProperties)===null||qe===void 0?void 0:qe.length)>0||((de=Ye.addOrUpdateProperties)===null||de===void 0?void 0:de.length)>0);if((Ye.newGeometry||Ye.removeAllProperties||ei)&&(nt=Object.assign({},nt),we.set(Ye.id,nt),ei&&(nt.properties=Object.assign({},nt.properties))),Ye.newGeometry&&(nt.geometry=Ye.newGeometry),Ye.removeAllProperties)nt.properties={};else if(((Je=Ye.removeProperties)===null||Je===void 0?void 0:Je.length)>0)for(const si of Ye.removeProperties)Object.prototype.hasOwnProperty.call(nt.properties,si)&&delete nt.properties[si];if(((ct=Ye.addOrUpdateProperties)===null||ct===void 0?void 0:ct.length)>0)for(const{key:si,value:$t}of Ye.addOrUpdateProperties)nt.properties[si]=$t}})(this._dataUpdateable,ee.dataDiff,ue),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(ee){return y._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class bi{constructor(ee){this.self=ee,this.actor=new y.F(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Q,ue)=>{if(this.externalWorkerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.externalWorkerSourceTypes[Q]=ue},this.self.addProtocol=y.bi,this.self.removeProtocol=y.bj,this.self.registerRTLTextPlugin=Q=>{if(y.bD.isParsed())throw new Error("RTL text plugin already registered.");y.bD.setMethods(Q)},this.actor.registerMessageHandler("LDT",((Q,ue)=>this._getDEMWorkerSource(Q,ue.source).loadTile(ue))),this.actor.registerMessageHandler("RDT",((Q,ue)=>y._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(Q,ue.source).removeTile(ue)})))),this.actor.registerMessageHandler("GCEZ",((Q,ue)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(Q,ue.type,ue.source).getClusterExpansionZoom(ue)})))),this.actor.registerMessageHandler("GCC",((Q,ue)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(Q,ue.type,ue.source).getClusterChildren(ue)})))),this.actor.registerMessageHandler("GCL",((Q,ue)=>y._(this,void 0,void 0,(function*(){return this._getWorkerSource(Q,ue.type,ue.source).getClusterLeaves(ue)})))),this.actor.registerMessageHandler("LD",((Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).loadData(ue))),this.actor.registerMessageHandler("GD",((Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).getData())),this.actor.registerMessageHandler("LT",((Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).loadTile(ue))),this.actor.registerMessageHandler("RT",((Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).reloadTile(ue))),this.actor.registerMessageHandler("AT",((Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).abortTile(ue))),this.actor.registerMessageHandler("RMT",((Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).removeTile(ue))),this.actor.registerMessageHandler("RS",((Q,ue)=>y._(this,void 0,void 0,(function*(){if(!this.workerSources[Q]||!this.workerSources[Q][ue.type]||!this.workerSources[Q][ue.type][ue.source])return;const we=this.workerSources[Q][ue.type][ue.source];delete this.workerSources[Q][ue.type][ue.source],we.removeSource!==void 0&&we.removeSource(ue)})))),this.actor.registerMessageHandler("RM",(Q=>y._(this,void 0,void 0,(function*(){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q]})))),this.actor.registerMessageHandler("SR",((Q,ue)=>y._(this,void 0,void 0,(function*(){this.referrer=ue})))),this.actor.registerMessageHandler("SRPS",((Q,ue)=>this._syncRTLPluginState(Q,ue))),this.actor.registerMessageHandler("IS",((Q,ue)=>y._(this,void 0,void 0,(function*(){this.self.importScripts(ue)})))),this.actor.registerMessageHandler("SI",((Q,ue)=>this._setImages(Q,ue))),this.actor.registerMessageHandler("UL",((Q,ue)=>y._(this,void 0,void 0,(function*(){this._getLayerIndex(Q).update(ue.layers,ue.removedIds)})))),this.actor.registerMessageHandler("SL",((Q,ue)=>y._(this,void 0,void 0,(function*(){this._getLayerIndex(Q).replace(ue)}))))}_setImages(ee,Q){return y._(this,void 0,void 0,(function*(){this.availableImages[ee]=Q;for(const ue in this.workerSources[ee]){const we=this.workerSources[ee][ue];for(const je in we)we[je].availableImages=Q}}))}_syncRTLPluginState(ee,Q){return y._(this,void 0,void 0,(function*(){if(y.bD.isParsed())return y.bD.getState();if(Q.pluginStatus!=="loading")return y.bD.setState(Q),Q;const ue=Q.pluginURL;if(this.self.importScripts(ue),y.bD.isParsed()){const we={pluginStatus:"loaded",pluginURL:ue};return y.bD.setState(we),we}throw y.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${ue}`)}))}_getAvailableImages(ee){let Q=this.availableImages[ee];return Q||(Q=[]),Q}_getLayerIndex(ee){let Q=this.layerIndexes[ee];return Q||(Q=this.layerIndexes[ee]=new d),Q}_getWorkerSource(ee,Q,ue){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][Q]||(this.workerSources[ee][Q]={}),!this.workerSources[ee][Q][ue]){const we={sendAsync:(je,Oe)=>(je.targetMapId=ee,this.actor.sendAsync(je,Oe))};switch(Q){case"vector":this.workerSources[ee][Q][ue]=new N(we,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][Q][ue]=new Ci(we,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][Q][ue]=new this.externalWorkerSourceTypes[Q](we,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][Q][ue]}_getDEMWorkerSource(ee,Q){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][Q]||(this.demWorkerSources[ee][Q]=new V),this.demWorkerSources[ee][Q]}}return y.i(self)&&(self.worker=new bi(self)),bi})),f("index",["exports","./shared"],(function(y,d){var A="4.7.1";let I,B;const N={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:E=>new Promise(((i,h)=>{const g=requestAnimationFrame(i);E.signal.addEventListener("abort",(()=>{cancelAnimationFrame(g),h(d.c())}))})),getImageData(E,i=0){return this.getImageCanvasContext(E).getImageData(-i,-i,E.width+2*i,E.height+2*i)},getImageCanvasContext(E){const i=window.document.createElement("canvas"),h=i.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return i.width=E.width,i.height=E.height,h.drawImage(E,0,0,E.width,E.height),h},resolveURL:E=>(I||(I=document.createElement("a")),I.href=E,I.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class V{static testProp(i){if(!V.docStyle)return i[0];for(let h=0;h<i.length;h++)if(i[h]in V.docStyle)return i[h];return i[0]}static create(i,h,g){const v=window.document.createElement(i);return h!==void 0&&(v.className=h),g&&g.appendChild(v),v}static createNS(i,h){return window.document.createElementNS(i,h)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(i,h){i.style[V.transformProp]=h}static addEventListener(i,h,g,v={}){i.addEventListener(h,g,"passive"in v?v:v.capture)}static removeEventListener(i,h,g,v={}){i.removeEventListener(h,g,"passive"in v?v:v.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",V.suppressClickInternal,!0)}),0)}static getScale(i){const h=i.getBoundingClientRect();return{x:h.width/i.offsetWidth||1,y:h.height/i.offsetHeight||1,boundingClientRect:h}}static getPoint(i,h,g){const v=h.boundingClientRect;return new d.P((g.clientX-v.left)/h.x-i.clientLeft,(g.clientY-v.top)/h.y-i.clientTop)}static mousePos(i,h){const g=V.getScale(i);return V.getPoint(i,g,h)}static touchPos(i,h){const g=[],v=V.getScale(i);for(let T=0;T<h.length;T++)g.push(V.getPoint(i,v,h[T]));return g}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);const K={supported:!1,testSupport:function(E){!ve&&ne&&(se?ge(E):ie=E)}};let ie,ne,ve=!1,se=!1;function ge(E){const i=E.createTexture();E.bindTexture(E.TEXTURE_2D,i);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,ne),E.isContextLost())return;K.supported=!0}catch{}E.deleteTexture(i),ve=!0}var ae;typeof document<"u"&&(ne=document.createElement("img"),ne.onload=()=>{ie&&ge(ie),ie=null,se=!0},ne.onerror=()=>{ve=!0,ie=null},ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(E){let i,h,g,v;E.resetRequestQueue=()=>{i=[],h=0,g=0,v={}},E.addThrottleControl=U=>{const H=g++;return v[H]=U,H},E.removeThrottleControl=U=>{delete v[U],z()},E.getImage=(U,H,Y=!0)=>new Promise(((X,oe)=>{K.supported&&(U.headers||(U.headers={}),U.headers.accept="image/webp,*/*"),d.e(U,{type:"image"}),i.push({abortController:H,requestParameters:U,supportImageRefresh:Y,state:"queued",onError:fe=>{oe(fe)},onSuccess:fe=>{X(fe)}}),z()}));const T=U=>d._(this,void 0,void 0,(function*(){U.state="running";const{requestParameters:H,supportImageRefresh:Y,onError:X,onSuccess:oe,abortController:fe}=U,_e=Y===!1&&!d.i(self)&&!d.g(H.url)&&(!H.headers||Object.keys(H.headers).reduce(((Pe,Le)=>Pe&&Le==="accept"),!0));h++;const ke=_e?O(H,fe):d.m(H,fe);try{const Pe=yield ke;delete U.abortController,U.state="completed",Pe.data instanceof HTMLImageElement||d.b(Pe.data)?oe(Pe):Pe.data&&oe({data:yield(Me=Pe.data,typeof createImageBitmap=="function"?d.d(Me):d.f(Me)),cacheControl:Pe.cacheControl,expires:Pe.expires})}catch(Pe){delete U.abortController,X(Pe)}finally{h--,z()}var Me})),z=()=>{const U=(()=>{for(const H of Object.keys(v))if(v[H]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let H=h;H<U&&i.length>0;H++){const Y=i.shift();Y.abortController.signal.aborted?H--:T(Y)}},O=(U,H)=>new Promise(((Y,X)=>{const oe=new Image,fe=U.url,_e=U.credentials;_e&&_e==="include"?oe.crossOrigin="use-credentials":(_e&&_e==="same-origin"||!d.s(fe))&&(oe.crossOrigin="anonymous"),H.signal.addEventListener("abort",(()=>{oe.src="",X(d.c())})),oe.fetchPriority="high",oe.onload=()=>{oe.onerror=oe.onload=null,Y({data:oe})},oe.onerror=()=>{oe.onerror=oe.onload=null,H.signal.aborted||X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},oe.src=fe}))})(ae||(ae={})),ae.resetRequestQueue();class me{constructor(i){this._transformRequestFn=i}transformRequest(i,h){return this._transformRequestFn&&this._transformRequestFn(i,h)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function ye(E){var i=new d.A(3);return i[0]=E[0],i[1]=E[1],i[2]=E[2],i}var Se,ze=function(E,i,h){return E[0]=i[0]-h[0],E[1]=i[1]-h[1],E[2]=i[2]-h[2],E};Se=new d.A(3),d.A!=Float32Array&&(Se[0]=0,Se[1]=0,Se[2]=0);var He=function(E){var i=E[0],h=E[1];return i*i+h*h};function Ze(E){const i=[];if(typeof E=="string")i.push({id:"default",url:E});else if(E&&E.length>0){const h=[];for(const{id:g,url:v}of E){const T=`${g}${v}`;h.indexOf(T)===-1&&(h.push(T),i.push({id:g,url:v}))}}return i}function st(E,i,h){const g=E.split("?");return g[0]+=`${i}${h}`,g.join("?")}(function(){var E=new d.A(2);d.A!=Float32Array&&(E[0]=0,E[1]=0)})();class lt{constructor(i,h,g,v){this.context=i,this.format=g,this.texture=i.gl.createTexture(),this.update(h,v)}update(i,h,g){const{width:v,height:T}=i,z=!(this.size&&this.size[0]===v&&this.size[1]===T||g),{context:O}=this,{gl:U}=O;if(this.useMipmap=!!(h&&h.useMipmap),U.bindTexture(U.TEXTURE_2D,this.texture),O.pixelStoreUnpackFlipY.set(!1),O.pixelStoreUnpack.set(1),O.pixelStoreUnpackPremultiplyAlpha.set(this.format===U.RGBA&&(!h||h.premultiply!==!1)),z)this.size=[v,T],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||d.b(i)?U.texImage2D(U.TEXTURE_2D,0,this.format,this.format,U.UNSIGNED_BYTE,i):U.texImage2D(U.TEXTURE_2D,0,this.format,v,T,0,this.format,U.UNSIGNED_BYTE,i.data);else{const{x:H,y:Y}=g||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||d.b(i)?U.texSubImage2D(U.TEXTURE_2D,0,H,Y,U.RGBA,U.UNSIGNED_BYTE,i):U.texSubImage2D(U.TEXTURE_2D,0,H,Y,v,T,U.RGBA,U.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&U.generateMipmap(U.TEXTURE_2D)}bind(i,h,g){const{context:v}=this,{gl:T}=v;T.bindTexture(T.TEXTURE_2D,this.texture),g!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=T.LINEAR),i!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,i),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,g||i),this.filter=i),h!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,h),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function Ke(E){const{userImage:i}=E;return!!(i&&i.render&&i.render())&&(E.data.replace(new Uint8Array(i.data.buffer)),!0)}class Mt extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:h,promiseResolve:g}of this.requestors)g(this._getImagesForIds(h));this.requestors=[]}}getImage(i){const h=this.images[i];if(h&&!h.data&&h.spriteData){const g=h.spriteData;h.data=new d.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),h.spriteData=null}return h}addImage(i,h){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,h)&&(this.images[i]=h)}_validate(i,h){let g=!0;const v=h.data||h.spriteData;return this._validateStretch(h.stretchX,v&&v.width)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,v&&v.height)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new d.j(new Error(`Image "${i}" has invalid "content" value`))),g=!1),g}_validateStretch(i,h){if(!i)return!0;let g=0;for(const v of i){if(v[0]<g||v[1]<v[0]||h<v[1])return!1;g=v[1]}return!0}_validateContent(i,h){if(!i)return!0;if(i.length!==4)return!1;const g=h.spriteData,v=g&&g.width||h.data.width,T=g&&g.height||h.data.height;return!(i[0]<0||v<i[0]||i[1]<0||T<i[1]||i[2]<0||v<i[2]||i[3]<0||T<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,h,g=!0){const v=this.getImage(i);if(g&&(v.data.width!==h.data.width||v.data.height!==h.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${h.data.width}x${h.data.height}).`);h.version=v.version+1,this.images[i]=h,this.updatedImages[i]=!0}removeImage(i){const h=this.images[i];delete this.images[i],delete this.patterns[i],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise(((h,g)=>{let v=!0;if(!this.isLoaded())for(const T of i)this.images[T]||(v=!1);this.isLoaded()||v?h(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:h})}))}_getImagesForIds(i){const h={};for(const g of i){let v=this.getImage(g);v||(this.fire(new d.k("styleimagemissing",{id:g})),v=this.getImage(g)),v?h[g]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:d.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return h}getPixelSize(){const{width:i,height:h}=this.atlasImage;return{width:i,height:h}}getPattern(i){const h=this.patterns[i],g=this.getImage(i);if(!g)return null;if(h&&h.position.version===g.version)return h.position;if(h)h.position.version=g.version;else{const v={w:g.data.width+2,h:g.data.height+2,x:0,y:0},T=new d.I(v,g);this.patterns[i]={bin:v,position:T}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const h=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new lt(i,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const T in this.patterns)i.push(this.patterns[T].bin);const{w:h,h:g}=d.p(i),v=this.atlasImage;v.resize({width:h||1,height:g||1});for(const T in this.patterns){const{bin:z}=this.patterns[T],O=z.x+1,U=z.y+1,H=this.getImage(T).data,Y=H.width,X=H.height;d.R.copy(H,v,{x:0,y:0},{x:O,y:U},{width:Y,height:X}),d.R.copy(H,v,{x:0,y:X-1},{x:O,y:U-1},{width:Y,height:1}),d.R.copy(H,v,{x:0,y:0},{x:O,y:U+X},{width:Y,height:1}),d.R.copy(H,v,{x:Y-1,y:0},{x:O-1,y:U},{width:1,height:X}),d.R.copy(H,v,{x:0,y:0},{x:O+Y,y:U},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const h of i){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const g=this.getImage(h);g||d.w(`Image with ID: "${h}" was not found`),Ke(g)&&this.updateImage(h,g)}}}const gt=1e20;function St(E,i,h,g,v,T,z,O,U){for(let H=i;H<i+g;H++)Be(E,h*T+H,T,v,z,O,U);for(let H=h;H<h+v;H++)Be(E,H*T+i,1,g,z,O,U)}function Be(E,i,h,g,v,T,z){T[0]=0,z[0]=-gt,z[1]=gt,v[0]=E[i];for(let O=1,U=0,H=0;O<g;O++){v[O]=E[i+O*h];const Y=O*O;do{const X=T[U];H=(v[O]-v[X]+Y-X*X)/(O-X)/2}while(H<=z[U]&&--U>-1);U++,T[U]=O,z[U]=H,z[U+1]=gt}for(let O=0,U=0;O<g;O++){for(;z[U+1]<O;)U++;const H=T[U],Y=O-H;E[i+O*h]=v[H]+Y*Y}}class ot{constructor(i,h){this.requestManager=i,this.localIdeographFontFamily=h,this.entries={}}setURL(i){this.url=i}getGlyphs(i){return d._(this,void 0,void 0,(function*(){const h=[];for(const T in i)for(const z of i[T])h.push(this._getAndCacheGlyphsPromise(T,z));const g=yield Promise.all(h),v={};for(const{stack:T,id:z,glyph:O}of g)v[T]||(v[T]={}),v[T][z]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};return v}))}_getAndCacheGlyphsPromise(i,h){return d._(this,void 0,void 0,(function*(){let g=this.entries[i];g||(g=this.entries[i]={glyphs:{},requests:{},ranges:{}});let v=g.glyphs[h];if(v!==void 0)return{stack:i,id:h,glyph:v};if(v=this._tinySDF(g,i,h),v)return g.glyphs[h]=v,{stack:i,id:h,glyph:v};const T=Math.floor(h/256);if(256*T>65535)throw new Error("glyphs > 65535 not supported");if(g.ranges[T])return{stack:i,id:h,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!g.requests[T]){const O=ot.loadGlyphRange(i,T,this.url,this.requestManager);g.requests[T]=O}const z=yield g.requests[T];for(const O in z)this._doesCharSupportLocalGlyph(+O)||(g.glyphs[+O]=z[+O]);return g.ranges[T]=!0,{stack:i,id:h,glyph:z[h]||null}}))}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(i))}_tinySDF(i,h,g){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(g))return;let T=i.tinySDF;if(!T){let O="400";/bold/i.test(h)?O="900":/medium/i.test(h)?O="500":/light/i.test(h)&&(O="200"),T=i.tinySDF=new ot.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:v,fontWeight:O})}const z=T.draw(String.fromCharCode(g));return{id:g,bitmap:new d.o({width:z.width||60,height:z.height||60},z.data),metrics:{width:z.glyphWidth/2||24,height:z.glyphHeight/2||24,left:z.glyphLeft/2+.5||0,top:z.glyphTop/2-27.5||-8,advance:z.glyphAdvance/2||24,isDoubleResolution:!0}}}}ot.loadGlyphRange=function(E,i,h,g){return d._(this,void 0,void 0,(function*(){const v=256*i,T=v+255,z=g.transformRequest(h.replace("{fontstack}",E).replace("{range}",`${v}-${T}`),"Glyphs"),O=yield d.l(z,new AbortController);if(!O||!O.data)throw new Error(`Could not load glyph range. range: ${i}, ${v}-${T}`);const U={};for(const H of d.n(O.data))U[H.id]=H;return U}))},ot.TinySDF=class{constructor({fontSize:E=24,buffer:i=3,radius:h=8,cutoff:g=.25,fontFamily:v="sans-serif",fontWeight:T="normal",fontStyle:z="normal"}={}){this.buffer=i,this.cutoff=g,this.radius=h;const O=this.size=E+4*i,U=this._createCanvas(O),H=this.ctx=U.getContext("2d",{willReadFrequently:!0});H.font=`${z} ${T} ${E}px ${v}`,H.textBaseline="alphabetic",H.textAlign="left",H.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Uint16Array(O)}_createCanvas(E){const i=document.createElement("canvas");return i.width=i.height=E,i}draw(E){const{width:i,actualBoundingBoxAscent:h,actualBoundingBoxDescent:g,actualBoundingBoxLeft:v,actualBoundingBoxRight:T}=this.ctx.measureText(E),z=Math.ceil(h),O=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(T-v))),U=Math.min(this.size-this.buffer,z+Math.ceil(g)),H=O+2*this.buffer,Y=U+2*this.buffer,X=Math.max(H*Y,0),oe=new Uint8ClampedArray(X),fe={data:oe,width:H,height:Y,glyphWidth:O,glyphHeight:U,glyphTop:z,glyphLeft:0,glyphAdvance:i};if(O===0||U===0)return fe;const{ctx:_e,buffer:ke,gridInner:Me,gridOuter:Pe}=this;_e.clearRect(ke,ke,O,U),_e.fillText(E,ke,ke+z);const Le=_e.getImageData(ke,ke,O,U);Pe.fill(gt,0,X),Me.fill(0,0,X);for(let Te=0;Te<U;Te++)for(let $e=0;$e<O;$e++){const Ve=Le.data[4*(Te*O+$e)+3]/255;if(Ve===0)continue;const it=(Te+ke)*H+$e+ke;if(Ve===1)Pe[it]=0,Me[it]=gt;else{const bt=.5-Ve;Pe[it]=bt>0?bt*bt:0,Me[it]=bt<0?bt*bt:0}}St(Pe,0,0,H,Y,H,this.f,this.v,this.z),St(Me,ke,ke,O,U,H,this.f,this.v,this.z);for(let Te=0;Te<X;Te++){const $e=Math.sqrt(Pe[Te])-Math.sqrt(Me[Te]);oe[Te]=Math.round(255-255*($e/this.radius+this.cutoff))}return fe}};class Fe{constructor(){this.specification=d.v.light.position}possiblyEvaluate(i,h){return d.x(i.expression.evaluate(h))}interpolate(i,h,g){return{x:d.y.number(i.x,h.x,g),y:d.y.number(i.y,h.y,g),z:d.y.number(i.z,h.z,g)}}}let kt;class rt extends d.E{constructor(i){super(),kt=kt||new d.q({anchor:new d.D(d.v.light.anchor),position:new Fe,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(kt),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,h={}){if(!this._validate(d.r,i,h))for(const g in i){const v=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,g){return(!g||g.validate!==!1)&&d.t(this,i.call(d.u,{value:h,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const be=new d.q({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class Ie extends d.E{constructor(i){super(),this._transitionable=new d.T(be),this.setSky(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.z(0))}setSky(i,h={}){if(!this._validate(d.B,i,h)){i||(i={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in i){const v=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),v):this._transitionable.setValue(g,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,g={}){return g?.validate!==!1&&d.t(this,i.call(d.u,d.e({value:h,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(i){return i<60?0:i<70?(i-60)/10:1}}class et{constructor(i,h){this.width=i,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,h){const g=i.join(",")+String(h);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(i,h)),this.dashEntry[g]}getDashRanges(i,h,g){const v=[];let T=i.length%2==1?-i[i.length-1]*g:0,z=i[0]*g,O=!0;v.push({left:T,right:z,isDash:O,zeroLength:i[0]===0});let U=i[0];for(let H=1;H<i.length;H++){O=!O;const Y=i[H];T=U*g,U+=Y,z=U*g,v.push({left:T,right:z,isDash:O,zeroLength:Y===0})}return v}addRoundDash(i,h,g){const v=h/2;for(let T=-g;T<=g;T++){const z=this.width*(this.nextRow+g+T);let O=0,U=i[O];for(let H=0;H<this.width;H++){H/U.right>1&&(U=i[++O]);const Y=Math.abs(H-U.left),X=Math.abs(H-U.right),oe=Math.min(Y,X);let fe;const _e=T/g*(v+1);if(U.isDash){const ke=v-Math.abs(_e);fe=Math.sqrt(oe*oe+ke*ke)}else fe=v-Math.sqrt(oe*oe+_e*_e);this.data[z+H]=Math.max(0,Math.min(255,fe+128))}}}addRegularDash(i){for(let O=i.length-1;O>=0;--O){const U=i[O],H=i[O+1];U.zeroLength?i.splice(O,1):H&&H.isDash===U.isDash&&(H.left=U.left,i.splice(O,1))}const h=i[0],g=i[i.length-1];h.isDash===g.isDash&&(h.left=g.left-this.width,g.right=h.right+this.width);const v=this.width*this.nextRow;let T=0,z=i[T];for(let O=0;O<this.width;O++){O/z.right>1&&(z=i[++T]);const U=Math.abs(O-z.left),H=Math.abs(O-z.right),Y=Math.min(U,H);this.data[v+O]=Math.max(0,Math.min(255,(z.isDash?Y:-Y)+128))}}addDash(i,h){const g=h?7:0,v=2*g+1;if(this.nextRow+v>this.height)return d.w("LineAtlas out of space"),null;let T=0;for(let O=0;O<i.length;O++)T+=i[O];if(T!==0){const O=this.width/T,U=this.getDashRanges(i,this.width,O);h?this.addRoundDash(U,O,g):this.addRegularDash(U)}const z={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:T};return this.nextRow+=v,this.dirty=!0,z}bind(i){const h=i.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}const at="maplibre_preloaded_worker_pool";class mt{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<mt.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach((h=>{h.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[at]}numActive(){return Object.keys(this.active).length}}const Ct=Math.floor(N.hardwareConcurrency/2);let Ot,Kt;function _i(){return Ot||(Ot=new mt),Ot}mt.workerCount=d.C(globalThis)?Math.max(Math.min(Ct,3),1):1;class Vi{constructor(i,h){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=h;const g=this.workerPool.acquire(h);for(let v=0;v<g.length;v++){const T=new d.F(g[v],h);T.name=`Worker ${v}`,this.actors.push(T)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,h){const g=[];for(const v of this.actors)g.push(v.sendAsync({type:i,data:h}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach((h=>{h.remove()})),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,h){for(const g of this.actors)g.registerMessageHandler(i,h)}}function gi(){return Kt||(Kt=new Vi(_i(),d.G),Kt.registerMessageHandler("GR",((E,i,h)=>d.m(i,h)))),Kt}function Oi(E,i){const h=d.H();return d.J(h,h,[1,1,0]),d.K(h,h,[.5*E.width,.5*E.height,1]),d.L(h,h,E.calculatePosMatrix(i.toUnwrapped()))}function xn(E,i,h,g,v,T){const z=(function(X,oe,fe){if(X)for(const _e of X){const ke=oe[_e];if(ke&&ke.source===fe&&ke.type==="fill-extrusion")return!0}else for(const _e in oe){const ke=oe[_e];if(ke.source===fe&&ke.type==="fill-extrusion")return!0}return!1})(v&&v.layers,i,E.id),O=T.maxPitchScaleFactor(),U=E.tilesIn(g,O,z);U.sort(cn);const H=[];for(const X of U)H.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(i,h,E._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,v,T,O,Oi(E.transform,X.tileID))});const Y=(function(X){const oe={},fe={};for(const _e of X){const ke=_e.queryResults,Me=_e.wrappedTileID,Pe=fe[Me]=fe[Me]||{};for(const Le in ke){const Te=ke[Le],$e=Pe[Le]=Pe[Le]||{},Ve=oe[Le]=oe[Le]||[];for(const it of Te)$e[it.featureIndex]||($e[it.featureIndex]=!0,Ve.push(it))}}return oe})(H);for(const X in Y)Y[X].forEach((oe=>{const fe=oe.feature,_e=E.getFeatureState(fe.layer["source-layer"],fe.id);fe.source=fe.layer.source,fe.layer["source-layer"]&&(fe.sourceLayer=fe.layer["source-layer"]),fe.state=_e}));return Y}function cn(E,i){const h=E.tileID,g=i.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}function Zn(E,i,h){return d._(this,void 0,void 0,(function*(){let g=E;if(E.url?g=(yield d.h(i.transformRequest(E.url,"Source"),h)).data:yield N.frameAsync(h),!g)return null;const v=d.M(d.e(g,E),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(v.vectorLayerIds=g.vector_layers.map((T=>T.id))),v}))}class tt{constructor(i,h){i&&(h?this.setSouthWest(i).setNorthEast(h):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof d.N?new d.N(i.lng,i.lat):d.N.convert(i),this}setSouthWest(i){return this._sw=i instanceof d.N?new d.N(i.lng,i.lat):d.N.convert(i),this}extend(i){const h=this._sw,g=this._ne;let v,T;if(i instanceof d.N)v=i,T=i;else{if(!(i instanceof tt))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(tt.convert(i)):this.extend(d.N.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(d.N.convert(i)):this;if(v=i._sw,T=i._ne,!v||!T)return this}return h||g?(h.lng=Math.min(v.lng,h.lng),h.lat=Math.min(v.lat,h.lat),g.lng=Math.max(T.lng,g.lng),g.lat=Math.max(T.lat,g.lat)):(this._sw=new d.N(v.lng,v.lat),this._ne=new d.N(T.lng,T.lat)),this}getCenter(){return new d.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.N(this.getWest(),this.getNorth())}getSouthEast(){return new d.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:h,lat:g}=d.N.convert(i);let v=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&v}static convert(i){return i instanceof tt?i:i&&new tt(i)}static fromLngLat(i,h=0){const g=360*h/40075017,v=g/Math.cos(Math.PI/180*i.lat);return new tt(new d.N(i.lng-v,i.lat-g),new d.N(i.lng+v,i.lat+g))}adjustAntiMeridian(){const i=new d.N(this._sw.lng,this._sw.lat),h=new d.N(this._ne.lng,this._ne.lat);return new tt(i,i.lng>h.lng?new d.N(h.lng+360,h.lat):h)}}class Xn{constructor(i,h,g){this.bounds=tt.convert(this.validateBounds(i)),this.minzoom=h||0,this.maxzoom=g||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const h=Math.pow(2,i.z),g=Math.floor(d.O(this.bounds.getWest())*h),v=Math.floor(d.Q(this.bounds.getNorth())*h),T=Math.ceil(d.O(this.bounds.getEast())*h),z=Math.ceil(d.Q(this.bounds.getSouth())*h);return i.x>=g&&i.x<T&&i.y>=v&&i.y<z}}class Pn extends d.E{constructor(i,h,g,v){if(super(),this.id=i,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.M(h,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield Zn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(d.e(this,i),i.bounds&&(this.tileBounds=new Xn(i.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new d.j(i))}}))}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}setUrl(i){return this.setSourceProperty((()=>{this.url=i,this._options.url=i})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(h,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};g.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise(((T,z)=>{i.reloadPromise={resolve:T,reject:z}}))}else i.actor=this.dispatcher.getActor(),v="LT";i.abortController=new AbortController;try{const T=yield i.actor.sendAsync({type:v,data:g},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,T)}catch(T){if(delete i.abortController,i.aborted)return;if(T&&T.status!==404)throw T;this._afterTileLoadWorkerResponse(i,null)}}))}_afterTileLoadWorkerResponse(i,h){if(h&&h.resourceTiming&&(i.resourceTiming=h.resourceTiming),h&&this.map._refreshExpiredTiles&&i.setExpiryData(h),i.loadVectorData(h,this.map.painter),i.reloadPromise){const g=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(g.resolve).catch(g.reject)}}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class ki extends d.E{constructor(i,h,g,v){super(),this.id=i,this.dispatcher=g,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},h),d.e(this,d.M(h,["url","scheme","tileSize"]))}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield Zn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(d.e(this,i),i.bounds&&(this.tileBounds=new Xn(i.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new d.j(i))}}))}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load()}setTiles(i){return this.setSourceProperty((()=>{this._options.tiles=i})),this}setUrl(i){return this.setSourceProperty((()=>{this.url=i,this._options.url=i})),this}serialize(){return d.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const g=yield ae.getImage(this.map._requestManager.transformRequest(h,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&i.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const v=this.map.painter.context,T=v.gl,z=g.data;i.texture=this.map.painter.getTileTexture(z.width),i.texture?i.texture.update(z,{useMipmap:!0}):(i.texture=new lt(v,z,T.RGBA,{useMipmap:!0}),i.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST)),i.state="loaded"}}catch(g){if(delete i.abortController,i.aborted)i.state="unloaded";else if(g)throw i.state="errored",g}}))}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)}))}hasTransition(){return!1}}class yi extends ki{constructor(i,h,g,v){super(i,h,g,v),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox",this.redFactor=h.redFactor,this.greenFactor=h.greenFactor,this.blueFactor=h.blueFactor,this.baseShift=h.baseShift}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(h,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const v=yield ae.getImage(g,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(v&&v.data){const T=v.data;this.map._refreshExpiredTiles&&v.cacheControl&&v.expires&&i.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const z=d.b(T)&&d.U()?T:yield this.readImageNow(T),O={type:this.type,uid:i.uid,source:this.id,rawImageData:z,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const U=yield i.actor.sendAsync({type:"LDT",data:O});i.dem=U,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(v){if(delete i.abortController,i.aborted)i.state="unloaded";else if(v)throw i.state="errored",v}}))}readImageNow(i){return d._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&d.V()){const h=i.width+2,g=i.height+2;try{return new d.R({width:h,height:g},yield d.W(i,-1,-1,h,g))}catch{}}return N.getImageData(i,1)}))}_getNeighboringTiles(i){const h=i.canonical,g=Math.pow(2,h.z),v=(h.x-1+g)%g,T=h.x===0?i.wrap-1:i.wrap,z=(h.x+1+g)%g,O=h.x+1===g?i.wrap+1:i.wrap,U={};return U[new d.S(i.overscaledZ,T,h.z,v,h.y).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,z,h.y).key]={backfilled:!1},h.y>0&&(U[new d.S(i.overscaledZ,T,h.z,v,h.y-1).key]={backfilled:!1},U[new d.S(i.overscaledZ,i.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,z,h.y-1).key]={backfilled:!1}),h.y+1<g&&(U[new d.S(i.overscaledZ,T,h.z,v,h.y+1).key]={backfilled:!1},U[new d.S(i.overscaledZ,i.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},U[new d.S(i.overscaledZ,O,h.z,z,h.y+1).key]={backfilled:!1}),U}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))}))}}class Cn extends d.E{constructor(i,h,g,v){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(v),this._data=h.data,this._options=d.e({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const T=d.X/this.tileSize;h.clusterMaxZoom!==void 0&&this.maxzoom<=h.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${h.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*T,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*T,extent:d.X,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:d.X,radius:(h.clusterRadius||50)*T,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return d._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}getData(){return d._(this,void 0,void 0,(function*(){const i=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})}))}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,h,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:h,offset:g}})}_updateWorkerData(i){return d._(this,void 0,void 0,(function*(){const h=d.e({type:this.type},this.workerOptions);i?h.dataDiff=i:typeof this._data=="string"?(h.request=this.map._requestManager.transformRequest(N.resolveURL(this._data),"Source"),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.k("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:h});if(this._pendingLoads--,this._removed||g.abandoned)return void this.fire(new d.k("dataabort",{dataType:"source"}));let v=null;g.resourceTiming&&g.resourceTiming[this.id]&&(v=g.resourceTiming[this.id].slice(0));const T={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&d.e(T,{resourceTiming:v}),this.fire(new d.k("data",Object.assign(Object.assign({},T),{sourceDataType:"metadata"}))),this.fire(new d.k("data",Object.assign(Object.assign({},T),{sourceDataType:"content"})))}catch(g){if(this._pendingLoads--,this._removed)return void this.fire(new d.k("dataabort",{dataType:"source"}));this.fire(new d.j(g))}}))}loaded(){return this._pendingLoads===0}loadTile(i){return d._(this,void 0,void 0,(function*(){const h=i.actor?"RT":"LT";i.actor=this.actor;const g={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.abortController=new AbortController;const v=yield this.actor.sendAsync({type:h,data:g},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(v,this.map.painter,h==="RT")}))}abortTile(i){return d._(this,void 0,void 0,(function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0}))}unloadTile(i){return d._(this,void 0,void 0,(function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ln=d.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class us extends d.E{constructor(i,h,g,v){super(),this.id=i,this.dispatcher=g,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h}load(i){return d._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const h=yield ae.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,h&&h.data&&(this.image=h.data,i&&(this.coordinates=i),this._finishLoading())}catch(h){this._request=null,this._loaded=!0,this.fire(new d.j(h))}}))}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const h=i.map(d.Z.fromLngLat);this.tileID=(function(v){let T=1/0,z=1/0,O=-1/0,U=-1/0;for(const oe of v)T=Math.min(T,oe.x),z=Math.min(z,oe.y),O=Math.max(O,oe.x),U=Math.max(U,oe.y);const H=Math.max(O-T,U-z),Y=Math.max(0,Math.floor(-Math.log(H)/Math.LN2)),X=Math.pow(2,Y);return new d.a1(Y,Math.floor((T+O)/2*X),Math.floor((z+U)/2*X))})(h),this.minzoom=this.maxzoom=this.tileID.z;const g=h.map((v=>this.tileID.getTilePoint(v)._round()));return this._boundsArray=new d.$,this._boundsArray.emplaceBack(g[0].x,g[0].y,0,0),this._boundsArray.emplaceBack(g[1].x,g[1].y,d.X,0),this._boundsArray.emplaceBack(g[3].x,g[3].y,0,d.X),this._boundsArray.emplaceBack(g[2].x,g[2].y,d.X,d.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,h=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Ln.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new lt(i,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));let g=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return d._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class an extends us{constructor(i,h,g,v){super(i,h,g,v),this.roundZoom=!0,this.type="video",this.options=h}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const h of i.urls)this.urls.push(this.map._requestManager.transformRequest(h,"Source").url);try{const h=yield d.a3(this.urls);if(this._loaded=!0,!h)return;this.video=h,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(h){this.fire(new d.j(h))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const h=this.video.seekable;i<h.start(0)||i>h.end(0)?this.fire(new d.j(new d.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,h=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Ln.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new lt(i,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));let g=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class en extends us{constructor(i,h,g,v){super(i,h,g,v),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some((T=>!Array.isArray(T)||T.length!==2||T.some((z=>typeof z!="number"))))||this.fire(new d.j(new d.a2(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.j(new d.a2(`sources.${i}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new d.j(new d.a2(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new d.j(new d.a2(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.j(new d.a2(`sources.${i}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){return d._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context,g=h.gl;this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Ln.members)),this.boundsSegments||(this.boundsSegments=d.a0.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new lt(h,this.canvas,g.RGBA,{premultiply:!0});let v=!1;for(const T in this.tiles){const z=this.tiles[T];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture,v=!0)}v&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const qi={},Fn=E=>{switch(E){case"geojson":return Cn;case"image":return us;case"raster":return ki;case"raster-dem":return yi;case"vector":return Pn;case"video":return an;case"canvas":return en}return qi[E]},Tt="RTLPluginLoaded";class On extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=gi()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch((h=>{throw this.status="error",h}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return d._(this,arguments,void 0,(function*(h,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=N.resolveURL(h),!this.url)throw new Error(`requested url ${h} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return d._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.k(Tt))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let dn=null;function An(){return dn||(dn=new On),dn}class Kn{constructor(i,h){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=d.a4(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const h=i+this.timeAdded;h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,h,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=(function(v,T){const z={};if(!T)return z;for(const O of v){const U=O.layerIds.map((H=>T.getLayer(H))).filter(Boolean);if(U.length!==0){O.layers=U,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map((H=>U.filter((Y=>Y.id===H))[0])));for(const H of U)z[H.id]=O}}return z})(i.buckets,h.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const T=this.buckets[v];if(T instanceof d.a6){if(this.hasSymbolBuckets=!0,!g)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const T=this.buckets[v];if(T instanceof d.a6&&T.hasRTLText){this.hasRTLText=!0,An().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(v).queryRadius(T))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new d.a5}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const g in this.buckets){const v=this.buckets[g];v.uploadPending()&&v.upload(i)}const h=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new lt(i,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new lt(i,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,h,g,v,T,z,O,U,H,Y){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:T,scale:z,tileSize:this.tileSize,pixelPosMatrix:Y,transform:U,params:O,queryPadding:this.queryPadding*H},i,h,g):{}}querySourceFeatures(i,h){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const v=g.loadVTLayers(),T=h&&h.sourceLayer?h.sourceLayer:"",z=v._geojsonTileLayer||v[T];if(!z)return;const O=d.a7(h&&h.filter),{z:U,x:H,y:Y}=this.tileID.canonical,X={z:U,x:H,y:Y};for(let oe=0;oe<z.length;oe++){const fe=z.feature(oe);if(O.needGeometry){const Me=d.a8(fe,!0);if(!O.filter(new d.z(this.tileID.overscaledZ),Me,this.tileID.canonical))continue}else if(!O.filter(new d.z(this.tileID.overscaledZ),fe))continue;const _e=g.getId(fe,T),ke=new d.a9(fe,U,H,Y,_e);ke.tile=X,i.push(ke)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const h=this.expirationTime;if(i.cacheControl){const g=d.aa(i.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const g=Date.now();let v=!1;if(this.expirationTime>g)v=!1;else if(h)if(this.expirationTime<h)v=!0;else{const T=this.expirationTime-h;T?this.expirationTime=g+Math.max(T,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!h.style.hasLayer(v))continue;const T=this.buckets[v],z=T.layers[0].sourceLayer||"_geojsonTileLayer",O=g[z],U=i[z];if(!O||!U||Object.keys(U).length===0)continue;T.update(U,O,this.imageAtlas&&this.imageAtlas.patternPositions||{});const H=h&&h.style&&h.style.getLayer(v);H&&(this.queryPadding=Math.max(this.queryPadding,H.queryRadius(T)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=N.now()+i}setDependencies(i,h){const g={};for(const v of h)g[v]=!0;this.dependencies[i]=g}hasDependency(i,h){for(const g of i){const v=this.dependencies[g];if(v){for(const T of h)if(v[T])return!0}}return!1}}class It{constructor(i,h){this.max=i,this.onRemove=h,this.reset()}reset(){for(const i in this.data)for(const h of this.data[i])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(i,h,g){const v=i.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const T={value:h,timeout:void 0};if(g!==void 0&&(T.timeout=setTimeout((()=>{this.remove(i,T)}),g)),this.data[v].push(T),this.order.push(v),this.order.length>this.max){const z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const h=this.data[i].shift();return h.timeout&&clearTimeout(h.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),h.value}getByKey(i){const h=this.data[i];return h?h[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,h){if(!this.has(i))return this;const g=i.wrapped().key,v=h===void 0?0:this.data[g].indexOf(h),T=this.data[g][v];return this.data[g].splice(v,1),T.timeout&&clearTimeout(T.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(T.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(i){const h=[];for(const g in this.data)for(const v of this.data[g])i(v.value)||h.push(v);for(const g of h)this.remove(g.value.tileID,g)}}class ai{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,h,g){const v=String(h);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][v]=this.stateChanges[i][v]||{},d.e(this.stateChanges[i][v],g),this.deletedStates[i]===null){this.deletedStates[i]={};for(const T in this.state[i])T!==v&&(this.deletedStates[i][T]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][v]===null){this.deletedStates[i][v]={};for(const T in this.state[i][v])g[T]||(this.deletedStates[i][v][T]=null)}else for(const T in g)this.deletedStates[i]&&this.deletedStates[i][v]&&this.deletedStates[i][v][T]===null&&delete this.deletedStates[i][v][T]}removeFeatureState(i,h,g){if(this.deletedStates[i]===null)return;const v=String(h);if(this.deletedStates[i]=this.deletedStates[i]||{},g&&h!==void 0)this.deletedStates[i][v]!==null&&(this.deletedStates[i][v]=this.deletedStates[i][v]||{},this.deletedStates[i][v][g]=null);else if(h!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][v])for(g in this.deletedStates[i][v]={},this.stateChanges[i][v])this.deletedStates[i][v][g]=null;else this.deletedStates[i][v]=null;else this.deletedStates[i]=null}getState(i,h){const g=String(h),v=d.e({},(this.state[i]||{})[g],(this.stateChanges[i]||{})[g]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const T=this.deletedStates[i][h];if(T===null)return{};for(const z in T)delete v[z]}return v}initializeTileState(i,h){i.setFeatureState(this.state,h)}coalesceChanges(i,h){const g={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const T={};for(const z in this.stateChanges[v])this.state[v][z]||(this.state[v][z]={}),d.e(this.state[v][z],this.stateChanges[v][z]),T[z]=this.state[v][z];g[v]=T}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const T={};if(this.deletedStates[v]===null)for(const z in this.state[v])T[z]={},this.state[v][z]={};else for(const z in this.deletedStates[v]){if(this.deletedStates[v][z]===null)this.state[v][z]={};else for(const O of Object.keys(this.deletedStates[v][z]))delete this.state[v][z][O];T[z]=this.state[v][z]}g[v]=g[v]||{},d.e(g[v],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const v in i)i[v].setFeatureState(g,h)}}class ti extends d.E{constructor(i,h,g){super(),this.id=i,this.dispatcher=g,this.on("data",(v=>this._dataHandler(v))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((v,T,z,O)=>{const U=new(Fn(T.type))(v,T,z,O);if(U.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${U.id}`);return U})(i,h,g,this),this._tiles={},this._cache=new It(0,(v=>this._unloadTile(v))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ai,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const h=this._tiles[i];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,h,g){return d._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,h,g)}catch(v){i.state="errored",v.status!==404?this._source.fire(new d.j(v,{tile:i})):this.update(this.transform,this.terrain)}}))}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new d.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const g=this._tiles[h];g.upload(i),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((i=>i.tileID)).sort(Ji).map((i=>i.key))}getRenderableIds(i){const h=[];for(const g in this._tiles)this._isIdRenderable(g,i)&&h.push(this._tiles[g]);return i?h.sort(((g,v)=>{const T=g.tileID,z=v.tileID,O=new d.P(T.canonical.x,T.canonical.y)._rotate(this.transform.angle),U=new d.P(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return T.overscaledZ-z.overscaledZ||U.y-O.y||U.x-O.x})).map((g=>g.tileID.key)):h.map((g=>g.tileID)).sort(Ji).map((g=>g.key))}hasRenderableParent(i){const h=this.findLoadedParent(i,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(i,h){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(h||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,h){return d._(this,void 0,void 0,(function*(){const g=this._tiles[i];g&&(g.state!=="loading"&&(g.state=h),yield this._loadTile(g,i,h))}))}_tileLoaded(i,h,g){i.timeAdded=N.now(),g==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(h,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new d.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const h=this.getRenderableIds();for(let v=0;v<h.length;v++){const T=h[v];if(i.neighboringTiles&&i.neighboringTiles[T]){const z=this.getTileByID(T);g(i,z),g(z,i)}}function g(v,T){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let z=T.tileID.canonical.x-v.tileID.canonical.x;const O=T.tileID.canonical.y-v.tileID.canonical.y,U=Math.pow(2,v.tileID.canonical.z),H=T.tileID.key;z===0&&O===0||Math.abs(O)>1||(Math.abs(z)>1&&(Math.abs(z+U)===1?z+=U:Math.abs(z-U)===1&&(z-=U)),T.dem&&v.dem&&(v.dem.backfillBorder(T.dem,z,O),v.neighboringTiles&&v.neighboringTiles[H]&&(v.neighboringTiles[H].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,h,g,v){for(const T in this._tiles){let z=this._tiles[T];if(v[T]||!z.hasData()||z.tileID.overscaledZ<=h||z.tileID.overscaledZ>g)continue;let O=z.tileID;for(;z&&z.tileID.overscaledZ>h+1;){const H=z.tileID.scaledTo(z.tileID.overscaledZ-1);z=this._tiles[H.key],z&&z.hasData()&&(O=H)}let U=O;for(;U.overscaledZ>h;)if(U=U.scaledTo(U.overscaledZ-1),i[U.key]){v[O.key]=O;break}}}findLoadedParent(i,h){if(i.key in this._loadedParentTiles){const g=this._loadedParentTiles[i.key];return g&&g.tileID.overscaledZ>=h?g:null}for(let g=i.overscaledZ-1;g>=h;g--){const v=i.scaledTo(g),T=this._getLoadedTile(v);if(T)return T}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){const h=this._tiles[i.key];return h&&h.hasData()?h:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const h=Math.ceil(i.width/this._source.tileSize)+1,g=Math.ceil(i.height/this._source.tileSize)+1,v=Math.floor(h*g*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(T)}handleWrapJump(i){const h=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,h){const g={};for(const v in this._tiles){const T=this._tiles[v];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+h),g[T.tileID.key]=T}this._tiles=g;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}_updateCoveredAndRetainedTiles(i,h,g,v,T,z){const O={},U={},H=Object.keys(i),Y=N.now();for(const X of H){const oe=i[X],fe=this._tiles[X];if(!fe||fe.fadeEndTime!==0&&fe.fadeEndTime<=Y)continue;const _e=this.findLoadedParent(oe,h),ke=this.findLoadedSibling(oe),Me=_e||ke||null;Me&&(this._addTile(Me.tileID),O[Me.tileID.key]=Me.tileID),U[X]=oe}this._retainLoadedChildren(U,v,g,i);for(const X in O)i[X]||(this._coveredTiles[X]=!0,i[X]=O[X]);if(z){const X={},oe={};for(const fe of T)this._tiles[fe.key].hasData()?X[fe.key]=fe:oe[fe.key]=fe;for(const fe in oe){const _e=oe[fe].children(this._source.maxzoom);this._tiles[_e[0].key]&&this._tiles[_e[1].key]&&this._tiles[_e[2].key]&&this._tiles[_e[3].key]&&(X[_e[0].key]=i[_e[0].key]=_e[0],X[_e[1].key]=i[_e[1].key]=_e[1],X[_e[2].key]=i[_e[2].key]=_e[2],X[_e[3].key]=i[_e[3].key]=_e[3],delete oe[fe])}for(const fe in oe){const _e=oe[fe],ke=this.findLoadedParent(_e,this._source.minzoom),Me=this.findLoadedSibling(_e),Pe=ke||Me||null;if(Pe){X[Pe.tileID.key]=i[Pe.tileID.key]=Pe.tileID;for(const Le in X)X[Le].isChildOf(Pe.tileID)&&delete X[Le]}}for(const fe in this._tiles)X[fe]||(this._coveredTiles[fe]=!0)}}update(i,h){if(!this._sourceLoaded||this._paused)return;let g;this.transform=i,this.terrain=h,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=i.getVisibleUnwrappedCoordinates(this._source.tileID).map((Y=>new d.S(Y.canonical.z,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y))):(g=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:h}),this._source.hasTile&&(g=g.filter((Y=>this._source.hasTile(Y))))):g=[];const v=i.coveringZoomLevel(this._source),T=Math.max(v-ti.maxOverzooming,this._source.minzoom),z=Math.max(v+ti.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Y={};for(const X of g)if(X.canonical.z>this._source.minzoom){const oe=X.scaledTo(X.canonical.z-1);Y[oe.key]=oe;const fe=X.scaledTo(Math.max(this._source.minzoom,Math.min(X.canonical.z,5)));Y[fe.key]=fe}g=g.concat(Object.values(Y))}const O=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,O&&this.fire(new d.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const U=this._updateRetainedTiles(g,v);Nn(this._source.type)&&this._updateCoveredAndRetainedTiles(U,T,z,v,g,h);for(const Y in U)this._tiles[Y].clearFadeHold();const H=d.ab(this._tiles,U);for(const Y of H){const X=this._tiles[Y];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile(Y)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,h){var g;const v={},T={},z=Math.max(h-ti.maxOverzooming,this._source.minzoom),O=Math.max(h+ti.maxUnderzooming,this._source.minzoom),U={};for(const H of i){const Y=this._addTile(H);v[H.key]=H,Y.hasData()||h<this._source.maxzoom&&(U[H.key]=H)}this._retainLoadedChildren(U,h,O,v);for(const H of i){let Y=this._tiles[H.key];if(Y.hasData())continue;if(h+1>this._source.maxzoom){const oe=H.children(this._source.maxzoom)[0],fe=this.getTile(oe);if(fe&&fe.hasData()){v[oe.key]=oe;continue}}else{const oe=H.children(this._source.maxzoom);if(v[oe[0].key]&&v[oe[1].key]&&v[oe[2].key]&&v[oe[3].key])continue}let X=Y.wasRequested();for(let oe=H.overscaledZ-1;oe>=z;--oe){const fe=H.scaledTo(oe);if(T[fe.key])break;if(T[fe.key]=!0,Y=this.getTile(fe),!Y&&X&&(Y=this._addTile(fe)),Y){const _e=Y.hasData();if((_e||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||X)&&(v[fe.key]=fe),X=Y.wasRequested(),_e)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const h=[];let g,v=this._tiles[i].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){g=this._loadedParentTiles[v.key];break}h.push(v.key);const T=v.scaledTo(v.overscaledZ-1);if(g=this._getLoadedTile(T),g)break;v=T}for(const T of h)this._loadedParentTiles[T]=g}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const i in this._tiles){const h=this._tiles[i].tileID,g=this._getLoadedTile(h);this._loadedSiblingTiles[h.key]=g}}_addTile(i){let h=this._tiles[i.key];if(h)return h;h=this._cache.getAndRemove(i),h&&(this._setTileReloadTimer(i.key,h),h.tileID=i,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,h)));const g=h;return h||(h=new Kn(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(h,i.key,h.state)),h.uses++,this._tiles[i.key]=h,g||this._source.fire(new d.k("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(i,h){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const g=h.getExpiryTimeout();g&&(this._timers[i]=setTimeout((()=>{this._reloadTile(i,"expired"),delete this._timers[i]}),g))}_removeTile(i){const h=this._tiles[i];h&&(h.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}_dataHandler(i){const h=i.sourceDataType;i.dataType==="source"&&h==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&h==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,h,g){const v=[],T=this.transform;if(!T)return v;const z=g?T.getCameraQueryGeometry(i):i,O=i.map((_e=>T.pointCoordinate(_e,this.terrain))),U=z.map((_e=>T.pointCoordinate(_e,this.terrain))),H=this.getIds();let Y=1/0,X=1/0,oe=-1/0,fe=-1/0;for(const _e of U)Y=Math.min(Y,_e.x),X=Math.min(X,_e.y),oe=Math.max(oe,_e.x),fe=Math.max(fe,_e.y);for(let _e=0;_e<H.length;_e++){const ke=this._tiles[H[_e]];if(ke.holdingForFade())continue;const Me=ke.tileID,Pe=Math.pow(2,T.zoom-ke.tileID.overscaledZ),Le=h*ke.queryPadding*d.X/ke.tileSize/Pe,Te=[Me.getTilePoint(new d.Z(Y,X)),Me.getTilePoint(new d.Z(oe,fe))];if(Te[0].x-Le<d.X&&Te[0].y-Le<d.X&&Te[1].x+Le>=0&&Te[1].y+Le>=0){const $e=O.map((it=>Me.getTilePoint(it))),Ve=U.map((it=>Me.getTilePoint(it)));v.push({tile:ke,tileID:Me,queryGeometry:$e,cameraQueryGeometry:Ve,scale:Pe})}}return v}getVisibleCoordinates(i){const h=this.getRenderableIds(i).map((g=>this._tiles[g].tileID));for(const g of h)g.posMatrix=this.transform.calculatePosMatrix(g.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(Nn(this._source.type)){const i=N.now();for(const h in this._tiles)if(this._tiles[h].fadeEndTime>=i)return!0}return!1}setFeatureState(i,h,g){this._state.updateState(i=i||"_geojsonTileLayer",h,g)}removeFeatureState(i,h,g){this._state.removeFeatureState(i=i||"_geojsonTileLayer",h,g)}getFeatureState(i,h){return this._state.getState(i=i||"_geojsonTileLayer",h)}setDependencies(i,h,g){const v=this._tiles[i];v&&v.setDependencies(h,g)}reloadTilesForDependencies(i,h){for(const g in this._tiles)this._tiles[g].hasDependency(i,h)&&this._reloadTile(g,"reloading");this._cache.filter((g=>!g.hasDependency(i,h)))}}function Ji(E,i){const h=Math.abs(2*E.wrap)-+(E.wrap<0),g=Math.abs(2*i.wrap)-+(i.wrap<0);return E.overscaledZ-i.overscaledZ||g-h||i.canonical.y-E.canonical.y||i.canonical.x-E.canonical.x}function Nn(E){return E==="raster"||E==="image"||E==="video"}ti.maxOverzooming=10,ti.maxUnderzooming=3;class mi{constructor(i,h){this.reset(i,h)}reset(i,h){this.points=i||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=d.ac(i,0,1);let h=1,g=this._distances[h];const v=i*this.paddedLength+this.padding;for(;g<v&&h<this._distances.length;)g=this._distances[++h];const T=h-1,z=this._distances[T],O=g-z,U=O>0?(v-z)/O:0;return this.points[T].mult(1-U).add(this.points[h].mult(U))}}function Bt(E,i){let h=!0;return E==="always"||E!=="never"&&i!=="never"||(h=!1),h}class hi{constructor(i,h,g){const v=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(i/g),this.yCellCount=Math.ceil(h/g);for(let z=0;z<this.xCellCount*this.yCellCount;z++)v.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=h,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,h,g,v,T){this._forEachCell(h,g,v,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(v),this.bboxes.push(T)}insertCircle(i,h,g,v){this._forEachCell(h-v,g-v,h+v,g+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(h),this.circles.push(g),this.circles.push(v)}_insertBoxCell(i,h,g,v,T,z){this.boxCells[T].push(z)}_insertCircleCell(i,h,g,v,T,z){this.circleCells[T].push(z)}_query(i,h,g,v,T,z,O){if(g<0||i>this.width||v<0||h>this.height)return[];const U=[];if(i<=0&&h<=0&&this.width<=g&&this.height<=v){if(T)return[{key:null,x1:i,y1:h,x2:g,y2:v}];for(let H=0;H<this.boxKeys.length;H++)U.push({key:this.boxKeys[H],x1:this.bboxes[4*H],y1:this.bboxes[4*H+1],x2:this.bboxes[4*H+2],y2:this.bboxes[4*H+3]});for(let H=0;H<this.circleKeys.length;H++){const Y=this.circles[3*H],X=this.circles[3*H+1],oe=this.circles[3*H+2];U.push({key:this.circleKeys[H],x1:Y-oe,y1:X-oe,x2:Y+oe,y2:X+oe})}}else this._forEachCell(i,h,g,v,this._queryCell,U,{hitTest:T,overlapMode:z,seenUids:{box:{},circle:{}}},O);return U}query(i,h,g,v){return this._query(i,h,g,v,!1,null)}hitTest(i,h,g,v,T,z){return this._query(i,h,g,v,!0,T,z).length>0}hitTestCircle(i,h,g,v,T){const z=i-g,O=i+g,U=h-g,H=h+g;if(O<0||z>this.width||H<0||U>this.height)return!1;const Y=[];return this._forEachCell(z,U,O,H,this._queryCellCircle,Y,{hitTest:!0,overlapMode:v,circle:{x:i,y:h,radius:g},seenUids:{box:{},circle:{}}},T),Y.length>0}_queryCell(i,h,g,v,T,z,O,U){const{seenUids:H,hitTest:Y,overlapMode:X}=O,oe=this.boxCells[T];if(oe!==null){const _e=this.bboxes;for(const ke of oe)if(!H.box[ke]){H.box[ke]=!0;const Me=4*ke,Pe=this.boxKeys[ke];if(i<=_e[Me+2]&&h<=_e[Me+3]&&g>=_e[Me+0]&&v>=_e[Me+1]&&(!U||U(Pe))&&(!Y||!Bt(X,Pe.overlapMode))&&(z.push({key:Pe,x1:_e[Me],y1:_e[Me+1],x2:_e[Me+2],y2:_e[Me+3]}),Y))return!0}}const fe=this.circleCells[T];if(fe!==null){const _e=this.circles;for(const ke of fe)if(!H.circle[ke]){H.circle[ke]=!0;const Me=3*ke,Pe=this.circleKeys[ke];if(this._circleAndRectCollide(_e[Me],_e[Me+1],_e[Me+2],i,h,g,v)&&(!U||U(Pe))&&(!Y||!Bt(X,Pe.overlapMode))){const Le=_e[Me],Te=_e[Me+1],$e=_e[Me+2];if(z.push({key:Pe,x1:Le-$e,y1:Te-$e,x2:Le+$e,y2:Te+$e}),Y)return!0}}}return!1}_queryCellCircle(i,h,g,v,T,z,O,U){const{circle:H,seenUids:Y,overlapMode:X}=O,oe=this.boxCells[T];if(oe!==null){const _e=this.bboxes;for(const ke of oe)if(!Y.box[ke]){Y.box[ke]=!0;const Me=4*ke,Pe=this.boxKeys[ke];if(this._circleAndRectCollide(H.x,H.y,H.radius,_e[Me+0],_e[Me+1],_e[Me+2],_e[Me+3])&&(!U||U(Pe))&&!Bt(X,Pe.overlapMode))return z.push(!0),!0}}const fe=this.circleCells[T];if(fe!==null){const _e=this.circles;for(const ke of fe)if(!Y.circle[ke]){Y.circle[ke]=!0;const Me=3*ke,Pe=this.circleKeys[ke];if(this._circlesCollide(_e[Me],_e[Me+1],_e[Me+2],H.x,H.y,H.radius)&&(!U||U(Pe))&&!Bt(X,Pe.overlapMode))return z.push(!0),!0}}}_forEachCell(i,h,g,v,T,z,O,U){const H=this._convertToXCellCoord(i),Y=this._convertToYCellCoord(h),X=this._convertToXCellCoord(g),oe=this._convertToYCellCoord(v);for(let fe=H;fe<=X;fe++)for(let _e=Y;_e<=oe;_e++)if(T.call(this,i,h,g,v,this.xCellCount*_e+fe,z,O,U))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,h,g,v,T,z){const O=v-i,U=T-h,H=g+z;return H*H>O*O+U*U}_circleAndRectCollide(i,h,g,v,T,z,O){const U=(z-v)/2,H=Math.abs(i-(v+U));if(H>U+g)return!1;const Y=(O-T)/2,X=Math.abs(h-(T+Y));if(X>Y+g)return!1;if(H<=U||X<=Y)return!0;const oe=H-U,fe=X-Y;return oe*oe+fe*fe<=g*g}}function Ci(E,i,h,g,v){const T=d.H();return i?(d.K(T,T,[1/v,1/v,1]),h||d.ad(T,T,g.angle)):d.L(T,g.labelPlaneMatrix,E),T}function bi(E,i,h,g,v){if(i){const T=d.ae(E);return d.K(T,T,[v,v,1]),h||d.ad(T,T,-g.angle),T}return g.glCoordMatrix}function xe(E,i,h,g){let v;g?(v=[E,i,g(E,i),1],d.af(v,v,h)):(v=[E,i,0,1],$t(v,v,h));const T=v[3];return{point:new d.P(v[0]/T,v[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}function ee(E,i){return .5+E/i*.5}function Q(E,i){return E.x>=-i[0]&&E.x<=i[0]&&E.y>=-i[1]&&E.y<=i[1]}function ue(E,i,h,g,v,T,z,O,U,H,Y,X,oe,fe,_e){const ke=g?E.textSizeData:E.iconSizeData,Me=d.ag(ke,h.transform.zoom),Pe=[256/h.width*2+1,256/h.height*2+1],Le=g?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;Le.clear();const Te=E.lineVertexArray,$e=g?E.text.placedSymbolArray:E.icon.placedSymbolArray,Ve=h.transform.width/h.transform.height;let it=!1;for(let bt=0;bt<$e.length;bt++){const Ut=$e.get(bt);if(Ut.hidden||Ut.writingMode===d.ah.vertical&&!it){si(Ut.numGlyphs,Le);continue}it=!1;const qt=xe(Ut.anchorX,Ut.anchorY,i,_e);if(!Q(qt.point,Pe)){si(Ut.numGlyphs,Le);continue}const ii=ee(h.transform.cameraToCenterDistance,qt.signedDistanceFromCamera),Ht=d.ai(ke,Me,Ut),Ft=z?Ht/ii:Ht*ii,oi={getElevation:_e,labelPlaneMatrix:v,lineVertexArray:Te,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:H,tileAnchorPoint:new d.P(Ut.anchorX,Ut.anchorY),unwrappedTileID:Y,width:X,height:oe,translation:fe},ji=Oe(oi,Ut,Ft,!1,O,i,T,E.glyphOffsetArray,Le,Ve,U);it=ji.useVertical,(ji.notEnoughRoom||it||ji.needsFlipping&&Oe(oi,Ut,Ft,!0,O,i,T,E.glyphOffsetArray,Le,Ve,U).notEnoughRoom)&&si(Ut.numGlyphs,Le)}g?E.text.dynamicLayoutVertexBuffer.updateData(Le):E.icon.dynamicLayoutVertexBuffer.updateData(Le)}function we(E,i,h,g,v,T,z,O){const U=T.glyphStartIndex+T.numGlyphs,H=T.lineStartIndex,Y=T.lineStartIndex+T.lineLength,X=i.getoffsetX(T.glyphStartIndex),oe=i.getoffsetX(U-1),fe=nt(E*X,h,g,v,T.segment,H,Y,O,z);if(!fe)return null;const _e=nt(E*oe,h,g,v,T.segment,H,Y,O,z);return _e?O.projectionCache.anyProjectionOccluded?null:{first:fe,last:_e}:null}function je(E,i,h,g){return E===d.ah.horizontal&&Math.abs(h.y-i.y)>Math.abs(h.x-i.x)*g?{useVertical:!0}:(E===d.ah.vertical?i.y<h.y:i.x>h.x)?{needsFlipping:!0}:null}function Oe(E,i,h,g,v,T,z,O,U,H,Y){const X=h/24,oe=i.lineOffsetX*X,fe=i.lineOffsetY*X;let _e;if(i.numGlyphs>1){const ke=i.glyphStartIndex+i.numGlyphs,Me=i.lineStartIndex,Pe=i.lineStartIndex+i.lineLength,Le=we(X,O,oe,fe,g,i,Y,E);if(!Le)return{notEnoughRoom:!0};const Te=xe(Le.first.point.x,Le.first.point.y,z,E.getElevation).point,$e=xe(Le.last.point.x,Le.last.point.y,z,E.getElevation).point;if(v&&!g){const Ve=je(i.writingMode,Te,$e,H);if(Ve)return Ve}_e=[Le.first];for(let Ve=i.glyphStartIndex+1;Ve<ke-1;Ve++)_e.push(nt(X*O.getoffsetX(Ve),oe,fe,g,i.segment,Me,Pe,E,Y));_e.push(Le.last)}else{if(v&&!g){const Me=xe(E.tileAnchorPoint.x,E.tileAnchorPoint.y,T,E.getElevation).point,Pe=i.lineStartIndex+i.segment+1,Le=new d.P(E.lineVertexArray.getx(Pe),E.lineVertexArray.gety(Pe)),Te=xe(Le.x,Le.y,T,E.getElevation),$e=Te.signedDistanceFromCamera>0?Te.point:(function(it,bt,Ut,qt,ii,Ht){return qe(it,bt,Ut,1,ii,Ht)})(E.tileAnchorPoint,Le,Me,0,T,E),Ve=je(i.writingMode,Me,$e,H);if(Ve)return Ve}const ke=nt(X*O.getoffsetX(i.glyphStartIndex),oe,fe,g,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,E,Y);if(!ke||E.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};_e=[ke]}for(const ke of _e)d.aj(U,ke.point,ke.angle);return{}}function qe(E,i,h,g,v,T){const z=E.add(E.sub(i)._unit()),O=v!==void 0?xe(z.x,z.y,v,T.getElevation).point:Je(z.x,z.y,T).point,U=h.sub(O);return h.add(U._mult(g/U.mag()))}function de(E,i,h){const g=i.projectionCache;if(g.projections[E])return g.projections[E];const v=new d.P(i.lineVertexArray.getx(E),i.lineVertexArray.gety(E)),T=Je(v.x,v.y,i);if(T.signedDistanceFromCamera>0)return g.projections[E]=T.point,g.anyProjectionOccluded=g.anyProjectionOccluded||T.isOccluded,T.point;const z=E-h.direction;return(function(O,U,H,Y,X){return qe(O,U,H,Y,void 0,X)})(h.distanceFromAnchor===0?i.tileAnchorPoint:new d.P(i.lineVertexArray.getx(z),i.lineVertexArray.gety(z)),v,h.previousVertex,h.absOffsetX-h.distanceFromAnchor+1,i)}function Je(E,i,h){const g=E+h.translation[0],v=i+h.translation[1];let T;return!h.pitchWithMap&&h.projection.useSpecialProjectionForSymbols?(T=h.projection.projectTileCoordinates(g,v,h.unwrappedTileID,h.getElevation),T.point.x=(.5*T.point.x+.5)*h.width,T.point.y=(.5*-T.point.y+.5)*h.height):(T=xe(g,v,h.labelPlaneMatrix,h.getElevation),T.isOccluded=!1),T}function ct(E,i,h){return E._unit()._perp()._mult(i*h)}function Ye(E,i,h,g,v,T,z,O,U){if(O.projectionCache.offsets[E])return O.projectionCache.offsets[E];const H=h.add(i);if(E+U.direction<g||E+U.direction>=v)return O.projectionCache.offsets[E]=H,H;const Y=de(E+U.direction,O,U),X=ct(Y.sub(h),z,U.direction),oe=h.add(X),fe=Y.add(X);return O.projectionCache.offsets[E]=d.ak(T,H,oe,fe)||H,O.projectionCache.offsets[E]}function nt(E,i,h,g,v,T,z,O,U){const H=g?E-i:E+i;let Y=H>0?1:-1,X=0;g&&(Y*=-1,X=Math.PI),Y<0&&(X+=Math.PI);let oe,fe=Y>0?T+v:T+v+1;O.projectionCache.cachedAnchorPoint?oe=O.projectionCache.cachedAnchorPoint:(oe=Je(O.tileAnchorPoint.x,O.tileAnchorPoint.y,O).point,O.projectionCache.cachedAnchorPoint=oe);let _e,ke,Me=oe,Pe=oe,Le=0,Te=0;const $e=Math.abs(H),Ve=[];let it;for(;Le+Te<=$e;){if(fe+=Y,fe<T||fe>=z)return null;Le+=Te,Pe=Me,ke=_e;const qt={absOffsetX:$e,direction:Y,distanceFromAnchor:Le,previousVertex:Pe};if(Me=de(fe,O,qt),h===0)Ve.push(Pe),it=Me.sub(Pe);else{let ii;const Ht=Me.sub(Pe);ii=Ht.mag()===0?ct(de(fe+Y,O,qt).sub(Me),h,Y):ct(Ht,h,Y),ke||(ke=Pe.add(ii)),_e=Ye(fe,ii,Me,T,z,ke,h,O,qt),Ve.push(ke),it=_e.sub(ke)}Te=it.mag()}const bt=it._mult(($e-Le)/Te)._add(ke||Pe),Ut=X+Math.atan2(Me.y-Pe.y,Me.x-Pe.x);return Ve.push(bt),{point:bt,angle:U?Ut:0,path:Ve}}const ei=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function si(E,i){for(let h=0;h<E;h++){const g=i.length;i.resize(g+4),i.float32.set(ei,3*g)}}function $t(E,i,h){const g=i[0],v=i[1];return E[0]=h[0]*g+h[4]*v+h[12],E[1]=h[1]*g+h[5]*v+h[13],E[3]=h[3]*g+h[7]*v+h[15],E}const At=100;class ni{constructor(i,h,g=new hi(i.width+200,i.height+200,25),v=new hi(i.width+200,i.height+200,25)){this.transform=i,this.mapProjection=h,this.grid=g,this.ignoredGrid=v,this.pitchFactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+At,this.screenBottomBoundary=i.height+At,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,h,g,v,T,z,O,U,H,Y,X){const oe=i.anchorPointX+U[0],fe=i.anchorPointY+U[1],_e=this.projectAndGetPerspectiveRatio(v,oe,fe,T,Y),ke=g*_e.perspectiveRatio;let Me;if(z||O)Me=this._projectCollisionBox(i,ke,v,T,z,O,U,_e,Y,X);else{const Ve=_e.point.x+(X?X.x*ke:0),it=_e.point.y+(X?X.y*ke:0);Me={allPointsOccluded:!1,box:[Ve+i.x1*ke,it+i.y1*ke,Ve+i.x2*ke,it+i.y2*ke]}}const[Pe,Le,Te,$e]=Me.box;return this.mapProjection.useSpecialProjectionForSymbols&&(z?Me.allPointsOccluded:this.mapProjection.isOccluded(oe,fe,T))||_e.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Pe,Le,Te,$e)||h!=="always"&&this.grid.hitTest(Pe,Le,Te,$e,h,H)?{box:[Pe,Le,Te,$e],placeable:!1,offscreen:!1}:{box:[Pe,Le,Te,$e],placeable:!0,offscreen:this.isOffscreen(Pe,Le,Te,$e)}}placeCollisionCircles(i,h,g,v,T,z,O,U,H,Y,X,oe,fe,_e,ke,Me){const Pe=[],Le=new d.P(h.anchorX,h.anchorY),Te=this.getPerspectiveRatio(z,Le.x,Le.y,O,Me),$e=(X?T/Te:T*Te)/d.ap,Ve={getElevation:Me,labelPlaneMatrix:U,lineVertexArray:g,pitchWithMap:X,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:Le,unwrappedTileID:O,width:this.transform.width,height:this.transform.height,translation:ke},it=we($e,v,h.lineOffsetX*$e,h.lineOffsetY*$e,!1,h,!1,Ve);let bt=!1,Ut=!1,qt=!0;if(it){const ii=.5*fe*Te+_e,Ht=new d.P(-100,-100),Ft=new d.P(this.screenRightBoundary,this.screenBottomBoundary),oi=new mi,ji=it.first,Zt=it.last;let Xt=[];for(let Xi=ji.path.length-1;Xi>=1;Xi--)Xt.push(ji.path[Xi]);for(let Xi=1;Xi<Zt.path.length;Xi++)Xt.push(Zt.path[Xi]);const Ii=2.5*ii;if(H){const Xi=this.projectPathToScreenSpace(Xt,Ve,H);Xt=Xi.some((un=>un.signedDistanceFromCamera<=0))?[]:Xi.map((un=>un.point))}let Vn=[];if(Xt.length>0){const Xi=Xt[0].clone(),un=Xt[0].clone();for(let $n=1;$n<Xt.length;$n++)Xi.x=Math.min(Xi.x,Xt[$n].x),Xi.y=Math.min(Xi.y,Xt[$n].y),un.x=Math.max(un.x,Xt[$n].x),un.y=Math.max(un.y,Xt[$n].y);Vn=Xi.x>=Ht.x&&un.x<=Ft.x&&Xi.y>=Ht.y&&un.y<=Ft.y?[Xt]:un.x<Ht.x||Xi.x>Ft.x||un.y<Ht.y||Xi.y>Ft.y?[]:d.al([Xt],Ht.x,Ht.y,Ft.x,Ft.y)}for(const Xi of Vn){oi.reset(Xi,.25*ii);let un=0;un=oi.length<=.5*ii?1:Math.ceil(oi.paddedLength/Ii)+1;for(let $n=0;$n<un;$n++){const Qs=$n/Math.max(un-1,1),Ha=oi.lerp(Qs),Jn=Ha.x+At,Lr=Ha.y+At;Pe.push(Jn,Lr,ii,0);const rs=Jn-ii,as=Lr-ii,Ms=Jn+ii,Za=Lr+ii;if(qt=qt&&this.isOffscreen(rs,as,Ms,Za),Ut=Ut||this.isInsideGrid(rs,as,Ms,Za),i!=="always"&&this.grid.hitTestCircle(Jn,Lr,ii,i,oe)&&(bt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:bt}}}}return{circles:!Y&&bt||!Ut||Te<this.perspectiveRatioCutoff?[]:Pe,offscreen:qt,collisionDetected:bt}}projectPathToScreenSpace(i,h,g){return i.map((v=>xe(v.x,v.y,g,h.getElevation)))}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let g=1/0,v=1/0,T=-1/0,z=-1/0;for(const Y of i){const X=new d.P(Y.x+At,Y.y+At);g=Math.min(g,X.x),v=Math.min(v,X.y),T=Math.max(T,X.x),z=Math.max(z,X.y),h.push(X)}const O=this.grid.query(g,v,T,z).concat(this.ignoredGrid.query(g,v,T,z)),U={},H={};for(const Y of O){const X=Y.key;if(U[X.bucketInstanceId]===void 0&&(U[X.bucketInstanceId]={}),U[X.bucketInstanceId][X.featureIndex])continue;const oe=[new d.P(Y.x1,Y.y1),new d.P(Y.x2,Y.y1),new d.P(Y.x2,Y.y2),new d.P(Y.x1,Y.y2)];d.am(h,oe)&&(U[X.bucketInstanceId][X.featureIndex]=!0,H[X.bucketInstanceId]===void 0&&(H[X.bucketInstanceId]=[]),H[X.bucketInstanceId].push(X.featureIndex))}return H}insertCollisionBox(i,h,g,v,T,z){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:T,collisionGroupID:z,overlapMode:h},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,h,g,v,T,z){const O=g?this.ignoredGrid:this.grid,U={bucketInstanceId:v,featureIndex:T,collisionGroupID:z,overlapMode:h};for(let H=0;H<i.length;H+=4)O.insertCircle(U,i[H],i[H+1],i[H+2])}projectAndGetPerspectiveRatio(i,h,g,v,T){let z;T?(z=[h,g,T(h,g),1],d.af(z,z,i)):(z=[h,g,0,1],$t(z,z,i));const O=z[3];return{point:new d.P((z[0]/O+1)/2*this.transform.width+At,(-z[1]/O+1)/2*this.transform.height+At),perspectiveRatio:.5+this.transform.cameraToCenterDistance/O*.5,isOccluded:!1,signedDistanceFromCamera:O}}getPerspectiveRatio(i,h,g,v,T){const z=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(h,g,v,T):xe(h,g,i,T);return .5+this.transform.cameraToCenterDistance/z.signedDistanceFromCamera*.5}isOffscreen(i,h,g,v){return g<At||i>=this.screenRightBoundary||v<At||h>this.screenBottomBoundary}isInsideGrid(i,h,g,v){return g>=0&&i<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const i=d.an([]);return d.J(i,i,[-100,-100,0]),i}_projectCollisionBox(i,h,g,v,T,z,O,U,H,Y){let X=new d.P(1,0),oe=new d.P(0,1);const fe=new d.P(i.anchorPointX+O[0],i.anchorPointY+O[1]);if(z&&!T){const qt=this.projectAndGetPerspectiveRatio(g,fe.x+1,fe.y,v,H).point.sub(U.point).unit(),ii=Math.atan(qt.y/qt.x)+(qt.x<0?Math.PI:0),Ht=Math.sin(ii),Ft=Math.cos(ii);X=new d.P(Ft,Ht),oe=new d.P(-Ht,Ft)}else if(!z&&T){const qt=-this.transform.angle,ii=Math.sin(qt),Ht=Math.cos(qt);X=new d.P(Ht,ii),oe=new d.P(-ii,Ht)}let _e=U.point,ke=h;if(T){_e=fe;const qt=this.transform.zoom-Math.floor(this.transform.zoom);ke=Math.pow(2,-qt),ke*=this.mapProjection.getPitchedTextCorrection(this.transform,fe,v),Y||(ke*=d.ac(.5+U.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}Y&&(_e=_e.add(X.mult(Y.x*ke)).add(oe.mult(Y.y*ke)));const Me=i.x1*ke,Pe=i.x2*ke,Le=(Me+Pe)/2,Te=i.y1*ke,$e=i.y2*ke,Ve=(Te+$e)/2,it=[{offsetX:Me,offsetY:Te},{offsetX:Le,offsetY:Te},{offsetX:Pe,offsetY:Te},{offsetX:Pe,offsetY:Ve},{offsetX:Pe,offsetY:$e},{offsetX:Le,offsetY:$e},{offsetX:Me,offsetY:$e},{offsetX:Me,offsetY:Ve}];let bt=[];for(const{offsetX:qt,offsetY:ii}of it)bt.push(new d.P(_e.x+X.x*qt+oe.x*ii,_e.y+X.y*qt+oe.y*ii));let Ut=!1;if(T){const qt=bt.map((ii=>this.projectAndGetPerspectiveRatio(g,ii.x,ii.y,v,H)));Ut=qt.some((ii=>!ii.isOccluded)),bt=qt.map((ii=>ii.point))}else Ut=!0;return{box:d.ao(bt),allPointsOccluded:!Ut}}}function vi(E,i,h){return i*(d.X/(E.tileSize*Math.pow(2,h-E.tileID.overscaledZ)))}class Bi{constructor(i,h,g,v){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?h:-h))):v&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class _t{constructor(i,h,g,v,T){this.text=new Bi(i?i.text:null,h,g,T),this.icon=new Bi(i?i.icon:null,h,v,T)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class xt{constructor(i,h,g){this.text=i,this.icon=h,this.skipFade=g}}class Wt{constructor(){this.invProjMatrix=d.H(),this.viewportMatrix=d.H(),this.circles=[]}}class pi{constructor(i,h,g,v,T){this.bucketInstanceId=i,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=v,this.tileID=T}}class Ne{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const h=++this.maxGroupID;this.collisionGroups[i]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[i]}}function zt(E,i,h,g,v){const{horizontalAlign:T,verticalAlign:z}=d.au(E);return new d.P(-(T-.5)*i+g[0]*v,-(z-.5)*h+g[1]*v)}class Jt{constructor(i,h,g,v,T,z){this.transform=i.clone(),this.terrain=g,this.collisionIndex=new ni(this.transform,h),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new Ne(T),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=z,z&&(z.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const h=this.terrain;return h?(g,v)=>h.getElevation(i,g,v):null}getBucketParts(i,h,g,v){const T=g.getBucket(h),z=g.latestFeatureIndex;if(!T||!z||h.id!==T.layerIds[0])return;const O=g.collisionBoxArray,U=T.layers[0].layout,H=T.layers[0].paint,Y=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),X=g.tileSize/d.X,oe=g.tileID.toUnwrapped(),fe=this.transform.calculatePosMatrix(oe),_e=U.get("text-pitch-alignment")==="map",ke=U.get("text-rotation-alignment")==="map",Me=vi(g,1,this.transform.zoom),Pe=this.collisionIndex.mapProjection.translatePosition(this.transform,g,H.get("text-translate"),H.get("text-translate-anchor")),Le=this.collisionIndex.mapProjection.translatePosition(this.transform,g,H.get("icon-translate"),H.get("icon-translate-anchor")),Te=Ci(fe,_e,ke,this.transform,Me);let $e=null;if(_e){const it=bi(fe,_e,ke,this.transform,Me);$e=d.L([],this.transform.labelPlaneMatrix,it)}this.retainedQueryData[T.bucketInstanceId]=new pi(T.bucketInstanceId,z,T.sourceLayerIndex,T.index,g.tileID);const Ve={bucket:T,layout:U,translationText:Pe,translationIcon:Le,posMatrix:fe,unwrappedTileID:oe,textLabelPlaneMatrix:Te,labelToScreenMatrix:$e,scale:Y,textPixelRatio:X,holdingForFade:g.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:d.ag(T.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(v)for(const it of T.sortKeyRanges){const{sortKey:bt,symbolInstanceStart:Ut,symbolInstanceEnd:qt}=it;i.push({sortKey:bt,symbolInstanceStart:Ut,symbolInstanceEnd:qt,parameters:Ve})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:Ve})}attemptAnchorPlacement(i,h,g,v,T,z,O,U,H,Y,X,oe,fe,_e,ke,Me,Pe,Le,Te){const $e=d.aq[i.textAnchor],Ve=[i.textOffset0,i.textOffset1],it=zt($e,g,v,Ve,T),bt=this.collisionIndex.placeCollisionBox(h,oe,U,H,Y,O,z,Me,X.predicate,Te,it);if((!Le||this.collisionIndex.placeCollisionBox(Le,oe,U,H,Y,O,z,Pe,X.predicate,Te,it).placeable)&&bt.placeable){let Ut;if(this.prevPlacement&&this.prevPlacement.variableOffsets[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID].text&&(Ut=this.prevPlacement.variableOffsets[fe.crossTileID].anchor),fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[fe.crossTileID]={textOffset:Ve,width:g,height:v,anchor:$e,textBoxScale:T,prevAnchor:Ut},this.markUsedJustification(_e,$e,fe,ke),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,ke,fe),this.placedOrientations[fe.crossTileID]=ke),{shift:it,placedGlyphBoxes:bt}}}placeLayerBucketPart(i,h,g){const{bucket:v,layout:T,translationText:z,translationIcon:O,posMatrix:U,unwrappedTileID:H,textLabelPlaneMatrix:Y,labelToScreenMatrix:X,textPixelRatio:oe,holdingForFade:fe,collisionBoxArray:_e,partiallyEvaluatedTextSize:ke,collisionGroup:Me}=i.parameters,Pe=T.get("text-optional"),Le=T.get("icon-optional"),Te=d.ar(T,"text-overlap","text-allow-overlap"),$e=Te==="always",Ve=d.ar(T,"icon-overlap","icon-allow-overlap"),it=Ve==="always",bt=T.get("text-rotation-alignment")==="map",Ut=T.get("text-pitch-alignment")==="map",qt=T.get("icon-text-fit")!=="none",ii=T.get("symbol-z-order")==="viewport-y",Ht=$e&&(it||!v.hasIconData()||Le),Ft=it&&($e||!v.hasTextData()||Pe);!v.collisionArrays&&_e&&v.deserializeCollisionBoxes(_e);const oi=this._getTerrainElevationFunc(this.retainedQueryData[v.bucketInstanceId].tileID),ji=(Zt,Xt,Ii)=>{var Vn,Xi;if(h[Zt.crossTileID])return;if(fe)return void(this.placements[Zt.crossTileID]=new xt(!1,!1,!1));let un=!1,$n=!1,Qs=!0,Ha=null,Jn={box:null,placeable:!1,offscreen:null},Lr={placeable:!1},rs=null,as=null,Ms=null,Za=0,uc=0,go=0;Xt.textFeatureIndex?Za=Xt.textFeatureIndex:Zt.useRuntimeCollisionCircles&&(Za=Zt.featureIndex),Xt.verticalTextFeatureIndex&&(uc=Xt.verticalTextFeatureIndex);const sr=Xt.textBox;if(sr){const Ri=Ps=>{let Is=d.ah.horizontal;if(v.allowVerticalPlacement&&!Ps&&this.prevPlacement){const zr=this.prevPlacement.placedOrientations[Zt.crossTileID];zr&&(this.placedOrientations[Zt.crossTileID]=zr,Is=zr,this.markUsedOrientation(v,Is,Zt))}return Is},gn=(Ps,Is)=>{if(v.allowVerticalPlacement&&Zt.numVerticalGlyphVertices>0&&Xt.verticalTextBox){for(const zr of v.writingModes)if(zr===d.ah.vertical?(Jn=Is(),Lr=Jn):Jn=Ps(),Jn&&Jn.placeable)break}else Jn=Ps()},os=Zt.textAnchorOffsetStartIndex,ha=Zt.textAnchorOffsetEndIndex;if(ha===os){const Ps=(Is,zr)=>{const sn=this.collisionIndex.placeCollisionBox(Is,Te,oe,U,H,Ut,bt,z,Me.predicate,oi);return sn&&sn.placeable&&(this.markUsedOrientation(v,zr,Zt),this.placedOrientations[Zt.crossTileID]=zr),sn};gn((()=>Ps(sr,d.ah.horizontal)),(()=>{const Is=Xt.verticalTextBox;return v.allowVerticalPlacement&&Zt.numVerticalGlyphVertices>0&&Is?Ps(Is,d.ah.vertical):{box:null,offscreen:null}})),Ri(Jn&&Jn.placeable)}else{let Ps=d.aq[(Xi=(Vn=this.prevPlacement)===null||Vn===void 0?void 0:Vn.variableOffsets[Zt.crossTileID])===null||Xi===void 0?void 0:Xi.anchor];const Is=(sn,Ga,Hc)=>{const ls=sn.x2-sn.x1,ch=sn.y2-sn.y1,id=Zt.textBoxScale,nd=qt&&Ve==="never"?Ga:null;let bl=null,rf=Te==="never"?1:2,Zc="never";Ps&&rf++;for(let dc=0;dc<rf;dc++){for(let Gc=os;Gc<ha;Gc++){const rr=v.textAnchorOffsets.get(Gc);if(Ps&&rr.textAnchor!==Ps)continue;const hs=this.attemptAnchorPlacement(rr,sn,ls,ch,id,bt,Ut,oe,U,H,Me,Zc,Zt,v,Hc,z,O,nd,oi);if(hs&&(bl=hs.placedGlyphBoxes,bl&&bl.placeable))return un=!0,Ha=hs.shift,bl}Ps?Ps=null:Zc=Te}return g&&!bl&&(bl={box:this.collisionIndex.placeCollisionBox(sr,"always",oe,U,H,Ut,bt,z,Me.predicate,oi,new d.P(0,0)).box,offscreen:!1,placeable:!1}),bl};gn((()=>Is(sr,Xt.iconBox,d.ah.horizontal)),(()=>{const sn=Xt.verticalTextBox;return v.allowVerticalPlacement&&(!Jn||!Jn.placeable)&&Zt.numVerticalGlyphVertices>0&&sn?Is(sn,Xt.verticalIconBox,d.ah.vertical):{box:null,occluded:!0,offscreen:null}})),Jn&&(un=Jn.placeable,Qs=Jn.offscreen);const zr=Ri(Jn&&Jn.placeable);if(!un&&this.prevPlacement){const sn=this.prevPlacement.variableOffsets[Zt.crossTileID];sn&&(this.variableOffsets[Zt.crossTileID]=sn,this.markUsedJustification(v,sn.anchor,Zt,zr))}}}if(rs=Jn,un=rs&&rs.placeable,Qs=rs&&rs.offscreen,Zt.useRuntimeCollisionCircles){const Ri=v.text.placedSymbolArray.get(Zt.centerJustifiedTextSymbolIndex),gn=d.ai(v.textSizeData,ke,Ri),os=T.get("text-padding");as=this.collisionIndex.placeCollisionCircles(Te,Ri,v.lineVertexArray,v.glyphOffsetArray,gn,U,H,Y,X,g,Ut,Me.predicate,Zt.collisionCircleDiameter,os,z,oi),as.circles.length&&as.collisionDetected&&!g&&d.w("Collisions detected, but collision boxes are not shown"),un=$e||as.circles.length>0&&!as.collisionDetected,Qs=Qs&&as.offscreen}if(Xt.iconFeatureIndex&&(go=Xt.iconFeatureIndex),Xt.iconBox){const Ri=gn=>this.collisionIndex.placeCollisionBox(gn,Ve,oe,U,H,Ut,bt,O,Me.predicate,oi,qt&&Ha?Ha:void 0);Lr&&Lr.placeable&&Xt.verticalIconBox?(Ms=Ri(Xt.verticalIconBox),$n=Ms.placeable):(Ms=Ri(Xt.iconBox),$n=Ms.placeable),Qs=Qs&&Ms.offscreen}const Rn=Pe||Zt.numHorizontalGlyphVertices===0&&Zt.numVerticalGlyphVertices===0,hc=Le||Zt.numIconVertices===0;Rn||hc?hc?Rn||($n=$n&&un):un=$n&&un:$n=un=$n&&un;const yo=$n&&Ms.placeable;if(un&&rs.placeable&&this.collisionIndex.insertCollisionBox(rs.box,Te,T.get("text-ignore-placement"),v.bucketInstanceId,Lr&&Lr.placeable&&uc?uc:Za,Me.ID),yo&&this.collisionIndex.insertCollisionBox(Ms.box,Ve,T.get("icon-ignore-placement"),v.bucketInstanceId,go,Me.ID),as&&un&&this.collisionIndex.insertCollisionCircles(as.circles,Te,T.get("text-ignore-placement"),v.bucketInstanceId,Za,Me.ID),g&&this.storeCollisionData(v.bucketInstanceId,Ii,Xt,rs,Ms,as),Zt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Zt.crossTileID]=new xt(un||Ht,$n||Ft,Qs||v.justReloaded),h[Zt.crossTileID]=!0};if(ii){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Zt=v.getSortedSymbolIndexes(this.transform.angle);for(let Xt=Zt.length-1;Xt>=0;--Xt){const Ii=Zt[Xt];ji(v.symbolInstances.get(Ii),v.collisionArrays[Ii],Ii)}}else for(let Zt=i.symbolInstanceStart;Zt<i.symbolInstanceEnd;Zt++)ji(v.symbolInstances.get(Zt),v.collisionArrays[Zt],Zt);if(g&&v.bucketInstanceId in this.collisionCircleArrays){const Zt=this.collisionCircleArrays[v.bucketInstanceId];d.as(Zt.invProjMatrix,U),Zt.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}storeCollisionData(i,h,g,v,T,z){if(g.textBox||g.iconBox){let O,U;this.collisionBoxArrays.has(i)?O=this.collisionBoxArrays.get(i):(O=new Map,this.collisionBoxArrays.set(i,O)),O.has(h)?U=O.get(h):(U={text:null,icon:null},O.set(h,U)),g.textBox&&(U.text=v.box),g.iconBox&&(U.icon=T.box)}if(z){let O=this.collisionCircleArrays[i];O===void 0&&(O=this.collisionCircleArrays[i]=new Wt);for(let U=0;U<z.circles.length;U+=4)O.circles.push(z.circles[U+0]),O.circles.push(z.circles[U+1]),O.circles.push(z.circles[U+2]),O.circles.push(z.collisionDetected?1:0)}}markUsedJustification(i,h,g,v){let T;T=v===d.ah.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[d.at(h)];const z=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const O of z)O>=0&&(i.text.placedSymbolArray.get(O).crossTileID=T>=0&&O!==T?0:g.crossTileID)}markUsedOrientation(i,h,g){const v=h===d.ah.horizontal||h===d.ah.horizontalOnly?h:0,T=h===d.ah.vertical?h:0,z=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const O of z)i.text.placedSymbolArray.get(O).placedOrientation=v;g.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(i):1,T=h?h.opacities:{},z=h?h.variableOffsets:{},O=h?h.placedOrientations:{};for(const U in this.placements){const H=this.placements[U],Y=T[U];Y?(this.opacities[U]=new _t(Y,v,H.text,H.icon),g=g||H.text!==Y.text.placed||H.icon!==Y.icon.placed):(this.opacities[U]=new _t(null,v,H.text,H.icon,H.skipFade),g=g||H.text||H.icon)}for(const U in T){const H=T[U];if(!this.opacities[U]){const Y=new _t(H,v,!1,!1);Y.isHidden()||(this.opacities[U]=Y,g=g||H.text.placed||H.icon.placed)}}for(const U in z)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=z[U]);for(const U in O)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=O[U]);if(h&&h.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:i)}updateLayerOpacities(i,h){const g={};for(const v of h){const T=v.getBucket(i);T&&v.latestFeatureIndex&&i.id===T.layerIds[0]&&this.updateBucketOpacities(T,v.tileID,g,v.collisionBoxArray)}}updateBucketOpacities(i,h,g,v){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const T=i.layers[0],z=T.layout,O=new _t(null,0,!1,!1,!0),U=z.get("text-allow-overlap"),H=z.get("icon-allow-overlap"),Y=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),X=z.get("text-rotation-alignment")==="map",oe=z.get("text-pitch-alignment")==="map",fe=z.get("icon-text-fit")!=="none",_e=new _t(null,0,U&&(H||!i.hasIconData()||z.get("icon-optional")),H&&(U||!i.hasTextData()||z.get("text-optional")),!0);!i.collisionArrays&&v&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(v);const ke=(Pe,Le,Te)=>{for(let $e=0;$e<Le/4;$e++)Pe.opacityVertexArray.emplaceBack(Te);Pe.hasVisibleVertices=Pe.hasVisibleVertices||Te!==ko},Me=this.collisionBoxArrays.get(i.bucketInstanceId);for(let Pe=0;Pe<i.symbolInstances.length;Pe++){const Le=i.symbolInstances.get(Pe),{numHorizontalGlyphVertices:Te,numVerticalGlyphVertices:$e,crossTileID:Ve}=Le;let it=this.opacities[Ve];g[Ve]?it=O:it||(it=_e,this.opacities[Ve]=it),g[Ve]=!0;const bt=Le.numIconVertices>0,Ut=this.placedOrientations[Le.crossTileID],qt=Ut===d.ah.vertical,ii=Ut===d.ah.horizontal||Ut===d.ah.horizontalOnly;if(Te>0||$e>0){const Ft=yr(it.text);ke(i.text,Te,qt?ko:Ft),ke(i.text,$e,ii?ko:Ft);const oi=it.text.isHidden();[Le.rightJustifiedTextSymbolIndex,Le.centerJustifiedTextSymbolIndex,Le.leftJustifiedTextSymbolIndex].forEach((Xt=>{Xt>=0&&(i.text.placedSymbolArray.get(Xt).hidden=oi||qt?1:0)})),Le.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(Le.verticalPlacedTextSymbolIndex).hidden=oi||ii?1:0);const ji=this.variableOffsets[Le.crossTileID];ji&&this.markUsedJustification(i,ji.anchor,Le,Ut);const Zt=this.placedOrientations[Le.crossTileID];Zt&&(this.markUsedJustification(i,"left",Le,Zt),this.markUsedOrientation(i,Zt,Le))}if(bt){const Ft=yr(it.icon),oi=!(fe&&Le.verticalPlacedIconSymbolIndex&&qt);Le.placedIconSymbolIndex>=0&&(ke(i.icon,Le.numIconVertices,oi?Ft:ko),i.icon.placedSymbolArray.get(Le.placedIconSymbolIndex).hidden=it.icon.isHidden()),Le.verticalPlacedIconSymbolIndex>=0&&(ke(i.icon,Le.numVerticalIconVertices,oi?ko:Ft),i.icon.placedSymbolArray.get(Le.verticalPlacedIconSymbolIndex).hidden=it.icon.isHidden())}const Ht=Me&&Me.has(Pe)?Me.get(Pe):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Ft=i.collisionArrays[Pe];if(Ft){let oi=new d.P(0,0);if(Ft.textBox||Ft.verticalTextBox){let ji=!0;if(Y){const Zt=this.variableOffsets[Ve];Zt?(oi=zt(Zt.anchor,Zt.width,Zt.height,Zt.textOffset,Zt.textBoxScale),X&&oi._rotate(oe?this.transform.angle:-this.transform.angle)):ji=!1}if(Ft.textBox||Ft.verticalTextBox){let Zt;Ft.textBox&&(Zt=qt),Ft.verticalTextBox&&(Zt=ii),Ki(i.textCollisionBox.collisionVertexArray,it.text.placed,!ji||Zt,Ht.text,oi.x,oi.y)}}if(Ft.iconBox||Ft.verticalIconBox){const ji=!!(!ii&&Ft.verticalIconBox);let Zt;Ft.iconBox&&(Zt=ji),Ft.verticalIconBox&&(Zt=!ji),Ki(i.iconCollisionBox.collisionVertexArray,it.icon.placed,Zt,Ht.icon,fe?oi.x:0,fe?oi.y:0)}}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const Pe=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Pe.invProjMatrix,i.placementViewportMatrix=Pe.viewportMatrix,i.collisionCircleArray=Pe.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,h){const g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>i}setStale(){this.stale=!0}}function Ki(E,i,h,g,v,T){g&&g.length!==0||(g=[0,0,0,0]);const z=g[0]-At,O=g[1]-At,U=g[2]-At,H=g[3]-At;E.emplaceBack(i?1:0,h?1:0,v||0,T||0,z,O),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,U,O),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,U,H),E.emplaceBack(i?1:0,h?1:0,v||0,T||0,z,H)}const wi=Math.pow(2,25),vn=Math.pow(2,24),gr=Math.pow(2,17),Ys=Math.pow(2,16),zs=Math.pow(2,9),Eo=Math.pow(2,8),ir=Math.pow(2,1);function yr(E){if(E.opacity===0&&!E.placed)return 0;if(E.opacity===1&&E.placed)return 4294967295;const i=E.placed?1:0,h=Math.floor(127*E.opacity);return h*wi+i*vn+h*gr+i*Ys+h*zs+i*Eo+h*ir+i}const ko=0;function _a(){return{isOccluded:(E,i,h)=>!1,getPitchedTextCorrection:(E,i,h)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(E,i,h,g){throw new Error("Not implemented.")},translatePosition:(E,i,h,g)=>(function(v,T,z,O,U=!1){if(!z[0]&&!z[1])return[0,0];const H=U?O==="map"?v.angle:0:O==="viewport"?-v.angle:0;if(H){const Y=Math.sin(H),X=Math.cos(H);z=[z[0]*X-z[1]*Y,z[0]*Y+z[1]*X]}return[U?z[0]:vi(T,z[0],v.zoom),U?z[1]:vi(T,z[1],v.zoom)]})(E,i,h,g),getCircleRadiusCorrection:E=>1}}class Pi{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,h,g,v,T){const z=this._bucketParts;for(;this._currentTileIndex<i.length;)if(h.getBucketParts(z,v,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort(((O,U)=>O.sortKey-U.sortKey)));this._currentPartIndex<z.length;)if(h.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,T())return!0;return!1}}class zn{constructor(i,h,g,v,T,z,O,U){this.placement=new Jt(i,_a(),h,z,O,U),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(i,h,g){const v=N.now(),T=()=>!this._forceFullPlacement&&N.now()-v>2;for(;this._currentPlacementIndex>=0;){const z=h[i[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=O)&&(!z.maxzoom||z.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new Pi(z)),this._inProgressLayer.continuePlacement(g[z.source],this.placement,this._showCollisionBoxes,z,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const ys=512/d.X/2;class fn{constructor(i,h,g){this.tileID=i,this.bucketInstanceId=g,this._symbolsByKey={};const v=new Map;for(let T=0;T<h.length;T++){const z=h.get(T),O=z.key,U=v.get(O);U?U.push(z):v.set(O,[z])}for(const[T,z]of v){const O={positions:z.map((U=>({x:Math.floor(U.anchorX*ys),y:Math.floor(U.anchorY*ys)}))),crossTileIDs:z.map((U=>U.crossTileID))};if(O.positions.length>128){const U=new d.av(O.positions.length,16,Uint16Array);for(const{x:H,y:Y}of O.positions)U.add(H,Y);U.finish(),delete O.positions,O.index=U}this._symbolsByKey[T]=O}}getScaledCoordinates(i,h){const{x:g,y:v,z:T}=this.tileID.canonical,{x:z,y:O,z:U}=h.canonical,H=ys/Math.pow(2,U-T),Y=(O*d.X+i.anchorY)*H,X=v*d.X*ys;return{x:Math.floor((z*d.X+i.anchorX)*H-g*d.X*ys),y:Math.floor(Y-X)}}findMatches(i,h,g){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let T=0;T<i.length;T++){const z=i.get(T);if(z.crossTileID)continue;const O=this._symbolsByKey[z.key];if(!O)continue;const U=this.getScaledCoordinates(z,h);if(O.index){const H=O.index.range(U.x-v,U.y-v,U.x+v,U.y+v).sort();for(const Y of H){const X=O.crossTileIDs[Y];if(!g[X]){g[X]=!0,z.crossTileID=X;break}}}else if(O.positions)for(let H=0;H<O.positions.length;H++){const Y=O.positions[H],X=O.crossTileIDs[H];if(Math.abs(Y.x-U.x)<=v&&Math.abs(Y.y-U.y)<=v&&!g[X]){g[X]=!0,z.crossTileID=X;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:i})=>i))}}class Ra{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Br{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const h=Math.round((i-this.lng)/360);if(h!==0)for(const g in this.indexes){const v=this.indexes[g],T={};for(const z in v){const O=v[z];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+h),T[O.tileID.key]=O}this.indexes[g]=T}this.lng=i}addBucket(i,h,g){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let T=0;T<h.symbolInstances.length;T++)h.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const v=this.usedCrossTileIDs[i.overscaledZ];for(const T in this.indexes){const z=this.indexes[T];if(Number(T)>i.overscaledZ)for(const O in z){const U=z[O];U.tileID.isChildOf(i)&&U.findMatches(h.symbolInstances,i,v)}else{const O=z[i.scaledTo(Number(T)).key];O&&O.findMatches(h.symbolInstances,i,v)}}for(let T=0;T<h.symbolInstances.length;T++){const z=h.symbolInstances.get(T);z.crossTileID||(z.crossTileID=g.generate(),v[z.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new fn(i,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(i,h){for(const g of h.getCrossTileIDsLists())for(const v of g)delete this.usedCrossTileIDs[i][v]}removeStaleBuckets(i){let h=!1;for(const g in this.indexes){const v=this.indexes[g];for(const T in v)i[v[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,v[T]),delete v[T],h=!0)}return h}}class Hi{constructor(){this.layerIndexes={},this.crossTileIDs=new Ra,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,h,g){let v=this.layerIndexes[i.id];v===void 0&&(v=this.layerIndexes[i.id]=new Br);let T=!1;const z={};v.handleWrapJump(g);for(const O of h){const U=O.getBucket(i);U&&i.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(O.tileID,U,this.crossTileIDs)&&(T=!0),z[U.bucketInstanceId]=!0)}return v.removeStaleBuckets(z)&&(T=!0),T}pruneUnusedLayers(i){const h={};i.forEach((g=>{h[g]=!0}));for(const g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}const In=(E,i)=>d.t(E,i&&i.filter((h=>h.identifier!=="source.canvas"))),Il=d.aw();class Wo extends d.E{constructor(i,h={}){super(),this._rtlPluginLoaded=()=>{for(const g in this.sourceCaches){const v=this.sourceCaches[g].getSource().type;v!=="vector"&&v!=="geojson"||this.sourceCaches[g].reload()}},this.map=i,this.dispatcher=new Vi(_i(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",((g,v)=>this.getGlyphs(g,v))),this.dispatcher.registerMessageHandler("GI",((g,v)=>this.getImages(g,v))),this.imageManager=new Mt,this.imageManager.setEventedParent(this),this.glyphManager=new ot(i._requestManager,h.localIdeographFontFamily),this.lineAtlas=new et(256,512),this.crossTileSymbolIndex=new Hi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.ay()),An().on(Tt,this._rtlPluginLoaded),this.on("data",(g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const v=this.sourceCaches[g.sourceId];if(!v)return;const T=v.getSource();if(T&&T.vectorLayerIds)for(const z in this._layers){const O=this._layers[z];O.source===T.id&&this._validateLayer(O)}}))}loadURL(i,h={},g){this.fire(new d.k("dataloading",{dataType:"style"})),h.validate=typeof h.validate!="boolean"||h.validate;const v=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController;const T=this._loadStyleRequest;d.h(v,this._loadStyleRequest).then((z=>{this._loadStyleRequest=null,this._load(z.data,h,g)})).catch((z=>{this._loadStyleRequest=null,z&&!T.signal.aborted&&this.fire(new d.j(z))}))}loadJSON(i,h={},g){this.fire(new d.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,h.validate=h.validate!==!1,this._load(i,h,g)})).catch((()=>{}))}loadEmpty(){this.fire(new d.k("dataloading",{dataType:"style"})),this._load(Il,{validate:!1})}_load(i,h,g){var v;const T=h.transformStyle?h.transformStyle(g,i):i;if(!h.validate||!In(this,d.u(T))){this._loaded=!0,this.stylesheet=T;for(const z in T.sources)this.addSource(z,T.sources[z],{validate:!1});T.sprite?this._loadSprite(T.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(T.glyphs),this._createLayers(),this.light=new rt(this.stylesheet.light),this.sky=new Ie(this.stylesheet.sky),this.map.setTerrain((v=this.stylesheet.terrain)!==null&&v!==void 0?v:null),this.fire(new d.k("data",{dataType:"style"})),this.fire(new d.k("style.load"))}}_createLayers(){const i=d.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map((h=>h.id)),this._layers={},this._serializedLayers=null;for(const h of i){const g=d.aA(h);g.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=g}}_loadSprite(i,h=!1,g=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(T,z,O,U){return d._(this,void 0,void 0,(function*(){const H=Ze(T),Y=O>1?"@2x":"",X={},oe={};for(const{id:fe,url:_e}of H){const ke=z.transformRequest(st(_e,Y,".json"),"SpriteJSON");X[fe]=d.h(ke,U);const Me=z.transformRequest(st(_e,Y,".png"),"SpriteImage");oe[fe]=ae.getImage(Me,U)}return yield Promise.all([...Object.values(X),...Object.values(oe)]),(function(fe,_e){return d._(this,void 0,void 0,(function*(){const ke={};for(const Me in fe){ke[Me]={};const Pe=N.getImageCanvasContext((yield _e[Me]).data),Le=(yield fe[Me]).data;for(const Te in Le){const{width:$e,height:Ve,x:it,y:bt,sdf:Ut,pixelRatio:qt,stretchX:ii,stretchY:Ht,content:Ft,textFitWidth:oi,textFitHeight:ji}=Le[Te];ke[Me][Te]={data:null,pixelRatio:qt,sdf:Ut,stretchX:ii,stretchY:Ht,content:Ft,textFitWidth:oi,textFitHeight:ji,spriteData:{width:$e,height:Ve,x:it,y:bt,context:Pe}}}}return ke}))})(X,oe)}))})(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((T=>{if(this._spriteRequest=null,T)for(const z in T){this._spritesImagesIds[z]=[];const O=this._spritesImagesIds[z]?this._spritesImagesIds[z].filter((U=>!(U in T))):[];for(const U of O)this.imageManager.removeImage(U),this._changedImages[U]=!0;for(const U in T[z]){const H=z==="default"?U:`${z}:${U}`;this._spritesImagesIds[z].push(H),H in this.imageManager.images?this.imageManager.updateImage(H,T[z][U],!1):this.imageManager.addImage(H,T[z][U]),h&&(this._changedImages[H]=!0)}}})).catch((T=>{this._spriteRequest=null,v=T,this.fire(new d.j(v))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),h&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"})),g&&g(v)}))}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}_validateLayer(i){const h=this.sourceCaches[i.source];if(!h)return;const g=i.sourceLayer;if(!g)return;const v=h.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(g)===-1)&&this.fire(new d.j(new Error(`Source layer "${g}" does not exist on source "${v.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i,h=!1){const g=this._serializedAllLayers();if(!i||i.length===0)return Object.values(h?d.aB(g):g);const v=[];for(const T of i)if(g[T]){const z=h?d.aB(g[T]):g[T];v.push(z)}return v}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const h=Object.keys(this._layers);for(const g of h){const v=this._layers[g];v.type!=="custom"&&(i[g]=v.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const h=this._changed;if(h){const v=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(v.length||T.length)&&this._updateWorkerLayers(v,T);for(const z in this._updatedSources){const O=this._updatedSources[z];if(O==="reload")this._reloadSource(z);else{if(O!=="clear")throw new Error(`Invalid action ${O}`);this._clearSource(z)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(i);this.light.updateTransitions(i),this.sky.updateTransitions(i),this._resetUpdates()}const g={};for(const v in this.sourceCaches){const T=this.sourceCaches[v];g[v]=T.used,T.used=!1}for(const v of this._order){const T=this._layers[v];T.recalculate(i,this._availableImages),!T.isHidden(i.zoom)&&T.source&&(this.sourceCaches[T.source].used=!0)}for(const v in g){const T=this.sourceCaches[v];!!g[v]!=!!T.used&&T.fire(new d.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(i),this.sky.recalculate(i),this.z=i.zoom,h&&this.fire(new d.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,h){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i,!1),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,h={}){var g;this._checkLoaded();const v=this.serialize();if(i=h.transformStyle?h.transformStyle(v,i):i,((g=h.validate)===null||g===void 0||g)&&In(this,d.u(i)))return!1;(i=d.aB(i)).layers=d.az(i.layers);const T=d.aC(v,i),z=this._getOperationsToPerform(T);if(z.unimplemented.length>0)throw new Error(`Unimplemented: ${z.unimplemented.join(", ")}.`);if(z.operations.length===0)return!1;for(const O of z.operations)O();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const h=[],g=[];for(const v of i)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":h.push((()=>this.addLayer.apply(this,v.args)));break;case"removeLayer":h.push((()=>this.removeLayer.apply(this,v.args)));break;case"setPaintProperty":h.push((()=>this.setPaintProperty.apply(this,v.args)));break;case"setLayoutProperty":h.push((()=>this.setLayoutProperty.apply(this,v.args)));break;case"setFilter":h.push((()=>this.setFilter.apply(this,v.args)));break;case"addSource":h.push((()=>this.addSource.apply(this,v.args)));break;case"removeSource":h.push((()=>this.removeSource.apply(this,v.args)));break;case"setLayerZoomRange":h.push((()=>this.setLayerZoomRange.apply(this,v.args)));break;case"setLight":h.push((()=>this.setLight.apply(this,v.args)));break;case"setGeoJSONSourceData":h.push((()=>this.setGeoJSONSourceData.apply(this,v.args)));break;case"setGlyphs":h.push((()=>this.setGlyphs.apply(this,v.args)));break;case"setSprite":h.push((()=>this.setSprite.apply(this,v.args)));break;case"setSky":h.push((()=>this.setSky.apply(this,v.args)));break;case"setTerrain":h.push((()=>this.map.setTerrain.apply(this,v.args)));break;case"setTransition":h.push((()=>{}));break;default:g.push(v.command)}return{operations:h,unimplemented:g}}addImage(i,h){if(this.getImage(i))return this.fire(new d.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,h),this._afterImageUpdated(i)}updateImage(i,h){this.imageManager.updateImage(i,h)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new d.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,h,g={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(d.u.source,`sources.${i}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=this.sourceCaches[i]=new ti(i,h,this.dispatcher);v.style=this,v.setEventedParent(this,(()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:i}))),v.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===i)return this.fire(new d.j(new Error(`Source "${i}" cannot be removed while layer "${g}" is using it.`)));const h=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],h.fire(new d.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,h){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const g=this.sourceCaches[i].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(h),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,h,g={}){this._checkLoaded();const v=i.id;if(this.getLayer(v))return void this.fire(new d.j(new Error(`Layer "${v}" already exists on this map.`)));let T;if(i.type==="custom"){if(In(this,d.aD(i)))return;T=d.aA(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(v,i.source),i=d.aB(i),i=d.e(i,{source:v})),this._validate(d.u.layer,`layers.${v}`,i,{arrayIndex:-1},g))return;T=d.aA(i),this._validateLayer(T),T.setEventedParent(this,{layer:{id:v}})}const z=h?this._order.indexOf(h):this._order.length;if(h&&z===-1)this.fire(new d.j(new Error(`Cannot add layer "${v}" before non-existing layer "${h}".`)));else{if(this._order.splice(z,0,v),this._layerOrderChanged=!0,this._layers[v]=T,this._removedLayers[v]&&T.source&&T.type!=="custom"){const O=this._removedLayers[v];delete this._removedLayers[v],O.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}moveLayer(i,h){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new d.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===h)return;const g=this._order.indexOf(i);this._order.splice(g,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new d.j(new Error(`Cannot move layer "${i}" before non-existing layer "${h}".`))):(this._order.splice(v,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const h=this._layers[i];if(!h)return void this.fire(new d.j(new Error(`Cannot remove non-existing layer "${i}".`)));h.setEventedParent(null);const g=this._order.indexOf(i);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=h,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],h.onRemove&&h.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,h,g){this._checkLoaded();const v=this.getLayer(i);v?v.minzoom===h&&v.maxzoom===g||(h!=null&&(v.minzoom=h),g!=null&&(v.maxzoom=g),this._updateLayer(v)):this.fire(new d.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,h,g={}){this._checkLoaded();const v=this.getLayer(i);if(v){if(!d.aE(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(d.u.filter,`layers.${v.id}.filter`,h,null,g)||(v.filter=d.aB(h),this._updateLayer(v)))}else this.fire(new d.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return d.aB(this.getLayer(i).filter)}setLayoutProperty(i,h,g,v={}){this._checkLoaded();const T=this.getLayer(i);T?d.aE(T.getLayoutProperty(h),g)||(T.setLayoutProperty(h,g,v),this._updateLayer(T)):this.fire(new d.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,h){const g=this.getLayer(i);if(g)return g.getLayoutProperty(h);this.fire(new d.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,h,g,v={}){this._checkLoaded();const T=this.getLayer(i);T?d.aE(T.getPaintProperty(h),g)||(T.setPaintProperty(h,g,v)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[i]=!0,this._serializedLayers=null):this.fire(new d.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,h){return this.getLayer(i).getPaintProperty(h)}setFeatureState(i,h){this._checkLoaded();const g=i.source,v=i.sourceLayer,T=this.sourceCaches[g];if(T===void 0)return void this.fire(new d.j(new Error(`The source '${g}' does not exist in the map's style.`)));const z=T.getSource().type;z==="geojson"&&v?this.fire(new d.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||v?(i.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),T.setFeatureState(v,i.id,h)):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,h){this._checkLoaded();const g=i.source,v=this.sourceCaches[g];if(v===void 0)return void this.fire(new d.j(new Error(`The source '${g}' does not exist in the map's style.`)));const T=v.getSource().type,z=T==="vector"?i.sourceLayer:void 0;T!=="vector"||z?h&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new d.j(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(z,i.id,h):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const h=i.source,g=i.sourceLayer,v=this.sourceCaches[h];if(v!==void 0)return v.getSource().type!=="vector"||g?(i.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),v.getFeatureState(g,i.id)):void this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.j(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=d.aF(this.sourceCaches,(T=>T.serialize())),h=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,v=this.stylesheet;return d.aG({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,sources:i,layers:h,terrain:g},(T=>T!==void 0))}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const h=z=>this._layers[z].type==="fill-extrusion",g={},v=[];for(let z=this._order.length-1;z>=0;z--){const O=this._order[z];if(h(O)){g[O]=z;for(const U of i){const H=U[O];if(H)for(const Y of H)v.push(Y)}}}v.sort(((z,O)=>O.intersectionZ-z.intersectionZ));const T=[];for(let z=this._order.length-1;z>=0;z--){const O=this._order[z];if(h(O))for(let U=v.length-1;U>=0;U--){const H=v[U].feature;if(g[H.layer.id]<z)break;T.push(H),v.pop()}else for(const U of i){const H=U[O];if(H)for(const Y of H)T.push(Y.feature)}}return T}queryRenderedFeatures(i,h,g){h&&h.filter&&this._validate(d.u.filter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new d.j(new Error("parameters.layers must be an Array."))),[];for(const O of h.layers){const U=this._layers[O];if(!U)return this.fire(new d.j(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];v[U.source]=!0}}const T=[];h.availableImages=this._availableImages;const z=this._serializedAllLayers();for(const O in this.sourceCaches)h.layers&&!v[O]||T.push(xn(this.sourceCaches[O],this._layers,z,i,h,g));return this.placement&&T.push((function(O,U,H,Y,X,oe,fe){const _e={},ke=oe.queryRenderedSymbols(Y),Me=[];for(const Pe of Object.keys(ke).map(Number))Me.push(fe[Pe]);Me.sort(cn);for(const Pe of Me){const Le=Pe.featureIndex.lookupSymbolFeatures(ke[Pe.bucketInstanceId],U,Pe.bucketIndex,Pe.sourceLayerIndex,X.filter,X.layers,X.availableImages,O);for(const Te in Le){const $e=_e[Te]=_e[Te]||[],Ve=Le[Te];Ve.sort(((it,bt)=>{const Ut=Pe.featureSortOrder;if(Ut){const qt=Ut.indexOf(it.featureIndex);return Ut.indexOf(bt.featureIndex)-qt}return bt.featureIndex-it.featureIndex}));for(const it of Ve)$e.push(it)}}for(const Pe in _e)_e[Pe].forEach((Le=>{const Te=Le.feature,$e=H[O[Pe].source].getFeatureState(Te.layer["source-layer"],Te.id);Te.source=Te.layer.source,Te.layer["source-layer"]&&(Te.sourceLayer=Te.layer["source-layer"]),Te.state=$e}));return _e})(this._layers,z,this.sourceCaches,i,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(i,h){h&&h.filter&&this._validate(d.u.filter,"querySourceFeatures.filter",h.filter,null,h);const g=this.sourceCaches[i];return g?(function(v,T){const z=v.getRenderableIds().map((H=>v.getTileByID(H))),O=[],U={};for(let H=0;H<z.length;H++){const Y=z[H],X=Y.tileID.canonical.key;U[X]||(U[X]=!0,Y.querySourceFeatures(O,T))}return O})(g,h):[]}getLight(){return this.light.getLight()}setLight(i,h={}){this._checkLoaded();const g=this.light.getLight();let v=!1;for(const z in i)if(!d.aE(i[z],g[z])){v=!0;break}if(!v)return;const T={now:N.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,h),this.light.updateTransitions(T)}getSky(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.sky}setSky(i,h={}){const g=this.getSky();let v=!1;if(!i&&!g)return;if(i&&!g)v=!0;else if(!i&&g)v=!0;else for(const z in i)if(!d.aE(i[z],g[z])){v=!0;break}if(!v)return;const T={now:N.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=i,this.sky.setSky(i,h),this.sky.updateTransitions(T)}_validate(i,h,g,v,T={}){return(!T||T.validate!==!1)&&In(this,i.call(d.u,d.e({key:h,style:this.serialize(),value:g,styleSpec:d.v},v)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),An().off(Tt,this._rtlPluginLoaded);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this.sourceCaches){const g=this.sourceCaches[h];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const h in this.sourceCaches)this.sourceCaches[h].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,h,g,v,T=!1){let z=!1,O=!1;const U={};for(const H of this._order){const Y=this._layers[H];if(Y.type!=="symbol")continue;if(!U[Y.source]){const oe=this.sourceCaches[Y.source];U[Y.source]=oe.getRenderableIds(!0).map((fe=>oe.getTileByID(fe))).sort(((fe,_e)=>_e.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(_e.tileID)?-1:1)))}const X=this.crossTileSymbolIndex.addLayer(Y,U[Y.source],i.center.lng);z=z||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(N.now(),i.zoom))&&(this.pauseablePlacement=new zn(i,this.map.terrain,this._order,T,h,g,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(N.now()),O=!0),z&&this.pauseablePlacement.placement.setStale()),O||z)for(const H of this._order){const Y=this._layers[H];Y.type==="symbol"&&this.placement.updateLayerOpacities(Y,U[Y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(N.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,h){return d._(this,void 0,void 0,(function*(){const g=yield this.imageManager.getImages(h.icons);this._updateTilesForChangedImages();const v=this.sourceCaches[h.source];return v&&v.setDependencies(h.tileID.key,h.type,h.icons),g}))}getGlyphs(i,h){return d._(this,void 0,void 0,(function*(){const g=yield this.glyphManager.getGlyphs(h.stacks),v=this.sourceCaches[h.source];return v&&v.setDependencies(h.tileID.key,h.type,[""]),g}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,h={}){this._checkLoaded(),i&&this._validate(d.u.glyphs,"glyphs",i,null,h)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,h,g={},v){this._checkLoaded();const T=[{id:i,url:h}],z=[...Ze(this.stylesheet.sprite),...T];this._validate(d.u.sprite,"sprite",z,null,g)||(this.stylesheet.sprite=z,this._loadSprite(T,!0,v))}removeSprite(i){this._checkLoaded();const h=Ze(this.stylesheet.sprite);if(h.find((g=>g.id===i))){if(this._spritesImagesIds[i])for(const g of this._spritesImagesIds[i])this.imageManager.removeImage(g),this._changedImages[g]=!0;h.splice(h.findIndex((g=>g.id===i)),1),this.stylesheet.sprite=h.length>0?h:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}else this.fire(new d.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return Ze(this.stylesheet.sprite)}setSprite(i,h={},g){this._checkLoaded(),i&&this._validate(d.u.sprite,"sprite",i,null,h)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,g):(this._unloadSprite(),g&&g(null)))}}var Bn=d.Y([{name:"a_pos",type:"Int16",components:2}]);const Da={prelude:pn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:pn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:pn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:pn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:pn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:pn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:pn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:pn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:pn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:pn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:pn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:pn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:pn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:pn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:pn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:pn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:pn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:pn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:pn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:pn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:pn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:pn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:pn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:pn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:pn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:pn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:pn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function pn(E,i){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=i.match(/attribute ([\w]+) ([\w]+)/g),v=E.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=T?T.concat(v):v,O={};return{fragmentSource:E=E.replace(h,((U,H,Y,X,oe)=>(O[oe]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
varying ${Y} ${X} ${oe};
#else
uniform ${Y} ${X} u_${oe};
#endif
`:`
#ifdef HAS_UNIFORM_u_${oe}
    ${Y} ${X} ${oe} = u_${oe};
#endif
`))),vertexSource:i=i.replace(h,((U,H,Y,X,oe)=>{const fe=X==="float"?"vec2":"vec4",_e=oe.match(/color/)?"color":fe;return O[oe]?H==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
attribute ${Y} ${fe} a_${oe};
varying ${Y} ${X} ${oe};
#else
uniform ${Y} ${X} u_${oe};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = a_${oe};
#else
    ${Y} ${X} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = unpack_mix_${_e}(a_${oe}, u_${oe}_t);
#else
    ${Y} ${X} ${oe} = u_${oe};
#endif
`:H==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
attribute ${Y} ${fe} a_${oe};
#else
uniform ${Y} ${X} u_${oe};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${Y} ${X} ${oe} = a_${oe};
#else
    ${Y} ${X} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${Y} ${X} ${oe} = unpack_mix_${_e}(a_${oe}, u_${oe}_t);
#else
    ${Y} ${X} ${oe} = u_${oe};
#endif
`})),staticAttributes:g,staticUniforms:z}}class va{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,h,g,v,T,z,O,U,H){this.context=i;let Y=this.boundPaintVertexBuffers.length!==v.length;for(let X=0;!Y&&X<v.length;X++)this.boundPaintVertexBuffers[X]!==v[X]&&(Y=!0);!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==g||Y||this.boundIndexBuffer!==T||this.boundVertexOffset!==z||this.boundDynamicVertexBuffer!==O||this.boundDynamicVertexBuffer2!==U||this.boundDynamicVertexBuffer3!==H?this.freshBind(h,g,v,T,z,O,U,H):(i.bindVertexArray.set(this.vao),O&&O.bind(),T&&T.dynamicDraw&&T.bind(),U&&U.bind(),H&&H.bind())}freshBind(i,h,g,v,T,z,O,U){const H=i.numAttributes,Y=this.context,X=Y.gl;this.vao&&this.destroy(),this.vao=Y.createVertexArray(),Y.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=v,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=O,this.boundDynamicVertexBuffer3=U,h.enableAttributes(X,i);for(const oe of g)oe.enableAttributes(X,i);z&&z.enableAttributes(X,i),O&&O.enableAttributes(X,i),U&&U.enableAttributes(X,i),h.bind(),h.setVertexAttribPointers(X,i,T);for(const oe of g)oe.bind(),oe.setVertexAttribPointers(X,i,T);z&&(z.bind(),z.setVertexAttribPointers(X,i,T)),v&&v.bind(),O&&(O.bind(),O.setVertexAttribPointers(X,i,T)),U&&(U.bind(),U.setVertexAttribPointers(X,i,T)),Y.currentNumAttributes=H}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Gn=(E,i,h,g,v)=>({u_matrix:E,u_texture:0,u_ele_delta:i,u_fog_matrix:h,u_fog_color:g?g.properties.get("fog-color"):d.aM.white,u_fog_ground_blend:g?g.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?g.calculateFogBlendOpacity(v):0,u_horizon_color:g?g.properties.get("horizon-color"):d.aM.white,u_horizon_fog_blend:g?g.properties.get("horizon-fog-blend"):1});function $r(E){const i=[];for(let h=0;h<E.length;h++){if(E[h]===null)continue;const g=E[h].split(" ");i.push(g.pop())}return i}class Co{constructor(i,h,g,v,T,z){const O=i.gl;this.program=O.createProgram();const U=$r(h.staticAttributes),H=g?g.getBinderAttributes():[],Y=U.concat(H),X=Da.prelude.staticUniforms?$r(Da.prelude.staticUniforms):[],oe=h.staticUniforms?$r(h.staticUniforms):[],fe=g?g.getBinderUniforms():[],_e=X.concat(oe).concat(fe),ke=[];for(const it of _e)ke.indexOf(it)<0&&ke.push(it);const Me=g?g.defines():[];T&&Me.push("#define OVERDRAW_INSPECTOR;"),z&&Me.push("#define TERRAIN3D;");const Pe=Me.concat(Da.prelude.fragmentSource,h.fragmentSource).join(`
`),Le=Me.concat(Da.prelude.vertexSource,h.vertexSource).join(`
`),Te=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(Te,Pe),O.compileShader(Te),!O.getShaderParameter(Te,O.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${O.getShaderInfoLog(Te)}`);O.attachShader(this.program,Te);const $e=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource($e,Le),O.compileShader($e),!O.getShaderParameter($e,O.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${O.getShaderInfoLog($e)}`);O.attachShader(this.program,$e),this.attributes={};const Ve={};this.numAttributes=Y.length;for(let it=0;it<this.numAttributes;it++)Y[it]&&(O.bindAttribLocation(this.program,it,Y[it]),this.attributes[Y[it]]=it);if(O.linkProgram(this.program),!O.getProgramParameter(this.program,O.LINK_STATUS))throw new Error(`Program failed to link: ${O.getProgramInfoLog(this.program)}`);O.deleteShader($e),O.deleteShader(Te);for(let it=0;it<ke.length;it++){const bt=ke[it];if(bt&&!Ve[bt]){const Ut=O.getUniformLocation(this.program,bt);Ut&&(Ve[bt]=Ut)}}this.fixedUniforms=v(i,Ve),this.terrainUniforms=((it,bt)=>({u_depth:new d.aH(it,bt.u_depth),u_terrain:new d.aH(it,bt.u_terrain),u_terrain_dim:new d.aI(it,bt.u_terrain_dim),u_terrain_matrix:new d.aJ(it,bt.u_terrain_matrix),u_terrain_unpack:new d.aK(it,bt.u_terrain_unpack),u_terrain_exaggeration:new d.aI(it,bt.u_terrain_exaggeration)}))(i,Ve),this.binderUniforms=g?g.getUniforms(i,Ve):[]}draw(i,h,g,v,T,z,O,U,H,Y,X,oe,fe,_e,ke,Me,Pe,Le){const Te=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(g),i.setStencilMode(v),i.setColorMode(T),i.setCullFace(z),U){i.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,U.depthTexture),i.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,U.texture);for(const Ve in this.terrainUniforms)this.terrainUniforms[Ve].set(U[Ve])}for(const Ve in this.fixedUniforms)this.fixedUniforms[Ve].set(O[Ve]);ke&&ke.setUniforms(i,this.binderUniforms,fe,{zoom:_e});let $e=0;switch(h){case Te.LINES:$e=2;break;case Te.TRIANGLES:$e=3;break;case Te.LINE_STRIP:$e=1}for(const Ve of oe.get()){const it=Ve.vaos||(Ve.vaos={});(it[H]||(it[H]=new va)).bind(i,this,Y,ke?ke.getPaintVertexBuffers():[],X,Ve.vertexOffset,Me,Pe,Le),Te.drawElements(h,Ve.primitiveLength*$e,Te.UNSIGNED_SHORT,Ve.primitiveOffset*$e*2)}}}function Ur(E,i,h){const g=1/vi(h,1,i.transform.tileZoom),v=Math.pow(2,h.tileID.overscaledZ),T=h.tileSize*Math.pow(2,i.transform.tileZoom)/v,z=T*(h.tileID.canonical.x+h.tileID.wrap*v),O=T*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[z>>16,O>>16],u_pixel_coord_lower:[65535&z,65535&O]}}const Yo=(E,i,h,g)=>{const v=i.style.light,T=v.properties.get("position"),z=[T.x,T.y,T.z],O=(function(){var H=new d.A(9);return d.A!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[5]=0,H[6]=0,H[7]=0),H[0]=1,H[4]=1,H[8]=1,H})();v.properties.get("anchor")==="viewport"&&(function(H,Y){var X=Math.sin(Y),oe=Math.cos(Y);H[0]=oe,H[1]=X,H[2]=0,H[3]=-X,H[4]=oe,H[5]=0,H[6]=0,H[7]=0,H[8]=1})(O,-i.transform.angle),(function(H,Y,X){var oe=Y[0],fe=Y[1],_e=Y[2];H[0]=oe*X[0]+fe*X[3]+_e*X[6],H[1]=oe*X[1]+fe*X[4]+_e*X[7],H[2]=oe*X[2]+fe*X[5]+_e*X[8]})(z,z,O);const U=v.properties.get("color");return{u_matrix:E,u_lightpos:z,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+h,u_opacity:g}},ro=(E,i,h,g,v,T,z)=>d.e(Yo(E,i,h,g),Ur(T,i,z),{u_height_factor:-Math.pow(2,v.overscaledZ)/z.tileSize/8}),ao=E=>({u_matrix:E}),jl=(E,i,h,g)=>d.e(ao(E),Ur(h,i,g)),Ic=(E,i)=>({u_matrix:E,u_world:i}),jc=(E,i,h,g,v)=>d.e(jl(E,i,h,g),{u_world:v}),Ll=(E,i,h,g)=>{const v=E.transform;let T,z;if(g.paint.get("circle-pitch-alignment")==="map"){const O=vi(h,1,v.zoom);T=!0,z=[O,O]}else T=!1,z=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:E.translatePosMatrix(i.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+T,u_device_pixel_ratio:E.pixelRatio,u_extrude_scale:z}},$s=(E,i,h)=>({u_matrix:E,u_inv_matrix:i,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}),Ao=(E,i,h=1)=>({u_matrix:E,u_color:i,u_overlay:0,u_overlay_scale:h}),Us=E=>({u_matrix:E}),Rs=(E,i,h,g)=>({u_matrix:E,u_extrude_scale:vi(i,1,h),u_intensity:g}),Di=(E,i,h,g)=>{const v=d.H();d.aP(v,0,E.width,E.height,0,0,1);const T=E.context.gl;return{u_matrix:v,u_world:[T.drawingBufferWidth,T.drawingBufferHeight],u_image:h,u_color_ramp:g,u_opacity:i.paint.get("heatmap-opacity")}};function Mr(E,i){const h=Math.pow(2,i.canonical.z),g=i.canonical.y;return[new d.Z(0,g/h).toLngLat().lat,new d.Z(0,(g+1)/h).toLngLat().lat]}const jn=(E,i,h,g)=>{const v=E.transform;return{u_matrix:na(E,i,h,g),u_ratio:1/vi(i,1,v.zoom),u_device_pixel_ratio:E.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Lc=(E,i,h,g,v)=>d.e(jn(E,i,h,v),{u_image:0,u_image_height:g}),ia=(E,i,h,g,v)=>{const T=E.transform,z=zl(i,T);return{u_matrix:na(E,i,h,v),u_texsize:i.imageAtlasTexture.size,u_ratio:1/vi(i,1,T.zoom),u_device_pixel_ratio:E.pixelRatio,u_image:0,u_scale:[z,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},xa=(E,i,h,g,v,T)=>{const z=E.lineAtlas,O=zl(i,E.transform),U=h.layout.get("line-cap")==="round",H=z.getDash(g.from,U),Y=z.getDash(g.to,U),X=H.width*v.fromScale,oe=Y.width*v.toScale;return d.e(jn(E,i,h,T),{u_patternscale_a:[O/X,-H.height/2],u_patternscale_b:[O/oe,-Y.height/2],u_sdfgamma:z.width/(256*Math.min(X,oe)*E.pixelRatio)/2,u_image:0,u_tex_y_a:H.y,u_tex_y_b:Y.y,u_mix:v.t})};function zl(E,i){return 1/vi(E,1,i.tileZoom)}function na(E,i,h,g){return E.translatePosMatrix(g?g.posMatrix:i.tileID.posMatrix,i,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const Oa=(E,i,h,g,v)=>{return{u_matrix:E,u_tl_parent:i,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(z=v.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(T=v.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Xo(v.paint.get("raster-hue-rotate"))};var T,z};function Xo(E){E*=Math.PI/180;const i=Math.sin(E),h=Math.cos(E);return[(2*h+1)/3,(-Math.sqrt(3)*i-h+1)/3,(Math.sqrt(3)*i-h+1)/3]}const xs=(E,i,h,g,v,T,z,O,U,H,Y,X,oe,fe)=>{const _e=z.transform;return{u_is_size_zoom_constant:+(E==="constant"||E==="source"),u_is_size_feature_constant:+(E==="constant"||E==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_pitch:_e.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:_e.width/_e.height,u_fade_change:z.options.fadeDuration?z.symbolFadeChange:1,u_matrix:O,u_label_plane_matrix:U,u_coord_matrix:H,u_is_text:+X,u_pitch_with_map:+g,u_is_along_line:v,u_is_variable_anchor:T,u_texsize:oe,u_texture:0,u_translation:Y,u_pitched_scale:fe}},sa=(E,i,h,g,v,T,z,O,U,H,Y,X,oe,fe,_e)=>{const ke=z.transform;return d.e(xs(E,i,h,g,v,T,z,O,U,H,Y,X,oe,_e),{u_gamma_scale:g?Math.cos(ke._pitch)*ke.cameraToCenterDistance:1,u_device_pixel_ratio:z.pixelRatio,u_is_halo:1})},Ko=(E,i,h,g,v,T,z,O,U,H,Y,X,oe,fe)=>d.e(sa(E,i,h,g,v,T,z,O,U,H,Y,!0,X,!0,fe),{u_texsize_icon:oe,u_texture_icon:1}),Mo=(E,i,h)=>({u_matrix:E,u_opacity:i,u_color:h}),zc=(E,i,h,g,v,T)=>d.e((function(z,O,U,H){const Y=U.imageManager.getPattern(z.from.toString()),X=U.imageManager.getPattern(z.to.toString()),{width:oe,height:fe}=U.imageManager.getPixelSize(),_e=Math.pow(2,H.tileID.overscaledZ),ke=H.tileSize*Math.pow(2,U.transform.tileZoom)/_e,Me=ke*(H.tileID.canonical.x+H.tileID.wrap*_e),Pe=ke*H.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Y.tl,u_pattern_br_a:Y.br,u_pattern_tl_b:X.tl,u_pattern_br_b:X.br,u_texsize:[oe,fe],u_mix:O.t,u_pattern_size_a:Y.displaySize,u_pattern_size_b:X.displaySize,u_scale_a:O.fromScale,u_scale_b:O.toScale,u_tile_units_to_pixels:1/vi(H,1,U.transform.tileZoom),u_pixel_coord_upper:[Me>>16,Pe>>16],u_pixel_coord_lower:[65535&Me,65535&Pe]}})(g,T,h,v),{u_matrix:E,u_opacity:i}),Xs={fillExtrusion:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_lightpos:new d.aN(E,i.u_lightpos),u_lightintensity:new d.aI(E,i.u_lightintensity),u_lightcolor:new d.aN(E,i.u_lightcolor),u_vertical_gradient:new d.aI(E,i.u_vertical_gradient),u_opacity:new d.aI(E,i.u_opacity)}),fillExtrusionPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_lightpos:new d.aN(E,i.u_lightpos),u_lightintensity:new d.aI(E,i.u_lightintensity),u_lightcolor:new d.aN(E,i.u_lightcolor),u_vertical_gradient:new d.aI(E,i.u_vertical_gradient),u_height_factor:new d.aI(E,i.u_height_factor),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade),u_opacity:new d.aI(E,i.u_opacity)}),fill:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix)}),fillPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),fillOutline:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world)}),fillOutlinePattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world),u_image:new d.aH(E,i.u_image),u_texsize:new d.aO(E,i.u_texsize),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),circle:(E,i)=>({u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_scale_with_map:new d.aH(E,i.u_scale_with_map),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_extrude_scale:new d.aO(E,i.u_extrude_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_matrix:new d.aJ(E,i.u_matrix)}),collisionBox:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_pixel_extrude_scale:new d.aO(E,i.u_pixel_extrude_scale)}),collisionCircle:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_inv_matrix:new d.aJ(E,i.u_inv_matrix),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_viewport_size:new d.aO(E,i.u_viewport_size)}),debug:(E,i)=>({u_color:new d.aL(E,i.u_color),u_matrix:new d.aJ(E,i.u_matrix),u_overlay:new d.aH(E,i.u_overlay),u_overlay_scale:new d.aI(E,i.u_overlay_scale)}),clippingMask:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix)}),heatmap:(E,i)=>({u_extrude_scale:new d.aI(E,i.u_extrude_scale),u_intensity:new d.aI(E,i.u_intensity),u_matrix:new d.aJ(E,i.u_matrix)}),heatmapTexture:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_world:new d.aO(E,i.u_world),u_image:new d.aH(E,i.u_image),u_color_ramp:new d.aH(E,i.u_color_ramp),u_opacity:new d.aI(E,i.u_opacity)}),hillshade:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_latrange:new d.aO(E,i.u_latrange),u_light:new d.aO(E,i.u_light),u_shadow:new d.aL(E,i.u_shadow),u_highlight:new d.aL(E,i.u_highlight),u_accent:new d.aL(E,i.u_accent)}),hillshadePrepare:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_image:new d.aH(E,i.u_image),u_dimension:new d.aO(E,i.u_dimension),u_zoom:new d.aI(E,i.u_zoom),u_unpack:new d.aK(E,i.u_unpack)}),line:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels)}),lineGradient:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_image:new d.aH(E,i.u_image),u_image_height:new d.aI(E,i.u_image_height)}),linePattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texsize:new d.aO(E,i.u_texsize),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_image:new d.aH(E,i.u_image),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_scale:new d.aN(E,i.u_scale),u_fade:new d.aI(E,i.u_fade)}),lineSDF:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ratio:new d.aI(E,i.u_ratio),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_units_to_pixels:new d.aO(E,i.u_units_to_pixels),u_patternscale_a:new d.aO(E,i.u_patternscale_a),u_patternscale_b:new d.aO(E,i.u_patternscale_b),u_sdfgamma:new d.aI(E,i.u_sdfgamma),u_image:new d.aH(E,i.u_image),u_tex_y_a:new d.aI(E,i.u_tex_y_a),u_tex_y_b:new d.aI(E,i.u_tex_y_b),u_mix:new d.aI(E,i.u_mix)}),raster:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_tl_parent:new d.aO(E,i.u_tl_parent),u_scale_parent:new d.aI(E,i.u_scale_parent),u_buffer_scale:new d.aI(E,i.u_buffer_scale),u_fade_t:new d.aI(E,i.u_fade_t),u_opacity:new d.aI(E,i.u_opacity),u_image0:new d.aH(E,i.u_image0),u_image1:new d.aH(E,i.u_image1),u_brightness_low:new d.aI(E,i.u_brightness_low),u_brightness_high:new d.aI(E,i.u_brightness_high),u_saturation_factor:new d.aI(E,i.u_saturation_factor),u_contrast_factor:new d.aI(E,i.u_contrast_factor),u_spin_weights:new d.aN(E,i.u_spin_weights)}),symbolIcon:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texture:new d.aH(E,i.u_texture),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),symbolSDF:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texture:new d.aH(E,i.u_texture),u_gamma_scale:new d.aI(E,i.u_gamma_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_is_halo:new d.aH(E,i.u_is_halo),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),symbolTextAndIcon:(E,i)=>({u_is_size_zoom_constant:new d.aH(E,i.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(E,i.u_is_size_feature_constant),u_size_t:new d.aI(E,i.u_size_t),u_size:new d.aI(E,i.u_size),u_camera_to_center_distance:new d.aI(E,i.u_camera_to_center_distance),u_pitch:new d.aI(E,i.u_pitch),u_rotate_symbol:new d.aH(E,i.u_rotate_symbol),u_aspect_ratio:new d.aI(E,i.u_aspect_ratio),u_fade_change:new d.aI(E,i.u_fade_change),u_matrix:new d.aJ(E,i.u_matrix),u_label_plane_matrix:new d.aJ(E,i.u_label_plane_matrix),u_coord_matrix:new d.aJ(E,i.u_coord_matrix),u_is_text:new d.aH(E,i.u_is_text),u_pitch_with_map:new d.aH(E,i.u_pitch_with_map),u_is_along_line:new d.aH(E,i.u_is_along_line),u_is_variable_anchor:new d.aH(E,i.u_is_variable_anchor),u_texsize:new d.aO(E,i.u_texsize),u_texsize_icon:new d.aO(E,i.u_texsize_icon),u_texture:new d.aH(E,i.u_texture),u_texture_icon:new d.aH(E,i.u_texture_icon),u_gamma_scale:new d.aI(E,i.u_gamma_scale),u_device_pixel_ratio:new d.aI(E,i.u_device_pixel_ratio),u_is_halo:new d.aH(E,i.u_is_halo),u_translation:new d.aO(E,i.u_translation),u_pitched_scale:new d.aI(E,i.u_pitched_scale)}),background:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_opacity:new d.aI(E,i.u_opacity),u_color:new d.aL(E,i.u_color)}),backgroundPattern:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_opacity:new d.aI(E,i.u_opacity),u_image:new d.aH(E,i.u_image),u_pattern_tl_a:new d.aO(E,i.u_pattern_tl_a),u_pattern_br_a:new d.aO(E,i.u_pattern_br_a),u_pattern_tl_b:new d.aO(E,i.u_pattern_tl_b),u_pattern_br_b:new d.aO(E,i.u_pattern_br_b),u_texsize:new d.aO(E,i.u_texsize),u_mix:new d.aI(E,i.u_mix),u_pattern_size_a:new d.aO(E,i.u_pattern_size_a),u_pattern_size_b:new d.aO(E,i.u_pattern_size_b),u_scale_a:new d.aI(E,i.u_scale_a),u_scale_b:new d.aI(E,i.u_scale_b),u_pixel_coord_upper:new d.aO(E,i.u_pixel_coord_upper),u_pixel_coord_lower:new d.aO(E,i.u_pixel_coord_lower),u_tile_units_to_pixels:new d.aI(E,i.u_tile_units_to_pixels)}),terrain:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texture:new d.aH(E,i.u_texture),u_ele_delta:new d.aI(E,i.u_ele_delta),u_fog_matrix:new d.aJ(E,i.u_fog_matrix),u_fog_color:new d.aL(E,i.u_fog_color),u_fog_ground_blend:new d.aI(E,i.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.aI(E,i.u_fog_ground_blend_opacity),u_horizon_color:new d.aL(E,i.u_horizon_color),u_horizon_fog_blend:new d.aI(E,i.u_horizon_fog_blend)}),terrainDepth:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_ele_delta:new d.aI(E,i.u_ele_delta)}),terrainCoords:(E,i)=>({u_matrix:new d.aJ(E,i.u_matrix),u_texture:new d.aH(E,i.u_texture),u_terrain_coords_id:new d.aI(E,i.u_terrain_coords_id),u_ele_delta:new d.aI(E,i.u_ele_delta)}),sky:(E,i)=>({u_sky_color:new d.aL(E,i.u_sky_color),u_horizon_color:new d.aL(E,i.u_horizon_color),u_horizon:new d.aI(E,i.u_horizon),u_sky_horizon_blend:new d.aI(E,i.u_sky_horizon_blend)})};class Fs{constructor(i,h,g){this.context=i;const v=i.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const h=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Rc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Po{constructor(i,h,g,v){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=i;const T=i.gl;this.buffer=T.createBuffer(),i.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,h){for(let g=0;g<this.attributes.length;g++){const v=h.attributes[this.attributes[g].name];v!==void 0&&i.enableVertexAttribArray(v)}}setVertexAttribPointers(i,h,g){for(let v=0;v<this.attributes.length;v++){const T=this.attributes[v],z=h.attributes[T.name];z!==void 0&&i.vertexAttribPointer(z,T.components,i[Rc[T.type]],!1,this.itemSize,T.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const tn=new WeakMap;function Na(E){var i;if(tn.has(E))return tn.get(E);{const h=(i=E.getParameter(E.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return tn.set(E,h),h}}class Zi{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ra extends Zi{getDefault(){return d.aM.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class ec extends Zi{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Jo extends Zi{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class yu extends Zi{getDefault(){return[!0,!0,!0,!0]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Qu extends Zi{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class eh extends Zi{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Dc extends Zi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const h=this.current;(i.func!==h.func||i.ref!==h.ref||i.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class _u extends Zi{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Oc extends Zi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=i,this.dirty=!1}}class th extends Zi{getDefault(){return[0,1]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class ba extends Zi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=i,this.dirty=!1}}class ih extends Zi{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class oo extends Zi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.BLEND):h.disable(h.BLEND),this.current=i,this.dirty=!1}}class lo extends Zi{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class nh extends Zi{getDefault(){return d.aM.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class vu extends Zi{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Qo extends Zi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=i,this.dirty=!1}}class xu extends Zi{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class tc extends Zi{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class sh extends Zi{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Jh extends Zi{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class bu extends Zi{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Nc extends Zi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class rh extends Zi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Bc extends Zi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class wu extends Zi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class el extends Zi{getDefault(){return null}set(i){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class _r extends Zi{getDefault(){return null}set(i){var h;if(i===this.current&&!this.dirty)return;const g=this.gl;Na(g)?g.bindVertexArray(i):(h=g.getExtension("OES_vertex_array_object"))===null||h===void 0||h.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Su extends Zi{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class tl extends Zi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Pr extends Zi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class il extends Zi{constructor(i,h){super(i),this.context=i,this.parent=h}getDefault(){return null}}class Io extends il{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class nl extends il{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Rl extends il{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class $c{constructor(i,h,g,v,T){this.context=i,this.width=h,this.height=g;const z=i.gl,O=this.framebuffer=z.createFramebuffer();if(this.colorAttachment=new Io(i,O),v)this.depthAttachment=T?new Rl(i,O):new nl(i,O);else if(T)throw new Error("Stencil cannot be set without depth");if(z.checkFramebufferStatus(z.FRAMEBUFFER)!==z.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,h=this.colorAttachment.get();if(h&&i.deleteTexture(h),this.depthAttachment){const g=this.depthAttachment.get();g&&i.deleteRenderbuffer(g)}i.deleteFramebuffer(this.framebuffer)}}class ps{constructor(i,h,g){this.blendFunction=i,this.blendColor=h,this.mask=g}}ps.Replace=[1,0],ps.disabled=new ps(ps.Replace,d.aM.transparent,[!1,!1,!1,!1]),ps.unblended=new ps(ps.Replace,d.aM.transparent,[!0,!0,!0,!0]),ps.alphaBlended=new ps([1,771],d.aM.transparent,[!0,!0,!0,!0]);class ah{constructor(i){var h,g;if(this.gl=i,this.clearColor=new ra(this),this.clearDepth=new ec(this),this.clearStencil=new Jo(this),this.colorMask=new yu(this),this.depthMask=new Qu(this),this.stencilMask=new eh(this),this.stencilFunc=new Dc(this),this.stencilOp=new _u(this),this.stencilTest=new Oc(this),this.depthRange=new th(this),this.depthTest=new ba(this),this.depthFunc=new ih(this),this.blend=new oo(this),this.blendFunc=new lo(this),this.blendColor=new nh(this),this.blendEquation=new vu(this),this.cullFace=new Qo(this),this.cullFaceSide=new xu(this),this.frontFace=new tc(this),this.program=new sh(this),this.activeTexture=new Jh(this),this.viewport=new bu(this),this.bindFramebuffer=new Nc(this),this.bindRenderbuffer=new rh(this),this.bindTexture=new Bc(this),this.bindVertexBuffer=new wu(this),this.bindElementBuffer=new el(this),this.bindVertexArray=new _r(this),this.pixelStoreUnpack=new Su(this),this.pixelStoreUnpackPremultiplyAlpha=new tl(this),this.pixelStoreUnpackFlipY=new Pr(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),Na(i)){this.HALF_FLOAT=i.HALF_FLOAT;const v=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(h=i.RGBA16F)!==null&&h!==void 0?h:v?.RGBA16F_EXT,this.RGB16F=(g=i.RGB16F)!==null&&g!==void 0?g:v?.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const v=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,h){return new Fs(this,i,h)}createVertexBuffer(i,h,g){return new Po(this,i,h,g)}createRenderbuffer(i,h,g){const v=this.gl,T=v.createRenderbuffer();return this.bindRenderbuffer.set(T),v.renderbufferStorage(v.RENDERBUFFER,i,h,g),this.bindRenderbuffer.set(null),T}createFramebuffer(i,h,g,v){return new $c(this,i,h,g,v)}clear({color:i,depth:h,stencil:g}){const v=this.gl;let T=0;i&&(T|=v.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(T|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g!==void 0&&(T|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),v.clear(T)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){d.aE(i.blendFunction,ps.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return Na(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var h;return Na(this.gl)?this.gl.deleteVertexArray(i):(h=this.gl.getExtension("OES_vertex_array_object"))===null||h===void 0?void 0:h.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class Yi{constructor(i,h,g){this.func=i,this.mask=h,this.range=g}}Yi.ReadOnly=!1,Yi.ReadWrite=!0,Yi.disabled=new Yi(519,Yi.ReadOnly,[0,1]);const co=7680;class mn{constructor(i,h,g,v,T,z){this.test=i,this.ref=h,this.mask=g,this.fail=v,this.depthFail=T,this.pass=z}}mn.disabled=new mn({func:519,mask:0},0,0,co,co,co);class Tn{constructor(i,h,g){this.enable=i,this.mode=h,this.frontFace=g}}let sl;function Ir(E,i,h,g,v){const T=E.context,z=T.gl,O=E.useProgram("collisionBox"),U=[];let H=0,Y=0;for(let Pe=0;Pe<g.length;Pe++){const Le=g[Pe],Te=i.getTile(Le).getBucket(h);if(!Te)continue;const $e=v?Te.textCollisionBox:Te.iconCollisionBox,Ve=Te.collisionCircleArray;if(Ve.length>0){const it=d.H();d.aQ(it,Te.placementInvProjMatrix,E.transform.glCoordMatrix),d.aQ(it,it,Te.placementViewportMatrix),U.push({circleArray:Ve,circleOffset:Y,transform:Le.posMatrix,invTransform:it,coord:Le}),H+=Ve.length/4,Y=H}$e&&O.draw(T,z.LINES,Yi.disabled,mn.disabled,E.colorModeForRenderPass(),Tn.disabled,{u_matrix:Le.posMatrix,u_pixel_extrude_scale:[1/(X=E.transform).width,1/X.height]},E.style.map.terrain&&E.style.map.terrain.getTerrainData(Le),h.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,null,E.transform.zoom,null,null,$e.collisionVertexBuffer)}var X;if(!v||!U.length)return;const oe=E.useProgram("collisionCircle"),fe=new d.aR;fe.resize(4*H),fe._trim();let _e=0;for(const Pe of U)for(let Le=0;Le<Pe.circleArray.length/4;Le++){const Te=4*Le,$e=Pe.circleArray[Te+0],Ve=Pe.circleArray[Te+1],it=Pe.circleArray[Te+2],bt=Pe.circleArray[Te+3];fe.emplace(_e++,$e,Ve,it,bt,0),fe.emplace(_e++,$e,Ve,it,bt,1),fe.emplace(_e++,$e,Ve,it,bt,2),fe.emplace(_e++,$e,Ve,it,bt,3)}(!sl||sl.length<2*H)&&(sl=(function(Pe){const Le=2*Pe,Te=new d.aT;Te.resize(Le),Te._trim();for(let $e=0;$e<Le;$e++){const Ve=6*$e;Te.uint16[Ve+0]=4*$e+0,Te.uint16[Ve+1]=4*$e+1,Te.uint16[Ve+2]=4*$e+2,Te.uint16[Ve+3]=4*$e+2,Te.uint16[Ve+4]=4*$e+3,Te.uint16[Ve+5]=4*$e+0}return Te})(H));const ke=T.createIndexBuffer(sl,!0),Me=T.createVertexBuffer(fe,d.aS.members,!0);for(const Pe of U){const Le=$s(Pe.transform,Pe.invTransform,E.transform);oe.draw(T,z.TRIANGLES,Yi.disabled,mn.disabled,E.colorModeForRenderPass(),Tn.disabled,Le,E.style.map.terrain&&E.style.map.terrain.getTerrainData(Pe.coord),h.id,Me,ke,d.a0.simpleSegment(0,2*Pe.circleOffset,Pe.circleArray.length,Pe.circleArray.length/2),null,E.transform.zoom,null,null,null)}Me.destroy(),ke.destroy()}Tn.disabled=new Tn(!1,1029,2305),Tn.backCCW=new Tn(!0,1029,2305);const Dl=d.an(new Float32Array(16));function aa(E,i,h,g,v,T){const{horizontalAlign:z,verticalAlign:O}=d.au(E);return new d.P((-(z-.5)*i/v+g[0])*T,(-(O-.5)*h/v+g[1])*T)}function wa(E,i,h,g,v,T){const z=i.tileAnchorPoint.add(new d.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let O=g.mult(T);h||(O=O.rotate(-v));const U=z.add(O);return xe(U.x,U.y,i.labelPlaneMatrix,i.getElevation).point}if(h){const O=Je(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(E),U=Math.atan(O.y/O.x)+(O.x<0?Math.PI:0);return E.add(g.rotate(U))}return E.add(g)}function Ba(E,i,h,g,v,T,z,O,U,H,Y,X,oe,fe){const _e=E.text.placedSymbolArray,ke=E.text.dynamicLayoutVertexArray,Me=E.icon.dynamicLayoutVertexArray,Pe={};ke.clear();for(let Le=0;Le<_e.length;Le++){const Te=_e.get(Le),$e=Te.hidden||!Te.crossTileID||E.allowVerticalPlacement&&!Te.placedOrientation?null:g[Te.crossTileID];if($e){const Ve=new d.P(Te.anchorX,Te.anchorY),it={getElevation:fe,width:v.width,height:v.height,labelPlaneMatrix:T,pitchWithMap:h,projection:Y,tileAnchorPoint:Ve,translation:X,unwrappedTileID:oe},bt=h?xe(Ve.x,Ve.y,z,fe):Je(Ve.x,Ve.y,it),Ut=ee(v.cameraToCenterDistance,bt.signedDistanceFromCamera);let qt=d.ai(E.textSizeData,U,Te)*Ut/d.ap;h&&(qt*=E.tilePixelRatio/O);const{width:ii,height:Ht,anchor:Ft,textOffset:oi,textBoxScale:ji}=$e,Zt=aa(Ft,ii,Ht,oi,ji,qt),Xt=Y.getPitchedTextCorrection(v,Ve.add(new d.P(X[0],X[1])),oe),Ii=wa(bt.point,it,i,Zt,v.angle,Xt),Vn=E.allowVerticalPlacement&&Te.placedOrientation===d.ah.vertical?Math.PI/2:0;for(let Xi=0;Xi<Te.numGlyphs;Xi++)d.aj(ke,Ii,Vn);H&&Te.associatedIconIndex>=0&&(Pe[Te.associatedIconIndex]={shiftedAnchor:Ii,angle:Vn})}else si(Te.numGlyphs,ke)}if(H){Me.clear();const Le=E.icon.placedSymbolArray;for(let Te=0;Te<Le.length;Te++){const $e=Le.get(Te);if($e.hidden)si($e.numGlyphs,Me);else{const Ve=Pe[Te];if(Ve)for(let it=0;it<$e.numGlyphs;it++)d.aj(Me,Ve.shiftedAnchor,Ve.angle);else si($e.numGlyphs,Me)}}E.icon.dynamicLayoutVertexBuffer.updateData(Me)}E.text.dynamicLayoutVertexBuffer.updateData(ke)}function nr(E,i,h){return h.iconsInText&&i?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function rl(E,i,h,g,v,T,z,O,U,H,Y,X){const oe=E.context,fe=oe.gl,_e=E.transform,ke=_a(),Me=O==="map",Pe=U==="map",Le=O!=="viewport"&&h.layout.get("symbol-placement")!=="point",Te=Me&&!Pe&&!Le,$e=!Pe&&Le,Ve=!h.layout.get("symbol-sort-key").isConstant();let it=!1;const bt=E.depthModeForSublayer(0,Yi.ReadOnly),Ut=h._unevaluatedLayout.hasValue("text-variable-anchor")||h._unevaluatedLayout.hasValue("text-variable-anchor-offset"),qt=[],ii=ke.getCircleRadiusCorrection(_e);for(const Ht of g){const Ft=i.getTile(Ht),oi=Ft.getBucket(h);if(!oi)continue;const ji=v?oi.text:oi.icon;if(!ji||!ji.segments.get().length||!ji.hasVisibleVertices)continue;const Zt=ji.programConfigurations.get(h.id),Xt=v||oi.sdfIcons,Ii=v?oi.textSizeData:oi.iconSizeData,Vn=Pe||_e.pitch!==0,Xi=E.useProgram(nr(Xt,v,oi),Zt),un=d.ag(Ii,_e.zoom),$n=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ht);let Qs,Ha,Jn,Lr,rs=[0,0],as=null;if(v)Ha=Ft.glyphAtlasTexture,Jn=fe.LINEAR,Qs=Ft.glyphAtlasTexture.size,oi.iconsInText&&(rs=Ft.imageAtlasTexture.size,as=Ft.imageAtlasTexture,Lr=Vn||E.options.rotating||E.options.zooming||Ii.kind==="composite"||Ii.kind==="camera"?fe.LINEAR:fe.NEAREST);else{const sn=h.layout.get("icon-size").constantOr(0)!==1||oi.iconsNeedLinear;Ha=Ft.imageAtlasTexture,Jn=Xt||E.options.rotating||E.options.zooming||sn||Vn?fe.LINEAR:fe.NEAREST,Qs=Ft.imageAtlasTexture.size}const Ms=vi(Ft,1,E.transform.zoom),Za=$e?Ht.posMatrix:Dl,uc=Ci(Za,Pe,Me,E.transform,Ms),go=bi(Za,Pe,Me,E.transform,Ms),sr=bi(Ht.posMatrix,Pe,Me,E.transform,Ms),Rn=ke.translatePosition(E.transform,Ft,T,z),hc=Ut&&oi.hasTextData(),yo=h.layout.get("icon-text-fit")!=="none"&&hc&&oi.hasIconData();if(Le){const sn=E.style.map.terrain?(Hc,ls)=>E.style.map.terrain.getElevation(Ht,Hc,ls):null,Ga=h.layout.get("text-rotation-alignment")==="map";ue(oi,Ht.posMatrix,E,v,uc,sr,Pe,H,Ga,ke,Ht.toUnwrapped(),_e.width,_e.height,Rn,sn)}const Ri=Ht.posMatrix,gn=v&&Ut||yo,os=Le||gn?Dl:uc,ha=go,Ps=Xt&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Is;Is=Xt?oi.iconsInText?Ko(Ii.kind,un,Te,Pe,Le,gn,E,Ri,os,ha,Rn,Qs,rs,ii):sa(Ii.kind,un,Te,Pe,Le,gn,E,Ri,os,ha,Rn,v,Qs,!0,ii):xs(Ii.kind,un,Te,Pe,Le,gn,E,Ri,os,ha,Rn,v,Qs,ii);const zr={program:Xi,buffers:ji,uniformValues:Is,atlasTexture:Ha,atlasTextureIcon:as,atlasInterpolation:Jn,atlasInterpolationIcon:Lr,isSDF:Xt,hasHalo:Ps};if(Ve&&oi.canOverlap){it=!0;const sn=ji.segments.get();for(const Ga of sn)qt.push({segments:new d.a0([Ga]),sortKey:Ga.sortKey,state:zr,terrainData:$n})}else qt.push({segments:ji.segments,sortKey:0,state:zr,terrainData:$n})}it&&qt.sort(((Ht,Ft)=>Ht.sortKey-Ft.sortKey));for(const Ht of qt){const Ft=Ht.state;if(oe.activeTexture.set(fe.TEXTURE0),Ft.atlasTexture.bind(Ft.atlasInterpolation,fe.CLAMP_TO_EDGE),Ft.atlasTextureIcon&&(oe.activeTexture.set(fe.TEXTURE1),Ft.atlasTextureIcon&&Ft.atlasTextureIcon.bind(Ft.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),Ft.isSDF){const oi=Ft.uniformValues;Ft.hasHalo&&(oi.u_is_halo=1,Uc(Ft.buffers,Ht.segments,h,E,Ft.program,bt,Y,X,oi,Ht.terrainData)),oi.u_is_halo=0}Uc(Ft.buffers,Ht.segments,h,E,Ft.program,bt,Y,X,Ft.uniformValues,Ht.terrainData)}}function Uc(E,i,h,g,v,T,z,O,U,H){const Y=g.context;v.draw(Y,Y.gl.TRIANGLES,T,z,O,Tn.disabled,U,H,h.id,E.layoutVertexBuffer,E.indexBuffer,i,h.paint,g.transform.zoom,E.programConfigurations.get(h.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function oa(E,i,h,g){const v=E.context,T=v.gl,z=mn.disabled,O=new ps([T.ONE,T.ONE],d.aM.transparent,[!0,!0,!0,!0]),U=i.getBucket(h);if(!U)return;const H=g.key;let Y=h.heatmapFbos.get(H);Y||(Y=Ol(v,i.tileSize,i.tileSize),h.heatmapFbos.set(H,Y)),v.bindFramebuffer.set(Y.framebuffer),v.viewport.set([0,0,i.tileSize,i.tileSize]),v.clear({color:d.aM.transparent});const X=U.programConfigurations.get(h.id),oe=E.useProgram("heatmap",X),fe=E.style.map.terrain.getTerrainData(g);oe.draw(v,T.TRIANGLES,Yi.disabled,z,O,Tn.disabled,Rs(g.posMatrix,i,E.transform.zoom,h.paint.get("heatmap-intensity")),fe,h.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,h.paint,E.transform.zoom,X)}function la(E,i,h){const g=E.context,v=g.gl;g.setColorMode(E.colorModeForRenderPass());const T=jo(g,i),z=h.key,O=i.heatmapFbos.get(z);O&&(g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,O.colorAttachment.get()),g.activeTexture.set(v.TEXTURE1),T.bind(v.LINEAR,v.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(g,v.TRIANGLES,Yi.disabled,mn.disabled,E.colorModeForRenderPass(),Tn.disabled,Di(E,i,0,1),null,i.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments,i.paint,E.transform.zoom),O.destroy(),i.heatmapFbos.delete(z))}function Ol(E,i,h){var g,v;const T=E.gl,z=T.createTexture();T.bindTexture(T.TEXTURE_2D,z),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR);const O=(g=E.HALF_FLOAT)!==null&&g!==void 0?g:T.UNSIGNED_BYTE,U=(v=E.RGBA16F)!==null&&v!==void 0?v:T.RGBA;T.texImage2D(T.TEXTURE_2D,0,U,i,h,0,T.RGBA,O,null);const H=E.createFramebuffer(i,h,!1,!1);return H.colorAttachment.set(z),H}function jo(E,i){return i.colorRampTexture||(i.colorRampTexture=new lt(E,i.colorRamp,E.gl.RGBA)),i.colorRampTexture}function al(E,i,h,g,v){if(!h||!g||!g.imageAtlas)return;const T=g.imageAtlas.patternPositions;let z=T[h.to.toString()],O=T[h.from.toString()];if(!z&&O&&(z=O),!O&&z&&(O=z),!z||!O){const U=v.getPaintProperty(i);z=T[U],O=T[U]}z&&O&&E.setConstantPatternPositions(z,O)}function Fr(E,i,h,g,v,T,z){const O=E.context.gl,U="fill-pattern",H=h.paint.get(U),Y=H&&H.constantOr(1),X=h.getCrossfadeParameters();let oe,fe,_e,ke,Me;z?(fe=Y&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",oe=O.LINES):(fe=Y?"fillPattern":"fill",oe=O.TRIANGLES);const Pe=H.constantOr(null);for(const Le of g){const Te=i.getTile(Le);if(Y&&!Te.patternsLoaded())continue;const $e=Te.getBucket(h);if(!$e)continue;const Ve=$e.programConfigurations.get(h.id),it=E.useProgram(fe,Ve),bt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Le);Y&&(E.context.activeTexture.set(O.TEXTURE0),Te.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ve.updatePaintBuffers(X)),al(Ve,U,Pe,Te,h);const Ut=bt?Le:null,qt=E.translatePosMatrix(Ut?Ut.posMatrix:Le.posMatrix,Te,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(z){ke=$e.indexBuffer2,Me=$e.segments2;const ii=[O.drawingBufferWidth,O.drawingBufferHeight];_e=fe==="fillOutlinePattern"&&Y?jc(qt,E,X,Te,ii):Ic(qt,ii)}else ke=$e.indexBuffer,Me=$e.segments,_e=Y?jl(qt,E,X,Te):ao(qt);it.draw(E.context,oe,v,E.stencilModeForClipping(Le),T,Tn.disabled,_e,bt,h.id,$e.layoutVertexBuffer,ke,Me,h.paint,E.transform.zoom,Ve)}}function Fc(E,i,h,g,v,T,z){const O=E.context,U=O.gl,H="fill-extrusion-pattern",Y=h.paint.get(H),X=Y.constantOr(1),oe=h.getCrossfadeParameters(),fe=h.paint.get("fill-extrusion-opacity"),_e=Y.constantOr(null);for(const ke of g){const Me=i.getTile(ke),Pe=Me.getBucket(h);if(!Pe)continue;const Le=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ke),Te=Pe.programConfigurations.get(h.id),$e=E.useProgram(X?"fillExtrusionPattern":"fillExtrusion",Te);X&&(E.context.activeTexture.set(U.TEXTURE0),Me.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Te.updatePaintBuffers(oe)),al(Te,H,_e,Me,h);const Ve=E.translatePosMatrix(ke.posMatrix,Me,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),it=h.paint.get("fill-extrusion-vertical-gradient"),bt=X?ro(Ve,E,it,fe,ke,oe,Me):Yo(Ve,E,it,fe);$e.draw(O,O.gl.TRIANGLES,v,T,z,Tn.backCCW,bt,Le,h.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,h.paint,E.transform.zoom,Te,E.style.map.terrain&&Pe.centroidVertexBuffer)}}function Sa(E,i,h,g,v,T,z){const O=E.context,U=O.gl,H=h.fbo;if(!H)return;const Y=E.useProgram("hillshade"),X=E.style.map.terrain&&E.style.map.terrain.getTerrainData(i);O.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,H.colorAttachment.get()),Y.draw(O,U.TRIANGLES,v,T,z,Tn.disabled,((oe,fe,_e,ke)=>{const Me=_e.paint.get("hillshade-shadow-color"),Pe=_e.paint.get("hillshade-highlight-color"),Le=_e.paint.get("hillshade-accent-color");let Te=_e.paint.get("hillshade-illumination-direction")*(Math.PI/180);_e.paint.get("hillshade-illumination-anchor")==="viewport"&&(Te-=oe.transform.angle);const $e=!oe.options.moving;return{u_matrix:ke?ke.posMatrix:oe.transform.calculatePosMatrix(fe.tileID.toUnwrapped(),$e),u_image:0,u_latrange:Mr(0,fe.tileID),u_light:[_e.paint.get("hillshade-exaggeration"),Te],u_shadow:Me,u_highlight:Pe,u_accent:Le}})(E,h,g,X?i:null),X,g.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}function Nl(E,i,h,g,v,T){const z=E.context,O=z.gl,U=i.dem;if(U&&U.data){const H=U.dim,Y=U.stride,X=U.getPixels();if(z.activeTexture.set(O.TEXTURE1),z.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||E.getTileTexture(Y),i.demTexture){const fe=i.demTexture;fe.update(X,{premultiply:!1}),fe.bind(O.NEAREST,O.CLAMP_TO_EDGE)}else i.demTexture=new lt(z,X,O.RGBA,{premultiply:!1}),i.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);z.activeTexture.set(O.TEXTURE0);let oe=i.fbo;if(!oe){const fe=new lt(z,{width:H,height:H,data:null},O.RGBA);fe.bind(O.LINEAR,O.CLAMP_TO_EDGE),oe=i.fbo=z.createFramebuffer(H,H,!0,!1),oe.colorAttachment.set(fe.texture)}z.bindFramebuffer.set(oe.framebuffer),z.viewport.set([0,0,H,H]),E.useProgram("hillshadePrepare").draw(z,O.TRIANGLES,g,v,T,Tn.disabled,((fe,_e)=>{const ke=_e.stride,Me=d.H();return d.aP(Me,0,d.X,-d.X,0,0,1),d.J(Me,Me,[0,-d.X,0]),{u_matrix:Me,u_image:1,u_dimension:[ke,ke],u_zoom:fe.overscaledZ,u_unpack:_e.getUnpackVector()}})(i.tileID,U),null,h.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function $a(E,i,h,g,v,T){const z=g.paint.get("raster-fade-duration");if(!T&&z>0){const O=N.now(),U=(O-E.timeAdded)/z,H=i?(O-i.timeAdded)/z:-1,Y=h.getSource(),X=v.coveringZoomLevel({tileSize:Y.tileSize,roundZoom:Y.roundZoom}),oe=!i||Math.abs(i.tileID.overscaledZ-X)>Math.abs(E.tileID.overscaledZ-X),fe=oe&&E.refreshedUponExpiration?1:d.ac(oe?U:1-H,0,1);return E.refreshedUponExpiration&&U>=1&&(E.refreshedUponExpiration=!1),i?{opacity:1,mix:1-fe}:{opacity:fe,mix:0}}return{opacity:1,mix:0}}const Vs=new d.aM(1,0,0,1),on=new d.aM(0,1,0,1),ol=new d.aM(0,0,1,1),ic=new d.aM(1,0,1,1),nc=new d.aM(0,1,1,1);function Ua(E,i,h,g){ll(E,0,i+h/2,E.transform.width,h,g)}function uo(E,i,h,g){ll(E,i-h/2,0,h,E.transform.height,g)}function ll(E,i,h,g,v,T){const z=E.context,O=z.gl;O.enable(O.SCISSOR_TEST),O.scissor(i*E.pixelRatio,h*E.pixelRatio,g*E.pixelRatio,v*E.pixelRatio),z.clear({color:T}),O.disable(O.SCISSOR_TEST)}function ho(E,i,h){const g=E.context,v=g.gl,T=h.posMatrix,z=E.useProgram("debug"),O=Yi.disabled,U=mn.disabled,H=E.colorModeForRenderPass(),Y="$debug",X=E.style.map.terrain&&E.style.map.terrain.getTerrainData(h);g.activeTexture.set(v.TEXTURE0);const oe=i.getTileByID(h.key).latestRawTileData,fe=Math.floor((oe&&oe.byteLength||0)/1024),_e=i.getTile(h).tileSize,ke=512/Math.min(_e,512)*(h.overscaledZ/E.transform.zoom)*.5;let Me=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Me+=` => ${h.overscaledZ}`),(function(Pe,Le){Pe.initDebugOverlayCanvas();const Te=Pe.debugOverlayCanvas,$e=Pe.context.gl,Ve=Pe.debugOverlayCanvas.getContext("2d");Ve.clearRect(0,0,Te.width,Te.height),Ve.shadowColor="white",Ve.shadowBlur=2,Ve.lineWidth=1.5,Ve.strokeStyle="white",Ve.textBaseline="top",Ve.font="bold 36px Open Sans, sans-serif",Ve.fillText(Le,5,5),Ve.strokeText(Le,5,5),Pe.debugOverlayTexture.update(Te),Pe.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)})(E,`${Me} ${fe}kB`),z.draw(g,v.TRIANGLES,O,U,ps.alphaBlended,Tn.disabled,Ao(T,d.aM.transparent,ke),null,Y,E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments),z.draw(g,v.LINE_STRIP,O,U,H,Tn.disabled,Ao(T,d.aM.red),X,Y,E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments)}function sc(E,i,h){const g=E.context,v=g.gl,T=E.colorModeForRenderPass(),z=new Yi(v.LEQUAL,Yi.ReadWrite,E.depthRangeFor3D),O=E.useProgram("terrain"),U=i.getTerrainMesh();g.bindFramebuffer.set(null),g.viewport.set([0,0,E.width,E.height]);for(const H of h){const Y=E.renderToTexture.getTexture(H),X=i.getTerrainData(H.tileID);g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,Y.texture);const oe=E.transform.calculatePosMatrix(H.tileID.toUnwrapped()),fe=i.getMeshFrameDelta(E.transform.zoom),_e=E.transform.calculateFogMatrix(H.tileID.toUnwrapped()),ke=Gn(oe,fe,_e,E.style.sky,E.transform.pitch);O.draw(g,v.TRIANGLES,z,mn.disabled,T,Tn.backCCW,ke,X,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}class Lo{constructor(i,h,g){this.vertexBuffer=i,this.indexBuffer=h,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class fo{constructor(i,h){this.context=new ah(i),this.transform=h,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ti.maxUnderzooming+ti.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Hi}resize(i,h,g){if(this.width=Math.floor(i*g),this.height=Math.floor(h*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const i=this.context,h=new d.aX;h.emplaceBack(0,0),h.emplaceBack(d.X,0),h.emplaceBack(0,d.X),h.emplaceBack(d.X,d.X),this.tileExtentBuffer=i.createVertexBuffer(h,Bn.members),this.tileExtentSegments=d.a0.simpleSegment(0,0,4,2);const g=new d.aX;g.emplaceBack(0,0),g.emplaceBack(d.X,0),g.emplaceBack(0,d.X),g.emplaceBack(d.X,d.X),this.debugBuffer=i.createVertexBuffer(g,Bn.members),this.debugSegments=d.a0.simpleSegment(0,0,4,5);const v=new d.$;v.emplaceBack(0,0,0,0),v.emplaceBack(d.X,0,d.X,0),v.emplaceBack(0,d.X,0,d.X),v.emplaceBack(d.X,d.X,d.X,d.X),this.rasterBoundsBuffer=i.createVertexBuffer(v,Ln.members),this.rasterBoundsSegments=d.a0.simpleSegment(0,0,4,2);const T=new d.aX;T.emplaceBack(0,0),T.emplaceBack(1,0),T.emplaceBack(0,1),T.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(T,Bn.members),this.viewportSegments=d.a0.simpleSegment(0,0,4,2);const z=new d.aZ;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(z);const O=new d.aY;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(O);const U=this.context.gl;this.stencilClearMode=new mn({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO)}clearStencil(){const i=this.context,h=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=d.H();d.aP(g,0,this.width,this.height,0,0,1),d.K(g,g,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,h.TRIANGLES,Yi.disabled,this.stencilClearMode,ps.disabled,Tn.disabled,Us(g),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,h){if(this.currentStencilSource===i.source||!i.isTileClipped()||!h||!h.length)return;this.currentStencilSource=i.source;const g=this.context,v=g.gl;this.nextStencilID+h.length>256&&this.clearStencil(),g.setColorMode(ps.disabled),g.setDepthMode(Yi.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of h){const O=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z);T.draw(g,v.TRIANGLES,Yi.disabled,new mn({func:v.ALWAYS,mask:0},O,255,v.KEEP,v.KEEP,v.REPLACE),ps.disabled,Tn.disabled,Us(z.posMatrix),U,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,h=this.context.gl;return new mn({func:h.NOTEQUAL,mask:255},i,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(i){const h=this.context.gl;return new mn({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(i){const h=this.context.gl,g=i.sort(((z,O)=>O.overscaledZ-z.overscaledZ)),v=g[g.length-1].overscaledZ,T=g[0].overscaledZ-v+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const z={};for(let O=0;O<T;O++)z[O+v]=new mn({func:h.GEQUAL,mask:255},O+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=T,[z,g]}return[{[v]:mn.disabled},g]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new ps([i.CONSTANT_COLOR,i.ONE],new d.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ps.unblended:ps.alphaBlended}depthModeForSublayer(i,h,g){if(!this.opaquePassEnabledForLayer())return Yi.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Yi(g||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,h){this.style=i,this.options=h,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(N.now()),this.imageManager.beginFrame();const g=this.style._order,v=this.style.sourceCaches,T={},z={},O={};for(const U in v){const H=v[U];H.used&&H.prepare(this.context),T[U]=H.getVisibleCoordinates(),z[U]=T[U].slice().reverse(),O[U]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<g.length;U++)if(this.style._layers[g[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of g){const H=this.style._layers[U];if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const Y=z[H.source];(H.type==="custom"||Y.length)&&this.renderLayer(this,v[H.source],H,Y)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?d.aM.black:d.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(U,H){const Y=U.context,X=Y.gl,oe=((Pe,Le,Te)=>({u_sky_color:Pe.properties.get("sky-color"),u_horizon_color:Pe.properties.get("horizon-color"),u_horizon:(Le.height/2+Le.getHorizon())*Te,u_sky_horizon_blend:Pe.properties.get("sky-horizon-blend")*Le.height/2*Te}))(H,U.style.map.transform,U.pixelRatio),fe=new Yi(X.LEQUAL,Yi.ReadWrite,[0,1]),_e=mn.disabled,ke=U.colorModeForRenderPass(),Me=U.useProgram("sky");if(!H.mesh){const Pe=new d.aX;Pe.emplaceBack(-1,-1),Pe.emplaceBack(1,-1),Pe.emplaceBack(1,1),Pe.emplaceBack(-1,1);const Le=new d.aY;Le.emplaceBack(0,1,2),Le.emplaceBack(0,2,3),H.mesh=new Lo(Y.createVertexBuffer(Pe,Bn.members),Y.createIndexBuffer(Le),d.a0.simpleSegment(0,0,Pe.length,Le.length))}Me.draw(Y,X.TRIANGLES,fe,_e,ke,Tn.disabled,oe,void 0,"sky",H.mesh.vertexBuffer,H.mesh.indexBuffer,H.mesh.segments)})(this,this.style.sky),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[g[this.currentLayer]],H=v[U.source],Y=T[U.source];this._renderTileClippingMasks(U,Y),this.renderLayer(this,H,U,Y)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const U=this.style._layers[g[this.currentLayer]],H=v[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U))continue;const Y=(U.type==="symbol"?O:z)[U.source];this._renderTileClippingMasks(U,T[U.source]),this.renderLayer(this,H,U,Y)}if(this.options.showTileBoundaries){const U=(function(H,Y){let X=null;const oe=Object.values(H._layers).flatMap((Me=>Me.source&&!Me.isHidden(Y)?[H.sourceCaches[Me.source]]:[])),fe=oe.filter((Me=>Me.getSource().type==="vector")),_e=oe.filter((Me=>Me.getSource().type!=="vector")),ke=Me=>{(!X||X.getSource().maxzoom<Me.getSource().maxzoom)&&(X=Me)};return fe.forEach((Me=>ke(Me))),X||_e.forEach((Me=>ke(Me))),X})(this.style,this.transform.zoom);U&&(function(H,Y,X){for(let oe=0;oe<X.length;oe++)ho(H,Y,X[oe])})(this,U,U.getVisibleCoordinates())}this.options.showPadding&&(function(U){const H=U.transform.padding;Ua(U,U.transform.height-(H.top||0),3,Vs),Ua(U,H.bottom||0,3,on),uo(U,H.left||0,3,ol),uo(U,U.transform.width-(H.right||0),3,ic);const Y=U.transform.centerPoint;(function(X,oe,fe,_e){ll(X,oe-1,fe-10,2,20,_e),ll(X,oe-10,fe-1,20,2,_e)})(U,Y.x,U.transform.height-Y.y,nc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const h=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=i?!d.a_(h,g):!d.a$(h,g)),v||(v=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),v&&(d.b0(h,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(T,z){const O=T.context,U=O.gl,H=ps.unblended,Y=new Yi(U.LEQUAL,Yi.ReadWrite,[0,1]),X=z.getTerrainMesh(),oe=z.sourceCache.getRenderableTiles(),fe=T.useProgram("terrainDepth");O.bindFramebuffer.set(z.getFramebuffer("depth").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:d.aM.transparent,depth:1});for(const _e of oe){const ke=z.getTerrainData(_e.tileID),Me={u_matrix:T.transform.calculatePosMatrix(_e.tileID.toUnwrapped()),u_ele_delta:z.getMeshFrameDelta(T.transform.zoom)};fe.draw(O,U.TRIANGLES,Y,mn.disabled,H,Tn.backCCW,Me,ke,"terrain",X.vertexBuffer,X.indexBuffer,X.segments)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain),(function(T,z){const O=T.context,U=O.gl,H=ps.unblended,Y=new Yi(U.LEQUAL,Yi.ReadWrite,[0,1]),X=z.getTerrainMesh(),oe=z.getCoordsTexture(),fe=z.sourceCache.getRenderableTiles(),_e=T.useProgram("terrainCoords");O.bindFramebuffer.set(z.getFramebuffer("coords").framebuffer),O.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),O.clear({color:d.aM.transparent,depth:1}),z.coordsIndex=[];for(const ke of fe){const Me=z.getTerrainData(ke.tileID);O.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,oe.texture);const Pe={u_matrix:T.transform.calculatePosMatrix(ke.tileID.toUnwrapped()),u_terrain_coords_id:(255-z.coordsIndex.length)/255,u_texture:0,u_ele_delta:z.getMeshFrameDelta(T.transform.zoom)};_e.draw(O,U.TRIANGLES,Y,mn.disabled,H,Tn.backCCW,Pe,Me,"terrain",X.vertexBuffer,X.indexBuffer,X.segments),z.coordsIndex.push(ke.tileID.key)}O.bindFramebuffer.set(null),O.viewport.set([0,0,T.width,T.height])})(this,this.style.map.terrain))}renderLayer(i,h,g,v){if(!g.isHidden(this.transform.zoom)&&(g.type==="background"||g.type==="custom"||(v||[]).length))switch(this.id=g.id,g.type){case"symbol":(function(T,z,O,U,H){if(T.renderPass!=="translucent")return;const Y=mn.disabled,X=T.colorModeForRenderPass();(O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(oe,fe,_e,ke,Me,Pe,Le,Te,$e){const Ve=fe.transform,it=_a(),bt=Me==="map",Ut=Pe==="map";for(const qt of oe){const ii=ke.getTile(qt),Ht=ii.getBucket(_e);if(!Ht||!Ht.text||!Ht.text.segments.get().length)continue;const Ft=d.ag(Ht.textSizeData,Ve.zoom),oi=vi(ii,1,fe.transform.zoom),ji=Ci(qt.posMatrix,Ut,bt,fe.transform,oi),Zt=_e.layout.get("icon-text-fit")!=="none"&&Ht.hasIconData();if(Ft){const Xt=Math.pow(2,Ve.zoom-ii.tileID.overscaledZ),Ii=fe.style.map.terrain?(Xi,un)=>fe.style.map.terrain.getElevation(qt,Xi,un):null,Vn=it.translatePosition(Ve,ii,Le,Te);Ba(Ht,bt,Ut,$e,Ve,ji,qt.posMatrix,Xt,Ft,Zt,it,Vn,qt.toUnwrapped(),Ii)}}})(U,T,O,z,O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),H),O.paint.get("icon-opacity").constantOr(1)!==0&&rl(T,z,O,U,!1,O.paint.get("icon-translate"),O.paint.get("icon-translate-anchor"),O.layout.get("icon-rotation-alignment"),O.layout.get("icon-pitch-alignment"),O.layout.get("icon-keep-upright"),Y,X),O.paint.get("text-opacity").constantOr(1)!==0&&rl(T,z,O,U,!0,O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.layout.get("text-keep-upright"),Y,X),z.map.showCollisionBoxes&&(Ir(T,z,O,U,!0),Ir(T,z,O,U,!1))})(i,h,g,v,this.style.placement.variableOffsets);break;case"circle":(function(T,z,O,U){if(T.renderPass!=="translucent")return;const H=O.paint.get("circle-opacity"),Y=O.paint.get("circle-stroke-width"),X=O.paint.get("circle-stroke-opacity"),oe=!O.layout.get("circle-sort-key").isConstant();if(H.constantOr(1)===0&&(Y.constantOr(1)===0||X.constantOr(1)===0))return;const fe=T.context,_e=fe.gl,ke=T.depthModeForSublayer(0,Yi.ReadOnly),Me=mn.disabled,Pe=T.colorModeForRenderPass(),Le=[];for(let Te=0;Te<U.length;Te++){const $e=U[Te],Ve=z.getTile($e),it=Ve.getBucket(O);if(!it)continue;const bt=it.programConfigurations.get(O.id),Ut=T.useProgram("circle",bt),qt=it.layoutVertexBuffer,ii=it.indexBuffer,Ht=T.style.map.terrain&&T.style.map.terrain.getTerrainData($e),Ft={programConfiguration:bt,program:Ut,layoutVertexBuffer:qt,indexBuffer:ii,uniformValues:Ll(T,$e,Ve,O),terrainData:Ht};if(oe){const oi=it.segments.get();for(const ji of oi)Le.push({segments:new d.a0([ji]),sortKey:ji.sortKey,state:Ft})}else Le.push({segments:it.segments,sortKey:0,state:Ft})}oe&&Le.sort(((Te,$e)=>Te.sortKey-$e.sortKey));for(const Te of Le){const{programConfiguration:$e,program:Ve,layoutVertexBuffer:it,indexBuffer:bt,uniformValues:Ut,terrainData:qt}=Te.state;Ve.draw(fe,_e.TRIANGLES,ke,Me,Pe,Tn.disabled,Ut,qt,O.id,it,bt,Te.segments,O.paint,T.transform.zoom,$e)}})(i,h,g,v);break;case"heatmap":(function(T,z,O,U){if(O.paint.get("heatmap-opacity")===0)return;const H=T.context;if(T.style.map.terrain){for(const Y of U){const X=z.getTile(Y);z.hasRenderableParent(Y)||(T.renderPass==="offscreen"?oa(T,X,O,Y):T.renderPass==="translucent"&&la(T,O,Y))}H.viewport.set([0,0,T.width,T.height])}else T.renderPass==="offscreen"?(function(Y,X,oe,fe){const _e=Y.context,ke=_e.gl,Me=mn.disabled,Pe=new ps([ke.ONE,ke.ONE],d.aM.transparent,[!0,!0,!0,!0]);(function(Le,Te,$e){const Ve=Le.gl;Le.activeTexture.set(Ve.TEXTURE1),Le.viewport.set([0,0,Te.width/4,Te.height/4]);let it=$e.heatmapFbos.get(d.aU);it?(Ve.bindTexture(Ve.TEXTURE_2D,it.colorAttachment.get()),Le.bindFramebuffer.set(it.framebuffer)):(it=Ol(Le,Te.width/4,Te.height/4),$e.heatmapFbos.set(d.aU,it))})(_e,Y,oe),_e.clear({color:d.aM.transparent});for(let Le=0;Le<fe.length;Le++){const Te=fe[Le];if(X.hasRenderableParent(Te))continue;const $e=X.getTile(Te),Ve=$e.getBucket(oe);if(!Ve)continue;const it=Ve.programConfigurations.get(oe.id),bt=Y.useProgram("heatmap",it),{zoom:Ut}=Y.transform;bt.draw(_e,ke.TRIANGLES,Yi.disabled,Me,Pe,Tn.disabled,Rs(Te.posMatrix,$e,Ut,oe.paint.get("heatmap-intensity")),null,oe.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,oe.paint,Y.transform.zoom,it)}_e.viewport.set([0,0,Y.width,Y.height])})(T,z,O,U):T.renderPass==="translucent"&&(function(Y,X){const oe=Y.context,fe=oe.gl;oe.setColorMode(Y.colorModeForRenderPass());const _e=X.heatmapFbos.get(d.aU);_e&&(oe.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,_e.colorAttachment.get()),oe.activeTexture.set(fe.TEXTURE1),jo(oe,X).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),Y.useProgram("heatmapTexture").draw(oe,fe.TRIANGLES,Yi.disabled,mn.disabled,Y.colorModeForRenderPass(),Tn.disabled,Di(Y,X,0,1),null,X.id,Y.viewportBuffer,Y.quadTriangleIndexBuffer,Y.viewportSegments,X.paint,Y.transform.zoom))})(T,O)})(i,h,g,v);break;case"line":(function(T,z,O,U){if(T.renderPass!=="translucent")return;const H=O.paint.get("line-opacity"),Y=O.paint.get("line-width");if(H.constantOr(1)===0||Y.constantOr(1)===0)return;const X=T.depthModeForSublayer(0,Yi.ReadOnly),oe=T.colorModeForRenderPass(),fe=O.paint.get("line-dasharray"),_e=O.paint.get("line-pattern"),ke=_e.constantOr(1),Me=O.paint.get("line-gradient"),Pe=O.getCrossfadeParameters(),Le=ke?"linePattern":fe?"lineSDF":Me?"lineGradient":"line",Te=T.context,$e=Te.gl;let Ve=!0;for(const it of U){const bt=z.getTile(it);if(ke&&!bt.patternsLoaded())continue;const Ut=bt.getBucket(O);if(!Ut)continue;const qt=Ut.programConfigurations.get(O.id),ii=T.context.program.get(),Ht=T.useProgram(Le,qt),Ft=Ve||Ht.program!==ii,oi=T.style.map.terrain&&T.style.map.terrain.getTerrainData(it),ji=_e.constantOr(null);if(ji&&bt.imageAtlas){const Ii=bt.imageAtlas,Vn=Ii.patternPositions[ji.to.toString()],Xi=Ii.patternPositions[ji.from.toString()];Vn&&Xi&&qt.setConstantPatternPositions(Vn,Xi)}const Zt=oi?it:null,Xt=ke?ia(T,bt,O,Pe,Zt):fe?xa(T,bt,O,fe,Pe,Zt):Me?Lc(T,bt,O,Ut.lineClipsArray.length,Zt):jn(T,bt,O,Zt);if(ke)Te.activeTexture.set($e.TEXTURE0),bt.imageAtlasTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),qt.updatePaintBuffers(Pe);else if(fe&&(Ft||T.lineAtlas.dirty))Te.activeTexture.set($e.TEXTURE0),T.lineAtlas.bind(Te);else if(Me){const Ii=Ut.gradients[O.id];let Vn=Ii.texture;if(O.gradientVersion!==Ii.version){let Xi=256;if(O.stepInterpolant){const un=z.getSource().maxzoom,$n=it.canonical.z===un?Math.ceil(1<<T.transform.maxZoom-it.canonical.z):1;Xi=d.ac(d.aV(Ut.maxLineLength/d.X*1024*$n),256,Te.maxTextureSize)}Ii.gradient=d.aW({expression:O.gradientExpression(),evaluationKey:"lineProgress",resolution:Xi,image:Ii.gradient||void 0,clips:Ut.lineClipsArray}),Ii.texture?Ii.texture.update(Ii.gradient):Ii.texture=new lt(Te,Ii.gradient,$e.RGBA),Ii.version=O.gradientVersion,Vn=Ii.texture}Te.activeTexture.set($e.TEXTURE0),Vn.bind(O.stepInterpolant?$e.NEAREST:$e.LINEAR,$e.CLAMP_TO_EDGE)}Ht.draw(Te,$e.TRIANGLES,X,T.stencilModeForClipping(it),oe,Tn.disabled,Xt,oi,O.id,Ut.layoutVertexBuffer,Ut.indexBuffer,Ut.segments,O.paint,T.transform.zoom,qt,Ut.layoutVertexBuffer2),Ve=!1}})(i,h,g,v);break;case"fill":(function(T,z,O,U){const H=O.paint.get("fill-color"),Y=O.paint.get("fill-opacity");if(Y.constantOr(1)===0)return;const X=T.colorModeForRenderPass(),oe=O.paint.get("fill-pattern"),fe=T.opaquePassEnabledForLayer()&&!oe.constantOr(1)&&H.constantOr(d.aM.transparent).a===1&&Y.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===fe){const _e=T.depthModeForSublayer(1,T.renderPass==="opaque"?Yi.ReadWrite:Yi.ReadOnly);Fr(T,z,O,U,_e,X,!1)}if(T.renderPass==="translucent"&&O.paint.get("fill-antialias")){const _e=T.depthModeForSublayer(O.getPaintProperty("fill-outline-color")?2:0,Yi.ReadOnly);Fr(T,z,O,U,_e,X,!0)}})(i,h,g,v);break;case"fill-extrusion":(function(T,z,O,U){const H=O.paint.get("fill-extrusion-opacity");if(H!==0&&T.renderPass==="translucent"){const Y=new Yi(T.context.gl.LEQUAL,Yi.ReadWrite,T.depthRangeFor3D);if(H!==1||O.paint.get("fill-extrusion-pattern").constantOr(1))Fc(T,z,O,U,Y,mn.disabled,ps.disabled),Fc(T,z,O,U,Y,T.stencilModeFor3D(),T.colorModeForRenderPass());else{const X=T.colorModeForRenderPass();Fc(T,z,O,U,Y,mn.disabled,X)}}})(i,h,g,v);break;case"hillshade":(function(T,z,O,U){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const H=T.context,Y=T.depthModeForSublayer(0,Yi.ReadOnly),X=T.colorModeForRenderPass(),[oe,fe]=T.renderPass==="translucent"?T.stencilConfigForOverlap(U):[{},U];for(const _e of fe){const ke=z.getTile(_e);ke.needsHillshadePrepare!==void 0&&ke.needsHillshadePrepare&&T.renderPass==="offscreen"?Nl(T,ke,O,Y,mn.disabled,X):T.renderPass==="translucent"&&Sa(T,_e,ke,O,Y,oe[_e.overscaledZ],X)}H.viewport.set([0,0,T.width,T.height])})(i,h,g,v);break;case"raster":(function(T,z,O,U){if(T.renderPass!=="translucent"||O.paint.get("raster-opacity")===0||!U.length)return;const H=T.context,Y=H.gl,X=z.getSource(),oe=T.useProgram("raster"),fe=T.colorModeForRenderPass(),[_e,ke]=X instanceof us?[{},U]:T.stencilConfigForOverlap(U),Me=ke[ke.length-1].overscaledZ,Pe=!T.options.moving;for(const Le of ke){const Te=T.depthModeForSublayer(Le.overscaledZ-Me,O.paint.get("raster-opacity")===1?Yi.ReadWrite:Yi.ReadOnly,Y.LESS),$e=z.getTile(Le);$e.registerFadeDuration(O.paint.get("raster-fade-duration"));const Ve=z.findLoadedParent(Le,0),it=z.findLoadedSibling(Le),bt=$a($e,Ve||it||null,z,O,T.transform,T.style.map.terrain);let Ut,qt;const ii=O.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;H.activeTexture.set(Y.TEXTURE0),$e.texture.bind(ii,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),H.activeTexture.set(Y.TEXTURE1),Ve?(Ve.texture.bind(ii,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),Ut=Math.pow(2,Ve.tileID.overscaledZ-$e.tileID.overscaledZ),qt=[$e.tileID.canonical.x*Ut%1,$e.tileID.canonical.y*Ut%1]):$e.texture.bind(ii,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),$e.texture.useMipmap&&H.extTextureFilterAnisotropic&&T.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const Ht=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Le),Ft=Ht?Le:null,oi=Ft?Ft.posMatrix:T.transform.calculatePosMatrix(Le.toUnwrapped(),Pe),ji=Oa(oi,qt||[0,0],Ut||1,bt,O);X instanceof us?oe.draw(H,Y.TRIANGLES,Te,mn.disabled,fe,Tn.disabled,ji,Ht,O.id,X.boundsBuffer,T.quadTriangleIndexBuffer,X.boundsSegments):oe.draw(H,Y.TRIANGLES,Te,_e[Le.overscaledZ],fe,Tn.disabled,ji,Ht,O.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}})(i,h,g,v);break;case"background":(function(T,z,O,U){const H=O.paint.get("background-color"),Y=O.paint.get("background-opacity");if(Y===0)return;const X=T.context,oe=X.gl,fe=T.transform,_e=fe.tileSize,ke=O.paint.get("background-pattern");if(T.isPatternMissing(ke))return;const Me=!ke&&H.a===1&&Y===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==Me)return;const Pe=mn.disabled,Le=T.depthModeForSublayer(0,Me==="opaque"?Yi.ReadWrite:Yi.ReadOnly),Te=T.colorModeForRenderPass(),$e=T.useProgram(ke?"backgroundPattern":"background"),Ve=U||fe.coveringTiles({tileSize:_e,terrain:T.style.map.terrain});ke&&(X.activeTexture.set(oe.TEXTURE0),T.imageManager.bind(T.context));const it=O.getCrossfadeParameters();for(const bt of Ve){const Ut=U?bt.posMatrix:T.transform.calculatePosMatrix(bt.toUnwrapped()),qt=ke?zc(Ut,Y,T,ke,{tileID:bt,tileSize:_e},it):Mo(Ut,Y,H),ii=T.style.map.terrain&&T.style.map.terrain.getTerrainData(bt);$e.draw(X,oe.TRIANGLES,Le,Pe,Te,Tn.disabled,qt,ii,O.id,T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}})(i,0,g,v);break;case"custom":(function(T,z,O){const U=T.context,H=O.implementation;if(T.renderPass==="offscreen"){const Y=H.prerender;Y&&(T.setCustomLayerDefaults(),U.setColorMode(T.colorModeForRenderPass()),Y.call(H,U.gl,T.transform.customLayerMatrix()),U.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),U.setColorMode(T.colorModeForRenderPass()),U.setStencilMode(mn.disabled);const Y=H.renderingMode==="3d"?new Yi(T.context.gl.LEQUAL,Yi.ReadWrite,T.depthRangeFor3D):T.depthModeForSublayer(0,Yi.ReadOnly);U.setDepthMode(Y),H.render(U.gl,T.transform.customLayerMatrix(),{farZ:T.transform.farZ,nearZ:T.transform.nearZ,fov:T.transform._fov,modelViewProjectionMatrix:T.transform.modelViewProjectionMatrix,projectionMatrix:T.transform.projectionMatrix}),U.setDirty(),T.setBaseState(),U.bindFramebuffer.set(null)}})(i,0,g)}}translatePosMatrix(i,h,g,v,T){if(!g[0]&&!g[1])return i;const z=T?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(z){const H=Math.sin(z),Y=Math.cos(z);g=[g[0]*Y-g[1]*H,g[0]*H+g[1]*Y]}const O=[T?g[0]:vi(h,g[0],this.transform.zoom),T?g[1]:vi(h,g[1],this.transform.zoom),0],U=new Float32Array(16);return d.J(U,i,O),U}saveTileTexture(i){const h=this._tileTextures[i.size[0]];h?h.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const h=this._tileTextures[i];return h&&h.length>0?h.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const h=this.imageManager.getPattern(i.from.toString()),g=this.imageManager.getPattern(i.to.toString());return!h||!g}useProgram(i,h){this.cache=this.cache||{};const g=i+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[g]||(this.cache[g]=new Co(this.context,Da[i],h,Xs[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new lt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:h}=this.context.gl;return this.width!==i||this.height!==h}}class cl{constructor(i,h){this.points=i,this.planes=h}static fromInvProjectionMatrix(i,h,g){const v=Math.pow(2,g),T=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((O=>{const U=1/(O=d.af([],O,i))[3]/h*v;return d.b1(O,O,[U,U,1/O[3],U])})),z=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((O=>{const U=(function(oe,fe){var _e=fe[0],ke=fe[1],Me=fe[2],Pe=_e*_e+ke*ke+Me*Me;return Pe>0&&(Pe=1/Math.sqrt(Pe)),oe[0]=fe[0]*Pe,oe[1]=fe[1]*Pe,oe[2]=fe[2]*Pe,oe})([],(function(oe,fe,_e){var ke=fe[0],Me=fe[1],Pe=fe[2],Le=_e[0],Te=_e[1],$e=_e[2];return oe[0]=Me*$e-Pe*Te,oe[1]=Pe*Le-ke*$e,oe[2]=ke*Te-Me*Le,oe})([],ze([],T[O[0]],T[O[1]]),ze([],T[O[2]],T[O[1]]))),H=-((Y=U)[0]*(X=T[O[1]])[0]+Y[1]*X[1]+Y[2]*X[2]);var Y,X;return U.concat(H)}));return new cl(T,z)}}class Vr{constructor(i,h){this.min=i,this.max=h,this.center=(function(g,v,T){return g[0]=.5*v[0],g[1]=.5*v[1],g[2]=.5*v[2],g})([],(function(g,v,T){return g[0]=v[0]+T[0],g[1]=v[1]+T[1],g[2]=v[2]+T[2],g})([],this.min,this.max))}quadrant(i){const h=[i%2==0,i<2],g=ye(this.min),v=ye(this.max);for(let T=0;T<h.length;T++)g[T]=h[T]?this.min[T]:this.center[T],v[T]=h[T]?this.center[T]:this.max[T];return v[2]=this.max[2],new Vr(g,v)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let g=!0;for(let v=0;v<i.planes.length;v++){const T=i.planes[v];let z=0;for(let O=0;O<h.length;O++)d.b2(T,h[O])>=0&&z++;if(z===0)return 0;z!==h.length&&(g=!1)}if(g)return 2;for(let v=0;v<3;v++){let T=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(let O=0;O<i.points.length;O++){const U=i.points[O][v]-this.min[v];T=Math.min(T,U),z=Math.max(z,U)}if(z<0||T>this.max[v]-this.min[v])return 0}return 1}}class Ta{constructor(i=0,h=0,g=0,v=0){if(isNaN(i)||i<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=h,this.left=g,this.right=v}interpolate(i,h,g){return h.top!=null&&i.top!=null&&(this.top=d.y.number(i.top,h.top,g)),h.bottom!=null&&i.bottom!=null&&(this.bottom=d.y.number(i.bottom,h.bottom,g)),h.left!=null&&i.left!=null&&(this.left=d.y.number(i.left,h.left,g)),h.right!=null&&i.right!=null&&(this.right=d.y.number(i.right,h.right,g)),this}getCenter(i,h){const g=d.ac((this.left+i-this.right)/2,0,i),v=d.ac((this.top+h-this.bottom)/2,0,h);return new d.P(g,v)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Ta(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Bl=85.051129;class ul{constructor(i,h,g,v,T){this.tileSize=512,this._renderWorldCopies=T===void 0||!!T,this._minZoom=i||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=v??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ta,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const i=new ul(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.lngRange=i.lngRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this.minElevationForCurrentTile=i.minElevationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const h=-d.b3(i,-180,180)*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(function(){var g=new d.A(4);return d.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g})(),(function(g,v,T){var z=v[0],O=v[1],U=v[2],H=v[3],Y=Math.sin(T),X=Math.cos(T);g[0]=z*X+U*Y,g[1]=O*X+H*Y,g[2]=z*-Y+U*X,g[3]=O*-Y+H*X})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const h=d.ac(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const h=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.tileZoom=Math.max(0,Math.floor(h)),this.scale=this.zoomScale(h),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,h,g){this._unmodified=!1,this._edgeInsets.interpolate(i,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const h=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(i){const h=[new d.b4(0,i)];if(this._renderWorldCopies){const g=this.pointCoordinate(new d.P(0,0)),v=this.pointCoordinate(new d.P(this.width,0)),T=this.pointCoordinate(new d.P(this.width,this.height)),z=this.pointCoordinate(new d.P(0,this.height)),O=Math.floor(Math.min(g.x,v.x,T.x,z.x)),U=Math.floor(Math.max(g.x,v.x,T.x,z.x)),H=1;for(let Y=O-H;Y<=U+H;Y++)Y!==0&&h.push(new d.b4(Y,i))}return h}coveringTiles(i){var h,g;let v=this.coveringZoomLevel(i);const T=v;if(i.minzoom!==void 0&&v<i.minzoom)return[];i.maxzoom!==void 0&&v>i.maxzoom&&(v=i.maxzoom);const z=this.pointCoordinate(this.getCameraPoint()),O=d.Z.fromLngLat(this.center),U=Math.pow(2,v),H=[U*z.x,U*z.y,0],Y=[U*O.x,U*O.y,0],X=cl.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,v);let oe=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(oe=v);const fe=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,_e=Te=>({aabb:new Vr([Te*U,0,0],[(Te+1)*U,U,0]),zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),ke=[],Me=[],Pe=v,Le=i.reparseOverscaled?T:v;if(this._renderWorldCopies)for(let Te=1;Te<=3;Te++)ke.push(_e(-Te)),ke.push(_e(Te));for(ke.push(_e(0));ke.length>0;){const Te=ke.pop(),$e=Te.x,Ve=Te.y;let it=Te.fullyVisible;if(!it){const Ht=Te.aabb.intersects(X);if(Ht===0)continue;it=Ht===2}const bt=i.terrain?H:Y,Ut=Te.aabb.distanceX(bt),qt=Te.aabb.distanceY(bt),ii=Math.max(Math.abs(Ut),Math.abs(qt));if(Te.zoom===Pe||ii>fe+(1<<Pe-Te.zoom)-2&&Te.zoom>=oe){const Ht=Pe-Te.zoom,Ft=H[0]-.5-($e<<Ht),oi=H[1]-.5-(Ve<<Ht);Me.push({tileID:new d.S(Te.zoom===Pe?Le:Te.zoom,Te.wrap,Te.zoom,$e,Ve),distanceSq:He([Y[0]-.5-$e,Y[1]-.5-Ve]),tileDistanceToCamera:Math.sqrt(Ft*Ft+oi*oi)})}else for(let Ht=0;Ht<4;Ht++){const Ft=($e<<1)+Ht%2,oi=(Ve<<1)+(Ht>>1),ji=Te.zoom+1;let Zt=Te.aabb.quadrant(Ht);if(i.terrain){const Xt=new d.S(ji,Te.wrap,ji,Ft,oi),Ii=i.terrain.getMinMaxElevation(Xt),Vn=(h=Ii.minElevation)!==null&&h!==void 0?h:this.elevation,Xi=(g=Ii.maxElevation)!==null&&g!==void 0?g:this.elevation;Zt=new Vr([Zt.min[0],Zt.min[1],Vn],[Zt.max[0],Zt.max[1],Xi])}ke.push({aabb:Zt,zoom:ji,x:Ft,y:oi,wrap:Te.wrap,fullyVisible:it})}}return Me.sort(((Te,$e)=>Te.distanceSq-$e.distanceSq)).map((Te=>Te.tileID))}resize(i,h){this.width=i,this.height=h,this.pixelsToGLUnits=[2/i,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const h=d.ac(i.lat,-85.051129,Bl);return new d.P(d.O(i.lng)*this.worldSize,d.Q(h)*this.worldSize)}unproject(i){return new d.Z(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const h=this.elevation,g=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,v=this.pointLocation(this.centerPoint,i),T=i.getElevationForLngLatZoom(v,this.tileZoom);if(!(this.elevation-T))return;const z=g+h-T,O=Math.cos(this._pitch)*this.cameraToCenterDistance/z/d.b5(1,v.lat),U=this.scaleZoom(O/this.tileSize);this._elevation=T,this._center=v,this.zoom=U}setLocationAtPoint(i,h){const g=this.pointCoordinate(h),v=this.pointCoordinate(this.centerPoint),T=this.locationCoordinate(i),z=new d.Z(T.x-(g.x-v.x),T.y-(g.y-v.y));this.center=this.coordinateLocation(z),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,h){return h?this.coordinatePoint(this.locationCoordinate(i),h.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,h){return this.coordinateLocation(this.pointCoordinate(i,h))}locationCoordinate(i){return d.Z.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,h){if(h){const oe=h.pointCoordinate(i);if(oe!=null)return oe}const g=[i.x,i.y,0,1],v=[i.x,i.y,1,1];d.af(g,g,this.pixelMatrixInverse),d.af(v,v,this.pixelMatrixInverse);const T=g[3],z=v[3],O=g[1]/T,U=v[1]/z,H=g[2]/T,Y=v[2]/z,X=H===Y?0:(0-H)/(Y-H);return new d.Z(d.y.number(g[0]/T,v[0]/z,X)/this.worldSize,d.y.number(O,U,X)/this.worldSize)}coordinatePoint(i,h=0,g=this.pixelMatrix){const v=[i.x*this.worldSize,i.y*this.worldSize,h,1];return d.af(v,v,g),new d.P(v[0]/v[3],v[1]/v[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new tt().extend(this.pointLocation(new d.P(0,i))).extend(this.pointLocation(new d.P(this.width,i))).extend(this.pointLocation(new d.P(this.width,this.height))).extend(this.pointLocation(new d.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new tt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Bl])}calculateTileMatrix(i){const h=i.canonical,g=this.worldSize/this.zoomScale(h.z),v=h.x+Math.pow(2,h.z)*i.wrap,T=d.an(new Float64Array(16));return d.J(T,T,[v*g,h.y*g,0]),d.K(T,T,[g/d.X,g/d.X,1]),T}calculatePosMatrix(i,h=!1){const g=i.key,v=h?this._alignedPosMatrixCache:this._posMatrixCache;if(v[g])return v[g];const T=this.calculateTileMatrix(i);return d.L(T,h?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,T),v[g]=new Float32Array(T),v[g]}calculateFogMatrix(i){const h=i.key,g=this._fogMatrixCache;if(g[h])return g[h];const v=this.calculateTileMatrix(i);return d.L(v,this.fogMatrix,v),g[h]=new Float32Array(v),g[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(i,h){h=d.ac(+h,this.minZoom,this.maxZoom);const g={center:new d.N(i.lng,i.lat),zoom:h};let v=this.lngRange;if(!this._renderWorldCopies&&v===null){const Te=179.9999999999;v=[-Te,Te]}const T=this.tileSize*this.zoomScale(g.zoom);let z=0,O=T,U=0,H=T,Y=0,X=0;const{x:oe,y:fe}=this.size;if(this.latRange){const Te=this.latRange;z=d.Q(Te[1])*T,O=d.Q(Te[0])*T,O-z<fe&&(Y=fe/(O-z))}v&&(U=d.b3(d.O(v[0])*T,0,T),H=d.b3(d.O(v[1])*T,0,T),H<U&&(H+=T),H-U<oe&&(X=oe/(H-U)));const{x:_e,y:ke}=this.project.call({worldSize:T},i);let Me,Pe;const Le=Math.max(X||0,Y||0);if(Le){const Te=new d.P(X?(H+U)/2:_e,Y?(O+z)/2:ke);return g.center=this.unproject.call({worldSize:T},Te).wrap(),g.zoom+=this.scaleZoom(Le),g}if(this.latRange){const Te=fe/2;ke-Te<z&&(Pe=z+Te),ke+Te>O&&(Pe=O-Te)}if(v){const Te=(U+H)/2;let $e=_e;this._renderWorldCopies&&($e=d.b3(_e,Te-T/2,Te+T/2));const Ve=oe/2;$e-Ve<U&&(Me=U+Ve),$e+Ve>H&&(Me=H-Ve)}if(Me!==void 0||Pe!==void 0){const Te=new d.P(Me??_e,Pe??ke);g.center=this.unproject.call({worldSize:T},Te).wrap()}return g}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:h,zoom:g}=this.getConstrained(this.center,this.zoom);this.center=h,this.zoom=g,this._unmodified=i,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,h=this.point.x,g=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=d.b5(1,this.center.lat)*this.worldSize;let v=d.an(new Float64Array(16));d.K(v,v,[this.width/2,-this.height/2,1]),d.J(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=d.an(new Float64Array(16)),d.K(v,v,[1,-1,1]),d.J(v,v,[-1,-1,0]),d.K(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v;const T=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),z=Math.min(this.elevation,this.minElevationForCurrentTile),O=T-z*this._pixelPerMeter/Math.cos(this._pitch),U=z<0?O:T,H=Math.PI/2+this._pitch,Y=this._fov*(.5+i.y/this.height),X=Math.sin(Y)*U/Math.sin(d.ac(Math.PI-H-Y,.01,Math.PI-.01)),oe=this.getHorizon(),fe=2*Math.atan(oe/this.cameraToCenterDistance)*(.5+i.y/(2*oe)),_e=Math.sin(fe)*U/Math.sin(d.ac(Math.PI-H-fe,.01,Math.PI-.01)),ke=Math.min(X,_e);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ke+U),this.nearZ=this.height/50,v=new Float64Array(16),d.b6(v,this._fov,this.width/this.height,this.nearZ,this.farZ),v[8]=2*-i.x/this.width,v[9]=2*i.y/this.height,this.projectionMatrix=d.ae(v),d.K(v,v,[1,-1,1]),d.J(v,v,[0,0,-this.cameraToCenterDistance]),d.b7(v,v,this._pitch),d.ad(v,v,this.angle),d.J(v,v,[-h,-g,0]),this.mercatorMatrix=d.K([],v,[this.worldSize,this.worldSize,this.worldSize]),d.K(v,v,[1,1,this._pixelPerMeter]),this.pixelMatrix=d.L(new Float64Array(16),this.labelPlaneMatrix,v),d.J(v,v,[0,0,-this.elevation]),this.modelViewProjectionMatrix=v,this.invModelViewProjectionMatrix=d.as([],v),this.fogMatrix=new Float64Array(16),d.b6(this.fogMatrix,this._fov,this.width/this.height,T,this.farZ),this.fogMatrix[8]=2*-i.x/this.width,this.fogMatrix[9]=2*i.y/this.height,d.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),d.b7(this.fogMatrix,this.fogMatrix,this._pitch),d.ad(this.fogMatrix,this.fogMatrix,this.angle),d.J(this.fogMatrix,this.fogMatrix,[-h,-g,0]),d.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),d.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=d.L(new Float64Array(16),this.labelPlaneMatrix,v);const Me=this.width%2/2,Pe=this.height%2/2,Le=Math.cos(this.angle),Te=Math.sin(this.angle),$e=h-Math.round(h)+Le*Me+Te*Pe,Ve=g-Math.round(g)+Le*Pe+Te*Me,it=new Float64Array(v);if(d.J(it,it,[$e>.5?$e-1:$e,Ve>.5?Ve-1:Ve,0]),this.alignedModelViewProjectionMatrix=it,v=d.as(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new d.P(0,0)),h=[i.x*this.worldSize,i.y*this.worldSize,0,1];return d.af(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(0,i))}getCameraQueryGeometry(i){const h=this.getCameraPoint();if(i.length===1)return[i[0],h];{let g=h.x,v=h.y,T=h.x,z=h.y;for(const O of i)g=Math.min(g,O.x),v=Math.min(v,O.y),T=Math.max(T,O.x),z=Math.max(z,O.y);return[new d.P(g,v),new d.P(T,v),new d.P(T,z),new d.P(g,z),new d.P(g,v)]}}lngLatToCameraDepth(i,h){const g=this.locationCoordinate(i),v=[g.x*this.worldSize,g.y*this.worldSize,h,1];return d.af(v,v,this.modelViewProjectionMatrix),v[2]/v[3]}}function Cs(E,i){let h,g=!1,v=null,T=null;const z=()=>{v=null,g&&(E.apply(T,h),v=setTimeout(z,i),g=!1)};return(...O)=>(g=!0,T=this,h=O,v||z(),v)}class zo{constructor(i){this._getCurrentHash=()=>{const h=window.location.hash.replace("#","");if(this._hashName){let g;return h.split("&").map((v=>v.split("="))).forEach((v=>{v[0]===this._hashName&&(g=v)})),(g&&g[1]||"").split("/")}return h.split("/")},this._onHashChange=()=>{const h=this._getCurrentHash();if(h.length>=3&&!h.some((g=>isNaN(g)))){const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(h[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const h=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,h)},this._removeHash=()=>{const h=this._getCurrentHash();if(h.length===0)return;const g=h.join("/");let v=g;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${g}`);let T=window.location.hash.replace(v,"");T.startsWith("#&")?T=T.slice(0,1)+T.slice(2):T==="#"&&(T="");let z=window.location.href.replace(/(#.+)?$/,T);z=z.replace("&&","&"),window.history.replaceState(window.history.state,null,z)},this._updateHash=Cs(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(i){const h=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,v=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,v),z=Math.round(h.lng*T)/T,O=Math.round(h.lat*T)/T,U=this._map.getBearing(),H=this._map.getPitch();let Y="";if(Y+=i?`/${z}/${O}/${g}`:`${g}/${O}/${z}`,(U||H)&&(Y+="/"+Math.round(10*U)/10),H&&(Y+=`/${Math.round(H)}`),this._hashName){const X=this._hashName;let oe=!1;const fe=window.location.hash.slice(1).split("&").map((_e=>{const ke=_e.split("=")[0];return ke===X?(oe=!0,`${ke}=${Y}`):_e})).filter((_e=>_e));return oe||fe.push(`${X}=${Y}`),`#${fe.join("&")}`}return`#${Y}`}}const rc={linearity:.3,easing:d.b8(0,0,.3,1)},hl=d.e({deceleration:2500,maxSpeed:1400},rc),Qh=d.e({deceleration:20,maxSpeed:1400},rc),Tu=d.e({deceleration:1e3,maxSpeed:360},rc),Vc=d.e({deceleration:1e3,maxSpeed:90},rc);class Ro{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:N.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,h=N.now();for(;i.length>0&&h-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)h.zoom+=T.zoomDelta||0,h.bearing+=T.bearingDelta||0,h.pitch+=T.pitchDelta||0,T.panDelta&&h.pan._add(T.panDelta),T.around&&(h.around=T.around),T.pinchAround&&(h.pinchAround=T.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const T=ca(h.pan.mag(),g,d.e({},hl,i||{}));v.offset=h.pan.mult(T.amount/h.pan.mag()),v.center=this._map.transform.center,$l(v,T)}if(h.zoom){const T=ca(h.zoom,g,Qh);v.zoom=this._map.transform.zoom+T.amount,$l(v,T)}if(h.bearing){const T=ca(h.bearing,g,Tu);v.bearing=this._map.transform.bearing+d.ac(T.amount,-179,179),$l(v,T)}if(h.pitch){const T=ca(h.pitch,g,Vc);v.pitch=this._map.transform.pitch+T.amount,$l(v,T)}if(v.zoom||v.bearing){const T=h.pinchAround===void 0?h.around:h.pinchAround;v.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),d.e(v,{noMoveStart:!0})}}function $l(E,i){(!E.duration||E.duration<i.duration)&&(E.duration=i.duration,E.easing=i.easing)}function ca(E,i,h){const{maxSpeed:g,linearity:v,deceleration:T}=h,z=d.ac(E*v/(i/1e3),-g,g),O=Math.abs(z)/(T*v);return{easing:h.easing,duration:1e3*O,amount:z*(O/2)}}class Wn extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g,v={}){const T=V.mousePos(h.getCanvas(),g),z=h.unproject(T);super(i,d.e({point:T,lngLat:z,originalEvent:g},v)),this._defaultPrevented=!1,this.target=h}}class Ea extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g){const v=i==="touchend"?g.changedTouches:g.touches,T=V.touchPos(h.getCanvasContainer(),v),z=T.map((U=>h.unproject(U))),O=T.reduce(((U,H,Y,X)=>U.add(H.div(X.length))),new d.P(0,0));super(i,{points:T,point:O,lngLats:z,lngLat:h.unproject(O),originalEvent:g}),this._defaultPrevented=!1}}class qr extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,g){super(i,{originalEvent:g}),this._defaultPrevented=!1}}class vr{constructor(i,h){this._map=i,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new qr(i.type,this._map,i))}mousedown(i,h){return this._mousedownPos=h,this._firePreventable(new Wn(i.type,this._map,i))}mouseup(i){this._map.fire(new Wn(i.type,this._map,i))}click(i,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new Wn(i.type,this._map,i))}dblclick(i){return this._firePreventable(new Wn(i.type,this._map,i))}mouseover(i){this._map.fire(new Wn(i.type,this._map,i))}mouseout(i){this._map.fire(new Wn(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Ea(i.type,this._map,i))}touchmove(i){this._map.fire(new Ea(i.type,this._map,i))}touchend(i){this._map.fire(new Ea(i.type,this._map,i))}touchcancel(i){this._map.fire(new Ea(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ss{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new Wn(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Wn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new Wn(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xr{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(d.P.convert(i),this._map.terrain)}}class As{constructor(i,h){this._map=i,this._tr=new xr(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,h){this.isEnabled()&&i.shiftKey&&i.button===0&&(V.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(i,h){if(!this._active)return;const g=h;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=g,this._box||(this._box=V.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const T=Math.min(v.x,g.x),z=Math.max(v.x,g.x),O=Math.min(v.y,g.y),U=Math.max(v.y,g.y);V.setTransform(this._box,`translate(${T}px,${O}px)`),this._box.style.width=z-T+"px",this._box.style.height=U-O+"px"}mouseupWindow(i,h){if(!this._active||i.button!==0)return;const g=this._startPos,v=h;if(this.reset(),V.suppressClick(),g.x!==v.x||g.y!==v.y)return this._map.fire(new d.k("boxzoomend",{originalEvent:i})),{cameraAnimation:T=>T.fitScreenCoordinates(g,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,h){return this._map.fire(new d.k(i,{originalEvent:h}))}}function dl(E,i){if(E.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${E.length}, points ${i.length}`);const h={};for(let g=0;g<E.length;g++)h[E[g].identifier]=i[g];return h}class ua{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),g.length===this.numTouches&&(this.centroid=(function(v){const T=new d.P(0,0);for(const z of v)T._add(z);return T.div(v.length)})(h),this.touches=dl(g,h)))}touchmove(i,h,g){if(this.aborted||!this.centroid)return;const v=dl(g,h);for(const T in this.touches){const z=v[T];(!z||z.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(i,h,g){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class po{constructor(i){this.singleTap=new ua(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,h,g){this.singleTap.touchstart(i,h,g)}touchmove(i,h,g){this.singleTap.touchmove(i,h,g)}touchend(i,h,g){const v=this.singleTap.touchend(i,h,g);if(v){const T=i.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(v)<30;if(T&&z||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Fa{constructor(i){this._tr=new xr(i),this._zoomIn=new po({numTouches:1,numTaps:2}),this._zoomOut=new po({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,h,g){this._zoomIn.touchstart(i,h,g),this._zoomOut.touchstart(i,h,g)}touchmove(i,h,g){this._zoomIn.touchmove(i,h,g),this._zoomOut.touchmove(i,h,g)}touchend(i,h,g){const v=this._zoomIn.touchend(i,h,g),T=this._zoomOut.touchend(i,h,g),z=this._tr;return v?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:z.zoom+1,around:z.unproject(v)},{originalEvent:i})}):T?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:z.zoom-1,around:z.unproject(T)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class br{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const h=this._moveFunction(...i);if(h.bearingDelta||h.pitchDelta||h.around||h.panDelta)return this._active=!0,h}dragStart(i,h){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=h.length?h[0]:h,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,h){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const v=h.length?h[0]:h;return!this._moved&&v.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(g,v))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&V.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Eu={0:1,2:2};class Ks{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const h=V.mouseButton(i);this._eventButton=h}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!(function(h,g){const v=Eu[g];return h.buttons===void 0||(h.buttons&v)!==v})(i,this._eventButton)}isValidEndEvent(i){return V.mouseButton(i)===this._eventButton}}class Ul{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const Hr=E=>{E.mousedown=E.dragStart,E.mousemoveWindow=E.dragMove,E.mouseup=E.dragEnd,E.contextmenu=i=>{i.preventDefault()}},ac=({enable:E,clickTolerance:i,bearingDegreesPerPixelMoved:h=.8})=>{const g=new Ks({checkCorrectEvent:v=>V.mouseButton(v)===0&&v.ctrlKey||V.mouseButton(v)===2});return new br({clickTolerance:i,move:(v,T)=>({bearingDelta:(T.x-v.x)*h}),moveStateManager:g,enable:E,assignEvents:Hr})},fl=({enable:E,clickTolerance:i,pitchDegreesPerPixelMoved:h=-.5})=>{const g=new Ks({checkCorrectEvent:v=>V.mouseButton(v)===0&&v.ctrlKey||V.mouseButton(v)===2});return new br({clickTolerance:i,move:(v,T)=>({pitchDelta:(T.y-v.y)*h}),moveStateManager:g,enable:E,assignEvents:Hr})};class Zr{constructor(i,h){this._clickTolerance=i.clickTolerance||1,this._map=h,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(i){return i<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(i,h,g){return this._calculateTransform(i,h,g)}touchmove(i,h,g){if(this._active){if(!this._shouldBePrevented(g.length))return i.preventDefault(),this._calculateTransform(i,h,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",i)}}touchend(i,h,g){this._calculateTransform(i,h,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,h,g){g.length>0&&(this._active=!0);const v=dl(g,h),T=new d.P(0,0),z=new d.P(0,0);let O=0;for(const H in v){const Y=v[H],X=this._touches[H];X&&(T._add(Y),z._add(Y.sub(X)),O++,v[H]=Y)}if(this._touches=v,this._shouldBePrevented(O)||!z.mag())return;const U=z.div(O);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(O),panDelta:U}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(i,h,g){if(!this._firstTwoTouches)return;i.preventDefault();const[v,T]=this._firstTwoTouches,z=ml(g,h,v),O=ml(g,h,T);if(!z||!O)return;const U=this._aroundCenter?null:z.add(O).div(2);return this._move([z,O],U,i)}touchend(i,h,g){if(!this._firstTwoTouches)return;const[v,T]=this._firstTwoTouches,z=ml(g,h,v),O=ml(g,h,T);z&&O||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ml(E,i,h){for(let g=0;g<E.length;g++)if(E[g].identifier===h)return i[g]}function oc(E,i){return Math.log(E/i)/Math.LN2}class u extends pl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,h){const g=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(oc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oc(this._distance,g),pinchAround:h}}}function b(E,i){return 180*E.angleWith(i)/Math.PI}class M extends pl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,h,g){const v=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:b(this._vector,v),pinchAround:h}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const h=25/(Math.PI*this._minDiameter)*360,g=b(i,this._startVector);return Math.abs(g)<h}}function $(E){return Math.abs(E.y)>Math.abs(E.x)}class Z extends pl{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,h,g){super.touchstart(i,h,g),this._currentTouchCount=g.length}_start(i){this._lastPoints=i,$(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,h,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=i[0].sub(this._lastPoints[0]),T=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,T,g.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5}):void 0}gestureBeginsVertically(i,h,g){if(this._valid!==void 0)return this._valid;const v=i.mag()>=2,T=h.mag()>=2;if(!v&&!T)return;if(!v||!T)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const z=i.y>0==h.y>0;return $(i)&&$(h)&&z}}const le={panStep:100,bearingStep:15,pitchStep:10};class Ce{constructor(i){this._tr=new xr(i);const h=le;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let h=0,g=0,v=0,T=0,z=0;switch(i.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:i.shiftKey?g=-1:(i.preventDefault(),T=-1);break;case 39:i.shiftKey?g=1:(i.preventDefault(),T=1);break;case 38:i.shiftKey?v=1:(i.preventDefault(),z=-1);break;case 40:i.shiftKey?v=-1:(i.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(g=0,v=0),{cameraAnimation:O=>{const U=this._tr;O.easeTo({duration:300,easeId:"keyboardHandler",easing:We,zoom:h?Math.round(U.zoom)+h*(i.shiftKey?2:1):U.zoom,bearing:U.bearing+g*this._bearingStep,pitch:U.pitch+v*this._pitchStep,offset:[-T*this._panStep,-z*this._panStep],center:U.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function We(E){return E*(2-E)}const ht=4.000244140625;class wt{constructor(i,h){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=i,this._tr=new xr(i),this._triggerRenderFrame=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(i){return!!this._map.cooperativeGestures.isEnabled()&&!(i.ctrlKey||this._map.cooperativeGestures.isBypassed(i))}wheel(i){if(!this.isEnabled())return;if(this._shouldBePrevented(i))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",i);let h=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const g=N.now(),v=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%ht==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),i.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=i,this._delta-=h,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=V.mousePos(this._map.getCanvas(),i),g=this._tr;this._around=h.y>g.transform.height/2-g.transform.getHorizon()?d.N.convert(this._aroundCenter?g.center:g.unproject(h)):d.N.convert(g.center),this._aroundPoint=g.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>ht?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&H!==0&&(H=1/H);const Y=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(Y*H))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,g=this._startZoom,v=this._easing;let T,z=!1;const O=N.now()-this._lastWheelEventTime;if(this._type==="wheel"&&g&&v&&O){const U=Math.min(O/200,1),H=v(U);T=d.y.number(g,h,H),U<1?this._frameId||(this._frameId=!0):z=!0}else T=h,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:T-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let h=d.b9;if(this._prevEase){const g=this._prevEase,v=(N.now()-g.start)/g.duration,T=g.easing(v+.01)-g.easing(v),z=.27/Math.sqrt(T*T+1e-4)*.01,O=Math.sqrt(.0729-z*z);h=d.b8(z,O,.25,1)}return this._prevEase={start:N.now(),duration:i,easing:h},h}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Yt{constructor(i,h){this._clickZoom=i,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Si{constructor(i){this._tr=new xr(i),this.reset()}reset(){this._active=!1}dblclick(i,h){return i.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(h)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ln{constructor(){this._tap=new po({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,h,g){if(!this._swipePoint)if(this._tapTime){const v=h[0],T=i.timeStamp-this._tapTime<500,z=this._tapPoint.dist(v)<30;T&&z?g.length>0&&(this._swipePoint=v,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(i,h,g)}touchmove(i,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const v=h[0],T=v.y-this._swipePoint.y;return this._swipePoint=v,i.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(i,h,g)}touchend(i,h,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const v=this._tap.touchend(i,h,g);v&&(this._tapTime=i.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qs{constructor(i,h,g){this._el=i,this._mousePan=h,this._touchPan=g}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class bs{constructor(i,h,g){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class wr{constructor(i,h,g,v){this._el=i,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class bn{constructor(i,h){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=h,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=V.create("div","maplibregl-cooperative-gesture-screen",i);let h=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(h=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=h,this._container.appendChild(v);const T=document.createElement("div");T.className="maplibregl-mobile-message",T.textContent=g,this._container.appendChild(T),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(i){return i[this._bypassKey]}notifyGestureBlocked(i,h){this._enabled&&(this._map.fire(new d.k("cooperativegestureprevented",{gestureType:i,originalEvent:h})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Qi=E=>E.zoom||E.drag||E.pitch||E.rotate;class jt extends d.k{}function ka(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta}class jr{constructor(i,h){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,T)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const z=v.type==="renderFrame"?void 0:v,O={needsRenderFrame:!1},U={},H={},Y=v.touches,X=Y?this._getMapTouches(Y):void 0,oe=X?V.touchPos(this._map.getCanvas(),X):V.mousePos(this._map.getCanvas(),v);for(const{handlerName:ke,handler:Me,allowed:Pe}of this._handlers){if(!Me.isEnabled())continue;let Le;this._blockedByActive(H,Pe,ke)?Me.reset():Me[T||v.type]&&(Le=Me[T||v.type](v,oe,X),this.mergeHandlerResult(O,U,Le,ke,z),Le&&Le.needsRenderFrame&&this._triggerRenderFrame()),(Le||Me.isActive())&&(H[ke]=Me)}const fe={};for(const ke in this._previousActiveHandlers)H[ke]||(fe[ke]=z);this._previousActiveHandlers=H,(Object.keys(fe).length||ka(O))&&(this._changes.push([O,U,fe]),this._triggerRenderFrame()),(Object.keys(H).length||ka(O))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:_e}=O;_e&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],_e(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ro(i),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,T,z]of this._listeners)V.addEventListener(v,T,v===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[i,h,g]of this._listeners)V.removeEventListener(i,h,i===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(i){const h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new vr(h,i));const v=h.boxZoom=new As(h,i);this._add("boxZoom",v),i.interactive&&i.boxZoom&&v.enable();const T=h.cooperativeGestures=new bn(h,i.cooperativeGestures);this._add("cooperativeGestures",T),i.cooperativeGestures&&T.enable();const z=new Fa(h),O=new Si(h);h.doubleClickZoom=new Yt(O,z),this._add("tapZoom",z),this._add("clickZoom",O),i.interactive&&i.doubleClickZoom&&h.doubleClickZoom.enable();const U=new ln;this._add("tapDragZoom",U);const H=h.touchPitch=new Z(h);this._add("touchPitch",H),i.interactive&&i.touchPitch&&h.touchPitch.enable(i.touchPitch);const Y=ac(i),X=fl(i);h.dragRotate=new bs(i,Y,X),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]),i.interactive&&i.dragRotate&&h.dragRotate.enable();const oe=(({enable:Le,clickTolerance:Te})=>{const $e=new Ks({checkCorrectEvent:Ve=>V.mouseButton(Ve)===0&&!Ve.ctrlKey});return new br({clickTolerance:Te,move:(Ve,it)=>({around:it,panDelta:it.sub(Ve)}),activateOnStart:!0,moveStateManager:$e,enable:Le,assignEvents:Hr})})(i),fe=new Zr(i,h);h.dragPan=new qs(g,oe,fe),this._add("mousePan",oe),this._add("touchPan",fe,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&h.dragPan.enable(i.dragPan);const _e=new M,ke=new u;h.touchZoomRotate=new wr(g,ke,_e,U),this._add("touchRotate",_e,["touchPan","touchZoom"]),this._add("touchZoom",ke,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&h.touchZoomRotate.enable(i.touchZoomRotate);const Me=h.scrollZoom=new wt(h,(()=>this._triggerRenderFrame()));this._add("scrollZoom",Me,["mousePan"]),i.interactive&&i.scrollZoom&&h.scrollZoom.enable(i.scrollZoom);const Pe=h.keyboard=new Ce(h);this._add("keyboard",Pe),i.interactive&&i.keyboard&&h.keyboard.enable(),this._add("blockableMapEvent",new ss(h))}_add(i,h,g){this._handlers.push({handlerName:i,handler:h,allowed:g}),this._handlersById[i]=h}stop(i){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Qi(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,h,g){for(const v in i)if(v!==g&&(!h||h.indexOf(v)<0))return!0;return!1}_getMapTouches(i){const h=[];for(const g of i)this._el.contains(g.target)&&h.push(g);return h}mergeHandlerResult(i,h,g,v,T){if(!g)return;d.e(i,g);const z={handlerName:v,originalEvent:g.originalEvent||T};g.zoomDelta!==void 0&&(h.zoom=z),g.panDelta!==void 0&&(h.drag=z),g.pitchDelta!==void 0&&(h.pitch=z),g.bearingDelta!==void 0&&(h.rotate=z)}_applyChanges(){const i={},h={},g={};for(const[v,T,z]of this._changes)v.panDelta&&(i.panDelta=(i.panDelta||new d.P(0,0))._add(v.panDelta)),v.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(i.around=v.around),v.pinchAround!==void 0&&(i.pinchAround=v.pinchAround),v.noInertia&&(i.noInertia=v.noInertia),d.e(h,T),d.e(g,z);this._updateMapTransform(i,h,g),this._changes=[]}_updateMapTransform(i,h,g){const v=this._map,T=v._getTransformForUpdate(),z=v.terrain;if(!(ka(i)||z&&this._terrainMovement))return this._fireEvents(h,g,!0);let{panDelta:O,zoomDelta:U,bearingDelta:H,pitchDelta:Y,around:X,pinchAround:oe}=i;oe!==void 0&&(X=oe),v._stop(!0),X=X||v.transform.centerPoint;const fe=T.pointLocation(O?X.sub(O):X);H&&(T.bearing+=H),Y&&(T.pitch+=Y),U&&(T.zoom+=U),z?this._terrainMovement||!h.drag&&!h.zoom?h.drag&&this._terrainMovement?T.center=T.pointLocation(T.centerPoint.sub(O)):T.setLocationAtPoint(fe,X):(this._terrainMovement=!0,this._map._elevationFreeze=!0,T.setLocationAtPoint(fe,X)):T.setLocationAtPoint(fe,X),v._applyUpdatedTransform(T),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(h,g,!0)}_fireEvents(i,h,g){const v=Qi(this._eventsInProgress),T=Qi(i),z={};for(const X in i){const{originalEvent:oe}=i[X];this._eventsInProgress[X]||(z[`${X}start`]=oe),this._eventsInProgress[X]=i[X]}!v&&T&&this._fireEvent("movestart",T.originalEvent);for(const X in z)this._fireEvent(X,z[X]);T&&this._fireEvent("move",T.originalEvent);for(const X in i){const{originalEvent:oe}=i[X];this._fireEvent(X,oe)}const O={};let U;for(const X in this._eventsInProgress){const{handlerName:oe,originalEvent:fe}=this._eventsInProgress[X];this._handlersById[oe].isActive()||(delete this._eventsInProgress[X],U=h[oe]||fe,O[`${X}end`]=U)}for(const X in O)this._fireEvent(X,O[X]);const H=Qi(this._eventsInProgress),Y=(v||T)&&!H;if(Y&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const X=this._map._getTransformForUpdate();X.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(X)}if(g&&Y){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=fe=>fe!==0&&-this._bearingSnap<fe&&fe<this._bearingSnap;!X||!X.essential&&N.prefersReducedMotion?(this._map.fire(new d.k("moveend",{originalEvent:U})),oe(this._map.getBearing())&&this._map.resetNorth()):(oe(X.bearing||this._map.getBearing())&&(X.bearing=0),X.freezeElevation=!0,this._map.easeTo(X,{originalEvent:U})),this._updatingCamera=!1}}_fireEvent(i,h){this._map.fire(new d.k(i,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((i=>{delete this._frameId,this.handleEvent(new jt("renderFrame",{timeStamp:i})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class lc extends d.E{constructor(i,h){super(),this._renderFrameCallback=()=>{const g=Math.min((N.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=h.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new d.N(this.transform.center.lng,this.transform.center.lat)}setCenter(i,h){return this.jumpTo({center:i},h)}panBy(i,h,g){return i=d.P.convert(i).mult(-1),this.panTo(this.transform.center,d.e({offset:i},h),g)}panTo(i,h,g){return this.easeTo(d.e({center:i},h),g)}getZoom(){return this.transform.zoom}setZoom(i,h){return this.jumpTo({zoom:i},h),this}zoomTo(i,h,g){return this.easeTo(d.e({zoom:i},h),g)}zoomIn(i,h){return this.zoomTo(this.getZoom()+1,i,h),this}zoomOut(i,h){return this.zoomTo(this.getZoom()-1,i,h),this}getBearing(){return this.transform.bearing}setBearing(i,h){return this.jumpTo({bearing:i},h),this}getPadding(){return this.transform.padding}setPadding(i,h){return this.jumpTo({padding:i},h),this}rotateTo(i,h,g){return this.easeTo(d.e({bearing:i},h),g)}resetNorth(i,h){return this.rotateTo(0,d.e({duration:1e3},i),h),this}resetNorthPitch(i,h){return this.easeTo(d.e({bearing:0,pitch:0,duration:1e3},i),h),this}snapToNorth(i,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,h):this}getPitch(){return this.transform.pitch}setPitch(i,h){return this.jumpTo({pitch:i},h),this}cameraForBounds(i,h){i=tt.convert(i).adjustAntiMeridian();const g=h&&h.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),g,h)}_cameraForBoxAndBearing(i,h,g,v){const T={top:0,bottom:0,right:0,left:0};if(typeof(v=d.e({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const Ht=v.padding;v.padding={top:Ht,bottom:Ht,right:Ht,left:Ht}}v.padding=d.e(T,v.padding);const z=this.transform,O=z.padding,U=new tt(i,h),H=z.project(U.getNorthWest()),Y=z.project(U.getNorthEast()),X=z.project(U.getSouthEast()),oe=z.project(U.getSouthWest()),fe=d.ba(-g),_e=H.rotate(fe),ke=Y.rotate(fe),Me=X.rotate(fe),Pe=oe.rotate(fe),Le=new d.P(Math.max(_e.x,ke.x,Pe.x,Me.x),Math.max(_e.y,ke.y,Pe.y,Me.y)),Te=new d.P(Math.min(_e.x,ke.x,Pe.x,Me.x),Math.min(_e.y,ke.y,Pe.y,Me.y)),$e=Le.sub(Te),Ve=(z.width-(O.left+O.right+v.padding.left+v.padding.right))/$e.x,it=(z.height-(O.top+O.bottom+v.padding.top+v.padding.bottom))/$e.y;if(it<0||Ve<0)return void d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const bt=Math.min(z.scaleZoom(z.scale*Math.min(Ve,it)),v.maxZoom),Ut=d.P.convert(v.offset),qt=new d.P((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(d.ba(g)),ii=Ut.add(qt).mult(z.scale/z.zoomScale(bt));return{center:z.unproject(H.add(X).div(2).sub(ii)),zoom:bt,bearing:g}}fitBounds(i,h,g){return this._fitInternal(this.cameraForBounds(i,h),h,g)}fitScreenCoordinates(i,h,g,v,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.P.convert(i)),this.transform.pointLocation(d.P.convert(h)),g,v),v,T)}_fitInternal(i,h,g){return i?(delete(h=d.e(i,h)).padding,h.linear?this.easeTo(h,g):this.flyTo(h,g)):this}jumpTo(i,h){this.stop();const g=this._getTransformForUpdate();let v=!1,T=!1,z=!1;return"zoom"in i&&g.zoom!==+i.zoom&&(v=!0,g.zoom=+i.zoom),i.center!==void 0&&(g.center=d.N.convert(i.center)),"bearing"in i&&g.bearing!==+i.bearing&&(T=!0,g.bearing=+i.bearing),"pitch"in i&&g.pitch!==+i.pitch&&(z=!0,g.pitch=+i.pitch),i.padding==null||g.isPaddingEqual(i.padding)||(g.padding=i.padding),this._applyUpdatedTransform(g),this.fire(new d.k("movestart",h)).fire(new d.k("move",h)),v&&this.fire(new d.k("zoomstart",h)).fire(new d.k("zoom",h)).fire(new d.k("zoomend",h)),T&&this.fire(new d.k("rotatestart",h)).fire(new d.k("rotate",h)).fire(new d.k("rotateend",h)),z&&this.fire(new d.k("pitchstart",h)).fire(new d.k("pitch",h)).fire(new d.k("pitchend",h)),this.fire(new d.k("moveend",h))}calculateCameraOptionsFromTo(i,h,g,v=0){const T=d.Z.fromLngLat(i,h),z=d.Z.fromLngLat(g,v),O=z.x-T.x,U=z.y-T.y,H=z.z-T.z,Y=Math.hypot(O,U,H);if(Y===0)throw new Error("Can't calculate camera options with same From and To");const X=Math.hypot(O,U),oe=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Y/this.transform.tileSize),fe=180*Math.atan2(O,-U)/Math.PI;let _e=180*Math.acos(X/Y)/Math.PI;return _e=H<0?90-_e:90+_e,{center:z.toLngLat(),zoom:oe,pitch:_e,bearing:fe}}easeTo(i,h){var g;this._stop(!1,i.easeId),((i=d.e({offset:[0,0],duration:500,easing:d.b9},i)).animate===!1||!i.essential&&N.prefersReducedMotion)&&(i.duration=0);const v=this._getTransformForUpdate(),T=v.zoom,z=v.bearing,O=v.pitch,U=v.padding,H="bearing"in i?this._normalizeBearing(i.bearing,z):z,Y="pitch"in i?+i.pitch:O,X="padding"in i?i.padding:v.padding,oe=d.P.convert(i.offset);let fe=v.centerPoint.add(oe);const _e=v.pointLocation(fe),{center:ke,zoom:Me}=v.getConstrained(d.N.convert(i.center||_e),(g=i.zoom)!==null&&g!==void 0?g:T);this._normalizeCenter(ke,v);const Pe=v.project(_e),Le=v.project(ke).sub(Pe),Te=v.zoomScale(Me-T);let $e,Ve;i.around&&($e=d.N.convert(i.around),Ve=v.locationPoint($e));const it={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Me!==T,this._rotating=this._rotating||z!==H,this._pitching=this._pitching||Y!==O,this._padding=!v.isPaddingEqual(X),this._easeId=i.easeId,this._prepareEase(h,i.noMoveStart,it),this.terrain&&this._prepareElevation(ke),this._ease((bt=>{if(this._zooming&&(v.zoom=d.y.number(T,Me,bt)),this._rotating&&(v.bearing=d.y.number(z,H,bt)),this._pitching&&(v.pitch=d.y.number(O,Y,bt)),this._padding&&(v.interpolatePadding(U,X,bt),fe=v.centerPoint.add(oe)),this.terrain&&!i.freezeElevation&&this._updateElevation(bt),$e)v.setLocationAtPoint($e,Ve);else{const Ut=v.zoomScale(v.zoom-T),qt=Me>T?Math.min(2,Te):Math.max(.5,Te),ii=Math.pow(qt,1-bt),Ht=v.unproject(Pe.add(Le.mult(bt*ii)).mult(Ut));v.setLocationAtPoint(v.renderWorldCopies?Ht.wrap():Ht,fe)}this._applyUpdatedTransform(v),this._fireMoveEvents(h)}),(bt=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(h,bt)}),i),this}_prepareEase(i,h,g={}){this._moving=!0,h||g.moving||this.fire(new d.k("movestart",i)),this._zooming&&!g.zooming&&this.fire(new d.k("zoomstart",i)),this._rotating&&!g.rotating&&this.fire(new d.k("rotatestart",i)),this._pitching&&!g.pitching&&this.fire(new d.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const h=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&h!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(g-(h-(g*i+this._elevationStart))/(1-i)),this._elevationTarget=h}this.transform.elevation=d.y.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(i){const h=i.getCameraPosition(),g=this.terrain.getElevationForLngLatZoom(h.lngLat,i.zoom);if(h.altitude<g){const v=this.calculateCameraOptionsFromTo(h.lngLat,g,i.center,i.elevation);return{pitch:v.pitch,zoom:v.zoom}}return{}}_applyUpdatedTransform(i){const h=[];if(this.terrain&&h.push((v=>this._elevateCameraIfInsideTerrain(v))),this.transformCameraUpdate&&h.push((v=>this.transformCameraUpdate(v))),!h.length)return;const g=i.clone();for(const v of h){const T=g.clone(),{center:z,zoom:O,pitch:U,bearing:H,elevation:Y}=v(T);z&&(T.center=z),O!==void 0&&(T.zoom=O),U!==void 0&&(T.pitch=U),H!==void 0&&(T.bearing=H),Y!==void 0&&(T.elevation=Y),g.apply(T)}this.transform.apply(g)}_fireMoveEvents(i){this.fire(new d.k("move",i)),this._zooming&&this.fire(new d.k("zoom",i)),this._rotating&&this.fire(new d.k("rotate",i)),this._pitching&&this.fire(new d.k("pitch",i))}_afterEase(i,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId;const g=this._zooming,v=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new d.k("zoomend",i)),v&&this.fire(new d.k("rotateend",i)),T&&this.fire(new d.k("pitchend",i)),this.fire(new d.k("moveend",i))}flyTo(i,h){var g;if(!i.essential&&N.prefersReducedMotion){const Xt=d.M(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Xt,h)}this.stop(),i=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.b9},i);const v=this._getTransformForUpdate(),T=v.zoom,z=v.bearing,O=v.pitch,U=v.padding,H="bearing"in i?this._normalizeBearing(i.bearing,z):z,Y="pitch"in i?+i.pitch:O,X="padding"in i?i.padding:v.padding,oe=d.P.convert(i.offset);let fe=v.centerPoint.add(oe);const _e=v.pointLocation(fe),{center:ke,zoom:Me}=v.getConstrained(d.N.convert(i.center||_e),(g=i.zoom)!==null&&g!==void 0?g:T);this._normalizeCenter(ke,v);const Pe=v.zoomScale(Me-T),Le=v.project(_e),Te=v.project(ke).sub(Le);let $e=i.curve;const Ve=Math.max(v.width,v.height),it=Ve/Pe,bt=Te.mag();if("minZoom"in i){const Xt=d.ac(Math.min(i.minZoom,T,Me),v.minZoom,v.maxZoom),Ii=Ve/v.zoomScale(Xt-T);$e=Math.sqrt(Ii/bt*2)}const Ut=$e*$e;function qt(Xt){const Ii=(it*it-Ve*Ve+(Xt?-1:1)*Ut*Ut*bt*bt)/(2*(Xt?it:Ve)*Ut*bt);return Math.log(Math.sqrt(Ii*Ii+1)-Ii)}function ii(Xt){return(Math.exp(Xt)-Math.exp(-Xt))/2}function Ht(Xt){return(Math.exp(Xt)+Math.exp(-Xt))/2}const Ft=qt(!1);let oi=function(Xt){return Ht(Ft)/Ht(Ft+$e*Xt)},ji=function(Xt){return Ve*((Ht(Ft)*(ii(Ii=Ft+$e*Xt)/Ht(Ii))-ii(Ft))/Ut)/bt;var Ii},Zt=(qt(!0)-Ft)/$e;if(Math.abs(bt)<1e-6||!isFinite(Zt)){if(Math.abs(Ve-it)<1e-6)return this.easeTo(i,h);const Xt=it<Ve?-1:1;Zt=Math.abs(Math.log(it/Ve))/$e,ji=()=>0,oi=Ii=>Math.exp(Xt*$e*Ii)}return i.duration="duration"in i?+i.duration:1e3*Zt/("screenSpeed"in i?+i.screenSpeed/$e:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=z!==H,this._pitching=Y!==O,this._padding=!v.isPaddingEqual(X),this._prepareEase(h,!1),this.terrain&&this._prepareElevation(ke),this._ease((Xt=>{const Ii=Xt*Zt,Vn=1/oi(Ii);v.zoom=Xt===1?Me:T+v.scaleZoom(Vn),this._rotating&&(v.bearing=d.y.number(z,H,Xt)),this._pitching&&(v.pitch=d.y.number(O,Y,Xt)),this._padding&&(v.interpolatePadding(U,X,Xt),fe=v.centerPoint.add(oe)),this.terrain&&!i.freezeElevation&&this._updateElevation(Xt);const Xi=Xt===1?ke:v.unproject(Le.add(Te.mult(ji(Ii))).mult(Vn));v.setLocationAtPoint(v.renderWorldCopies?Xi.wrap():Xi,fe),this._applyUpdatedTransform(v),this._fireMoveEvents(h)}),(()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(h)}),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,h){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,h)}return i||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(i,h,g){g.animate===!1||g.duration===0?(i(1),h()):(this._easeStart=N.now(),this._easeOptions=g,this._onEaseFrame=i,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,h){i=d.b3(i,-180,180);const g=Math.abs(i-h);return Math.abs(i-360-h)<g&&(i-=360),Math.abs(i+360-h)<g&&(i+=360),i}_normalizeCenter(i,h){if(!h.renderWorldCopies||h.lngRange)return;const g=i.lng-h.center.lng;i.lng+=g>180?-360:g<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(d.N.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}const Gr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Do{constructor(i=Gr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=h=>{!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"&&h.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,h){const g=this._map._getUIString(`AttributionControl.${h}`);i.title=g,i.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map((v=>typeof v!="string"?"":v))):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style.sourceCaches;for(const v in h){const T=h[v];if(T.used||T.usedForTerrain){const z=T.getSource();z.attribution&&i.indexOf(z.attribution)<0&&i.push(z.attribution)}}i=i.filter((v=>String(v).trim())),i.sort(((v,T)=>v.length-T.length)),i=i.filter(((v,T)=>{for(let z=T+1;z<i.length;z++)if(i[z].indexOf(v)>=0)return!1;return!0}));const g=i.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,i.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ms{constructor(i={}){this._updateCompact=()=>{const h=this._container.children;if(h.length){const g=h[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl");const h=V.create("a","maplibregl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ui{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const h=++this._id;return this._queue.push({callback:i,id:h,cancelled:!1}),h}remove(i){const h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(const v of g)if(v.id===i)return void(v.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const h=this._currentlyRunning=this._queue;this._queue=[];for(const g of h)if(!g.cancelled&&(g.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var mo=d.Y([{name:"a_pos3d",type:"Int16",components:3}]);class ku extends d.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,h){this.sourceCache.update(i,h),this._renderableTilesKeys=[];const g={};for(const v of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:h}))g[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.posMatrix=new Float64Array(16),d.aP(v.posMatrix,0,d.X,0,d.X,0,1),this._tiles[v.key]=new Kn(v,this.tileSize));for(const v in this._tiles)g[v]||delete this._tiles[v]}freeRtt(i){for(const h in this._tiles){const g=this._tiles[h];(!i||g.tileID.equals(i)||g.tileID.isChildOf(i)||i.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((i=>this.getTileByID(i)))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const h={};for(const g of this._renderableTilesKeys){const v=this._tiles[g].tileID;if(v.canonical.equals(i.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16),d.aP(T.posMatrix,0,d.X,0,d.X,0,1),h[g]=T}else if(v.canonical.isChildOf(i.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16);const z=v.canonical.z-i.canonical.z,O=v.canonical.x-(v.canonical.x>>z<<z),U=v.canonical.y-(v.canonical.y>>z<<z),H=d.X>>z;d.aP(T.posMatrix,0,H,0,H,0,1),d.J(T.posMatrix,T.posMatrix,[-O*H,-U*H,0]),h[g]=T}else if(i.canonical.isChildOf(v.canonical)){const T=i.clone();T.posMatrix=new Float64Array(16);const z=i.canonical.z-v.canonical.z,O=i.canonical.x-(i.canonical.x>>z<<z),U=i.canonical.y-(i.canonical.y>>z<<z),H=d.X>>z;d.aP(T.posMatrix,0,d.X,0,d.X,0,1),d.J(T.posMatrix,T.posMatrix,[O*H,U*H,0]),d.K(T.posMatrix,T.posMatrix,[1/2**z,1/2**z,0]),h[g]=T}}return h}getSourceTile(i,h){const g=this.sourceCache._source;let v=i.overscaledZ-this.deltaZoom;if(v>g.maxzoom&&(v=g.maxzoom),v<g.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(v).key);let T=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!T||!T.dem)&&h)for(;v>=g.minzoom&&(!T||!T.dem);)T=this.sourceCache.getTileByID(i.scaledTo(v--).key);return T}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter((h=>h.timeAdded>=i))}}class gl{constructor(i,h,g){this.painter=i,this.sourceCache=new ku(h),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,h,g,v=d.X){var T;if(!(h>=0&&h<v&&g>=0&&g<v))return 0;const z=this.getTerrainData(i),O=(T=z.tile)===null||T===void 0?void 0:T.dem;if(!O)return 0;const U=(function(_e,ke,Me){var Pe=ke[0],Le=ke[1];return _e[0]=Me[0]*Pe+Me[4]*Le+Me[12],_e[1]=Me[1]*Pe+Me[5]*Le+Me[13],_e})([],[h/v*d.X,g/v*d.X],z.u_terrain_matrix),H=[U[0]*O.dim,U[1]*O.dim],Y=Math.floor(H[0]),X=Math.floor(H[1]),oe=H[0]-Y,fe=H[1]-X;return O.get(Y,X)*(1-oe)*(1-fe)+O.get(Y+1,X)*oe*(1-fe)+O.get(Y,X+1)*(1-oe)*fe+O.get(Y+1,X+1)*oe*fe}getElevationForLngLatZoom(i,h){if(!d.bb(h,i.wrap()))return 0;const{tileID:g,mercatorX:v,mercatorY:T}=this._getOverscaledTileIDFromLngLatZoom(i,h);return this.getElevation(g,v%d.X,T%d.X,d.X)}getElevation(i,h,g,v=d.X){return this.getDEMElevation(i,h,g,v)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const v=this.painter.context,T=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new lt(v,T,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new lt(v,new d.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.an([])}const h=this.sourceCache.getSourceTile(i,!0);if(h&&h.dem&&(!h.demTexture||h.needsTerrainPrepare)){const v=this.painter.context;h.demTexture=this.painter.getTileTexture(h.dem.stride),h.demTexture?h.demTexture.update(h.dem.getPixels(),{premultiply:!1}):h.demTexture=new lt(v,h.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),h.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),h.needsTerrainPrepare=!1}const g=h&&h+h.tileID.key+i.key;if(g&&!this._demMatrixCache[g]){const v=this.sourceCache.sourceCache._source.maxzoom;let T=i.canonical.z-h.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=v?T=i.canonical.z-v:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=i.canonical.x-(i.canonical.x>>T<<T),O=i.canonical.y-(i.canonical.y>>T<<T),U=d.bc(new Float64Array(16),[1/(d.X<<T),1/(d.X<<T),0]);d.J(U,U,[z*d.X,O*d.X,0]),this._demMatrixCache[i.key]={matrix:U,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:h&&h.dem&&h.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:h&&h.dem&&h.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(h&&h.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:h}}getFramebuffer(i){const h=this.painter,g=h.width/devicePixelRatio,v=h.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new lt(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new lt(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=h.context.createFramebuffer(g,v,!0,!1),this._fbo.depthAttachment.set(h.context.createRenderbuffer(h.context.gl.DEPTH_COMPONENT16,g,v))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const h=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let T=0,z=0;T<this._coordsTextureSize;T++)for(let O=0;O<this._coordsTextureSize;O++,z+=4)h[z+0]=255&O,h[z+1]=255&T,h[z+2]=O>>8<<4|T>>8,h[z+3]=0;const g=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(h.buffer)),v=new lt(i,g,i.gl.RGBA,{premultiply:!1});return v.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const h=new Uint8Array(4),g=this.painter.context,v=g.gl,T=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),z=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),O=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(T,O-z-1,1,1,v.RGBA,v.UNSIGNED_BYTE,h),g.bindFramebuffer.set(null);const U=h[0]+(h[2]>>4<<8),H=h[1]+((15&h[2])<<8),Y=this.coordsIndex[255-h[3]],X=Y&&this.sourceCache.getTileByID(Y);if(!X)return null;const oe=this._coordsTextureSize,fe=(1<<X.tileID.canonical.z)*oe;return new d.Z((X.tileID.canonical.x*oe+U)/fe+X.tileID.wrap,(X.tileID.canonical.y*oe+H)/fe,this.getElevation(X.tileID,U,H,oe))}depthAtPoint(i){const h=new Uint8Array(4),g=this.painter.context,v=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,h),g.bindFramebuffer.set(null),(h[0]/16777216+h[1]/65536+h[2]/256+h[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.painter.context,h=new d.bd,g=new d.aY,v=this.meshSize,T=d.X/v,z=v*v;for(let X=0;X<=v;X++)for(let oe=0;oe<=v;oe++)h.emplaceBack(oe*T,X*T,0);for(let X=0;X<z;X+=v+1)for(let oe=0;oe<v;oe++)g.emplaceBack(oe+X,v+oe+X+1,v+oe+X+2),g.emplaceBack(oe+X,v+oe+X+2,oe+X+1);const O=h.length,U=O+2*(v+1);for(const X of[0,1])for(let oe=0;oe<=v;oe++)for(const fe of[0,1])h.emplaceBack(oe*T,X*d.X,fe);for(let X=0;X<2*v;X+=2)g.emplaceBack(U+X,U+X+1,U+X+3),g.emplaceBack(U+X,U+X+3,U+X+2),g.emplaceBack(O+X,O+X+3,O+X+1),g.emplaceBack(O+X,O+X+2,O+X+3);const H=h.length,Y=H+2*(v+1);for(const X of[0,1])for(let oe=0;oe<=v;oe++)for(const fe of[0,1])h.emplaceBack(X*d.X,oe*T,fe);for(let X=0;X<2*v;X+=2)g.emplaceBack(H+X,H+X+1,H+X+3),g.emplaceBack(H+X,H+X+3,H+X+2),g.emplaceBack(Y+X,Y+X+3,Y+X+1),g.emplaceBack(Y+X,Y+X+2,Y+X+3);return this._mesh=new Lo(i.createVertexBuffer(h,mo.members),i.createIndexBuffer(g),d.a0.simpleSegment(0,0,h.length,g.length)),this._mesh}getMeshFrameDelta(i){return 2*Math.PI*d.be/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,h){var g;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(i,h);return(g=this.getMinMaxElevation(v).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(i){const h=this.getTerrainData(i).tile,g={minElevation:null,maxElevation:null};return h&&h.dem&&(g.minElevation=h.dem.min*this.exaggeration,g.maxElevation=h.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(i,h){const g=d.Z.fromLngLat(i.wrap()),v=(1<<h)*d.X,T=g.x*v,z=g.y*v,O=Math.floor(T/d.X),U=Math.floor(z/d.X);return{tileID:new d.S(h,0,h,O,U),mercatorX:T,mercatorY:z}}}class cc{constructor(i,h,g){this._context=i,this._size=h,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const h=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new lt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),h.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),h.colorAttachment.set(g.texture),{id:i,fbo:h,texture:g,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((h=>i.id!==h)),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const h of this._recentlyUsed)if(!this._objects[h].inUse)return this._objects[h];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((i=>!i.inUse))===!1}}const Wr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Va{constructor(i,h){this.painter=i,this.terrain=h,this.pool=new cc(i.context,30,h.sourceCache.tileSize*h.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,h){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter((g=>!i._layers[g].isHidden(h))),this._coordsDescendingInv={};for(const g in i.sourceCaches){this._coordsDescendingInv[g]={};const v=i.sourceCaches[g].getVisibleCoordinates();for(const T of v){const z=this.terrain.sourceCache.getTerrainCoords(T);for(const O in z)this._coordsDescendingInv[g][O]||(this._coordsDescendingInv[g][O]=[]),this._coordsDescendingInv[g][O].push(z[O])}}this._coordsDescendingInvStr={};for(const g of i._order){const v=i._layers[g],T=v.source;if(Wr[v.type]&&!this._coordsDescendingInvStr[T]){this._coordsDescendingInvStr[T]={};for(const z in this._coordsDescendingInv[T])this._coordsDescendingInvStr[T][z]=this._coordsDescendingInv[T][z].map((O=>O.key)).sort().join()}}for(const g of this._renderableTiles)for(const v in this._coordsDescendingInvStr){const T=this._coordsDescendingInvStr[v][g.tileID.key];T&&T!==g.rttCoords[v]&&(g.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;const h=i.type,g=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(Wr[h]&&(this._prevType&&Wr[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(i.id),!v))return!0;if(Wr[this._prevType]||Wr[h]&&v){this._prevType=h;const T=this._stacks.length-1,z=this._stacks[T]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(sc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[T]){const H=this.pool.getObjectForId(O.rtt[T].id);if(H.stamp===O.rtt[T].stamp){this.pool.useObject(H);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),O.rtt[T]={id:U.id,stamp:U.stamp},g.context.bindFramebuffer.set(U.fbo.framebuffer),g.context.clear({color:d.aM.transparent,stencil:0}),g.currentStencilSource=void 0;for(let H=0;H<z.length;H++){const Y=g.style._layers[z[H]],X=Y.source?this._coordsDescendingInv[Y.source][O.tileID.key]:[O.tileID];g.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),g._renderTileClippingMasks(Y,X),g.renderLayer(g,g.style.sourceCaches[Y.source],Y,X),Y.source&&(O.rttCoords[Y.source]=this._coordsDescendingInvStr[Y.source][O.tileID.key])}}return sc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Wr[h]}return!1}}const Oo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},No=A,ed={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Gr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Cu=E=>{E.touchstart=E.dragStart,E.touchmoveWindow=E.dragMove,E.touchend=E.dragEnd},qc={showCompass:!0,showZoom:!0,visualizePitch:!1};class oh{constructor(i,h,g=!1){this.mousedown=z=>{this.startMouse(d.e({},z,{ctrlKey:!0,preventDefault:()=>z.preventDefault()}),V.mousePos(this.element,z)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=z=>{this.moveMouse(z,V.mousePos(this.element,z))},this.mouseup=z=>{this.mouseRotate.dragEnd(z),this.mousePitch&&this.mousePitch.dragEnd(z),this.offTemp()},this.touchstart=z=>{z.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,z.targetTouches)[0],this.startTouch(z,this._startPos),V.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.addEventListener(window,"touchend",this.touchend))},this.touchmove=z=>{z.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,z.targetTouches)[0],this.moveTouch(z,this._lastPos))},this.touchend=z=>{z.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const v=i.dragRotate._mouseRotate.getClickTolerance(),T=i.dragRotate._mousePitch.getClickTolerance();this.element=h,this.mouseRotate=ac({clickTolerance:v,enable:!0}),this.touchRotate=(({enable:z,clickTolerance:O,bearingDegreesPerPixelMoved:U=.8})=>{const H=new Ul;return new br({clickTolerance:O,move:(Y,X)=>({bearingDelta:(X.x-Y.x)*U}),moveStateManager:H,enable:z,assignEvents:Cu})})({clickTolerance:v,enable:!0}),this.map=i,g&&(this.mousePitch=fl({clickTolerance:T,enable:!0}),this.touchPitch=(({enable:z,clickTolerance:O,pitchDegreesPerPixelMoved:U=-.5})=>{const H=new Ul;return new br({clickTolerance:O,move:(Y,X)=>({pitchDelta:(X.y-Y.y)*U}),moveStateManager:H,enable:z,assignEvents:Cu})})({clickTolerance:T,enable:!0})),V.addEventListener(h,"mousedown",this.mousedown),V.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(h,"touchcancel",this.reset)}startMouse(i,h){this.mouseRotate.dragStart(i,h),this.mousePitch&&this.mousePitch.dragStart(i,h),V.disableDrag()}startTouch(i,h){this.touchRotate.dragStart(i,h),this.touchPitch&&this.touchPitch.dragStart(i,h),V.disableDrag()}moveMouse(i,h){const g=this.map,{bearingDelta:v}=this.mouseRotate.dragMove(i,h)||{};if(v&&g.setBearing(g.getBearing()+v),this.mousePitch){const{pitchDelta:T}=this.mousePitch.dragMove(i,h)||{};T&&g.setPitch(g.getPitch()+T)}}moveTouch(i,h){const g=this.map,{bearingDelta:v}=this.touchRotate.dragMove(i,h)||{};if(v&&g.setBearing(g.getBearing()+v),this.touchPitch){const{pitchDelta:T}=this.touchPitch.dragMove(i,h)||{};T&&g.setPitch(g.getPitch()+T)}}off(){const i=this.element;V.removeEventListener(i,"mousedown",this.mousedown),V.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend),V.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend)}}let Js;function nn(E,i,h){const g=new d.N(E.lng,E.lat);if(E=new d.N(E.lng,E.lat),i){const v=new d.N(E.lng-360,E.lat),T=new d.N(E.lng+360,E.lat),z=h.locationPoint(E).distSqr(i);h.locationPoint(v).distSqr(i)<z?E=v:h.locationPoint(T).distSqr(i)<z&&(E=T)}for(;Math.abs(E.lng-h.center.lng)>180;){const v=h.locationPoint(E);if(v.x>=0&&v.y>=0&&v.x<=h.width&&v.y<=h.height)break;E.lng>h.center.lng?E.lng-=360:E.lng+=360}return E.lng!==g.lng&&h.locationPoint(E).y>h.height/2-h.getHorizon()?E:g}const yl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Au(E,i,h){const g=E.classList;for(const v in yl)g.remove(`maplibregl-${h}-anchor-${v}`);g.add(`maplibregl-${h}-anchor-${i}`)}class lh extends d.E{constructor(i){if(super(),this._onKeyPress=h=>{const g=h.code,v=h.charCode||h.keyCode;g!=="Space"&&g!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=h=>{const g=h.originalEvent.target,v=this._element;this._popup&&(g===v||v.contains(g))&&this.togglePopup()},this._update=h=>{var g;if(!this._map)return;const v=this._map.loaded()&&!this._map.isMoving();(h?.type==="terrain"||h?.type==="render"&&!v)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?nn(this._lngLat,this._flatPos,this._map.transform):(g=this._lngLat)===null||g===void 0?void 0:g.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let T="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?T=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(T=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let z="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?z="rotateX(0deg)":this._pitchAlignment==="map"&&(z=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||h&&h.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${yl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${z} ${T}`),N.frameAsync(new AbortController).then((()=>{this._updateOpacity(h&&h.type==="moveend")})).catch((()=>{}))},this._onMove=h=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.k("dragstart"))),this.fire(new d.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.k("dragend")),this._state="inactive"},this._addDragHandler=h=>{this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._subpixelPositioning=i&&i.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(i?.opacity,i?.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=d.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div");const h=V.createNS("http://www.w3.org/2000/svg","svg"),g=41,v=27;h.setAttributeNS(null,"display","block"),h.setAttributeNS(null,"height",`${g}px`),h.setAttributeNS(null,"width",`${v}px`),h.setAttributeNS(null,"viewBox",`0 0 ${v} ${g}`);const T=V.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const z=V.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill-rule","nonzero");const O=V.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"transform","translate(3.0, 29.0)"),O.setAttributeNS(null,"fill","#000000");const U=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of U){const Le=V.createNS("http://www.w3.org/2000/svg","ellipse");Le.setAttributeNS(null,"opacity","0.04"),Le.setAttributeNS(null,"cx","10.5"),Le.setAttributeNS(null,"cy","5.80029008"),Le.setAttributeNS(null,"rx",Pe.rx),Le.setAttributeNS(null,"ry",Pe.ry),O.appendChild(Le)}const H=V.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);const Y=V.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(Y);const X=V.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const oe=V.createNS("http://www.w3.org/2000/svg","path");oe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild(oe);const fe=V.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),fe.setAttributeNS(null,"fill","#FFFFFF");const _e=V.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ke=V.createNS("http://www.w3.org/2000/svg","circle");ke.setAttributeNS(null,"fill","#000000"),ke.setAttributeNS(null,"opacity","0.25"),ke.setAttributeNS(null,"cx","5.5"),ke.setAttributeNS(null,"cy","5.5"),ke.setAttributeNS(null,"r","5.4999962");const Me=V.createNS("http://www.w3.org/2000/svg","circle");Me.setAttributeNS(null,"fill","#FFFFFF"),Me.setAttributeNS(null,"cx","5.5"),Me.setAttributeNS(null,"cy","5.5"),Me.setAttributeNS(null,"r","5.4999962"),_e.appendChild(ke),_e.appendChild(Me),z.appendChild(O),z.appendChild(H),z.appendChild(X),z.appendChild(fe),z.appendChild(_e),h.appendChild(z),h.setAttributeNS(null,"height",g*this._scale+"px"),h.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(h),this._offset=d.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(h=>{h.preventDefault()})),this._element.addEventListener("mousedown",(h=>{h.preventDefault()})),Au(this._element,this._anchor,"marker"),i&&i.className)for(const h of i.className.split(" "))this._element.classList.add(h);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=d.N.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const v=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(i){return this._subpixelPositioning=i,this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var h,g;if(!(!((h=this._map)===null||h===void 0)&&h.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const v=this._map,T=v.terrain.depthAtPoint(this._pos),z=v.terrain.getElevationForLngLatZoom(this._lngLat,v.transform.tileZoom);if(v.transform.lngLatToCameraDepth(this._lngLat,z)-T<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/v.transform._pixelPerMeter,U=Math.sin(v.getPitch()*Math.PI/180)*O,H=v.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),Y=v.transform.lngLatToCameraDepth(this._lngLat,z+U)-H>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&Y&&this._popup.remove(),this._element.style.opacity=Y?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=d.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,h){return i===void 0&&h===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),h!==void 0&&(this._opacityWhenCovered=h),this._map&&this._updateOpacity(!0),this}}const sf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Mu=0,_s=!1;const qa={maxWidth:100,unit:"metric"};function _l(E,i,h){const g=h&&h.maxWidth||100,v=E._container.clientHeight/2,T=E.unproject([0,v]),z=E.unproject([g,v]),O=T.distanceTo(z);if(h&&h.unit==="imperial"){const U=3.2808*O;U>5280?ui(i,g,U/5280,E._getUIString("ScaleControl.Miles")):ui(i,g,U,E._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?ui(i,g,O/1852,E._getUIString("ScaleControl.NauticalMiles")):O>=1e3?ui(i,g,O/1e3,E._getUIString("ScaleControl.Kilometers")):ui(i,g,O,E._getUIString("ScaleControl.Meters"))}function ui(E,i,h,g){const v=(function(T){const z=Math.pow(10,`${Math.floor(T)}`.length-1);let O=T/z;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:(function(U){const H=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*H)/H})(O),z*O})(h);E.style.width=i*(v/h)+"px",E.innerHTML=`${v}&nbsp;${g}`}const Ti={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xl(E){if(E){if(typeof E=="number"){const i=Math.round(Math.abs(E)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,E),"top-left":new d.P(i,i),"top-right":new d.P(-i,i),bottom:new d.P(0,-E),"bottom-left":new d.P(i,-i),"bottom-right":new d.P(-i,-i),left:new d.P(E,0),right:new d.P(-E,0)}}if(E instanceof d.P||Array.isArray(E)){const i=d.P.convert(E);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:d.P.convert(E.center||[0,0]),top:d.P.convert(E.top||[0,0]),"top-left":d.P.convert(E["top-left"]||[0,0]),"top-right":d.P.convert(E["top-right"]||[0,0]),bottom:d.P.convert(E.bottom||[0,0]),"bottom-left":d.P.convert(E["bottom-left"]||[0,0]),"bottom-right":d.P.convert(E["bottom-right"]||[0,0]),left:d.P.convert(E.left||[0,0]),right:d.P.convert(E.right||[0,0])}}return xl(new d.P(0,0))}const td=A;y.AJAXError=d.bh,y.Evented=d.E,y.LngLat=d.N,y.MercatorCoordinate=d.Z,y.Point=d.P,y.addProtocol=d.bi,y.config=d.a,y.removeProtocol=d.bj,y.AttributionControl=Do,y.BoxZoomHandler=As,y.CanvasSource=en,y.CooperativeGesturesHandler=bn,y.DoubleClickZoomHandler=Yt,y.DragPanHandler=qs,y.DragRotateHandler=bs,y.EdgeInsets=Ta,y.FullscreenControl=class extends d.E{constructor(E={}){super(),this._onFullscreenChange=()=>{var i;let h=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=h?.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)h=h.shadowRoot.fullscreenElement;h===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,E&&E.container&&(E.container instanceof HTMLElement?this._container=E.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const E=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon",E).setAttribute("aria-hidden","true"),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=Cn,y.GeolocateControl=class extends d.E{constructor(E){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new d.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{const h=new d.N(i.coords.longitude,i.coords.latitude),g=i.coords.accuracy,v=this._map.getBearing(),T=d.e({bearing:v},this.options.fitBoundsOptions),z=tt.fromLngLat(h,g);this._map.fitBounds(z,T,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const h=new d.N(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&_s)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=i=>{if(this._map){if(i===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new lh({element:this._dotElement}),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.k("trackuserlocationend")),this.fire(new d.k("userlocationlostfocus")))}))}},this.options=d.e({},sf,E)}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return d._(this,arguments,void 0,(function*(i=!1){if(Js!==void 0&&!i)return Js;if(window.navigator.permissions===void 0)return Js=!!window.navigator.geolocation,Js;try{Js=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Js=!!window.navigator.geolocation}return Js}))})().then((i=>this._finishSetupUI(i))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Mu=0,_s=!1}_isOutOfMapMaxBounds(E){const i=this._map.getMaxBounds(),h=E.coords;return i&&(h.longitude<i.getWest()||h.longitude>i.getEast()||h.latitude<i.getSouth()||h.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const E=this._map.getBounds(),i=E.getSouthEast(),h=E.getNorthEast(),g=i.distanceTo(h),v=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Mu--,_s=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.k("trackuserlocationstart")),this.fire(new d.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let E;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Mu++,Mu>1?(E={maximumAge:6e5,timeout:0},_s=!0):(E=this.options.positionOptions,_s=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,E)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.Hash=zo,y.ImageSource=us,y.KeyboardHandler=Ce,y.LngLatBounds=tt,y.LogoControl=ms,y.Map=class extends lc{constructor(E){d.bf.mark(d.bg.create);const i=Object.assign(Object.assign({},ed),E);if(i.minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ul(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ui,this._controls=[],this._mapId=d.a4(),this._contextLost=h=>{h.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.k("webglcontextlost",{originalEvent:h}))},this._contextRestored=h=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.k("webglcontextrestored",{originalEvent:h}))},this._onMapScroll=h=>{if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=i.preserveDrawingBuffer===!0,this._antialias=i.antialias===!0,this._trackResize=i.trackResize===!0,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles===!0,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=i.crossSourceCollisions===!0,this._collectResourceTiming=i.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Oo),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=i.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ae.addThrottleControl((()=>this.isMoving())),this._requestManager=new me(i.transformRequest),typeof i.container=="string"){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let h=!1;const g=Cs((v=>{this._trackResize&&!this._removed&&(this.resize(v),this.redraw())}),50);this._resizeObserver=new ResizeObserver((v=>{h?g(v):h=!0})),this._resizeObserver.observe(this._container)}this.handlers=new jr(this,i),this._hash=i.hash&&new zo(typeof i.hash=="string"&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,d.e({},i.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new Do(typeof i.attributionControl=="boolean"?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new ms,i.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(h=>{this._update(h.dataType==="style"),this.fire(new d.k(`${h.dataType}data`,h))})),this.on("dataloading",(h=>{this.fire(new d.k(`${h.dataType}dataloading`,h))})),this.on("dataabort",(h=>{this.fire(new d.k("sourcedataabort",h))}))}_getMapId(){return this._mapId}addControl(E,i){if(i===void 0&&(i=E.getDefaultPosition?E.getDefaultPosition():"top-right"),!E||!E.onAdd)return this.fire(new d.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=E.onAdd(this);this._controls.push(E);const g=this._controlPositions[i];return i.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(E){if(!E||!E.onRemove)return this.fire(new d.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(E);return i>-1&&this._controls.splice(i,1),E.onRemove(this),this}hasControl(E){return this._controls.indexOf(E)>-1}calculateCameraOptionsFromTo(E,i,h,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(h,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(E,i,h,g)}resize(E){var i;const h=this._containerDimensions(),g=h[0],v=h[1],T=this._getClampedPixelRatio(g,v);if(this._resizeCanvas(g,v,T),this.painter.resize(g,v,T),this.painter.overLimit()){const O=this.painter.context.gl;this._maxCanvasSize=[O.drawingBufferWidth,O.drawingBufferHeight];const U=this._getClampedPixelRatio(g,v);this._resizeCanvas(g,v,U),this.painter.resize(g,v,U)}this.transform.resize(g,v),(i=this._requestedCameraState)===null||i===void 0||i.resize(g,v);const z=!this._moving;return z&&(this.stop(),this.fire(new d.k("movestart",E)).fire(new d.k("move",E))),this.fire(new d.k("resize",E)),z&&this.fire(new d.k("moveend",E)),this}_getClampedPixelRatio(E,i){const{0:h,1:g}=this._maxCanvasSize,v=this.getPixelRatio(),T=E*v,z=i*v;return Math.min(T>h?h/T:1,z>g?g/z:1)*v}getPixelRatio(){var E;return(E=this._overridePixelRatio)!==null&&E!==void 0?E:devicePixelRatio}setPixelRatio(E){this._overridePixelRatio=E,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(E){return this.transform.setMaxBounds(tt.convert(E)),this._update()}setMinZoom(E){if((E=E??-2)>=-2&&E<=this.transform.maxZoom)return this.transform.minZoom=E,this._update(),this.getZoom()<E&&this.setZoom(E),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(E){if((E=E??22)>=this.transform.minZoom)return this.transform.maxZoom=E,this._update(),this.getZoom()>E&&this.setZoom(E),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(E){if((E=E??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(E>=0&&E<=this.transform.maxPitch)return this.transform.minPitch=E,this._update(),this.getPitch()<E&&this.setPitch(E),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(E){if((E=E??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(E>=this.transform.minPitch)return this.transform.maxPitch=E,this._update(),this.getPitch()>E&&this.setPitch(E),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(E){return this.transform.renderWorldCopies=E,this._update()}project(E){return this.transform.locationPoint(d.N.convert(E),this.style&&this.terrain)}unproject(E){return this.transform.pointLocation(d.P.convert(E),this.terrain)}isMoving(){var E;return this._moving||((E=this.handlers)===null||E===void 0?void 0:E.isMoving())}isZooming(){var E;return this._zooming||((E=this.handlers)===null||E===void 0?void 0:E.isZooming())}isRotating(){var E;return this._rotating||((E=this.handlers)===null||E===void 0?void 0:E.isRotating())}_createDelegatedListener(E,i,h){if(E==="mouseenter"||E==="mouseover"){let g=!1;return{layers:i,listener:h,delegates:{mousemove:T=>{const z=i.filter((U=>this.getLayer(U))),O=z.length!==0?this.queryRenderedFeatures(T.point,{layers:z}):[];O.length?g||(g=!0,h.call(this,new Wn(E,this,T.originalEvent,{features:O}))):g=!1},mouseout:()=>{g=!1}}}}if(E==="mouseleave"||E==="mouseout"){let g=!1;return{layers:i,listener:h,delegates:{mousemove:z=>{const O=i.filter((U=>this.getLayer(U)));(O.length!==0?this.queryRenderedFeatures(z.point,{layers:O}):[]).length?g=!0:g&&(g=!1,h.call(this,new Wn(E,this,z.originalEvent)))},mouseout:z=>{g&&(g=!1,h.call(this,new Wn(E,this,z.originalEvent)))}}}}{const g=v=>{const T=i.filter((O=>this.getLayer(O))),z=T.length!==0?this.queryRenderedFeatures(v.point,{layers:T}):[];z.length&&(v.features=z,h.call(this,v),delete v.features)};return{layers:i,listener:h,delegates:{[E]:g}}}}_saveDelegatedListener(E,i){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[E]=this._delegatedListeners[E]||[],this._delegatedListeners[E].push(i)}_removeDelegatedListener(E,i,h){if(!this._delegatedListeners||!this._delegatedListeners[E])return;const g=this._delegatedListeners[E];for(let v=0;v<g.length;v++){const T=g[v];if(T.listener===h&&T.layers.length===i.length&&T.layers.every((z=>i.includes(z)))){for(const z in T.delegates)this.off(z,T.delegates[z]);return void g.splice(v,1)}}}on(E,i,h){if(h===void 0)return super.on(E,i);const g=this._createDelegatedListener(E,typeof i=="string"?[i]:i,h);this._saveDelegatedListener(E,g);for(const v in g.delegates)this.on(v,g.delegates[v]);return this}once(E,i,h){if(h===void 0)return super.once(E,i);const g=typeof i=="string"?[i]:i,v=this._createDelegatedListener(E,g,h);for(const T in v.delegates){const z=v.delegates[T];v.delegates[T]=(...O)=>{this._removeDelegatedListener(E,g,h),z(...O)}}this._saveDelegatedListener(E,v);for(const T in v.delegates)this.once(T,v.delegates[T]);return this}off(E,i,h){return h===void 0?super.off(E,i):(this._removeDelegatedListener(E,typeof i=="string"?[i]:i,h),this)}queryRenderedFeatures(E,i){if(!this.style)return[];let h;const g=E instanceof d.P||Array.isArray(E),v=g?E:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(g?{}:E)||{},v instanceof d.P||typeof v[0]=="number")h=[d.P.convert(v)];else{const T=d.P.convert(v[0]),z=d.P.convert(v[1]);h=[T,new d.P(z.x,T.y),z,new d.P(T.x,z.y),T]}return this.style.queryRenderedFeatures(h,i,this.transform)}querySourceFeatures(E,i){return this.style.querySourceFeatures(E,i)}setStyle(E,i){return(i=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&E?(this._diffStyle(E,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(E,i))}setTransformRequest(E){return this._requestManager.setTransformRequest(E),this}_getUIString(E){const i=this._locale[E];if(i==null)throw new Error(`Missing UI string '${E}'`);return i}_updateStyle(E,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(E,i)));const h=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!E)),E?(this.style=new Wo(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof E=="string"?this.style.loadURL(E,i,h):this.style.loadJSON(E,i,h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Wo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(E,i){if(typeof E=="string"){const h=this._requestManager.transformRequest(E,"Style");d.h(h,new AbortController).then((g=>{this._updateDiff(g.data,i)})).catch((g=>{g&&this.fire(new d.j(g))}))}else typeof E=="object"&&this._updateDiff(E,i)}_updateDiff(E,i){try{this.style.setState(E,i)&&this._update(!0)}catch(h){d.w(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(E,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(E,i){return this._lazyInitEmptyStyle(),this.style.addSource(E,i),this._update(!0)}isSourceLoaded(E){const i=this.style&&this.style.sourceCaches[E];if(i!==void 0)return i.loaded();this.fire(new d.j(new Error(`There is no source with ID '${E}'`)))}setTerrain(E){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),E){const i=this.style.sourceCaches[E.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${E.source}`);this.terrain===null&&i.reload();for(const h in this.style._layers){const g=this.style._layers[h];g.type==="hillshade"&&g.source===E.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new gl(this.painter,i,E),this.painter.renderToTexture=new Va(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=h=>{h.dataType==="style"?this.terrain.sourceCache.freeRtt():h.dataType==="source"&&h.tile&&(h.sourceId!==E.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(h.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new d.k("terrain",{terrain:E})),this}getTerrain(){var E,i;return(i=(E=this.terrain)===null||E===void 0?void 0:E.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const E=this.style&&this.style.sourceCaches;for(const i in E){const h=E[i]._tiles;for(const g in h){const v=h[g];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(E){return this.style.removeSource(E),this._update(!0)}getSource(E){return this.style.getSource(E)}addImage(E,i,h={}){const{pixelRatio:g=1,sdf:v=!1,stretchX:T,stretchY:z,content:O,textFitWidth:U,textFitHeight:H}=h;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||d.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Y,height:X,data:oe}=i,fe=i;return this.style.addImage(E,{data:new d.R({width:Y,height:X},new Uint8Array(oe)),pixelRatio:g,stretchX:T,stretchY:z,content:O,textFitWidth:U,textFitHeight:H,sdf:v,version:0,userImage:fe}),fe.onAdd&&fe.onAdd(this,E),this}}{const{width:Y,height:X,data:oe}=N.getImageData(i);this.style.addImage(E,{data:new d.R({width:Y,height:X},oe),pixelRatio:g,stretchX:T,stretchY:z,content:O,textFitWidth:U,textFitHeight:H,sdf:v,version:0})}}updateImage(E,i){const h=this.style.getImage(E);if(!h)return this.fire(new d.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=i instanceof HTMLImageElement||d.b(i)?N.getImageData(i):i,{width:v,height:T,data:z}=g;if(v===void 0||T===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==h.data.width||T!==h.data.height)return this.fire(new d.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const O=!(i instanceof HTMLImageElement||d.b(i));return h.data.replace(z,O),this.style.updateImage(E,h),this}getImage(E){return this.style.getImage(E)}hasImage(E){return E?!!this.style.getImage(E):(this.fire(new d.j(new Error("Missing required image id"))),!1)}removeImage(E){this.style.removeImage(E)}loadImage(E){return ae.getImage(this._requestManager.transformRequest(E,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(E,i){return this._lazyInitEmptyStyle(),this.style.addLayer(E,i),this._update(!0)}moveLayer(E,i){return this.style.moveLayer(E,i),this._update(!0)}removeLayer(E){return this.style.removeLayer(E),this._update(!0)}getLayer(E){return this.style.getLayer(E)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(E,i,h){return this.style.setLayerZoomRange(E,i,h),this._update(!0)}setFilter(E,i,h={}){return this.style.setFilter(E,i,h),this._update(!0)}getFilter(E){return this.style.getFilter(E)}setPaintProperty(E,i,h,g={}){return this.style.setPaintProperty(E,i,h,g),this._update(!0)}getPaintProperty(E,i){return this.style.getPaintProperty(E,i)}setLayoutProperty(E,i,h,g={}){return this.style.setLayoutProperty(E,i,h,g),this._update(!0)}getLayoutProperty(E,i){return this.style.getLayoutProperty(E,i)}setGlyphs(E,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(E,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(E,i,h={}){return this._lazyInitEmptyStyle(),this.style.addSprite(E,i,h,(g=>{g||this._update(!0)})),this}removeSprite(E){return this._lazyInitEmptyStyle(),this.style.removeSprite(E),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(E,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(E,i,(h=>{h||this._update(!0)})),this}setLight(E,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(E,i),this._update(!0)}getLight(){return this.style.getLight()}setSky(E){return this._lazyInitEmptyStyle(),this.style.setSky(E),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(E,i){return this.style.setFeatureState(E,i),this._update()}removeFeatureState(E,i){return this.style.removeFeatureState(E,i),this._update()}getFeatureState(E){return this.style.getFeatureState(E)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let E=0,i=0;return this._container&&(E=this._container.clientWidth||400,i=this._container.clientHeight||300),[E,i]}_setupContainer(){const E=this._container;E.classList.add("maplibregl-map");const i=this._canvasContainer=V.create("div","maplibregl-canvas-container",E);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const h=this._containerDimensions(),g=this._getClampedPixelRatio(h[0],h[1]);this._resizeCanvas(h[0],h[1],g);const v=this._controlContainer=V.create("div","maplibregl-control-container",E),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((z=>{T[z]=V.create("div",`maplibregl-ctrl-${z} `,v)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(E,i,h){this._canvas.width=Math.floor(h*E),this._canvas.height=Math.floor(h*i),this._canvas.style.width=`${E}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const E={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let i=null;this._canvas.addEventListener("webglcontextcreationerror",(g=>{i={requestedAttributes:E},g&&(i.statusMessage=g.statusMessage,i.type=g.type)}),{once:!0});const h=this._canvas.getContext("webgl2",E)||this._canvas.getContext("webgl",E);if(!h){const g="Failed to initialize WebGL";throw i?(i.message=g,new Error(JSON.stringify(i))):new Error(g)}this.painter=new fo(h,this.transform),K.testSupport(h)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(E){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||E,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(E){return this._update(),this._renderTaskQueue.add(E)}_cancelRenderFrame(E){this._renderTaskQueue.remove(E)}_render(E){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(E),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,T=N.now();this.style.zoomHistory.update(v,T);const z=new d.z(v,{now:T,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),O=z.crossFadingFactor();O===1&&O===this._crossFadingFactor||(h=!0,this._crossFadingFactor=O),this.style.update(z)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new d.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.bf.mark(d.bg.load),this.fire(new d.k("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.k("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,d.bf.mark(d.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var E;this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ae.removeThrottleControl(this._imageQueueHandle),(E=this._resizeObserver)===null||E===void 0||E.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i?.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),d.bf.clearMetrics(),this._removed=!0,this.fire(new d.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then((E=>{d.bf.frame(E),this._frameRequest=null,this._render(E)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(E){this._showTileBoundaries!==E&&(this._showTileBoundaries=E,this._update())}get showPadding(){return!!this._showPadding}set showPadding(E){this._showPadding!==E&&(this._showPadding=E,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(E){this._showCollisionBoxes!==E&&(this._showCollisionBoxes=E,E?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(E){this._showOverdrawInspector!==E&&(this._showOverdrawInspector=E,this._update())}get repaint(){return!!this._repaint}set repaint(E){this._repaint!==E&&(this._repaint=E,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(E){this._vertices=E,this._update()}get version(){return No}getCameraTargetElevation(){return this.transform.elevation}},y.MapMouseEvent=Wn,y.MapTouchEvent=Ea,y.MapWheelEvent=qr,y.Marker=lh,y.NavigationControl=class{constructor(E){this._updateZoomButtons=()=>{const i=this._map.getZoom(),h=i===this._map.getMaxZoom(),g=i===this._map.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,h)=>{const g=this._map._getUIString(`NavigationControl.${h}`);i.title=g,i.setAttribute("aria-label",g)},this.options=d.e({},qc,E),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(i=>this._map.zoomIn({},{originalEvent:i}))),V.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(i=>this._map.zoomOut({},{originalEvent:i}))),V.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})})),this._compassIcon=V.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new oh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(E,i){const h=V.create("button",E,this._container);return h.type="button",h.addEventListener("click",i),h}},y.Popup=class extends d.E{constructor(E){super(),this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.k("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{var h;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create("div","maplibregl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const O of this.options.className.split(" "))this._container.classList.add(O);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?nn(this._lngLat,this._flatPos,this._map.transform):(h=this._lngLat)===null||h===void 0?void 0:h.wrap(),this._trackPointer&&!i)return;const g=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationPoint(this._lngLat));let v=this.options.anchor;const T=xl(this.options.offset);if(!v){const O=this._container.offsetWidth,U=this._container.offsetHeight;let H;H=g.y+T.bottom.y<U?["top"]:g.y>this._map.transform.height-U?["bottom"]:[],g.x<O/2?H.push("left"):g.x>this._map.transform.width-O/2&&H.push("right"),v=H.length===0?"bottom":H.join("-")}let z=g.add(T[v]);this.options.subpixelPositioning||(z=z.round()),V.setTransform(this._container,`${yl[v]} translate(${z.x}px,${z.y}px)`),Au(this._container,v,"popup")},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(Ti),E)}addTo(E){return this._map&&this.remove(),this._map=E,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(E){return this._lngLat=d.N.convert(E),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(E){return this.setDOMContent(document.createTextNode(E))}setHTML(E){const i=document.createDocumentFragment(),h=document.createElement("body");let g;for(h.innerHTML=E;g=h.firstChild,g;)i.appendChild(g);return this.setDOMContent(i)}getMaxWidth(){var E;return(E=this._container)===null||E===void 0?void 0:E.style.maxWidth}setMaxWidth(E){return this.options.maxWidth=E,this._update(),this}setDOMContent(E){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(E),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(E){return this._container&&this._container.classList.add(E),this}removeClassName(E){return this._container&&this._container.classList.remove(E),this}setOffset(E){return this.options.offset=E,this._update(),this}toggleClassName(E){if(this._container)return this._container.classList.toggle(E)}setSubpixelPositioning(E){this.options.subpixelPositioning=E}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const E=this._container.querySelector(vl);E&&E.focus()}},y.RasterDEMTileSource=yi,y.RasterTileSource=ki,y.ScaleControl=class{constructor(E){this._onMove=()=>{_l(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,_l(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},qa),E)}getDefaultPosition(){return"bottom-left"}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=wt,y.Style=Wo,y.TerrainControl=class{constructor(E){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=E}onAdd(E){return this._map=E,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=Z,y.TwoFingersTouchRotateHandler=M,y.TwoFingersTouchZoomHandler=u,y.TwoFingersTouchZoomRotateHandler=wr,y.VectorTileSource=Pn,y.VideoSource=an,y.addSourceType=(E,i)=>d._(void 0,void 0,void 0,(function*(){if(Fn(E))throw new Error(`A source type called "${E}" already exists.`);((h,g)=>{qi[h]=g})(E,i)})),y.clearPrewarmedResources=function(){const E=Ot;E&&(E.isPreloaded()&&E.numActive()===1?(E.release(at),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return An().getRTLTextPluginStatus()},y.getVersion=function(){return td},y.getWorkerCount=function(){return mt.workerCount},y.getWorkerUrl=function(){return d.a.WORKER_URL},y.importScriptInWorkers=function(E){return gi().broadcast("IS",E)},y.prewarm=function(){_i().acquire(at)},y.setMaxParallelImageRequests=function(E){d.a.MAX_PARALLEL_IMAGE_REQUESTS=E},y.setRTLTextPlugin=function(E,i){return An().setRTLTextPlugin(E,i)},y.setWorkerCount=function(E){mt.workerCount=E},y.setWorkerUrl=function(E){d.a.WORKER_URL=E}}));var _=r;return _}))})(Py)),Py.exports}var Kz=l2();const uw=Kh(Kz);var Iy={exports:{}},Jz=Iy.exports,hw;function Qz(){return hw||(hw=1,(function(t,e){(function(r,l){t.exports=l(i2(),l2())})(typeof globalThis<"u"?globalThis:Jz||self,function(r,l){r.MaplibreGL=r.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(f){r.setOptions(this,f),this._throttledUpdate=r.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(f){this._container||this._initContainer();var _=this.getPaneName();f.getPane(_).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),f.options.zoomAnimation&&r.DomEvent.on(f._proxy,r.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(f){this._map._proxy&&this._map.options.zoomAnimation&&r.DomEvent.off(this._map._proxy,r.DomUtil.TRANSITION_END,this._transitionEnd,this);var _=this.getPaneName();f.getPane(_).removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getAttribution:function(){if(this.options.attributionControl)return this.options.attributionControl.customAttribution;var f=this._glMap;if(f&&this.options.attributionControl!==!1){var _=f.getStyle();if(_&&_.sources)return Object.keys(_.sources).map(function(y){var d=f.getSource(y);return d&&typeof d.attribution=="string"?d.attribution.trim():null}).filter(Boolean).join(", ")}return""},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){var f=this.getSize().multiplyBy(.5),_=this._map.latLngToContainerPoint(this._map.getCenter());return r.latLngBounds(this._map.containerPointToLatLng(_.subtract(f)),this._map.containerPointToLatLng(_.add(f)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_roundPoint:function(f){return{x:Math.round(f.x),y:Math.round(f.y)}},_initContainer:function(){var f=this._container=r.DomUtil.create("div","leaflet-gl-layer");this._resizeContainer();var _=this._map.getSize().multiplyBy(this.options.padding),y=this._map.containerPointToLayerPoint([0,0]).subtract(_);r.DomUtil.setPosition(f,this._roundPoint(y))},_resizeContainer:function(){var f=this.getSize();this._container.style.width=f.x+"px",this._container.style.height=f.y+"px"},_initGL:function(){var f=this._map.getCenter(),_=r.extend({},this.options,{container:this._container,center:[f.lng,f.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new l.Map(_);var y=this._map,d=this.getAttribution(),A=this.getAttribution.bind(this);this._glMap.on("load",function(){y&&y.attributionControl&&(y.attributionControl.removeAttribution(d),y.attributionControl.addAttribution(A()))});var I=Object.getPrototypeOf(this._glMap.transform),B=Object.getOwnPropertyDescriptor(I,"latRange");(!B||B.set||B.writable)&&(this._glMap.transform.latRange=null);var N=Object.getOwnPropertyDescriptor(I,"maxValidLatitude");(!N||N.set||N.writable)&&(this._glMap.transform.maxValidLatitude=1/0),this._glMap.transform._helper&&this._glMap.transform._helper._latRange&&(this._glMap.transform._helper._latRange=[-1/0,1/0]),this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;var V=this._glMap._actualCanvas;r.DomUtil.addClass(V,"leaflet-image-layer"),r.DomUtil.addClass(V,"leaflet-zoom-animated"),this.options.interactive&&r.DomUtil.addClass(V,"leaflet-interactive"),this.options.className&&r.DomUtil.addClass(V,this.options.className)},_update:function(f){if(this._map&&(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming)){var _=this._container,y=this._glMap,d=this._map.getSize().multiplyBy(this.options.padding),A=this._map.containerPointToLayerPoint([0,0]).subtract(d);r.DomUtil.setPosition(_,this._roundPoint(A)),this._transformGL(y)}},_transformGL:function(f){var _=this._map.getCenter(),y=f._getTransformForUpdate();y.setCenter?(y.setCenter(l.LngLat.convert([_.lng,_.lat])),y.setZoom(this._map.getZoom()-1),f.transform.apply(y)):(y=f.transform,y.center=l.LngLat.convert([_.lng,_.lat]),y.zoom=this._map.getZoom()-1),f._fireMoveEvents()},_pinchZoom:function(f){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(f){var _=this._map.getZoomScale(f.zoom),y=this._map.getSize().multiplyBy(this.options.padding*_),d=this.getSize()._divideBy(2),A=this._map.project(f.center,f.zoom)._subtract(d)._add(this._map._getMapPanePos().add(y))._round(),I=this._map.project(this._map.getBounds().getNorthWest(),f.zoom)._subtract(A);r.DomUtil.setTransform(this._glMap._actualCanvas,I.subtract(this._offset),_)},_zoomStart:function(f){this._zooming=!0},_zoomEnd:function(){var f=this._map.getZoomScale(this._map.getZoom());r.DomUtil.setTransform(this._glMap._actualCanvas,null,f),this._zooming=!1,this._update()},_transitionEnd:function(f){r.Util.requestAnimFrame(function(){var _=this._map.getZoom(),y=this._map.getCenter(),d=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());this._resizeContainer(),r.DomUtil.setTransform(this._glMap._actualCanvas,d,1),this._glMap.once("moveend",r.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:y,zoom:_-1})},this)},_resize:function(f){this._transitionEnd(f)}}),r.maplibreGL=function(f){return new r.MaplibreGL(f)}})})(Iy)),Iy.exports}Qz();const eR={},tR=eR?.VITE_MAP_STYLE_URL||"https://tiles.openfreemap.org/styles/liberty/style.json",iR="Leaflet | OpenFreeMap  OpenMapTiles Data from OpenStreetMap",nR="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",sR="&copy; OpenStreetMap contributors",c2=({styleUrl:t,attribution:e})=>{const r=gp();return te.useEffect(()=>{const l=Xh.maplibreGL;window.maplibregl=uw;let f=null,_=null,y=null;const d=()=>{_&&(r.removeLayer(_),_=null),!f&&(f=Xh.tileLayer(nR,{attribution:sR}),f.addTo(r))};if(!l){console.warn("MapLibre GL Leaflet plugin is not available."),d();return}let A=null;try{_=l({style:t||tR,attribution:e||iR,maplibreGL:uw}),_.addTo(r),y=_.getMapboxMap?.()||_.getMaplibreMap?.(),y&&(r._maplibreMap=y),A=()=>y?.resize?.(),y?.on&&(y.on("error",d),y.on("load",A))}catch(I){console.warn("MapLibre GL failed, falling back to raster.",I),d()}return()=>{y?.off&&(y.off("error",d),A&&y.off("load",A)),_&&r.removeLayer(_),f&&r.removeLayer(f)}},[r,t,e]),null},xy=t=>{if(typeof t=="string"){const e=Number(t);return Number.isNaN(e)?null:e}return t},dw=(t,e,r,l=!1)=>{const f=r?encodeURI(r).replace(/'/g,"%27"):"",_=r?`<div class="map-pin-avatar" style="background-image:url('${f}')"></div>`:'<div class="map-pin-avatar map-pin-avatar--empty"></div>',y=`
    <div class="map-pin map-pin--${t} ${l?"map-pin--active":""}" style="pointer-events:auto;">
      ${_}
      <span class="map-pin-label">${e}</span>
    </div>
  `;return Xh.divIcon({className:"leaflet-div-icon leaflet-interactive map-pin-wrapper",html:y,iconSize:l?[56,64]:[52,60],iconAnchor:[26,60],popupAnchor:[0,-54]})},rR=t=>t.event_artists?.find(e=>e.artist?.avatar_url)?.artist?.avatar_url||null,aR=({events:t,venues:e,showVenues:r,onSelectEvent:l,onSelectVenue:f,activeSelection:_})=>S.jsxs(S.Fragment,{children:[t.map(y=>{const d=xy(y.latitude??y.venue_place?.latitude??null),A=xy(y.longitude??y.venue_place?.longitude??null);if(d===null||A===null)return null;const I=rR(y),B=y.is_free!==!1,N=B?"GRATIS":"PAGO",V=_?.type==="event"&&_.id===y.id,K=dw(B?"free":"paid",N,I,V);return S.jsx(i_,{position:[d,A],icon:K,pane:"markerPane",interactive:!0,bubblingMouseEvents:!1,zIndexOffset:V?200:0,eventHandlers:{click:()=>l(y.id)}},y.id)}),r&&e.map(y=>{const d=xy(y.latitude??null),A=xy(y.longitude??null);if(d===null||A===null)return null;const I=y.photos?.[0]||null,B=_?.type==="venue"&&_.id===y.id,N=dw("venue","SALA",I,B);return S.jsx(i_,{position:[d,A],icon:N,pane:"markerPane",interactive:!0,bubblingMouseEvents:!1,zIndexOffset:B?200:0,eventHandlers:{click:()=>f(y.id)}},y.id)})]}),oR=({filterToday:t,filterTomorrow:e,filterFree:r,showEvents:l,onToggleToday:f,onToggleTomorrow:_,onToggleFree:y,onToggleEvents:d,onOpenFilters:A})=>{const I="inline-flex items-center justify-center whitespace-nowrap rounded-xl bg-white/15 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] transition-colors hover:bg-white/20",B="text-white/85",N="bg-white/20 text-app-accent";return S.jsxs("div",{className:"flex flex-wrap gap-2 overflow-x-auto pb-1",children:[S.jsx("button",{type:"button",className:`${I} ${l?N:B}`,onClick:d,children:"Events"}),S.jsx("button",{type:"button",className:`${I} ${t?N:B}`,onClick:f,children:"Today"}),S.jsx("button",{type:"button",className:`${I} ${e?N:B}`,onClick:_,children:"Tomorrow"}),S.jsx("button",{type:"button",className:`${I} ${r?N:B}`,onClick:y,children:"Free"}),S.jsx("button",{type:"button",className:`${I} ${B}`,onClick:A,children:"Filters"})]})},lR=({isOpen:t,onDismiss:e,filterGenres:r,onGenresChange:l,priceMin:f,priceMax:_,onPriceMinChange:y,onPriceMaxChange:d,filterDayPart:A,onDayPartChange:I,filterBandOnly:B,onToggleBand:N,selectedArtists:V,onAddArtist:K,onRemoveArtist:ie,autoFocusArtist:ne=!1,filterGoing:ve,filterAttended:se,onToggleGoing:ge,onToggleAttended:ae,onClear:me,disableAttendance:ye,filterDate:Se,onDateChange:ze,showVenues:He,onToggleVenues:Ze})=>{const[st,lt]=Nt.useState(""),[Ke,Mt]=Nt.useState([]),[gt,St]=Nt.useState(!1),Be=Nt.useRef(null);Nt.useEffect(()=>{t&&ne&&Be.current&&Be.current.focus()},[t,ne]);const ot=async()=>{const Fe=st.trim();if(!Fe){Mt([]);return}try{St(!0);const{data:kt}=await Rt.from("artists").select("id, name, avatar_url, artist_type").ilike("name",`%${Fe}%`).order("name",{ascending:!0}).limit(6);Mt((kt||[]).map(rt=>({id:rt.id,name:rt.name,avatar_url:rt.avatar_url??null})))}finally{St(!1)}};return Nt.useEffect(()=>{if(!st.trim()){Mt([]);return}const Fe=window.setTimeout(()=>ot(),350);return()=>window.clearTimeout(Fe)},[st]),S.jsx($m,{isOpen:t,onDidDismiss:e,children:S.jsx(Pl,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Filters"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:e,children:"Close"})]}),S.jsxs("div",{className:"mt-6 space-y-6",children:[S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Show"}),S.jsxs("label",{className:"flex items-center justify-between gap-3 text-sm text-white/80",children:[S.jsx("span",{className:"flex items-center gap-2",children:"Venues"}),S.jsxs("span",{className:"relative inline-flex h-6 w-11 items-center",children:[S.jsx("input",{type:"checkbox",className:"peer sr-only",checked:He,onChange:Fe=>Ze(Fe.target.checked)}),S.jsx("span",{className:"h-full w-full rounded-full bg-white/10 transition peer-checked:bg-[#ff6b4a]/80"}),S.jsx("span",{className:"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]})]})]}),S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"When"}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsx("button",{type:"button",className:`bg-white/10 px-3 py-2 text-sm font-semibold ${A==="day"?"text-app-accent":"text-white/75"}`,onClick:()=>I(A==="day"?"":"day"),children:"Day"}),S.jsx("button",{type:"button",className:`bg-white/10 px-3 py-2 text-sm font-semibold ${A==="night"?"text-app-accent":"text-white/75"}`,onClick:()=>I(A==="night"?"":"night"),children:"Night"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsxs("label",{className:"flex items-center gap-2 text-sm text-white/80",children:[S.jsx("input",{type:"checkbox",checked:ve,onChange:Fe=>ge(Fe.target.checked),disabled:ye,className:"accent-[#ff6b4a]"}),S.jsx("span",{children:"Going"})]}),S.jsxs("label",{className:"flex items-center gap-2 text-sm text-white/80",children:[S.jsx("input",{type:"checkbox",checked:se,onChange:Fe=>ae(Fe.target.checked),disabled:ye,className:"accent-[#ff6b4a]"}),S.jsx("span",{children:"Attended"})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Specific date"}),S.jsx("input",{type:"date",value:Se,onChange:Fe=>ze(Fe.target.value),className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none"})]})]}),S.jsxs("div",{className:"space-y-4 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Lineup"}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Genres (comma)"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:r,onChange:Fe=>l(Fe.target.value),placeholder:"Jazz, Rock"})]}),S.jsxs("label",{className:"flex items-center justify-between gap-3 text-sm text-white/80",children:[S.jsx("span",{className:"flex items-center gap-2",children:"Band only"}),S.jsxs("span",{className:"relative inline-flex h-6 w-11 items-center",children:[S.jsx("input",{type:"checkbox",className:"peer sr-only",checked:B,onChange:Fe=>N(Fe.target.checked)}),S.jsx("span",{className:"h-full w-full rounded-full bg-white/10 transition peer-checked:bg-[#ff6b4a]/80"}),S.jsx("span",{className:"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("input",{className:"flex-1 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/40 focus:outline-none",value:st,onChange:Fe=>lt(Fe.target.value),ref:Be,placeholder:"Search artist",onKeyDown:Fe=>{Fe.key==="Enter"&&(Fe.preventDefault(),ot())}}),S.jsx("button",{type:"button",className:"bg-white/10 px-3 py-2 text-xs font-semibold uppercase tracking-[0.22em] text-white",onClick:ot,disabled:gt,children:gt?"Searching":"Search"})]}),Ke.length>0&&S.jsxs("div",{className:"bg-white/5 p-3 text-sm text-white",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Results"}),S.jsx("div",{className:"mt-2 space-y-2",children:Ke.map(Fe=>S.jsxs("button",{type:"button",className:"flex w-full items-center gap-3 bg-white/5 px-3 py-2 text-left hover:bg-white/10",onClick:()=>{K(Fe),lt(""),Mt([])},children:[S.jsx("div",{className:"h-8 w-8 overflow-hidden rounded-full bg-white/10",children:Fe.avatar_url?S.jsx("img",{src:Fe.avatar_url,alt:Fe.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-full w-full items-center justify-center text-[10px] text-white/60",children:"A"})}),S.jsx("span",{children:Fe.name})]},Fe.id))})]}),V.length>0&&S.jsxs("div",{className:"bg-white/5 p-3 text-sm text-white",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Active"}),S.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:V.map(Fe=>S.jsxs("span",{className:"inline-flex items-center gap-2 bg-white/10 px-3 py-1 text-xs",children:[Fe.name,S.jsx("button",{type:"button",className:"text-white/70 hover:text-white",onClick:()=>ie(Fe.id),children:""})]},Fe.id))})]})]})]}),S.jsxs("div",{className:"space-y-3 bg-white/5 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65",children:"Price"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Min"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:f,onChange:Fe=>y(Fe.target.value),placeholder:"0"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Max"}),S.jsx("input",{className:"w-full bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none",value:_,onChange:Fe=>d(Fe.target.value),placeholder:"50"})]})]})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:me,children:"Clear filters"})]})]})})})},cR=({activeItem:t,events:e,venues:r,onTouchStart:l,onTouchEnd:f})=>{const _=QM();if(!t)return null;const y=()=>{if(t.type==="event"){const A=e.find(B=>B.id===t.id);if(!A)return null;const I=(A.event_artists||[]).map(B=>B.artist?.name).filter(Boolean).join(", ");return S.jsxs("div",{className:"flex gap-4",children:[S.jsxs("div",{className:"relative flex-shrink-0",children:[A.cover_image_url?S.jsx("img",{src:A.cover_image_url,alt:A.name,className:"h-80 w-48 rounded-xl object-cover"}):S.jsx("div",{className:"h-80 w-48 rounded-xl bg-white/10"}),S.jsxs("div",{className:"absolute left-2 top-2 flex gap-2",children:[S.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-black/40 text-white backdrop-blur-sm transition hover:bg-black/60","aria-label":"Like",children:S.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),S.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-black/40 text-white backdrop-blur-sm transition hover:bg-black/60","aria-label":"Going",children:S.jsxs("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),S.jsxs("div",{className:"flex min-w-0 flex-1 flex-col justify-center cursor-pointer transition-opacity hover:opacity-80",onClick:()=>_.push(`/event/${A.id}`,"forward"),children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Event"}),S.jsx("h3",{className:"mt-2 font-display text-2xl font-bold text-white leading-tight",children:A.name}),A.venue_place?.name&&S.jsx("p",{className:"mt-1 text-sm font-medium text-white/80",children:A.venue_place.name}),S.jsx("p",{className:"mt-1 text-sm text-white/70",children:A.venue_place?.city||A.city}),I&&S.jsx("p",{className:"mt-2 text-sm text-white/55",children:I}),S.jsx("p",{className:"mt-3 text-sm text-white/55",children:new Date(A.starts_at).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),S.jsx("p",{className:"mt-2 text-xs font-medium text-white/40",children:"Tap to view event details"})]})]})}const d=r.find(A=>A.id===t.id);return d?S.jsxs("div",{className:"cursor-pointer transition-opacity hover:opacity-80",onClick:()=>_.push(`/venue/${d.id}`,"forward"),children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venue"}),S.jsx("h3",{className:"mt-2 font-display text-xl font-bold text-white",children:d.name}),S.jsx("p",{className:"text-sm text-white/70",children:d.city}),S.jsx("p",{className:"mt-2 text-xs font-medium text-white/40",children:"Tap to view venue details"})]}):null};return S.jsxs("div",{className:"fixed inset-x-0 bottom-0 z-[1100] max-h-[60vh] rounded-t-3xl bg-black/92 p-4",onTouchStart:l,onTouchEnd:f,children:[S.jsx("div",{className:"mb-3 flex items-center justify-center",children:S.jsx("div",{className:"h-1 w-12 rounded-full bg-white/20"})}),y()]})},uR=({events:t,venues:e,userId:r})=>{const[l,f]=te.useState(""),[_,y]=te.useState(!0),[d,A]=te.useState(!1),[I,B]=te.useState(!0),[N,V]=te.useState(!0),[K,ie]=te.useState(!1),[ne,ve]=te.useState(!1),[se,ge]=te.useState(""),[ae,me]=te.useState(!1),[ye,Se]=te.useState(!1),[ze,He]=te.useState(""),[Ze,st]=te.useState(""),[lt,Ke]=te.useState(""),[Mt,gt]=te.useState(""),[St,Be]=te.useState(!1),[ot,Fe]=te.useState([]),[kt,rt]=te.useState(!1),[be,Ie]=te.useState(!1),[et,at]=te.useState({});te.useEffect(()=>{if(!r||!kt&&!be){at({});return}(async()=>{const{data:Oi}=await Rt.from("event_attendance").select("event_id, status").eq("user_id",r),xn={};(Oi||[]).forEach(cn=>{cn?.event_id&&cn?.status&&(xn[cn.event_id]=cn.status)}),at(xn)})()},[r,kt,be]);const mt=te.useMemo(()=>{if(!_)return[];const gi=l.trim().toLowerCase(),Oi=new Date,xn=new Date(Oi);xn.setHours(0,0,0,0);const cn=new Date(Oi);cn.setHours(23,59,59,999);const Zn=new Date(xn);Zn.setDate(Zn.getDate()+1);const tt=new Date(Zn);tt.setHours(23,59,59,999);const Xn=ze.split(",").map(yi=>yi.trim().toLowerCase()).filter(Boolean),Pn=Ze.trim()?Number(Ze):null,ki=lt.trim()?Number(lt):null;return t.filter(yi=>{if(gi&&!(yi.name.toLowerCase().includes(gi)||yi.city.toLowerCase().includes(gi)||yi.venue_place?.name?.toLowerCase().includes(gi)||yi.venue_place?.city?.toLowerCase().includes(gi)||yi.address?.toLowerCase().includes(gi)))return!1;const Cn=new Date(yi.starts_at),Ln=yi.ends_at?new Date(yi.ends_at):null,an=(Ln??Cn)<Oi;if(!I&&!N||I!==N&&(N&&!an||I&&an)||K&&(Cn<xn||Cn>cn)||ne&&(Cn<Zn||Cn>tt))return!1;if(se){const en=new Date(`${se}T00:00:00`),qi=new Date(en);if(qi.setHours(23,59,59,999),Cn<en||Cn>qi)return!1}if(ae&&(Cn>Oi||Ln&&Ln<Oi)||ye&&yi.is_free===!1)return!1;if(Mt){const en=Cn.getHours(),qi=en>=6&&en<18;if(Mt==="day"&&!qi||Mt==="night"&&qi)return!1}if(St&&!(Array.isArray(yi.event_artists)&&yi.event_artists.some(qi=>qi?.artist?.artist_type==="band"))||ot.length>0&&!(Array.isArray(yi.event_artists)&&yi.event_artists.some(qi=>qi?.artist?.id&&ot.includes(qi.artist.id))))return!1;if(Xn.length>0){const en=(yi.genres||[]).map(qi=>qi.toLowerCase());if(!Xn.some(qi=>en.includes(qi)))return!1}if(Pn!==null||ki!==null){const qi=(yi.price_tiers||[]).map(dn=>Number(dn.price)).filter(dn=>Number.isFinite(dn)),Fn=yi.is_free!==!1,Tt=Fn?0:qi.length>0?Math.min(...qi):null,On=Fn?0:qi.length>0?Math.max(...qi):null;if(Tt===null||On===null||Pn!==null&&On<Pn||ki!==null&&Tt>ki)return!1}if(kt||be){const en=et[yi.id];return!!(kt&&en==="going"||be&&en==="attended")}return!0})},[t,l,I,N,K,ne,se,ae,ye,ze,Ze,lt,Mt,St,ot,kt,be,et,_]),Ct=te.useMemo(()=>{const gi=l.trim().toLowerCase();return gi?e.filter(Oi=>Oi.name.toLowerCase().includes(gi)||Oi.city.toLowerCase().includes(gi)||Oi.address?.toLowerCase().includes(gi)):e},[e,l]);return{search:l,setSearch:f,showEvents:_,setShowEvents:y,showVenues:d,setShowVenues:A,showUpcoming:I,setShowUpcoming:B,showPast:N,setShowPast:V,filterToday:K,filterTomorrow:ne,filterDate:se,filterNow:ae,filterFree:ye,filterGenres:ze,priceMin:Ze,priceMax:lt,filterDayPart:Mt,setFilterDayPart:gt,filterBandOnly:St,setFilterBandOnly:Be,selectedArtistIds:ot,setSelectedArtistIds:Fe,filterGoing:kt,filterAttended:be,toggleToday:()=>{ie(gi=>{const Oi=!gi;return Oi&&(ve(!1),ge("")),Oi})},toggleTomorrow:()=>{ve(gi=>{const Oi=!gi;return Oi&&(ie(!1),ge("")),Oi})},setFilterDate:gi=>{ge(gi),gi&&(ie(!1),ve(!1))},setFilterNow:me,setFilterFree:Se,setFilterGenres:He,setPriceMin:st,setPriceMax:Ke,setFilterGoing:rt,setFilterAttended:Ie,clearExtraFilters:()=>{He(""),st(""),Ke(""),gt(""),Be(!1),Fe([]),rt(!1),Ie(!1)},filteredEvents:mt,filteredVenues:Ct}},hR=[37.3891,-5.9845],dR=15,u2="live_space.map.view",fR=()=>{if(typeof window>"u")return null;try{const t=window.localStorage.getItem(u2);if(!t)return null;const e=JSON.parse(t);if(!e?.center||typeof e.zoom!="number")return null;const[r,l]=e.center;return!Number.isFinite(r)||!Number.isFinite(l)?null:{center:e.center,zoom:e.zoom}}catch{return null}},pR=(t,e)=>{if(!(typeof window>"u"))try{window.localStorage.setItem(u2,JSON.stringify({center:`${t[0]},${t[1]}`,zoom:e}))}catch{}},mR=()=>{pp();const{user:t}=ya(),[e,r]=te.useState([]),[l,f]=te.useState([]),[_,y]=te.useState([]),[d,A]=te.useState(!1),[I,B]=te.useState(null),[N,V]=te.useState([]),K=I!==null?N[I]:null,[ie,ne]=te.useState(hR),[ve,se]=te.useState(dR),[ge,ae]=te.useState(!1),[me,ye]=te.useState(!1),[Se,ze]=te.useState(null),He=te.useRef(null);te.useEffect(()=>{const Bt=()=>{He.current&&!Se&&(console.log("[Map] mapRef.current is now available, setting mapInstance"),ze(He.current))};Bt();const hi=setInterval(Bt,100);return setTimeout(()=>clearInterval(hi),5e3),()=>clearInterval(hi)},[Se]);const[Ze,st]=te.useState(!1),[lt,Ke]=te.useState(null),{search:Mt,setSearch:gt,showEvents:St,setShowEvents:Be,showVenues:ot,setShowVenues:Fe,showUpcoming:kt,setShowUpcoming:rt,showPast:be,setShowPast:Ie,filterToday:et,filterTomorrow:at,filterDate:mt,setFilterDate:Ct,filterNow:Ot,setFilterNow:Kt,filterFree:_i,setFilterFree:Vi,filterGenres:gi,setFilterGenres:Oi,priceMin:xn,setPriceMin:cn,priceMax:Zn,setPriceMax:tt,filterDayPart:Xn,setFilterDayPart:Pn,filterBandOnly:ki,setFilterBandOnly:yi,filterGoing:Cn,setFilterGoing:Ln,filterAttended:us,setFilterAttended:an,clearExtraFilters:en,setSelectedArtistIds:qi,filteredEvents:Fn,filteredVenues:Tt}=uR({events:e,venues:l,userId:t?.id});te.useEffect(()=>{Xh.Icon.Default.mergeOptions({iconRetinaUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",import.meta.url).toString(),iconUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",import.meta.url).toString(),shadowUrl:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",import.meta.url).toString()})},[]);const On=te.useCallback(async()=>{const{data:Bt}=await Rt.from("events").select(`
        *,
        venue_place:venue_places(*),
        event_artists(artist:artists(*))
      `);r(Bt||[])},[]),dn=te.useCallback(async()=>{const{data:Bt}=await Rt.from("venue_places").select("id, name, city, address, latitude, longitude, photos, venue_type, capacity");f(Bt||[])},[]);te.useEffect(()=>{On(),dn()},[]),te.useEffect(()=>{e.length===0&&On()},[e.length,On]),te.useEffect(()=>{l.length===0&&dn()},[l.length,dn]),te.useEffect(()=>{const Bt=fR();Bt&&!ge&&(ne(Bt.center),se(Bt.zoom),ae(!0))},[ge]),te.useEffect(()=>{!navigator.geolocation||me||!ge||(ye(!0),navigator.geolocation.getCurrentPosition(Bt=>{ne([Bt.coords.latitude,Bt.coords.longitude])},()=>{},{enableHighAccuracy:!0,timeout:5e3}))},[ge,me]),te.useEffect(()=>{if(!Se)return;Se.invalidateSize();const Bt=()=>{const hi=Se.getCenter(),Ci=Se.getZoom(),bi=[hi.lat,hi.lng];ne(bi),se(Ci),pR(bi,Ci)};return Se.on("moveend",Bt),Se.on("zoomend",Bt),()=>{Se.off("moveend",Bt),Se.off("zoomend",Bt)}},[Se]),te.useEffect(()=>{if(!Se)return;const Bt=Se.getCenter(),hi=Se.getZoom(),[Ci,bi]=ie,xe=Math.abs(Bt.lat-Ci),ee=Math.abs(Bt.lng-bi);hi===ve&&xe<1e-7&&ee<1e-7||Se.setView(ie,ve,{animate:!0})},[ie,ve,Se]),SM(()=>{Se&&window.setTimeout(()=>{Se.invalidateSize()},150)}),te.useEffect(()=>{if(K&&Se){const Bt=An(K);if(Bt){const bi=Se.getSize().y*-.15,xe=Se.getZoom(),ee=Se.latLngToContainerPoint(Bt),Q=Xh.point(ee.x,ee.y-bi),ue=Se.containerPointToLatLng(Q);Se.setView(ue,xe,{animate:!0})}}},[K,Se]);const An=Bt=>{if(Bt.type==="event"){const hi=Fn.find(xe=>xe.id===Bt.id);if(!hi)return null;const Ci=Number(hi.latitude??hi.venue_place?.latitude??null),bi=Number(hi.longitude??hi.venue_place?.longitude??null);return Number.isNaN(Ci)||Number.isNaN(bi)?null:[Ci,bi]}else{const hi=Tt.find(xe=>xe.id===Bt.id);if(!hi)return null;const Ci=Number(hi.latitude??null),bi=Number(hi.longitude??null);return Number.isNaN(Ci)||Number.isNaN(bi)?null:[Ci,bi]}},Kn=Bt=>{if(!An(Bt))return;const Ci=[];St&&Fn.forEach(Q=>{An({type:"event",id:Q.id})&&Ci.push({type:"event",id:Q.id})}),ot&&Tt.forEach(Q=>{An({type:"venue",id:Q.id})&&Ci.push({type:"venue",id:Q.id})});const bi=Ci.findIndex(Q=>Q.type===Bt.type&&Q.id===Bt.id),xe=bi===-1?[...Ci,Bt]:Ci,ee=bi===-1?xe.length-1:bi;V(xe),B(ee)},It=Bt=>{if(I===null||N.length===0)return;let hi=I+Bt;hi<0&&(hi=N.length-1),hi>=N.length&&(hi=0),B(hi)},[ai,ti]=te.useState(null),[Ji,Nn]=te.useState(null),mi=()=>{y([]),qi([]),Fe(!0)};return S.jsxs(so,{children:[S.jsxs("div",{className:"relative flex min-h-full flex-col p-0",children:[S.jsx("div",{className:"pointer-events-auto absolute left-4 right-4 top-4 z-[1000]",children:S.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl bg-black/85 p-3",children:[S.jsx("input",{type:"search",placeholder:"Search shows",value:Mt,onChange:Bt=>gt(Bt.target.value),className:"w-full rounded-xl bg-white/15 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"}),S.jsx(oR,{showUpcoming:kt,showPast:be,filterToday:et,filterTomorrow:at,filterDate:mt,filterNow:Ot,filterFree:_i,showEvents:St,showVenues:ot,onToggleUpcoming:()=>rt(Bt=>!Bt),onTogglePast:()=>Ie(Bt=>!Bt),onToggleToday:()=>{},onToggleTomorrow:()=>{},onDateChange:Bt=>{Ct(Bt),Bt&&Kt(!1)},onToggleNow:()=>Kt(Bt=>!Bt),onToggleFree:()=>Vi(Bt=>!Bt),onToggleEvents:()=>Be(Bt=>!Bt),onToggleVenues:()=>Fe(Bt=>!Bt),onOpenArtistSearch:()=>{A(!0),st(!0)},onOpenFilters:()=>st(!0)}),_.length>0&&S.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-xl bg-white/10 px-3 py-2 text-xs text-white",children:[S.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.22em] text-white/60",children:"Artist"}),_.map(Bt=>S.jsxs("div",{className:"flex items-center gap-1 rounded-lg bg-white/15 px-2 py-1 text-xs font-medium text-white",children:[Bt.avatar_url&&S.jsx("img",{src:Bt.avatar_url,alt:Bt.name,className:"h-4 w-4 rounded-full object-cover"}),S.jsx("span",{children:Bt.name}),S.jsx("button",{type:"button",onClick:()=>{y(hi=>hi.filter(Ci=>Ci.id!==Bt.id)),qi(hi=>{const Ci=hi.filter(bi=>bi!==Bt.id);return Ci.length===0&&Fe(!0),Ci})},className:"ml-auto text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 transition hover:text-white",children:"Clear"})]},Bt.id)),S.jsx("button",{type:"button",onClick:mi,className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white",children:"Clear artist filter"})]})]})}),S.jsx("div",{className:"relative",children:S.jsxs(Xx,{center:ie,zoom:ve,style:{height:"calc(100vh - 60px)",width:"100%"},className:"rounded-none [&_.leaflet-container]:rounded-none [&_.leaflet-pane]:z-0 [&_.leaflet-marker-pane]:z-[500] [&_.leaflet-overlay-pane]:z-[400] [&_.leaflet-popup-pane]:z-[600]",zoomControl:!1,ref:He,whenReady:()=>{console.log("[Map] MapContainer whenReady triggered")},preferCanvas:!1,children:[S.jsx(c2,{}),S.jsx(Kx,{}),S.jsx(aR,{events:St?Fn:[],venues:Tt,showVenues:ot,onSelectEvent:Bt=>Kn({type:"event",id:Bt}),onSelectVenue:Bt=>Kn({type:"venue",id:Bt}),activeSelection:I!==null?N[I]:null})]})})]}),S.jsx(cR,{activeItem:K,events:Fn,venues:Tt,onTouchStart:Bt=>{ti(Bt.touches[0].clientX),Nn(Bt.touches[0].clientY)},onTouchEnd:Bt=>{if(ai===null||Ji===null)return;const hi=Bt.changedTouches[0].clientX-ai,Ci=Bt.changedTouches[0].clientY-Ji;Ci>100&&Math.abs(hi)<50?B(null):Math.abs(hi)>50&&Math.abs(Ci)<50&&It(hi<0?1:-1),ti(null),Nn(null)}}),S.jsx(lR,{isOpen:Ze,onDismiss:()=>{st(!1),A(!1)},filterGenres:gi,onGenresChange:Oi,priceMin:xn.toString(),onPriceMinChange:Bt=>cn(Number(Bt)||0),priceMax:Zn.toString(),onPriceMaxChange:Bt=>tt(Number(Bt)||100),filterDayPart:Xn||"",onDayPartChange:Pn,filterBandOnly:ki,onToggleBand:yi,filterGoing:Cn,onToggleGoing:Ln,filterAttended:us,onToggleAttended:an,disableAttendance:!1,selectedArtists:_,onAddArtist:Bt=>{y(hi=>[...hi,Bt]),qi(hi=>[...hi,Bt.id]),Fe(!1)},onRemoveArtist:Bt=>{y(hi=>hi.filter(Ci=>Ci.id!==Bt)),qi(hi=>{const Ci=hi.filter(bi=>bi!==Bt);return Ci.length===0&&Fe(!0),Ci})},filterDate:mt,onDateChange:Ct,showVenues:ot,onToggleVenues:Fe,onClear:()=>{en(),Ct(""),Kt(!1),Vi(!1),Oi(""),cn(0),tt(100),Pn(""),yi(!1),Ln(!1),an(!1)}})]})},gR=({value:t,placeholder:e,onChange:r,onClear:l})=>S.jsx("div",{className:"sticky top-0 z-20 -mx-4 bg-app-bg px-4 pb-3 pt-2",children:S.jsx("div",{className:"bg-white/5",children:S.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[S.jsx("input",{type:"search",value:t,placeholder:e||"Search artists or venues",onChange:f=>r(f.target.value),className:"w-full bg-transparent text-sm text-white placeholder:text-white/40 focus:outline-none"}),t.trim().length>0&&S.jsx("button",{type:"button",onClick:l,className:"shrink-0 px-2 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",children:"Clear"})]})})}),yR=({value:t,onChange:e})=>S.jsxs("div",{className:"flex items-center gap-6",children:[S.jsx("button",{type:"button",onClick:()=>e("artists"),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t==="artists"?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:"Artists"}),S.jsx("button",{type:"button",onClick:()=>e("venues"),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t==="venues"?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:"Venues"})]}),by=({title:t,description:e,actionLabel:r,onAction:l})=>S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"text-sm font-semibold text-white/90",children:t}),e&&S.jsx("p",{className:"mt-1 text-xs text-white/55",children:e}),r&&l&&S.jsx("button",{type:"button",className:"mt-4 bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:l,children:r})]}),_R=({rows:t=6})=>S.jsx("div",{className:"space-y-3",children:Array.from({length:t}).map((e,r)=>S.jsx("div",{className:"h-[74px] animate-pulse bg-white/5"},r))}),fw=({sections:t,renderItem:e})=>{const[r,l]=te.useState(!1),f=te.useMemo(()=>r?t:t.slice(0,2),[r,t]),_=Math.max(0,t.length-f.length);return S.jsxs("div",{className:"space-y-8",children:[f.map(y=>S.jsxs("section",{className:"space-y-3",children:[S.jsx("div",{className:"flex items-baseline justify-between gap-4",children:S.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:y.title})}),S.jsx("div",{className:"space-y-2",children:y.items.map(e)})]},y.key)),_>0&&S.jsxs("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",onClick:()=>l(!0),children:["Show ",_," more"]}),r&&t.length>2&&S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",onClick:()=>l(!1),children:"Show less"})]})},pw=({artist:t,isFollowing:e,followLoading:r,canFollow:l,onToggleFollow:f,onOpenProfile:_})=>S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:_,children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:t.avatar_url?S.jsx("img",{src:t.avatar_url,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:t.name}),S.jsx("p",{className:"mt-0.5 text-xs text-white/55 line-clamp-1",children:t.city||(t.genres?.length?t.genres.slice(0,2).join("  "):"Artist")})]})]}),S.jsx("button",{type:"button",disabled:!l||r,onClick:y=>{y.stopPropagation(),f()},className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${e?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:r?"Loading":e?"Following":"Follow"})]}),mw=({venue:t,isFollowing:e,followLoading:r,canFollow:l,onToggleFollow:f,onOpenProfile:_})=>{const y=t.photos?.[0]||null;return S.jsxs("div",{className:"flex items-center justify-between gap-4 py-2",children:[S.jsxs("button",{type:"button",className:"flex min-w-0 flex-1 items-center gap-3 text-left",onClick:_,children:[S.jsx("div",{className:"h-14 w-14 shrink-0 overflow-hidden bg-white/5",children:y?S.jsx("img",{src:y,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0",children:[S.jsx("p",{className:"font-display text-base font-bold text-white line-clamp-1",children:t.name}),S.jsx("p",{className:"mt-0.5 text-xs text-white/55 line-clamp-1",children:t.city})]})]}),S.jsx("button",{type:"button",disabled:!l||r,onClick:d=>{d.stopPropagation(),f()},className:`shrink-0 px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${e?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:r?"Loading":e?"Following":"Follow"})]})},vR=(t,e)=>{const[r,l]=te.useState(t);return te.useEffect(()=>{const f=window.setTimeout(()=>l(t),e);return()=>window.clearTimeout(f)},[e,t]),r},xR=async(t,e=20)=>{const r=t.trim();return r?mr(`discover:artists:search:${r}:${e}`,async()=>{const{data:l,error:f}=await Rt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres").or(`name.ilike.%${r}%,city.ilike.%${r}%`).limit(e);if(f)throw f;return(l||[]).map(_=>({id:_.artist_id,subject_id:_.subject_id,name:_.name,avatar_url:_.avatar_url,city:_.city,genres:_.genres||[]}))},{ttlMs:1e4}):[]},bR=async(t,e=20)=>{const r=t.trim();return r?mr(`discover:venues:search:${r}:${e}`,async()=>{const{data:l,error:f}=await Rt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity").or(`name.ilike.%${r}%,city.ilike.%${r}%`).limit(e);if(f)throw f;return(l||[]).map(_=>({id:_.venue_place_id,subject_id:_.subject_id,name:_.name,city:_.city,address:_.address,photos:_.photos||[],venue_type:_.venue_type??null,capacity:_.capacity??null}))},{ttlMs:1e4}):[]},h2=async(t,e)=>mr(`events:list:${t}:${e}`,async()=>{const{data:r,error:l}=await Rt.from("events").select(`
          id,
          name,
          city,
          address,
          latitude,
          longitude,
          starts_at,
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url,
              city,
              genres
            )
          )
        `).gte("starts_at",t).lte("starts_at",e).order("starts_at",{ascending:!0});if(l)throw l;return r||[]},{ttlMs:1e4}),d2=10,wR=50,SR=()=>{const t=new Date,e=new Date(t);e.setHours(0,0,0,0);const r=new Date(e);r.setDate(r.getDate()+14),r.setHours(23,59,59,999);const l=new Date(e);return l.setDate(l.getDate()+7),l.setHours(23,59,59,999),{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}},f2=t=>({id:t.artist_id,subject_id:t.subject_id,name:t.name,avatar_url:t.avatar_url,city:t.city,genres:t.genres||[]}),gw=async t=>{if(t.length===0)return[];const e=Array.from(new Set(t)).sort(),r=e.join(","),l=await mr(`artists:by_ids:${r}`,async()=>{const{data:_,error:y}=await Rt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres").in("artist_id",e);if(y)throw y;return _||[]},{ttlMs:6e4}),f=new Map;for(const _ of l)f.set(_.artist_id,_);return t.map(_=>f.get(_)).filter(Boolean).map(f2)},yw=t=>{const e=new Map;for(const r of t)for(const l of r.event_artists||[]){const f=l.artist?.id;f&&e.set(f,(e.get(f)||0)+1)}return Array.from(e.entries()).sort((r,l)=>l[1]-r[1]).slice(0,d2).map(([r])=>r)},TR=async t=>{const{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}=SR(),f=await h2(e.toISOString(),r.toISOString()),_=[];if(t?.location){const N=[];for(const ie of f){const ne=qh(ie.latitude??ie.venue_place?.latitude??null),ve=qh(ie.longitude??ie.venue_place?.longitude??null);ne===null||ve===null||qx(t.location.lat,t.location.lng,ne,ve)>wR||N.push(ie)}const V=yw(N),K=await gw(V);K.length>0&&_.push({key:"trending_near_you",title:"Trending near you",items:K})}const y=f.filter(N=>{const V=new Date(N.starts_at);return V>=e&&V<=l}),d=yw(y),A=await gw(d);A.length>0&&_.push({key:"popular_this_week",title:"Popular this week",items:A});const I=await mr("discover:artists:recent",async()=>{const{data:N,error:V}=await Rt.from("v_subject_artists").select("artist_id,subject_id,name,avatar_url,city,genres,updated_at").order("updated_at",{ascending:!1}).limit(d2);if(V)throw V;return(N||[]).map(f2)},{ttlMs:6e4});I.length>0&&_.push({key:"recently_active",title:"Recently active",items:I});const B=new Set;return _.map(N=>({...N,items:N.items.filter(V=>B.has(V.id)?!1:(B.add(V.id),!0))}))},p2=10,ER=50,kR=()=>{const t=new Date,e=new Date(t);e.setHours(0,0,0,0);const r=new Date(e);r.setDate(r.getDate()+14),r.setHours(23,59,59,999);const l=new Date(e);return l.setDate(l.getDate()+7),l.setHours(23,59,59,999),{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}},m2=t=>({id:t.venue_place_id,subject_id:t.subject_id,name:t.name,city:t.city,address:t.address,photos:t.photos||[],venue_type:t.venue_type??null,capacity:t.capacity??null}),_w=async t=>{if(t.length===0)return[];const e=Array.from(new Set(t)).sort(),r=e.join(","),l=await mr(`venues:by_place_ids:${r}`,async()=>{const{data:_,error:y}=await Rt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity").in("venue_place_id",e);if(y)throw y;return _||[]},{ttlMs:6e4}),f=new Map;for(const _ of l)f.set(_.venue_place_id,_);return t.map(_=>f.get(_)).filter(Boolean).map(m2)},vw=t=>{const e=new Map;for(const r of t){const l=r.venue_place?.id;l&&e.set(l,(e.get(l)||0)+1)}return Array.from(e.entries()).sort((r,l)=>l[1]-r[1]).slice(0,p2).map(([r])=>r)},CR=async t=>{const{startOfToday:e,endOfTwoWeeks:r,endOfWeek:l}=kR(),f=await h2(e.toISOString(),r.toISOString()),_=[];if(t?.location){const N=[];for(const ie of f){const ne=qh(ie.latitude??ie.venue_place?.latitude??null),ve=qh(ie.longitude??ie.venue_place?.longitude??null);ne===null||ve===null||qx(t.location.lat,t.location.lng,ne,ve)>ER||N.push(ie)}const V=vw(N),K=await _w(V);K.length>0&&_.push({key:"venues_near_you",title:"Venues near you",items:K})}const y=f.filter(N=>{const V=new Date(N.starts_at);return V>=e&&V<=l}),d=vw(y),A=await _w(d);A.length>0&&_.push({key:"popular_venues_this_week",title:"Popular venues this week",items:A});const I=await mr("discover:venues:recent",async()=>{const{data:N,error:V}=await Rt.from("v_subject_venues").select("venue_place_id,subject_id,name,city,address,photos,venue_type,capacity,created_at").order("created_at",{ascending:!1}).limit(p2);if(V)throw V;return(N||[]).map(m2)},{ttlMs:6e4});I.length>0&&_.push({key:"recently_added",title:"Recently added venues",items:I});const B=new Set;return _.map(N=>({...N,items:N.items.filter(V=>B.has(V.id)?!1:(B.add(V.id),!0))}))},wy={searchArtists:xR,searchVenues:bR,getSuggestedArtists:TR,getSuggestedVenues:CR},AR=({tab:t,query:e,location:r})=>{const[l,f]=te.useState(!1),[_,y]=te.useState([]),[d,A]=te.useState([]),[I,B]=te.useState([]),[N,V]=te.useState([]),K=e.trim().length>0;return te.useEffect(()=>{let ie=!1;return(async()=>{f(!0);try{if(t==="artists")if(K){const ve=await wy.searchArtists(e);if(ie)return;y(ve)}else{const ve=await wy.getSuggestedArtists({location:r});if(ie)return;B(ve)}else if(K){const ve=await wy.searchVenues(e);if(ie)return;A(ve)}else{const ve=await wy.getSuggestedVenues({location:r});if(ie)return;V(ve)}}catch{if(ie)return;t==="artists"?(y([]),B([])):(A([]),V([]))}finally{ie||f(!1)}})(),()=>{ie=!0}},[K,r,e,t]),{loading:l,artists:_,venues:d,suggestedArtistSections:I,suggestedVenueSections:N,isSearching:K}},MR=()=>{const t=ta(),e=pp().state,r=KS(),[l]=iP(),[f,_]=te.useState("artists"),[y,d]=te.useState(""),A=vR(y,350),{canFollow:I,isFollowing:B,isToggling:N,toggleFollowSubject:V}=JS(),{loading:K,artists:ie,venues:ne,suggestedArtistSections:ve,suggestedVenueSections:se,isSearching:ge}=AR({tab:f,query:A,location:r});te.useEffect(()=>{e?.initialTab&&_(e.initialTab)},[]);const ae=async ye=>{const Se=await V(ye);!Se.ok&&Se.reason==="network"&&l({message:"Couldn't follow. Try again.",duration:2e3,position:"top"})},me=te.useMemo(()=>f==="artists"?"Follow the ones youve seen live.":"Follow the rooms you return to.",[f]);return S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("header",{className:"space-y-2",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Discover"}),S.jsx("h2",{className:"font-display text-3xl font-bold text-white",children:f==="artists"?"Artists":"Venues"}),S.jsx("p",{className:"text-sm text-white/55",children:me})]}),S.jsx(gR,{value:y,placeholder:"Search artists or venues",onChange:d,onClear:()=>d("")}),S.jsx(yR,{value:f,onChange:_}),K&&S.jsx(_R,{rows:6}),!K&&f==="artists"&&S.jsx(S.Fragment,{children:ge?ie.length===0?S.jsx(by,{title:`No results for "${A.trim()}"`,description:"Try a different spelling or search by city.",actionLabel:"Clear search",onAction:()=>d("")}):S.jsx("div",{className:"space-y-3",children:ie.map(ye=>S.jsx(pw,{artist:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>ae(ye.subject_id),onOpenProfile:()=>t.push(`/artist/${ye.id}`)},ye.id))}):ve.length===0?S.jsx(by,{title:"No artist suggestions yet",description:"Search by name to find an artist."}):S.jsx(fw,{sections:ve,renderItem:ye=>S.jsx(pw,{artist:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>ae(ye.subject_id),onOpenProfile:()=>t.push(`/artist/${ye.id}`)},ye.id)})}),!K&&f==="venues"&&S.jsx(S.Fragment,{children:ge?ne.length===0?S.jsx(by,{title:`No results for "${A.trim()}"`,description:"Try a different spelling or search by city.",actionLabel:"Clear search",onAction:()=>d("")}):S.jsx("div",{className:"space-y-3",children:ne.map(ye=>S.jsx(mw,{venue:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>ae(ye.subject_id),onOpenProfile:()=>t.push(`/venue/${ye.id}`)},ye.id))}):se.length===0?S.jsx(by,{title:"No venue suggestions yet",description:"Search by name to find a venue."}):S.jsx(fw,{sections:se,renderItem:ye=>S.jsx(mw,{venue:ye,canFollow:I,isFollowing:B(ye.subject_id),followLoading:N(ye.subject_id),onToggleFollow:()=>ae(ye.subject_id),onOpenProfile:()=>t.push(`/venue/${ye.id}`)},ye.id)})})]})},PR=()=>S.jsx(so,{children:S.jsx(MR,{})}),g2=(t,e,r)=>{const l=r?encodeURI(r).replace(/'/g,"%27"):"",f=r?`<div class="map-pin-avatar" style="background-image:url('${l}')"></div>`:'<div class="map-pin-avatar map-pin-avatar--empty"></div>',_=`
    <div class="map-pin map-pin--${t}">
      ${f}
      <span class="map-pin-label">${e}</span>
    </div>
  `;return Xh.divIcon({className:"map-pin-wrapper",html:_,iconSize:[52,60],iconAnchor:[26,60],popupAnchor:[0,-54]})},IR=({center:t})=>{const e=gp();return te.useEffect(()=>{t&&e.setView(t)},[t,e]),null},jR=({onChange:t})=>{const e=gp();return te.useEffect(()=>{t(e.getBounds())},[e,t]),r2({moveend:()=>t(e.getBounds()),zoomend:()=>t(e.getBounds())}),null},LR=({enabled:t,onSelect:e})=>(r2({click:r=>{t&&e(r.latlng.lat,r.latlng.lng)}}),null),xw=[41.3874,2.1686],mv="createEvent:lastMapCenter",bw=t=>{const e=t.getTimezoneOffset();return new Date(t.getTime()-e*6e4).toISOString().slice(0,16)},du=t=>{if(t==null)return null;if(typeof t=="number")return Number.isNaN(t)?null:t;const e=Number(t);return Number.isNaN(e)?null:e},zR=t=>t.replace(/[^a-zA-Z0-9._-]/g,"-"),Em=async(t,e,r)=>{let l=null;const f=new Promise((_,y)=>{l=window.setTimeout(()=>{y(new Error(`${r} timed out. Please try again.`))},e)});try{return await Promise.race([t,f])}finally{l!==null&&window.clearTimeout(l)}},RR=({userId:t,profileRole:e,profileCity:r,defaultArtistId:l=null,defaultArtistName:f=null,initialCenter:_=null})=>{const[y,d]=te.useState([]),[A,I]=te.useState([]),[B,N]=te.useState(!1),[V,K]=te.useState(!1),[ie,ne]=te.useState(!1),[ve,se]=te.useState(""),[ge,ae]=te.useState(""),[me,ye]=te.useState(null),[Se,ze]=te.useState("existing"),[He,Ze]=te.useState(""),[st,lt]=te.useState(r||""),[Ke,Mt]=te.useState(""),[gt,St]=te.useState(""),[Be,ot]=te.useState(""),[Fe,kt]=te.useState(""),[rt,be]=te.useState(bw(new Date)),[Ie,et]=te.useState(""),[at,mt]=te.useState(""),[Ct,Ot]=te.useState(""),[Kt,_i]=te.useState(""),[Vi,gi]=te.useState(null),[Oi,xn]=te.useState(null),[cn,Zn]=te.useState(""),[tt,Xn]=te.useState(!0),[Pn,ki]=te.useState([]),[yi,Cn]=te.useState(""),[Ln,us]=te.useState(""),[an,en]=te.useState(l?[l]:[]),[qi,Fn]=te.useState("existing"),[Tt,On]=te.useState(""),[dn,An]=te.useState(""),[Kn,It]=te.useState(""),[ai,ti]=te.useState(null),Ji=()=>{if(typeof window>"u")return null;try{const $t=window.localStorage.getItem(mv);if(!$t)return null;const At=JSON.parse($t);if(Array.isArray(At)&&At.length===2&&Number.isFinite(Number(At[0]))&&Number.isFinite(Number(At[1])))return[Number(At[0]),Number(At[1])]}catch{return null}return null},Nn=te.useMemo(()=>Ji(),[_]),mi=Nn||_||null,[Bt,hi]=te.useState(mi||xw),[Ci,bi]=te.useState(null);te.useEffect(()=>{se(""),ae(""),ye(null),ze("existing"),Ze(""),lt(r||""),Mt(""),St(""),ot(""),kt(""),be(bw(new Date)),et(""),mt(""),Ot(""),_i(""),gi(null),xn(null),Zn(""),Xn(!0),ki([]),Cn(""),us(""),en(l?[l]:[]),It(""),ti(null),hi(mi||xw)},[r,l,mi]),te.useEffect(()=>{(async()=>{N(!0);const{data:At,error:ni}=await Rt.from("venue_places").select("id, name, city, address, latitude, longitude, website_url, photos").order("name",{ascending:!0});ni?(se("Unable to load venues."),d([])):d(At||[]),N(!1)})()},[]),te.useEffect(()=>{const $t=Kn.trim();if(ti(null),!$t){I(l?[{id:l,display_name:f||"Your artist profile",username:null,role:"artist"}]:[]),K(!1);return}let At=!1;const ni=window.setTimeout(async()=>{K(!0);const vi=Rt.from("artists").select("id, name, avatar_url").order("name",{ascending:!0}),{data:Bi,error:_t}=await vi.ilike("name",`%${$t}%`);if(!At){if(_t)se("Unable to load artists."),I([]),ti(0);else{const xt=(Bi||[]).map(Ne=>({id:Ne.id,display_name:Ne.name,username:null,role:"artist",avatar_url:Ne.avatar_url??null}));ti(xt.length);const Wt=l?xt.some(Ne=>Ne.id===l):!1,pi=l&&!Wt?[{id:l,display_name:f||"Your artist profile",username:null,role:"artist"},...xt]:xt;I(pi)}K(!1)}},700);return()=>{At=!0,window.clearTimeout(ni)}},[Kn,l,f]),te.useEffect(()=>{l&&an.length===0&&en([l])},[l,an.length]);const xe=te.useCallback($t=>{hi($t),typeof window<"u"&&window.localStorage.setItem(mv,JSON.stringify($t))},[]),ee=te.useCallback($t=>{typeof window<"u"&&window.localStorage.setItem(mv,JSON.stringify($t))},[]);te.useEffect(()=>{_&&!Nn&&xe(_)},[_,Nn,xe]),te.useEffect(()=>{mi||navigator.geolocation&&navigator.geolocation.getCurrentPosition($t=>{xe([$t.coords.latitude,$t.coords.longitude])},()=>{},{enableHighAccuracy:!0,timeout:5e3})},[mi,xe]),te.useEffect(()=>{if(!Vi){xn(null);return}const $t=URL.createObjectURL(Vi);return xn($t),()=>URL.revokeObjectURL($t)},[Vi]);const Q=te.useMemo(()=>{const $t=ge.trim().toLowerCase();return $t?y.filter(At=>At.name.toLowerCase().includes($t)||At.city.toLowerCase().includes($t)||At.address?.toLowerCase().includes($t)):y},[y,ge]),ue=te.useMemo(()=>Ci?Q.filter($t=>{const At=du($t.latitude),ni=du($t.longitude);return At===null||ni===null?!1:Ci.contains(Xh.latLng(At,ni))}):Q,[Q,Ci]),we=te.useMemo(()=>ue.map($t=>{const At=du($t.latitude),ni=du($t.longitude);return At===null||ni===null?null:{venue:$t,position:[At,ni],icon:g2("venue","SALA",$t.photos?.[0]||null)}}).filter(Boolean),[ue]),je=te.useCallback($t=>{bi($t);const At=$t.getCenter();At&&Number.isFinite(At.lat)&&Number.isFinite(At.lng)&&ee([At.lat,At.lng])},[ee]),Oe=te.useCallback($t=>{ye($t),ze("existing");const At=du($t.latitude),ni=du($t.longitude);At!==null&&ni!==null&&xe([At,ni])},[xe]),qe=te.useCallback(($t,At)=>{ze("new"),ye(null),St($t.toFixed(6)),ot(At.toFixed(6)),xe([$t,At])},[xe]),de=Se==="existing"?me?.city||"":st.trim(),Je=Se==="existing"?me?.address||"":Ke.trim(),ct=du(Se==="existing"?me?.latitude:gt),Ye=du(Se==="existing"?me?.longitude:Be);return{artists:A,artistsLoading:V,venuesLoading:B,error:ve,saving:ie,venueSearch:ge,venueMode:Se,selectedVenue:me,newVenueName:He,newVenueCity:st,newVenueAddress:Ke,newVenueLat:gt,newVenueLng:Be,eventName:Fe,eventStart:rt,eventEnd:Ie,eventDescription:at,eventUrl:Ct,eventCoverUrl:Kt,posterFile:Vi,posterPreview:Oi,eventGenres:cn,isFree:tt,priceTiers:Pn,tierLabel:yi,tierPrice:Ln,selectedArtistIds:an,artistMode:qi,newArtistName:Tt,newArtistUsername:dn,artistSearch:Kn,artistSearchCount:ai,mapCenter:Bt,mapBounds:Ci,visibleVenues:ue,venueMarkers:we,venueLat:ct,venueLng:Ye,setVenueSearch:ae,setVenueMode:ze,setSelectedVenue:ye,setNewVenueName:Ze,setNewVenueCity:lt,setNewVenueAddress:Mt,setNewVenueLat:St,setNewVenueLng:ot,setEventName:kt,setEventStart:be,setEventEnd:et,setEventDescription:mt,setEventUrl:Ot,setEventCoverUrl:_i,setPosterFile:gi,setEventGenres:Zn,setIsFree:Xn,setTierLabel:Cn,setTierPrice:us,setSelectedArtistIds:en,setArtistMode:Fn,setNewArtistName:On,setNewArtistUsername:An,setArtistSearch:It,setError:se,handleBoundsChange:je,addPriceTier:()=>{se("");const $t=yi.trim(),At=Number(Ln);if(!$t){se("Price tier name is required.");return}if(!Number.isFinite(At)||At<0){se("Enter a valid price.");return}ki(ni=>[...ni,{label:$t,price:At}]),Cn(""),us("")},removePriceTier:$t=>{ki(At=>At.filter((ni,vi)=>vi!==$t))},selectVenue:Oe,handleMapSelect:qe,handleCreate:async()=>{if(!t)return se("Sign in to create events."),null;if(!Fe.trim())return se("Event name is required."),null;if(!rt)return se("Start time is required."),null;if(!tt&&Pn.length===0)return se("Add at least one price tier."),null;if(Se==="existing"&&!me)return se("Select a venue place."),null;if(Se==="new"){if(!He.trim())return se("Venue name is required."),null;if(!st.trim())return se("Venue city is required."),null;if(ct===null||Ye===null)return se("Select a location on the map."),null}const $t=l&&e==="artist"?[l]:[],At=an.length>0?an:$t;if(At.length===0)return se("Select at least one artist."),null;const ni=new Date(rt);if(Number.isNaN(ni.getTime()))return se("Invalid start time."),null;let vi=null;if(Ie){const Bi=new Date(Ie);if(Number.isNaN(Bi.getTime()))return se("Invalid end time."),null;if(Bi<ni)return se("End time must be after the start time."),null;vi=Bi.toISOString()}ne(!0),se("");try{let Bi=Kt.trim()||null,_t=me?.id||null;if(Vi){const Ne=zR(Vi.name||"poster"),zt=`event-posters/${t}/${Date.now()}-${Ne}`,{error:Jt}=await Em(Rt.storage.from("media").upload(zt,Vi,{cacheControl:"3600",upsert:!1,contentType:Vi.type||"image/*"}),45e3,"Poster upload");if(Jt)throw Jt;const{data:Ki}=Rt.storage.from("media").getPublicUrl(zt);Bi=Ki.publicUrl}if(Se==="new"){const{data:Ne,error:zt}=await Em(Rt.from("venue_places").insert({name:He.trim(),city:st.trim(),address:Ke.trim()||null,latitude:ct,longitude:Ye,created_by:t}).select("id, name, city, address, latitude, longitude").single(),2e4,"Venue create");if(zt)throw zt;_t=Ne.id}if(!_t)throw new Error("Venue is required.");const xt=cn.split(",").map(Ne=>Ne.trim()).filter(Boolean),{data:Wt,error:pi}=await Em(Rt.from("events").insert({organizer_id:t,venue_place_id:_t,name:Fe.trim(),description:at.trim()||null,event_url:Ct.trim()||null,city:de||r||"",address:Je||null,latitude:ct,longitude:Ye,genres:xt,cover_image_url:Bi,is_free:tt,price_tiers:tt?[]:Pn,starts_at:ni.toISOString(),ends_at:vi,is_public:!0}).select("id").single(),2e4,"Event create");if(pi||!Wt)throw pi||new Error("Event creation failed.");for(const Ne of At){const{error:zt}=await Em(Rt.from("event_artists").insert({event_id:Wt.id,artist_entity_id:Ne}),2e4,"Lineup create");if(zt)throw await Em(Rt.from("events").delete().eq("id",Wt.id),2e4,"Rollback"),zt}return Wt.id}catch(Bi){const _t=Bi instanceof Error?Bi.message:"Unknown error occurred";return se(_t),null}finally{ne(!1)}}}},DR=({venueMode:t,onToggleVenueMode:e,venueSearch:r,onVenueSearchChange:l,mapCenter:f,venueMarkers:_,newVenueIcon:y,visibleVenues:d,venuesLoading:A,selectedVenue:I,onSelectVenue:B,onClearVenue:N,onBoundsChange:V,onMapSelect:K,venueLat:ie,venueLng:ne,newVenueName:ve,newVenueCity:se,newVenueAddress:ge,newVenueLat:ae,newVenueLng:me,onNewVenueNameChange:ye,onNewVenueCityChange:Se,onNewVenueAddressChange:ze,onNewVenueLatChange:He,onNewVenueLngChange:Ze})=>S.jsxs("section",{className:"h-full space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsx("div",{children:S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Venue"})}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center text-sm font-semibold text-white/70 transition hover:text-white",onClick:e,children:t==="existing"?"New venue":"Use existing"})]}),S.jsx("input",{type:"search",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",placeholder:"Search venues",value:r,onChange:st=>l(st.target.value)}),S.jsx("div",{className:"h-[220px] overflow-hidden rounded-2xl bg-black/30",children:S.jsxs(Xx,{center:f,zoom:12,className:"h-full w-full",zoomControl:!1,style:{height:"100%",width:"100%"},children:[S.jsx(c2,{}),S.jsx(Kx,{}),t==="existing"&&_.map(st=>S.jsx(i_,{position:st.position,icon:st.icon,eventHandlers:{click:()=>B(st.venue)}},st.venue.id)),t==="new"&&ie!==null&&ne!==null&&S.jsx(i_,{position:[ie,ne],icon:y}),S.jsx(IR,{center:f}),S.jsx(jR,{onChange:V}),S.jsx(LR,{enabled:t==="new",onSelect:K})]})}),t==="existing"&&S.jsx(S.Fragment,{children:A?S.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/70",children:[S.jsx(Ws,{name:"crescent"}),"Loading venues..."]}):d.length===0?S.jsx("p",{className:"h-[250px] text-sm text-white/60",children:'No venues found. Switch to "New venue" to add one.'}):S.jsx("div",{className:"max-h-[250px] overflow-auto pr-1",children:S.jsx("div",{className:"space-y-3",children:d.map(st=>S.jsxs("div",{className:`flex cursor-pointer items-center gap-4 rounded-2xl p-4 text-left transition ${I?.id===st.id?"bg-white/10":"bg-white/5 hover:bg-white/10"}`,onClick:()=>B(st),children:[S.jsx("div",{className:"flex h-16 w-16 flex-shrink-0 items-center justify-center overflow-hidden rounded-xl bg-white/10",children:st.photos&&st.photos.length>0?S.jsx("img",{src:st.photos[0],alt:st.name,className:"h-full w-full object-cover"}):S.jsx("svg",{className:"h-8 w-8 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsx("h3",{className:"mb-1 text-sm font-semibold text-white",children:st.name}),S.jsxs("p",{className:"mb-1 text-xs text-white/60",children:[st.city,st.address?`  ${st.address}`:""]}),st.venue_type&&S.jsxs("p",{className:"text-xs text-white/50",children:[st.venue_type,st.capacity?`  Capacity: ${st.capacity}`:""]})]}),I?.id===st.id&&S.jsx("div",{className:"h-2.5 w-2.5 flex-shrink-0 rounded-full bg-app-accent"})]},st.id))})})}),t==="new"&&S.jsxs("div",{className:"space-y-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Venue name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:ve,onChange:st=>ye(st.target.value),placeholder:"Venue name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:se,onChange:st=>Se(st.target.value),placeholder:"City"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Address"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:ge,onChange:st=>ze(st.target.value),placeholder:"Street address"})]})]})]}),OR=({name:t})=>t==="spotify"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("circle",{cx:"12",cy:"12",r:"9"}),S.jsx("path",{d:"M7.5 10.5c3.2-1 6.8-.6 9.3.9M8.5 13.5c2.3-.6 5-.4 6.9.6M9.5 16.1c1.6-.3 3.3-.1 4.6.5"})]}):t==="apple_music"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[S.jsx("path",{d:"M16.5 3.5c-.9.6-1.9 1-2.7.9-.1-1 .5-2 1.3-2.6.9-.6 2.2-1 3.2-1-.2 1-1 2-1.8 2.7z"}),S.jsx("path",{d:"M19 13.5c-.2 2-1.7 5.5-3.4 5.5-.8 0-1.2-.5-2-.5-.8 0-1.4.5-2 .5-1.7 0-3.6-3.3-3.6-6.1 0-2.7 1.8-4.1 3.4-4.1.8 0 1.6.5 2.1.5s1.3-.6 2.3-.6c.6 0 2.1.2 2.8 1.6-.1.1-1.7 1-1.6 3.2 0 2.6 2 3.4 2 3.4z"})]}):t==="instagram"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"4"}),S.jsx("circle",{cx:"12",cy:"12",r:"3.2"}),S.jsx("circle",{cx:"17",cy:"7",r:"1",fill:"currentColor"})]}):t==="youtube"?S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[S.jsx("path",{d:"M21 8.5s0-2-2-2.1C17.2 6.2 12 6.2 12 6.2s-5.2 0-7 .2C3 6.4 3 8.5 3 8.5S3 10.6 3 12v1.5s0 2 2 2.2c1.8.2 7 .2 7 .2s5.2 0 7-.2c2-.2 2-2.2 2-2.2V12s0-1.5 0-3.5z"}),S.jsx("path",{d:"M10 15l4-3-4-3v6z",fill:"#0b0b0d"})]}):S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[S.jsx("path",{d:"M10 14l-4 4m0 0h4m-4 0v-4"}),S.jsx("path",{d:"M14 10l4-4m0 0h-4m4 0v4"}),S.jsx("path",{d:"M8 16h8a4 4 0 0 0 4-4V8"}),S.jsx("path",{d:"M16 8H8a4 4 0 0 0-4 4v4"})]}),NR=({artist:t,isManager:e,playedCount:r,externalLinks:l,heroStyle:f,onEdit:_})=>{const y=t?.is_verified;return S.jsxs("section",{className:"relative min-h-[420px] overflow-hidden bg-black",style:f,children:[e&&S.jsx("button",{type:"button",onClick:_,className:"absolute right-4 top-4 z-10 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",children:S.jsxs("span",{className:"inline-flex items-center gap-2",children:[S.jsx(sI,{size:14}),"Edit"]})}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-6",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 overflow-hidden bg-white/10",children:t.avatar_url?S.jsx("img",{src:t.avatar_url,alt:t.name,className:"h-full w-full object-cover"}):S.jsx("div",{className:"h-full w-full bg-white/10"})}),S.jsxs("div",{className:"min-w-0 flex-1",children:[S.jsx("h1",{className:"font-display text-2xl font-bold text-white line-clamp-1",children:t.name}),S.jsxs("p",{className:"mt-1 text-sm text-white/55 line-clamp-1",children:[t.city?t.city:t.artist_type==="band"?"Band":"Solo",y?"  Verified":"",r>0?`  ${r} shows`:""]})]})]}),t.bio&&S.jsx("p",{className:"mt-4 text-sm text-white/80",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.bio}),l.length>0&&S.jsx("div",{className:"mt-4 flex flex-wrap gap-x-4 gap-y-2",children:l.map(d=>{const A=d.key,I={spotify:"Spotify",apple_music:"Apple Music",instagram:"Instagram",youtube:"YouTube",website:"Website"};return S.jsxs("a",{href:d.value,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(OR,{name:A}),I[A]]},A)})})]})]})},BR=({activeTab:t,onSelect:e})=>S.jsx("div",{className:"flex flex-wrap items-center gap-6",children:["shows","moments","media","about"].map(r=>S.jsx("button",{type:"button",onClick:()=>e(r),className:`text-xs font-semibold uppercase tracking-[0.22em] transition-colors ${t===r?"text-app-accent":"text-white/55 hover:text-white/80"}`,children:r==="shows"?"Shows":r==="media"?"Media":r==="moments"?"Moments":"About"},r))}),$R=({events:t,isManager:e,onViewEvent:r,onCreateShow:l,onOpenMap:f})=>S.jsxs("section",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Upcoming"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Upcoming shows"})]}),S.jsxs("button",{type:"button",onClick:f,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(h_,{size:16}),"Artist map"]})]}),t.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"font-semibold text-white",children:"No upcoming shows"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"When new dates are announced they will show up here first."}),e?S.jsx("button",{type:"button",onClick:l,className:"mt-3 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create your first show"}):null]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:t.map(_=>{const d=new Date(_.starts_at).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),A=_.venue_place?.name||_.address||"Venue TBA",I=_.venue_place?.city||_.city||"City";return S.jsx(Ql,{event:_,className:"w-[220px] shrink-0",kicker:d,title:A,subtitle:I,onSelect:B=>r(B.id)},_.id)})})]}),UR=({hasEvents:t,artistName:e,isManager:r,onOpenMap:l,onCreateShow:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Map"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Artist map"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Filtered to ",e," by default."]})]}),S.jsxs("button",{type:"button",onClick:l,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:[S.jsx(h_,{size:16}),"Open map"]})]}),S.jsx("div",{className:"overflow-hidden bg-white/5 p-5",children:t?S.jsxs("div",{className:"space-y-2",children:[S.jsx("p",{className:"text-sm font-semibold text-white",children:"Map preview"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Open the live map to explore where ",e," is playing. The map starts filtered to this artist."]}),S.jsx("div",{className:"mt-3 h-40 bg-black/60"})]}):S.jsxs("div",{className:"flex flex-col items-start gap-2 text-white",children:[S.jsx("p",{className:"text-lg font-semibold",children:"No shows to display for this artist"}),S.jsx("p",{className:"text-sm text-white/55",children:"New events will appear on the map as soon as they are published."}),r?S.jsx("button",{type:"button",onClick:f,className:"mt-2 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create show"}):null]})})]}),FR=({gallery:t,onSelect:e,onViewGallery:r})=>t.length===0?null:S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Media"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Gallery"}),S.jsx("p",{className:"text-sm text-white/55",children:"Live photos, posters, backstage."})]}),S.jsx("button",{type:"button",onClick:r,className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:"View gallery"})]}),S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:t.map(l=>S.jsx("button",{type:"button",onClick:()=>e(l.id),className:"group relative aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:S.jsx("img",{src:l.media_url,alt:l.caption||"Gallery item",className:"h-full w-full object-cover"})},l.id))})]}),VR=({events:t,playedCount:e,isManager:r,onViewEvent:l,onCreateShow:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Archive"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Past shows"}),S.jsxs("p",{className:"text-sm text-white/55",children:["Last ",t.length||3," performances."]})]}),e>0&&S.jsxs("span",{className:"bg-white/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.22em] text-white/80",children:["Played ",e]})]}),t.length===0?S.jsxs("div",{className:"bg-white/5 p-5",children:[S.jsx("p",{className:"font-semibold text-white",children:"No past shows yet"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"We will start showing the archive as soon as the first show finishes."}),r?S.jsx("button",{type:"button",onClick:f,className:"mt-3 bg-white/10 px-4 py-2 text-sm font-semibold text-white",children:"Create show"}):null]}):S.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:t.map(_=>{const y=new Date(_.starts_at).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),d=_.venue_place?.name||_.address||"Venue TBA",A=_.venue_place?.city||_.city||"City";return S.jsx(Ql,{event:_,className:"w-[220px] shrink-0",kicker:y,title:d,subtitle:A,onSelect:I=>l(I.id)},_.id)})})]}),qR=({moments:t,isManager:e,onSelect:r})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"Moments"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Relive it"}),S.jsx("p",{className:"text-sm text-white/70",children:"Clips and snapshots from the crowd."})]}),e&&t.length===0&&S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.18em] text-white/60",children:"Empty  add the first one"})]}),t.length===0?e?S.jsxs("div",{className:"rounded-2xl bg-white/5 p-5 text-white/80",children:[S.jsx("p",{className:"font-semibold text-white",children:"No moments yet  share your first live moment"}),S.jsx("p",{className:"mt-1 text-sm text-white/70",children:"Upload a clip or photo from a recent performance."})]}):null:S.jsx("div",{className:"grid grid-cols-3 gap-2",children:t.slice(0,12).map(l=>S.jsx("button",{type:"button",onClick:()=>r(l.id),className:"relative aspect-square overflow-hidden bg-black/30",children:l.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:l.media_url})}):S.jsx("img",{src:l.media_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"})},l.id))})]}),HR=({artist:t,isManager:e,playedCount:r,onCreateShow:l,onOpenMap:f})=>S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.35em] text-white/60",children:"About"}),S.jsx("h2",{className:"font-display text-xl font-bold text-white",children:"Details"})]}),S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-5",children:[S.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"City"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.city||""})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Type"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.artist_type==="band"?"Band":"Solo artist"})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Genres"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:t.genres&&t.genres.length>0?t.genres.join(", "):""})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/60",children:"Shows"}),S.jsx("p",{className:"text-sm font-semibold text-white",children:r>0?`Played ${r}`:"Coming soon"})]})]}),e&&S.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[S.jsx("button",{type:"button",onClick:l,className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.14em] text-white transition hover:bg-white/15",children:"Create show"}),S.jsxs("button",{type:"button",onClick:f,className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.14em] text-white transition hover:bg-white/15",children:[S.jsx(h_,{size:14}),"View on map"]})]})]})]}),y2=({artistId:t,embedded:e})=>{const{id:r}=eg(),l=t||r,f=ta(),{managedEntities:_,activeWorkspace:y}=mp(),{user:d}=ya(),[A,I]=te.useState(null),[B,N]=te.useState([]),[V,K]=te.useState([]),[ie,ne]=te.useState([]),[ve,se]=te.useState([]),[ge,ae]=te.useState(!0),[me,ye]=te.useState(""),[Se,ze]=te.useState("shows");te.useEffect(()=>{(async()=>{ae(!0),ye("");try{const{data:Fe,error:kt}=await Rt.from("v_subject_artists").select("*").eq("artist_id",l).maybeSingle();if(kt||!Fe)throw kt||new Error("Artist not found");const rt={id:Fe.artist_id||Fe.id||l,name:Fe.name,artist_type:Fe.artist_type,city:Fe.city,bio:Fe.bio,avatar_url:Fe.avatar_url,genres:Fe.genres||[],external_links:Fe.external_links||{},created_at:Fe.created_at,updated_at:Fe.updated_at,subject_id:Fe.subject_id},{data:be}=await Rt.from("event_artists").select("event_id").eq("artist_entity_id",rt.id),Ie=(be||[]).map(Ot=>Ot.event_id).filter(Boolean);let et=[];if(Ie.length>0){const{data:Ot}=await Rt.from("events").select(`
                *,
                venue_place:venue_places!events_venue_place_id_fkey (
                  id,
                  name,
                  city,
                  address,
                  latitude,
                  longitude
                ),
                event_artists (
                  artist:artists!event_artists_artist_entity_fk (
                    id,
                    name,
                    avatar_url
                  )
                )
              `).in("id",Ie).order("starts_at",{ascending:!0});et=Ot||[]}const at=new Date,mt=et.filter(Ot=>new Date(Ot.starts_at)>=at),Ct=et.filter(Ot=>new Date(Ot.starts_at)<at);if(I(rt),N(mt),K(Ct.reverse()),Ie.length>0){const{data:Ot}=await Rt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",Ie).order("created_at",{ascending:!1}).limit(24),Kt=Ot||[];ne(Kt),se(Kt.filter(_i=>_i.media_type==="image").slice(0,6))}else ne([]),se([])}catch(Fe){console.error("Failed to load artist profile",Fe),ye("Artist not found."),I(null),N([]),K([]),ne([]),se([])}finally{ae(!1)}})()},[l]);const He=te.useMemo(()=>A?y?.type==="artist"&&y.artist?.id===A.id||_.some(ot=>ot.type==="artist"&&ot.artist?.id===A.id):!1,[y,A,_]),Ze=te.useMemo(()=>{const ot=A?.external_links||{},Fe={spotify:ot.spotify,apple_music:ot.apple_music||ot.appleMusic,instagram:ot.instagram,youtube:ot.youtube,website:ot.website};return Object.entries(Fe).map(([kt,rt])=>({key:kt,value:rt})).filter(kt=>!!kt.value)},[A]),st=B.slice(0,5),lt=V.slice(0,5),Ke=A?.avatar_url?{backgroundColor:"#0b0b0d",backgroundImage:`linear-gradient(180deg, rgba(0,0,0,0.12) 0%, rgba(0,0,0,0.68) 70%, #0b0b0d 100%), url(${A.avatar_url})`,backgroundSize:"cover",backgroundPosition:"center"}:{backgroundColor:"#0b0b0d"},Mt=()=>{A&&f.push("/tabs/map",{artistFilter:{id:A.id,name:A.name,avatar_url:A.avatar_url}})},gt=V.length+B.length,St=()=>{switch(Se){case"shows":return S.jsxs("div",{className:"space-y-6",children:[S.jsx($R,{events:st,isManager:He,onViewEvent:ot=>f.push(`/event/${ot}`),onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`}),onOpenMap:Mt}),S.jsx(VR,{events:lt,playedCount:gt,isManager:He,onViewEvent:ot=>f.push(`/event/${ot}`),onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`})})]});case"media":return S.jsxs("div",{className:"space-y-6",children:[S.jsx(UR,{hasEvents:B.length>0||V.length>0,artistName:A?.name||"",isManager:He,onOpenMap:Mt,onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`})}),S.jsx(FR,{gallery:ve,onSelect:ot=>f.push(`/post/${ot}`),onViewGallery:()=>ze("moments")})]});case"moments":return S.jsx(qR,{moments:ie,isManager:He,onSelect:ot=>f.push(`/post/${ot}`)});default:return S.jsx(HR,{artist:A,isManager:He,playedCount:gt,onCreateShow:()=>f.push("/create-event",{from:`/tabs/artist/${l}`}),onOpenMap:Mt})}},Be=S.jsxs(S.Fragment,{children:[ge&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})}),!ge&&me&&S.jsx("p",{className:"text-sm text-rose-400",children:me}),!ge&&A&&S.jsxs("div",{className:"space-y-8",children:[S.jsx(NR,{artist:A,isManager:He,playedCount:gt,externalLinks:Ze,heroStyle:Ke,onEdit:()=>f.push("/tabs/profile")}),S.jsx("div",{className:"sticky top-[72px] z-10 -mx-4 bg-app-bg px-4 py-3",children:S.jsx(BR,{activeTab:Se,onSelect:ot=>ze(ot)})}),S.jsx("div",{children:St()})]})]});return e?S.jsx("div",{className:"p-4",children:Be}):S.jsx(so,{children:S.jsx("div",{className:"p-4",children:Be})})},ZR=({profileRole:t,profileName:e,artists:r,selectedArtistIds:l,artistsLoading:f,artistSearch:_,artistSearchCount:y,onArtistSearchChange:d,onSelectArtists:A})=>{const[I,B]=te.useState("existing"),[N,V]=te.useState(""),[K,ie]=te.useState(""),[ne,ve]=te.useState(null),se=me=>{l.includes(me)?A(l.filter(ye=>ye!==me)):A([...l,me])},ge=r.filter(me=>l.includes(me.id));Nt.useEffect(()=>{if(t==="artist"&&l.length===0){const me=r.find(ye=>ye.display_name===e||ye.username===e);me&&A([me.id])}},[t,e,r,l.length,A]);const ae=()=>{B(me=>me==="existing"?"new":"existing")};return S.jsxs("section",{className:"h-full space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Artists"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:t==="artist"?"Add yourself and other artists to your event.":"Add multiple artists to your event."})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center text-sm font-semibold text-white/70 transition hover:text-white",onClick:ae,children:I==="existing"?"New artist":"Use existing"})]}),I==="existing"?S.jsxs(S.Fragment,{children:[S.jsxs("label",{className:"flex items-center gap-2 rounded-2xl bg-white/10 px-3 py-2 text-sm text-white",children:[S.jsx("svg",{className:"h-4 w-4 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"})}),S.jsx("input",{className:"w-full bg-transparent text-sm text-white placeholder:text-white/40 focus:outline-none",placeholder:"Search artists",value:_,onChange:me=>d(me.target.value)})]}),f&&S.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/70",children:[S.jsx(Ws,{name:"crescent"}),"Searching artists..."]}),!f&&_.trim()!==""&&y===0&&S.jsxs("p",{className:"text-sm text-white/60",children:['No artists found for "',_.trim(),'". The band does not exist yet.']}),!f&&r.length===0&&_.trim()===""&&S.jsx("p",{className:"h-[250px] text-sm text-white/60",children:'No artists found. Switch to "New artist" to add one.'}),r.length>0&&S.jsxs(S.Fragment,{children:[ge.length>0&&S.jsxs("div",{className:"space-y-2 flex-shrink-0",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:["Selected Artists (",ge.length,")"]}),S.jsx("div",{className:"space-y-2",children:ge.map(me=>S.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl bg-white/10 p-3",children:[S.jsxs("div",{children:[S.jsxs("p",{className:"text-sm font-semibold text-white",children:[me.display_name||me.username||"Artist",t==="artist"&&(me.display_name===e||me.username===e)&&S.jsx("span",{className:"ml-2 text-xs text-white/60",children:"(You)"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Artist"})]}),me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-10 w-10 rounded-full object-cover"}):null,S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg bg-white/10 px-2 py-1 text-xs font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>se(me.id),children:"Remove"})]},me.id))})]}),S.jsx("div",{className:"overflow-auto max-h-[250px] pr-1",children:S.jsx("div",{className:"space-y-3",children:r.filter(me=>!l.includes(me.id)).map(me=>S.jsxs("div",{className:"flex cursor-pointer items-center gap-4 rounded-2xl bg-white/5 p-4 text-left transition hover:bg-white/10",onClick:()=>se(me.id),children:[S.jsx("div",{className:"flex h-16 w-16 flex-shrink-0 items-center justify-center overflow-hidden rounded-xl bg-white/10",children:me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-white/10",children:S.jsx("span",{className:"text-sm font-semibold text-white/80",children:(me.display_name||me.username||"A")[0]?.toUpperCase()})})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsxs("h3",{className:"mb-1 text-sm font-semibold text-white",children:[me.display_name||me.username||"Artist",t==="artist"&&(me.display_name===e||me.username===e)&&S.jsx("span",{className:"ml-2 text-xs text-white/60",children:"(You)"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Artist"}),S.jsx("button",{type:"button",className:"mt-1 inline-flex text-xs font-semibold text-white/70 hover:text-white",onClick:ye=>{ye.stopPropagation(),ve(me)},children:"View profile"})]}),S.jsx("div",{className:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-white/10",children:S.jsx("svg",{className:"h-4 w-4 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]},me.id))})}),ge.length===0&&S.jsx("div",{className:"flex flex-shrink-0 items-center justify-between gap-3 rounded-2xl bg-white/5 p-3",children:S.jsx("p",{className:"text-sm text-white",children:r.length===0?"No matching artists. Try a different search or add a new artist.":"Select artists to continue"})})]})]}):S.jsxs("div",{className:"space-y-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Artist name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:N,onChange:me=>V(me.target.value),placeholder:"Artist name"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Username"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:K,onChange:me=>ie(me.target.value),placeholder:"Username"})]}),S.jsx("p",{className:"text-xs text-white/60",children:"Note: You can assign a user to this artist later."})]}),S.jsx($m,{isOpen:!!ne,onDidDismiss:()=>ve(null),children:S.jsxs(Pl,{fullscreen:!0,children:[S.jsxs("div",{className:"flex items-center justify-between gap-4 bg-app-bg px-5 py-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Artist profile"}),S.jsx("button",{type:"button",className:"inline-flex items-center gap-2 rounded-xl bg-white/10 px-3 py-1.5 text-xs font-semibold text-white transition hover:bg-white/15",onClick:()=>ve(null),children:"Close"})]}),ne&&S.jsx(y2,{artistId:ne.id,embedded:!0})]})})]})},GR=({eventName:t,eventStart:e,eventUrl:r,isFree:l,tierLabel:f,tierPrice:_,priceTiers:y,onEventNameChange:d,onEventStartChange:A,onEventUrlChange:I,onToggleFree:B,onTierLabelChange:N,onTierPriceChange:V,onAddTier:K,onRemoveTier:ie})=>S.jsxs("section",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"Tickets"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Essentials only. Everything else can wait."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Event name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:t,onChange:ne=>d(ne.target.value),placeholder:"Night Session"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Starts at"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",type:"datetime-local",value:e,onChange:ne=>A(ne.target.value)})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Event link"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:r,onChange:ne=>I(ne.target.value),placeholder:"https://..."})]}),S.jsxs("label",{className:"flex items-center gap-3 text-sm text-white",children:[S.jsxs("span",{className:"relative inline-flex items-center",children:[S.jsx("input",{type:"checkbox",className:"peer h-5 w-10 appearance-none rounded-full bg-white/10 transition checked:border-app-accent checked:bg-app-accent",checked:l,onChange:ne=>B(ne.target.checked)}),S.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-5"})]}),S.jsx("span",{className:"text-white/80",children:l?"Free event":"Paid event"})]}),!l&&S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Tier name"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:f,onChange:ne=>N(ne.target.value),placeholder:"Presale"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Price"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:_,onChange:ne=>V(ne.target.value),placeholder:"12"})]})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:K,children:"Add tier"}),y.length>0&&S.jsx("div",{className:"space-y-2",children:y.map((ne,ve)=>S.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl bg-white/5 px-3 py-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-xs font-semibold text-white",children:ne.label}),S.jsxs("p",{className:"text-[10px] text-white/60",children:["$",ne.price.toFixed(2)]})]}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>ie(ve),children:"Remove"})]},`${ne.label}-${ve}`))})]})]}),WR=({eventEnd:t,eventGenres:e,eventCoverUrl:r,eventDescription:l,posterPreview:f,posterFile:_,onEventEndChange:y,onEventGenresChange:d,onEventCoverUrlChange:A,onEventDescriptionChange:I,onPosterFileChange:B,onPosterRemove:N})=>{const V=te.useRef(null),[K,ie]=te.useState(0),ne=!!(f||_),ve=te.useMemo(()=>_?_.name:r.trim()?"Using poster URL":"Upload a poster or paste a URL (optional).",[r,_]);return S.jsxs("section",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-white/60",children:"More info"}),S.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Optional details (poster, genres, description)."})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Ends at"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-white/15",type:"datetime-local",value:t,onChange:se=>y(se.target.value)})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Genres"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:e,onChange:se=>d(se.target.value),placeholder:"Jazz, Experimental"})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-start justify-between gap-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Poster"}),S.jsx("p",{className:"mt-1 text-xs text-white/60",children:ve})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:()=>V.current?.click(),children:"Upload"}),ne&&S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white/80 transition hover:bg-white/15 hover:text-white",onClick:()=>{ie(se=>se+1),N()},children:"Remove"})]})]}),S.jsx("input",{ref:V,type:"file",accept:"image/*",className:"hidden",onChange:se=>B(se.target.files?.[0]||null)},K),f&&S.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-black/30",children:S.jsx("img",{src:f,alt:"Event poster preview",className:"h-52 w-full object-cover"})}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Poster URL (optional)"}),S.jsx("input",{className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:r,onChange:se=>A(se.target.value),placeholder:"https://..."})]})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Description"}),S.jsx("textarea",{className:"min-h-[110px] w-full resize-none rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15",value:l,onChange:se=>I(se.target.value),placeholder:"Optional details..."})]})]})},Zf=["Sala","Artista","Entrada","Ms info"],YR=({onDismiss:t,onCreated:e,userId:r,profileRole:l,profileCity:f,profileName:_,defaultArtistId:y,initialMapCenter:d})=>{const[A,I]=te.useState(0),B=!!(l&&["artist","venue","label"].includes(l)),N=RR({userId:r,profileRole:l,profileCity:f,defaultArtistId:y,defaultArtistName:_||void 0,initialCenter:d||void 0}),V=te.useMemo(()=>g2("venue","SALA"),[]),K=()=>I(ge=>Math.max(ge-1,0)),ie=()=>I(ge=>Math.min(ge+1,Zf.length-1)),ne=async()=>{if(A<Zf.length-1){ie();return}const ge=await N.handleCreate();ge&&(e?.(ge),t())},ve=()=>N.setVenueMode(ge=>ge==="existing"?"new":"existing"),se=(()=>{switch(A){case 0:return S.jsx(DR,{venueMode:N.venueMode,onToggleVenueMode:ve,venueSearch:N.venueSearch,onVenueSearchChange:N.setVenueSearch,mapCenter:N.mapCenter,venueMarkers:N.venueMarkers,newVenueIcon:V,visibleVenues:N.visibleVenues,venuesLoading:N.venuesLoading,selectedVenue:N.selectedVenue,onSelectVenue:N.selectVenue,onClearVenue:()=>N.setSelectedVenue(null),onBoundsChange:N.handleBoundsChange,onMapSelect:N.handleMapSelect,venueLat:N.venueLat,venueLng:N.venueLng,newVenueName:N.newVenueName,newVenueCity:N.newVenueCity,newVenueAddress:N.newVenueAddress,newVenueLat:N.newVenueLat,newVenueLng:N.newVenueLng,onNewVenueNameChange:N.setNewVenueName,onNewVenueCityChange:N.setNewVenueCity,onNewVenueAddressChange:N.setNewVenueAddress,onNewVenueLatChange:N.setNewVenueLat,onNewVenueLngChange:N.setNewVenueLng});case 1:return S.jsx(ZR,{profileRole:l,profileName:_,artists:N.artists,selectedArtistIds:N.selectedArtistIds,artistsLoading:N.artistsLoading,artistSearch:N.artistSearch,artistSearchCount:N.artistSearchCount,onArtistSearchChange:N.setArtistSearch,onSelectArtists:N.setSelectedArtistIds});case 2:return S.jsx(GR,{eventName:N.eventName,eventStart:N.eventStart,eventUrl:N.eventUrl,isFree:N.isFree,tierLabel:N.tierLabel,tierPrice:N.tierPrice,priceTiers:N.priceTiers,onEventNameChange:N.setEventName,onEventStartChange:N.setEventStart,onEventUrlChange:N.setEventUrl,onToggleFree:ge=>{N.setIsFree(ge),N.setError("")},onTierLabelChange:N.setTierLabel,onTierPriceChange:N.setTierPrice,onAddTier:N.addPriceTier,onRemoveTier:N.removePriceTier});default:return S.jsx(WR,{eventEnd:N.eventEnd,eventGenres:N.eventGenres,eventCoverUrl:N.eventCoverUrl,eventDescription:N.eventDescription,posterPreview:N.posterPreview,posterFile:N.posterFile,onEventEndChange:N.setEventEnd,onEventGenresChange:N.setEventGenres,onEventCoverUrlChange:N.setEventCoverUrl,onEventDescriptionChange:N.setEventDescription,onPosterFileChange:N.setPosterFile,onPosterRemove:()=>N.setPosterFile(null)})}})();return S.jsxs("div",{className:"flex h-full max-h-[100vh] flex-col overflow-hidden rounded-3xl bg-app-bg",children:[S.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-4 p-4",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/60",children:"Create"}),S.jsx("h2",{className:"mt-1 font-display text-lg font-bold text-white",children:"Event"})]}),S.jsx("div",{className:"flex flex-1 justify-end",children:S.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:t,children:"Close"})})]}),S.jsx("div",{className:"flex-shrink-0 px-4",children:S.jsx("div",{className:"flex items-center gap-3 overflow-x-auto pb-2",children:Zf.map((ge,ae)=>{const me=ae===A,ye=ae<A;return S.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[S.jsx("span",{className:`text-[10px] font-semibold uppercase tracking-[0.22em] ${me?"text-app-accent":ye?"text-white/70":"text-white/45"}`,children:ge}),ae<Zf.length-1&&S.jsx("span",{className:"text-white/20",children:""})]},ge)})})}),N.error&&S.jsx("div",{className:"flex-shrink-0 px-4 pt-3",children:S.jsx("p",{className:"text-sm text-rose-400",children:N.error})}),S.jsx("div",{className:"min-h-0 flex-1 overflow-y-auto px-4 py-4",children:se}),S.jsx("div",{className:"flex-shrink-0 p-4 pt-0",children:S.jsxs("div",{className:"tw flex flex-col gap-2 sm:flex-row",children:[A>0&&S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 rounded-2xl bg-white/10 px-6 py-3 text-sm font-semibold text-white transition hover:bg-white/15 sm:w-auto",onClick:K,children:"Back"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 rounded-2xl bg-white/10 px-6 py-3 text-sm font-semibold text-white transition hover:bg-white/15 disabled:cursor-not-allowed disabled:opacity-60",onClick:ne,disabled:N.saving||A===Zf.length-1&&!B,children:A===Zf.length-1?N.saving?"Creating...":"Create event":"Next"})]})})]})},XR=()=>{const t=ta(),e=pp(),{user:r,profile:l,loading:f}=ya(),{canCreateEvent:_,activeWorkspace:y,loading:d,ready:A}=mp(),I=te.useRef(null),B=te.useRef(null),N=te.useRef(null),V=e.state?.from||"/tabs/events";te.useEffect(()=>{A&&(I.current=_)},[A,_]),te.useEffect(()=>{r||(I.current=null,B.current=null,N.current=null)},[r]),te.useEffect(()=>{y&&(B.current=y)},[y]),te.useEffect(()=>{l&&(N.current=l)},[l]);const K=A?_:I.current??!1,ie=y??B.current,ne=l??N.current,ve=ie?.type==="artist"&&(ie.artist?.id||ie.artist?.artist_id)||null,se=ie?.type==="venue"?Number(ie.venue?.latitude??ie.venue?.lat??null):null,ge=ie?.type==="venue"?Number(ie.venue?.longitude??ie.venue?.lng??null):null,ae=ie?.type==="venue"&&Number.isFinite(se)&&Number.isFinite(ge)?[se,ge]:null;return f&&!r?S.jsx(Zh,{children:S.jsx(Pl,{fullscreen:!0,children:S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})})})}):r?(!A||d)&&!K?S.jsx(Zh,{children:S.jsx(Pl,{fullscreen:!0,children:S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})})})}):A&&!K?S.jsx(Ec,{to:"/tabs/events"}):S.jsx(Zh,{children:S.jsx(Pl,{fullscreen:!0,children:S.jsx(YR,{onDismiss:()=>t.push(V),onCreated:me=>{me?t.push(`/event/${me}`):t.push(V)},userId:r?.id,profileRole:ie?.type||ne?.role||null,profileCity:ie?.venue?.city||ne?.primary_city||null,profileName:ie?.artist?.name||ie?.venue?.name||ne?.display_name||ne?.username||null,defaultArtistId:ve,initialMapCenter:ae})})}):S.jsx(Ec,{to:"/welcome"})},KR=()=>{const t=ta(),{updatePassword:e}=ya(),[r,l]=te.useState(""),[f,_]=te.useState(""),[y,d]=te.useState(!1),[A,I]=te.useState(""),[B,N]=te.useState("");te.useEffect(()=>{(async()=>{const ne=new URLSearchParams(window.location.search).get("code");ne&&await Rt.auth.exchangeCodeForSession(ne);const{data:ve}=await Rt.auth.getSession();d(!!ve.session)})()},[]);const V=async()=>{if(N(""),I(""),!r||r.length<6){N("Password must be at least 6 characters.");return}if(r!==f){N("Passwords do not match.");return}const{error:K}=await e(r);if(K){N(K.message);return}I("Password updated. You can sign in now.")};return S.jsx(so,{children:S.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[!y&&S.jsx("p",{className:"text-sm text-white/70",children:"Open the reset link from your email to continue."}),y&&S.jsxs("div",{className:"space-y-4 rounded-2xl bg-white/5 p-4",children:[S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"New password"}),S.jsx("input",{type:"password",value:r,onChange:K=>l(K.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-white/60",children:"Confirm password"}),S.jsx("input",{type:"password",value:f,onChange:K=>_(K.target.value),placeholder:"",className:"w-full rounded-2xl bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-white/15"})]}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15",onClick:V,children:"Update password"})]}),B&&S.jsx("p",{className:"text-sm text-rose-400",children:B}),A&&S.jsx("p",{className:"text-sm text-emerald-400",children:A}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-2 text-sm font-semibold text-white/70 transition hover:text-white",onClick:()=>t.replace("/welcome"),children:"Back to sign in"})]})})},JR={async getEventPosts(t){const{data:e,error:r}=await Rt.from("v_posts_with_setlist").select("*").eq("event_id",t).order("event_offset_ms",{ascending:!0,nullsFirst:!1}).order("captured_at",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0});if(r)throw r;return e||[]},async getEventSetlist(t){const{data:e,error:r}=await Rt.from("event_setlist").select("*").eq("event_id",t).order("ordinal",{ascending:!0});if(r)throw r;return e||[]},async getSetlistEntryForOffset(t,e){const{data:r,error:l}=await Rt.rpc("get_setlist_entry_for_offset",{p_event_id:t,p_offset_ms:e});if(l)throw l;return r?.[0]||null}},ww=2082844800,Sy=t=>t.toString().padStart(2,"0"),QR=t=>`${t.getFullYear()}-${Sy(t.getMonth()+1)}-${Sy(t.getDate())}T${Sy(t.getHours())}:${Sy(t.getMinutes())}`,eD=t=>{if(!t)return null;const e=new Date(t);return Number.isNaN(e.getTime())?null:e},tD=(t,e)=>e+4>t.byteLength?"":String.fromCharCode(t.getUint8(e),t.getUint8(e+1),t.getUint8(e+2),t.getUint8(e+3)),_2=(t,e)=>{const r=t.getUint32(e),l=t.getUint32(e+4);return r*2**32+l},Sw=(t,e,r)=>{if(e+8>r)return null;let l=t.getUint32(e);const f=tD(t,e+4);let _=8;if(l===1){if(e+16>r)return null;l=_2(t,e+8),_=16}else l===0&&(l=r-e);return l<_?null:{size:l,type:f,headerSize:_}},iD=(t,e,r)=>e+4>r?null:t.getUint8(e)===1?e+12>r?null:_2(t,e+4):e+8>r?null:t.getUint32(e+4),nD=t=>{const e=new DataView(t),r=e.byteLength;let l=0;for(;l+8<=r;){const f=Sw(e,l,r);if(!f)break;const _=Math.min(l+f.size,r);if(f.type==="moov"){let y=l+f.headerSize;for(;y+8<=_;){const d=Sw(e,y,_);if(!d)break;if(d.type==="mvhd"){const A=iD(e,y+d.headerSize,_);if(A!==null)return A}if(d.size<=0)break;y+=d.size}}if(f.size<=0)break;l+=f.size}return null},sD=async t=>{const r=[t.slice(0,2097152)];t.size>2097152&&r.push(t.slice(Math.max(t.size-2097152,0),t.size));for(const l of r)try{const f=await l.arrayBuffer(),_=nD(f);if(_&&_>ww){const y=new Date((_-ww)*1e3);if(!Number.isNaN(y.getTime()))return y}}catch{}return null},rD=async t=>{const e=t.type.startsWith("image/"),r=t.type.startsWith("video/");if(e)try{const l=await Ac(()=>import("./full.esm-DoFl4RTa.js"),[]),_=await(l.default??l).parse(t,["DateTimeOriginal","CreateDate","ModifyDate"]),y=_?.DateTimeOriginal||_?.CreateDate||_?.ModifyDate,d=y instanceof Date?y:typeof y=="string"?new Date(y):null;if(d&&!Number.isNaN(d.getTime()))return{capturedAt:d,source:"exif"}}catch{}if(r){const l=await sD(t);if(l)return{capturedAt:l,source:"video.metadata"}}return Number.isFinite(t.lastModified)&&t.lastModified>0?{capturedAt:new Date(t.lastModified),source:"file.lastModified"}:{capturedAt:null,source:null}},aD=async t=>{const e=new Date;return await Promise.all(t.map(async l=>{const{capturedAt:f,source:_}=await rD(l),y=l.type.startsWith("video")?"video":"image",d=f??e,A=f?_:"manual";return{id:typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`,file:l,previewUrl:URL.createObjectURL(l),mediaType:y,captureAt:f??d,captureSource:A??null,manualValue:QR(d)}}))},oD=t=>t==="artist"||t==="artist_entity"?"Artist":t==="venue"?"Venue":t==="label"?"Label":"User",lD=({title:t,meta:e,entities:r,onSelectEntity:l,coverImageUrl:f,actions:_})=>S.jsxs("section",{children:[S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[f?S.jsx("img",{src:f,alt:t,className:"absolute inset-0 h-full w-full object-cover"}):null,_?S.jsx("div",{className:"absolute right-4 top-4 z-10 flex items-center gap-3",children:_}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("h1",{className:"font-display text-3xl font-bold text-white",children:t}),e?S.jsx("div",{className:"mt-2 text-sm text-white/75",children:e}):null]})]}),r.length>0&&S.jsx("div",{className:"mt-4 flex flex-wrap gap-x-4 gap-y-2 px-4",children:r.map(y=>S.jsxs("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/65 hover:text-white",onClick:()=>l(y.id,y.role),children:[y.name,"  ",oD(y.role)]},y.id))})]}),cD=(t,e,r)=>Math.min(r,Math.max(e,t)),gv=t=>{const e=Math.max(0,Math.round(t)),r=Math.floor(e/3600),l=Math.floor(e%3600/60),f=e%60;return r>0?`+${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`+${l.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},uD=({buckets:t,selectedIndex:e,onSelectIndex:r,eventStart:l,gapThresholdSeconds:f=120})=>{const _=te.useRef(null),y=te.useRef({offsets:[],maxOffset:1}),[d,A]=te.useState(!1),I=te.useMemo(()=>l||(t[0]?new Date(t[0].bucket_time):null),[l,t]),B=te.useMemo(()=>I?t.map(ae=>{const me=Math.round((new Date(ae.bucket_time).getTime()-I.getTime())/1e3);return me<0?0:me}):[],[t,I]),N=te.useMemo(()=>B.length===0?1:Math.max(...B,1),[B]),V=te.useMemo(()=>{if(B.length<2||N<=0)return[];const ae=[];for(let me=0;me<B.length-1;me+=1){const ye=B[me],Se=B[me+1];if(Se<=ye)continue;const ze=Se-ye>f;ae.push({key:`${ye}-${Se}`,left:ye/N*100,width:(Se-ye)/N*100,isGap:ze})}return ae},[B,N,f]);te.useEffect(()=>{y.current={offsets:B,maxOffset:N}},[B,N]);const K=te.useCallback(ae=>{const me=_.current;if(!me||t.length===0)return;const ye=me.getBoundingClientRect();if(ye.width===0)return;const Se=cD((ae-ye.left)/ye.width,0,1),{offsets:ze,maxOffset:He}=y.current,Ze=Se*He;let st=0,lt=Number.POSITIVE_INFINITY;ze.forEach((Ke,Mt)=>{const gt=Math.abs(Ke-Ze);gt<lt&&(lt=gt,st=Mt)}),r(st)},[t.length,r]),ie=ae=>{_.current&&(_.current.setPointerCapture(ae.pointerId),A(!0),K(ae.clientX))},ne=ae=>{d&&K(ae.clientX)},ve=ae=>{_.current&&(_.current.hasPointerCapture(ae.pointerId)&&_.current.releasePointerCapture(ae.pointerId),A(!1))};if(t.length===0)return null;const se=B[e]??0,ge=N?se/N:0;return S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsxs("div",{className:"relative h-8 cursor-pointer touch-none",ref:_,onPointerDown:ie,onPointerMove:ne,onPointerUp:ve,onPointerCancel:ve,onPointerLeave:ve,children:[S.jsx("div",{className:"absolute inset-x-0 top-1/2 h-0.5 -translate-y-1/2 bg-white/10"}),V.map(ae=>S.jsx("div",{className:`absolute top-1/2 h-0.5 -translate-y-1/2 rounded-full ${ae.isGap?"bg-[repeating-linear-gradient(90deg,rgba(255,255,255,0.08),rgba(255,255,255,0.08)_6px,transparent_6px,transparent_12px)]":"bg-white/30"}`,style:{left:`${ae.left}%`,width:`${ae.width}%`}},ae.key)),t.map((ae,me)=>{const ye=N?(B[me]??0)/N:0,Se=ae.moment_count>=5?3:ae.moment_count>=3?2:1,ze=Se===3?"h-3 w-3":Se===2?"h-2.5 w-2.5":"h-2 w-2";return S.jsx("button",{type:"button",className:`absolute top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full ${ze} ${me===e?"bg-[#ff6b4a]":"bg-white/40"}`,style:{left:`${ye*100}%`},onClick:()=>r(me),children:S.jsx("span",{className:"sr-only",children:gv(B[me]??0)})},ae.bucket_time)}),S.jsx("div",{className:"pointer-events-none absolute top-1/2 h-4 w-4 -translate-x-1/2 -translate-y-1/2 rounded-full border-2 border-[#ff6b4a] bg-[#ff6b4a]/20",style:{left:`${ge*100}%`}})]}),S.jsxs("div",{className:"flex justify-between text-[11px] text-white/55",children:[S.jsx("span",{children:gv(0)}),S.jsx("span",{children:gv(N)})]})]})},hD=({moments:t,selectedIndex:e,onSelect:r})=>t.length<=1?null:S.jsx("div",{className:"flex gap-2.5 overflow-x-auto pb-1",children:t.map((l,f)=>S.jsxs("button",{type:"button",className:"relative h-14 w-14 flex-shrink-0 overflow-hidden bg-white/5 transition-opacity hover:opacity-90",onClick:()=>r(f),children:[f===e&&S.jsx("span",{className:"absolute left-2 top-2 h-2 w-2 bg-[#ff6b4a]"}),l.media_type==="video"?l.thumbnail_url?S.jsx("img",{src:l.thumbnail_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"}):S.jsx("video",{muted:!0,preload:"metadata",className:"h-full w-full object-cover",children:S.jsx("source",{src:l.media_url})}):S.jsx("img",{src:l.media_url,alt:l.caption||"Moment",className:"h-full w-full object-cover"}),S.jsxs("span",{className:"sr-only",children:["Moment ",f+1]})]},l.id))}),v2=t=>{const e=Math.max(0,Math.round(t)),r=Math.floor(e/3600),l=Math.floor(e%3600/60),f=e%60;return r>0?`+${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`+${l.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},dD=(t,e)=>{if(!t)return"";const r=new Date(t);if(e){const l=(r.getTime()-e.getTime())/1e3;return v2(l)}return r.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})},fD=(t,e)=>{if(!t)return"";const r=t.captured_at||t.created_at,l=new Date(r);if(e){const f=(l.getTime()-e.getTime())/1e3;return v2(f)}return l.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})},pD=({buckets:t,selectedBucketIndex:e,selectedMomentIndex:r,moments:l,loading:f,totalMoments:_,eventStart:y,mediaFilter:d,onSelectBucket:A,onSelectMoment:I,onAddMoments:B,onFilterChange:N,autoAdvance:V,onRequestNext:K})=>{const ie=t[e]??null,ne=l[r]??null,ve=te.useRef(null);te.useEffect(()=>{if(!ne||ne.media_type!=="video")return;const ae=ve.current;if(!ae)return;const me=ae.play();me&&typeof me.catch=="function"&&me.catch(()=>{})},[ne?.id]);const se=te.useMemo(()=>dD(ie?.bucket_time??null,y),[ie?.bucket_time,y]),ge=te.useMemo(()=>fD(ne,y),[ne,y]);return S.jsxs("section",{className:"flex flex-col gap-4",children:[S.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Timeline"}),S.jsx("p",{className:"mt-1.5 font-display text-lg font-bold text-white",children:se||"+00:00"})]}),S.jsxs("div",{className:"inline-flex items-center gap-3",children:[_>0&&S.jsxs("span",{className:"text-xs text-white/55",children:[_," moments"]}),S.jsx("div",{className:"inline-flex gap-4 bg-white/10 px-3 py-2",children:["all","video","image"].map(ae=>S.jsx("button",{type:"button",className:`text-[10px] font-semibold uppercase tracking-[0.22em] transition-colors ${d===ae?"text-app-accent":"text-white/55 hover:text-white/80"}`,onClick:()=>N(ae),children:ae==="all"?"All":ae==="video"?"Video":"Photos"},ae))})]})]}),S.jsx("div",{className:"-mx-4",children:S.jsx("div",{className:`relative aspect-video overflow-hidden bg-black ${f?"opacity-90":""}`,children:f?S.jsx("div",{className:"flex h-full items-center justify-center",children:S.jsx(Ws,{name:"crescent"})}):ne?S.jsxs("div",{className:"relative h-full w-full animate-[timeline-fade_0.35s_ease]",onClick:()=>{const ae=ve.current;ae&&(ae.paused?ae.play().catch(()=>{}):ae.pause())},children:[ne.media_type==="video"?S.jsx("video",{ref:ve,playsInline:!0,muted:!0,autoPlay:!0,className:"h-full w-full object-cover",onEnded:()=>{V&&K&&K()},poster:ne.thumbnail_url||void 0,children:S.jsx("source",{src:ne.media_url})}):S.jsx("img",{src:ne.media_url,alt:ne.caption||"Moment",className:"h-full w-full object-cover"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-4",children:[ne.resolved_song_title&&S.jsx("div",{className:"mb-2 inline-flex items-center gap-1.5 bg-black/60 px-2.5 py-1",children:S.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.22em] text-white/80",children:ne.resolved_song_title})}),S.jsx("p",{className:"text-xs text-white/65",children:ge}),S.jsx("h4",{className:"mt-1.5 font-display text-lg font-bold text-white",children:ne.actor_name||ne.profiles?.display_name||ne.profiles?.username||"Anonymous"})]})]},ne.id):S.jsxs("div",{className:"flex min-h-full flex-col items-center justify-center gap-2 px-6 text-center",children:[S.jsx("p",{className:"text-lg font-semibold text-white",children:"No moments yet."}),S.jsx("span",{className:"text-xs text-white/55",children:"Relive the show by adding the first clip."}),B&&S.jsx("button",{type:"button",className:"mt-1.5 text-xs font-semibold uppercase tracking-[0.22em] text-app-accent",onClick:B,children:"Add the first moment"})]})})}),S.jsx(uD,{buckets:t,selectedIndex:e,onSelectIndex:A,eventStart:y,gapThresholdSeconds:120}),S.jsx(hD,{moments:l,selectedIndex:r,onSelect:I})]})},mD=({isOpen:t,onClose:e,link:r})=>{const[l,f]=te.useState("");te.useEffect(()=>{t||f("")},[t]);const _=async()=>{if(r)try{await navigator.clipboard.writeText(r),f("Link copied.")}catch{f("Copy failed. Long-press to copy.")}},y=async()=>{if(r){if(navigator.share)try{await navigator.share({url:r,title:"Live Space event"});return}catch{}_()}};return S.jsx($m,{isOpen:t,onDidDismiss:e,initialBreakpoint:.5,breakpoints:[0,.5,.9],className:"share-sheet",children:S.jsx(Pl,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Share"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:e,children:"Close"})]}),S.jsx("div",{className:"mt-6 flex items-center justify-center bg-white/5 p-5",children:r&&S.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${encodeURIComponent(r)}`,alt:"Event QR",className:"h-40 w-40 bg-white"})}),S.jsxs("div",{className:"mt-6 space-y-2",children:[S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:_,children:[S.jsx(aI,{className:"h-4 w-4"}),"Copy link"]}),S.jsxs("button",{type:"button",className:"inline-flex w-full items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:y,children:[S.jsx(TS,{className:"h-4 w-4"}),"Share"]})]}),l&&S.jsx("p",{className:"mt-4 text-sm text-white/55",children:l})]})})})},gD=()=>{const t=ta(),e=pp(),{id:r}=eg(),{user:l,profile:f,isManagementMode:_,activeEntity:y}=ya(),[d,A]=te.useState(null),[I,B]=te.useState(!0),[N,V]=te.useState(""),[K,ie]=te.useState([]),[ne,ve]=te.useState(!1),[se,ge]=te.useState(""),[ae,me]=te.useState([]),[ye,Se]=te.useState([]),[ze,He]=te.useState(!1),[Ze,st]=te.useState(0),[lt,Ke]=te.useState(0),[Mt,gt]=te.useState(!1),[St,Be]=te.useState([]),[ot,Fe]=te.useState(!1),[kt,rt]=te.useState({current:0,total:0}),[be,Ie]=te.useState(""),[et,at]=te.useState(""),[mt,Ct]=te.useState(!1),[Ot,Kt]=te.useState(!1),[_i,Vi]=te.useState(!1),[gi,Oi]=te.useState("video"),[xn,cn]=te.useState({all:0,video:0,image:0}),[Zn,tt]=te.useState(!1),[Xn,Pn]=te.useState(null),[ki,yi]=te.useState(!1),[Cn,Ln]=te.useState(""),[us,an]=te.useState(!1),en=te.useRef(null),qi=te.useRef([]),Fn=te.useRef({}),Tt=te.useRef({});te.useEffect(()=>{e.state?.openAddMoments&&(an(!0),t.replace({pathname:e.pathname,search:e.search,hash:e.hash,state:{}}))},[t,e.hash,e.pathname,e.search,e.state?.openAddMoments]);const On=te.useMemo(()=>!!new URLSearchParams(e.search).get("token"),[e.search]);te.useEffect(()=>{qi.current=St},[St]),te.useEffect(()=>()=>{qi.current.forEach(_t=>URL.revokeObjectURL(_t.previewUrl))},[]);const dn=async()=>{B(!0),V("");try{const{data:_t,error:xt}=await Rt.from("events").select(`
          *,
          organizer:profiles!events_organizer_id_fkey (
            id,
            username,
            display_name,
            avatar_url,
            role
          ),
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude,
            website_url,
            photos
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `).eq("id",r).single();if(xt||!_t){V("Event not found."),A(null);return}A(_t);const Wt=await JR.getEventSetlist(r);Se(Wt)}catch{V("Could not load this event. Check your Supabase connection."),A(null)}finally{B(!1)}},An=async _t=>{ve(!0),ge(""),Fn.current={},Tt.current={};try{let xt=null;if(_t==="all")xt=await Rt.rpc("event_moment_buckets",{p_event_id:r});else{const Ne=await Rt.rpc("event_moment_buckets_filtered",{p_event_id:r,p_media_type:_t});Ne.error?xt=await Rt.rpc("event_moment_buckets",{p_event_id:r}):xt=Ne}if(xt?.error)throw xt.error;const Wt=xt?.data||[],pi=Wt.length>0?Wt.length-1:0;ie(Wt),st(pi),Ke(0)}catch(xt){ie([]),ge(xt?.message||"Could not load the timeline.")}finally{ve(!1)}},Kn=async()=>{try{const _t=Rt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",r),xt=Rt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",r).eq("media_type","video"),Wt=Rt.from("posts").select("id",{count:"exact",head:!0}).eq("event_id",r).eq("media_type","image"),[{count:pi},{count:Ne},{count:zt}]=await Promise.all([_t,xt,Wt]),Jt={all:pi??0,video:Ne??0,image:zt??0};cn(Jt),gi==="video"&&Jt.video===0&&Jt.image>0&&Oi("image"),gi==="image"&&Jt.image===0&&Jt.video>0&&Oi("video"),gi!=="all"&&Jt.video===0&&Jt.image===0&&Oi("all")}catch{cn({all:0,video:0,image:0})}},It=async(_t,xt,Wt)=>{if(!_t)return;const pi=`${Wt}:${_t}`;if(Fn.current[pi]){xt&&(me(Fn.current[pi]),Ke(0));return}if(!Tt.current[pi]){Tt.current[pi]=!0,xt&&He(!0);try{const Ne=new Date(_t),zt=new Date(Ne.getTime()+1e3),Jt=Ne.toISOString(),Ki=zt.toISOString();let wi=Rt.from("v_event_posts_with_setlist").select(`
          *,
          profiles:profiles!posts_user_id_fkey (
            id,
            username,
            display_name,
            avatar_url
          )
        `).eq("event_id",r).or(`and(captured_at.gte.${Jt},captured_at.lt.${Ki}),and(captured_at.is.null,created_at.gte.${Jt},created_at.lt.${Ki})`).order("event_offset_ms",{ascending:!0,nullsFirst:!1}).order("captured_at",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0});Wt!=="all"&&(wi=wi.eq("media_type",Wt));const{data:vn,error:gr}=await wi;if(gr)throw gr;const Ys=vn||[];Fn.current[pi]=Ys,xt&&(me(Ys),Ke(0))}catch{xt&&me([])}finally{Tt.current[pi]=!1,xt&&He(!1)}}},ai=(_t,xt)=>{if(_t<0||_t>=K.length)return;const Wt=K[_t];It(Wt.bucket_time,!1,xt)};te.useEffect(()=>{Fn.current={},Tt.current={},ie([]),me([]),st(0),Ke(0),Be([]),gt(!1),Kt(!1),dn(),Kn()},[r]),te.useEffect(()=>{An(gi)},[r,gi]),te.useEffect(()=>{Ze>=K.length&&K.length>0&&st(0)},[K,Ze]);const ti=K[Ze]??null,Ji=te.useMemo(()=>{const _t=K.reduce((xt,Wt)=>xt+Wt.moment_count,0);return gi==="video"?xn.video||_t:gi==="image"?xn.image||_t:xn.all||_t},[K,xn,gi]);te.useEffect(()=>{if(!ti){me([]);return}It(ti.bucket_time,!0,gi),ai(Ze-1,gi),ai(Ze+1,gi)},[ti?.bucket_time,gi]),te.useEffect(()=>{(async()=>{if(!l||!r){Vi(!1),Pn(null);return}try{const xt=_&&y?y.subject_id:f?.subject_id,[{data:Wt},{data:pi}]=await Promise.all([Rt.from("event_saves").select("event_id").eq("event_id",r).eq(xt?"subject_id":"user_id",xt||l.id).limit(1),Rt.from("event_attendance").select("status").eq("event_id",r).eq(xt?"subject_id":"user_id",xt||l.id).limit(1)]);Vi(!!(Wt&&Wt.length>0)),Pn(pi?.[0]?.status??null)}catch{Vi(!1),Pn(null)}})()},[l,r]);const Nn=te.useMemo(()=>{if(!d)return[];const _t=[],xt=new Set,Wt=Ne=>{!Ne||xt.has(Ne.id)||(_t.push({id:Ne.id,name:Ne.display_name||Ne.username||"Unknown",role:Ne.role}),xt.add(Ne.id))},pi=Ne=>{!Ne||xt.has(Ne.id)||(_t.push({id:Ne.id,name:Ne.name||"Unknown Artist",role:"artist_entity"}),xt.add(Ne.id))};return Wt(d.organizer),Wt(d.venue),d.event_artists?.forEach(Ne=>pi(Ne.artist)),_t},[d]),mi=te.useMemo(()=>{if(!d)return"Event";const _t=d.event_artists?.find(Wt=>Wt.artist)?.artist;return _t?_t.name:(d.organizer&&d.organizer.role!=="venue"?d.organizer.display_name||d.organizer.username:null)||d.name},[d]),Bt=te.useMemo(()=>{if(!d)return null;const _t=d.venue_place?.name||d.venue?.display_name||d.venue?.username||d.address||"Venue TBA",xt=new Date(d.starts_at).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return S.jsxs("span",{className:"flex flex-wrap items-center gap-2",children:[d.venue_place?S.jsx("button",{type:"button",className:"font-semibold text-white",onClick:()=>t.push(`/tabs/venue/${d.venue_place?.id}`),children:_t}):S.jsx("span",{className:"font-semibold text-white",children:_t}),S.jsx("span",{className:"text-white/50",children:""}),S.jsx("span",{className:"text-white/80",children:xt})]})},[d,t]),hi=te.useMemo(()=>d?new Date(d.starts_at):null,[d]),Ci=te.useMemo(()=>d?.ends_at?new Date(d.ends_at):null,[d]),bi=(_t,xt)=>{xt==="artist_entity"?t.push(`/tabs/artist/${_t}`):t.push(`/profile/${_t}`)},xe=!!(l&&(On||Xn)),ee=()=>{en.current?.click()},Q=()=>{if(Ie(""),at(""),!l){t.push("/welcome");return}if(!d){Ie("Event not found.");return}if(!xe){Kt(!0);return}ee()},ue=async _t=>{const xt=Array.from(_t.target.files||[]);if(!xt.length)return;const Wt=await aD(xt);Be(pi=>[...pi,...Wt]),gt(!0),_t.target.value=""},we=(_t,xt)=>{const Wt=eD(xt);Be(pi=>pi.map(Ne=>Ne.id===_t?{...Ne,manualValue:xt,captureAt:Wt,captureSource:xt?"manual":null}:Ne))},je=_t=>{Be(xt=>xt.map(Wt=>Wt.id===_t?{...Wt,manualValue:"",captureAt:null,captureSource:null}:Wt))},Oe=_t=>{Be(xt=>{const Wt=xt.find(pi=>pi.id===_t);return Wt&&URL.revokeObjectURL(Wt.previewUrl),xt.filter(pi=>pi.id!==_t)})},qe=async()=>{if(Ie(""),at(""),!l){Ie("Sign in to upload moments.");return}if(!d){Ie("Event not found.");return}if(St.length===0){Ie("Select at least one photo or video.");return}Fe(!0),rt({current:0,total:St.length});try{for(let _t=0;_t<St.length;_t+=1){const xt=St[_t];rt({current:_t+1,total:St.length});const Wt=xt.mediaType==="video",pi=xt.file.name.split(".").pop()||(Wt?"mp4":"jpg"),zt=`${Wt?"videos":"images"}/${l.id}/${d.id}/${Date.now()}-${xt.id}.${pi}`,{error:Jt}=await Rt.storage.from("media").upload(zt,xt.file,{cacheControl:"3600",upsert:!1});if(Jt)throw Jt;const{data:Ki}=Rt.storage.from("media").getPublicUrl(zt),wi=_&&y?y.subject_id:f?.subject_id,{error:vn}=await Rt.from("posts").insert({user_id:l.id,actor_subject_id:wi,event_id:d.id,media_url:Ki.publicUrl,media_type:xt.mediaType,captured_at:xt.captureAt?xt.captureAt.toISOString():null,capture_source:xt.captureSource});if(vn)throw vn}at("Moments uploaded!"),FS(`posts:count:user:${l.id}:event:${d.id}`),Be(_t=>(_t.forEach(xt=>URL.revokeObjectURL(xt.previewUrl)),[])),gt(!1),Kn(),An(gi)}catch(_t){Ie(_t?.message||"Upload failed. Try again.")}finally{Fe(!1)}},de=async()=>{if(!(!l||!d)){Ln(""),tt(!0);try{const _t=_&&y?y.subject_id:f?.subject_id;if(_i){const{error:xt}=await Rt.from("event_saves").delete().eq("event_id",d.id).eq(_t?"subject_id":"user_id",_t||l.id);if(xt)throw xt;Vi(!1)}else{const{error:xt}=await Rt.from("event_saves").insert({event_id:d.id,user_id:l.id,subject_id:_t||null});if(xt)throw xt;Vi(!0)}}catch(_t){Ln(_t?.message||"Could not update follow state.")}finally{tt(!1)}}},Je=async(_t,xt)=>{if(!l||!d)return!1;Ln(""),yi(!0);try{const Wt=_&&y?y.subject_id:f?.subject_id;if(!xt?.force&&Xn===_t){const{error:Ne}=await Rt.from("event_attendance").delete().eq("event_id",d.id).eq(Wt?"subject_id":"user_id",Wt||l.id);if(Ne)throw Ne;return Pn(null),!0}const{error:pi}=await Rt.from("event_attendance").upsert({event_id:d.id,user_id:l.id,subject_id:Wt||null,status:_t},{onConflict:"event_id,user_id"});if(pi)throw pi;return Pn(_t),!0}catch(Wt){return Ln(Wt?.message||"Could not update attendance."),!1}finally{yi(!1)}},ct=async()=>{if(!l){t.push("/welcome");return}await Je("attended",{force:!0})&&(Kt(!1),ee())},Ye=d?`${window.location.origin}/event/${d.id}${d.qr_token?`?token=${d.qr_token}`:""}`:"",nt=new Date,ei=hi?Ci?nt>Ci:nt.getTime()>hi.getTime()+360*60*1e3:!1,si=ei?"attended":"going",$t=ei?"I went":"I'm here",At=Xn===si,ni=()=>{if(!l){t.push("/welcome");return}de()},vi=()=>{if(!l){t.push("/welcome");return}Je(si)},Bi=()=>{if(ae.length>lt+1){Ke(_t=>_t+1);return}Ze+1<K.length&&(st(_t=>_t+1),Ke(0))};return S.jsxs(so,{children:[I&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})}),!I&&N&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:N})}),!I&&d&&S.jsxs(S.Fragment,{children:[us&&S.jsx("div",{className:"px-4 pt-4",children:S.jsxs("div",{className:"bg-black/70 p-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Relive last night"}),S.jsx("p",{className:"mt-2 font-display text-lg font-bold text-white",children:"Add your moments"}),S.jsx("p",{className:"mt-1 text-xs text-white/55",children:"Share what you lived before the memory fades."}),S.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center bg-[#ff6b4a] px-4 py-2 text-sm font-semibold text-white",onClick:Q,children:"Add your moments"}),S.jsx("button",{type:"button",className:"inline-flex items-center justify-center bg-white/10 px-4 py-2 text-sm font-semibold text-white",onClick:()=>an(!1),children:"Not now"})]})]})}),S.jsx(lD,{title:mi,meta:Bt,entities:Nn,onSelectEntity:bi,coverImageUrl:d.cover_image_url??void 0,actions:S.jsxs(S.Fragment,{children:[S.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.22em] transition-colors ${_i?"text-app-accent":"text-white/70 hover:text-white"}`,onClick:ni,disabled:Zn,"aria-pressed":_i,children:[_i?S.jsx(iI,{className:"h-4 w-4"}):S.jsx(Nx,{className:"h-4 w-4"}),S.jsx("span",{children:"Like"})]}),S.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.22em] transition-colors ${At?"text-app-accent":"text-white/70 hover:text-white"}`,onClick:vi,disabled:ki,"aria-pressed":At,children:[S.jsx(nI,{className:"h-4 w-4"}),S.jsx("span",{children:$t})]})]})}),S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("div",{className:"flex flex-col gap-2",children:[S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white",onClick:Q,children:"Add your moments"}),l&&!xe&&S.jsx("p",{className:"text-xs text-white/55",children:"Mark I went to unlock uploads."})]}),Cn&&S.jsx("p",{className:"text-sm text-rose-400",children:Cn}),se&&S.jsx("p",{className:"text-sm text-rose-400",children:se}),ye.length>0&&S.jsxs("div",{className:"bg-white/5 p-4",children:[S.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Official setlist"}),S.jsx("div",{className:"mt-3 flex flex-col gap-2",children:ye.map(_t=>S.jsx("div",{className:"flex items-center justify-between text-xs",children:S.jsxs("span",{className:"text-white/80",children:[S.jsxs("span",{className:"mr-2 text-white/45",children:[_t.ordinal,"."]}),_t.song_title||"Unknown Song"]})},_t.ordinal))})]}),S.jsx(pD,{buckets:K,selectedBucketIndex:Ze,selectedMomentIndex:lt,moments:ae,loading:ze||ne&&ae.length===0,totalMoments:Ji,eventStart:hi,mediaFilter:gi,onSelectBucket:_t=>{st(_t),Ke(0)},onSelectMoment:_t=>Ke(_t),onAddMoments:Q,onFilterChange:Oi,autoAdvance:gi==="video",onRequestNext:Bi})]})]}),S.jsx($m,{isOpen:Mt,onDidDismiss:()=>gt(!1),children:S.jsx(Pl,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Add moments"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>gt(!1),disabled:ot,children:"Close"})]}),St.length===0&&S.jsx("p",{className:"text-sm text-white/55",children:"Select photos or videos to add moments."}),St.map(_t=>S.jsxs("div",{className:"mt-4 space-y-3 bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx("div",{className:"h-20 w-20 overflow-hidden bg-black",children:_t.mediaType==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:_t.previewUrl})}):S.jsx("img",{src:_t.previewUrl,alt:_t.file.name,className:"h-full w-full object-cover"})}),S.jsxs("div",{className:"flex-1 space-y-1",children:[S.jsx("p",{className:"text-sm font-semibold text-white",children:_t.file.name}),S.jsx("p",{className:"text-xs text-white/55",children:_t.captureAt?_t.captureAt.toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Upload time"})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>Oe(_t.id),children:"Remove"})]}),S.jsxs("label",{className:"flex flex-col gap-2",children:[S.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:"Captured time"}),S.jsx("input",{type:"datetime-local",className:"w-full bg-white/10 px-4 py-3 text-sm text-white/85 focus:outline-none",value:_t.manualValue,onChange:xt=>we(_t.id,xt.target.value)})]}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>je(_t.id),children:"Use upload time"})]},_t.id)),be&&S.jsx("p",{className:"text-sm text-rose-400",children:be}),et&&S.jsx("p",{className:"text-sm text-emerald-400",children:et}),ot&&S.jsxs("p",{className:"text-xs text-white/55",children:["Uploading ",kt.current,"/",kt.total]}),S.jsx("button",{type:"button",className:"mt-4 inline-flex w-full items-center justify-center bg-[#ff6b4a] px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:qe,disabled:ot||St.length===0,children:ot?"Uploading...":"Upload moments"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:ee,disabled:ot,children:"Add more"})]})})}),S.jsx($m,{isOpen:Ot,onDidDismiss:()=>Kt(!1),initialBreakpoint:.45,breakpoints:[0,.45,.7],className:"gate-sheet",children:S.jsx(Pl,{fullscreen:!0,children:S.jsxs("div",{className:"min-h-full bg-app-bg p-5",children:[S.jsxs("div",{className:"flex items-center justify-between gap-4",children:[S.jsx("h2",{className:"font-display text-lg font-bold text-white",children:"Unlock moments"}),S.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70",onClick:()=>Kt(!1),disabled:ki,children:"Close"})]}),S.jsx("p",{className:"text-sm text-white/55",children:'Mark "I went" to add moments for this event.'}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center bg-white/10 px-4 py-3 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:ct,disabled:ki,children:ki?"Marking...":"Mark I went"}),S.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center px-4 py-3 text-sm font-semibold text-white/70 disabled:cursor-not-allowed disabled:opacity-60",onClick:()=>Kt(!1),disabled:ki,children:"Not now"})]})})}),S.jsx(mD,{isOpen:mt,onClose:()=>Ct(!1),link:Ye}),S.jsx("input",{ref:en,type:"file",accept:"image/*,video/*",multiple:!0,onChange:ue,className:"hidden"})]})},yD=()=>{const t=ta(),{id:e}=eg(),{user:r,profile:l}=ya(),[f,_]=te.useState(null),[y,d]=te.useState([]),[A,I]=te.useState([]),[B,N]=te.useState([]),[V,K]=te.useState(!0),[ie,ne]=te.useState(""),[ve,se]=te.useState(!1),[ge,ae]=te.useState(!1),[me,ye]=te.useState(0);te.useEffect(()=>{(async()=>{K(!0),ne("");try{const{data:Ze,error:st}=await Rt.from("profiles").select("*").eq("id",e).single();if(st||!Ze)throw st;if(_(Ze),Ze.subject_id){const[gt,St]=await Promise.all([fu.getFollowersCount(Ze.subject_id),r&&l?.subject_id?fu.isFollowing(l.subject_id,Ze.subject_id):Promise.resolve(!1)]);ye(gt),se(St)}const lt=`
          *,
          organizer:profiles!events_organizer_id_fkey (
            id,
            username,
            display_name,
            role
          ),
          venue_place:venue_places!events_venue_place_id_fkey (
            id,
            name,
            city,
            address,
            latitude,
            longitude
          ),
          event_artists (
            artist:artists!event_artists_artist_entity_fk (
              id,
              name,
              avatar_url
            )
          )
        `;let Ke=[],Mt=[];if(Ze.role==="artist"){const{data:gt}=await Rt.from("event_artists").select("event_id").eq("artist_entity_id",e);if(Ke=(gt||[]).map(St=>St.event_id),Ke.length>0){const{data:St}=await Rt.from("events").select(lt).in("id",Ke).order("starts_at",{ascending:!1});Mt=St||[]}}else if(Ze.role==="venue"){const{data:gt}=await Rt.from("venue_places").select("*").eq("created_by",e).order("name",{ascending:!0}),St=gt||[];d(St);const Be=St.map(ot=>ot.id).filter(Boolean);if(Be.length>0){const{data:ot}=await Rt.from("events").select(lt).in("venue_place_id",Be).order("starts_at",{ascending:!1});Mt=ot||[],Ke=Mt.map(Fe=>Fe.id)}else Mt=[],Ke=[]}else if(Ze.role==="label"){const{data:gt}=await Rt.from("events").select(lt).eq("organizer_id",e).order("starts_at",{ascending:!1});Mt=gt||[],Ke=Mt.map(St=>St.id)}if(I(Mt),Ke.length>0){const{data:gt}=await Rt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",Ke).order("created_at",{ascending:!1}).limit(18);N(gt||[])}else N([])}catch{ne("Profile not found.")}finally{K(!1)}})()},[e,r,l?.subject_id]);const Se=async()=>{if(!r||!l?.subject_id||!f?.subject_id){r||t.push("/welcome");return}ae(!0);try{ve?(await fu.unfollow(l.subject_id,f.subject_id),se(!1),ye(He=>Math.max(0,He-1))):(await fu.follow(l.subject_id,f.subject_id),se(!0),ye(He=>He+1))}catch(He){console.error("Failed to toggle follow",He)}finally{ae(!1)}},ze=te.useMemo(()=>{const He=f?.external_links||{};return Object.entries(He).map(([Ze,st])=>({key:Ze,value:st})).filter(Ze=>!!Ze.value)},[f]);return S.jsxs(so,{children:[V&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})}),!V&&ie&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:ie})}),!V&&f&&S.jsxs(S.Fragment,{children:[S.jsxs("section",{className:"relative h-[340px] w-full overflow-hidden bg-black",children:[f.avatar_url?S.jsx("img",{src:f.avatar_url,alt:f.display_name||"Profile",className:"absolute inset-0 h-full w-full object-cover"}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:f.role.toUpperCase()}),S.jsx("h2",{className:"mt-2 font-display text-3xl font-bold text-white",children:f.display_name||f.username||"Unknown"}),f.primary_city&&S.jsx("p",{className:"mt-2 text-sm text-white/70",children:f.primary_city}),S.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:[me," followers"]}),r&&f.id!==r.id&&S.jsx("button",{type:"button",disabled:ge,onClick:Se,className:`px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${ve?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:ge?S.jsx(Ws,{name:"crescent"}):ve?"Following":"Follow"})]})]})]}),S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[f.bio&&S.jsx("p",{className:"text-sm text-white/70",children:f.bio}),ze.length>0&&S.jsxs("section",{className:"space-y-3",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Links"}),S.jsx("div",{className:"space-y-2 text-sm",children:ze.map(He=>S.jsx("a",{href:He.value,target:"_blank",rel:"noreferrer",className:"block text-white/70 hover:text-white",children:He.value.replace(/^https?:\/\//,"")},He.key))})]}),f.role==="venue"&&y.length>0&&S.jsxs("section",{className:"space-y-4",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venues"}),S.jsx("div",{className:"space-y-6",children:y.map(He=>S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{children:[S.jsx("p",{className:"font-display text-lg font-bold text-white",children:He.name}),S.jsx("p",{className:"text-sm text-white/70",children:He.address||He.city}),(He.venue_type||He.capacity)&&S.jsxs("p",{className:"text-xs text-white/55",children:[He.venue_type||"Venue",He.capacity?`  ${He.capacity} cap`:""]})]}),He.website_url&&S.jsx("a",{href:He.website_url,target:"_blank",rel:"noreferrer",className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",children:He.website_url.replace(/^https?:\/\//,"")}),(He.photos||[]).length>0&&S.jsx("div",{className:"-mx-4 flex gap-2 overflow-x-auto pb-1",children:He.photos.slice(0,8).map((Ze,st)=>S.jsx("div",{className:"h-28 w-44 flex-shrink-0 overflow-hidden bg-white/5",children:S.jsx("img",{src:Ze,alt:"Venue",className:"h-full w-full object-cover"})},`${Ze}-${st}`))})]},He.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Events"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Shows connected to this profile."})]}),A.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No events yet."}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:A.map(He=>S.jsx(Ql,{event:He,className:"w-full",onSelect:Ze=>t.push(`/event/${Ze.id}`)},He.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Latest media from connected events."})]}),B.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No moments yet."}):S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:B.map(He=>S.jsx("button",{type:"button",onClick:()=>t.push(`/post/${He.id}`),className:"aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:He.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:He.media_url})}):S.jsx("img",{src:He.media_url,alt:He.caption||"Moment",className:"h-full w-full object-cover"})},He.id))})]}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>t.goBack(),children:"Back"})]})]})]})},_D=()=>{const{id:t}=eg(),e=ta(),[r,l]=te.useState(null),[f,_]=te.useState(!0),[y,d]=te.useState(""),A=r?.events??null;return te.useEffect(()=>{(async()=>{_(!0),d("");try{const{data:B,error:N}=await Rt.from("posts").select(`
            id,
            media_url,
            media_type,
            thumbnail_url,
            caption,
            created_at,
            profiles:profiles!posts_user_id_fkey (
              id,
              username,
              display_name,
              avatar_url
            ),
            events:events!posts_event_id_fkey (
              id,
              name,
              city,
              starts_at,
              cover_image_url,
              address,
              venue_place:venue_places!events_venue_place_id_fkey (
                id,
                name,
                city,
                address
              )
            )
          `).eq("id",t).single();if(N||!B)throw N;l(B)}catch{d("Post not found."),l(null)}finally{_(!1)}})()},[t]),S.jsxs(so,{children:[f&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})}),!f&&y&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:y})}),!f&&r&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden bg-black",children:[r.media_type==="video"?S.jsx("video",{controls:!0,playsInline:!0,className:"absolute inset-0 h-full w-full object-cover",poster:r.thumbnail_url||r.events?.cover_image_url||void 0,children:S.jsx("source",{src:r.media_url})}):S.jsx("img",{src:r.media_url,alt:r.caption||"Moment",className:"absolute inset-0 h-full w-full object-cover"}),S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moment"}),S.jsx("h2",{className:"mt-2 font-display text-2xl font-bold text-white",children:r.caption||"Relive the moment"}),S.jsxs("p",{className:"mt-2 text-sm text-white/70",children:[(r.profiles?.username?`@${r.profiles.username}`:r.profiles?.display_name)||"Anonymous","  ",new Date(r.created_at).toLocaleString()]})]})]}),S.jsxs("div",{className:"flex flex-col gap-6 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[S.jsxs("div",{className:"flex gap-2",children:[S.jsxs("button",{type:"button",className:"inline-flex flex-1 items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",children:[S.jsx(Nx,{className:"h-4 w-4"}),"Like"]}),S.jsxs("button",{type:"button",className:"inline-flex flex-1 items-center justify-center gap-2 bg-white/10 px-4 py-3 text-sm font-semibold text-white",children:[S.jsx(TS,{className:"h-4 w-4"}),"Share"]})]}),A&&S.jsxs("button",{type:"button",onClick:()=>e.push(`/event/${A.id}`),className:"bg-white/5 p-4 text-left",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Event"}),S.jsx("p",{className:"mt-2 font-display text-lg font-bold text-white",children:A.name}),S.jsxs("p",{className:"mt-1 text-sm text-white/70",children:[A.venue_place?.name||A.address||"Venue","  ",new Date(A.starts_at).toLocaleString()]}),S.jsx("p",{className:"mt-2 text-xs text-white/55",children:"View event details"})]})]})]})]})},vD=()=>{const{id:t}=eg(),e=ta(),{user:r,profile:l}=ya(),[f,_]=te.useState(null),[y,d]=te.useState([]),[A,I]=te.useState([]),[B,N]=te.useState(!0),[V,K]=te.useState(""),[ie,ne]=te.useState(!1),[ve,se]=te.useState(!1),[ge,ae]=te.useState(0);te.useEffect(()=>{(async()=>{N(!0),K("");try{const{data:ze,error:He}=await Rt.from("venue_places").select("*").eq("id",t).single();if(He||!ze)throw He;let Ze=null;try{const{data:Mt,error:gt}=await Rt.rpc("get_or_create_venue_subject",{p_venue_place_id:ze.id});!gt&&typeof Mt=="string"&&(Ze=Mt)}catch{}const{data:st,error:lt}=await Rt.from("events").select(`
            *,
            organizer:profiles!events_organizer_id_fkey (
              id,
              username,
              display_name,
              role
            ),
            venue_place:venue_places!events_venue_place_id_fkey (
              id,
              name,
              city,
              address,
              latitude,
              longitude
            ),
            event_artists (
              artist:artists!event_artists_artist_entity_fk (
                id,
                name,
                avatar_url
              )
            )
          `).eq("venue_place_id",t).order("starts_at",{ascending:!1});if(lt)throw lt;if(_({...ze,subject_id:Ze}),d(st||[]),Ze){const[Mt,gt]=await Promise.all([fu.getFollowersCount(Ze),r&&l?.subject_id?fu.isFollowing(l.subject_id,Ze):Promise.resolve(!1)]);ae(Mt),ne(gt)}const Ke=(st||[]).map(Mt=>Mt.id);if(Ke.length>0){const{data:Mt}=await Rt.from("posts").select("id, media_url, media_type, caption, event_id, created_at, actor_subject_id, song_title").in("event_id",Ke).order("created_at",{ascending:!1}).limit(18);I(Mt||[])}else I([])}catch{K("Venue not found."),_(null),d([]),I([])}finally{N(!1)}})()},[t,r,l?.subject_id]);const me=async()=>{if(!r||!l?.subject_id||!f?.subject_id){r||e.push("/welcome");return}se(!0);try{ie?(await fu.unfollow(l.subject_id,f.subject_id),ne(!1),ae(Se=>Math.max(0,Se-1))):(await fu.follow(l.subject_id,f.subject_id),ne(!0),ae(Se=>Se+1))}catch(Se){console.error("Failed to toggle follow",Se)}finally{se(!1)}},ye=te.useMemo(()=>f?f.address&&f.city?`${f.address}  ${f.city}`:f.address||f.city||"":"",[f]);return S.jsxs(so,{children:[B&&S.jsx("div",{className:"flex items-center justify-center py-12",children:S.jsx(Ws,{name:"crescent"})}),!B&&V&&S.jsx("div",{className:"p-4",children:S.jsx("p",{className:"text-sm text-rose-400",children:V})}),!B&&f&&S.jsxs(S.Fragment,{children:[S.jsxs("section",{className:"relative h-[340px] w-full overflow-hidden bg-black",children:[(f.photos||[])[0]?S.jsx("img",{src:(f.photos||[])[0],alt:f.name,className:"absolute inset-0 h-full w-full object-cover"}):null,S.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 p-5",children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Venue"}),S.jsx("h1",{className:"mt-2 font-display text-3xl font-bold text-white",children:f.name}),ye&&S.jsx("p",{className:"mt-2 text-sm text-white/70",children:ye}),S.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[S.jsxs("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/55",children:[ge," followers"]}),r&&S.jsx("button",{type:"button",disabled:ve,onClick:me,className:`px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] disabled:opacity-60 ${ie?"bg-white/10 text-white/80":"bg-[#ff6b4a] text-white"}`,children:ve?S.jsx(Ws,{name:"crescent"}):ie?"Following":"Follow"})]})]})]}),S.jsxs("div",{className:"flex flex-col gap-8 p-4 pb-[calc(32px+env(safe-area-inset-bottom,0px))]",children:[(f.photos||[]).length>1&&S.jsx("section",{className:"-mx-4 flex gap-2 overflow-x-auto pb-1",children:(f.photos||[]).slice(1,8).map((Se,ze)=>S.jsx("div",{className:"h-36 w-52 flex-shrink-0 overflow-hidden bg-white/5",children:S.jsx("img",{src:Se,alt:`Venue ${f.name}`,className:"h-full w-full object-cover"})},`${Se}-${ze}`))}),(f.venue_type||f.capacity)&&S.jsxs("p",{className:"text-xs text-white/55",children:[f.venue_type||"Venue",f.capacity?`  ${f.capacity} cap`:""]}),f.website_url&&S.jsx("a",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-white/70 hover:text-white",href:f.website_url,target:"_blank",rel:"noreferrer",children:f.website_url.replace(/^https?:\/\//,"")}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Events"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"All shows hosted here."})]}),y.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No events here yet."}):S.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:y.map(Se=>S.jsx(Ql,{event:Se,className:"w-full",onSelect:ze=>e.push(`/event/${ze.id}`)},Se.id))})]}),S.jsxs("section",{className:"space-y-3",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-white/65",children:"Moments"}),S.jsx("p",{className:"mt-1 text-sm text-white/55",children:"Latest media from this room."})]}),A.length===0?S.jsx("p",{className:"text-sm text-white/55",children:"No memories here yet."}):S.jsx("div",{className:"-mx-4 grid grid-cols-3 gap-1",children:A.map(Se=>S.jsx("button",{type:"button",onClick:()=>e.push(`/post/${Se.id}`),className:"aspect-square overflow-hidden bg-white/5 transition-opacity hover:opacity-90",children:Se.media_type==="video"?S.jsx("video",{className:"h-full w-full object-cover",muted:!0,children:S.jsx("source",{src:Se.media_url})}):S.jsx("img",{src:Se.media_url,alt:Se.caption||"Moment",className:"h-full w-full object-cover"})},Se.id))})]}),S.jsx("button",{type:"button",className:"bg-white/10 px-4 py-3 text-sm font-semibold text-white",onClick:()=>e.goBack(),children:"Back"})]})]})]})},xD=[{key:"grant",label:"Grant Access",href:"/admin/grants"},{key:"artist",label:"Create Artist",href:"/admin/create-artist"},{key:"venue",label:"Create Venue",href:"/admin/create-venue"},{key:"list",label:"View Access Grants",href:"/admin/access-grants"}],y_=({active:t})=>S.jsx("div",{className:"grid gap-3 rounded-2xl border border-white/10 bg-white/5 p-3 sm:grid-cols-2",children:xD.map(e=>{const r=e.key===t;return S.jsx("a",{href:e.href,className:`flex min-h-[72px] items-center justify-center rounded-xl border px-4 py-3 text-base font-semibold uppercase tracking-[0.12em] transition ${r?"border-app-ink bg-app-ink text-white shadow-lg shadow-app-ink/30":"border-white/10 bg-white/5 text-app-light/80 hover:border-app-ink/40 hover:text-white"}`,children:e.label},e.key)})}),bD=()=>{const{profile:t}=ya(),[e,r]=te.useState(!1),[l,f]=te.useState(null),[_,y]=te.useState(""),[d,A]=te.useState([]),[I,B]=te.useState(null),[N,V]=te.useState(""),[K,ie]=te.useState("artist"),[ne,ve]=te.useState([]),[se,ge]=te.useState(null);te.useEffect(()=>{_.length>2?Cm.searchProfiles(_).then(A):A([])},[_]),te.useEffect(()=>{N.length>2?K==="artist"?Cm.searchArtists(N).then(ve):Cm.searchVenues(N).then(ve):ve([])},[N,K]);const ae=async()=>{if(!(!I||!se)){r(!0),f(null);try{await Cm.adminGrantEntityAccess(I.id,K,se.id,"admin"),f({type:"success",text:"Access granted successfully"}),B(null),ge(null),y(""),V("")}catch(me){f({type:"error",text:me.message||"Failed to grant access"})}finally{r(!1)}}};return t?.role!=="admin"?S.jsx(Zh,{children:S.jsx(Pl,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsx(so,{headerProps:{title:"Admin Grants",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-10 py-6",children:[S.jsx(y_,{active:"grant"}),S.jsxs("section",{className:"space-y-3 rounded-2xl border border-white/10 bg-white/5 p-4",children:[S.jsx("div",{className:"flex items-center justify-between",children:S.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider text-app-light/70",children:"Grant Access"})}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Grant a user access to manage an artist or venue."}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wider text-app-light/50",children:"Find User"}),S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:"Search by username or display name...",value:_,onChange:me=>y(me.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),d.length>0&&!I&&S.jsx("div",{className:"absolute top-full z-10 mt-1 w-full overflow-hidden rounded-xl border border-white/10 bg-[#1A1D25] shadow-xl",children:d.map(me=>S.jsxs("button",{onClick:()=>{B(me),y(me.username||me.display_name)},className:"flex w-full items-center gap-3 p-3 text-left hover:bg-white/5",children:[me.avatar_url?S.jsx("img",{src:me.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-app-ink/20 text-xs font-bold text-app-ink",children:me.username?.[0]?.toUpperCase()||"?"}),S.jsxs("div",{children:[S.jsx("div",{className:"font-medium text-app-light",children:me.username}),S.jsx("div",{className:"text-xs text-app-light/50",children:me.display_name})]})]},me.id))})]}),I&&S.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-app-ink/10 p-3",children:[S.jsxs("span",{className:"text-sm text-app-ink",children:["Selected: ",S.jsx("strong",{children:I.username})]}),S.jsx("button",{onClick:()=>B(null),className:"text-xs text-app-ink hover:underline",children:"Clear"})]})]}),S.jsxs("div",{className:"space-y-3 pt-2",children:[S.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wider text-app-light/50",children:"Select Entity"}),S.jsxs("div",{className:"flex gap-2 rounded-xl bg-white/5 p-1",children:[S.jsx("button",{onClick:()=>{ie("artist"),ge(null),V("")},className:`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${K==="artist"?"bg-app-ink text-white":"text-app-light/60 hover:text-app-light"}`,children:"Artist"}),S.jsx("button",{onClick:()=>{ie("venue"),ge(null),V("")},className:`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${K==="venue"?"bg-app-ink text-white":"text-app-light/60 hover:text-app-light"}`,children:"Venue"})]}),S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:`Search for ${K}...`,value:N,onChange:me=>V(me.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),ne.length>0&&!se&&S.jsx("div",{className:"absolute top-full z-10 mt-1 w-full overflow-hidden rounded-xl border border-white/10 bg-[#1A1D25] shadow-xl",children:ne.map(me=>S.jsxs("button",{onClick:()=>{ge(me),V(me.name)},className:"flex w-full items-center gap-3 p-3 text-left hover:bg-white/5",children:[me.image_url?S.jsx("img",{src:me.image_url,alt:"",className:"h-8 w-8 rounded-lg object-cover"}):S.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-white/10 text-xs font-bold text-app-light/40",children:me.name[0]}),S.jsxs("div",{children:[S.jsx("div",{className:"font-medium text-app-light",children:me.name}),me.city&&S.jsx("div",{className:"text-xs text-app-light/50",children:me.city})]})]},me.id))})]}),se&&S.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-app-ink/10 p-3",children:[S.jsxs("span",{className:"text-sm text-app-ink",children:["Selected: ",S.jsx("strong",{children:se.name})]}),S.jsx("button",{onClick:()=>ge(null),className:"text-xs text-app-ink hover:underline",children:"Clear"})]})]}),S.jsxs("div",{className:"pt-4",children:[l&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${l.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:l.text}),S.jsx("button",{disabled:!I||!se||e,onClick:ae,className:"flex w-full items-center justify-center rounded-2xl bg-app-ink py-4 font-bold text-white shadow-lg shadow-app-ink/20 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:e?S.jsx(Ws,{name:"crescent",color:"light"}):"Grant Access"})]})]})]})})},wD={async createArtist(t){const{data:e,error:r}=await Rt.from("artists").insert(t).select().single();if(r)throw r;const{data:l,error:f}=await Rt.rpc("get_or_create_artist_subject",{p_artist_id:e.id});if(f)throw f;return{...e,subject_id:l}},async getArtistBySubject(t){const{data:e,error:r}=await Rt.from("v_subject_artists").select("*").eq("subject_id",t).maybeSingle();if(r)throw r;return e},async updateArtist(t,e){const{data:r,error:l}=await Rt.from("artists").update(e).eq("id",t).select().single();if(l)throw l;return r}},SD=()=>{const{profile:t}=ya(),[e,r]=te.useState(""),[l,f]=te.useState(""),[_,y]=te.useState("solo"),[d,A]=te.useState(""),[I,B]=te.useState(""),[N,V]=te.useState(!1),[K,ie]=te.useState(null),ne=async()=>{if(!e.trim()){ie({type:"error",text:"Artist name is required"});return}V(!0),ie(null);try{const ve=d.split(",").map(se=>se.trim()).filter(Boolean);await wD.createArtist({name:e.trim(),artist_type:_,city:l.trim()||null,bio:null,avatar_url:I.trim()||null,genres:ve,external_links:{}}),ie({type:"success",text:"Artist created successfully"}),r(""),f(""),A(""),B(""),y("solo")}catch(ve){ie({type:"error",text:ve.message||"Failed to create artist"})}finally{V(!1)}};return t?.role!=="admin"?S.jsx(Zh,{children:S.jsx(Pl,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsx(so,{headerProps:{title:"Create Artist",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-6 py-6",children:[S.jsx(y_,{active:"artist"}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Create an artist entity so you can publish and assign access."}),S.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[S.jsx("input",{type:"text",placeholder:"Artist name *",value:e,onChange:ve=>r(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"City",value:l,onChange:ve=>f(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsxs("select",{value:_,onChange:ve=>y(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50",children:[S.jsx("option",{value:"solo",children:"Solo"}),S.jsx("option",{value:"band",children:"Band"})]}),S.jsx("input",{type:"text",placeholder:"Avatar URL",value:I,onChange:ve=>B(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Genres (comma separated)",value:d,onChange:ve=>A(ve.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"})]}),S.jsxs("div",{className:"pt-2",children:[K&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${K.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:K.text}),S.jsx("button",{disabled:N,onClick:ne,className:"flex w-full items-center justify-center rounded-2xl bg-white/10 py-4 font-bold text-app-light shadow-lg shadow-white/10 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:N?S.jsx(Ws,{name:"crescent",color:"light"}):"Create Artist"})]})]})})},TD={async createVenue(t){const{data:e,error:r}=await Rt.from("venue_places").insert(t).select().single();if(r)throw r;const{data:l,error:f}=await Rt.rpc("get_or_create_venue_subject",{p_venue_place_id:e.id});if(f)throw f;return{...e,subject_id:l}},async getVenueBySubject(t){const{data:e,error:r}=await Rt.from("v_subject_venues").select("*").eq("subject_id",t).maybeSingle();if(r)throw r;return e},async updateVenue(t,e){const{data:r,error:l}=await Rt.from("venue_places").update(e).eq("id",t).select().single();if(l)throw l;return r}},ED=()=>{const{profile:t}=ya(),[e,r]=te.useState(""),[l,f]=te.useState(""),[_,y]=te.useState(""),[d,A]=te.useState(""),[I,B]=te.useState(""),[N,V]=te.useState(""),[K,ie]=te.useState(!1),[ne,ve]=te.useState(null),se=async()=>{if(!e.trim()||!l.trim()){ve({type:"error",text:"Venue name and city are required"});return}ie(!0),ve(null);try{const ge=N?Number(N):null;await TD.createVenue({name:e.trim(),city:l.trim(),address:d.trim()||null,capacity:Number.isNaN(ge)?null:ge,venue_type:_.trim()||null,latitude:null,longitude:null,website_url:I.trim()||null,photos:[],created_by:t?.id??null}),ve({type:"success",text:"Venue created successfully"}),r(""),f(""),A(""),B(""),V(""),y("")}catch(ge){ve({type:"error",text:ge.message||"Failed to create venue"})}finally{ie(!1)}};return t?.role!=="admin"?S.jsx(Zh,{children:S.jsx(Pl,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})}):S.jsx(so,{headerProps:{title:"Create Venue",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-2xl space-y-6 py-6",children:[S.jsx(y_,{active:"venue"}),S.jsx("p",{className:"text-sm text-app-light/70",children:"Create a venue entity to manage events and content."}),S.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[S.jsx("input",{type:"text",placeholder:"Venue name *",value:e,onChange:ge=>r(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"City *",value:l,onChange:ge=>f(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Type (club, theatre...)",value:_,onChange:ge=>y(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Website",value:I,onChange:ge=>B(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50"}),S.jsx("input",{type:"text",placeholder:"Address",value:d,onChange:ge=>A(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"}),S.jsx("input",{type:"number",placeholder:"Capacity",value:N,onChange:ge=>V(ge.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 p-4 text-app-light outline-none focus:border-app-ink/50 sm:col-span-2"})]}),S.jsxs("div",{className:"pt-2",children:[ne&&S.jsx("div",{className:`mb-4 rounded-xl p-4 text-sm font-medium ${ne.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:ne.text}),S.jsx("button",{disabled:K,onClick:se,className:"flex w-full items-center justify-center rounded-2xl bg-white/10 py-4 font-bold text-app-light shadow-lg shadow-white/10 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100",children:K?S.jsx(Ws,{name:"crescent",color:"light"}):"Create Venue"})]})]})})},kD=()=>{const{profile:t}=ya(),[e,r]=te.useState(!0),[l,f]=te.useState(null),[_,y]=te.useState([]);if(te.useEffect(()=>{const I=async()=>{r(!0),f(null);try{const{data:B,error:N}=await Rt.from("entity_members").select(`
            admin_subject_id,
            entity_subject_id,
            role,
            created_at,
            admin:admin_subject_id (
              profile:profile_id (
                id,
                username,
                display_name,
                avatar_url
              )
            ),
            entity:entity_subject_id (
              type,
              profile:profile_id (
                username,
                display_name
              ),
              venue_place:venue_place_id (
                name,
                city
              ),
              artist:artist_id (
                name,
                city
              )
            )
          `).order("created_at",{ascending:!1});if(N)throw N;y(B)}catch(B){f(B.message||"Failed to load access grants")}finally{r(!1)}};t?.role==="admin"&&I()},[t]),t?.role!=="admin")return S.jsx(Zh,{children:S.jsx(Pl,{className:"ion-padding",children:S.jsx("div",{className:"flex h-full items-center justify-center text-app-light/60",children:"Access Denied. Admin only."})})});const d=I=>I.entity?I.entity.type==="artist"&&I.entity.artist?I.entity.artist.name:I.entity.type==="venue"&&I.entity.venue_place?I.entity.venue_place.name:I.entity.profile&&(I.entity.profile.display_name||I.entity.profile.username)||I.entity_subject_id:I.entity_subject_id,A=I=>I.entity?I.entity.type==="artist"&&I.entity.artist?.city?I.entity.artist.city:I.entity.type==="venue"&&I.entity.venue_place?.city?I.entity.venue_place.city:"":"";return S.jsx(so,{headerProps:{title:"Access Grants",showBack:!0},headerPlacement:"outside",contentClassName:"ion-padding",contentFullscreen:!1,contentWrapperClassName:!1,children:S.jsxs("div",{className:"mx-auto max-w-3xl space-y-8 py-6",children:[S.jsx(y_,{active:"list"}),S.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wider text-app-light/70",children:"Granted Accesses"}),e&&S.jsx(Ws,{name:"crescent",color:"light"})]}),l&&S.jsx("div",{className:"mt-3 rounded-xl bg-red-500/10 p-3 text-sm text-red-300",children:l}),!e&&!l&&_.length===0&&S.jsx("div",{className:"mt-3 rounded-xl border border-white/10 bg-white/5 p-4 text-sm text-app-light/70",children:"No access grants found."}),S.jsx("div",{className:"mt-4 space-y-3",children:_.map(I=>S.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-white/10 bg-black/20 p-3",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"h-10 w-10 overflow-hidden rounded-full bg-white/10",children:I.admin?.profile?.avatar_url?S.jsx("img",{src:I.admin.profile.avatar_url,alt:"",className:"h-full w-full object-cover"}):S.jsx("div",{className:"flex h-full w-full items-center justify-center text-xs font-bold text-app-light/70",children:I.admin?.profile?.username?.[0]?.toUpperCase()||"?"})}),S.jsxs("div",{children:[S.jsx("div",{className:"text-sm font-semibold text-app-light",children:I.admin?.profile?.display_name||I.admin?.profile?.username||"Unknown admin"}),S.jsx("div",{className:"text-xs uppercase tracking-widest text-app-light/50",children:I.role})]})]}),S.jsxs("div",{className:"text-right",children:[S.jsx("div",{className:"text-sm font-semibold text-app-light",children:d(I)}),S.jsxs("div",{className:"text-xs text-app-light/60",children:[I.entity?.type?I.entity.type.toUpperCase():"Entity"," ",A(I)&&` ${A(I)}`]})]})]},`${I.admin_subject_id}-${I.entity_subject_id}`))})]})]})})},CD=()=>{const{user:t,loading:e}=ya(),{activeWorkspace:r,loading:l}=mp(),f=r?.type==="artist"&&(r.artist?.id||r.artist?.artist_id)||null,_=r?.type==="venue"&&(r.venue?.id||r.venue?.venue_place_id)||null,y=r?.type==="artist"&&f?`/tabs/artist/${f}`:r?.type==="venue"&&_?`/tabs/venue/${_}`:"/tabs/profile",d={"--background":"rgba(11, 11, 13, 0.92)","--border":"none","--color":"rgba(255, 255, 255, 0.62)","--color-selected":"#ffffff","--padding-top":"6px","--padding-bottom":"6px","--padding-start":"10px","--padding-end":"10px","--border-radius":"0px","--background-focused":"rgba(255, 107, 74, 0.16)"},A=e&&!t;return S.jsxs(lS,{children:[S.jsx(tI,{children:S.jsxs(tp,{children:[S.jsx(Gs,{exact:!0,path:"/welcome",render:()=>!e&&!t?S.jsx(nz,{}):S.jsx(Ec,{to:"/tabs/events"})}),S.jsx(Gs,{exact:!0,path:"/event/:id",component:gD}),S.jsx(Gs,{exact:!0,path:"/profile/:id",component:yD}),S.jsx(Gs,{exact:!0,path:"/post/:id",component:_D}),S.jsx(Gs,{exact:!0,path:"/discover",render:()=>S.jsx(Ec,{to:"/tabs/discover"})}),S.jsx(Gs,{exact:!0,path:"/artist/:id",render:({match:I})=>S.jsx(Ec,{to:`/tabs/artist/${I.params.id}`})}),S.jsx(Gs,{exact:!0,path:"/venue/:id",render:({match:I})=>S.jsx(Ec,{to:`/tabs/venue/${I.params.id}`})}),S.jsx(Gs,{exact:!0,path:"/admin/grants",component:bD}),S.jsx(Gs,{exact:!0,path:"/admin/create-artist",component:SD}),S.jsx(Gs,{exact:!0,path:"/admin/create-venue",component:ED}),S.jsx(Gs,{exact:!0,path:"/admin/access-grants",component:kD}),S.jsx(Gs,{exact:!0,path:"/reset",component:KR}),S.jsx(Gs,{exact:!0,path:"/create-event",component:XR}),S.jsx(Gs,{path:"/tabs",render:()=>!e&&!t?S.jsx(Ec,{to:"/welcome"}):S.jsxs(WM,{children:[S.jsxs(tp,{children:[S.jsx(Gs,{exact:!0,path:"/tabs/feed",component:sz}),S.jsx(Gs,{exact:!0,path:"/tabs/map",component:mR}),S.jsx(Gs,{exact:!0,path:"/tabs/discover",component:PR}),S.jsx(Gs,{exact:!0,path:"/tabs/events",component:Wz}),S.jsx(Gs,{exact:!0,path:"/tabs/profile",render:()=>(console.log("[profile-route] workspace loading:",l,"workspace:",r),r?.type==="artist"&&f?S.jsx(Ec,{to:`/tabs/artist/${f}`}):r?.type==="venue"&&_?S.jsx(Ec,{to:`/tabs/venue/${_}`}):S.jsx(Yz,{}))}),S.jsx(Gs,{exact:!0,path:"/tabs/artist/:id",component:y2}),S.jsx(Gs,{exact:!0,path:"/tabs/venue/:id",component:vD}),S.jsx(Gs,{exact:!0,path:"/tabs",render:()=>S.jsx(Ec,{to:"/tabs/events"})})]}),S.jsxs(KM,{slot:"bottom",className:"h-16 px-2 py-2",style:d,children:[S.jsxs(Zd,{tab:"events",href:"/tabs/events",children:[S.jsx(SS,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Main"})]}),S.jsxs(Zd,{tab:"discover",href:"/tabs/discover",children:[S.jsx(hI,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Discover"})]}),S.jsxs(Zd,{tab:"map",href:"/tabs/map",children:[S.jsx(h_,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Map"})]}),S.jsxs(Zd,{tab:"profile",href:y,children:[S.jsx(My,{className:"h-5 w-5"}),S.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em]",children:"Profile"})]})]})]})}),S.jsx(Gs,{exact:!0,path:"/",render:()=>S.jsx(Ec,{to:e||t?"/tabs/events":"/welcome"})})]})}),A&&S.jsx("div",{className:"pointer-events-none fixed inset-0 z-[5000] flex items-center justify-center bg-black/35 backdrop-blur",children:S.jsx(Ws,{name:"crescent"})})]})},AD=({children:t})=>S.jsx(YL,{children:S.jsx(KL,{children:S.jsx(QL,{children:t})})});nP();z2.createRoot(document.getElementById("root")).render(S.jsx(AD,{children:S.jsx(CD,{})}));export{I1 as K,Ny as a,Jd as b,hx as c,Mm as d,HT as e,jv as f,ZT as g,zv as h,Lk as i,Bs as j,pu as k,RD as l,OD as m,_n as n,PD as o,MD as p,Ty as r,DD as s,zm as w};
